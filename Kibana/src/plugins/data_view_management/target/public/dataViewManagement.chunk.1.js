(window.dataViewManagement_bundle_jsonpfunction=window.dataViewManagement_bundle_jsonpfunction||[]).push([[1],Array(19).concat([function(e,t,n){e.exports=n(10)(2)},function(e,t,n){e.exports=n(10)(2455)},function(e,t,n){e.exports=n(10)(8)},function(e,t,n){"use strict";let a,i;Object.defineProperty(t,"__esModule",{value:!0}),t.KBN_FIELD_TYPES=t.ES_FIELD_TYPES=void 0,t.ES_FIELD_TYPES=a,function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(a||(t.ES_FIELD_TYPES=a={})),t.KBN_FIELD_TYPES=i,function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(i||(t.KBN_FIELD_TYPES=i={}))},function(e,t,n){e.exports=n(10)(21)},function(e,t,n){"use strict";function a(e,t){return e===t}function i(e,t,n){if(null===t||null===n||t.length!==n.length)return!1;for(var a=t.length,i=0;i<a;i++)if(!e(t[i],n[i]))return!1;return!0}function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a,n=null,s=null;return function(){return i(t,n,arguments)||(s=e.apply(null,arguments)),n=arguments,s}}function r(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var n=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+n+"]")}return t}function l(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return function(){for(var t=arguments.length,a=Array(t),i=0;i<t;i++)a[i]=arguments[i];var s=0,l=a.pop(),d=r(a),o=e.apply(void 0,[function(){return s++,l.apply(null,arguments)}].concat(n)),c=e((function(){for(var e=[],t=d.length,n=0;n<t;n++)e.push(d[n].apply(null,arguments));return o.apply(null,e)}));return c.resultFunc=l,c.dependencies=d,c.recomputations=function(){return s},c.resetRecomputations=function(){return s=0},c}}t.__esModule=!0,t.defaultMemoize=s,t.createSelectorCreator=l,t.createStructuredSelector=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d;if("object"!=typeof e)throw new Error("createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);var n=Object.keys(e);return t(n.map((function(t){return e[t]})),(function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.reduce((function(e,t,a){return e[n[a]]=t,e}),{})}))};var d=t.createSelector=l(s)},function(e,t,n){"use strict";var a,i=function(){return void 0===a&&(a=Boolean(window&&document&&document.all&&!window.atob)),a},s=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),r=[];function l(e){for(var t=-1,n=0;n<r.length;n++)if(r[n].identifier===e){t=n;break}return t}function d(e,t){for(var n={},a=[],i=0;i<e.length;i++){var s=e[i],d=t.base?s[0]+t.base:s[0],o=n[d]||0,c="".concat(d," ").concat(o);n[d]=o+1;var u=l(c),p={css:s[1],media:s[2],sourceMap:s[3]};-1!==u?(r[u].references++,r[u].updater(p)):r.push({identifier:c,updater:b(p,t),references:1}),a.push(c)}return a}function o(e){var t=document.createElement("style"),a=e.attributes||{};if(void 0===a.nonce){var i=n.nc;i&&(a.nonce=i)}if(Object.keys(a).forEach((function(e){t.setAttribute(e,a[e])})),"function"==typeof e.insert)e.insert(t);else{var r=s(e.insert||"head");if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}return t}var c,u=(c=[],function(e,t){return c[e]=t,c.filter(Boolean).join("\n")});function p(e,t,n,a){var i=n?"":a.media?"@media ".concat(a.media," {").concat(a.css,"}"):a.css;if(e.styleSheet)e.styleSheet.cssText=u(t,i);else{var s=document.createTextNode(i),r=e.childNodes;r[t]&&e.removeChild(r[t]),r.length?e.insertBefore(s,r[t]):e.appendChild(s)}}function f(e,t,n){var a=n.css,i=n.media,s=n.sourceMap;if(i?e.setAttribute("media",i):e.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(a+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),e.styleSheet)e.styleSheet.cssText=a;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(a))}}var g=null,m=0;function b(e,t){var n,a,i;if(t.singleton){var s=m++;n=g||(g=o(t)),a=p.bind(null,n,s,!1),i=p.bind(null,n,s,!0)}else n=o(t),a=f.bind(null,n,t),i=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return a(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;a(e=t)}else i()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=i());var n=d(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var a=0;a<n.length;a++){var i=l(n[a]);r[i].references--}for(var s=d(e,t),o=0;o<n.length;o++){var c=l(n[o]);0===r[c].references&&(r[c].updater(),r.splice(c,1))}n=s}}}},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",a=e[3];if(!a)return n;if(t&&"function"==typeof btoa){var i=(r=a,l=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),d="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(d," */")),s=a.sources.map((function(e){return"/*# sourceURL=".concat(a.sourceRoot||"").concat(e," */")}));return[n].concat(s).concat([i]).join("\n")}var r,l,d;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,a){"string"==typeof e&&(e=[[null,e,""]]);var i={};if(a)for(var s=0;s<this.length;s++){var r=this[s][0];null!=r&&(i[r]=!0)}for(var l=0;l<e.length;l++){var d=[].concat(e[l]);a&&i[d[0]]||(n&&(d[2]?d[2]="".concat(n," and ").concat(d[2]):d[2]=n),t.push(d))}},t}},function(e,t,n){e.exports=n(10)(43)},function(e,t,n){"use strict";function a(e,t,n,i){var s=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(s,a.prototype),s.expected=t,s.found=n,s.location=i,s.name="SyntaxError",s}function i(e,t,n){return n=n||" ",e.length>t?e:(t-=e.length,e+(n+=n.repeat(t)).slice(0,t))}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(a,Error),a.prototype.format=function(e){var t="Error: "+this.message;if(this.location){var n,a=null;for(n=0;n<e.length;n++)if(e[n].source===this.location.source){a=e[n].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,r=this.location.source+":"+s.line+":"+s.column;if(a){var l=this.location.end,d=i("",s.line.toString().length),o=a[s.line-1],c=s.line===l.line?l.column:o.length+1;t+="\n --\x3e "+r+"\n"+d+" |\n"+s.line+" | "+o+"\n"+d+" | "+i("",s.column-1)+i("",c-s.column,"^")}else t+="\n at "+r}return t},a.buildMessage=function(e,t){var n={literal:function(e){return'"'+i(e.text)+'"'},class:function(e){var t=e.parts.map((function(e){return Array.isArray(e)?s(e[0])+"-"+s(e[1]):s(e)}));return"["+(e.inverted?"^":"")+t+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(e){return e.description}};function a(e){return e.charCodeAt(0).toString(16).toUpperCase()}function i(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+a(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+a(e)}))}function r(e){return n[e.type](e)}return"Expected "+function(e){var t,n,a=e.map(r);if(a.sort(),a.length>0){for(t=1,n=1;t<a.length;t++)a[t-1]!==a[t]&&(a[n]=a[t],n++);a.length=n}switch(a.length){case 1:return a[0];case 2:return a[0]+" or "+a[1];default:return a.slice(0,-1).join(", ")+", or "+a[a.length-1]}}(e)+" but "+function(e){return e?'"'+i(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:a,parse:function(e,t){var n,i={},s=(t=void 0!==t?t:{}).grammarSource,r={start:je,Literal:Le},l=je,d=":",o="or",c="and",u="not",p='"',f="\\",g="<=",m=">=",b="@kuery-cursor@",x=/^[\\"]/,h=/^[^"]/,j=/^[\\():<>"*{}]/,v=/^[0-9a-f]/i,y=/^[ \t\r\n\xA0]/,O=pe("(",!1),F=pe(")",!1),E=pe(":",!1),M=pe("{",!1),P=pe("}",!1),T=ge("fieldName"),S=ge("value"),I=ge("OR"),_=pe("or",!0),w=ge("AND"),L=pe("and",!0),C=ge("NOT"),D=pe("not",!0),N=ge("literal"),A=pe('"',!1),k=pe("\\",!1),B=fe(["\\",'"'],!1,!1),R=fe(['"'],!0,!1),K={type:"any"},U=pe("*",!1),H=pe("\\t",!1),q=pe("\\r",!1),V=pe("\\n",!1),Y=fe(["\\","(",")",":","<",">",'"',"*","{","}"],!1,!1),G=pe("u",!1),z=fe([["0","9"],["a","f"]],!1,!0),W=pe("<=",!1),Q=pe(">=",!1),$=pe("<",!1),J=pe(">",!1),Z=ge("whitespace"),X=fe([" ","\t","\r","\n"," "],!1,!1),ee=pe("@kuery-cursor@",!1),te=function(e,t){return t},ne=function(e,t){return t},ae=function(e){if("cursor"===e.type)return e;!Ge&&"wildcard"===e.type&&ze.wildcard.hasLeadingWildcard(e)&&function(e,t){throw t=void 0!==t?t:be(le,re),function(e,t){return new a(e,null,null,t)}(e,t)}("Leading wildcards are disabled. See query:allowLeadingWildcards in Advanced Settings.");const t=Qe(!1);return n=>We("is",[n,e,t])},ie=function(){return Ve},se=function(t,n,a){const{start:i,end:s}=be(le,re);return{type:"cursor",start:i.offset,end:s.offset-n.length,prefix:t.join(""),suffix:a.join(""),text:e.substring(le,re).replace(n,"")}},re=0,le=0,de=[{line:1,column:1}],oe=0,ce=[],ue=0;if("startRule"in t){if(!(t.startRule in r))throw new Error("Can't start parsing from rule \""+t.startRule+'".');l=r[t.startRule]}function pe(e,t){return{type:"literal",text:e,ignoreCase:t}}function fe(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function ge(e){return{type:"other",description:e}}function me(t){var n,a=de[t];if(a)return a;for(n=t-1;!de[n];)n--;for(a={line:(a=de[n]).line,column:a.column};n<t;)10===e.charCodeAt(n)?(a.line++,a.column=1):a.column++,n++;return de[t]=a,a}function be(e,t){var n=me(e),a=me(t);return{source:s,start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:a.line,column:a.column}}}function xe(e){re<oe||(re>oe&&(oe=re,ce=[]),ce.push(e))}function he(e,t,n){return new a(a.buildMessage(e,t),e,t,n)}function je(){var e,t,n,a,s,r;for(e=re,t=[],n=He();n!==i;)t.push(n),n=He();return(n=ve())===i&&(n=null),(a=ke())!==i?(le=e,s=n,e="cursor"===(r=a).type?{...r,suggestionTypes:["conjunction"]}:null!==s?s:ze.function.buildNode("is","*","*")):(re=e,e=i),e}function ve(){var e,t,n,a,s;if(e=re,(t=ye())!==i){if(n=[],a=re,Ie()!==i&&(s=ye())!==i?(le=a,a=te(0,s)):(re=a,a=i),a!==i)for(;a!==i;)n.push(a),a=re,Ie()!==i&&(s=ye())!==i?(le=a,a=te(0,s)):(re=a,a=i);else n=i;n!==i?(le=e,e=function(e,t){const n=[e,...t];return Ve&&n.find((e=>"cursor"===e.type))||We("or",n)}(t,n)):(re=e,e=i)}else re=e,e=i;return e===i&&(e=ye()),e}function ye(){var e,t,n,a,s;if(e=re,(t=Oe())!==i){if(n=[],a=re,_e()!==i&&(s=Oe())!==i?(le=a,a=te(0,s)):(re=a,a=i),a!==i)for(;a!==i;)n.push(a),a=re,_e()!==i&&(s=Oe())!==i?(le=a,a=te(0,s)):(re=a,a=i);else n=i;n!==i?(le=e,e=function(e,t){const n=[e,...t];return Ve&&n.find((e=>"cursor"===e.type))||We("and",n)}(t,n)):(re=e,e=i)}else re=e,e=i;return e===i&&(e=Oe()),e}function Oe(){var e,t,n;return e=re,we()!==i&&(t=Fe())!==i?(le=e,e="cursor"===(n=t).type?n:We("not",[n])):(re=e,e=i),e===i&&(e=Fe()),e}function Fe(){var t,n,a,s,r,l,o,c;if(t=re,40===e.charCodeAt(re)?(n="(",re++):(n=i,0===ue&&xe(O)),n!==i){for(a=[],s=He();s!==i;)a.push(s),s=He();(s=ve())!==i&&(r=ke())!==i?(41===e.charCodeAt(re)?(l=")",re++):(l=i,0===ue&&xe(F)),l!==i?(le=t,o=s,t="cursor"===(c=r).type?{...c,suggestionTypes:["conjunction"]}:o):(re=t,t=i)):(re=t,t=i)}else re=t,t=i;return t===i&&(t=function(){var t,n,a,s,r,l,o,c,u,p;if(t=re,(n=Ee())!==i){for(a=[],s=He();s!==i;)a.push(s),s=He();if(58===e.charCodeAt(re)?(s=":",re++):(s=i,0===ue&&xe(E)),s!==i){for(r=[],l=He();l!==i;)r.push(l),l=He();if(123===e.charCodeAt(re)?(l="{",re++):(l=i,0===ue&&xe(M)),l!==i){for(o=[],c=He();c!==i;)o.push(c),c=He();(c=ve())!==i&&(u=ke())!==i?(125===e.charCodeAt(re)?(p="}",re++):(p=i,0===ue&&xe(P)),p!==i?(le=t,t=function(e,t,n){return"cursor"===t.type?{...t,nestedPath:t.nestedPath?`${e.value}.${t.nestedPath}`:e.value}:"cursor"===n.type?{...n,suggestionTypes:["conjunction"]}:We("nested",[e,t])}(n,c,u)):(re=t,t=i)):(re=t,t=i)}else re=t,t=i}else re=t,t=i}else re=t,t=i;t===i&&(t=function(){var t;(t=function(){var t,n,a,s,r,l;if(t=re,(n=Ee())!==i){for(a=[],s=He();s!==i;)a.push(s),s=He();if((s=function(){var t,n;t=re,e.substr(re,2)===g?(n=g,re+=2):(n=i,0===ue&&xe(W));n!==i&&(le=t,n="lte");(t=n)===i&&(t=re,e.substr(re,2)===m?(n=m,re+=2):(n=i,0===ue&&xe(Q)),n!==i&&(le=t,n="gte"),(t=n)===i&&(t=re,60===e.charCodeAt(re)?(n="<",re++):(n=i,0===ue&&xe($)),n!==i&&(le=t,n="lt"),(t=n)===i&&(t=re,62===e.charCodeAt(re)?(n=">",re++):(n=i,0===ue&&xe(J)),n!==i&&(le=t,n="gt"),t=n)));return t}())!==i){for(r=[],l=He();l!==i;)r.push(l),l=He();(l=Le())!==i?(le=t,d=n,o=s,t="cursor"===(c=l).type?{...c,suggestionTypes:["conjunction"]}:We("range",[d,o,c])):(re=t,t=i)}else re=t,t=i}else re=t,t=i;var d,o,c;return t}())===i&&(t=function(){var t,n,a,s,r,l;if(t=re,(n=Ee())!==i){for(a=[],s=He();s!==i;)a.push(s),s=He();if(58===e.charCodeAt(re)?(s=d,re++):(s=i,0===ue&&xe(E)),s!==i){for(r=[],l=He();l!==i;)r.push(l),l=He();(l=Me())!==i?(le=t,o=n,t="cursor"===(c=l).type?{...c,fieldName:o.value,suggestionTypes:["value","conjunction"]}:c(o)):(re=t,t=i)}else re=t,t=i}else re=t,t=i;var o,c;return t}())===i&&(t=function(){var e,t;e=re,(t=Se())!==i&&(le=e,t=function(e){if("cursor"===e.type){const t=`${e.prefix}${e.suffix}`.trim();return{...e,fieldName:t,suggestionTypes:["field","operator","conjunction"]}}return e(Qe(null))}(t));return e=t}());return t}());return t}()),t}function Ee(){var e;return ue++,e=Le(),ue--,e===i&&(i,0===ue&&xe(T)),e}function Me(){var t,n,a,s,r,l,d,o;if(t=re,40===e.charCodeAt(re)?(n="(",re++):(n=i,0===ue&&xe(O)),n!==i){for(a=[],s=He();s!==i;)a.push(s),s=He();(s=function(){var e,t,n,a,s;if(e=re,(t=Pe())!==i){if(n=[],a=re,Ie()!==i&&(s=Pe())!==i?(le=a,a=ne(0,s)):(re=a,a=i),a!==i)for(;a!==i;)n.push(a),a=re,Ie()!==i&&(s=Pe())!==i?(le=a,a=ne(0,s)):(re=a,a=i);else n=i;n!==i?(le=e,e=function(e,t){const n=[e,...t],a=Ve&&n.find((e=>"cursor"===e.type));return a?{...a,suggestionTypes:["value"]}:e=>We("or",n.map((t=>t(e))))}(t,n)):(re=e,e=i)}else re=e,e=i;e===i&&(e=Pe());return e}())!==i&&(r=ke())!==i?(41===e.charCodeAt(re)?(l=")",re++):(l=i,0===ue&&xe(F)),l!==i?(le=t,d=s,t="cursor"===(o=r).type?{...o,suggestionTypes:["conjunction"]}:d):(re=t,t=i)):(re=t,t=i)}else re=t,t=i;return t===i&&(t=Se()),t}function Pe(){var e,t,n,a,s;if(e=re,(t=Te())!==i){if(n=[],a=re,_e()!==i&&(s=Te())!==i?(le=a,a=ne(0,s)):(re=a,a=i),a!==i)for(;a!==i;)n.push(a),a=re,_e()!==i&&(s=Te())!==i?(le=a,a=ne(0,s)):(re=a,a=i);else n=i;n!==i?(le=e,e=function(e,t){const n=[e,...t],a=Ve&&n.find((e=>"cursor"===e.type));return a?{...a,suggestionTypes:["value"]}:e=>We("and",n.map((t=>t(e))))}(t,n)):(re=e,e=i)}else re=e,e=i;return e===i&&(e=Te()),e}function Te(){var e,t,n;return e=re,we()!==i&&(t=Me())!==i?(le=e,e="cursor"===(n=t).type?{...list,suggestionTypes:["value"]}:e=>We("not",[n(e)])):(re=e,e=i),e===i&&(e=Me()),e}function Se(){var e,t;return ue++,e=re,(t=Ce())!==i&&(le=e,t=function(e){if("cursor"===e.type)return e;const t=Qe(!0);return n=>We("is",[n,e,t])}(t)),(e=t)===i&&(e=re,(t=Ne())!==i&&(le=e,t=ae(t)),e=t),ue--,e===i&&(t=i,0===ue&&xe(S)),e}function Ie(){var t,n,a,s,r;if(ue++,t=re,n=[],(a=He())!==i)for(;a!==i;)n.push(a),a=He();else n=i;if(n!==i)if("or"===e.substr(re,2).toLowerCase()?(a=e.substr(re,2),re+=2):(a=i,0===ue&&xe(_)),a!==i){if(s=[],(r=He())!==i)for(;r!==i;)s.push(r),r=He();else s=i;s!==i?t=n=[n,a,s]:(re=t,t=i)}else re=t,t=i;else re=t,t=i;return ue--,t===i&&(n=i,0===ue&&xe(I)),t}function _e(){var t,n,a,s,r;if(ue++,t=re,n=[],(a=He())!==i)for(;a!==i;)n.push(a),a=He();else n=i;if(n!==i)if("and"===e.substr(re,3).toLowerCase()?(a=e.substr(re,3),re+=3):(a=i,0===ue&&xe(L)),a!==i){if(s=[],(r=He())!==i)for(;r!==i;)s.push(r),r=He();else s=i;s!==i?t=n=[n,a,s]:(re=t,t=i)}else re=t,t=i;else re=t,t=i;return ue--,t===i&&(n=i,0===ue&&xe(w)),t}function we(){var t,n,a,s;if(ue++,t=re,"not"===e.substr(re,3).toLowerCase()?(n=e.substr(re,3),re+=3):(n=i,0===ue&&xe(D)),n!==i){if(a=[],(s=He())!==i)for(;s!==i;)a.push(s),s=He();else a=i;a!==i?t=n=[n,a]:(re=t,t=i)}else re=t,t=i;return ue--,t===i&&(n=i,0===ue&&xe(C)),t}function Le(){var e;return ue++,(e=Ce())===i&&(e=Ne()),ue--,e===i&&(i,0===ue&&xe(N)),e}function Ce(){var t,n,a,s,r,l,d;if(t=re,le=re,(n=(n=ie())?void 0:i)!==i)if(34===e.charCodeAt(re)?(a=p,re++):(a=i,0===ue&&xe(A)),a!==i){for(s=[],r=De();r!==i;)s.push(r),r=De();if((r=qe())!==i){for(l=[],d=De();d!==i;)l.push(d),d=De();34===e.charCodeAt(re)?(d=p,re++):(d=i,0===ue&&xe(A)),d!==i?(le=t,t=se(s,r,l)):(re=t,t=i)}else re=t,t=i}else re=t,t=i;else re=t,t=i;if(t===i)if(t=re,34===e.charCodeAt(re)?(n=p,re++):(n=i,0===ue&&xe(A)),n!==i){for(a=[],s=De();s!==i;)a.push(s),s=De();34===e.charCodeAt(re)?(s=p,re++):(s=i,0===ue&&xe(A)),s!==i?(le=t,t=Qe(a.join(""))):(re=t,t=i)}else re=t,t=i;return t}function De(){var t,n,a;return(t=Be())===i&&(t=Ke())===i&&(t=re,92===e.charCodeAt(re)?(n=f,re++):(n=i,0===ue&&xe(k)),n!==i?(x.test(e.charAt(re))?(a=e.charAt(re),re++):(a=i,0===ue&&xe(B)),a!==i?(le=t,t=a):(re=t,t=i)):(re=t,t=i),t===i&&(t=re,n=re,ue++,a=qe(),ue--,a===i?n=void 0:(re=n,n=i),n!==i?(h.test(e.charAt(re))?(a=e.charAt(re),re++):(a=i,0===ue&&xe(R)),a!==i?(le=t,t=a):(re=t,t=i)):(re=t,t=i))),t}function Ne(){var e,t,n,a,s,r;if(e=re,le=re,(t=(t=ie())?void 0:i)!==i){for(n=[],a=Ae();a!==i;)n.push(a),a=Ae();if((a=qe())!==i){for(s=[],r=Ae();r!==i;)s.push(r),r=Ae();le=e,e=se(n,a,s)}else re=e,e=i}else re=e,e=i;if(e===i){if(e=re,t=[],(n=Ae())!==i)for(;n!==i;)t.push(n),n=Ae();else t=i;t!==i&&(le=e,t=function(e){const t=e.join("").trim();return"null"===t?Qe(null):"true"===t?Qe(!0):"false"===t?Qe(!1):e.includes(Je)?$e(t):Qe(t)}(t)),e=t}return e}function Ae(){var t,n,a,s,r;return(t=Be())===i&&(t=function(){var t,n,a;t=re,92===e.charCodeAt(re)?(n=f,re++):(n=i,0===ue&&xe(k));n!==i&&(a=Re())!==i?(le=t,t=a):(re=t,t=i);return t}())===i&&(t=Ke())===i&&(t=function(){var t,n,a;t=re,92===e.charCodeAt(re)?(n=f,re++):(n=i,0===ue&&xe(k));n!==i?(e.substr(re,2).toLowerCase()===o?(a=e.substr(re,2),re+=2):(a=i,0===ue&&xe(_)),a===i&&(e.substr(re,3).toLowerCase()===c?(a=e.substr(re,3),re+=3):(a=i,0===ue&&xe(L)),a===i&&(e.substr(re,3).toLowerCase()===u?(a=e.substr(re,3),re+=3):(a=i,0===ue&&xe(D)))),a!==i?(le=t,t=a):(re=t,t=i)):(re=t,t=i);return t}())===i&&(t=function(){var t,n;t=re,42===e.charCodeAt(re)?(n="*",re++):(n=i,0===ue&&xe(U));n!==i&&(le=t,n=Je);return t=n}())===i&&(t=re,n=re,ue++,a=Re(),ue--,a===i?n=void 0:(re=n,n=i),n!==i?(a=re,ue++,s=function(){var e;(e=Ie())===i&&(e=_e())===i&&(e=we());return e}(),ue--,s===i?a=void 0:(re=a,a=i),a!==i?(s=re,ue++,r=qe(),ue--,r===i?s=void 0:(re=s,s=i),s!==i?(e.length>re?(r=e.charAt(re),re++):(r=i,0===ue&&xe(K)),r!==i?(le=t,t=r):(re=t,t=i)):(re=t,t=i)):(re=t,t=i)):(re=t,t=i)),t}function ke(){var e,t,n,a,s,r;if(e=re,le=re,(t=(t=ie())?void 0:i)!==i){for(n=[],a=He();a!==i;)n.push(a),a=He();if((a=qe())!==i){for(s=[],r=He();r!==i;)s.push(r),r=He();le=e,e=se(n,a,s)}else re=e,e=i}else re=e,e=i;if(e===i)for(e=[],t=He();t!==i;)e.push(t),t=He();return e}function Be(){var t,n;return t=re,"\\t"===e.substr(re,2)?(n="\\t",re+=2):(n=i,0===ue&&xe(H)),n!==i&&(le=t,n="\t"),(t=n)===i&&(t=re,"\\r"===e.substr(re,2)?(n="\\r",re+=2):(n=i,0===ue&&xe(q)),n!==i&&(le=t,n="\r"),(t=n)===i&&(t=re,"\\n"===e.substr(re,2)?(n="\\n",re+=2):(n=i,0===ue&&xe(V)),n!==i&&(le=t,n="\n"),t=n)),t}function Re(){var t;return j.test(e.charAt(re))?(t=e.charAt(re),re++):(t=i,0===ue&&xe(Y)),t}function Ke(){var t,n,a;return t=re,92===e.charCodeAt(re)?(n=f,re++):(n=i,0===ue&&xe(k)),n!==i&&(a=function(){var t,n,a,s,r,l,d,o;t=re,117===e.charCodeAt(re)?(n="u",re++):(n=i,0===ue&&xe(G));n!==i?(a=re,s=re,(r=Ue())!==i&&(l=Ue())!==i&&(d=Ue())!==i&&(o=Ue())!==i?s=r=[r,l,d,o]:(re=s,s=i),(a=s!==i?e.substring(a,re):s)!==i?(le=t,c=a,t=String.fromCharCode(parseInt(c,16))):(re=t,t=i)):(re=t,t=i);var c;return t}())!==i?(le=t,t=a):(re=t,t=i),t}function Ue(){var t;return v.test(e.charAt(re))?(t=e.charAt(re),re++):(t=i,0===ue&&xe(z)),t}function He(){var t;return ue++,y.test(e.charAt(re))?(t=e.charAt(re),re++):(t=i,0===ue&&xe(X)),ue--,t===i&&(i,0===ue&&xe(Z)),t}function qe(){var t,n;return t=re,le=re,(ie()?void 0:i)!==i?(e.substr(re,14)===b?(n=b,re+=14):(n=i,0===ue&&xe(ee)),n!==i?(le=t,t=Ye):(re=t,t=i)):(re=t,t=i),t}const{parseCursor:Ve,cursorSymbol:Ye,allowLeadingWildcards:Ge=!0,helpers:{nodeTypes:ze}}=t,We=ze.function.buildNodeWithArgumentNodes,Qe=ze.literal.buildNode,$e=ze.wildcard.buildNode,{wildcardSymbol:Je}=ze.wildcard;if((n=l())!==i&&re===e.length)return n;throw n!==i&&re<e.length&&xe({type:"end"}),he(ce,oe<e.length?e.charAt(oe):null,oe<e.length?be(oe,oe+1):be(oe,oe))}}},function(e,t,n){"use strict";var a=n(43);Object.defineProperty(t,"__esModule",{value:!0}),t.KbnFieldType=void 0;var i=a(n(19)),s=n(22);t.KbnFieldType=class KbnFieldType{constructor(e={}){(0,i.default)(this,"name",void 0),(0,i.default)(this,"sortable",void 0),(0,i.default)(this,"filterable",void 0),(0,i.default)(this,"esTypes",void 0),this.name=e.name||s.KBN_FIELD_TYPES.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}},function(e,t,n){e.exports=n(10)(3)},function(e,t,n){switch(window.__kbnThemeTag__){case"v8dark":return n(32);case"v8light":return n(34)}},function(e,t,n){var a=n(25),i=n(33);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};a(i,s);e.exports=i.locals||{}},function(e,t,n){(t=n(26)(!1)).push([e.i,".testScript__searchBar .globalQueryBar{padding:16px 0 0}\n",""]),e.exports=t},function(e,t,n){var a=n(25),i=n(35);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};a(i,s);e.exports=i.locals||{}},function(e,t,n){(t=n(26)(!1)).push([e.i,".testScript__searchBar .globalQueryBar{padding:16px 0 0}\n",""]),e.exports=t},function(e,t,n){e.exports=n(10)(14)},function(e,t,n){e.exports=n(10)(13)},function(e,t,n){e.exports=n(10)(4)},function(e,t,n){e.exports=n(10)(19)},function(e,t,n){e.exports=n(10)(2453)},function(e,t,n){e.exports=n(10)(2460)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ES_FIELD_TYPES",{enumerable:!0,get:function(){return s.ES_FIELD_TYPES}}),Object.defineProperty(t,"KBN_FIELD_TYPES",{enumerable:!0,get:function(){return s.KBN_FIELD_TYPES}}),Object.defineProperty(t,"KbnFieldType",{enumerable:!0,get:function(){return a.KbnFieldType}}),Object.defineProperty(t,"castEsToKbnFieldTypeName",{enumerable:!0,get:function(){return i.castEsToKbnFieldTypeName}}),Object.defineProperty(t,"getFilterableKbnTypeNames",{enumerable:!0,get:function(){return i.getFilterableKbnTypeNames}}),Object.defineProperty(t,"getKbnFieldType",{enumerable:!0,get:function(){return i.getKbnFieldType}}),Object.defineProperty(t,"getKbnTypeNames",{enumerable:!0,get:function(){return i.getKbnTypeNames}});var a=n(29),i=n(44),s=n(22)},function(e,t,n){e.exports=n(10)(1115)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getKbnTypeNames=t.getKbnFieldType=t.getFilterableKbnTypeNames=t.castEsToKbnFieldTypeName=void 0;var a=n(45),i=n(22);const s=(0,a.createKbnFieldTypes)();t.getKbnFieldType=e=>s.find((t=>t.name===e))||a.kbnFieldTypeUnknown;t.getKbnTypeNames=()=>s.filter((e=>e.name)).map((e=>e.name));t.castEsToKbnFieldTypeName=e=>{const t=s.find((t=>t.esTypes.includes(e)));return t&&t.name?t.name:i.KBN_FIELD_TYPES.UNKNOWN};t.getFilterableKbnTypeNames=()=>s.filter((e=>e.filterable)).map((e=>e.name))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kbnFieldTypeUnknown=t.createKbnFieldTypes=void 0;var a=n(29),i=n(22);const s=new a.KbnFieldType({name:i.KBN_FIELD_TYPES.UNKNOWN});t.kbnFieldTypeUnknown=s;t.createKbnFieldTypes=()=>[new a.KbnFieldType({name:i.KBN_FIELD_TYPES.STRING,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.STRING,i.ES_FIELD_TYPES.TEXT,i.ES_FIELD_TYPES.KEYWORD,i.ES_FIELD_TYPES.VERSION,i.ES_FIELD_TYPES._TYPE,i.ES_FIELD_TYPES._ID]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.NUMBER,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.FLOAT,i.ES_FIELD_TYPES.HALF_FLOAT,i.ES_FIELD_TYPES.SCALED_FLOAT,i.ES_FIELD_TYPES.DOUBLE,i.ES_FIELD_TYPES.INTEGER,i.ES_FIELD_TYPES.LONG,i.ES_FIELD_TYPES.UNSIGNED_LONG,i.ES_FIELD_TYPES.SHORT,i.ES_FIELD_TYPES.BYTE,i.ES_FIELD_TYPES.TOKEN_COUNT]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.FLOAT_RANGE,i.ES_FIELD_TYPES.DOUBLE_RANGE,i.ES_FIELD_TYPES.INTEGER_RANGE,i.ES_FIELD_TYPES.LONG_RANGE]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.DATE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.DATE,i.ES_FIELD_TYPES.DATE_NANOS]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.DATE_RANGE]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.IP,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.IP]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.IP_RANGE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.IP_RANGE]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.BOOLEAN,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.BOOLEAN]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.OBJECT,esTypes:[i.ES_FIELD_TYPES.OBJECT]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.NESTED,esTypes:[i.ES_FIELD_TYPES.NESTED]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.GEO_POINT,esTypes:[i.ES_FIELD_TYPES.GEO_POINT]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.GEO_SHAPE,esTypes:[i.ES_FIELD_TYPES.GEO_SHAPE]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.ATTACHMENT,esTypes:[i.ES_FIELD_TYPES.ATTACHMENT]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.MURMUR3,esTypes:[i.ES_FIELD_TYPES.MURMUR3]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES._SOURCE,esTypes:[i.ES_FIELD_TYPES._SOURCE]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.HISTOGRAM,filterable:!0,esTypes:[i.ES_FIELD_TYPES.HISTOGRAM]}),new a.KbnFieldType({name:i.KBN_FIELD_TYPES.CONFLICT}),s]},function(e,t,n){"use strict";n.r(t),n.d(t,"mountManagementSection",(function(){return na}));var a={};n.r(a),n.d(a,"buildNode",(function(){return wt})),n.d(a,"toElasticsearchQuery",(function(){return Lt}));var i={};n.r(i),n.d(i,"wildcardSymbol",(function(){return Ct})),n.d(i,"buildNode",(function(){return At})),n.d(i,"test",(function(){return kt})),n.d(i,"toElasticsearchQuery",(function(){return Bt})),n.d(i,"toQueryStringQuery",(function(){return Rt})),n.d(i,"hasLeadingWildcard",(function(){return Kt}));var s={};n.r(s),n.d(s,"buildNodeParams",(function(){return zt})),n.d(s,"toElasticsearchQuery",(function(){return Wt}));var r={};n.r(r),n.d(r,"buildNodeParams",(function(){return Qt})),n.d(r,"toElasticsearchQuery",(function(){return $t}));var l={};n.r(l),n.d(l,"buildNodeParams",(function(){return Jt})),n.d(l,"toElasticsearchQuery",(function(){return Zt}));var d={};n.r(d),n.d(d,"buildNodeParams",(function(){return Xt})),n.d(d,"toElasticsearchQuery",(function(){return en}));var o={};n.r(o),n.d(o,"buildNodeParams",(function(){return tn})),n.d(o,"toElasticsearchQuery",(function(){return nn}));var c={};n.r(c),n.d(c,"buildNodeParams",(function(){return an})),n.d(c,"toElasticsearchQuery",(function(){return sn}));var u={};n.r(u),n.d(u,"buildNodeParams",(function(){return rn})),n.d(u,"toElasticsearchQuery",(function(){return ln}));var p={};n.r(p),n.d(p,"buildNode",(function(){return on})),n.d(p,"buildNodeWithArgumentNodes",(function(){return cn})),n.d(p,"toElasticsearchQuery",(function(){return un}));var f=n(4),g=n.n(f),m=n(13),b=n.n(m),x=n(11),h=n(0),j=n(8),v=n(9),y=n(7);const O=h.i18n.translate("indexPatternManagement.editIndexPattern.list.defaultIndexPatternListName",{defaultMessage:"Default"}),F=h.i18n.translate("indexPatternManagement.editIndexPattern.list.rollupIndexPatternListName",{defaultMessage:"Rollup"}),E=(e="")=>"rollup"===e;const M=(e,t)=>{const n=[];return t&&n.push({key:"default",name:O}),E(e.type)&&n.push({key:"rollup",name:F}),n},P=(e,t)=>{var n;if(!E(e.type))return[];const a=null===(n=e.typeMeta)||void 0===n?void 0:n.aggs,i=a&&Object.keys(a).filter((e=>a[e][t.name]));return i&&i.length?["Rollup aggregations:"].concat(i.map((e=>{const n=a[e][t.name];switch(e){case"date_histogram":return h.i18n.translate("indexPatternManagement.editIndexPattern.list.dateHistogramSummary",{defaultMessage:"{aggName} (interval: {interval}, {delay} {time_zone})",values:{aggName:e,interval:n.fixed_interval,delay:n.delay?h.i18n.translate("indexPatternManagement.editIndexPattern.list.DateHistogramDelaySummary",{defaultMessage:"delay: {delay},",values:{delay:n.delay}}):"",time_zone:n.time_zone}});case"histogram":return h.i18n.translate("indexPatternManagement.editIndexPattern.list.histogramSummary",{defaultMessage:"{aggName} (interval: {interval})",values:{aggName:e,interval:n.interval}});default:return e}}))):[]};function T(){return[{text:h.i18n.translate("indexPatternManagement.dataViews.listBreadcrumb",{defaultMessage:"Data views"}),href:"/"}]}function S(e){return[...T(),{text:e.title,href:`/patterns/${e.id}`}]}var I=n(5);const _={initialPageSize:10,pageSizeOptions:[5,10,25,50]},w={sort:{field:"title",direction:"asc"}},L={box:{incremental:!0,schema:{fields:{title:{type:"string"}}}}},C=h.i18n.translate("indexPatternManagement.dataViewTable.title",{defaultMessage:"Data Views"}),D=h.i18n.translate("indexPatternManagement.indexPatternTable.badge.securityDataViewTitle",{defaultMessage:"Security Data View"}),N=Object(x.withRouter)((({history:e,canSave:t,showCreateDialog:n=!1})=>{const{setBreadcrumbs:a,uiSettings:i,indexPatternManagementStart:s,chrome:r,dataViews:l,IndexPatternEditor:d}=Object(v.useKibana)().services,[o,c]=Object(f.useState)([]),[u,p]=Object(f.useState)(!0),[m,b]=Object(f.useState)(n);a(T()),Object(f.useEffect)((()=>{!async function(){const e=await async function(e,t){return(await t.getIdsWithTitle(!0)).map((t=>{const{id:n,title:a}=t,i=e===n;return{id:n,title:a,default:i,tags:M(t,i),sort:`${i?"0":"1"}${a}`}})).sort(((e,t)=>e.sort<t.sort?-1:e.sort>t.sort?1:0))||[]}(i.get("defaultIndex"),l);c(e),p(!1),0!==e.length&&await l.hasUserDataView().catch((()=>!1))||b(!0)}()}),[s,i,l]),r.docTitle.change(C);const O="rollup"===new URLSearchParams(Object(x.useLocation)().search).get("type"),F=[{field:"title",name:h.i18n.translate("indexPatternManagement.dataViewTable.nameColumn",{defaultMessage:"Name"}),render:(t,n)=>Object(I.jsx)("div",null,Object(I.jsx)(y.EuiLink,Object(v.reactRouterNavigate)(e,`patterns/${n.id}`),t),n.id&&0===n.id.indexOf("security-solution")&&Object(I.jsx)(g.a.Fragment,null," ",Object(I.jsx)(y.EuiBadge,null,D)),n.tags&&n.tags.map((({key:e,name:t})=>Object(I.jsx)(g.a.Fragment,null," ",Object(I.jsx)(y.EuiBadge,{key:e},t))))),dataType:"string",sortable:({sort:e})=>e}],E=t?Object(I.jsx)(y.EuiButton,{fill:!0,iconType:"plusInCircle",onClick:()=>b(!0),"data-test-subj":"createIndexPatternButton"},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.dataViewTable.createBtn",defaultMessage:"Create data view"})):Object(I.jsx)(g.a.Fragment,null);if(u)return Object(I.jsx)(g.a.Fragment,null);const P=m?Object(I.jsx)(d,{onSave:t=>{e.push(`patterns/${t.id}`)},onCancel:()=>b(!1),defaultTypeIsRollup:O}):Object(I.jsx)(g.a.Fragment,null);return Object(I.jsx)("div",{"data-test-subj":"indexPatternTable",role:"region","aria-label":C},Object(I.jsx)(y.EuiPageHeader,{pageTitle:C,description:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.dataViewTable.indexPatternExplanation",defaultMessage:"Create and manage the data views that help you retrieve your data from Elasticsearch."}),bottomBorder:!0,rightSideItems:[E]}),Object(I.jsx)(y.EuiSpacer,{size:"l"}),Object(I.jsx)(y.EuiInMemoryTable,{allowNeutralSort:!1,itemId:"id",isSelectable:!1,items:o,columns:F,pagination:_,sorting:w,search:L}),P)}));var A=n(6),k=n.n(A),B=n(12),R=n(14),K=n(15);const U="indexedFields",H="scriptedFields",q="sourceFilters";var V=n(19),Y=n.n(V),G=n(24);const z=h.i18n.translate("indexPatternManagement.editIndexPattern.sourcePlaceholder",{defaultMessage:"field filter, accepts wildcards (e.g., `user*` to filter fields starting with 'user')"}),W=({onAddFilter:e})=>{const[t,n]=Object(f.useState)(""),a=Object(f.useCallback)((()=>{e(t),n("")}),[t,e]);return Object(I.jsx)(y.EuiFlexGroup,null,Object(I.jsx)(y.EuiFlexItem,{grow:10},Object(I.jsx)(y.EuiFieldText,{fullWidth:!0,value:t,onChange:e=>n(e.target.value.trim()),placeholder:z})),Object(I.jsx)(y.EuiFlexItem,null,Object(I.jsx)(y.EuiButton,{isDisabled:0===t.length,onClick:a},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.addButtonLabel",defaultMessage:"Add"}))))},Q=({filterToDeleteValue:e,onCancelConfirmationModal:t,onDeleteFilter:n})=>Object(I.jsx)(y.EuiConfirmModal,{title:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteSourceFilterLabel",defaultMessage:"Delete field filter '{value}'?",values:{value:e}}),onCancel:t,onConfirm:n,cancelButtonText:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.cancelButtonLabel",defaultMessage:"Cancel"}),buttonColor:"danger",confirmButtonText:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.deleteFilter.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:y.EUI_MODAL_CONFIRM_BUTTON}),$=()=>Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(y.EuiText,{size:"s"},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.sourceLabel",defaultMessage:"Field filters can be used to exclude one or more fields when fetching a document. This happens when viewing a document in the Discover app, or with a table displaying results from a saved search in the Dashboard app. If you have documents with large or unimportant fields you may benefit from filtering those out at this lower level."})),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.noteLabel",defaultMessage:"Note that multi-fields will incorrectly appear as matches in the table below. These filters only actually apply to fields in the original source document, so matching multi-fields are not actually being filtered."}))),Object(I.jsx)(y.EuiSpacer,{size:"s"})),J=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterHeader",{defaultMessage:"Filter"}),Z=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.filterDescription",{defaultMessage:"Filter name"}),X=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesHeader",{defaultMessage:"Matches"}),ee=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.matchesDescription",{defaultMessage:"Language used for the field"}),te=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.editAria",{defaultMessage:"Edit"}),ne=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.saveAria",{defaultMessage:"Save"}),ae=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.deleteAria",{defaultMessage:"Delete"}),ie=h.i18n.translate("indexPatternManagement.editIndexPattern.source.table.cancelAria",{defaultMessage:"Cancel"});class table_Table extends f.Component{constructor(e){super(e),Y()(this,"startEditingFilter",((e,t)=>this.setState({editingFilterId:e,editingFilterValue:t}))),Y()(this,"stopEditingFilter",(()=>this.setState({editingFilterId:""}))),Y()(this,"onEditingFilterChange",(e=>this.setState({editingFilterValue:e.target.value}))),Y()(this,"onEditFieldKeyDown",(({key:e})=>{y.keys.ENTER===e&&this.state.editingFilterId&&this.state.editingFilterValue&&(this.props.saveFilter({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()),y.keys.ESCAPE===e&&this.stopEditingFilter()})),this.state={editingFilterId:"",editingFilterValue:""}}getColumns(){const{deleteFilter:e,fieldWildcardMatcher:t,indexPattern:n,saveFilter:a}=this.props;return[{field:"value",name:J,description:Z,dataType:"string",sortable:!0,render:(e,t)=>this.state.editingFilterId&&this.state.editingFilterId===t.clientId?Object(I.jsx)(y.EuiFieldText,{autoFocus:!0,value:this.state.editingFilterValue,onChange:this.onEditingFilterChange,onKeyDown:this.onEditFieldKeyDown}):Object(I.jsx)("span",null,e)},{field:"value",name:X,description:ee,dataType:"string",sortable:!0,render:(e,a)=>{const i=t([this.state.editingFilterId===a.clientId?this.state.editingFilterValue:e]),s=n.getNonScriptedFields().map((e=>e.name)).filter(i).sort();return s.length?Object(I.jsx)("span",null,s.join(", ")):Object(I.jsx)("em",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.source.table.notMatchedLabel",defaultMessage:"The source filter doesn't match any known fields."}))}},{name:"",align:y.RIGHT_ALIGNMENT,width:"100",render:t=>this.state.editingFilterId===t.clientId?Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(y.EuiButtonIcon,{size:"s",onClick:()=>{a({clientId:this.state.editingFilterId,value:this.state.editingFilterValue}),this.stopEditingFilter()},iconType:"checkInCircleFilled","aria-label":ne}),Object(I.jsx)(y.EuiButtonIcon,{size:"s",onClick:()=>{this.stopEditingFilter()},iconType:"cross","aria-label":ie})):Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(y.EuiButtonIcon,{size:"s",onClick:()=>this.startEditingFilter(t.clientId,t.value),iconType:"pencil","aria-label":te}),Object(I.jsx)(y.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>e(t),iconType:"trash","aria-label":ae}))}]}render(){const{items:e,isSaving:t}=this.props,n=this.getColumns();return Object(I.jsx)(y.EuiInMemoryTable,{loading:t,items:e,columns:n,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}class source_filters_table_SourceFiltersTable extends f.Component{constructor(e){super(e),Y()(this,"clientSideId",0),Y()(this,"updateFilters",(()=>{const e=(this.props.indexPattern.sourceFilters||[]).map((e=>({...e,clientId:++this.clientSideId})));this.setState({filters:e})})),Y()(this,"getFilteredFilters",Object(G.createSelector)((e=>e.filters),((e,t)=>t.filterFilter),((e,t)=>{if(t){const n=t.toLowerCase();return e.filter((e=>e.value.toLowerCase().includes(n)))}return e}))),Y()(this,"startDeleteFilter",(e=>{this.setState({filterToDelete:e,isDeleteConfirmationModalVisible:!0})})),Y()(this,"hideDeleteConfirmationModal",(()=>{this.setState({filterToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),Y()(this,"deleteFilter",(async()=>{const{indexPattern:e,onAddOrRemoveFilter:t,saveIndexPattern:n}=this.props,{filterToDelete:a,filters:i}=this.state;e.sourceFilters=i.filter((e=>e.clientId!==a.clientId)),this.setState({isSaving:!0}),await n(e),t&&t(),this.updateFilters(),this.setState({isSaving:!1}),this.hideDeleteConfirmationModal()})),Y()(this,"onAddFilter",(async e=>{const{indexPattern:t,onAddOrRemoveFilter:n,saveIndexPattern:a}=this.props;t.sourceFilters=[...t.sourceFilters||[],{value:e}],this.setState({isSaving:!0}),await a(t),n&&n(),this.updateFilters(),this.setState({isSaving:!1})})),Y()(this,"saveFilter",(async({clientId:e,value:t})=>{const{indexPattern:n,saveIndexPattern:a}=this.props,{filters:i}=this.state;n.sourceFilters=i.map((n=>n.clientId===e?{value:t,clientId:e}:n)),this.setState({isSaving:!0}),await a(n),this.updateFilters(),this.setState({isSaving:!1})})),this.state={filterToDelete:void 0,isDeleteConfirmationModalVisible:!1,isSaving:!1,filters:[]}}UNSAFE_componentWillMount(){this.updateFilters()}render(){const{indexPattern:e,fieldWildcardMatcher:t}=this.props,{isSaving:n,filterToDelete:a}=this.state,i=this.getFilteredFilters(this.state,this.props);return Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)($,null),Object(I.jsx)(W,{onAddFilter:this.onAddFilter}),Object(I.jsx)(y.EuiSpacer,{size:"l"}),Object(I.jsx)(table_Table,{isSaving:n,indexPattern:e,items:i,fieldWildcardMatcher:t,deleteFilter:this.startDeleteFilter,saveFilter:this.saveFilter}),a&&Object(I.jsx)(Q,{filterToDeleteValue:a.value,onCancelConfirmationModal:this.hideDeleteConfirmationModal,onDeleteFilter:this.deleteFilter}))}}const se=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.additionalInfoAriaLabel",{defaultMessage:"Additional field information"}),re=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictDetailIconAria",{defaultMessage:"Conflict Detail"}),le=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeAriaLabel",{defaultMessage:"Primary time field"}),de=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.primaryTimeTooltip",{defaultMessage:"This field represents the time that events occurred."}),oe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.nameHeader",{defaultMessage:"Name"}),ce=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.typeHeader",{defaultMessage:"Type"}),ue=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.formatHeader",{defaultMessage:"Format"}),pe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableHeader",{defaultMessage:"Searchable"}),fe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.searchableDescription",{defaultMessage:"These fields can be used in the filter bar"}),ge=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isSearchableAria",{defaultMessage:"Is searchable"}),me=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableLabel",{defaultMessage:"Aggregatable"}),be=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.aggregatableDescription",{defaultMessage:"These fields can be used in visualization aggregations"}),xe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isAggregatableAria",{defaultMessage:"Is aggregatable"}),he=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedLabel",{defaultMessage:"Excluded"}),je=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.excludedDescription",{defaultMessage:"Fields that are excluded from _source when it is fetched"}),ve=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.isExcludedAria",{defaultMessage:"Is excluded"}),ye=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editLabel",{defaultMessage:"Edit"}),Oe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.editDescription",{defaultMessage:"Edit"}),Fe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteLabel",{defaultMessage:"Delete"}),Ee=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.deleteDescription",{defaultMessage:"Delete"}),Me=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.customLabelTooltip",{defaultMessage:"A custom label for the field."}),Pe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.runtimeIconTipTitle",{defaultMessage:"Runtime field"}),Te=h.i18n.translate("indexPatternManagement.editDataView.fields.table.runtimeIconTipText",{defaultMessage:"This field exists on the data view only."}),Se=h.i18n.translate("indexPatternManagement.editDataView.fields.table.conflictType",{defaultMessage:"Conflict"}),Ie=e=>{const t=[];return Object.keys(e).forEach((n=>{t.push({type:n,indices:e[n].slice(0,99).join(", ")})})),t},_e=[{field:"type",name:h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalTypeColumn",{defaultMessage:"Type"})},{field:"indices",name:h.i18n.translate("indexPatternManagement.editIndexPattern.fields.table.conflictModalIndicesColumn",{defaultMessage:"Indices"})}],we=(e,t,n,a)=>{const i=()=>{const i=n(Object(v.toMountPoint)((({closeFn:e,fieldName:t,conflictDescriptions:n})=>Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(y.EuiModalHeader,null,Object(I.jsx)(y.EuiModalHeaderTitle,null,Object(I.jsx)("h1",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.title",defaultMessage:"This field has a type conflict"})))),Object(I.jsx)(y.EuiModalBody,null,Object(I.jsx)(y.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.description",defaultMessage:"The type of the {fieldName} field changes across indices and might not be available for search, visualizations, and other analysis.",values:{fieldName:Object(I.jsx)(y.EuiCode,null,t)}})),Object(I.jsx)(y.EuiBasicTable,{tableCaption:"Demo of EuiBasicTable",items:Ie(n),rowHeader:"firstName",columns:_e,tableLayout:"auto"}))),Object(I.jsx)(y.EuiModalFooter,null,Object(I.jsx)(y.EuiButton,{onClick:e,fill:!0},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.fields.conflictModal.closeBtn",defaultMessage:"Close"})))))({closeFn:()=>{i.close()},fieldName:e,conflictDescriptions:t}),{theme$:a.theme$}))};return Object(I.jsx)("span",null,Object(I.jsx)(y.EuiBadge,{color:"warning",iconType:"alert",onClick:i,iconOnClick:i,iconOnClickAriaLabel:re,onClickAriaLabel:re},Se))};class table_table_Table extends f.PureComponent{renderBooleanTemplate(e,t){return e?Object(I.jsx)(y.EuiIcon,{type:"dot",color:"success","aria-label":t}):Object(I.jsx)("span",null)}renderFieldType(e,t){const n=t.conflictDescriptions&&t.conflictDescriptions[t.name];return Object(I.jsx)("span",null,"conflict"===e&&n?"":e,t.conflictDescriptions?we(t.name,t.conflictDescriptions,this.props.openModal,this.props.theme):"")}render(){const{items:e,editField:t,deleteField:n,indexPattern:a}=this.props,i=[{field:"displayName",name:oe,dataType:"string",sortable:!0,render:(e,t)=>((e,t)=>Object(I.jsx)("span",null,e.name,e.info&&e.info.length?Object(I.jsx)("span",null," ",Object(I.jsx)(y.EuiIconTip,{type:"questionInCircle",color:"primary","aria-label":se,content:e.info.map(((e,t)=>Object(I.jsx)("div",{key:t},e)))})):null,t===e.name?Object(I.jsx)("span",null," ",Object(I.jsx)(y.EuiIconTip,{type:"clock",color:"primary","aria-label":le,content:de})):null,!e.isMapped&&e.hasRuntime?Object(I.jsx)("span",null," ",Object(I.jsx)(y.EuiIconTip,{type:"indexRuntime",title:Pe,content:Object(I.jsx)("span",null,Te)})):null,e.customLabel&&e.customLabel!==e.name?Object(I.jsx)("div",null,Object(I.jsx)(y.EuiToolTip,{content:Me},Object(I.jsx)(y.EuiBadge,{iconType:"flag",iconSide:"left"},e.customLabel))):null))(t,a.timeFieldName),width:"38%","data-test-subj":"indexedFieldName"},{field:"type",name:ce,dataType:"string",sortable:!0,render:(e,t)=>this.renderFieldType(e,t),"data-test-subj":"indexedFieldType"},{field:"format",name:ue,dataType:"string",sortable:!0},{field:"searchable",name:pe,description:fe,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,ge)},{field:"aggregatable",name:me,description:be,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,xe)},{field:"excluded",name:he,description:je,dataType:"boolean",sortable:!0,render:e=>this.renderBooleanTemplate(e,ve)},{name:"",actions:[{name:ye,description:Oe,icon:"pencil",onClick:t,type:"icon","data-test-subj":"editFieldFormat",available:e=>e.isUserEditable}],width:"40px"},{name:"",actions:[{name:Fe,description:Ee,icon:"trash",onClick:e=>n(e.name),type:"icon","data-test-subj":"deleteField",available:e=>!e.isMapped&&e.isUserEditable}],width:"40px"}];return Object(I.jsx)(y.EuiInMemoryTable,{items:e,columns:i,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:{sort:{field:"displayName",direction:"asc"}}})}}class indexed_fields_table_IndexedFieldsTable extends f.Component{constructor(e){super(e),Y()(this,"getFilteredFields",Object(G.createSelector)((e=>e.fields),((e,t)=>t.fieldFilter),((e,t)=>t.indexedFieldTypeFilter),((e,t,n)=>{if(t){const n=t.toLowerCase();e=e.filter((e=>e.name.toLowerCase().includes(n)||e.displayName&&e.displayName.toLowerCase().includes(n)))}return n&&(e=e.filter((e=>{var t,a;return"conflict"===n&&"conflict"===e.kbnType||(null===(t=e.esTypes)||void 0===t?void 0:t.length)&&-1!==(null===(a=e.esTypes)||void 0===a?void 0:a.indexOf(n))}))),e}))),this.state={fields:this.mapFields(this.props.fields)}}UNSAFE_componentWillReceiveProps(e){e.fields!==this.props.fields&&this.setState({fields:this.mapFields(e.fields)})}mapFields(e){const{indexPattern:t,fieldWildcardMatcher:n,helpers:a,userEditPermission:i}=this.props,s=n(t.sourceFilters&&t.sourceFilters.map((e=>e.value))||[]);return e&&e.map((e=>{var n,r,l;return{...e.spec,type:(null===(n=e.esTypes)||void 0===n?void 0:n.join(", "))||"",kbnType:e.type,displayName:e.displayName,format:(null===(r=t.getFormatterForFieldNoDefault(e.name))||void 0===r||null===(l=r.type)||void 0===l?void 0:l.title)||"",excluded:!!s&&s(e.name),info:a.getFieldInfo&&a.getFieldInfo(t,e),isMapped:!!e.isMapped,isUserEditable:i,hasRuntime:!!e.runtimeField}}))||[]}render(){const{indexPattern:e}=this.props,t=this.getFilteredFields(this.state,this.props);return Object(I.jsx)("div",null,Object(I.jsx)(table_table_Table,{indexPattern:e,items:t,editField:e=>this.props.helpers.editField(e.name),deleteField:e=>this.props.helpers.deleteField(e),openModal:this.props.openModal,theme:this.props.theme}))}}class components_table_table_Table extends f.PureComponent{constructor(...e){super(...e),Y()(this,"renderFormatCell",(e=>{const{indexPattern:t}=this.props,n=Object(A.get)(t,["fieldFormatMap",e,"type","title"],"");return Object(I.jsx)("span",null,n)}))}render(){const{items:e,editField:t,deleteField:n}=this.props,a=[{field:"displayName",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameHeader",{defaultMessage:"Name"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.nameDescription",{defaultMessage:"Name of the field"}),dataType:"string",sortable:!0,width:"38%"},{field:"lang",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langHeader",{defaultMessage:"Lang"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.langDescription",{defaultMessage:"Language used for the field"}),dataType:"string",sortable:!0,"data-test-subj":"scriptedFieldLang"},{field:"script",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptHeader",{defaultMessage:"Script"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.scriptDescription",{defaultMessage:"Script for the field"}),dataType:"string",sortable:!0},{field:"name",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatHeader",{defaultMessage:"Format"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.formatDescription",{defaultMessage:"Format used for the field"}),render:this.renderFormatCell,sortable:!1},{name:"",actions:[{type:"icon",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editHeader",{defaultMessage:"Edit"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.editDescription",{defaultMessage:"Edit this field"}),icon:"pencil",onClick:t,available:e=>!!e.isUserEditable},{type:"icon",name:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteHeader",{defaultMessage:"Delete"}),description:h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.table.deleteDescription",{defaultMessage:"Delete this field"}),icon:"trash",color:"danger",onClick:n,available:e=>!!e.isUserEditable}],width:"40px"}];return Object(I.jsx)(y.EuiInMemoryTable,{items:e,columns:a,pagination:{initialPageSize:10,pageSizeOptions:[5,10,25,50]},sorting:!0})}}var Le=n(30),Ce=n.n(Le);const De=Object(x.withRouter)((({indexPatternId:e,history:t})=>{const{dataViews:n,docLinks:a}=Object(v.useKibana)().services,i=null==a?void 0:a.links,s=n.getCanSaveSync();return Object(I.jsx)(y.EuiFlexGroup,{alignItems:"center"},Object(I.jsx)(y.EuiFlexItem,null,Object(I.jsx)(y.EuiText,{size:"s"},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scriptedLabel",defaultMessage:"Scripted fields can be used in visualizations and displayed in documents. However, they cannot be searched."}),Object(I.jsx)("br",null),Object(I.jsx)(y.EuiIcon,{type:"alert",color:"warning",style:{marginRight:"4px"}}),Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.deprecation",defaultMessage:"Scripted fields are deprecated. Use {runtimeDocs} instead.",values:{runtimeDocs:Object(I.jsx)(y.EuiLink,{target:"_blank",href:i.runtimeFields.overview},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.header.runtimeLink",defaultMessage:"runtime fields"}))}})))),s&&Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiButton,Ce()({"data-test-subj":"addScriptedFieldLink"},Object(v.reactRouterNavigate)(t,`patterns/${e}/create-field/`)),Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.addFieldButton",defaultMessage:"Add scripted field"}))))})),Ne=({deprecatedLangsInUse:e,painlessDocLink:t})=>e.length?Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(y.EuiCallOut,{title:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangHeader",defaultMessage:"Deprecation languages in use"}),color:"danger",iconType:"cross"},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.deprecationLangDetail",defaultMessage:"The following deprecated languages are in use: {deprecatedLangsInUse}. Support for these languages will be removed in the next major version of Kibana and Elasticsearch. Convert you scripted fields to {link} to avoid any problems.",values:{deprecatedLangsInUse:e.join(", "),link:Object(I.jsx)(y.EuiLink,{href:t},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.scripted.deprecationLangLabel.painlessDescription",defaultMessage:"Painless"}))}}))),Object(I.jsx)(y.EuiSpacer,{size:"m"})):null,Ae=({field:e,hideDeleteConfirmationModal:t,deleteField:n})=>{const a=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteFieldLabel",{defaultMessage:"Delete scripted field '{fieldName}'?",values:{fieldName:e.name}}),i=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.cancelButton",{defaultMessage:"Cancel"}),s=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.deleteField.deleteButton",{defaultMessage:"Delete"});return Object(I.jsx)(y.EuiConfirmModal,{title:a,onCancel:t,onConfirm:n,cancelButtonText:i,confirmButtonText:s,defaultFocusedButton:y.EUI_MODAL_CONFIRM_BUTTON})};class scripted_fields_table_ScriptedFieldsTable extends f.Component{constructor(e){super(e),Y()(this,"fetchFields",(async()=>{const e=await this.props.indexPattern.getScriptedFields(),t=[],n=[],a=["painless"];for(const i of e){const e=i.lang;!n.includes(e)&&a.includes(e)||t.push(e)}this.setState({fields:e,deprecatedLangsInUse:t})})),Y()(this,"getFilteredItems",(()=>{const{fields:e}=this.state,{fieldFilter:t,scriptedFieldLanguageFilter:n,userEditPermission:a}=this.props;let i=e;n&&(i=e.filter((e=>e.lang===this.props.scriptedFieldLanguageFilter)));let s=i;if(t){const e=t.toLowerCase();s=i.filter((t=>t.name.toLowerCase().includes(e)))}return s.forEach((e=>e.isUserEditable=a)),s})),Y()(this,"startDeleteField",(e=>{this.setState({fieldToDelete:e,isDeleteConfirmationModalVisible:!0})})),Y()(this,"hideDeleteConfirmationModal",(()=>{this.setState({fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1})})),Y()(this,"deleteField",(()=>{const{indexPattern:e,onRemoveField:t,saveIndexPattern:n}=this.props,{fieldToDelete:a}=this.state;e.removeScriptedField(a.name),n(e),t&&t(),this.fetchFields(),this.hideDeleteConfirmationModal()})),this.state={deprecatedLangsInUse:[],fieldToDelete:void 0,isDeleteConfirmationModalVisible:!1,fields:[]}}UNSAFE_componentWillMount(){this.fetchFields()}render(){const{indexPattern:e,painlessDocLink:t}=this.props,{fieldToDelete:n,deprecatedLangsInUse:a}=this.state,i=this.getFilteredItems();return Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(De,{indexPatternId:e.id||""}),Object(I.jsx)(Ne,{deprecatedLangsInUse:a,painlessDocLink:t}),Object(I.jsx)(y.EuiSpacer,{size:"l"}),Object(I.jsx)(components_table_table_Table,{indexPattern:e,items:i,editField:e=>this.props.helpers.redirectToRoute(e),deleteField:this.startDeleteField}),n&&Object(I.jsx)(Ae,{deleteField:this.deleteField,field:n,hideDeleteConfirmationModal:this.hideDeleteConfirmationModal}))}}function ke(e,t,n=""){const a=Object(A.countBy)(function(e,t){const n=(t||"").toLowerCase();return e.filter((e=>e.name.toLowerCase().includes(n)))}(e,n),(function(e){return e.scripted?"scripted":"indexed"}));return Object(A.defaults)(a,{indexed:0,scripted:0,sourceFilters:t.excludes?t.excludes.filter((e=>e.toLowerCase().includes(n.toLowerCase()))).length:0}),a}function Be(e,t,n){let a="";switch(e){case"indexed":a=h.i18n.translate("indexPatternManagement.editIndexPattern.tabs.fieldsHeader",{defaultMessage:"Fields"});break;case"scripted":a=h.i18n.translate("indexPatternManagement.editIndexPattern.tabs.scriptedHeader",{defaultMessage:"Scripted fields"});break;case"sourceFilters":a=h.i18n.translate("indexPatternManagement.editIndexPattern.tabs.sourceHeader",{defaultMessage:"Field filters"})}return a+` (${t[e]===n[e]?t[e]:t[e]+" / "+n[e]})`}function Re(e,t){const n=ke(e.fields.getAll(),e.getSourceFiltering()),a=ke(e.fields.getAll(),e.getSourceFiltering(),t),i=[];return i.push({name:Be("indexed",a,n),id:U,"data-test-subj":"tab-indexedFields"}),(e=>!E(e.type))(e)&&i.push({name:Be("scripted",a,n),id:H,"data-test-subj":"tab-scriptedFields"}),i.push({name:Be("sourceFilters",a,n),id:q,"data-test-subj":"tab-sourceFilters"}),i}const Ke=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.allTypesDropDown",{defaultMessage:"All field types"}),Ue=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.allLangsDropDown",{defaultMessage:"All languages"});function He(e,t){return(e.length>0?[{value:"",text:"scriptedFieldLanguages"===t?Ue:Ke}]:[]).concat(Object(A.uniq)(e).map((e=>({value:e,text:e}))))}const qe=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.searchAria",{defaultMessage:"Search fields"}),Ve=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterAria",{defaultMessage:"Filter field types"}),Ye=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.filterPlaceholder",{defaultMessage:"Search"}),Ge=h.i18n.translate("indexPatternManagement.editIndexPattern.fields.addFieldButtonLabel",{defaultMessage:"Add field"});function ze({indexPattern:e,saveIndexPattern:t,fields:n,history:a,location:i,refreshFields:s}){const{uiSettings:r,docLinks:l,dataViewFieldEditor:d,overlays:o,theme:c,dataViews:u}=Object(v.useKibana)().services,[p,m]=Object(f.useState)(""),[b,x]=Object(f.useState)(""),[h,j]=Object(f.useState)(""),[O,F]=Object(f.useState)([]),[E,M]=Object(f.useState)([]),[T,S]=Object(f.useState)({getCurrentTab:()=>U}),_=Object(f.useRef)(),{DeleteRuntimeFieldProvider:w}=d,L=Object(f.useCallback)((()=>{const t=[],n=[];e.fields.getAll().forEach((e=>{e.scripted?e.lang&&n.push(e.lang):("conflict"===e.type&&t.push("conflict"),e.esTypes&&e.esTypes.forEach((e=>t.push(e))))})),F(He(t,"indexedFiledTypes")),M(He(n,"scriptedFieldLanguages"))}),[e]),C=Object(f.useCallback)((()=>{_.current&&_.current()}),[]),D=Object(f.useCallback)((t=>{_.current=d.openEditor({ctx:{dataView:e},onSave:s,fieldName:t})}),[d,e,s]);Object(f.useEffect)((()=>{L()}),[e,e.fields,L]),Object(f.useEffect)((()=>()=>{C()}),[C]);const N=Object(f.useCallback)((e=>Object(B.fieldWildcardMatcher)(e,r.get(R.META_FIELDS))),[r]),A=u.getCanSaveSync(),k=Object(f.useCallback)((e=>Object(I.jsx)(y.EuiFlexGroup,null,Object(I.jsx)(y.EuiFlexItem,{grow:!0},Object(I.jsx)(y.EuiFieldSearch,{fullWidth:!0,placeholder:Ye,value:p,onChange:e=>m(e.target.value),"data-test-subj":"indexPatternFieldFilter","aria-label":qe})),e===U&&O.length>0&&Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiSelect,{options:O,value:b,onChange:e=>x(e.target.value),"data-test-subj":"indexedFieldTypeFilterDropdown","aria-label":Ve})),A&&Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiButton,{fill:!0,onClick:()=>D(),"data-test-subj":"addField"},Ge))),e===H&&E.length>0&&Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiSelect,{options:E,value:h,onChange:e=>j(e.target.value),"data-test-subj":"scriptedFieldLanguageFilterDropdown"})))),[p,b,O,h,E,D,A]),V=Object(f.useCallback)((i=>{switch(i){case U:return Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiSpacer,{size:"m"}),k(i),Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(w,{dataView:e,onDelete:s},(t=>Object(I.jsx)(indexed_fields_table_IndexedFieldsTable,{fields:n,indexPattern:e,fieldFilter:p,fieldWildcardMatcher:N,indexedFieldTypeFilter:b,helpers:{editField:D,deleteField:t,getFieldInfo:P},openModal:o.openModal,theme:c,userEditPermission:u.getCanSaveSync()}))));case H:return Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiSpacer,{size:"m"}),k(i),Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(scripted_fields_table_ScriptedFieldsTable,{indexPattern:e,saveIndexPattern:t,fieldFilter:p,scriptedFieldLanguageFilter:h,helpers:{redirectToRoute:t=>{a.push(function(e,t){return`/dataView/${null==t?void 0:t.id}/field/${encodeURIComponent(e.name)}`}(t,e))}},onRemoveField:L,painlessDocLink:l.links.scriptedFields.painless,userEditPermission:u.getCanSaveSync()}));case q:return Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiSpacer,{size:"m"}),k(i),Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(source_filters_table_SourceFiltersTable,{saveIndexPattern:t,indexPattern:e,filterFilter:p,fieldWildcardMatcher:N,onAddOrRemoveFilter:L}))}}),[l.links.scriptedFields.painless,p,N,n,k,a,e,b,L,h,t,D,w,s,o,c,u]),Y=Object(f.useMemo)((()=>Re(e,p).map((e=>({...e,content:V(e.id)})))),[p,V,e]),[G,z]=Object(f.useState)(Y[0].id);return Object(f.useEffect)((()=>{const{startSyncingState:e,stopSyncingState:t,setCurrentTab:n,getCurrentTab:a}=function({defaultTab:e,useHashedUrl:t}){const n=Object(K.createHashHistory)(),a="_a",i={tab:e},s=Object(B.createKbnUrlStateStorage)({useHash:t,history:n}),r=s.get(a),l=Object(B.createStateContainer)({...i,...r},{setTab:e=>t=>({...e,tab:t})},{tab:e=>()=>e.tab}),{start:d,stop:o}=Object(B.syncState)({storageKey:a,stateContainer:{...l,set:e=>e&&l.set(e)},stateStorage:s});return s.set(a,l.getState(),{replace:!0}),{startSyncingState:d,stopSyncingState:o,setCurrentTab:e=>l.transitions.setTab(e),getCurrentTab:()=>l.selectors.tab()}}({useHashedUrl:r.get("state:storeInSessionStorage"),defaultTab:U});return e(),S({setCurrentTab:n,getCurrentTab:a}),z(a()),()=>{t()}}),[r]),Object(I.jsx)(y.EuiTabbedContent,{tabs:Y,selectedTab:Y.find((e=>e.id===G)),onTabClick:e=>{z(e.id),T.setCurrentTab(e.id)}})}const We=h.i18n.translate("indexPatternManagement.editDataView.setDefaultAria",{defaultMessage:"Set as default data view."}),Qe=h.i18n.translate("indexPatternManagement.editDataView.setDefaultTooltip",{defaultMessage:"Set as default data view."}),$e=h.i18n.translate("indexPatternManagement.editDataView.removeAria",{defaultMessage:"Delete data view."}),Je=h.i18n.translate("indexPatternManagement.editDataView.removeTooltip",{defaultMessage:"Delete data view."}),Ze=({defaultIndex:e,indexPattern:t,setDefault:n,deleteIndexPatternClick:a,children:i,canSave:s})=>Object(I.jsx)(y.EuiPageHeader,{pageTitle:Object(I.jsx)("span",{"data-test-subj":"indexPatternTitle"},t.title),rightSideItems:[e!==t.id&&n&&s&&Object(I.jsx)(y.EuiToolTip,{content:Qe},Object(I.jsx)(y.EuiButtonIcon,{color:"text",onClick:n,iconType:"starFilled","aria-label":We,"data-test-subj":"setDefaultIndexPatternButton"})),s&&Object(I.jsx)(y.EuiToolTip,{content:Je},Object(I.jsx)(y.EuiButtonIcon,{color:"danger",onClick:a,iconType:"trash","aria-label":$e,"data-test-subj":"deleteIndexPatternButton"}))].filter(Boolean)},i),Xe=h.i18n.translate("indexPatternManagement.editIndexPattern.timeFilterLabel.mappingAPILink",{defaultMessage:"field mappings"}),et=h.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictHeader",{defaultMessage:"Mapping conflict"}),tt={confirmButtonText:h.i18n.translate("indexPatternManagement.editIndexPattern.deleteButton",{defaultMessage:"Delete"}),title:h.i18n.translate("indexPatternManagement.editDataView.deleteHeader",{defaultMessage:"Delete data view?"})},nt=h.i18n.translate("indexPatternManagement.editIndexPattern.badge.securityDataViewTitle",{defaultMessage:"Security Data View"}),at=Object(x.withRouter)((({indexPattern:e,history:t,location:n})=>{const{uiSettings:a,overlays:i,chrome:s,dataViews:r}=Object(v.useKibana)().services,[l,d]=Object(f.useState)(e.getNonScriptedFields()),[o,c]=Object(f.useState)(e.fields.getAll().filter((e=>"conflict"===e.type))),[u,p]=Object(f.useState)(a.get("defaultIndex")),[m,b]=Object(f.useState)([]);Object(f.useEffect)((()=>{d(e.getNonScriptedFields()),c(e.fields.getAll().filter((e=>"conflict"===e.type)))}),[e]),Object(f.useEffect)((()=>{b(M(e,e.id===u))}),[u,e]);const x=Object(f.useCallback)((()=>{a.set("defaultIndex",e.id),p(e.id||"")}),[a,e.id]),O=h.i18n.translate("indexPatternManagement.editIndexPattern.timeFilterHeader",{defaultMessage:"Time field: '{timeFieldName}'",values:{timeFieldName:e.timeFieldName}}),F=h.i18n.translate("indexPatternManagement.editIndexPattern.mappingConflictLabel",{defaultMessage:"{conflictFieldsLength, plural, one {A field is} other {# fields are}} defined as several types (string, integer, etc) across the indices that match this pattern. You may still be able to use these conflict fields in parts of Kibana, but they will be unavailable for functions that require Kibana to know their type. Correcting this issue will require reindexing your data.",values:{conflictFieldsLength:o.length}}),E=h.i18n.translate("indexPatternManagement.editDataView.detailsAria",{defaultMessage:"Data view details"});s.docTitle.change(e.title);const P=Boolean(e.timeFieldName||m&&m.length>0),T=Object(v.useKibana)().services.docLinks.links.elasticsearch.mapping,S=r.getCanSaveSync();return Object(I.jsx)("div",{"data-test-subj":"editIndexPattern",role:"region","aria-label":E},Object(I.jsx)(Ze,{indexPattern:e,setDefault:x,deleteIndexPatternClick:()=>{i.openConfirm("",tt).then((n=>{n&&async function(){if(e.id===u){const t=await r.getIdsWithTitle();a.remove("defaultIndex");const n=Object(A.filter)(t,(t=>t.id!==e.id));n.length&&a.set("defaultIndex",n[0].id)}e.id&&Promise.resolve(r.delete(e.id)).then((function(){t.push("")}))}()}))},defaultIndex:u,canSave:S},P&&Object(I.jsx)(y.EuiFlexGroup,{wrap:!0,gutterSize:"s"},Boolean(e.timeFieldName)&&Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiBadge,{color:"warning"},O)),e.id&&0===e.id.indexOf("security-solution")&&Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiBadge,null,nt)),m.map((e=>Object(I.jsx)(y.EuiFlexItem,{grow:!1,key:e.key},Object(I.jsx)(y.EuiBadge,{color:"hollow"},e.name))))),Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(y.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editIndexPattern.timeFilterLabel.timeFilterDetail",defaultMessage:"View and edit fields in {indexPatternTitle}. Field attributes, such as type and searchability, are based on {mappingAPILink} in Elasticsearch.",values:{indexPatternTitle:Object(I.jsx)("strong",null,e.title),mappingAPILink:Object(I.jsx)(y.EuiLink,{href:T,target:"_blank",external:!0},Xe)}})," ")),o.length>0&&Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(y.EuiSpacer,null),Object(I.jsx)(y.EuiCallOut,{title:et,color:"warning",iconType:"alert"},Object(I.jsx)("p",null,F)))),Object(I.jsx)(y.EuiSpacer,null),Object(I.jsx)(ze,{indexPattern:e,saveIndexPattern:r.updateSavedObject.bind(r),fields:l,history:t,location:n,refreshFields:()=>{d(e.getNonScriptedFields())}}))})),it=Object(x.withRouter)((({...e})=>{const{dataViews:t,setBreadcrumbs:n}=Object(v.useKibana)().services,[a,i]=Object(f.useState)();return Object(f.useEffect)((()=>{t.get(e.match.params.id).then((e=>{i(e),n(S(e))}))}),[t,e.match.params.id,n]),a?Object(I.jsx)(at,{indexPattern:a}):Object(I.jsx)(g.a.Fragment,null)}));var st=n(16);const rt=({isVisible:e=!1})=>e?Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiCallOut,{title:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.disabledCallOutHeader",defaultMessage:"Scripting disabled",description:"Showing the status that scripting is disabled in Elasticsearch. Not an update message, that it JUST got disabled."}),color:"danger",iconType:"alert"},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.disabledCallOutLabel",defaultMessage:"All inline scripting has been disabled in Elasticsearch. You must enable inline scripting for at least one language in order to use scripted fields in Kibana."}))),Object(I.jsx)(y.EuiSpacer,{size:"m"})):null;rt.displayName="ScriptingDisabledCallOut";const lt=({isVisible:e=!1})=>{var t;const n=null===(t=Object(v.useKibana)().services.docLinks)||void 0===t?void 0:t.links;return e?Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiText,{size:"s"},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.callOutDetail",defaultMessage:"Familiarize yourself with {scripFields} and {scriptsInAggregation} before using this feature. Scripted fields can be used to display and aggregate calculated values. As such, they can be very slow and, if done incorrectly, can cause Kibana to become unusable.",values:{scripFields:Object(I.jsx)(y.EuiLink,{target:"_blank",href:n.scriptedFields.scriptFields},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scripFieldsLink",defaultMessage:"scripted fields"})),scriptsInAggregation:Object(I.jsx)(y.EuiLink,{target:"_blank",href:n.scriptedFields.scriptAggs},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.scriptsInAggregationLink",defaultMessage:"scripts in aggregations"}))}}))),Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(y.EuiCallOut,{color:"warning",iconType:"alert",title:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedTitle",defaultMessage:"Scripted fields are deprecated",description:"Deprecation warning title within scripted field editor"})},Object(I.jsx)(y.EuiText,{size:"s"},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.scriptedFieldsDeprecatedBody",defaultMessage:"For greater flexibility and Painless script support, use {runtimeDocs}.",values:{runtimeDocs:Object(I.jsx)(y.EuiLink,{target:"_blank",href:n.runtimeFields.overview},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.warningCallOutLabel.runtimeLink",defaultMessage:"runtime fields"}))}})))),Object(I.jsx)(y.EuiSpacer,{size:"m"})):null};lt.displayName="ScriptingWarningCallOut";const dt=()=>{var e;const t=null===(e=Object(v.useKibana)().services.docLinks)||void 0===e?void 0:e.links.scriptedFields;return Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiSpacer,null),Object(I.jsx)(y.EuiText,null,Object(I.jsx)("h3",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntaxHeader",defaultMessage:"Syntax"})),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.defaultDetail",defaultMessage:"By default, Kibana scripted fields use {painless}, a simple and secure scripting language designed specifically for use with Elasticsearch, to access values in the document use the following format:",values:{painless:Object(I.jsx)(y.EuiLink,{target:"_blank",href:t.painless},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.defaultLabel.painlessLink",defaultMessage:"Painless"})," ",Object(I.jsx)(y.EuiIcon,{type:"link"}))}})),Object(I.jsx)("p",null,Object(I.jsx)(y.EuiCode,null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.default.formatLabel",defaultMessage:"doc['some_field'].value"}))),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.painlessDetail",defaultMessage:"Painless is powerful but easy to use. It provides access to many {javaAPIs}. Read up on its {syntax} and you'll be up to speed in no time!",values:{javaAPIs:Object(I.jsx)(y.EuiLink,{target:"_blank",href:t.painlessApi},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.javaAPIsLink",defaultMessage:"native Java APIs"})," ",Object(I.jsx)(y.EuiIcon,{type:"link"})),syntax:Object(I.jsx)(y.EuiLink,{target:"_blank",href:t.painlessSyntax},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.painlessLabel.syntaxLink",defaultMessage:"syntax"})," ",Object(I.jsx)(y.EuiIcon,{type:"link"}))}})),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.kibanaLabel",defaultMessage:"Kibana currently imposes one special limitation on the painless scripts you write. They cannot contain named functions."})),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.commonDetail",defaultMessage:"Coming from an older version of Kibana? The {lucene} you know and love are still available. Lucene expressions are a lot like JavaScript, but limited to basic arithmetic, bitwise and comparison operations.",values:{lucene:Object(I.jsx)(y.EuiLink,{target:"_blank",href:t.luceneExpressions},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.commonLabel.luceneLink",defaultMessage:"Lucene Expressions"})," ",Object(I.jsx)(y.EuiIcon,{type:"link"}))}})),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limitsLabel",defaultMessage:"There are a few limitations when using Lucene Expressions:"})),Object(I.jsx)("ul",null,Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.typesLabel",defaultMessage:"Only numeric, boolean, date, and geo_point fields may be accessed"})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.fieldsLabel",defaultMessage:"Stored fields are not available"})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.limits.sparseLabel",defaultMessage:"If a field is sparse (only some documents contain a value), documents missing the field will have a value of 0"}))),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operationsLabel",defaultMessage:"Here are all the operations available to lucene expressions:"})),Object(I.jsx)("ul",null,Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.arithmeticLabel",defaultMessage:"Arithmetic operators: {operators}",values:{operators:Object(I.jsx)("code",null,"+ - * / %")}})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.bitwiseLabel",defaultMessage:"Bitwise operators: {operators}",values:{operators:Object(I.jsx)("code",null,"| & ^ ~ << >> >>>")}})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.booleanLabel",defaultMessage:"Boolean operators (including the ternary operator): {operators}",values:{operators:Object(I.jsx)("code",null,"&& || ! ?:")}})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.comparisonLabel",defaultMessage:"Comparison operators: {operators}",values:{operators:Object(I.jsx)("code",null,"< <= == >= >")}})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.mathLabel",defaultMessage:"Common mathematic functions: {operators}",values:{operators:Object(I.jsx)("code",null,"abs ceil exp floor ln log10 logn max min sqrt pow")}})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.trigLabel",defaultMessage:"Trigonometric library functions: {operators}",values:{operators:Object(I.jsx)("code",null,"acosh acos asinh asin atanh atan atan2 cosh cos sinh sin tanh tan")}})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.distanceLabel",defaultMessage:"Distance functions: {operators}",values:{operators:Object(I.jsx)("code",null,"haversin")}})),Object(I.jsx)("li",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.syntax.lucene.operations.miscellaneousLabel",defaultMessage:"Miscellaneous functions: {operators}",values:{operators:Object(I.jsx)("code",null,"min, max")}})))))};n(31);var ot,ct,ut=n(20),pt=n.n(ut),ft=n(27),gt=n.n(ft),mt=function(e,t){if("boolean"!=typeof t&&"boolean"===e.type){if([1,"true"].includes(t))return!0;if([0,"false"].includes(t))return!1;throw new Error("".concat(t," is not a valid boolean value for boolean field ").concat(e.name))}return"number"!=typeof t&&"number"===e.type?Number(t):t},bt=function(e){var t=Object(A.has)(e,"query.match_phrase"),n=Object(A.get)(e,"query.match",[]),a=void 0!==Object.values(n).find((function(e){return"phrase"===e.type}));return t||a},xt=function(e,t){var n=mt(e,t);return{script:{source:ht(e),lang:e.lang,params:{value:n}}}},ht=function(e){return"painless"===e.lang?"boolean compare(Supplier s, def v) {return s.get() == v;}"+"compare(() -> { ".concat(e.script," }, params.value);"):"(".concat(e.script,") == value")};!function(e){e.CUSTOM="custom",e.PHRASES="phrases",e.PHRASE="phrase",e.EXISTS="exists",e.MATCH_ALL="match_all",e.QUERY_STRING="query_string",e.RANGE="range",e.RANGE_FROM_VALUE="range_from_value",e.SPATIAL_FILTER="spatial_filter"}(ot||(ot={})),function(e){e.APP_STATE="appState",e.GLOBAL_STATE="globalState"}(ct||(ct={}));var jt={gt:">",gte:">=",lte:"<=",lt:"<"},vt={gt:"boolean gt(Supplier s, def v) {return s.get() > v}",gte:"boolean gte(Supplier s, def v) {return s.get() >= v}",lte:"boolean lte(Supplier s, def v) {return s.get() <= v}",lt:"boolean lt(Supplier s, def v) {return s.get() < v}"},yt={gt:"boolean gt(Supplier s, def v) {return s.get().toInstant().isAfter(Instant.parse(v))}",gte:"boolean gte(Supplier s, def v) {return !s.get().toInstant().isBefore(Instant.parse(v))}",lte:"boolean lte(Supplier s, def v) {return !s.get().toInstant().isAfter(Instant.parse(v))}",lt:"boolean lt(Supplier s, def v) {return s.get().toInstant().isBefore(Instant.parse(v))}"},Ot=function(e,t){var n=Object(A.mapValues)(Object(A.pickBy)(t,(function(e,t){return t in jt})),(function(t){return"number"===e.type&&"string"==typeof t?parseFloat(t):t})),a=Object(A.map)(n,(function(t,n){return"("+e.script+")"+Object(A.get)(jt,n)+n})).join(" && ");if("painless"===e.lang){var i="date"===e.type?yt:vt,s=Object(A.reduce)(n,(function(e,t,n){return e.concat(Object(A.get)(i,n))}),[]).join(" "),r=Object(A.map)(n,(function(t,n){return"".concat(n,"(() -> { ").concat(e.script," }, params.").concat(n,")")})).join(" && ");a="".concat(s).concat(r)}return{script:{source:a,params:n,lang:e.lang}}};var Ft=function(e){return function(e){return Object(A.has)(e,"query.exists")}(e)?function(e){return e.query.exists&&e.query.exists.field}(e):bt(e)?function(e){var t,n,a=null!==(t=null!==(n=e.query.match_phrase)&&void 0!==n?n:e.query.match)&&void 0!==t?t:{};return Object.keys(a)[0]}(e):function(e){var t;return(null==e||null===(t=e.meta)||void 0===t?void 0:t.type)===ot.PHRASES}(e)?function(e){return e.meta.key}(e):function(e){return Object(A.has)(e,"query.range")}(e)?function(e){return e.query.range&&Object.keys(e.query.range)[0]}(e):void 0};var Et=function(e){return Object(A.get)(e,"meta.disabled",!1)},Mt=function(e){return Object(A.omit)(e,["meta","$state"])};function Pt(e,t){if(function(e){var t,n,a=Object.keys(null!==(t=e.match||(null===(n=e.query)||void 0===n?void 0:n.match))&&void 0!==t?t:{})[0];return Boolean(a&&("phrase"===Object(A.get)(e,["query","match",a,"type"])||"phrase"===Object(A.get)(e,["match",a,"type"])))}(e)){var n=e.match||e.query.match,a=Object.keys(n)[0],i=Object(A.get)(n,[a]),s=i.query;if(t){var r=t.fields.find((function(e){return e.name===a}));r&&(s=mt(r,i.query))}return{meta:e.meta,$state:e.$state,query:{match_phrase:Y()({},a,Object(A.omit)(pt()(pt()({},i),{},{query:s}),"type"))}}}return e.query||(e.query={}),e.exists&&(e.query.exists=e.exists,delete e.exists),e.range&&(e.query.range=e.range,delete e.range),e.match_all&&(e.query.match_all=e.match_all,delete e.match_all),Object.keys(e).forEach((function(t){"meta"!==t&&"query"!==t&&"$state"!==t&&(e.query[t]=e[t],delete e[t])})),e}var Tt=n(23),St=n.n(Tt),It=n(21),_t=n.n(It);function wt(e){return{type:"literal",value:e}}function Lt(e){return e.value}var Ct="@kuery-wildcard@";function Dt(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Nt(e){return e.replace(/[+-=&|><!(){}[\]^"~*?:\\/]/g,"\\$&")}function At(e){return e.includes(Ct)?{type:"wildcard",value:e}:_n(e)}function kt(e,t){var n=e.value.split(Ct).map(Dt).join("[\\s\\S]*");return new RegExp("^".concat(n,"$")).test(t)}function Bt(e){return e.value.split(Ct).join("*")}function Rt(e){return e.value.split(Ct).map(Nt).join("*")}function Kt(e){var t=e.value;return t.startsWith(Ct)&&t.replace(Ct,"").length>0}function Ut(e,t){if(!t)return[];if("literal"===e.type){var n=Lt(e),a=t.fields.find((function(e){return e.name===n}));return a?[a]:[]}return"wildcard"===e.type?t.fields.filter((function(t){return kt(e,t.name)})):void 0}var Ht=n(17),qt=n.n(Ht);function Vt(e){var t=qt.a.tz.guess();return"Browser"===e?t:e}function Yt(e){return function(e){var t,n=null==e?void 0:e.subType;return!(null==n||null===(t=n.nested)||void 0===t||!t.path)}(e)?e.subType:void 0}function Gt(e,t,n){var a=pt()(pt()({},e),{},{value:n?"".concat(n,".").concat(e.value):e.value});if(!t||"wildcard"===a.type&&!n)return a;var i=Ut(a,t).reduce((function(e,t){var a=Yt(t),i=null==a?void 0:a.nested.path;return n&&!i?[].concat(St()(e),["".concat(t.name,' is not a nested field but is in nested group "').concat(n,'" in the KQL expression.')]):i&&!n?[].concat(St()(e),["".concat(t.name," is a nested field, but is not in a nested group in the KQL expression.")]):i!==n?[].concat(St()(e),["Nested field ".concat(t.name," is being queried with the incorrect nested path. The correct path is ").concat(null==a?void 0:a.nested.path,".")]):e}),[]);if(i.length>0)throw new Error(i.join("\n"));return a}function zt(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(A.isUndefined)(e))throw new Error("fieldName is a required argument");if(Object(A.isUndefined)(t))throw new Error("value is a required argument");var a="string"==typeof e?_n(e):wt(e),i="string"==typeof t?_n(t):wt(t),s=wt(n);return{arguments:[a,i,s]}}function Wt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=_t()(e.arguments,3),s=i[0],r=i[1],l=i[2],d="wildcard"===r.type&&r.value===Ct,o="wildcard"===s.type&&s.value===Ct,c=d&&o;if(c)return{match_all:{}};var u=Gt(s,t,null!=a&&a.nested?a.nested.path:void 0),p=Object(A.isUndefined)(r)?r:Ln(r),f=l.value?"phrase":"best_fields";if(null===u.value)return"wildcard"===r.type?{query_string:{query:Rt(r)}}:{multi_match:{type:f,query:p,lenient:!0}};var g=t?Ut(u,t):[];if(g&&0===g.length&&g.push({name:Ln(u),scripted:!1,type:""}),d&&(null==g||!g.length||(null==g?void 0:g.length)===(null==t?void 0:t.fields.length)))return{match_all:{}};var m=g.reduce((function(e,t){var i=function(e){var n=Yt(t);return"wildcard"!==u.type||null==n||!n.nested||null!=a&&a.nested?e:{nested:{path:n.nested.path,query:e,score_mode:"none"}}};if(!t.scripted){if(d)return[].concat(St()(e),[i({exists:{field:t.name}})]);if("wildcard"===r.type)return[].concat(St()(e),[i({query_string:{fields:[t.name],query:Rt(r)}})]);if("date"===t.type){var s=n.dateFormatTZ?{time_zone:Vt(n.dateFormatTZ)}:{};return[].concat(St()(e),[i({range:Y()({},t.name,pt()({gte:p,lte:p},s))})])}var l="phrase"===f?"match_phrase":"match";return[].concat(St()(e),[i(Y()({},l,Y()({},t.name,p)))])}if(!d)return[].concat(St()(e),[{script:pt()({},xt(t,p))}])}),[]);return{bool:{should:m||[],minimum_should_match:1}}}function Qt(e){return{arguments:e}}function $t(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=n.filtersInMustClause,s=e.arguments||[],r=i?"must":"filter";return{bool:Y()({},r,s.map((function(e){return Ln(e,t,n,a)})))}}function Jt(e){return{arguments:e}}function Zt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.arguments||[];return{bool:{should:i.map((function(e){return Ln(e,t,n,a)})),minimum_should_match:1}}}function Xt(e){return{arguments:[e]}}function en(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=_t()(e.arguments,1),s=i[0];return{bool:{must_not:Ln(s,t,n,a)}}}function tn(e,t,n){return{arguments:[_n(e),t,pn.literal.buildNode(n)]}}function nn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=_t()(e.arguments,3),s=i[0],r=i[1],l=i[2],d=Gt(s,t,null!=a&&a.nested?a.nested.path:void 0),o=t?Ut(d,t):[];o&&0===o.length&&o.push({name:Ln(d),scripted:!1,type:""});var c=o.map((function(e){var t=function(t){var n=Yt(e);return"wildcard"!==d.type||null==n||!n.nested||a.nested?t:{nested:{path:n.nested.path,query:t,score_mode:"none"}}},i=Y()({},r,Ln(l));if(e.scripted)return{script:Ot(e,i)};if("date"===e.type){var s=n.dateFormatTZ?{time_zone:Vt(n.dateFormatTZ)}:{};return t({range:Y()({},e.name,pt()(pt()({},i),s))})}return t({range:Y()({},e.name,i)})}));return{bool:{should:c,minimum_should_match:1}}}function an(e){return{arguments:[wt(e)]}}function sn(e,t){var n,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=_t()(e.arguments,1),s=i[0],r=pt()(pt()({},s),{},{value:null!=a&&a.nested?"".concat(a.nested.path,".").concat(s.value):s.value}),l=Lt(r),d=null==t||null===(n=t.fields)||void 0===n?void 0:n.find((function(e){return e.name===l}));if(null!=d&&d.scripted)throw new Error("Exists query does not support scripted fields");return{exists:{field:l}}}function rn(e,t){return{arguments:["string"==typeof e?_n(e):wt(e),t]}}function ln(e,t){var n,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=_t()(e.arguments,2),r=s[0],l=s[1],d=Ln(r),o=null!=i&&null!==(n=i.nested)&&void 0!==n&&n.path?"".concat(i.nested.path,".").concat(d):d;return{nested:{path:o,query:Ln(l,t,a,pt()(pt()({},i),{},{nested:{path:o}})),score_mode:"none"}}}var dn={is:s,and:r,or:l,not:d,range:o,exists:c,nested:u};function on(e){var t=dn[e];if(k.a.isUndefined(t))throw new Error('Unknown function "'.concat(e,'"'));for(var n=arguments.length,a=new Array(n>1?n-1:0),i=1;i<n;i++)a[i-1]=arguments[i];return pt()({type:"function",function:e},t.buildNodeParams.apply(t,a))}function cn(e,t){if(k.a.isUndefined(dn[e]))throw new Error('Unknown function "'.concat(e,'"'));return{type:"function",function:e,arguments:t}}function un(e,t,n,a){return dn[e.function].toElasticsearchQuery(e,t,n,a)}var pn={function:p,literal:a,wildcard:i},fn=n(36),gn=n.n(fn),mn=n(37),bn=n.n(mn),xn=n(38),hn=n.n(xn),jn=n(39),vn=n.n(jn),yn=n(40),On=n.n(yn),Fn=n(41),En=n.n(Fn),Mn=h.i18n.translate("esQuery.kql.errors.endOfInputText",{defaultMessage:"end of input"}),Pn={fieldName:h.i18n.translate("esQuery.kql.errors.fieldNameText",{defaultMessage:"field name"}),value:h.i18n.translate("esQuery.kql.errors.valueText",{defaultMessage:"value"}),literal:h.i18n.translate("esQuery.kql.errors.literalText",{defaultMessage:"literal"}),whitespace:h.i18n.translate("esQuery.kql.errors.whitespaceText",{defaultMessage:"whitespace"})},Tn=function(e){vn()(n,e);var t=On()(n);function n(e,a){var i;bn()(this,n);var s=e.message;if(e.expected){var r=e.expected.map((function(e){var t,n="other"===(t=e).type?t.description:"literal"===t.type?'"'.concat(t.text,'"'):"end"===t.type?"end of input":t.text||t.description||"";return Pn[n]||n})),l=Object(A.uniq)(r).filter((function(e){return void 0!==e})).sort().join(", ");s=h.i18n.translate("esQuery.kql.errors.syntaxError",{defaultMessage:"Expected {expectedList} but {foundInput} found.",values:{expectedList:l,foundInput:e.found?'"'.concat(e.found,'"'):Mn}})}var d=[s,a,Object(A.repeat)("-",e.location.start.offset)+"^"].join("\n");return i=t.call(this,d),Y()(hn()(i),"shortMessage",void 0),i.name="KQLSyntaxError",i.shortMessage=s,i}return gn()(n)}(En()(Error)),Sn=n(28),In=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Sn.parse;if(void 0===e)throw new Error("expression must be a string, got undefined instead");return n(e,pt()(pt()({},t),{},{helpers:{nodeTypes:pn}}))},_n=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return In(e,pt()(pt()({},t),{},{startRule:"Literal"}),Sn.parse)},wn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return In(e,t,Sn.parse)}catch(t){throw"SyntaxError"===t.name?new Tn(t,e):t}},Ln=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!t||!t.type||!pn[t.type])return e(pn.function.buildNode("and",[]),n);var s=pn[t.type];return s.toElasticsearchQuery(t,n,a,i)},Cn=function(){return Ln.apply(void 0,arguments)};function Dn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=t.map((function(e){return wn(e.query,{allowLeadingWildcards:n})}));return Nn(e,s,{dateFormatTZ:a,filtersInMustClause:i})}function Nn(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=pn.function.buildNode("and",t),i=Cn(a,e,n);return Object.assign({must:[],filter:[],should:[],must_not:[]},i.bool)}function An(e,t){var n,a;return null===(n=e.meta)||void 0===n||!n.key||!t||("custom"===(null===(a=e.meta)||void 0===a?void 0:a.type)?e.meta.index===t.id:t.fields.some((function(t){return t.name===e.meta.key})))}var kn=function(e,t){if(!t)return e;var n=Ft(e);if(!n)return e;var a=t.fields.find((function(e){return e.name===n})),i=a&&Yt(a);if(!i)return e;var s=Mt(e);return{meta:e.meta,query:{nested:{path:i.nested.path,query:s.query||s}}}},Bn=function(e){return function(t){return Object(A.isUndefined)(t.meta)||Object(A.isUndefined)(t.meta.negate)?!e:t.meta&&t.meta.negate===e}},Rn=function(e){return e.query||e},Kn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e=e.filter((function(e){return e&&!Et(e)}));var a=function(a){return e.filter((function(e){return!!e})).filter(Bn(a)).filter((function(e){return!n||An(e,t)})).map((function(e){return Pt(e,t)})).map((function(e){return kn(e,t)})).map(Mt).map(Rn)};return{must:[],filter:a(!1),should:[],must_not:a(!0)}};function Un(e,t,n){return function(e){return Object(A.has)(e,"query_string.query")}(e)&&("string"==typeof t&&(t=JSON.parse(t)),Object(A.extend)(e.query_string,t),n&&Object(A.defaults)(e.query_string,{time_zone:Vt(n)})),e}function Hn(e,t,n){return{must:(e||[]).map((function(e){return Un(function(e){return Object(A.isString)(e)?""===e.trim()?{match_all:{}}:{query_string:{query:e}}:e}(e.query),t,n)})),filter:[],should:[],must_not:[]}}function qn(e){return e.filter((function(e){return!e||"object"!==gt()(e)||!Object(A.isEqual)(e,{match_all:{}})}))}var Vn=n(18);class test_script_TestScript extends f.Component{constructor(...e){super(...e),Y()(this,"defaultProps",{name:"myScriptedField"}),Y()(this,"state",{isLoading:!1,additionalFields:[],previewData:void 0}),Y()(this,"previewScript",(async e=>{var t;const{indexPattern:n,name:a,script:i,executeScript:s}=this.props;if(!i||0===i.length)return;let r;if(this.setState({isLoading:!0}),e){const t=Object(Vn.getEsQueryConfig)(this.context.services.uiSettings);r=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{allowLeadingWildcards:!1,queryStringOptions:{},ignoreFilterIfFieldNotInIndex:!1};t=Array.isArray(t)?t:[t],n=Array.isArray(n)?n:[n];var i=t.filter((function(e){return Object(A.has)(e,"query")})),s=Object(A.groupBy)(i,"language"),r=Dn(e,s.kuery,a.allowLeadingWildcards,a.dateFormatTZ,a.filtersInMustClause),l=Hn(s.lucene,a.queryStringOptions,a.dateFormatTZ),d=Kn(n,e,a.ignoreFilterIfFieldNotInIndex);return{bool:{must:qn([].concat(St()(r.must),St()(l.must),St()(d.must))),filter:qn([].concat(St()(r.filter),St()(l.filter),St()(d.filter))),should:qn([].concat(St()(r.should),St()(l.should),St()(d.should))),must_not:[].concat(St()(r.must_not),St()(l.must_not),St()(d.must_not))}}}(this.props.indexPattern,e.query||[],[],t)}const l=await s({name:a,script:i,indexPatternTitle:n.title,query:r,additionalFields:this.state.additionalFields.map((e=>e.value)),http:this.context.services.http});200===l.status?this.setState({isLoading:!1,previewData:null===(t=l.hits)||void 0===t?void 0:t.hits.map((e=>({_id:e._id,...e._source,...e.fields})))}):this.setState({isLoading:!1,previewData:l})})),Y()(this,"onAdditionalFieldsChange",(e=>{this.setState({additionalFields:e})}))}componentDidMount(){this.props.script&&this.previewScript()}renderPreview(e){return e?e.error?Object(I.jsx)(y.EuiCallOut,{title:h.i18n.translate("indexPatternManagement.testScript.errorMessage",{defaultMessage:"There's an error in your script"}),color:"danger",iconType:"cross"},Object(I.jsx)(y.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e.error,null," "))):Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiTitle,{size:"xs"},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.testScript.resultsLabel",defaultMessage:"First 10 results"}))),Object(I.jsx)(y.EuiSpacer,{size:"s"}),Object(I.jsx)(y.EuiCodeBlock,{language:"json",className:"scriptPreviewCodeBlock","data-test-subj":"scriptedFieldPreview"},JSON.stringify(e,null," "))):null}renderToolbar(){const e=new Map,t=[];return this.props.indexPattern.fields.getAll().filter((e=>{const t=e.isSubtypeMulti();return!e.name.startsWith("_")&&!t&&!e.scripted})).forEach((t=>{if(e.has(t.type)){const n=e.get(t.type);n.push(t.name),e.set(t.type,n)}else e.set(t.type,[t.name])})),e.forEach(((e,n)=>{t.push({label:n,options:e.sort().map((e=>({value:e,label:e})))})})),t.sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0)),Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.testScript.fieldsLabel",{defaultMessage:"Additional fields"}),fullWidth:!0},Object(I.jsx)(y.EuiComboBox,{placeholder:h.i18n.translate("indexPatternManagement.testScript.fieldsPlaceholder",{defaultMessage:"Select..."}),options:t,selectedOptions:this.state.additionalFields,onChange:e=>this.onAdditionalFieldsChange(e),"data-test-subj":"additionalFieldsSelect",fullWidth:!0})),Object(I.jsx)("div",{className:"testScript__searchBar"},Object(I.jsx)(this.context.services.data.ui.SearchBar,{appName:"indexPatternManagement",showFilterBar:!1,showDatePicker:!1,showQueryInput:!0,query:this.context.services.data.query.queryString.getDefaultQuery(),onQuerySubmit:this.previewScript,indexPatterns:[this.props.indexPattern],customSubmitButton:Object(I.jsx)(y.EuiButton,{disabled:!this.props.script,isLoading:this.state.isLoading,"data-test-subj":"runScriptButton"},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.testScript.submitButtonLabel",defaultMessage:"Run script"}))})))}render(){return Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiSpacer,null),Object(I.jsx)(y.EuiText,null,Object(I.jsx)("h3",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.testScript.resultsTitle",defaultMessage:"Preview results"})),Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.testScript.instructions",defaultMessage:"Run your script to preview the first 10 results. You can also select some additional fields to include in your results to gain more context or add a query to filter on specific documents."}))),Object(I.jsx)(y.EuiSpacer,null),this.renderToolbar(),Object(I.jsx)(y.EuiSpacer,null),this.renderPreview(this.state.previewData))}}Y()(test_script_TestScript,"contextType",v.context);const Yn=({isVisible:e=!1,onClose:t=(()=>{}),indexPattern:n,lang:a,name:i,script:s,executeScript:r})=>{const l=[{id:"syntax",name:"Syntax","data-test-subj":"syntaxTab",content:Object(I.jsx)(dt,null)},{id:"test",name:"Preview results","data-test-subj":"testTab",content:Object(I.jsx)(test_script_TestScript,{indexPattern:n,lang:a,name:i,script:s,executeScript:r})}];return e?Object(I.jsx)(y.EuiFlyout,{onClose:t,"data-test-subj":"scriptedFieldsHelpFlyout"},Object(I.jsx)(y.EuiFlyoutBody,null,Object(I.jsx)(y.EuiTabbedContent,{tabs:l,initialSelectedTab:l[0]}))):null};Yn.displayName="ScriptingHelpFlyout";const Gn=Object(A.memoize)((e=>e?g.a.lazy((()=>e().then((e=>({default:e}))))):null));class field_format_editor_FieldFormatEditor extends f.PureComponent{constructor(e){super(e),this.state={EditorComponent:Gn(e.fieldFormatEditors.getById(e.fieldFormatId))}}static getDerivedStateFromProps(e){return{EditorComponent:Gn(e.fieldFormatEditors.getById(e.fieldFormatId))}}render(){const{EditorComponent:e}=this.state,{fieldType:t,fieldFormat:n,fieldFormatParams:a,onChange:i,onError:s}=this.props;return Object(I.jsx)(g.a.Fragment,null,e?Object(I.jsx)(g.a.Suspense,{fallback:Object(I.jsx)("div",{style:{minHeight:430,marginTop:8}},Object(I.jsx)(y.EuiDelayRender,null,Object(I.jsx)(y.EuiLoadingContent,{lines:4})))},Object(I.jsx)(e,{fieldType:t,format:n,formatParams:a,onChange:i,onError:s})):null)}}var zn=n(42);const Wn={painless:["number","string","date","boolean"],expression:["number"]},Qn=Object(zn.getKbnTypeNames)(),$n=async({name:e,script:t,indexPatternTitle:n,query:a,additionalFields:i=[],http:s})=>s.post("/internal/index-pattern-management/preview_scripted_field",{body:JSON.stringify({index:n,name:e,script:t,query:a,additionalFields:i})}).then((e=>({status:e.statusCode,hits:e.body.hits}))).catch((e=>({status:e.statusCode,error:e.body.attributes.error}))),Jn=(e,t,n)=>{const a=n.getByFieldType(e.type).map((({id:e,title:t})=>({id:e,title:t})));return[{id:"",defaultFieldFormat:t,title:h.i18n.translate("indexPatternManagement.defaultFormatDropDown",{defaultMessage:"- Default -"})},...a]};class field_editor_FieldEditor extends f.PureComponent{constructor(e,t){super(e,t),Y()(this,"supportedLangs",[]),Y()(this,"deprecatedLangs",[]),Y()(this,"onFieldChange",((e,t)=>{const{spec:n}=this.state;n[e]=t,this.forceUpdate()})),Y()(this,"onTypeChange",(e=>{const{fieldFormats:t}=this.context.services,{spec:n,format:a}=this.state,i=t.getDefaultType(e);n.type=e,this.setState({fieldTypeFormats:Jn(n,i,t),fieldFormatId:i.id,fieldFormatParams:a.params()})})),Y()(this,"onLangChange",(e=>{const{spec:t}=this.state,n=Object(A.get)(Wn,e,Qn);t.lang=e,t.type=n.includes(t.type)?t.type:n[0],this.setState({fieldTypes:n})})),Y()(this,"onFormatChange",((e,t)=>{const{fieldTypeFormats:n}=this.state,{uiSettings:a,fieldFormats:i}=this.context.services,s=new(i.getType(e||n[0].defaultFieldFormat.id))(t,(e=>a.get(e)));this.setState({fieldFormatId:e,fieldFormatParams:t,format:s})})),Y()(this,"onFormatParamsChange",(e=>{const{fieldFormatId:t}=this.state;this.onFormatChange(t,e)})),Y()(this,"onFormatParamsError",(e=>{this.setState({hasFormatError:!!e})})),Y()(this,"onScriptChange",(e=>{this.setState({hasScriptError:!1}),this.onFieldChange("script",e)})),Y()(this,"showScriptingHelp",(()=>{this.setState({showScriptingHelp:!0})})),Y()(this,"hideScriptingHelp",(()=>{this.setState({showScriptingHelp:!1})})),Y()(this,"renderDeleteModal",(()=>{const{spec:e}=this.state;return this.state.showDeleteModal?Object(I.jsx)(y.EuiConfirmModal,{title:h.i18n.translate("indexPatternManagement.deleteFieldHeader",{defaultMessage:"Delete field '{fieldName}'",values:{fieldName:e.name}}),onCancel:this.hideDeleteModal,onConfirm:()=>{this.hideDeleteModal(),this.deleteField()},cancelButtonText:h.i18n.translate("indexPatternManagement.deleteField.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:h.i18n.translate("indexPatternManagement.deleteField.deleteButton",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:y.EUI_MODAL_CONFIRM_BUTTON},Object(I.jsx)("p",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.deleteFieldLabel",defaultMessage:"You can't recover a deleted field.{separator}Are you sure you want to do this?",values:{separator:Object(I.jsx)("span",null,Object(I.jsx)("br",null),Object(I.jsx)("br",null))}}))):null})),Y()(this,"showDeleteModal",(()=>{this.setState({showDeleteModal:!0})})),Y()(this,"hideDeleteModal",(()=>{this.setState({showDeleteModal:!1})})),Y()(this,"renderScriptingPanels",(()=>{const{scriptingLangs:e,spec:t,showScriptingHelp:n}=this.state;if(t.scripted)return Object(I.jsx)(f.Fragment,null,Object(I.jsx)(rt,{isVisible:!e.length}),Object(I.jsx)(lt,{isVisible:!0}),Object(I.jsx)(Yn,{isVisible:n,onClose:this.hideScriptingHelp,indexPattern:this.props.indexPattern,lang:t.lang,name:t.name,script:t.script,executeScript:$n}))})),Y()(this,"deleteField",(()=>{const{redirectAway:e,indexPatternService:t}=this.props.services,{indexPattern:n}=this.props,{spec:a}=this.state;n.removeScriptedField(a.name),t.updateSavedObject(n).then((()=>{const t=h.i18n.translate("indexPatternManagement.deleteField.deletedHeader",{defaultMessage:"Deleted '{fieldName}'",values:{fieldName:a.name}});this.context.services.notifications.toasts.addSuccess(t),e()}))})),Y()(this,"saveField",(async()=>{const e=this.state.spec,{indexPattern:t}=this.props,{fieldFormatId:n,fieldFormatParams:a,customLabel:i}=this.state;if(e.scripted){this.setState({isSaving:!0});if(!await(async({name:e,script:t,indexPatternTitle:n,http:a})=>200===(await $n({name:e,script:t,indexPatternTitle:n,http:a})).status)({name:e.name,script:e.script,indexPatternTitle:t.title,http:this.context.services.http}))return void this.setState({hasScriptError:!0,isSaving:!1})}const{redirectAway:s,indexPatternService:r}=this.props.services;let l;return!!t.fields.getByName(e.name)?(l=t.fields.getByName(e.name).spec,t.fields.update(e)):t.fields.add(e),n?t.setFieldFormat(e.name,{id:n,params:a}):t.deleteFieldFormat(e.name),e.customLabel!==i&&(e.customLabel=i,t.fields.update(e)),r.updateSavedObject(t).then((()=>{const t=h.i18n.translate("indexPatternManagement.deleteField.savedHeader",{defaultMessage:"Saved '{fieldName}'",values:{fieldName:e.name}});this.context.services.notifications.toasts.addSuccess(t),s()})).catch((()=>{l?t.fields.update(l):t.fields.remove(e)}))}));const{spec:n,indexPattern:a}=e;this.state={isReady:!1,isCreating:!1,isDeprecatedLang:!1,scriptingLangs:[],fieldTypes:[],fieldTypeFormats:[],existingFieldNames:a.fields.getAll().map((e=>e.name)),fieldFormatId:void 0,fieldFormatParams:{},showScriptingHelp:!1,showDeleteModal:!1,hasFormatError:!1,hasScriptError:!1,isSaving:!1,format:e.indexPattern.getFormatterForField(n),spec:{...n},customLabel:""},this.supportedLangs=["painless"],this.deprecatedLangs=[],this.init(t)}async init(e){var t,n;const{http:a,notifications:i,fieldFormats:s}=e.services,{format:r,spec:l}=this.state,{indexPattern:d}=this.props,o=await((e,t)=>e.get("/api/kibana/scripts/languages").catch((()=>(t.addDanger(h.i18n.translate("indexPatternManagement.scriptingLanguages.errorFetchingToastDescription",{defaultMessage:"Error getting available scripting languages from Elasticsearch"})),[]))))(a,i.toasts),c=Object(A.intersection)(o,Object(A.union)(this.supportedLangs,this.deprecatedLangs));l.lang=l.lang&&c.includes(l.lang)?l.lang:void 0,l.scripted&&!l.lang&&(l.lang=c[0]);const u=Object(A.get)(Wn,l.lang||"",Qn);l.type=u.includes(l.type)?l.type:u[0];const p=s.getDefaultType(l.type,l.esTypes);this.setState({isReady:!0,isCreating:!d.fields.getByName(l.name),isDeprecatedLang:this.deprecatedLangs.includes(l.lang||""),errors:[],scriptingLangs:c,fieldTypes:u,fieldTypeFormats:Jn(l,p,s),fieldFormatId:null===(t=d.getFormatterForFieldNoDefault(l.name))||void 0===t||null===(n=t.type)||void 0===n?void 0:n.id,customLabel:l.customLabel||"",fieldFormatParams:r.params()})}isDuplicateName(){const{isCreating:e,spec:t,existingFieldNames:n}=this.state;return e&&n.includes(t.name)}renderName(){var e;const{isCreating:t,spec:n}=this.state,a=null==n||null===(e=n.name)||void 0===e?void 0:e.includes("*"),i=!n.name||!n.name.trim()||a;return t?Object(I.jsx)(y.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.nameLabel",{defaultMessage:"Name"}),helpText:this.isDuplicateName()?Object(I.jsx)("span",null,Object(I.jsx)(y.EuiIcon,{type:"alert",color:"warning",size:"s"})," ",Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictDetail",defaultMessage:"{mappingConflict} You already have a field with the name {fieldName}. Naming your scripted field with the same name means you won't be able to query both fields at the same time.",values:{mappingConflict:Object(I.jsx)("strong",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.mappingConflictLabel.mappingConflictLabel",defaultMessage:"Mapping Conflict:"})),fieldName:Object(I.jsx)(y.EuiCode,null,n.name)}})):null,isInvalid:i,error:i&&(a?h.i18n.translate("indexPatternManagement.starCharacterNotAllowedValidationErrorMessage",{defaultMessage:"The field cannot have * in the name."}):h.i18n.translate("indexPatternManagement.nameErrorMessage",{defaultMessage:"Name is required"}))},Object(I.jsx)(y.EuiFieldText,{value:n.name||"",placeholder:h.i18n.translate("indexPatternManagement.namePlaceholder",{defaultMessage:"New scripted field"}),"data-test-subj":"editorFieldName",onChange:e=>{this.onFieldChange("name",e.target.value)},isInvalid:i})):null}renderLanguage(){const{spec:e,scriptingLangs:t,isDeprecatedLang:n}=this.state;return e.scripted?Object(I.jsx)(y.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.languageLabel",{defaultMessage:"Language"}),helpText:n?Object(I.jsx)("span",null,Object(I.jsx)(y.EuiIcon,{type:"alert",color:"warning",size:"s"})," ",Object(I.jsx)("strong",null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.warningHeader",defaultMessage:"Deprecation Warning:"}))," ",Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.warningLabel.warningDetail",defaultMessage:"{language} is deprecated and support will be removed in the next major version of Kibana and Elasticsearch. We recommend using {painlessLink} for new scripted fields.",values:{language:Object(I.jsx)(y.EuiCode,null,e.lang),painlessLink:Object(I.jsx)(y.EuiLink,{target:"_blank",href:this.context.services.docLinks.links.scriptedFields.painless},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.warningLabel.painlessLinkLabel",defaultMessage:"Painless"}))}})):null},Object(I.jsx)(y.EuiSelect,{value:e.lang,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldLang",onChange:e=>{this.onLangChange(e.target.value)}})):null}renderType(){const{spec:e,fieldTypes:t}=this.state;return Object(I.jsx)(y.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"})},Object(I.jsx)(y.EuiSelect,{value:e.type,disabled:!e.scripted,options:t.map((e=>({value:e,text:e}))),"data-test-subj":"editorFieldType",onChange:e=>{this.onTypeChange(e.target.value)}}))}renderCustomLabel(){const{customLabel:e,spec:t}=this.state;return Object(I.jsx)(y.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.customLabel",{defaultMessage:"Custom label"}),helpText:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.labelHelpText",defaultMessage:"Set a custom label to use when this field is displayed in Discover, Maps, and Visualize. Queries and filters don't currently support a custom label and will use the original field name."})},Object(I.jsx)(y.EuiFieldText,{value:e||"",placeholder:t.name,"data-test-subj":"editorFieldCustomLabel",onChange:e=>{this.setState({customLabel:e.target.value})}}))}renderTypeConflict(){const{spec:e}=this.state;if(!e.conflictDescriptions||"object"!=typeof e.conflictDescriptions)return null;const t=[{field:"type",name:h.i18n.translate("indexPatternManagement.typeLabel",{defaultMessage:"Type"}),width:"100px"},{field:"indices",name:h.i18n.translate("indexPatternManagement.indexNameLabel",{defaultMessage:"Index names"})}],n=Object.entries(e.conflictDescriptions).map((([e,t])=>({type:e,indices:Array.isArray(t)?t.join(", "):"Index names unavailable"})));return Object(I.jsx)("div",null,Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(y.EuiCallOut,{color:"warning",iconType:"alert",title:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.fieldTypeConflict",defaultMessage:"Field type conflict"}),size:"s"},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.multiTypeLabelDesc",defaultMessage:"The type of this field changes across indices. It is unavailable for many analysis functions. The indices per type are as follows:"})),Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(y.EuiBasicTable,{items:n,columns:t}),Object(I.jsx)(y.EuiSpacer,{size:"m"}))}renderFormat(){const{spec:e,fieldTypeFormats:t,fieldFormatId:n,fieldFormatParams:a,format:i}=this.state,{fieldFormatEditors:s}=this.context.services,r=t[0].defaultFieldFormat.title,l=r?Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.defaultFormatHeader",defaultMessage:"Format (Default: {defaultFormat})",values:{defaultFormat:Object(I.jsx)(y.EuiCode,null,r)}}):Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.formatHeader",defaultMessage:"Format"});return Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiFormRow,{label:l,helpText:Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.formatLabel",defaultMessage:"Formatting controls how values are displayed. Changing this setting might also affect the field value and highlighting in Discover."})},Object(I.jsx)(y.EuiSelect,{value:n,options:t.map((e=>({value:e.id||"",text:e.title}))),"data-test-subj":"editorSelectedFormatId",onChange:e=>{this.onFormatChange(e.target.value)}})),n?Object(I.jsx)(field_format_editor_FieldFormatEditor,{fieldType:e.type,fieldFormat:i,fieldFormatId:n,fieldFormatParams:a||{},fieldFormatEditors:s,onChange:this.onFormatParamsChange,onError:this.onFormatParamsError}):null)}renderPopularity(){const{spec:e}=this.state;return Object(I.jsx)(y.EuiFormRow,{label:h.i18n.translate("indexPatternManagement.popularityLabel",{defaultMessage:"Popularity",description:'"Popularity" refers to Kibana\'s measurement how popular a field is (i.e. how commonly it is used).'})},Object(I.jsx)(y.EuiFieldNumber,{value:e.count,"data-test-subj":"editorFieldCount",onChange:e=>{this.onFieldChange("count",e.target.value?Number(e.target.value):"")}}))}renderScript(){var e;const{spec:t,hasScriptError:n}=this.state,a=!t.script||!t.script.trim()||n,i=n?Object(I.jsx)("span",{"data-test-subj":"invalidScriptError"},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.scriptInvalidErrorMessage",defaultMessage:"Script is invalid. View script preview for details"})):Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.scriptRequiredErrorMessage",defaultMessage:"Script is required"});return t.scripted?Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiFormRow,{fullWidth:!0,label:h.i18n.translate("indexPatternManagement.scriptLabel",{defaultMessage:"Script"}),isInvalid:a,error:a?i:null},Object(I.jsx)(v.CodeEditor,{languageId:st.PainlessLang.ID,width:"100%",height:"300px",value:null!==(e=t.script)&&void 0!==e?e:"",onChange:this.onScriptChange,"data-test-subj":"editorFieldScript","aria-label":h.i18n.translate("indexPatternManagement.scriptLabelAriaLabel",{defaultMessage:"Script editor"})})),Object(I.jsx)(y.EuiFormRow,null,Object(I.jsx)(f.Fragment,null,Object(I.jsx)(y.EuiText,null,Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.script.accessWithLabel",defaultMessage:"Access fields with {code}.",values:{code:Object(I.jsx)("code",null,"doc['some_field'].value")}})),Object(I.jsx)("br",null),Object(I.jsx)(y.EuiLink,{onClick:this.showScriptingHelp,"data-test-subj":"scriptedFieldsHelpLink"},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.script.getHelpLabel",defaultMessage:"Get help with the syntax and preview the results of your script."}))))):null}renderActions(){const{isCreating:e,spec:t,isSaving:n}=this.state,{redirectAway:a}=this.props.services;return Object(I.jsx)(y.EuiFormRow,null,Object(I.jsx)(y.EuiFlexGroup,null,Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiButton,{fill:!0,onClick:this.saveField,isDisabled:this.isSavingDisabled(),isLoading:n,"data-test-subj":"fieldSaveButton"},e?Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.actions.createButton",defaultMessage:"Create field"}):Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.actions.saveButton",defaultMessage:"Save field"}))),Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiButtonEmpty,{onClick:a,"data-test-subj":"fieldCancelButton"},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.actions.cancelButton",defaultMessage:"Cancel"}))),!e&&t.scripted?Object(I.jsx)(y.EuiFlexItem,null,Object(I.jsx)(y.EuiFlexGroup,{justifyContent:"flexEnd"},Object(I.jsx)(y.EuiFlexItem,{grow:!1},Object(I.jsx)(y.EuiButtonEmpty,{color:"danger",onClick:this.showDeleteModal},Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.actions.deleteButton",defaultMessage:"Delete"}))))):null))}isSavingDisabled(){const{spec:e,hasFormatError:t,hasScriptError:n}=this.state;return!(!t&&!n&&e.name&&e.name.trim()&&(!e.scripted||e.script&&e.script.trim()))}render(){const{isReady:e,isCreating:t,spec:n}=this.state;return e?Object(I.jsx)("div",null,Object(I.jsx)(y.EuiText,null,Object(I.jsx)("h3",null,t?Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.createHeader",defaultMessage:"Create scripted field"}):Object(I.jsx)(j.FormattedMessage,{id:"indexPatternManagement.editHeader",defaultMessage:"Edit {fieldName}",values:{fieldName:n.name}}))),Object(I.jsx)(y.EuiSpacer,{size:"m"}),Object(I.jsx)(y.EuiForm,null,this.renderScriptingPanels(),this.renderName(),this.renderCustomLabel(),this.renderLanguage(),this.renderType(),this.renderTypeConflict(),this.renderFormat(),this.renderPopularity(),this.renderScript(),this.renderActions(),this.renderDeleteModal()),Object(I.jsx)(y.EuiSpacer,{size:"l"})):null}}Y()(field_editor_FieldEditor,"contextType",v.context);const Zn=h.i18n.translate("indexPatternManagement.editIndexPattern.scripted.newFieldPlaceholder",{defaultMessage:"New Scripted Field"}),Xn=Object(x.withRouter)((({indexPattern:e,mode:t,fieldName:n,history:a})=>{var i;const{uiSettings:s,chrome:r,notifications:l,dataViews:d}=Object(v.useKibana)().services,o="edit"===t&&n?null===(i=e.fields.getByName(n))||void 0===i?void 0:i.spec:{scripted:!0,type:"number",name:void 0},c=`/dataView/${e.id}`;if("edit"===t&&!o){const t=h.i18n.translate("indexPatternManagement.editDataView.scripted.noFieldLabel",{defaultMessage:"'{dataViewTitle}' data view doesn't have a scripted field called '{fieldName}'",values:{dataViewTitle:e.title,fieldName:n}});l.toasts.addWarning(t),a.push(c)}const u=(null==o?void 0:o.name)||Zn;r.docTitle.change([u,e.title]);const p=()=>{a.push(`${c}#/?_a=(tab:${null!=o&&o.scripted?H:U})`)};return o?Object(I.jsx)(g.a.Fragment,null,Object(I.jsx)(Ze,{indexPattern:e,defaultIndex:s.get("defaultIndex"),canSave:d.getCanSaveSync()}),Object(I.jsx)(y.EuiSpacer,{size:"l"}),Object(I.jsx)(field_editor_FieldEditor,{indexPattern:e,spec:o,services:{indexPatternService:d,redirectAway:p}})):Object(I.jsx)(g.a.Fragment,null)})),ea=Object(x.withRouter)((({...e})=>{const{setBreadcrumbs:t,dataViews:n}=Object(v.useKibana)().services,[a,i]=Object(f.useState)(),s=e.match.params.fieldName&&decodeURIComponent(e.match.params.fieldName);return Object(f.useEffect)((()=>{n.get(e.match.params.id).then((e=>{i(e),e&&t(s?function(e,t){return[...S(e),{text:t}]}(e,s):function(e){return[...S(e),{text:h.i18n.translate("indexPatternManagement.indexPatterns.createFieldBreadcrumb",{defaultMessage:"Create field"})}]}(e))}))}),[e.match.params.id,s,t,n]),a?Object(I.jsx)(Xn,{indexPattern:a,mode:s?"edit":"create",fieldName:s}):Object(I.jsx)(g.a.Fragment,null)})),ta={text:h.i18n.translate("indexPatternManagement.indexPatterns.badge.readOnly.text",{defaultMessage:"Read only"}),tooltip:h.i18n.translate("indexPatternManagement.dataViews.badge.readOnly.tooltip",{defaultMessage:"Unable to save data views"}),iconType:"glasses"};async function na(e,t){const[{chrome:n,uiSettings:a,notifications:i,overlays:s,http:r,docLinks:l,theme:d},{data:o,dataViewFieldEditor:c,dataViewEditor:u,dataViews:p,fieldFormats:f},g]=await e(),m=p.getCanSaveSync();m||n.setBadge(ta);const h={chrome:n,uiSettings:a,notifications:i,overlays:s,http:r,docLinks:l,data:o,dataViewFieldEditor:c,dataViews:p,indexPatternManagementStart:g,setBreadcrumbs:t.setBreadcrumbs,fieldFormatEditors:c.fieldFormatEditors,IndexPatternEditor:u.IndexPatternEditorComponent,fieldFormats:f};return b.a.render(Object(I.jsx)(v.KibanaContextProvider,{services:h},Object(I.jsx)(v.KibanaThemeProvider,{theme$:d.theme$},Object(I.jsx)(j.I18nProvider,null,Object(I.jsx)(x.Router,{history:t.history},Object(I.jsx)(x.Switch,null,Object(I.jsx)(x.Route,{path:["/create"]},Object(I.jsx)(N,{canSave:m,showCreateDialog:!0})),Object(I.jsx)(x.Route,{path:["/dataView/:id/field/:fieldName","/dataView/:id/create-field/"]},Object(I.jsx)(ea,null)),Object(I.jsx)(x.Route,{path:["/dataView/:id"]},Object(I.jsx)(it,null)),Object(I.jsx)(x.Redirect,{path:"/patterns*",to:"dataView*"}),Object(I.jsx)(x.Route,{path:["/"]},Object(I.jsx)(N,{canSave:m}))))))),t.element),()=>{n.docTitle.reset(),b.a.unmountComponentAtNode(t.element)}}}])]);