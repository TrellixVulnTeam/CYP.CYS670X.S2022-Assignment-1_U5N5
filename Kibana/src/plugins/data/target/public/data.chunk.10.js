(window.data_bundle_jsonpfunction=window.data_bundle_jsonpfunction||[]).push([[10],{139:function(e,t,a){"use strict";a.r(t);var o=a(3),s=a.n(o),r=a(4),n=a.n(r),l=a(17),i=a(14),d=a(0);class data_table_DataTableFormat extends r.Component{constructor(...e){super(...e),s()(this,"csvSeparator",this.props.uiSettings.get("csv:separator",",")),s()(this,"quoteValues",this.props.uiSettings.get("csv:quoteValues",!0)),s()(this,"state",{})}static renderCell({table:e,columnIndex:t,rowIndex:a,formattedValue:o,uiActions:s,isFilterable:r}){const c=e.columns[t];return n.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"s",alignItems:"center"},n.a.createElement(i.EuiFlexItem,{grow:!1},o),n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(i.EuiFlexGroup,{responsive:!1,gutterSize:"none",alignItems:"center"},r&&n.a.createElement(i.EuiToolTip,{position:"bottom",content:n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.filterForValueButtonTooltip",defaultMessage:"Filter for value"})},n.a.createElement(i.EuiButtonIcon,{iconType:"plusInCircle",color:"text","aria-label":d.i18n.translate("data.inspector.table.filterForValueButtonAriaLabel",{defaultMessage:"Filter for value"}),"data-test-subj":"filterForInspectorCellValue",className:"insDataTableFormat__filter",onClick:()=>{const o=e.rows[a][c.id],r={table:e,column:t,row:a,value:o};s.executeTriggerActions("VALUE_CLICK_TRIGGER",{data:{data:[r]}})}})),r&&n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(i.EuiToolTip,{position:"bottom",content:n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.filterOutValueButtonTooltip",defaultMessage:"Filter out value"})},n.a.createElement(i.EuiButtonIcon,{iconType:"minusInCircle",color:"text","aria-label":d.i18n.translate("data.inspector.table.filterOutValueButtonAriaLabel",{defaultMessage:"Filter out value"}),"data-test-subj":"filterOutInspectorCellValue",className:"insDataTableFormat__filter",onClick:()=>{const o=e.rows[a][c.id],r={table:e,column:t,row:a,value:o};s.executeTriggerActions("VALUE_CLICK_TRIGGER",{data:{data:[r],negate:!0}})}}))))))}static getDerivedStateFromProps({data:e,uiActions:t,fieldFormats:a,isFilterable:o}){if(!e)return{columns:null,rows:null};return{columns:e.columns.map(((s,r)=>{const n={id:"string",...s.meta.params},l=a.deserialize(n),i=o(s);return{name:s.name,field:s.id,sortable:!0,render:a=>{const o=l.convert(a),n=e.rows.findIndex((e=>e[s.id]===a))||0;return data_table_DataTableFormat.renderCell({table:e,columnIndex:r,rowIndex:n,formattedValue:o,uiActions:t,isFilterable:i})}}})),rows:e.rows}}render(){const{columns:e,rows:t}=this.state;return n.a.createElement(i.EuiInMemoryTable,{className:"insDataTableFormat__table","data-test-subj":"inspectorTable",columns:e,items:t,sorting:!0,pagination:{pageSizeOptions:[10,20,50],initialPageSize:20}})}}class data_table_selector_TableSelector extends r.Component{constructor(...e){super(...e),s()(this,"state",{isPopoverOpen:!1}),s()(this,"togglePopover",(()=>{this.setState((e=>({isPopoverOpen:!e.isPopoverOpen})))})),s()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),s()(this,"renderTableDropdownItem",((e,t)=>n.a.createElement(i.EuiContextMenuItem,{key:t,icon:e===this.props.selectedTable?"check":"empty",onClick:()=>{this.props.onTableChanged(e),this.closePopover()},"data-test-subj":`inspectorTableChooser${t}`},n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.tableLabel",defaultMessage:"Table {index}",values:{index:t+1}}))))}render(){const e=this.props.tables.findIndex((e=>e===this.props.selectedTable));return n.a.createElement(i.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement("strong",null,n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.tableSelectorLabel",defaultMessage:"Selected:"}))),n.a.createElement(i.EuiFlexItem,{grow:!0},n.a.createElement(i.EuiPopover,{id:"inspectorTableChooser",button:n.a.createElement(i.EuiButtonEmpty,{iconType:"arrowDown",iconSide:"right",size:"s",onClick:this.togglePopover,"data-test-subj":"inspectorTableChooser"},n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.tableLabel",defaultMessage:"Table {index}",values:{index:e+1}})),isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downLeft",repositionOnScroll:!0},n.a.createElement(i.EuiContextMenuPanel,{items:this.props.tables.map(this.renderTableDropdownItem),"data-test-subj":"inspectorTableChooserMenuPanel"}))))}}var c=a(1),p=a(2),u=a(114);const m=Object(c.memoize)((e=>e.some((({columns:e,rows:t})=>Object(p.tableHasFormulas)(e,t)))));class download_options_DataDownloadOptions extends r.Component{constructor(...e){super(...e),s()(this,"state",{isPopoverOpen:!1}),s()(this,"onTogglePopover",(()=>{this.setState((e=>({isPopoverOpen:!e.isPopoverOpen})))})),s()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),s()(this,"exportCsv",((e=!0)=>{let t=this.props.title;t&&0!==t.length||(t=d.i18n.translate("data.inspector.table.downloadOptionsUnsavedFilename",{defaultMessage:"unsaved"}));const a=this.props.datatables.reduce(((a,o,s)=>{if(o){const r=this.props.datatables.length>1?`-${s+1}`:"";a[`${t}${r}.csv`]={content:Object(p.datatableToCSV)(o,{csvSeparator:this.props.uiSettings.get("csv:separator",","),quoteValues:this.props.uiSettings.get("csv:quoteValues",!0),raw:!e,formatFactory:this.props.fieldFormats.deserialize,escapeFormulaValues:!1}),type:p.CSV_MIME_TYPE}}return a}),{});a&&Object(u.downloadMultipleAs)(a)})),s()(this,"exportFormattedCsv",(()=>{this.exportCsv(!0)})),s()(this,"exportFormattedAsRawCsv",(()=>{this.exportCsv(!1)}))}renderFormattedDownloads(){const e=m(this.props.datatables),t=n.a.createElement(i.EuiButton,{iconType:"arrowDown",iconSide:"right",size:"s",onClick:this.onTogglePopover},n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.downloadCSVToggleButtonLabel",defaultMessage:"Download CSV"})),a=e?n.a.createElement(i.EuiToolTip,{position:"top",content:d.i18n.translate("data.inspector.table.exportButtonFormulasWarning",{defaultMessage:"Your CSV contains characters that spreadsheet applications might interpret as formulas."})},t):t,o=[n.a.createElement(i.EuiContextMenuItem,{key:"csv",onClick:this.exportFormattedCsv,toolTipContent:n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.formattedCSVButtonTooltip",defaultMessage:"Download the data in table format"}),toolTipPosition:"left"},n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.formattedCSVButtonLabel",defaultMessage:"Formatted CSV"})),n.a.createElement(i.EuiContextMenuItem,{key:"rawCsv",onClick:this.exportFormattedAsRawCsv,toolTipContent:n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.rawCSVButtonTooltip",defaultMessage:"Download the data as provided, for example, dates as timestamps"}),toolTipPosition:"left"},n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.rawCSVButtonLabel",defaultMessage:"Raw CSV"}))];return n.a.createElement(i.EuiPopover,{id:"inspectorDownloadData",button:a,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none",repositionOnScroll:!0},n.a.createElement(i.EuiContextMenuPanel,{className:"eui-textNoWrap",items:o}))}render(){return this.renderFormattedDownloads()}}class data_view_DataViewComponent extends r.Component{constructor(...e){super(...e),s()(this,"state",{}),s()(this,"onUpdateData",(e=>{const t=Object.keys(e),a=t.length?e[t[0]]:void 0;a&&this.setState({datatable:a})})),s()(this,"selectTable",(e=>{e!==this.state.datatable&&this.setState({datatable:e})}))}static getDerivedStateFromProps(e,t){if(t&&e.adapters===t.adapters)return null;const{tables:a}=e.adapters.tables,o=Object.keys(a),s=o.length?a[o[0]]:void 0;return{adapters:e.adapters,datatable:s}}componentDidMount(){this.props.adapters.tables.on("change",this.onUpdateData)}componentWillUnmount(){this.props.adapters.tables.removeListener("change",this.onUpdateData)}static renderNoData(){return n.a.createElement(i.EuiEmptyPrompt,{title:n.a.createElement("h2",null,n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.noDataAvailableTitle",defaultMessage:"No data available"})),body:n.a.createElement(n.a.Fragment,null,n.a.createElement("p",null,n.a.createElement(l.FormattedMessage,{id:"data.inspector.table.noDataAvailableDescription",defaultMessage:"The element did not provide any data."})))})}render(){var e;if(!this.state.datatable)return data_view_DataViewComponent.renderNoData();const t=Object.values(this.state.adapters.tables.tables);return n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiFlexGroup,null,n.a.createElement(i.EuiFlexItem,{grow:!0},t.length>1?n.a.createElement(n.a.Fragment,null,n.a.createElement(i.EuiText,{size:"xs"},n.a.createElement("p",{role:"status","aria-live":"polite","aria-atomic":"true"},n.a.createElement(l.FormattedMessage,{"data-test-subj":"inspectorDataViewSelectorLabel",id:"data.inspector.table.tablesDescription",defaultMessage:"There are {tablesCount, plural, one {# table} other {# tables} } in total",values:{tablesCount:t.length}}))),n.a.createElement(i.EuiSpacer,{size:"xs"}),n.a.createElement(data_table_selector_TableSelector,{tables:t,selectedTable:this.state.datatable,onTableChanged:this.selectTable})):null),n.a.createElement(i.EuiFlexItem,{grow:!1},n.a.createElement(download_options_DataDownloadOptions,{title:(null===(e=this.props.options)||void 0===e?void 0:e.fileName)||this.props.title,uiSettings:this.props.uiSettings,datatables:t,fieldFormats:this.props.fieldFormats}))),n.a.createElement(i.EuiSpacer,{size:"s"}),n.a.createElement(data_table_DataTableFormat,{data:this.state.datatable,uiSettings:this.props.uiSettings,fieldFormats:this.props.fieldFormats,uiActions:this.props.uiActions,isFilterable:this.props.isFilterable}))}}t.default=data_view_DataViewComponent}}]);