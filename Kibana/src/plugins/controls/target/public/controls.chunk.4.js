(window.controls_bundle_jsonpfunction=window.controls_bundle_jsonpfunction||[]).push([[4],{50:function(t,e,i){switch(window.__kbnThemeTag__){case"v8dark":return i(51);case"v8light":return i(53)}},51:function(t,e,i){var o=i(33),s=i(52);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var n={insert:"head",singleton:!1};o(s,n);t.exports=s.locals||{}},52:function(t,e,i){(e=i(34)(!1)).push([t.i,".optionsList__anchorOverride{display:block}.optionsList__popoverOverride{width:100%;height:100%}.optionsList__items{scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow-y:auto;max-height:480px;width:400px;max-width:100%}.optionsList__items::-webkit-scrollbar{width:16px;height:16px}.optionsList__items::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.optionsList__items::-webkit-scrollbar-corner,.optionsList__items::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.optionsList__actions{padding:8px;border-bottom:1px solid #343741;border-color:#202128}.optionsList--filterBtn .euiFilterButton__text-hasNotification{flex-grow:1;justify-content:space-between;width:0}.optionsList--filterBtn.optionsList--filterBtnPlaceholder .euiFilterButton__textShift{color:#7a7f89}.optionsList--filterGroupSingle{box-shadow:none;height:100%;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:5px;border-bottom-right-radius:5px}.optionsList--filterGroup{width:100%}\n",""]),t.exports=e},53:function(t,e,i){var o=i(33),s=i(54);"string"==typeof(s=s.__esModule?s.default:s)&&(s=[[t.i,s,""]]);var n={insert:"head",singleton:!1};o(s,n);t.exports=s.locals||{}},54:function(t,e,i){(e=i(34)(!1)).push([t.i,".optionsList__anchorOverride{display:block}.optionsList__popoverOverride{width:100%;height:100%}.optionsList__items{scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;overflow-y:auto;max-height:480px;width:400px;max-width:100%}.optionsList__items::-webkit-scrollbar{width:16px;height:16px}.optionsList__items::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.optionsList__items::-webkit-scrollbar-corner,.optionsList__items::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.optionsList__actions{padding:8px;border-bottom:1px solid #D3DAE6;border-color:#eef2f7}.optionsList--filterBtn .euiFilterButton__text-hasNotification{flex-grow:1;justify-content:space-between;width:0}.optionsList--filterBtn.optionsList--filterBtnPlaceholder .euiFilterButton__textShift{color:#69707D}.optionsList--filterGroupSingle{box-shadow:none;height:100%;border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:5px;border-bottom-right-radius:5px}.optionsList--filterGroup{width:100%}\n",""]),t.exports=e},74:function(t,e,i){"use strict";i.r(e),i.d(e,"OptionsListEmbeddable",(function(){return options_list_embeddable_OptionsListEmbeddable}));var o=i(1),s=i.n(o),n=i(43),a=i(5),r=i.n(a),l=i(27),c=i.n(l),d=i(24),p=i(13),u=i.n(p),b=i(29),h=i(30),g=i(8),j=i(25),m=i.n(j),O=i(4),S=i(2),x=i(3);const w=({loading:t,searchString:e,availableOptions:i,updateSearchString:o})=>{var s;const{useEmbeddableSelector:n,useEmbeddableDispatch:l,actions:{selectOption:c,deselectOption:d,clearSelections:p,replaceSelection:u}}=Object(S.useReduxEmbeddableContext)(),b=l(),{selectedOptions:h,singleSelect:j,title:m}=n((t=>t)),w=Object(a.useMemo)((()=>new Set(h)),[h]),[f,_]=Object(a.useState)(!1);return Object(x.jsx)(r.a.Fragment,null,Object(x.jsx)(g.EuiPopoverTitle,{paddingSize:"s"},m),Object(x.jsx)("div",{className:"optionsList__actions"},Object(x.jsx)(g.EuiFormRow,null,Object(x.jsx)(g.EuiFlexGroup,{gutterSize:"xs",direction:"row",justifyContent:"spaceBetween"},Object(x.jsx)(g.EuiFlexItem,null,Object(x.jsx)(g.EuiFieldSearch,{compressed:!0,disabled:f,onChange:t=>o(t.target.value),value:e,"data-test-subj":"optionsList-control-search-input"})),Object(x.jsx)(g.EuiFlexItem,{grow:!1},Object(x.jsx)(g.EuiToolTip,{position:"top",content:O.a.popover.getClearAllSelectionsButtonTitle()},Object(x.jsx)(g.EuiButtonIcon,{size:"s",color:"danger",iconType:"eraser","data-test-subj":"optionsList-control-clear-all-selections","aria-label":O.a.popover.getClearAllSelectionsButtonTitle(),onClick:()=>b(p({}))}))),Object(x.jsx)(g.EuiFlexItem,{grow:!1},Object(x.jsx)(g.EuiToolTip,{position:"top",content:f?O.a.popover.getAllOptionsButtonTitle():O.a.popover.getSelectedOptionsButtonTitle()},Object(x.jsx)(g.EuiButtonIcon,{size:"s",iconType:"list","aria-pressed":f,color:f?"primary":"text",display:f?"base":"empty","aria-label":O.a.popover.getClearAllSelectionsButtonTitle(),onClick:()=>_(!f)})))))),Object(x.jsx)("div",{className:"optionsList__items","data-option-count":null!==(s=null==i?void 0:i.length)&&void 0!==s?s:0,"data-test-subj":"optionsList-control-available-options"},!f&&Object(x.jsx)(r.a.Fragment,null,null==i?void 0:i.map(((t,e)=>Object(x.jsx)(g.EuiFilterSelectItem,{"data-test-subj":`optionsList-control-selection-${t}`,checked:null!=w&&w.has(t)?"on":void 0,key:e,onClick:()=>{j?b(u(t)):w.has(t)?b(d(t)):b(c(t))}},`${t}`))),!t&&(!i||0===i.length)&&Object(x.jsx)("div",{className:"euiFilterSelect__note"},Object(x.jsx)("div",{className:"euiFilterSelect__noteContent"},Object(x.jsx)(g.EuiIcon,{type:"minusInCircle"}),Object(x.jsx)(g.EuiSpacer,{size:"xs"}),Object(x.jsx)("p",null,O.a.popover.getEmptyMessage())))),f&&Object(x.jsx)(r.a.Fragment,null,h&&h.map(((t,e)=>Object(x.jsx)(g.EuiFilterSelectItem,{checked:"on",key:e,onClick:()=>b(d(t))},`${t}`))),(!h||0===h.length)&&Object(x.jsx)("div",{className:"euiFilterSelect__note"},Object(x.jsx)("div",{className:"euiFilterSelect__noteContent"},Object(x.jsx)(g.EuiIcon,{type:"minusInCircle"}),Object(x.jsx)(g.EuiSpacer,{size:"xs"}),Object(x.jsx)("p",null,O.a.popover.getSelectionsEmptyMessage()))))))};i(50);const f=({typeaheadSubject:t,componentStateSubject:e})=>{const[i,o]=Object(a.useState)(!1),[s,n]=Object(a.useState)(""),{useEmbeddableDispatch:r,useEmbeddableSelector:l,actions:{replaceSelection:c}}=Object(S.useReduxEmbeddableContext)(),p=r(),{controlStyle:u,selectedOptions:b,singleSelect:h,id:j}=l((t=>t)),{availableOptions:f,loading:_}=((t,e)=>{const[i,o]=Object(a.useState)(e);return Object(a.useEffect)((()=>{const e=t.subscribe((t=>o(t)));return()=>e.unsubscribe()}),[t]),i})(e,e.getValue()),[v,y]=Object(a.useState)(!0),L=Object(a.useMemo)((()=>Object(d.debounce)((t=>y(t)),100)),[]);Object(a.useEffect)((()=>L(_)),[_,L]),Object(a.useEffect)((()=>{h&&b&&(null==b?void 0:b.length)>1&&p(c(b[0]))}),[b,h,p,c]);const E=Object(a.useCallback)((e=>{t.next(e),n(e)}),[t]),{selectedOptionsCount:F,selectedOptionsString:k}=Object(a.useMemo)((()=>({selectedOptionsCount:null==b?void 0:b.length,selectedOptionsString:null==b?void 0:b.join(O.a.summary.getSeparator())})),[b]),C=Object(x.jsx)(g.EuiFilterButton,{iconType:"arrowDown",isLoading:v,className:m()("optionsList--filterBtn",{"optionsList--filterBtnSingle":"twoLine"!==u,"optionsList--filterBtnPlaceholder":!F}),"data-test-subj":`optionsList-control-${j}`,onClick:()=>o((t=>!t)),isSelected:i,numActiveFilters:F,hasActiveFilters:(null!=F?F:0)>0},F?k:O.a.summary.getPlaceholder());return Object(x.jsx)(g.EuiFilterGroup,{className:m()("optionsList--filterGroup",{"optionsList--filterGroupSingle":"twoLine"!==u})},Object(x.jsx)(g.EuiPopover,{button:C,isOpen:i,className:"optionsList__popoverOverride",anchorClassName:"optionsList__anchorOverride",closePopover:()=>o(!1),panelPaddingSize:"none",anchorPosition:"downCenter",ownFocus:!0,repositionOnScroll:!0},Object(x.jsx)(w,{loading:_,searchString:s,updateSearchString:E,availableOptions:f})))};var _=i(15),v=i(26);const y={deselectOption:(t,e)=>{if(!t.selectedOptions)return;const i=t.selectedOptions.indexOf(e.payload);if(-1!==i){const e=[...t.selectedOptions];e.splice(i,1),t.selectedOptions=e}},selectOption:(t,e)=>{var i;t.selectedOptions||(t.selectedOptions=[]),null===(i=t.selectedOptions)||void 0===i||i.push(e.payload)},replaceSelection:(t,e)=>{t.selectedOptions=[e.payload]},clearSelections:t=>{t.selectedOptions=[]}};var L=i(6);const E=Object(S.withSuspense)(S.LazyReduxEmbeddableWrapper),F=(t,e)=>{if(!t||!e)return!1;const{filters:i,...o}=t,{filters:s,...a}=e;return!!u()(o,a)&&!!Object(n.d)(null!=s?s:[],null!=i?i:[])},k=t=>new Error(`field ${t} not found in index pattern`);class options_list_embeddable_OptionsListEmbeddable extends v.Embeddable{constructor(t,e,i){super(t,e,i),s()(this,"type",_.a),s()(this,"deferEmbeddableLoad",!0),s()(this,"subscriptions",new b.Subscription),s()(this,"node",void 0),s()(this,"dataService",void 0),s()(this,"dataViewsService",void 0),s()(this,"typeaheadSubject",new b.Subject),s()(this,"dataView",void 0),s()(this,"searchString",""),s()(this,"componentState",void 0),s()(this,"componentStateSubject$",new b.BehaviorSubject({loading:!0})),s()(this,"setupSubscriptions",(()=>{const t=this.getInput$().pipe(Object(h.map)((t=>({lastReloadRequestTime:t.lastReloadRequestTime,dataViewId:t.dataViewId,fieldName:t.fieldName,timeRange:t.timeRange,filters:t.filters,query:t.query}))),Object(h.distinctUntilChanged)(F));this.typeaheadSubject=new b.Subject;const e=this.typeaheadSubject.pipe(Object(h.tap)((t=>this.searchString=t)),Object(h.debounceTime)(100));this.subscriptions.add(Object(b.merge)(t,e).subscribe(this.fetchAvailableOptions)),this.subscriptions.add(this.getInput$().pipe(Object(h.debounceTime)(400),Object(h.distinctUntilChanged)(((t,e)=>Object(d.isEqual)(t.selectedOptions,e.selectedOptions))),Object(h.skip)(1)).subscribe((()=>this.buildFilter())))})),s()(this,"getCurrentDataView",(async()=>{const{dataViewId:t}=this.getInput();return this.dataView&&this.dataView.id===t||(this.dataView=await this.dataViewsService.get(t),void 0===this.dataView&&this.onFatalError(new Error(O.a.errors.getDataViewNotFoundError(t))),this.updateOutput({dataViews:[this.dataView]})),this.dataView})),s()(this,"fetchAvailableOptions",(async()=>{this.updateComponentState({loading:!0});const{ignoreParentSettings:t,filters:e,fieldName:i,query:o}=this.getInput(),s=await this.getCurrentDataView(),a=s.getFieldByName(i);if(!a)throw k(i);const r=[Object(n.a)(s,null!=t&&t.ignoreQuery?[]:null!=o?o:[],null!=t&&t.ignoreFilters?[]:null!=e?e:[])],l=await this.dataService.autocomplete.getValueSuggestions({query:this.searchString,indexPattern:s,useTimeRange:!(null!=t&&t.ignoreTimerange),method:"terms_agg",boolFilter:r,field:a});this.updateComponentState({availableOptions:l,loading:!1})})),s()(this,"initialize",(async()=>{this.getInput().selectedOptions&&(await this.getCurrentDataView(),await this.buildFilter()),this.setInitializationFinished(),this.setupSubscriptions()})),s()(this,"buildFilter",(async()=>{const{fieldName:t,selectedOptions:e}=this.getInput();if(!e||0===e.length)return void this.updateOutput({filters:[]});const i=await this.getCurrentDataView(),o=i.getFieldByName(this.getInput().fieldName);if(!o)throw k(t);let s;s=1===e.length?Object(n.b)(o,e[0],i):Object(n.c)(o,e,i),s.meta.key=null==o?void 0:o.name,this.updateOutput({filters:[s]})})),s()(this,"reload",(()=>{this.fetchAvailableOptions()})),s()(this,"destroy",(()=>{super.destroy(),this.subscriptions.unsubscribe()})),s()(this,"render",(t=>{this.node&&c.a.unmountComponentAtNode(this.node),this.node=t,c.a.render(Object(x.jsx)(E,{embeddable:this,reducers:y},Object(x.jsx)(f,{componentStateSubject:this.componentStateSubject$,typeaheadSubject:this.typeaheadSubject})),t)})),({data:this.dataService,dataViews:this.dataViewsService}=L.a.getServices()),this.componentState={loading:!0},this.updateComponentState(this.componentState),this.initialize()}updateComponentState(t){this.componentState={...this.componentState,...t},this.componentStateSubject$.next(this.componentState)}}}}]);