(window.inputControlVis_bundle_jsonpfunction=window.inputControlVis_bundle_jsonpfunction||[]).push([[1],[,,,,,,,,,,,,,,,,function(t,e,r){t.exports=r(6)(2)},function(t,e,r){t.exports=r(6)(2455)},function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"g",(function(){return i})),r.d(e,"b",(function(){return s})),r.d(e,"d",(function(){return a})),r.d(e,"f",(function(){return o})),r.d(e,"e",(function(){return u})),r.d(e,"c",(function(){return c}));const n={LIST:"list",RANGE:"range"},i=(t,e,r)=>[...t.slice(0,e),r,...t.slice(e+1)],s=(t,e)=>[...t,e],a=(t,e,r)=>{let n;if(n=r>=0?e+1:e-1,n<0)return[...t.slice(1),t[0]];if(n>=t.length){const e=t.length-1;return[t[e],...t.slice(0,e)]}{const r=t.slice(),i=r[n];return r[n]=r[e],r[e]=i,r}},o=(t,e)=>[...t.slice(0,e),...t.slice(e+1)],l=t=>{const e={};switch(t){case n.RANGE:e.decimalPlaces=0,e.step=1;break;case n.LIST:e.type="terms",e.multiselect=!0,e.dynamicOptions=!0,e.size=5,e.order="desc"}return e},u=t=>({id:(new Date).getTime().toString(),indexPattern:"",fieldName:"",parent:"",label:"",type:t,options:l(t)}),c=(t,e)=>{let r=`${t.type}: ${e}`;return t.label?r=`${t.label}`:t.fieldName&&(r=`${t.fieldName}`),r}},function(t,e,r){"use strict";var n,i=function(){return void 0===n&&(n=Boolean(window&&document&&document.all&&!window.atob)),n},s=function(){var t={};return function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}t[e]=r}return t[e]}}(),a=[];function o(t){for(var e=-1,r=0;r<a.length;r++)if(a[r].identifier===t){e=r;break}return e}function l(t,e){for(var r={},n=[],i=0;i<t.length;i++){var s=t[i],l=e.base?s[0]+e.base:s[0],u=r[l]||0,c="".concat(l," ").concat(u);r[l]=u+1;var d=o(c),h={css:s[1],media:s[2],sourceMap:s[3]};-1!==d?(a[d].references++,a[d].updater(h)):a.push({identifier:c,updater:m(h,e),references:1}),n.push(c)}return n}function u(t){var e=document.createElement("style"),n=t.attributes||{};if(void 0===n.nonce){var i=r.nc;i&&(n.nonce=i)}if(Object.keys(n).forEach((function(t){e.setAttribute(t,n[t])})),"function"==typeof t.insert)t.insert(e);else{var a=s(t.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(e)}return e}var c,d=(c=[],function(t,e){return c[t]=e,c.filter(Boolean).join("\n")});function h(t,e,r,n){var i=r?"":n.media?"@media ".concat(n.media," {").concat(n.css,"}"):n.css;if(t.styleSheet)t.styleSheet.cssText=d(e,i);else{var s=document.createTextNode(i),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(s,a[e]):t.appendChild(s)}}function f(t,e,r){var n=r.css,i=r.media,s=r.sourceMap;if(i?t.setAttribute("media",i):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}var p=null,g=0;function m(t,e){var r,n,i;if(e.singleton){var s=g++;r=p||(p=u(e)),n=h.bind(null,r,s,!1),i=h.bind(null,r,s,!0)}else r=u(e),n=f.bind(null,r,e),i=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(r)};return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=i());var r=l(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var n=0;n<r.length;n++){var i=o(r[n]);a[i].references--}for(var s=l(t,e),u=0;u<r.length;u++){var c=o(r[u]);0===a[c].references&&(a[c].updater(),a.splice(c,1))}r=s}}}},function(t,e,r){"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var i=(a=n,o=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),l="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(l," */")),s=n.sources.map((function(t){return"/*# sourceURL=".concat(n.sourceRoot||"").concat(t," */")}));return[r].concat(s).concat([i]).join("\n")}var a,o,l;return[r].join("\n")}(e,t);return e[2]?"@media ".concat(e[2]," {").concat(r,"}"):r})).join("")},e.i=function(t,r,n){"string"==typeof t&&(t=[[null,t,""]]);var i={};if(n)for(var s=0;s<this.length;s++){var a=this[s][0];null!=a&&(i[a]=!0)}for(var o=0;o<t.length;o++){var l=[].concat(t[o]);n&&i[l[0]]||(r&&(l[2]?l[2]="".concat(r," and ").concat(l[2]):l[2]=r),e.push(l))}},e}},function(t,e,r){t.exports=r(6)(8)},function(t,e,r){t.exports=r(6)(21)},function(t,e,r){"use strict";r.d(e,"a",(function(){return s})),r.d(e,"b",(function(){return o}));var n=r(10),i=r.n(n);function s(t){const e=new Map;return t.forEach((r=>{const n=[r.id],s=e=>{if(i.a.has(e,"parent")&&""!==e.parent&&!n.includes(e.parent)){n.push(e.parent);const i=(r=e.parent,t.find((t=>t.id===r)));i&&s(i)}var r};s(r),e.set(r.id,n)})),e}var a=r(18);function o(t,e,r){return t.filter((t=>{if(!t.indexPattern||!t.fieldName)return!1;const n=r.get(t.id);return null==n||!n.includes(e)})).map(((t,e)=>({value:t.id,text:Object(a.c)(t,e)})))}},function(t,e,r){t.exports=r(6)(43)},function(t,e,r){"use strict";function n(t,e,r,i){var s=Error.call(this,t);return Object.setPrototypeOf&&Object.setPrototypeOf(s,n.prototype),s.expected=e,s.found=r,s.location=i,s.name="SyntaxError",s}function i(t,e,r){return r=r||" ",t.length>e?t:(e-=t.length,t+(r+=r.repeat(e)).slice(0,e))}!function(t,e){function r(){this.constructor=t}r.prototype=e.prototype,t.prototype=new r}(n,Error),n.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var r,n=null;for(r=0;r<t.length;r++)if(t[r].source===this.location.source){n=t[r].text.split(/\r\n|\n|\r/g);break}var s=this.location.start,a=this.location.source+":"+s.line+":"+s.column;if(n){var o=this.location.end,l=i("",s.line.toString().length),u=n[s.line-1],c=s.line===o.line?o.column:u.length+1;e+="\n --\x3e "+a+"\n"+l+" |\n"+s.line+" | "+u+"\n"+l+" | "+i("",s.column-1)+i("",c-s.column,"^")}else e+="\n at "+a}return e},n.buildMessage=function(t,e){var r={literal:function(t){return'"'+i(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?s(t[0])+"-"+s(t[1]):s(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function i(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function s(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+n(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+n(t)}))}function a(t){return r[t.type](t)}return"Expected "+function(t){var e,r,n=t.map(a);if(n.sort(),n.length>0){for(e=1,r=1;e<n.length;e++)n[e-1]!==n[e]&&(n[r]=n[e],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}(t)+" but "+function(t){return t?'"'+i(t)+'"':"end of input"}(e)+" found."},t.exports={SyntaxError:n,parse:function(t,e){var r,i={},s=(e=void 0!==e?e:{}).grammarSource,a={start:yt,Literal:Pt},o=yt,l=":",u="or",c="and",d="not",h='"',f="\\",p="<=",g=">=",m="@kuery-cursor@",v=/^[\\"]/,b=/^[^"]/,y=/^[\\():<>"*{}]/,x=/^[0-9a-f]/i,C=/^[ \t\r\n\xA0]/,w=ht("(",!1),_=ht(")",!1),j=ht(":",!1),F=ht("{",!1),A=ht("}",!1),S=pt("fieldName"),O=pt("value"),M=pt("OR"),E=ht("or",!0),N=pt("AND"),P=ht("and",!0),T=pt("NOT"),I=ht("not",!0),q=pt("literal"),k=ht('"',!1),R=ht("\\",!1),V=ft(["\\",'"'],!1,!1),L=ft(['"'],!0,!1),B={type:"any"},U=ht("*",!1),Q=ht("\\t",!1),$=ht("\\r",!1),z=ht("\\n",!1),G=ft(["\\","(",")",":","<",">",'"',"*","{","}"],!1,!1),W=ht("u",!1),D=ft([["0","9"],["a","f"]],!1,!0),H=ht("<=",!1),K=ht(">=",!1),Z=ht("<",!1),J=ht(">",!1),X=pt("whitespace"),Y=ft([" ","\t","\r","\n","Â "],!1,!1),tt=ht("@kuery-cursor@",!1),et=function(t,e){return e},rt=function(t,e){return e},nt=function(t){if("cursor"===t.type)return t;!Wt&&"wildcard"===t.type&&Dt.wildcard.hasLeadingWildcard(t)&&function(t,e){throw e=void 0!==e?e:mt(ot,at),function(t,e){return new n(t,null,null,e)}(t,e)}("Leading wildcards are disabled. See query:allowLeadingWildcards in Advanced Settings.");const e=Kt(!1);return r=>Ht("is",[r,t,e])},it=function(){return zt},st=function(e,r,n){const{start:i,end:s}=mt(ot,at);return{type:"cursor",start:i.offset,end:s.offset-r.length,prefix:e.join(""),suffix:n.join(""),text:t.substring(ot,at).replace(r,"")}},at=0,ot=0,lt=[{line:1,column:1}],ut=0,ct=[],dt=0;if("startRule"in e){if(!(e.startRule in a))throw new Error("Can't start parsing from rule \""+e.startRule+'".');o=a[e.startRule]}function ht(t,e){return{type:"literal",text:t,ignoreCase:e}}function ft(t,e,r){return{type:"class",parts:t,inverted:e,ignoreCase:r}}function pt(t){return{type:"other",description:t}}function gt(e){var r,n=lt[e];if(n)return n;for(r=e-1;!lt[r];)r--;for(n={line:(n=lt[r]).line,column:n.column};r<e;)10===t.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return lt[e]=n,n}function mt(t,e){var r=gt(t),n=gt(e);return{source:s,start:{offset:t,line:r.line,column:r.column},end:{offset:e,line:n.line,column:n.column}}}function vt(t){at<ut||(at>ut&&(ut=at,ct=[]),ct.push(t))}function bt(t,e,r){return new n(n.buildMessage(t,e),t,e,r)}function yt(){var t,e,r,n,s,a;for(t=at,e=[],r=Qt();r!==i;)e.push(r),r=Qt();return(r=xt())===i&&(r=null),(n=Rt())!==i?(ot=t,s=r,t="cursor"===(a=n).type?{...a,suggestionTypes:["conjunction"]}:null!==s?s:Dt.function.buildNode("is","*","*")):(at=t,t=i),t}function xt(){var t,e,r,n,s;if(t=at,(e=Ct())!==i){if(r=[],n=at,Mt()!==i&&(s=Ct())!==i?(ot=n,n=et(0,s)):(at=n,n=i),n!==i)for(;n!==i;)r.push(n),n=at,Mt()!==i&&(s=Ct())!==i?(ot=n,n=et(0,s)):(at=n,n=i);else r=i;r!==i?(ot=t,t=function(t,e){const r=[t,...e];return zt&&r.find((t=>"cursor"===t.type))||Ht("or",r)}(e,r)):(at=t,t=i)}else at=t,t=i;return t===i&&(t=Ct()),t}function Ct(){var t,e,r,n,s;if(t=at,(e=wt())!==i){if(r=[],n=at,Et()!==i&&(s=wt())!==i?(ot=n,n=et(0,s)):(at=n,n=i),n!==i)for(;n!==i;)r.push(n),n=at,Et()!==i&&(s=wt())!==i?(ot=n,n=et(0,s)):(at=n,n=i);else r=i;r!==i?(ot=t,t=function(t,e){const r=[t,...e];return zt&&r.find((t=>"cursor"===t.type))||Ht("and",r)}(e,r)):(at=t,t=i)}else at=t,t=i;return t===i&&(t=wt()),t}function wt(){var t,e,r;return t=at,Nt()!==i&&(e=_t())!==i?(ot=t,t="cursor"===(r=e).type?r:Ht("not",[r])):(at=t,t=i),t===i&&(t=_t()),t}function _t(){var e,r,n,s,a,o,u,c;if(e=at,40===t.charCodeAt(at)?(r="(",at++):(r=i,0===dt&&vt(w)),r!==i){for(n=[],s=Qt();s!==i;)n.push(s),s=Qt();(s=xt())!==i&&(a=Rt())!==i?(41===t.charCodeAt(at)?(o=")",at++):(o=i,0===dt&&vt(_)),o!==i?(ot=e,u=s,e="cursor"===(c=a).type?{...c,suggestionTypes:["conjunction"]}:u):(at=e,e=i)):(at=e,e=i)}else at=e,e=i;return e===i&&(e=function(){var e,r,n,s,a,o,u,c,d,h;if(e=at,(r=jt())!==i){for(n=[],s=Qt();s!==i;)n.push(s),s=Qt();if(58===t.charCodeAt(at)?(s=":",at++):(s=i,0===dt&&vt(j)),s!==i){for(a=[],o=Qt();o!==i;)a.push(o),o=Qt();if(123===t.charCodeAt(at)?(o="{",at++):(o=i,0===dt&&vt(F)),o!==i){for(u=[],c=Qt();c!==i;)u.push(c),c=Qt();(c=xt())!==i&&(d=Rt())!==i?(125===t.charCodeAt(at)?(h="}",at++):(h=i,0===dt&&vt(A)),h!==i?(ot=e,e=function(t,e,r){return"cursor"===e.type?{...e,nestedPath:e.nestedPath?`${t.value}.${e.nestedPath}`:t.value}:"cursor"===r.type?{...r,suggestionTypes:["conjunction"]}:Ht("nested",[t,e])}(r,c,d)):(at=e,e=i)):(at=e,e=i)}else at=e,e=i}else at=e,e=i}else at=e,e=i;e===i&&(e=function(){var e;(e=function(){var e,r,n,s,a,o;if(e=at,(r=jt())!==i){for(n=[],s=Qt();s!==i;)n.push(s),s=Qt();if((s=function(){var e,r;e=at,t.substr(at,2)===p?(r=p,at+=2):(r=i,0===dt&&vt(H));r!==i&&(ot=e,r="lte");(e=r)===i&&(e=at,t.substr(at,2)===g?(r=g,at+=2):(r=i,0===dt&&vt(K)),r!==i&&(ot=e,r="gte"),(e=r)===i&&(e=at,60===t.charCodeAt(at)?(r="<",at++):(r=i,0===dt&&vt(Z)),r!==i&&(ot=e,r="lt"),(e=r)===i&&(e=at,62===t.charCodeAt(at)?(r=">",at++):(r=i,0===dt&&vt(J)),r!==i&&(ot=e,r="gt"),e=r)));return e}())!==i){for(a=[],o=Qt();o!==i;)a.push(o),o=Qt();(o=Pt())!==i?(ot=e,l=r,u=s,e="cursor"===(c=o).type?{...c,suggestionTypes:["conjunction"]}:Ht("range",[l,u,c])):(at=e,e=i)}else at=e,e=i}else at=e,e=i;var l,u,c;return e}())===i&&(e=function(){var e,r,n,s,a,o;if(e=at,(r=jt())!==i){for(n=[],s=Qt();s!==i;)n.push(s),s=Qt();if(58===t.charCodeAt(at)?(s=l,at++):(s=i,0===dt&&vt(j)),s!==i){for(a=[],o=Qt();o!==i;)a.push(o),o=Qt();(o=Ft())!==i?(ot=e,u=r,e="cursor"===(c=o).type?{...c,fieldName:u.value,suggestionTypes:["value","conjunction"]}:c(u)):(at=e,e=i)}else at=e,e=i}else at=e,e=i;var u,c;return e}())===i&&(e=function(){var t,e;t=at,(e=Ot())!==i&&(ot=t,e=function(t){if("cursor"===t.type){const e=`${t.prefix}${t.suffix}`.trim();return{...t,fieldName:e,suggestionTypes:["field","operator","conjunction"]}}return t(Kt(null))}(e));return t=e}());return e}());return e}()),e}function jt(){var t;return dt++,t=Pt(),dt--,t===i&&(i,0===dt&&vt(S)),t}function Ft(){var e,r,n,s,a,o,l,u;if(e=at,40===t.charCodeAt(at)?(r="(",at++):(r=i,0===dt&&vt(w)),r!==i){for(n=[],s=Qt();s!==i;)n.push(s),s=Qt();(s=function(){var t,e,r,n,s;if(t=at,(e=At())!==i){if(r=[],n=at,Mt()!==i&&(s=At())!==i?(ot=n,n=rt(0,s)):(at=n,n=i),n!==i)for(;n!==i;)r.push(n),n=at,Mt()!==i&&(s=At())!==i?(ot=n,n=rt(0,s)):(at=n,n=i);else r=i;r!==i?(ot=t,t=function(t,e){const r=[t,...e],n=zt&&r.find((t=>"cursor"===t.type));return n?{...n,suggestionTypes:["value"]}:t=>Ht("or",r.map((e=>e(t))))}(e,r)):(at=t,t=i)}else at=t,t=i;t===i&&(t=At());return t}())!==i&&(a=Rt())!==i?(41===t.charCodeAt(at)?(o=")",at++):(o=i,0===dt&&vt(_)),o!==i?(ot=e,l=s,e="cursor"===(u=a).type?{...u,suggestionTypes:["conjunction"]}:l):(at=e,e=i)):(at=e,e=i)}else at=e,e=i;return e===i&&(e=Ot()),e}function At(){var t,e,r,n,s;if(t=at,(e=St())!==i){if(r=[],n=at,Et()!==i&&(s=St())!==i?(ot=n,n=rt(0,s)):(at=n,n=i),n!==i)for(;n!==i;)r.push(n),n=at,Et()!==i&&(s=St())!==i?(ot=n,n=rt(0,s)):(at=n,n=i);else r=i;r!==i?(ot=t,t=function(t,e){const r=[t,...e],n=zt&&r.find((t=>"cursor"===t.type));return n?{...n,suggestionTypes:["value"]}:t=>Ht("and",r.map((e=>e(t))))}(e,r)):(at=t,t=i)}else at=t,t=i;return t===i&&(t=St()),t}function St(){var t,e,r;return t=at,Nt()!==i&&(e=Ft())!==i?(ot=t,t="cursor"===(r=e).type?{...list,suggestionTypes:["value"]}:t=>Ht("not",[r(t)])):(at=t,t=i),t===i&&(t=Ft()),t}function Ot(){var t,e;return dt++,t=at,(e=Tt())!==i&&(ot=t,e=function(t){if("cursor"===t.type)return t;const e=Kt(!0);return r=>Ht("is",[r,t,e])}(e)),(t=e)===i&&(t=at,(e=qt())!==i&&(ot=t,e=nt(e)),t=e),dt--,t===i&&(e=i,0===dt&&vt(O)),t}function Mt(){var e,r,n,s,a;if(dt++,e=at,r=[],(n=Qt())!==i)for(;n!==i;)r.push(n),n=Qt();else r=i;if(r!==i)if("or"===t.substr(at,2).toLowerCase()?(n=t.substr(at,2),at+=2):(n=i,0===dt&&vt(E)),n!==i){if(s=[],(a=Qt())!==i)for(;a!==i;)s.push(a),a=Qt();else s=i;s!==i?e=r=[r,n,s]:(at=e,e=i)}else at=e,e=i;else at=e,e=i;return dt--,e===i&&(r=i,0===dt&&vt(M)),e}function Et(){var e,r,n,s,a;if(dt++,e=at,r=[],(n=Qt())!==i)for(;n!==i;)r.push(n),n=Qt();else r=i;if(r!==i)if("and"===t.substr(at,3).toLowerCase()?(n=t.substr(at,3),at+=3):(n=i,0===dt&&vt(P)),n!==i){if(s=[],(a=Qt())!==i)for(;a!==i;)s.push(a),a=Qt();else s=i;s!==i?e=r=[r,n,s]:(at=e,e=i)}else at=e,e=i;else at=e,e=i;return dt--,e===i&&(r=i,0===dt&&vt(N)),e}function Nt(){var e,r,n,s;if(dt++,e=at,"not"===t.substr(at,3).toLowerCase()?(r=t.substr(at,3),at+=3):(r=i,0===dt&&vt(I)),r!==i){if(n=[],(s=Qt())!==i)for(;s!==i;)n.push(s),s=Qt();else n=i;n!==i?e=r=[r,n]:(at=e,e=i)}else at=e,e=i;return dt--,e===i&&(r=i,0===dt&&vt(T)),e}function Pt(){var t;return dt++,(t=Tt())===i&&(t=qt()),dt--,t===i&&(i,0===dt&&vt(q)),t}function Tt(){var e,r,n,s,a,o,l;if(e=at,ot=at,(r=(r=it())?void 0:i)!==i)if(34===t.charCodeAt(at)?(n=h,at++):(n=i,0===dt&&vt(k)),n!==i){for(s=[],a=It();a!==i;)s.push(a),a=It();if((a=$t())!==i){for(o=[],l=It();l!==i;)o.push(l),l=It();34===t.charCodeAt(at)?(l=h,at++):(l=i,0===dt&&vt(k)),l!==i?(ot=e,e=st(s,a,o)):(at=e,e=i)}else at=e,e=i}else at=e,e=i;else at=e,e=i;if(e===i)if(e=at,34===t.charCodeAt(at)?(r=h,at++):(r=i,0===dt&&vt(k)),r!==i){for(n=[],s=It();s!==i;)n.push(s),s=It();34===t.charCodeAt(at)?(s=h,at++):(s=i,0===dt&&vt(k)),s!==i?(ot=e,e=Kt(n.join(""))):(at=e,e=i)}else at=e,e=i;return e}function It(){var e,r,n;return(e=Vt())===i&&(e=Bt())===i&&(e=at,92===t.charCodeAt(at)?(r=f,at++):(r=i,0===dt&&vt(R)),r!==i?(v.test(t.charAt(at))?(n=t.charAt(at),at++):(n=i,0===dt&&vt(V)),n!==i?(ot=e,e=n):(at=e,e=i)):(at=e,e=i),e===i&&(e=at,r=at,dt++,n=$t(),dt--,n===i?r=void 0:(at=r,r=i),r!==i?(b.test(t.charAt(at))?(n=t.charAt(at),at++):(n=i,0===dt&&vt(L)),n!==i?(ot=e,e=n):(at=e,e=i)):(at=e,e=i))),e}function qt(){var t,e,r,n,s,a;if(t=at,ot=at,(e=(e=it())?void 0:i)!==i){for(r=[],n=kt();n!==i;)r.push(n),n=kt();if((n=$t())!==i){for(s=[],a=kt();a!==i;)s.push(a),a=kt();ot=t,t=st(r,n,s)}else at=t,t=i}else at=t,t=i;if(t===i){if(t=at,e=[],(r=kt())!==i)for(;r!==i;)e.push(r),r=kt();else e=i;e!==i&&(ot=t,e=function(t){const e=t.join("").trim();return"null"===e?Kt(null):"true"===e?Kt(!0):"false"===e?Kt(!1):t.includes(Jt)?Zt(e):Kt(e)}(e)),t=e}return t}function kt(){var e,r,n,s,a;return(e=Vt())===i&&(e=function(){var e,r,n;e=at,92===t.charCodeAt(at)?(r=f,at++):(r=i,0===dt&&vt(R));r!==i&&(n=Lt())!==i?(ot=e,e=n):(at=e,e=i);return e}())===i&&(e=Bt())===i&&(e=function(){var e,r,n;e=at,92===t.charCodeAt(at)?(r=f,at++):(r=i,0===dt&&vt(R));r!==i?(t.substr(at,2).toLowerCase()===u?(n=t.substr(at,2),at+=2):(n=i,0===dt&&vt(E)),n===i&&(t.substr(at,3).toLowerCase()===c?(n=t.substr(at,3),at+=3):(n=i,0===dt&&vt(P)),n===i&&(t.substr(at,3).toLowerCase()===d?(n=t.substr(at,3),at+=3):(n=i,0===dt&&vt(I)))),n!==i?(ot=e,e=n):(at=e,e=i)):(at=e,e=i);return e}())===i&&(e=function(){var e,r;e=at,42===t.charCodeAt(at)?(r="*",at++):(r=i,0===dt&&vt(U));r!==i&&(ot=e,r=Jt);return e=r}())===i&&(e=at,r=at,dt++,n=Lt(),dt--,n===i?r=void 0:(at=r,r=i),r!==i?(n=at,dt++,s=function(){var t;(t=Mt())===i&&(t=Et())===i&&(t=Nt());return t}(),dt--,s===i?n=void 0:(at=n,n=i),n!==i?(s=at,dt++,a=$t(),dt--,a===i?s=void 0:(at=s,s=i),s!==i?(t.length>at?(a=t.charAt(at),at++):(a=i,0===dt&&vt(B)),a!==i?(ot=e,e=a):(at=e,e=i)):(at=e,e=i)):(at=e,e=i)):(at=e,e=i)),e}function Rt(){var t,e,r,n,s,a;if(t=at,ot=at,(e=(e=it())?void 0:i)!==i){for(r=[],n=Qt();n!==i;)r.push(n),n=Qt();if((n=$t())!==i){for(s=[],a=Qt();a!==i;)s.push(a),a=Qt();ot=t,t=st(r,n,s)}else at=t,t=i}else at=t,t=i;if(t===i)for(t=[],e=Qt();e!==i;)t.push(e),e=Qt();return t}function Vt(){var e,r;return e=at,"\\t"===t.substr(at,2)?(r="\\t",at+=2):(r=i,0===dt&&vt(Q)),r!==i&&(ot=e,r="\t"),(e=r)===i&&(e=at,"\\r"===t.substr(at,2)?(r="\\r",at+=2):(r=i,0===dt&&vt($)),r!==i&&(ot=e,r="\r"),(e=r)===i&&(e=at,"\\n"===t.substr(at,2)?(r="\\n",at+=2):(r=i,0===dt&&vt(z)),r!==i&&(ot=e,r="\n"),e=r)),e}function Lt(){var e;return y.test(t.charAt(at))?(e=t.charAt(at),at++):(e=i,0===dt&&vt(G)),e}function Bt(){var e,r,n;return e=at,92===t.charCodeAt(at)?(r=f,at++):(r=i,0===dt&&vt(R)),r!==i&&(n=function(){var e,r,n,s,a,o,l,u;e=at,117===t.charCodeAt(at)?(r="u",at++):(r=i,0===dt&&vt(W));r!==i?(n=at,s=at,(a=Ut())!==i&&(o=Ut())!==i&&(l=Ut())!==i&&(u=Ut())!==i?s=a=[a,o,l,u]:(at=s,s=i),(n=s!==i?t.substring(n,at):s)!==i?(ot=e,c=n,e=String.fromCharCode(parseInt(c,16))):(at=e,e=i)):(at=e,e=i);var c;return e}())!==i?(ot=e,e=n):(at=e,e=i),e}function Ut(){var e;return x.test(t.charAt(at))?(e=t.charAt(at),at++):(e=i,0===dt&&vt(D)),e}function Qt(){var e;return dt++,C.test(t.charAt(at))?(e=t.charAt(at),at++):(e=i,0===dt&&vt(Y)),dt--,e===i&&(i,0===dt&&vt(X)),e}function $t(){var e,r;return e=at,ot=at,(it()?void 0:i)!==i?(t.substr(at,14)===m?(r=m,at+=14):(r=i,0===dt&&vt(tt)),r!==i?(ot=e,e=Gt):(at=e,e=i)):(at=e,e=i),e}const{parseCursor:zt,cursorSymbol:Gt,allowLeadingWildcards:Wt=!0,helpers:{nodeTypes:Dt}}=e,Ht=Dt.function.buildNodeWithArgumentNodes,Kt=Dt.literal.buildNode,Zt=Dt.wildcard.buildNode,{wildcardSymbol:Jt}=Dt.wildcard;if((r=o())!==i&&at===t.length)return r;throw r!==i&&at<t.length&&vt({type:"end"}),bt(ct,ut<t.length?t.charAt(ut):null,ut<t.length?mt(ut,ut+1):mt(ut,ut))}}},function(t,e,r){switch(window.__kbnThemeTag__){case"v8dark":return r(27);case"v8light":return r(29)}},function(t,e,r){var n=r(19),i=r(28);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);t.exports=i.locals||{}},function(t,e,r){(e=r(20)(!1)).push([t.i,".icvContainer__wrapper{scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;min-height:0;flex:1 1 0;display:flex;overflow:auto}.icvContainer__wrapper::-webkit-scrollbar{width:16px;height:16px}.icvContainer__wrapper::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.icvContainer__wrapper::-webkit-scrollbar-corner,.icvContainer__wrapper::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]),t.exports=e},function(t,e,r){var n=r(19),i=r(30);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[t.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);t.exports=i.locals||{}},function(t,e,r){(e=r(20)(!1)).push([t.i,".icvContainer__wrapper{scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;min-height:0;flex:1 1 0;display:flex;overflow:auto}.icvContainer__wrapper::-webkit-scrollbar{width:16px;height:16px}.icvContainer__wrapper::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.icvContainer__wrapper::-webkit-scrollbar-corner,.icvContainer__wrapper::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.icvContainer{width:100%;margin:0 4px;padding:8px}\n",""]),t.exports=e},function(t,e,r){t.exports=r(6)(14)},function(t,e,r){t.exports=r(6)(13)},function(t,e,r){t.exports=r(6)(4)},function(t,e,r){t.exports=r(6)(19)},function(t,e,r){t.exports=r(6)(2453)},function(t,e,r){t.exports=r(6)(2460)},,,,,,,function(t,e,r){"use strict";r.r(e),r.d(e,"createInputControlVisController",(function(){return ee}));var n={};r.r(n),r.d(n,"buildNode",(function(){return X})),r.d(n,"toElasticsearchQuery",(function(){return Y}));var i={};r.r(i),r.d(i,"wildcardSymbol",(function(){return tt})),r.d(i,"buildNode",(function(){return nt})),r.d(i,"test",(function(){return it})),r.d(i,"toElasticsearchQuery",(function(){return st})),r.d(i,"toQueryStringQuery",(function(){return at})),r.d(i,"hasLeadingWildcard",(function(){return ot}));var s={};r.r(s),r.d(s,"buildNodeParams",(function(){return pt})),r.d(s,"toElasticsearchQuery",(function(){return gt}));var a={};r.r(a),r.d(a,"buildNodeParams",(function(){return mt})),r.d(a,"toElasticsearchQuery",(function(){return vt}));var o={};r.r(o),r.d(o,"buildNodeParams",(function(){return bt})),r.d(o,"toElasticsearchQuery",(function(){return yt}));var l={};r.r(l),r.d(l,"buildNodeParams",(function(){return xt})),r.d(l,"toElasticsearchQuery",(function(){return Ct}));var u={};r.r(u),r.d(u,"buildNodeParams",(function(){return wt})),r.d(u,"toElasticsearchQuery",(function(){return _t}));var c={};r.r(c),r.d(c,"buildNodeParams",(function(){return jt})),r.d(c,"toElasticsearchQuery",(function(){return Ft}));var d={};r.r(d),r.d(d,"buildNodeParams",(function(){return At})),r.d(d,"toElasticsearchQuery",(function(){return St}));var h={};r.r(h),r.d(h,"buildNode",(function(){return Mt})),r.d(h,"buildNodeWithArgumentNodes",(function(){return Et})),r.d(h,"toElasticsearchQuery",(function(){return Nt}));var f=r(16),p=r.n(f),g=r(1),m=r.n(g),v=r(10),b=r.n(v),y=r(13),x=r(4),C=r(11),w=r(12),_=r(18),j=r(0),F=r(2);function A(t){let e=t.children;t.disableMsg&&(e=Object(F.jsx)(C.EuiToolTip,{position:"top",content:t.disableMsg,anchorClassName:"eui-displayBlock"},e));const r=t.warningMsg?Object(F.jsx)(m.a.Fragment,null,Object(F.jsx)(C.EuiToolTip,{position:"top",content:t.warningMsg},Object(F.jsx)(C.EuiIcon,{type:"alert"})),t.label):t.label;return Object(F.jsx)(C.EuiFormRow,{label:r,id:t.id,"data-test-subj":"inputControl"+t.controlIndex},e)}class list_control_ListControlUi extends g.PureComponent{constructor(t){super(t),p()(this,"isMounted",!1),p()(this,"state",{isLoading:!1}),p()(this,"textInput",void 0),p()(this,"componentDidMount",(()=>{this.textInput&&this.textInput.setAttribute("focusable","false"),this.isMounted=!0})),p()(this,"componentWillUnmount",(()=>{this.isMounted=!1})),p()(this,"setTextInputRef",(t=>{this.textInput=t})),p()(this,"handleOnChange",(t=>{const e=t.map((({value:t})=>t));this.props.stageFilter(this.props.controlIndex,e)})),p()(this,"debouncedFetch",b.a.debounce((async t=>{this.props.fetchOptions&&await this.props.fetchOptions(t),this.isMounted&&this.setState({isLoading:!1})}),300)),p()(this,"onSearchChange",(t=>{this.setState({isLoading:!0},this.debouncedFetch.bind(null,t))})),this.textInput=null}renderControl(){var t;const{intl:e}=this.props;if(this.props.disableMsg)return Object(F.jsx)(C.EuiFieldText,{"aria-label":e.formatMessage({id:"inputControl.vis.listControl.selectTextPlaceholder",defaultMessage:"Select..."}),placeholder:e.formatMessage({id:"inputControl.vis.listControl.selectTextPlaceholder",defaultMessage:"Select..."}),disabled:!0});const r=null===(t=this.props.options)||void 0===t?void 0:t.map((t=>({label:this.props.formatOptionLabel(t).toString(),value:t,"data-test-subj":`option_${t.toString().replace(" ","_")}`}))).sort(((t,e)=>t.label.toLowerCase().localeCompare(e.label.toLowerCase()))),n=this.props.selectedOptions.map((t=>({label:this.props.formatOptionLabel(t).toString(),value:t})));return Object(F.jsx)(C.EuiComboBox,{placeholder:e.formatMessage({id:"inputControl.vis.listControl.selectPlaceholder",defaultMessage:"Select..."}),options:r,isLoading:this.state.isLoading,async:this.props.dynamicOptions,onSearchChange:this.props.dynamicOptions?this.onSearchChange:void 0,selectedOptions:n,onChange:this.handleOnChange,singleSelection:!this.props.multiselect,"data-test-subj":`listControlSelect${this.props.controlIndex}`,inputRef:this.setTextInputRef})}render(){const t=j.i18n.translate("inputControl.vis.listControl.partialResultsWarningMessage",{defaultMessage:"Terms list might be incomplete because the request is taking too long. Adjust the autocomplete settings in kibana.yml for complete results."});return Object(F.jsx)(A,{id:this.props.id,label:this.props.label,warningMsg:this.props.partialResults?t:void 0,controlIndex:this.props.controlIndex,disableMsg:this.props.disableMsg},this.renderControl())}}p()(list_control_ListControlUi,"defaultProps",{dynamicOptions:!1,multiselect:!0,selectedOptions:[],options:[]});const S=Object(w.injectI18n)(list_control_ListControlUi);var O=r(14);function M(t,e,r){if(e<=0)return r(t);let n=t;return n*=Math.pow(10,e),n=r(n),n/=Math.pow(10,e),n}class range_control_RangeControl extends g.PureComponent{constructor(...t){super(...t),p()(this,"state",{}),p()(this,"onChangeComplete",b.a.debounce((t=>{const e={min:t[0],max:t[1]};this.props.stageFilter(this.props.controlIndex,e)}),200))}static getDerivedStateFromProps(t,e){const r=t.control.hasValue()?[t.control.value.min,t.control.value.max]:["",""];return t.control.hasValue()&&null==t.control.value.min&&(r[0]=""),t.control.hasValue()&&null==t.control.value.max&&(r[1]=""),r!==e.prevValue?{value:r,prevValue:r}:null}renderControl(){if(!this.props.control.isEnabled())return Object(F.jsx)(O.ValidatedDualRange,{disabled:!0,showInput:!0});const t=b.a.get(this.props,"control.options.decimalPlaces",0),e=function(t,e){return M(t,e,Math.floor)}(this.props.control.min,t),r=function(t,e){return M(t,e,Math.ceil)}(this.props.control.max,t),n=[{value:e,label:e},{value:r,label:r}];return Object(F.jsx)(O.ValidatedDualRange,{id:this.props.control.id,min:e,max:r,value:this.state.value,onChange:this.onChangeComplete,showInput:!0,showRange:!0,showTicks:!0,ticks:n})}render(){return Object(F.jsx)(A,{id:this.props.control.id,label:this.props.control.label,controlIndex:this.props.controlIndex,disableMsg:this.props.control.isEnabled()?void 0:this.props.control.disabledReason},this.renderControl())}}r(26);class input_control_vis_InputControlVis extends g.Component{constructor(t){super(t),this.handleSubmit=this.handleSubmit.bind(this),this.handleReset=this.handleReset.bind(this),this.handleClearAll=this.handleClearAll.bind(this)}handleSubmit(){this.props.submitFilters()}handleReset(){this.props.resetControls()}handleClearAll(){this.props.clearControls()}renderControls(){return this.props.controls.map(((t,e)=>{let r=null;if(function(t){return t.type===_.a.LIST}(t))r=Object(F.jsx)(S,{id:t.id,label:t.label,options:t.selectOptions,selectedOptions:t.value,formatOptionLabel:t.format,disableMsg:t.isEnabled()?void 0:t.disabledReason,multiselect:t.options.multiselect,partialResults:t.partialResults,dynamicOptions:t.options.dynamicOptions,controlIndex:e,stageFilter:this.props.stageFilter,fetchOptions:t=>{this.props.refreshControl(e,t)}});else{if(!function(t){return t.type===_.a.RANGE}(t))throw new Error(`Unhandled control type ${t.type}`);r=Object(F.jsx)(range_control_RangeControl,{control:t,controlIndex:e,stageFilter:this.props.stageFilter})}return Object(F.jsx)(C.EuiFlexItem,{key:t.id,style:{minWidth:"250px"},"data-test-subj":"inputControlItem"},r)}))}renderStagingButtons(){return Object(F.jsx)(C.EuiFlexGroup,{wrap:!0},Object(F.jsx)(C.EuiFlexItem,{grow:!1},Object(F.jsx)(C.EuiButton,{fill:!0,onClick:this.handleSubmit,disabled:!this.props.hasChanges(),"data-test-subj":"inputControlSubmitBtn"},Object(F.jsx)(w.FormattedMessage,{id:"inputControl.vis.inputControlVis.applyChangesButtonLabel",defaultMessage:"Apply changes"}))),Object(F.jsx)(C.EuiFlexItem,{grow:!1},Object(F.jsx)(C.EuiButtonEmpty,{onClick:this.handleReset,disabled:!this.props.hasChanges(),"data-test-subj":"inputControlCancelBtn"},Object(F.jsx)(w.FormattedMessage,{id:"inputControl.vis.inputControlVis.cancelChangesButtonLabel",defaultMessage:"Cancel changes"}))),Object(F.jsx)(C.EuiFlexItem,{grow:!1},Object(F.jsx)(C.EuiButtonEmpty,{onClick:this.handleClearAll,disabled:!this.props.hasValues(),"data-test-subj":"inputControlClearBtn"},Object(F.jsx)(w.FormattedMessage,{id:"inputControl.vis.inputControlVis.clearFormButtonLabel",defaultMessage:"Clear form"}))))}render(){let t;return this.props.controls.length>0&&!this.props.updateFiltersOnChange&&(t=this.renderStagingButtons()),Object(F.jsx)("div",{className:"icvContainer__wrapper"},Object(F.jsx)("div",{className:"icvContainer"},Object(F.jsx)(C.EuiFlexGroup,{wrap:!0},this.renderControls()),t))}}function E(t,e){return j.i18n.translate("inputControl.control.noValuesDisableTooltip",{defaultMessage:'Filtering occurs on the "{fieldName}" field, which doesn\'t exist on any documents in the "{indexPatternName}" index pattern. Choose a different field or index documents that contain values for this field.',values:{fieldName:t,indexPatternName:e}})}function N(t){return j.i18n.translate("inputControl.control.noIndexPatternTooltip",{defaultMessage:"Could not locate index-pattern id: {indexPatternId}.",values:{indexPatternId:t}})}class control_Control{constructor(t,e,r){p()(this,"kbnFilter",null),p()(this,"enable",!1),p()(this,"disabledReason",""),p()(this,"value",void 0),p()(this,"id",void 0),p()(this,"options",void 0),p()(this,"type",void 0),p()(this,"label",void 0),p()(this,"ancestors",[]),p()(this,"format",(t=>{const e=this.filterManager.getIndexPattern(),r=this.filterManager.getField();return r&&e?e.getFormatterForField(r).convert(t):t})),this.controlParams=t,this.filterManager=e,this.useTimeFilter=r,this.id=t.id,this.controlParams=t,this.options=t.options,this.type=t.type,this.label=t.label?t.label:t.fieldName,this.reset(),this.disable(j.i18n.translate("inputControl.control.notInitializedTooltip",{defaultMessage:"Control has not been initialized"}))}setAncestors(t){this.ancestors=t}hasAncestors(){return this.ancestors&&this.ancestors.length>0}hasUnsetAncestor(){return this.ancestors.reduce(((t,e)=>t||!e.hasValue()),!1)}getAncestorValues(){return this.ancestors.map((t=>t.value))}getAncestorFilters(){return this.ancestors.map((t=>t.filterManager.createFilter(t.value)))}isEnabled(){return this.enable}disable(t){this.enable=!1,this.disabledReason=t}set(t){this.value=t,this.hasValue()?this.kbnFilter=this.filterManager.createFilter(this.value):this.kbnFilter=null}reset(){this.kbnFilter=null,this.value=this.filterManager.getValueFromFilterBar()}clear(){this.value=void 0}hasChanged(){return!b.a.isEqual(this.value,this.filterManager.getValueFromFilterBar())}hasKbnFilter(){return!!this.kbnFilter}getKbnFilter(){return this.kbnFilter}hasValue(){return void 0!==this.value}}var P,T,I=r(17),q=r.n(I),k=(r(24),function(t,e){if("boolean"!=typeof e&&"boolean"===t.type){if([1,"true"].includes(e))return!0;if([0,"false"].includes(e))return!1;throw new Error("".concat(e," is not a valid boolean value for boolean field ").concat(t.name))}return"number"!=typeof e&&"number"===t.type?Number(e):e}),R=function(t){var e=Object(v.has)(t,"query.match_phrase"),r=Object(v.get)(t,"query.match",[]),n=void 0!==Object.values(r).find((function(t){return"phrase"===t.type}));return e||n},V=function(t){var e,r,n=null!==(e=null!==(r=t.query.match_phrase)&&void 0!==r?r:t.query.match)&&void 0!==e?e:{};return Object.keys(n)[0]},L=function(t,e,r){var n=k(t,e);return t.scripted?{meta:{index:r.id,field:t.name},query:{script:B(t,e)}}:{meta:{index:r.id},query:{match_phrase:p()({},t.name,n)}}},B=function(t,e){var r=k(t,e);return{script:{source:U(t),lang:t.lang,params:{value:r}}}},U=function(t){return"painless"===t.lang?"boolean compare(Supplier s, def v) {return s.get() == v;}"+"compare(() -> { ".concat(t.script," }, params.value);"):"(".concat(t.script,") == value")};!function(t){t.CUSTOM="custom",t.PHRASES="phrases",t.PHRASE="phrase",t.EXISTS="exists",t.MATCH_ALL="match_all",t.QUERY_STRING="query_string",t.RANGE="range",t.RANGE_FROM_VALUE="range_from_value",t.SPATIAL_FILTER="spatial_filter"}(P||(P={})),function(t){t.APP_STATE="appState",t.GLOBAL_STATE="globalState"}(T||(T={}));var Q=function(t,e,r){var n,i=r.id,s=P.PHRASES,a=t.name;return n=t.scripted?e.map((function(e){return{script:B(t,e)}})):e.map((function(e){return{match_phrase:p()({},t.name,e)}})),{meta:{index:i,type:s,key:a,params:e},query:{bool:{should:n,minimum_should_match:1}}}},$={gt:">",gte:">=",lte:"<=",lt:"<"},z={gt:"boolean gt(Supplier s, def v) {return s.get() > v}",gte:"boolean gte(Supplier s, def v) {return s.get() >= v}",lte:"boolean lte(Supplier s, def v) {return s.get() <= v}",lt:"boolean lt(Supplier s, def v) {return s.get() < v}"},G={gt:"boolean gt(Supplier s, def v) {return s.get().toInstant().isAfter(Instant.parse(v))}",gte:"boolean gte(Supplier s, def v) {return !s.get().toInstant().isBefore(Instant.parse(v))}",lte:"boolean lte(Supplier s, def v) {return !s.get().toInstant().isAfter(Instant.parse(v))}",lt:"boolean lt(Supplier s, def v) {return s.get().toInstant().isBefore(Instant.parse(v))}"},W=function(t,e,r,n){if("gte"in(e=Object(v.mapValues)(e,(function(e){return"number"===t.type?parseFloat(e):e})))&&"gt"in e)throw new Error("gte and gt are mutually exclusive");if("lte"in e&&"lt"in e)throw new Error("lte and lt are mutually exclusive");var i=["gt","lt"].reduce((function(t,r){var n=r in e?r:"".concat(r,"e");return Math.abs(Object(v.get)(e,n))===1/0&&(t++,delete e[n]),t}),0),s=q()({index:r.id,params:{},field:t.name},n?{formattedValue:n}:{});if(2===i)return{meta:s,query:{match_all:{}}};if(t.scripted){var a=D(t,e);return a.script.params.value=function(t){return Object(v.map)(t,(function(t,e){return Object(v.get)($,e)+t})).join(" ")}(a.script.params),{meta:s,query:{script:a}}}return{meta:s,query:{range:p()({},t.name,e)}}},D=function(t,e){var r=Object(v.mapValues)(Object(v.pickBy)(e,(function(t,e){return e in $})),(function(e){return"number"===t.type&&"string"==typeof e?parseFloat(e):e})),n=Object(v.map)(r,(function(e,r){return"("+t.script+")"+Object(v.get)($,r)+r})).join(" && ");if("painless"===t.lang){var i="date"===t.type?G:z,s=Object(v.reduce)(r,(function(t,e,r){return t.concat(Object(v.get)(i,r))}),[]).join(" "),a=Object(v.map)(r,(function(e,r){return"".concat(r,"(() -> { ").concat(t.script," }, params.").concat(r,")")})).join(" && ");n="".concat(s).concat(a)}return{script:{source:n,params:r,lang:t.lang}}};var H=r(22),K=r.n(H),Z=r(21),J=r.n(Z);function X(t){return{type:"literal",value:t}}function Y(t){return t.value}var tt="@kuery-wildcard@";function et(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function rt(t){return t.replace(/[+-=&|><!(){}[\]^"~*?:\\/]/g,"\\$&")}function nt(t){return t.includes(tt)?{type:"wildcard",value:t}:Kt(t)}function it(t,e){var r=t.value.split(tt).map(et).join("[\\s\\S]*");return new RegExp("^".concat(r,"$")).test(e)}function st(t){return t.value.split(tt).join("*")}function at(t){return t.value.split(tt).map(rt).join("*")}function ot(t){var e=t.value;return e.startsWith(tt)&&e.replace(tt,"").length>0}function lt(t,e){if(!e)return[];if("literal"===t.type){var r=Y(t),n=e.fields.find((function(t){return t.name===r}));return n?[n]:[]}return"wildcard"===t.type?e.fields.filter((function(e){return it(t,e.name)})):void 0}var ut=r(15),ct=r.n(ut);function dt(t){var e=ct.a.tz.guess();return"Browser"===t?e:t}function ht(t){return function(t){var e,r=null==t?void 0:t.subType;return!(null==r||null===(e=r.nested)||void 0===e||!e.path)}(t)?t.subType:void 0}function ft(t,e,r){var n=q()(q()({},t),{},{value:r?"".concat(r,".").concat(t.value):t.value});if(!e||"wildcard"===n.type&&!r)return n;var i=lt(n,e).reduce((function(t,e){var n=ht(e),i=null==n?void 0:n.nested.path;return r&&!i?[].concat(K()(t),["".concat(e.name,' is not a nested field but is in nested group "').concat(r,'" in the KQL expression.')]):i&&!r?[].concat(K()(t),["".concat(e.name," is a nested field, but is not in a nested group in the KQL expression.")]):i!==r?[].concat(K()(t),["Nested field ".concat(e.name," is being queried with the incorrect nested path. The correct path is ").concat(null==n?void 0:n.nested.path,".")]):t}),[]);if(i.length>0)throw new Error(i.join("\n"));return n}function pt(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(v.isUndefined)(t))throw new Error("fieldName is a required argument");if(Object(v.isUndefined)(e))throw new Error("value is a required argument");var n="string"==typeof t?Kt(t):X(t),i="string"==typeof e?Kt(e):X(e),s=X(r);return{arguments:[n,i,s]}}function gt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=J()(t.arguments,3),s=i[0],a=i[1],o=i[2],l="wildcard"===a.type&&a.value===tt,u="wildcard"===s.type&&s.value===tt,c=l&&u;if(c)return{match_all:{}};var d=ft(s,e,null!=n&&n.nested?n.nested.path:void 0),h=Object(v.isUndefined)(a)?a:Zt(a),f=o.value?"phrase":"best_fields";if(null===d.value)return"wildcard"===a.type?{query_string:{query:at(a)}}:{multi_match:{type:f,query:h,lenient:!0}};var g=e?lt(d,e):[];if(g&&0===g.length&&g.push({name:Zt(d),scripted:!1,type:""}),l&&(null==g||!g.length||(null==g?void 0:g.length)===(null==e?void 0:e.fields.length)))return{match_all:{}};var m=g.reduce((function(t,e){var i=function(t){var r=ht(e);return"wildcard"!==d.type||null==r||!r.nested||null!=n&&n.nested?t:{nested:{path:r.nested.path,query:t,score_mode:"none"}}};if(!e.scripted){if(l)return[].concat(K()(t),[i({exists:{field:e.name}})]);if("wildcard"===a.type)return[].concat(K()(t),[i({query_string:{fields:[e.name],query:at(a)}})]);if("date"===e.type){var s=r.dateFormatTZ?{time_zone:dt(r.dateFormatTZ)}:{};return[].concat(K()(t),[i({range:p()({},e.name,q()({gte:h,lte:h},s))})])}var o="phrase"===f?"match_phrase":"match";return[].concat(K()(t),[i(p()({},o,p()({},e.name,h)))])}if(!l)return[].concat(K()(t),[{script:q()({},B(e,h))}])}),[]);return{bool:{should:m||[],minimum_should_match:1}}}function mt(t){return{arguments:t}}function vt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=r.filtersInMustClause,s=t.arguments||[],a=i?"must":"filter";return{bool:p()({},a,s.map((function(t){return Zt(t,e,r,n)})))}}function bt(t){return{arguments:t}}function yt(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t.arguments||[];return{bool:{should:i.map((function(t){return Zt(t,e,r,n)})),minimum_should_match:1}}}function xt(t){return{arguments:[t]}}function Ct(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=J()(t.arguments,1),s=i[0];return{bool:{must_not:Zt(s,e,r,n)}}}function wt(t,e,r){return{arguments:[Kt(t),e,Pt.literal.buildNode(r)]}}function _t(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=J()(t.arguments,3),s=i[0],a=i[1],o=i[2],l=ft(s,e,null!=n&&n.nested?n.nested.path:void 0),u=e?lt(l,e):[];u&&0===u.length&&u.push({name:Zt(l),scripted:!1,type:""});var c=u.map((function(t){var e=function(e){var r=ht(t);return"wildcard"!==l.type||null==r||!r.nested||n.nested?e:{nested:{path:r.nested.path,query:e,score_mode:"none"}}},i=p()({},a,Zt(o));if(t.scripted)return{script:D(t,i)};if("date"===t.type){var s=r.dateFormatTZ?{time_zone:dt(r.dateFormatTZ)}:{};return e({range:p()({},t.name,q()(q()({},i),s))})}return e({range:p()({},t.name,i)})}));return{bool:{should:c,minimum_should_match:1}}}function jt(t){return{arguments:[X(t)]}}function Ft(t,e){var r,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=J()(t.arguments,1),s=i[0],a=q()(q()({},s),{},{value:null!=n&&n.nested?"".concat(n.nested.path,".").concat(s.value):s.value}),o=Y(a),l=null==e||null===(r=e.fields)||void 0===r?void 0:r.find((function(t){return t.name===o}));if(null!=l&&l.scripted)throw new Error("Exists query does not support scripted fields");return{exists:{field:o}}}function At(t,e){return{arguments:["string"==typeof t?Kt(t):X(t),e]}}function St(t,e){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=J()(t.arguments,2),a=s[0],o=s[1],l=Zt(a),u=null!=i&&null!==(r=i.nested)&&void 0!==r&&r.path?"".concat(i.nested.path,".").concat(l):l;return{nested:{path:u,query:Zt(o,e,n,q()(q()({},i),{},{nested:{path:u}})),score_mode:"none"}}}var Ot={is:s,and:a,or:o,not:l,range:u,exists:c,nested:d};function Mt(t){var e=Ot[t];if(b.a.isUndefined(e))throw new Error('Unknown function "'.concat(t,'"'));for(var r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return q()({type:"function",function:t},e.buildNodeParams.apply(e,n))}function Et(t,e){if(b.a.isUndefined(Ot[t]))throw new Error('Unknown function "'.concat(t,'"'));return{type:"function",function:t,arguments:e}}function Nt(t,e,r,n){return Ot[t.function].toElasticsearchQuery(t,e,r,n)}var Pt={function:h,literal:n,wildcard:i},Tt=r(31),It=r.n(Tt),qt=r(32),kt=r.n(qt),Rt=r(33),Vt=r.n(Rt),Lt=r(34),Bt=r.n(Lt),Ut=r(35),Qt=r.n(Ut),$t=r(36),zt=r.n($t),Gt=j.i18n.translate("esQuery.kql.errors.endOfInputText",{defaultMessage:"end of input"}),Wt={fieldName:j.i18n.translate("esQuery.kql.errors.fieldNameText",{defaultMessage:"field name"}),value:j.i18n.translate("esQuery.kql.errors.valueText",{defaultMessage:"value"}),literal:j.i18n.translate("esQuery.kql.errors.literalText",{defaultMessage:"literal"}),whitespace:j.i18n.translate("esQuery.kql.errors.whitespaceText",{defaultMessage:"whitespace"})},Dt=(Error,r(25)),Ht=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dt.parse;if(void 0===t)throw new Error("expression must be a string, got undefined instead");return r(t,q()(q()({},e),{},{helpers:{nodeTypes:Pt}}))},Kt=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Ht(t,q()(q()({},e),{},{startRule:"Literal"}),Dt.parse)},Zt=function t(e,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=arguments.length>3?arguments[3]:void 0;if(!e||!e.type||!Pt[e.type])return t(Pt.function.buildNode("and",[]),r);var s=Pt[e.type];return s.toElasticsearchQuery(e,r,n,i)};class filter_manager_FilterManager{constructor(t,e,r,n,i){p()(this,"indexPattern",void 0),this.controlId=t,this.fieldName=e,this.indexPatternId=r,this.indexPatternsService=n,this.queryFilter=i}async init(){try{this.indexPattern||(this.indexPattern=await this.indexPatternsService.get(this.indexPatternId))}catch(t){}}getIndexPattern(){return this.indexPattern}getField(){var t;return null===(t=this.indexPattern)||void 0===t?void 0:t.fields.getByName(this.fieldName)}findFilters(){return b.a.flatten([this.queryFilter.getAppFilters(),this.queryFilter.getGlobalFilters()]).filter((t=>b.a.get(t,"meta.controlledBy")===this.controlId))}}class range_filter_manager_RangeFilterManager extends filter_manager_FilterManager{createFilter(t){const e=this.getIndexPattern(),r=W(e.fields.getByName(this.fieldName),{gte:(n=t).min,lte:n.max},e);var n;return r.meta.key=this.fieldName,r.meta.controlledBy=this.controlId,r}getValueFromFilterBar(){const t=this.findFilters();if(0===t.length)return;let e;return e=b.a.has(t[0],"query.script")?b.a.get(t[0],"query.script.script.params"):b.a.get(t[0],["query","range",this.fieldName]),e?function(t){const e={};return b.a.has(t,"gte")&&(e.min=b.a.get(t,"gte")),b.a.has(t,"gt")&&(e.min=b.a.get(t,"gt")),b.a.has(t,"lte")&&(e.max=b.a.get(t,"lte")),b.a.has(t,"lt")&&(e.max=b.a.get(t,"lt")),e}(e):void 0}}async function Jt({create:t},e,r,n,i,s=[],a){const o=await t(e||{});return o.setParent(void 0),o.setField("filter",(()=>{const t=[...s];if(i){const e=a.createFilter(r);e&&t.push(e)}return t})),o.setField("size",0),o.setField("index",r),o.setField("aggs",n),o}class range_control_factory_RangeControl extends control_Control{constructor(t,e,r,n,i){super(t,e,r),p()(this,"searchSource",void 0),p()(this,"timefilter",void 0),p()(this,"abortController",void 0),p()(this,"min",void 0),p()(this,"max",void 0),this.timefilter=i.data.query.timefilter.timefilter,this.searchSource=n}async fetch(){this.abortController&&this.abortController.abort(),this.abortController=new AbortController;const t=this.filterManager.getIndexPattern();if(!t)return void this.disable(N(this.controlParams.indexPattern));const e=this.filterManager.fieldName,r=(t=>{const e={};return t&&(t.scripted?e.script={source:t.script,lang:t.lang}:e.field=t.name),{maxAgg:{max:e},minAgg:{min:e}}})(t.fields.getByName(e)),n=await Jt(this.searchSource,null,t,r,this.useTimeFilter,[],this.timefilter),i=this.abortController.signal;let s;try{s=await n.fetch({abortSignal:i})}catch(t){if("AbortError"===t.name)return;return void this.disable(j.i18n.translate("inputControl.rangeControl.unableToFetchTooltip",{defaultMessage:"Unable to fetch range min and max, error: {errorMessage}",values:{errorMessage:t.message}}))}const a=b.a.get(s,"aggregations.minAgg.value",null),o=b.a.get(s,"aggregations.maxAgg.value",null);null!==a&&null!==o?(this.min=a,this.max=o,this.enable=!0):this.disable(E(e,t.title))}destroy(){this.abortController&&this.abortController.abort()}}async function Xt(t,e,r){const[,{data:n}]=await r.core.getStartServices(),i=new range_control_factory_RangeControl(t,new range_filter_manager_RangeFilterManager(t.id,t.fieldName,t.indexPattern,n.indexPatterns,r.data.query.filterManager),e,n.search.searchSource,r);return await i.filterManager.init(),i}class phrase_filter_manager_PhraseFilterManager extends filter_manager_FilterManager{constructor(t,e,r,n,i){super(t,e,r,n,i)}createFilter(t){const e=this.getIndexPattern();let r;const n=e.fields.getByName(this.fieldName);if(!n)throw new Error(`Unable to find field with name: ${this.fieldName} on indexPattern`);return r=1===t.length?L(n,t[0],e):Q(n,t,e),r.meta.key=this.fieldName,r.meta.controlledBy=this.controlId,r}getValueFromFilterBar(){const t=this.findFilters();if(0===t.length)return;const e=t.map((t=>this.getValueFromFilter(t))).filter((t=>null!=t));return 0!==e.length?e.reduce(((t,e)=>t.concat(e)),[]):void 0}getValueFromFilter(t){if(b.a.has(t,"query.bool.should"))return b.a.get(t,"query.bool.should").map((t=>this.getValueFromFilter(t))).filter((t=>!!t));if(b.a.has(t,"query.script"))return b.a.get(t,"query.script.script.params.value");if(R(t)){if(V(t)!==this.fieldName)return;return function(t){if(R(t)){var e=t.query.match_phrase||t.query.match||{},r=Object.values(e)[0];return Object(v.isPlainObject)(r)?r.query:r}var n,i,s,a;return null===(n=t.query)||void 0===n||null===(i=n.script)||void 0===i||null===(s=i.script)||void 0===s||null===(a=s.params)||void 0===a?void 0:a.value}(t)}return b.a.has(t,["match_phrase",this.fieldName])?b.a.get(t,["match_phrase",this.fieldName]):void 0}}class list_control_factory_ListControl extends control_Control{constructor(t,e,r,n,i){super(t,e,r),p()(this,"getSettings",void 0),p()(this,"timefilter",void 0),p()(this,"searchSource",void 0),p()(this,"abortController",void 0),p()(this,"lastAncestorValues",void 0),p()(this,"lastQuery",void 0),p()(this,"partialResults",void 0),p()(this,"selectOptions",void 0),p()(this,"fetch",(async t=>{this.abortController&&this.abortController.abort(),this.abortController=new AbortController;const e=this.filterManager.getIndexPattern();if(!e)return void this.disable(N(this.controlParams.indexPattern));let r;if(this.hasAncestors()){if(this.hasUnsetAncestor())return this.disable(j.i18n.translate("inputControl.listControl.disableTooltip",{defaultMessage:"Disabled until '{label}' is set.",values:{label:this.ancestors[0].label}})),void(this.lastAncestorValues=void 0);const e=this.getAncestorValues();if(b.a.isEqual(e,this.lastAncestorValues)&&b.a.isEqual(t,this.lastQuery))return;this.lastAncestorValues=e,this.lastQuery=t,r=this.getAncestorFilters()}const n=this.filterManager.fieldName,i=await this.getSettings(),s={timeout:`${i.autocompleteTimeout}ms`,terminate_after:Number(i.autocompleteTerminateAfter)},a=null==e?void 0:e.fields.getAll().find((({name:t})=>t===this.controlParams.fieldName));a&&"string"!==a.type&&(this.options.dynamicOptions=!1);const o=(({field:t,size:e,direction:r,query:n})=>{const i={order:{_count:r}};return e&&(i.size=e<1?1:e),null!=t&&t.scripted?(i.script={source:t.script,lang:t.lang},i.value_type="number"===t.type?"float":t.type):i.field=null==t?void 0:t.name,n&&(i.include=`.*${function(t=""){return t.replace(/[.?+*|{}[\]()"\\#@&<>~]/g,(t=>`\\${t}`))}(n)}.*`),{termsAgg:{terms:i}}})({field:e.fields.getByName(n),size:this.options.dynamicOptions?null:b.a.get(this.options,"size",5),direction:"desc",query:t}),l=await Jt(this.searchSource,s,e,o,this.useTimeFilter,r,this.timefilter),u=this.abortController.signal;let c;this.lastQuery=t;try{c=await l.fetch({abortSignal:u})}catch(t){if("AbortError"===t.name)return;return void this.disable(j.i18n.translate("inputControl.listControl.unableToFetchTooltip",{defaultMessage:"Unable to fetch terms, error: {errorMessage}",values:{errorMessage:t.message}}))}if(t&&this.lastQuery!==t)return;const d=b.a.get(c,"aggregations.termsAgg.buckets",[]).map((t=>null==t?void 0:t.key));0!==d.length||t?(this.partialResults=c.terminated_early||c.timed_out,this.selectOptions=d,this.enable=!0,this.disabledReason=""):this.disable(E(n,e.title))})),this.getSettings=i.getSettings,this.timefilter=i.data.query.timefilter.timefilter,this.searchSource=n}destroy(){this.abortController&&this.abortController.abort()}hasValue(){return void 0!==this.value&&this.value.length>0}}async function Yt(t,e,r){const[,{data:n}]=await r.core.getStartServices(),i=new list_control_factory_ListControl(t,new phrase_filter_manager_PhraseFilterManager(t.id,t.fieldName,t.indexPattern,n.indexPatterns,r.data.query.filterManager),e,n.search.searchSource,r);return await i.filterManager.init(),i}var te=r(23);const ee=(t,e,r)=>{let n,i=!1;return new class InputControlVisController{constructor(){p()(this,"controls",void 0),p()(this,"queryBarUpdateHandler",void 0),p()(this,"filterManager",void 0),p()(this,"updateSubsciption",void 0),p()(this,"timeFilterSubscription",void 0),p()(this,"visParams",void 0),p()(this,"drawVis",(()=>{var t;if(!n)throw new Error("no i18n context found");Object(y.render)(Object(F.jsx)(n,null,Object(F.jsx)(x.VisualizationContainer,{handlers:e},Object(F.jsx)(input_control_vis_InputControlVis,{updateFiltersOnChange:null===(t=this.visParams)||void 0===t?void 0:t.updateFiltersOnChange,controls:this.controls,stageFilter:this.stageFilter,submitFilters:this.submitFilters,resetControls:this.updateControlsFromKbn,clearControls:this.clearControls,hasChanges:this.hasChanges,hasValues:this.hasValues,refreshControl:this.refreshControl}))),r)})),p()(this,"stageFilter",(async(t,e)=>{var r;this.controls[t].set(e),null!==(r=this.visParams)&&void 0!==r&&r.updateFiltersOnChange?this.submitFilters():(await this.updateNestedControls(),this.drawVis())})),p()(this,"submitFilters",(()=>{var t;const e=this.controls.filter((t=>t.hasChanged())),r=e.map((t=>t.getKbnFilter())).filter((t=>null!==t));e.forEach((t=>{t.filterManager.findFilters().forEach((t=>{this.filterManager.removeFilter(t)}))})),this.controls.map((t=>{t.hasAncestors()&&t.hasUnsetAncestor()&&t.filterManager.findFilters().forEach((t=>{this.filterManager.removeFilter(t)}))})),this.filterManager.addFilters(r,null===(t=this.visParams)||void 0===t?void 0:t.pinFilters)})),p()(this,"clearControls",(async()=>{this.controls.forEach((t=>{t.clear()})),await this.updateNestedControls(),this.drawVis()})),p()(this,"updateControlsFromKbn",(async()=>{this.controls.forEach((t=>{t.reset()})),await this.updateNestedControls(),this.drawVis()})),p()(this,"hasChanges",(()=>this.controls.map((t=>t.hasChanged())).some((t=>t)))),p()(this,"hasValues",(()=>this.controls.map((t=>t.hasValue())).reduce(((t,e)=>t||e)))),p()(this,"refreshControl",(async(t,e)=>{await this.controls[t].fetch(e),this.drawVis()})),this.controls=[],this.queryBarUpdateHandler=this.updateControlsFromKbn.bind(this),this.filterManager=t.data.query.filterManager,this.updateSubsciption=this.filterManager.getUpdates$().subscribe(this.queryBarUpdateHandler),this.timeFilterSubscription=t.data.query.timefilter.timefilter.getTimeUpdate$().subscribe((()=>{var t;null!==(t=this.visParams)&&void 0!==t&&t.useTimeFilter&&(i=!1)}))}async render(e){if(!n){const[{i18n:e}]=await t.core.getStartServices();n=e.Context}i&&Object(v.isEqual)(e,this.visParams)||(this.visParams=e,this.controls=[],this.controls=await this.initControls(e),i=!0),this.drawVis()}destroy(){this.updateSubsciption.unsubscribe(),this.timeFilterSubscription.unsubscribe(),Object(y.unmountComponentAtNode)(r),this.controls.forEach((t=>t.destroy()))}async initControls(e){const r=e.controls.filter((t=>t.indexPattern&&t.fieldName)),n=r.map((r=>function(t){let e=null;switch(t.type){case _.a.RANGE:e=Xt;break;case _.a.LIST:e=Yt;break;default:throw new Error(`Unhandled control type ${t.type}`)}return e}(r)(r,e.useTimeFilter,t))),i=await Promise.all(n),s=t=>i.find((({id:e})=>e===t)),a=[];return Object(te.a)(r).forEach(((t,e)=>{t.shift();const r=[];t.forEach((t=>{const e=s(t);e&&r.push(e)}));const n=s(e);n&&(n.setAncestors(r),a.push(n.fetch()))})),await Promise.all(a),i}async updateNestedControls(){const t=this.controls.map((async t=>{t.hasAncestors()&&await t.fetch()}));return await Promise.all(t)}}}}]]);