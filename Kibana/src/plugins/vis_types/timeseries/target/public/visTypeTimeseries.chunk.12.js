(window.visTypeTimeseries_bundle_jsonpfunction=window.visTypeTimeseries_bundle_jsonpfunction||[]).push([[12],{192:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return w}));var a=r(0),s=r(53),o=r(48),n=r(54),l=r(17),i=r.n(l),c=r(4),d=r.n(c),b=r(44),u=r(56),p=r(41),j=r(64),m=r.n(j),f=r(1);const x="positive",_="negative",h="mixed";class top_n_TopN extends c.Component{constructor(e){super(e),this.tableRef=d.a.createRef(),this.state={labelMaxWidth:150}}get labelMaxWidth(){return.35*this.tableRef.current.offsetWidth}componentDidMount(){this.setState({labelMaxWidth:this.labelMaxWidth})}componentDidUpdate(e,t){t.labelMaxWidth!==this.labelMaxWidth&&this.setState({labelMaxWidth:this.labelMaxWidth})}handleClick(e){return()=>{this.props.onClick&&this.props.onClick(e)}}renderRow({min:e,max:t}){return r=>{const a=top_n_TopN.getRenderMode(e,t),s=`${r.id||r.label}`,o=Object(b.b)(r.data),n=Object(b.c)(o)?0:o,l=r.tickFormatter||this.props.tickFormatter,i=n>=0,c=top_n_TopN.calcDomain(a,e,t),d=Math.abs(n)/c*100||0,j=Object(b.c)(o)?"1px":`${d}%`,x=r.labelFormatted?Object(u.a)(r.labelFormatted):r.label,_=m()({default:{innerBar:{...top_n_TopN.calcInnerBarStyles(a,i)},innerBarValue:{...top_n_TopN.calcInnerBarDivStyles(r,j,i)},label:{maxWidth:this.state.labelMaxWidth}},onClickStyle:{row:{cursor:"pointer"}}},{onClickStyle:"function"==typeof this.props.onClick});return Object(f.jsx)("tr",{key:s,onClick:this.handleClick({lastValue:o,...r}),style:_.row},Object(f.jsx)("td",{title:r.label,className:"tvbVisTopN__label",style:_.label},Object(p.b)(x)),Object(f.jsx)("td",{width:"100%",className:"tvbVisTopN__bar"},Object(f.jsx)("div",{className:"tvbVisTopN__innerBar",style:_.innerBar},Object(f.jsx)("div",{style:_.innerBarValue,"data-test-subj":"topNInnerBar"}))),Object(f.jsx)("td",{className:"tvbVisTopN__value","data-test-subj":"tsvbTopNValue"},Object(f.jsx)("span",{dangerouslySetInnerHTML:{__html:l(o)}})))}}render(){if(!this.props.series)return null;const e=this.props.series.reduce(((e,t,r)=>{var a;const s=null!==(a=Object(b.b)(t.data))&&void 0!==a?a:0;return{min:!r||s<e.min?s:e.min,max:!r||s>e.max?s:e.max}}),{min:void 0,max:void 0}),t=this.props.series.map(this.renderRow(e));let r="tvbVisTopN";return this.props.reversed&&(r+=" tvbVisTopN--reversed"),Object(f.jsx)("div",{className:r},Object(f.jsx)("table",{className:"tvbVisTopN__table","data-test-subj":"tvbVisTopNTable",ref:this.tableRef},Object(f.jsx)("tbody",null,t)))}}i()(top_n_TopN,"getRenderMode",((e,t)=>e>=0?x:t<0?_:h)),i()(top_n_TopN,"calcInnerBarStyles",((e,t)=>e===h?{[t?"marginLeft":"marginRight"]:"50%"}:{})),i()(top_n_TopN,"calcInnerBarDivStyles",((e,t,r)=>({backgroundColor:e.color,width:t,float:r?"left":"right"}))),i()(top_n_TopN,"calcDomain",((e,t,r)=>e===h?Math.max(r,Math.abs(t)):e===_?Math.abs(t):r)),top_n_TopN.defaultProps={tickFormatter:e=>e,direction:"desc"};var v=r(63),O=r(55),T=r(9),y=r(2),g=r(60),M=r(75),k=r(8);function N(e,t){const r=Object(T.get)(e,`${t.id}.series`,[]);return t.series.reduce(((e,t)=>{const a=r.filter((e=>Object(T.first)(e.id.split(k.c))===t.id)),s=t.terms_direction||"desc";return"_key"===t.terms_order_by?e.concat(a):e.concat(function(e,t,r){return"desc"===t?Object(T.sortBy)(e,r).reverse():Object(T.sortBy)(e,r)}(a,s,(e=>Object(b.b)(e.data))))}),[])}function w(e){const[t,r]=Object(c.useState)(null),l=Object(a.b)(),{backgroundColor:i,model:d,visData:u,fieldFormatMap:p,getConfig:j}=e,m=N(u,d).map((e=>{const t=Object(T.first)(e.id.split(k.c)),r=d.series.find((e=>e.id===t));if(r){const t=r.formatter===y.b.DEFAULT?Object(n.a)(Object(s.a)(r.metrics),p,"html"):Object(o.a)(r.formatter,r.value_template,j),a=Object(b.b)(e.data);let l=e.color||r.color;return d.bar_color_rules&&d.bar_color_rules.forEach((e=>{Object(g.c)(e,a)&&e.operator&&e.bar_color&&Object(g.b)(e.operator)(a,e.value)&&(l=e.bar_color)})),{...e,color:l,tickFormatter:t}}return e})),x=d.background_color||i,_={backgroundColor:x},h={series:m,reversed:Object(v.b)(x)};d.drilldown_url&&(h.onClick=e=>{const t=Object(O.a)(d.drilldown_url,{},{key:e.label});l.http.externalUrl.validateUrl(t)?(r(null),l.application.navigateToUrl(t)):r(t)});const w=Object(c.useCallback)((()=>r(null)),[]);return Object(f.jsx)("div",{className:"tvbVis",style:_},Object(f.jsx)(top_n_TopN,h),t&&Object(f.jsx)(M.a,{url:t,handleClose:w}))}},55:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var a=r(61),s=r.n(a),o=r(7),n=r(41);function l(e,t={},r={},a={}){try{const o=s.a.compile(e.split(n.a).join(`[${n.a}]`),{strict:!0,knownHelpersOnly:!0,...a});return o({...r,args:t})}catch(t){if(-1!==t.toString().indexOf("Parse error"))return e;if(-1!==t.message.indexOf("not defined in")){const e=t.message.split(/"/)[1];t.error={caused_by:{reason:o.i18n.translate("visTypeTimeseries.replaceVars.errors.unknownVarDescription",{defaultMessage:"{badVar} is an unknown variable",values:{badVar:"{{"+e+"}}"}}),title:o.i18n.translate("visTypeTimeseries.replaceVars.errors.unknownVarTitle",{defaultMessage:"Error processing your markdown"})}}}else t.error={caused_by:{reason:o.i18n.translate("visTypeTimeseries.replaceVars.errors.markdownErrorDescription",{defaultMessage:"Please verify you are only using markdown, known variables, and built-in Handlebars expressions"}),title:o.i18n.translate("visTypeTimeseries.replaceVars.errors.markdownErrorTitle",{defaultMessage:"Error processing your markdown"})}};return t}}},75:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));r(4);var a=r(16),s=r(15),o=r(1);const n=({url:e,handleClose:t})=>Object(o.jsx)(s.EuiModal,{onClose:t},Object(o.jsx)(s.EuiModalHeader,null,Object(o.jsx)(s.EuiModalHeaderTitle,null,Object(o.jsx)(a.FormattedMessage,{id:"visTypeTimeseries.externalUrlErrorModal.headerTitle",defaultMessage:"Access to this external URL is not yet enabled"}))),Object(o.jsx)(s.EuiModalBody,null,Object(o.jsx)(a.FormattedMessage,{id:"visTypeTimeseries.externalUrlErrorModal.bodyMessage",defaultMessage:"Configure {externalUrlPolicy} in your {kibanaConfigFileName} to allow access to {url}.",values:{url:Object(o.jsx)(s.EuiTextColor,{color:"warning",component:"span"},e),externalUrlPolicy:"externalUrl.policy",kibanaConfigFileName:"kibana.yml"}})),Object(o.jsx)(s.EuiModalFooter,null,Object(o.jsx)(s.EuiButton,{onClick:t,fill:!0},Object(o.jsx)(a.FormattedMessage,{id:"visTypeTimeseries.externalUrlErrorModal.closeButtonLabel",defaultMessage:"Close"}))))}}]);