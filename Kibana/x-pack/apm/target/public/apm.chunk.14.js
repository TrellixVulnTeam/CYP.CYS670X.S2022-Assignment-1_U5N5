/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[14],{101:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return r}));var n=a(134);function i(e){return t=>e(t).formatted}function r(e){const t=null==e?void 0:e.flatMap((e=>e.data)).map((e=>e.y)).filter(n.a);return null!=t&&t.length?Math.max(...t,0):0}},1041:function(e,t,a){"use strict";a.r(t),a.d(t,"TransactionDurationAlertTrigger",(function(){return y}));var n=a(8),i=a(0),r=a(26),l=a(1),o=a.n(l),s=a(11),c=a(44),u=a(3),d=a(59),m=a(53),p=a(64),g=a(101),v=a(128),f=a(107),h=a(129),w=a(106),E=a(92);const b={avg:i.i18n.translate("xpack.apm.transactionDurationAlert.aggregationType.avg",{defaultMessage:"Average"}),"95th":i.i18n.translate("xpack.apm.transactionDurationAlert.aggregationType.95th",{defaultMessage:"95th percentile"}),"99th":i.i18n.translate("xpack.apm.transactionDurationAlert.aggregationType.99th",{defaultMessage:"99th percentile"})};function y(e){var t;const{services:a}=Object(s.useKibana)(),{ruleParams:y,metadata:x,setRuleParams:O,setRuleProperty:T}=e;Object(l.useEffect)((()=>{Object(p.createCallApmApi)(a)}),[a]);const S=Object(r.defaults)({...Object(r.omit)(x,["start","end"]),...y},{aggregationType:"avg",threshold:1500,windowSize:5,windowUnit:"m",environment:u.a.value}),{data:C}=Object(m.b)((e=>{const{interval:t,start:a,end:n}=Object(h.a)({windowSize:S.windowSize,windowUnit:S.windowUnit});if(t&&a&&n)return e("GET /internal/apm/alerts/chart_preview/transaction_duration",{params:{query:{aggregationType:S.aggregationType,environment:S.environment,serviceName:S.serviceName,transactionType:S.transactionType,interval:t,start:a,end:n}}})}),[S.aggregationType,S.environment,S.serviceName,S.transactionType,S.windowSize,S.windowUnit]),k=null!==(t=null==C?void 0:C.latencyChartPreview)&&void 0!==t?t:[],j=Object(g.a)([{data:k}]),A=Object(d.l)(j),M=Object(g.b)(A),P=1e3*S.threshold,_=o.a.createElement(v.a,{data:k,threshold:P,yTickFormat:M,uiSettings:a.uiSettings}),V=[o.a.createElement(f.c,{allowAll:!1,currentValue:S.serviceName,onChange:e=>O("serviceName",e)}),o.a.createElement(f.d,{currentValue:S.transactionType,onChange:e=>O("transactionType",e)}),o.a.createElement(f.a,{currentValue:S.environment,onChange:e=>O("environment",e)}),o.a.createElement(E.a,{value:S.aggregationType,title:i.i18n.translate("xpack.apm.transactionDurationAlertTrigger.when",{defaultMessage:"When"})},o.a.createElement(n.EuiSelect,{value:S.aggregationType,options:Object(r.map)(b,((e,t)=>({text:e,value:t}))),onChange:e=>O("aggregationType",e.target.value),compressed:!0})),o.a.createElement(f.b,{value:S.threshold,unit:i.i18n.translate("xpack.apm.transactionDurationAlertTrigger.ms",{defaultMessage:"ms"}),onChange:e=>O("threshold",e||0)}),o.a.createElement(c.ForLastExpression,{onChangeWindowSize:e=>O("windowSize",e||""),onChangeWindowUnit:e=>O("windowUnit",e),timeWindowSize:S.windowSize,timeWindowUnit:S.windowUnit,errors:{timeWindowSize:[],timeWindowUnit:[]}})];return o.a.createElement(w.a,{chartPreview:_,defaults:S,fields:V,setRuleParams:O,setRuleProperty:T})}t.default=y},106:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(8),i=a(1),r=a.n(i);function l(e){const{fields:t,setRuleParams:a,defaults:l,chartPreview:o}=e,s={...l};return Object(i.useEffect)((()=>{Object.keys(s).forEach((e=>{a(e,s[e])}))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement(n.EuiSpacer,{size:"l"}),r.a.createElement(n.EuiFlexGrid,{gutterSize:"l",direction:"row",columns:2},t.map(((e,t)=>r.a.createElement(n.EuiFlexItem,{grow:!1,key:t},e)))),o,r.a.createElement(n.EuiSpacer,{size:"m"}))}},107:function(e,t,a){"use strict";a.d(t,"c",(function(){return f})),a.d(t,"a",(function(){return h})),a.d(t,"d",(function(){return w})),a.d(t,"b",(function(){return E}));var n=a(8),i=a(0),r=a(1),l=a.n(r),o=a(10),s=a(3),c=a(26),u=a(53);function d({allOption:e,customOptionText:t,defaultValue:a,field:i,onChange:o,placeholder:s}){var d;let m;!!e&&!a&&(m=e),a&&(m={label:a,value:a});const[p,g]=Object(r.useState)(m?[m]:[]),[v,f]=Object(r.useState)(""),{data:h,status:w}=Object(u.b)((e=>e("GET /internal/apm/suggestions",{params:{query:{field:i,string:v}}})),[i,v],{preservePreviousData:!1}),E=Object(r.useCallback)((e=>{g(e),1===e.length&&o(e[0].value?e[0].value.trim():e[0].value)}),[o]),b=Object(r.useCallback)((e=>{E([{label:e,value:e}])}),[E]),y=null!==(d=null==h?void 0:h.terms)&&void 0!==d?d:[],x=[...!e||""!==v&&v.toLowerCase()!==e.label.toLowerCase()?[]:[e],...y.map((e=>({label:e,value:e})))];return l.a.createElement(n.EuiComboBox,{async:!0,compressed:!0,customOptionText:t,isLoading:w===u.a.LOADING,onChange:E,onCreateOption:b,onSearchChange:Object(c.debounce)(f,500),options:x,placeholder:s,selectedOptions:p,singleSelection:{asPlainText:!0},style:{minWidth:"256px"}})}var m=a(92);const p=i.i18n.translate("xpack.apm.alerting.fields.allOption",{defaultMessage:"All"}),g={label:p,value:p},v={label:s.a.text,value:s.a.value};function f({allowAll:e=!0,currentValue:t,onChange:a}){return l.a.createElement(m.a,{value:t||g.value,title:i.i18n.translate("xpack.apm.alerting.fields.service",{defaultMessage:"Service"})},l.a.createElement(d,{allOption:e?g:void 0,customOptionText:i.i18n.translate("xpack.apm.serviceNamesSelectCustomOptionText",{defaultMessage:"Add \\{searchValue\\} as a new service name"}),defaultValue:t,field:o.v,onChange:a,placeholder:i.i18n.translate("xpack.apm.serviceNamesSelectPlaceholder",{defaultMessage:"Select service name"})}))}function h({currentValue:e,onChange:t}){return l.a.createElement(m.a,{value:Object(s.c)(e),title:i.i18n.translate("xpack.apm.alerting.fields.environment",{defaultMessage:"Environment"})},l.a.createElement(d,{allOption:v,customOptionText:i.i18n.translate("xpack.apm.environmentsSelectCustomOptionText",{defaultMessage:"Add \\{searchValue\\} as a new environment"}),defaultValue:Object(s.c)(e),field:o.u,onChange:t,placeholder:i.i18n.translate("xpack.apm.environmentsSelectPlaceholder",{defaultMessage:"Select environment"})}))}function w({currentValue:e,onChange:t}){const a=i.i18n.translate("xpack.apm.alerting.fields.type",{defaultMessage:"Type"});return l.a.createElement(m.a,{value:e||g.value,title:a},l.a.createElement(d,{allOption:g,customOptionText:i.i18n.translate("xpack.apm.transactionTypesSelectCustomOptionText",{defaultMessage:"Add \\{searchValue\\} as a new transaction type"}),defaultValue:e,field:o.J,onChange:t,placeholder:i.i18n.translate("xpack.apm.transactionTypesSelectPlaceholder",{defaultMessage:"Select transaction type"})}))}function E({value:e,unit:t,onChange:a,step:r}){return l.a.createElement(m.a,{value:e?`${e.toString()}${t}`:"",title:i.i18n.translate("xpack.apm.transactionErrorRateAlertTrigger.isAbove",{defaultMessage:"is above"})},l.a.createElement(n.EuiFieldNumber,{value:null!=e?e:"",onChange:e=>a(parseInt(e.target.value,10)),append:t,compressed:!0,step:r}))}},128:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(30),i=a(8),r=a(1),l=a.n(r),o=a(60),s=a(117);function c({data:e=[],yTickFormat:t,threshold:a,uiSettings:r}){const c=Object(o.a)(),u=e.map((e=>e.x)),d=Math.min(...u),m=Math.max(...u),p=Object(n.niceTimeFormatter)([d,m]),g=e.map((e=>{var t;return null!==(t=e.y)&&void 0!==t?t:0})),v=Math.max(...g,1.2*a),f={fill:c.eui.euiColorVis2,line:{strokeWidth:2,stroke:c.eui.euiColorVis2,opacity:1},opacity:.3},h=[{coordinates:{x0:null,x1:null,y0:a,y1:null}}],w=Object(s.a)(r);return l.a.createElement(l.a.Fragment,null,l.a.createElement(i.EuiSpacer,{size:"m"}),l.a.createElement(n.Chart,{size:{height:150},"data-test-subj":"ChartPreview"},l.a.createElement(n.Settings,{tooltip:"none"}),l.a.createElement(n.LineAnnotation,{dataValues:[{dataValue:a}],domainType:n.AnnotationDomainType.YDomain,id:"chart_preview_line_annotation",markerPosition:"left",style:f}),l.a.createElement(n.RectAnnotation,{dataValues:h,hideTooltips:!0,id:"chart_preview_rect_annotation",style:f}),l.a.createElement(n.Axis,{id:"chart_preview_x_axis",position:n.Position.Bottom,showOverlappingTicks:!0,tickFormat:p}),l.a.createElement(n.Axis,{id:"chart_preview_y_axis",position:n.Position.Left,tickFormat:t,ticks:5,domain:{max:v,min:NaN}}),l.a.createElement(n.BarSeries,{timeZone:w,color:c.eui.euiColorVis1,data:e,id:"chart_preview_bar_series",xAccessor:"x",xScaleType:n.ScaleType.Time,yAccessors:["y"],yScaleType:n.ScaleType.Linear})))}},129:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(31),i=a.n(n);function r({windowSize:e,windowUnit:t}){const a=Date.now(),n=a-20*i.a.duration(e,t).asMilliseconds();return{interval:`${e}${t}`,start:new Date(n).toISOString(),end:new Date(a).toISOString()}}},92:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(1),i=a.n(n),r=a(8);function l(e){const{title:t,value:a,children:l}=e,[o,s]=Object(n.useState)(!1);return i.a.createElement(r.EuiPopover,{isOpen:o,anchorPosition:"downLeft",closePopover:()=>s(!1),button:i.a.createElement(r.EuiExpression,{description:t,value:a,isActive:o,onClick:()=>s(!0)}),repositionOnScroll:!0},l)}}}]);