/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.apm_bundle_jsonpfunction=window.apm_bundle_jsonpfunction||[]).push([[17],{1047:function(e,t,a){"use strict";a.r(t),a.d(t,"uxRoutes",(function(){return Ut})),a.d(t,"UXAppRoot",(function(){return qt})),a.d(t,"renderApp",(function(){return Yt}));var n=a(34),r=a(8),l=a(1),i=a.n(l),s=a(45),o=a.n(s),c=a(27),u=a(84),d=a(29),m=a.n(d),p=a(0),E=a(11),g=a(193),b=a(9),f=a(26),h=a(132),v=a(61),x=a(99),y=a(56);var T=a(79);const k={dataMissing:p.i18n.translate("xpack.apm.rum.dashboard.dataMissing",{defaultMessage:"N/A"}),totalPageLoad:p.i18n.translate("xpack.apm.rum.dashboard.totalPageLoad",{defaultMessage:"Total"}),backEnd:p.i18n.translate("xpack.apm.rum.dashboard.backend",{defaultMessage:"Backend"}),frontEnd:p.i18n.translate("xpack.apm.rum.dashboard.frontend",{defaultMessage:"Frontend"}),pageViews:p.i18n.translate("xpack.apm.rum.dashboard.pageViews",{defaultMessage:"Total page views"}),percPageLoaded:p.i18n.translate("xpack.apm.rum.dashboard.pagesLoaded.label",{defaultMessage:"Pages loaded"}),pageLoadTime:p.i18n.translate("xpack.apm.rum.dashboard.pageLoadTime.label",{defaultMessage:"Page load time (seconds)"}),pageLoadTimes:p.i18n.translate("xpack.apm.rum.dashboard.pageLoadTimes.label",{defaultMessage:"Page load times"}),pageLoadDuration:p.i18n.translate("xpack.apm.rum.dashboard.pageLoadDuration.label",{defaultMessage:"Page load duration"}),pageLoad:p.i18n.translate("xpack.apm.rum.dashboard.pageLoad.label",{defaultMessage:"Page load"}),pageLoadDistribution:p.i18n.translate("xpack.apm.rum.dashboard.pageLoadDistribution.label",{defaultMessage:"Page load distribution"}),jsErrors:p.i18n.translate("xpack.apm.rum.dashboard.impactfulMetrics.jsErrors",{defaultMessage:"JavaScript errors"}),highTrafficPages:p.i18n.translate("xpack.apm.rum.dashboard.impactfulMetrics.highTrafficPages",{defaultMessage:"High traffic pages"}),resetZoom:p.i18n.translate("xpack.apm.rum.dashboard.resetZoom.label",{defaultMessage:"Reset zoom"}),overall:p.i18n.translate("xpack.apm.rum.dashboard.overall.label",{defaultMessage:"Overall"}),selectBreakdown:p.i18n.translate("xpack.apm.rum.filterGroup.selectBreakdown",{defaultMessage:"Select breakdown"}),breakdown:p.i18n.translate("xpack.apm.rum.filterGroup.breakdown",{defaultMessage:"Breakdown"}),seconds:p.i18n.translate("xpack.apm.rum.filterGroup.seconds",{defaultMessage:"seconds"}),coreWebVitals:p.i18n.translate("xpack.apm.rum.filterGroup.coreWebVitals",{defaultMessage:"Core web vitals"}),browser:p.i18n.translate("xpack.apm.rum.visitorBreakdown.browser",{defaultMessage:"Browser"}),operatingSystem:p.i18n.translate("xpack.apm.rum.visitorBreakdown.operatingSystem",{defaultMessage:"Operating system"}),metrics:p.i18n.translate("xpack.apm.ux.metrics",{defaultMessage:"Metrics"}),median:p.i18n.translate("xpack.apm.ux.median",{defaultMessage:"median"}),avgPageLoadDuration:p.i18n.translate("xpack.apm.rum.visitorBreakdownMap.avgPageLoadDuration",{defaultMessage:"Average page load duration"}),pageLoadDurationByRegion:p.i18n.translate("xpack.apm.rum.visitorBreakdownMap.pageLoadDurationByRegion",{defaultMessage:"Page load duration by region (avg.)"}),filterByUrl:p.i18n.translate("xpack.apm.rum.filters.filterByUrl",{defaultMessage:"Filter by URL"}),getSearchResultsLabel:e=>p.i18n.translate("xpack.apm.rum.filters.searchResults",{defaultMessage:"{total} Search results",values:{total:e}}),topPages:p.i18n.translate("xpack.apm.rum.filters.topPages",{defaultMessage:"Top pages"}),select:p.i18n.translate("xpack.apm.rum.filters.select",{defaultMessage:"Select"}),url:p.i18n.translate("xpack.apm.rum.filters.url",{defaultMessage:"Url"}),loadingResults:p.i18n.translate("xpack.apm.rum.filters.url.loadingResults",{defaultMessage:"Loading results"}),noResults:p.i18n.translate("xpack.apm.rum.filters.url.noResults",{defaultMessage:"No results available"}),totalErrors:p.i18n.translate("xpack.apm.rum.jsErrors.totalErrors",{defaultMessage:"Total errors"}),errorRate:p.i18n.translate("xpack.apm.rum.jsErrors.errorRate",{defaultMessage:"Error rate"}),errorMessage:p.i18n.translate("xpack.apm.rum.jsErrors.errorMessage",{defaultMessage:"Error message"}),impactedPageLoads:p.i18n.translate("xpack.apm.rum.jsErrors.impactedPageLoads",{defaultMessage:"Impacted page loads"}),percentile:p.i18n.translate("xpack.apm.ux.percentile.label",{defaultMessage:"Percentile"}),percentile50thMedian:p.i18n.translate("xpack.apm.ux.percentile.50thMedian",{defaultMessage:"50th (Median)"}),percentile75th:p.i18n.translate("xpack.apm.ux.percentile.75th",{defaultMessage:"75th"}),percentile90th:p.i18n.translate("xpack.apm.ux.percentile.90th",{defaultMessage:"90th"}),percentile95th:p.i18n.translate("xpack.apm.ux.percentile.95th",{defaultMessage:"95th"}),percentile99th:p.i18n.translate("xpack.apm.ux.percentile.99th",{defaultMessage:"99th"}),noData:p.i18n.translate("xpack.apm.ux.visitorBreakdown.noData",{defaultMessage:"No data."}),totalPageLoadTooltip:p.i18n.translate("xpack.apm.rum.dashboard.tooltips.totalPageLoad",{defaultMessage:"Total represents the full page load duration"}),frontEndTooltip:p.i18n.translate("xpack.apm.rum.dashboard.tooltips.frontEnd",{defaultMessage:"Frontend time represents the total page load duration minus the backend time"}),backEndTooltip:p.i18n.translate("xpack.apm.rum.dashboard.tooltips.backEnd",{defaultMessage:"Backend time represents time to first byte (TTFB), which is when the first response packet is received after the request has been made"})},S=p.i18n.translate("xpack.apm.rum.visitorBreakdown",{defaultMessage:"Visitor breakdown"});var O=a(33),w=a.n(O);const F=p.i18n.translate("xpack.apm.rum.coreVitals.dataUndefined",{defaultMessage:"N/A"}),j=p.i18n.translate("xpack.apm.rum.coreVitals.fcp",{defaultMessage:"First contentful paint"}),P=p.i18n.translate("xpack.apm.rum.coreVitals.fcpTooltip",{defaultMessage:"First contentful paint (FCP) focusses on the initial rendering and measures the time from when the page starts loading to when any part of the pageâ€™s content is displayed on the screen."}),M=p.i18n.translate("xpack.apm.rum.coreVitals.tbt",{defaultMessage:"Total blocking time"}),I=p.i18n.translate("xpack.apm.rum.coreVitals.tbtTooltip",{defaultMessage:"Total blocking time (TBT) is the sum of the blocking time (duration above 50 ms) for each long task that occurs between the First contentful paint and the time when the transaction is completed."}),L=p.i18n.translate("xpack.apm.rum.uxMetrics.noOfLongTasks",{defaultMessage:"No. of long tasks"}),C=p.i18n.translate("xpack.apm.rum.uxMetrics.noOfLongTasksTooltip",{defaultMessage:"The number of long tasks, a long task is defined as any user activity or browser task that monopolizes the UI thread for extended periods (greater than 50 milliseconds) and blocks other critical tasks (frame rate or input latency) from being executed."}),_=p.i18n.translate("xpack.apm.rum.uxMetrics.longestLongTasks",{defaultMessage:"Longest long task duration"}),R=p.i18n.translate("xpack.apm.rum.uxMetrics.longestLongTasksTooltip",{defaultMessage:"The duration of the longest long task, a long task is defined as any user activity or browser task that monopolizes the UI thread for extended periods (greater than 50 milliseconds) and blocks other critical tasks (frame rate or input latency) from being executed."}),A=p.i18n.translate("xpack.apm.rum.uxMetrics.sumLongTasks",{defaultMessage:"Total long tasks duration"}),D=p.i18n.translate("xpack.apm.rum.uxMetrics.sumLongTasksTooltip",{defaultMessage:"The total duration of long tasks, a long task is defined as any user activity or browser task that monopolizes the UI thread for extended periods (greater than 50 milliseconds) and blocks other critical tasks (frame rate or input latency) from being executed."}),N=e=>50===e?k.median:p.i18n.translate("xpack.apm.ux.percentiles.label",{defaultMessage:"{value}th Perc.",values:{value:e}});var z=a(53);function B(){const{urlParams:e,uxUiFilters:t}=Object(y.a)(),{start:a,end:n,searchTerm:r,percentile:i}=e;return Object(l.useMemo)((()=>{const{serviceName:e}=t;return a&&n&&e&&i?{start:a,end:n,percentile:String(i),urlQuery:r||void 0,uiFilters:JSON.stringify(t)}:null}),[a,n,r,i,t])}function V(e,t="MicroSec"){const a=Number(null!=e?e:0)/("MicroSec"===t?1e3:1);return a<1e3?a.toFixed(0)+" ms":(a/1e3).toFixed(2)+" s"}const U={width:"200px"};function G(e,t){return null==t?F:V(t,e)}function H({data:e,loading:t}){const a=B(),{data:n,status:l}=Object(z.b)((e=>a?e("GET /internal/apm/ux/long-task-metrics",{params:{query:{...a}}}):Promise.resolve(null)),[a]);return i.a.createElement(r.EuiFlexGroup,{wrap:!0,responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:!1,style:U},i.a.createElement(r.EuiStat,{titleSize:"s",title:G("ms",null==e?void 0:e.fcp),description:i.a.createElement(i.a.Fragment,null,j,i.a.createElement(r.EuiIconTip,{content:P,type:"questionInCircle"})),isLoading:t})),i.a.createElement(r.EuiFlexItem,{grow:!1,style:U},i.a.createElement(r.EuiStat,{titleSize:"s",title:G("ms",null==e?void 0:e.tbt),description:i.a.createElement(i.a.Fragment,null,M,i.a.createElement(r.EuiIconTip,{content:I,type:"questionInCircle"})),isLoading:t})),i.a.createElement(r.EuiFlexItem,{grow:!1,style:U},i.a.createElement(r.EuiStat,{titleSize:"s",title:void 0!==(null==n?void 0:n.noOfLongTasks)?w()(null==n?void 0:n.noOfLongTasks).format("0,0"):F,description:i.a.createElement(i.a.Fragment,null,L,i.a.createElement(r.EuiIconTip,{content:C,type:"questionInCircle"})),isLoading:"success"!==l})),i.a.createElement(r.EuiFlexItem,{grow:!1,style:U},i.a.createElement(r.EuiStat,{titleSize:"s",title:G("ms",null==n?void 0:n.longestLongTask),description:i.a.createElement(i.a.Fragment,null,_,i.a.createElement(r.EuiIconTip,{content:R,type:"questionInCircle"})),isLoading:"success"!==l})),i.a.createElement(r.EuiFlexItem,{grow:!1,style:U},i.a.createElement(r.EuiStat,{titleSize:"s",title:G("ms",null==n?void 0:n.sumOfLongTasks),description:i.a.createElement(i.a.Fragment,null,A,i.a.createElement(r.EuiIconTip,{content:D,type:"questionInCircle"})),isLoading:"success"!==l})))}const q=m.a.span.withConfig({displayName:"StyledSpan",componentId:"sc-kab9ht-0"})(["color:",";font-weight:500;:not(:last-of-type)::after{content:'â€¢';margin:0 4px;}"],n.euiLightVars.euiColorSuccessText),Y=m.a.span.withConfig({displayName:"StyledListSpan",componentId:"sc-kab9ht-1"})(["display:block;margin-top:4px;font-size:12px;"]);function W(e,t){return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiHighlight,{className:"euiSelectableTemplateSitewide__listItemTitle",search:t},e.label),function(e){if(!e||e.length<1)return;return i.a.createElement(Y,null,e.map((e=>i.a.createElement(q,{key:e},e))))}(e.meta))}var $=a(198),K=a.n($);const J=e=>({includedItems:Object(f.map)(e.filter((({checked:e,isWildcard:t})=>"on"===e&&!t)),"label"),excludedItems:Object(f.map)(e.filter((({checked:e,isWildcard:t})=>"off"===e&&!t)),"label"),includedWildcards:Object(f.map)(e.filter((({checked:e,isWildcard:t})=>"on"===e&&t)),"title"),excludedWildcards:Object(f.map)(e.filter((({checked:e,isWildcard:t})=>"off"===e&&t)),"title")});function Q({onChange:e,updateSearchTerm:t}){var a;const{uxUiFilters:{transactionUrl:n,transactionUrlExcluded:r},urlParams:s}=Object(y.a)(),{searchTerm:o,percentile:c}=s,[u,d]=Object(l.useState)(!1),[m,E]=Object(l.useState)(""),[g,h]=Object(l.useState)([]),{data:v,status:x}=(({popoverIsOpen:e,query:t})=>{const a=B(),{uxUiFilters:n}=Object(y.a)(),{transactionUrl:r,transactionUrlExcluded:i,...s}=n,[o,c]=Object(l.useState)(null!=t?t:"");return K()((()=>{c(t)}),250,[t]),Object(z.b)((t=>a&&e?t("GET /internal/apm/ux/url-search",{params:{query:{...a,uiFilters:JSON.stringify(s),urlQuery:o}}}):Promise.resolve(null)),[a,o,e])})({query:m,popoverIsOpen:u});Object(l.useEffect)((()=>{var e;const t=((e,t,a,n)=>{const r=N(n);return e.map((e=>({label:e.url,title:e.url,key:e.url,meta:[k.pageViews+": "+e.count,k.pageLoadDuration+": "+V(e.pld)+` (${r})`],url:e.url,checked:null!=t&&t.includes(e.url)?"on":null!=a&&a.includes(e.url)?"off":void 0})))})(null!==(e=null==v?void 0:v.items)&&void 0!==e?e:[],n,r,c),a=m||o;var l;a&&t.unshift({label:(l=a,p.i18n.translate("xpack.apm.urlFilter.wildcard",{defaultMessage:"Use wildcard *{wildcard}*",values:{wildcard:l}})),title:a,isWildcard:!0,checked:o?"on":void 0}),h(t)}),[v,c,o,m,n,r]);const T="success"!==x;return i.a.createElement(b.SelectableUrlList,{loading:T,onInputChange:e=>{E(e)},data:{items:g,total:null!==(a=null==v?void 0:v.total)&&void 0!==a?a:0},onSelectionChange:e=>{h(e.map((e=>{const{isWildcard:t,checked:a}=e;return t&&"off"===a?{...e,checked:void 0}:e})))},searchValue:m,popoverIsOpen:Boolean(u),setPopoverIsOpen:d,onSelectionApply:()=>{const{includedItems:a,excludedItems:n}=J(g);e(a,n),t(m),E("")},renderOption:W,rowHeight:64,hasChanged:()=>Boolean((()=>{const{includedItems:e,excludedItems:t,includedWildcards:a}=J(g);let l=a.length>0&&!o||0===a.length&&o;return a.length>0&&(l=a[0]!==o),l||!Object(f.isEqual)(e.sort(),(null!=n?n:[]).sort())||!Object(f.isEqual)(t.sort(),(null!=r?r:[]).sort())})())})}function Z(){const e=Object(c.useHistory)(),t=Object(l.useCallback)(((t,a)=>{const n="transactionUrl",r=Object(f.omit)(Object(v.d)(e.location.search),n);e.push({...e.location,search:Object(v.a)(Object(x.b)({...r,[n]:null!=t&&t.length?t.join(","):void 0,transactionUrlExcluded:null!=a&&a.length?a.join(","):void 0}))})}),[e]),a=Object(l.useCallback)((t=>{const a={...Object(v.d)(e.location.search),searchTerm:t||void 0};t||delete a.searchTerm;const n={...e.location,search:Object(v.a)(a)};e.push(n)}),[e]);return i.a.createElement("span",{"data-cy":"csmUrlFilter"},i.a.createElement(Q,{onChange:t,updateSearchTerm:a}))}var X=a(10);function ee({indexPattern:e}){const t=Object(c.useHistory)(),{urlParams:{searchTerm:a}}=Object(y.a)(),n=Object(l.useCallback)((e=>{const a={...Object(v.d)(t.location.search),searchTerm:e||void 0};e||delete a.searchTerm;const n={...t.location,search:Object(v.a)(a)};t.push(n)}),[t]);return a?l.createElement(b.FilterValueLabel,{indexPattern:e,removeFilter:()=>{n("")},invertFilter:({negate:e})=>{},field:X.K,value:a,negate:!1,label:"URL wildcard"}):null}const te=m()(r.EuiFlexItem).withConfig({displayName:"FilterItem",componentId:"sc-dvkggi-0"})(["max-width:300px;"]);function ae({indexPattern:e,onChange:t,filters:a,invertFilter:n,clearValues:s}){const{uxUiFilters:o,urlParams:{searchTerm:c}}=Object(y.a)(),{transactionUrl:u}=o,d=null!=u?u:[],m=a.some((e=>{var t;return(null===(t=e.value)||void 0===t?void 0:t.length)>0}));return e&&(m||d.length>0||c)?i.a.createElement(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",wrap:!0},i.a.createElement(ee,{indexPattern:e}),(null!=a?a:[]).map((({name:a,title:r,fieldName:s,excluded:c})=>{var u;return i.a.createElement(l.Fragment,{key:a},(null!==(u=null==o?void 0:o[a])&&void 0!==u?u:[]).map((l=>i.a.createElement(te,{key:a+l,grow:!1},i.a.createElement(b.FilterValueLabel,{indexPattern:e,removeFilter:()=>{t(a,(null==o?void 0:o[a]).filter((e=>e!==l)))},invertFilter:({negate:e})=>{n(a,l,e)},field:s,value:"transactionUrl"===a?ne(l):l,negate:!!c,label:r})))))})),i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiButtonEmpty,{size:"xs",iconType:"cross",onClick:s,"data-cy":"clearFilters"},p.i18n.translate("xpack.apm.clearFilters",{defaultMessage:"Clear filters"})))):null}function ne(e){const t=e.length;if(t<30)return e;const a=new URL(e);if("/"===a.pathname)return e;const n=a.hostname,r=t-30,l=n.substring(0,r);return a.pathname.length+7>30?e.replace(n,".."):e.replace(l,"..")}var re=a(121),le=a(200);var ie=a(3);function se(e){return e&&e!==ie.a.value?e===ie.b.value?[{bool:{must_not:{exists:{field:X.u}}}}]:[{term:{[X.u]:e}}]:[]}var oe=a(150);const ce=["location","device","os","browser"],ue=e=>`${e}Excluded`,de=[{term:{[X.J]:re.a}}];function me(){const{dataViewTitle:e,dataView:t}=function(){const{dataView:e}=Object(le.a)(),{services:{data:{dataViews:t}}}=Object(E.useKibana)(),{data:a}=Object(z.b)((async()=>{if(null!=e&&e.title)return t.create({title:null==e?void 0:e.title})}),[null==e?void 0:e.title,t]);return{dataViewTitle:null==e?void 0:e.title,dataView:a}}(),{filters:a=[],setFilterValue:n,invertFilter:s,clearValues:o}=function({filterNames:e}){const t=Object(c.useHistory)(),{uxUiFilters:a}=Object(y.a)(),n=(e,a)=>{const n=Object(f.omit)(Object(v.d)(t.location.search),e);t.push({...t.location,search:Object(v.a)(Object(x.b)({...n,[e]:a.length?a.join(","):void 0}))})};return{filters:e.map((e=>{var t;return{value:null!==(t=a[e])&&void 0!==t?t:[],...h.a[e],name:e}})),setFilterValue:n,clearValues:()=>{const a=Object(f.omit)(Object(v.d)(t.location.search),[...e,"searchTerm","transactionUrl"]);t.push({...t.location,search:Object(v.a)(a)})},invertFilter:(e,t,r)=>{if(r){var l;const r=e.split("Excluded")[0],i=e;n(i,(null==a?void 0:a[i]).filter((e=>e!==t))),n(r,[...null!==(l=null==a?void 0:a[r])&&void 0!==l?l:[],t])}else{var i;n(e,(null==a?void 0:a[e]).filter((e=>e!==t)));const r=ue(e);n(r,[...null!==(i=null==a?void 0:a[r])&&void 0!==i?i:[],t])}}}}({filterNames:h.b.filter((e=>!["serviceName"].includes(e)))}),{urlParams:{start:u,end:d,serviceName:m,environment:g}}=Object(oe.a)(),k=Object(l.useMemo)((()=>{const e=[...de,...se(g||ie.a.value)];return m&&e.push({term:{[X.v]:m}}),e}),[g,m]),{isSmall:S}=Object(T.a)(),O=i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement("h3",null,p.i18n.translate("xpack.apm.localFiltersTitle",{defaultMessage:"Filters"}))),w=i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiFlexGroup,{wrap:!0},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(Z,null)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiFilterGroup,{fullWidth:!0},ce.map((t=>{var r,l;return i.a.createElement(b.FieldValueSuggestions,{key:t,sourceField:h.a[t].fieldName,indexPatternTitle:e,label:h.a[t].title,asCombobox:!1,selectedValue:null===(r=a.find((e=>e.name===t&&!e.excluded)))||void 0===r?void 0:r.value,excludedValue:null===(l=a.find((e=>e.name===ue(t)&&e.excluded)))||void 0===l?void 0:l.value,asFilterButton:!0,onChange:(e,a)=>{n(t,e||[]),n(ue(t),a||[])},filters:k,time:{from:u,to:d}})}))))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(ae,{filters:a,onChange:(e,t)=>{n(e,t)},clearValues:o,invertFilter:s,indexPattern:t}));return S?i.a.createElement(r.EuiAccordion,{id:"uxFilterAccordion",buttonContent:O},w):i.a.createElement(i.a.Fragment,null,w)}const pe={sharedData:{totalPageViews:0},setSharedData:e=>{throw new Error("setSharedData was not initialized, set it when you invoke the context")}},Ee=Object(l.createContext)(pe);function ge({children:e}){const[t,a]=Object(l.useState)({totalPageViews:0}),n=i.a.useCallback((e=>{a(e)}),[]),r=Object(l.useMemo)((()=>({sharedData:t,setSharedData:n})),[t,n]);return i.a.createElement(Ee.Provider,{value:r,children:e})}function be(){const{urlParams:{percentile:e}}=Object(y.a)(),t=B(),{data:a,status:n}=Object(z.b)((e=>t?e("GET /internal/apm/ux/web-core-vitals",{params:{query:t}}):Promise.resolve(null)),[t]),{sharedData:{totalPageViews:s}}=Object(l.useContext)(Ee),o=Object(l.useMemo)((()=>Object(b.getCoreVitalsComponent)({data:a,totalPageViews:s,loading:"success"!==n,displayTrafficMetric:!0})),[n]);return i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween",wrap:!0,responsive:!1},i.a.createElement(r.EuiFlexItem,{grow:1,"data-cy":"client-metrics"},i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,k.metrics," (",N(e),")")),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(H,{data:a,loading:"success"!==n}))),i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(r.EuiHorizontalRule,{margin:"xs"}),i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween",wrap:!0},i.a.createElement(r.EuiFlexItem,{grow:1,"data-cy":"client-metrics",style:{minHeight:150}},i.a.createElement(r.EuiSpacer,{size:"s"}),o)))}var fe=a(32),he=a(140);function ve(){var e,t,a;const{urlParams:n,uxUiFilters:s}=Object(y.a)(),{start:o,end:c,serviceName:u,searchTerm:d}=n,[m,E]=Object(l.useState)({pageIndex:0,pageSize:5}),{data:g,status:b}=Object(z.b)((e=>o&&c&&u?e("GET /internal/apm/ux/js-errors",{params:{query:{start:o,end:c,urlQuery:d||void 0,uiFilters:JSON.stringify(s),pageSize:String(m.pageSize),pageIndex:String(m.pageIndex)}}}):Promise.resolve(null)),[o,c,u,s,m,d]),{sharedData:{totalPageViews:f}}=Object(l.useContext)(Ee),h=[{field:"errorMessage",name:k.errorMessage,render:(e,t)=>i.a.createElement(he.a,{serviceName:u,errorGroupId:t.errorGroupId},e)},{name:k.impactedPageLoads,field:"count",align:"right",render:e=>i.a.createElement(fe.FormattedMessage,{id:"xpack.apm.ux.jsErrors.percent",defaultMessage:"{pageLoadPercent} %",values:{pageLoadPercent:(e/f*100).toFixed(1)}})}],v=null!==(e=null==g?void 0:g.totalErrors)&&void 0!==e?e:0;return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,k.jsErrors)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFlexGroup,null,i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiStat,{"data-test-subj":"uxJsErrorsTotal",titleSize:"s",title:v<1e3?v:i.a.createElement(r.EuiToolTip,{content:v},i.a.createElement(i.a.Fragment,null,w()(v).format("0 a"))),description:k.totalErrors,isLoading:b===z.a.LOADING}))),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiBasicTable,{"data-test-subj":"uxJsErrorTable",loading:b===z.a.LOADING,error:b===z.a.FAILURE?p.i18n.translate("xpack.apm.rum.jsErrorsTable.errorMessage",{defaultMessage:"Failed to fetch"}):"",responsive:!1,compressed:!0,columns:h,items:null!==(t=null==g?void 0:g.items)&&void 0!==t?t:[],onChange:({page:e})=>{E({pageIndex:e.index,pageSize:e.size})},pagination:{...m,totalItemCount:null!==(a=null==g?void 0:g.totalErrorGroups)&&void 0!==a?a:0}}))}function xe(){return i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(r.EuiSpacer,{size:"xs"}),i.a.createElement(r.EuiFlexGroup,{wrap:!0},i.a.createElement(r.EuiFlexItem,{style:{flexBasis:650}},i.a.createElement(ve,null))))}function ye({selectedBreakdown:e,onBreakdownChange:t,dataTestSubj:a}){var n;const l="noBreakdown",s=[{name:p.i18n.translate("xpack.apm.csm.breakDownFilter.noBreakdown",{defaultMessage:"No breakdown"}),fieldName:l,type:"category"},{name:p.i18n.translate("xpack.apm.csm.breakdownFilter.browser",{defaultMessage:"Browser"}),fieldName:X.M,type:"category"},{name:p.i18n.translate("xpack.apm.csm.breakdownFilter.os",{defaultMessage:"OS"}),fieldName:X.N,type:"category"},{name:p.i18n.translate("xpack.apm.csm.breakdownFilter.device",{defaultMessage:"Device"}),fieldName:X.L,type:"category"},{name:p.i18n.translate("xpack.apm.csm.breakdownFilter.location",{defaultMessage:"Location"}),fieldName:X.b,type:"category"}],o=s.map((({name:e,fieldName:t})=>({inputDisplay:t===l?e:i.a.createElement("strong",null,e),value:t,dropdownDisplay:e})));return i.a.createElement(r.EuiSuperSelect,{fullWidth:!0,compressed:!0,options:o,valueOfSelected:null!==(n=null==e?void 0:e.fieldName)&&void 0!==n?n:l,onChange:e=>(e=>{t(e===l?null:s.find((({fieldName:t})=>t===e)))})(e),"data-test-subj":a})}var Te=a(30),ke=a(39);function Se({percentiles:e}){var t;const a=null!==(i=e,t=Object.entries(null!=i?i:{}).map((e=>({dataValue:e[1],details:`${(+e[0]).toFixed(0)}`}))))&&void 0!==t?t:[];var i;const s={line:{strokeWidth:1,stroke:n.euiLightVars.euiColorSuccess,opacity:1}};function o({annotation:e}){return l.createElement("span",{"data-cy":"percentileTooltipTitle"},e.details,"th Percentile")}return l.createElement(l.Fragment,null,a.map(((e,t)=>l.createElement(Te.LineAnnotation,{id:t+"annotation_"+e.dataValue,key:t+"percentile_"+e.dataValue,domainType:Te.AnnotationDomainType.XDomain,dataValues:[e],style:s,hideTooltips:!0,markerPosition:Te.Position.Top,marker:l.createElement("span",{"data-cy":"percentile-markers"},l.createElement(r.EuiToolTip,{title:l.createElement(o,{annotation:e}),content:l.createElement("span",null,"Pages loaded: ",Math.round(e.dataValue))},l.createElement(l.Fragment,null,e.details,"th")))}))))}var Oe=a(65),we=a.n(Oe);function Fe({loading:e=!1,height:t="100%",maxWidth:a,children:n,...l}){const s=!0===e?.3:1;return i.a.createElement(r.EuiErrorBoundary,null,i.a.createElement("div",we()({style:{height:t,opacity:s,transition:"opacity 0.2s",...a?{maxWidth:a}:{}}},l),n),!0===e&&i.a.createElement(r.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center",style:{height:t,marginTop:`-${t}`,marginBottom:0,...a?{maxWidth:a}:{}}},i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiLoadingChart,{size:"xl"}))))}function je({field:e,value:t,percentileRange:a,onLoadingChange:n}){const[r]=Object(E.useUiSetting$)("theme:darkMode"),s=r?ke.EUI_CHARTS_THEME_DARK:ke.EUI_CHARTS_THEME_LIGHT,{breakdowns:o,status:c}=(({percentileRange:e,field:t,value:a})=>{var n;const{urlParams:r,uxUiFilters:l}=Object(y.a)(),{start:i,end:s,searchTerm:o}=r,{min:c,max:u}=null!=e?e:{},{data:d,status:m}=Object(z.b)((e=>{if(i&&s&&t&&a)return e("GET /internal/apm/ux/page-load-distribution/breakdown",{params:{query:{start:i,end:s,breakdown:a,uiFilters:JSON.stringify(l),urlQuery:o,...c&&u?{minPercentile:String(c),maxPercentile:String(u)}:{}}}})}),[s,i,l,t,a,c,u,o]);return{breakdowns:null!==(n=null==d?void 0:d.pageLoadDistBreakdown)&&void 0!==n?n:[],status:m}})({field:e,value:t,percentileRange:a});return Object(l.useEffect)((()=>{n("success"!==c)}),[c,n]),i.a.createElement(i.a.Fragment,null,o.map((({data:a,name:n},r)=>{var l,o;return i.a.createElement(Te.LineSeries,{id:`${e}-${t}-${n}`,key:`${e}-${t}-${n}`,name:n,xAccessor:"x",yAccessors:["y"],xScaleType:Te.ScaleType.Linear,yScaleType:Te.ScaleType.Linear,curve:Te.CurveType.CURVE_CATMULL_ROM,data:null!=a?a:[],lineSeriesStyle:{point:{visible:!1}},fit:Te.Fit.Linear,color:null===(l=s.theme.colors)||void 0===l||null===(o=l.vizColors)||void 0===o?void 0:o[0===r?0:r+1],tickFormat:e=>w()(e).format("0.0")+" %"})})))}const Pe=m()(Te.Chart).withConfig({displayName:"PageLoadChart",componentId:"sc-12sgdot-0"})([".echAnnotation{pointer-events:initial;}"]);function Me({onPercentileChange:e,data:t,breakdown:a,loading:n,percentileRange:r}){var s,o,c;const[u,d]=Object(l.useState)(!1),m={headerFormatter:e=>i.a.createElement("div",null,i.a.createElement("p",null,e.value," ",k.seconds))},[p]=Object(E.useUiSetting$)("theme:darkMode"),g=p?ke.EUI_CHARTS_THEME_DARK:ke.EUI_CHARTS_THEME_LIGHT;return i.a.createElement(Fe,{loading:n||u,height:"250px"},(!n||t)&&i.a.createElement(Pe,null,i.a.createElement(Te.Settings,{baseTheme:p?Te.DARK_THEME:Te.LIGHT_THEME,theme:g.theme,onBrushEnd:({x:t})=>{if(!t)return;const[a,n]=t;e(a,n)},tooltip:m,showLegend:!0}),i.a.createElement(Se,{percentiles:null==t?void 0:t.percentiles}),i.a.createElement(Te.Axis,{id:"bottom",title:k.pageLoadTime,position:Te.Position.Bottom}),i.a.createElement(Te.Axis,{id:"left",title:k.percPageLoaded,position:Te.Position.Left,labelFormat:e=>e+" %"}),i.a.createElement(Te.LineSeries,{sortIndex:0,fit:Te.Fit.Linear,id:"PagesPercentage",name:k.overall,xAccessor:"x",yAccessors:["y"],xScaleType:Te.ScaleType.Linear,yScaleType:Te.ScaleType.Linear,data:null!==(s=null==t?void 0:t.pageLoadDistribution)&&void 0!==s?s:[],curve:Te.CurveType.CURVE_CATMULL_ROM,lineSeriesStyle:{point:{visible:!1},line:{strokeWidth:3}},color:null===(o=g.theme.colors)||void 0===o||null===(c=o.vizColors)||void 0===c?void 0:c[1],tickFormat:e=>w()(e).format("0.0")+" %"}),a&&i.a.createElement(je,{key:`${a.type}-${a.name}`,field:a.type,value:a.name,percentileRange:r,onLoadingChange:e=>{d(e)}})))}function Ie({percentileRange:e,setPercentileRange:t}){const a=()=>{t({min:null,max:null})};return null===e.min&&null===e.max?null:i.a.createElement(r.EuiFlexItem,{grow:!1},i.a.createElement(r.EuiShowFor,{sizes:["xs"]},i.a.createElement(r.EuiButtonIcon,{iconType:"inspect",size:"s","aria-label":k.resetZoom,onClick:a})),i.a.createElement(r.EuiHideFor,{sizes:["xs"]},i.a.createElement(r.EuiButtonEmpty,{iconType:"inspect",size:"s",onClick:a},k.resetZoom)))}function Le(){var e,t;const{services:{http:a}}=Object(E.useKibana)(),{urlParams:n,uxUiFilters:s}=Object(y.a)(),{start:o,end:c,rangeFrom:u,rangeTo:d,searchTerm:m}=n,{serviceName:p}=s,[g,f]=Object(l.useState)({min:null,max:null}),[h,v]=Object(l.useState)(null),{data:x,status:T}=Object(z.b)((e=>o&&c&&p?e("GET /internal/apm/ux/page-load-distribution",{params:{query:{start:o,end:c,uiFilters:JSON.stringify(s),urlQuery:m,...g.min&&g.max?{minPercentile:String(g.min),maxPercentile:String(g.max)}:{}}}}):Promise.resolve(null)),[c,o,s,g.min,g.max,m,p]);Object(b.createExploratoryViewUrl)({reportType:"kpi-over-time",allSeries:[{name:`${p}-page-views`,dataType:"ux",time:{from:u,to:d},reportDefinitions:{"service.name":p},...h?{breakdown:h.fieldName}:{}}]},null==a?void 0:a.basePath.get());return i.a.createElement("div",{"data-cy":"pageLoadDist"},i.a.createElement(r.EuiFlexGroup,{responsive:!1},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,k.pageLoadDistribution))),i.a.createElement(Ie,{percentileRange:g,setPercentileRange:f}),i.a.createElement(r.EuiFlexItem,{grow:!1,style:{width:170}},i.a.createElement(ye,{selectedBreakdown:h,onBreakdownChange:v,dataTestSubj:"pldBreakdownFilter"})),!1),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(Me,{data:null==x?void 0:x.pageLoadDistribution,onPercentileChange:(e,t)=>{f({min:e,max:t})},loading:"success"!==T,breakdown:h,percentileRange:{max:g.max||(null==x||null===(e=x.pageLoadDistribution)||void 0===e?void 0:e.maxDuration),min:g.min||(null==x||null===(t=x.pageLoadDistribution)||void 0===t?void 0:t.minDuration)}}))}var Ce=a(31),_e=a.n(Ce);function Re({data:e,loading:t}){var a,n,r,l,s;const o=Object(c.useHistory)(),{urlParams:u}=Object(y.a)(),{start:d,end:m}=u,p=_e()(new Date(m)).diff(_e()(new Date(d)),"day"),g=Object(Te.timeFormatter)(Object(Te.niceTimeFormatByDay)(p>1?2:1)),b=!(null==e||null===(a=e.topItems)||void 0===a||!a.length),f=null!=e&&null!==(n=e.topItems)&&void 0!==n&&n.length?null==e?void 0:e.topItems:["y"],[h]=Object(E.useUiSetting$)("theme:darkMode"),x=h?ke.EUI_CHARTS_THEME_DARK:ke.EUI_CHARTS_THEME_LIGHT;return i.a.createElement(Fe,{loading:t,height:"250px"},(!t||e)&&i.a.createElement(Te.Chart,null,i.a.createElement(Te.Settings,{baseTheme:h?Te.DARK_THEME:Te.LIGHT_THEME,theme:x.theme,showLegend:!0,onBrushEnd:({x:e})=>{if(!e)return;const[t,a]=e,n=_e()(t).toISOString(),r=_e()(a).toISOString();o.push({...o.location,search:Object(v.a)({...Object(v.d)(o.location.search),rangeFrom:n,rangeTo:r})})},xDomain:{min:new Date(d).valueOf(),max:new Date(m).valueOf()}}),i.a.createElement(Te.Axis,{id:"date_time",position:Te.Position.Bottom,tickFormat:g}),i.a.createElement(Te.Axis,{id:"page_views",title:k.pageViews,position:Te.Position.Left,tickFormat:e=>w()(e).format("0"),labelFormat:e=>w()(e).format("0a")}),i.a.createElement(Te.BarSeries,{id:k.pageViews,xScaleType:Te.ScaleType.Time,yScaleType:Te.ScaleType.Linear,xAccessor:"x",yAccessors:Array.from(f),stackAccessors:["x"],data:null!==(r=null==e?void 0:e.items)&&void 0!==r?r:[],name:({yAccessor:e})=>"y"===e?k.overall:e,color:b||null===(l=x.theme.colors)||void 0===l||null===(s=l.vizColors)||void 0===s?void 0:s[1]})))}function Ae(){const{services:{http:e}}=Object(E.useKibana)(),{urlParams:t,uxUiFilters:a}=Object(y.a)(),{serviceName:n}=a,{start:s,end:o,searchTerm:c,rangeTo:u,rangeFrom:d}=t,[m,p]=Object(l.useState)(null),{data:g,status:f}=Object(z.b)((e=>s&&o&&n?e("GET /internal/apm/ux/page-view-trends",{params:{query:{start:s,end:o,uiFilters:JSON.stringify(a),urlQuery:c,...m?{breakdowns:JSON.stringify(m)}:{}}}}):Promise.resolve(void 0)),[s,o,n,a,c,m]);Object(b.createExploratoryViewUrl)({reportType:"kpi-over-time",allSeries:[{name:`${n}-page-views`,dataType:"ux",time:{from:d,to:u},reportDefinitions:{"service.name":n},...m?{breakdown:m.fieldName}:{}}]},null==e?void 0:e.basePath.get());return i.a.createElement("div",null,i.a.createElement(r.EuiFlexGroup,{responsive:!1},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,k.pageViews))),i.a.createElement(r.EuiFlexItem,{grow:!1,style:{width:170}},i.a.createElement(ye,{selectedBreakdown:m,onBreakdownChange:p,dataTestSubj:"pvBreakdownFilter"})),!1),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(Re,{data:g,loading:"success"!==f}))}function De(){return i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",wrap:!0},i.a.createElement(r.EuiFlexItem,{style:{flexBasis:650}},i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(Le,null))),i.a.createElement(r.EuiFlexItem,{style:{flexBasis:650}},i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(Ae,null))))}const Ne=m.a.div.withConfig({displayName:"StyleChart",componentId:"sc-ae1i4f-0"})(["height:100%;"]),ze={chartMargins:{top:0,bottom:0,left:0,right:0},legend:{verticalWidth:100},partition:{linkLabel:{maximumSection:1/0,maxCount:0},outerSizeRatio:1,circlePadding:4}};function Be({loading:e,options:t}){const[a]=Object(E.useUiSetting$)("theme:darkMode"),n=a?ke.EUI_CHARTS_THEME_DARK:ke.EUI_CHARTS_THEME_LIGHT;return i.a.createElement(Fe,{loading:e,height:"245px",maxWidth:"430px"},i.a.createElement(Ne,null,i.a.createElement(Te.Chart,null,i.a.createElement(Te.Settings,{showLegend:!0,baseTheme:a?Te.DARK_THEME:Te.LIGHT_THEME,theme:ze}),i.a.createElement(Te.Partition,{id:"spec_1",data:null!=t&&t.length?t:[{count:1,name:k.noData}],layout:Te.PartitionLayout.sunburst,clockwiseSectors:!1,valueAccessor:e=>e.count,valueGetter:"percent",percentFormatter:e=>Math.round(100*(e+Number.EPSILON))/100+"%",layers:[{groupByRollup:e=>e.name,shape:{fillColor:e=>{var t,a;return null===(t=n.theme.colors)||void 0===t||null===(a=t.vizColors)||void 0===a?void 0:a[e.sortIndex]}}}]}))))}function Ve(){const{urlParams:e,uxUiFilters:t}=Object(y.a)(),{start:a,end:n,searchTerm:l}=e,{data:s,status:o}=Object(z.b)((e=>{const{serviceName:r}=t;return a&&n&&r?e("GET /internal/apm/ux/visitor-breakdown",{params:{query:{start:a,end:n,uiFilters:JSON.stringify(t),urlQuery:l}}}):Promise.resolve(null)}),[n,a,t,l]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"s"},i.a.createElement("h3",null,S)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(r.EuiFlexGroup,{style:{height:"calc(100% - 32px)"}},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h4",null,k.browser)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(Be,{options:null==s?void 0:s.browsers,loading:"success"!==o})),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h4",null,k.operatingSystem)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement(Be,{options:null==s?void 0:s.os,loading:"success"!==o}))))}var Ue=a(111),Ge=a.n(Ue),He=a(47),qe=a(51),Ye=a(164);const We={type:He.SOURCE_TYPES.ES_TERM_SOURCE,id:"3657625d-17b0-41ef-99ba-3a2b2938655c",indexPatternTitle:"apm-*",term:"client.geo.country_iso_code",metrics:[{type:He.AGG_TYPE.AVG,field:"transaction.duration.us",label:"Page load duration"}],indexPatternId:Ye.a,applyGlobalQuery:!0,applyGlobalTime:!0,applyForceRefresh:!0},$e={type:He.SOURCE_TYPES.ES_TERM_SOURCE,id:"e62a1b9c-d7ff-4fd4-a0f6-0fdc44bb9e41",indexPatternTitle:"apm-*",term:"client.geo.region_iso_code",metrics:[{type:He.AGG_TYPE.AVG,field:"transaction.duration.us"}],whereQuery:{query:'transaction.type : "page-load"',language:"kuery"},indexPatternId:Ye.a,applyGlobalQuery:!0,applyGlobalTime:!0,applyForceRefresh:!0},Ke=e=>({query:`${X.J} : "${re.a}" and ${X.v} : "${e}"`,language:"kuery"}),Je="region_name",Qe="name",Ze="__kbnjoin__avg_of_transaction.duration.us__e62a1b9c-d7ff-4fd4-a0f6-0fdc44bb9e41",Xe="__kbnjoin__avg_of_transaction.duration.us__3657625d-17b0-41ef-99ba-3a2b2938655c";var et=a(55);const tt=m()(r.EuiDescriptionListDescription).withConfig({displayName:"DescriptionItem",componentId:"sc-zlc1av-0"})(["&&&{width:25%;}"]),at=m()(r.EuiDescriptionListTitle).withConfig({displayName:"TitleItem",componentId:"sc-zlc1av-1"})(["&&&{width:75%;}"]);function nt({closeTooltip:e,features:t=[],loadFeatureProperties:a}){var n;const{id:s,layerId:o,mbProperties:c}=null!==(n=t[0])&&void 0!==n?n:{},[u,d]=Object(l.useState)(s),[m,p]=Object(l.useState)("");return Object(l.useEffect)((()=>{(async()=>{if(a){(await a({layerId:o,properties:c})).forEach((e=>{e.getPropertyKey()!==Qe&&e.getPropertyKey()!==Je||d(e.getRawValue()),e.getPropertyKey()!==Ze&&e.getPropertyKey()!==Xe||p((e=>{const t=e/1e3;return t>1e3?(t/1e3).toFixed(2)+" sec":(t/1e3).toFixed(0)+" ms"})(+e.getRawValue()))}))}})()})),i.a.createElement(r.EuiOutsideClickDetector,{onOutsideClick:()=>{null!=e&&e()}},i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiPopoverTitle,null,u),i.a.createElement(r.EuiDescriptionList,{type:"column",textStyle:"reverse",compressed:!0,style:{width:300}},i.a.createElement(at,{className:"eui-textNoWrap"},k.avgPageLoadDuration),i.a.createElement(tt,null,m))))}const rt=i.a.memo(nt),lt=(e,t,a=!1)=>({meta:{index:Ye.a,type:"phrases",key:e,value:t.join(", "),params:t,alias:null,negate:a,disabled:!1},query:{bool:{should:t.map((t=>({match_phrase:{[e]:t}}))),minimum_should_match:1}}}),it={meta:{index:Ye.a,alias:null,negate:!1,disabled:!1,type:"exists",key:"transaction.marks.navigationTiming.fetchStart",value:"exists"},query:{exists:{field:"transaction.marks.navigationTiming.fetchStart"}}},st=()=>{const{urlParams:e,uxUiFilters:t}=Object(y.a)(),{serviceName:a,searchTerm:n}=e,{browser:r,device:i,os:s,location:o,transactionUrl:c,browserExcluded:u,deviceExcluded:d,osExcluded:m,locationExcluded:p,transactionUrlExcluded:E}=t;return Object(l.useMemo)((()=>{const e=[it];var t,l;return a&&e.push((t=X.v,l=a,{meta:{index:Ye.a,alias:null,negate:!1,disabled:!1,type:"phrase",key:t,params:{query:l}},query:{term:{[t]:l}}})),r&&e.push(lt(X.M,r)),i&&e.push(lt(X.L,i)),s&&e.push(lt(X.N,s)),o&&e.push(lt(X.b,o)),c&&e.push(lt(X.K,c)),u&&e.push(lt(X.M,u,!0)),d&&e.push(lt(X.L,d,!0)),m&&e.push(lt(X.N,m,!0)),p&&e.push(lt(X.b,p,!0)),E&&e.push(lt(X.K,E,!0)),n&&e.push(((e,t)=>({meta:{index:Ye.a,alias:null,negate:!1,disabled:!1,type:"term",key:e,params:{query:t}},query:{wildcard:{[e]:{value:`*${t}*`}}}}))(X.K,n)),e}),[a,r,i,s,o,c,u,d,m,p,E,n])},ot=m.a.div.withConfig({displayName:"EmbeddedPanel",componentId:"sc-1asxr9y-0"})(["z-index:auto;flex:1;display:flex;flex-direction:column;height:100%;position:relative;.embPanel__content{display:flex;flex:1 1 100%;z-index:1;min-height:0;}&&& .mapboxgl-canvas{animation:none !important;}"]);function ct(){const{urlParams:e}=Object(y.a)(),t=Object(et.a)(),{start:a,end:n,serviceName:r}=e,s=st(),o=function(){const{urlParams:e}=Object(y.a)(),{serviceName:t}=e;We.whereQuery=Ke(t);const a=e=>({type:"VECTOR",properties:{icon:{type:He.STYLE_TYPE.STATIC,options:{value:"marker"}},fillColor:{type:He.STYLE_TYPE.DYNAMIC,options:{color:"Blue to Red",colorCategory:"palette_0",fieldMetaOptions:{isEnabled:!0,sigma:3},type:He.COLOR_MAP_TYPE.ORDINAL,field:{name:e,origin:He.FIELD_ORIGIN.JOIN},useCustomColorRamp:!1}},lineColor:{type:He.STYLE_TYPE.DYNAMIC,options:{color:"#3d3d3d",fieldMetaOptions:{isEnabled:!0}}},lineWidth:{type:He.STYLE_TYPE.STATIC,options:{size:1}},iconSize:{type:He.STYLE_TYPE.STATIC,options:{size:6}},iconOrientation:{type:He.STYLE_TYPE.STATIC,options:{orientation:0}},labelText:{type:He.STYLE_TYPE.STATIC,options:{value:""}},labelColor:{type:He.STYLE_TYPE.STATIC,options:{color:"#000000"}},labelSize:{type:He.STYLE_TYPE.STATIC,options:{size:14}},labelBorderColor:{type:He.STYLE_TYPE.STATIC,options:{color:"#FFFFFF"}},symbolizeAs:{options:{value:He.SYMBOLIZE_AS_TYPES.CIRCLE}},labelBorderSize:{options:{size:He.LABEL_BORDER_SIZES.SMALL}}},isTimeAware:!0}),n={joins:[{leftField:"iso2",right:We}],sourceDescriptor:{type:"EMS_FILE",id:"world_countries",tooltipProperties:[Qe]},style:a(Xe),id:"e8d1d974-eed8-462f-be2c-f0004b7619b2",label:null,minZoom:0,maxZoom:24,alpha:.75,visible:!0,type:He.LAYER_TYPE.GEOJSON_VECTOR};return $e.whereQuery=Ke(t),[n,{joins:[{leftField:"region_iso_code",right:$e}],sourceDescriptor:{type:"EMS_FILE",id:"administrative_regions_lvl2",tooltipProperties:["region_iso_code",Je]},style:a(Ze),id:"0e936d41-8765-41c9-97f0-05e166391366",label:null,minZoom:3,maxZoom:24,alpha:.75,visible:!0,type:He.LAYER_TYPE.GEOJSON_VECTOR}]}(),[c,u]=Object(l.useState)(),d=Object(l.useRef)(null),{services:{embeddable:m}}=Object(E.useKibana)();if(!m)throw new Error("Embeddable start plugin not found");const p=m.getEmbeddableFactory(He.MAP_SAVED_OBJECT_TYPE),g={attributes:{title:""},id:Ge.a.v4(),filters:s,viewMode:qe.ViewMode.VIEW,isLayerTOCOpen:!1,query:{query:'transaction.type : "page-load"',language:"kuery"},...a&&{timeRange:{from:new Date(a).toISOString(),to:new Date(n).toISOString()}},hideFilterActions:!0};function b({addFilters:e,closeTooltip:t,features:a,isLocked:n,getLayerName:r,loadFeatureProperties:l}){const s={addFilters:e,closeTooltip:t,isLocked:n,getLayerName:r,loadFeatureProperties:l};return i.a.createElement(rt,we()({},s,{features:a}))}return Object(l.useEffect)((()=>{null!=c&&r&&(c.updateInput({filters:s}),c.reload())}),[s]),Object(l.useEffect)((()=>{if(null!=c&&null!=a&&null!=n){const e={from:new Date(a).toISOString(),to:new Date(n).toISOString()};c.updateInput({timeRange:e}),c.reload()}}),[a,n]),Object(l.useEffect)((()=>{!async function(){if(!p)throw new Error("Map embeddable not found.");const e=await p.create({...g,title:"Visitors by region"});if(e&&!Object(qe.isErrorEmbeddable)(e)){e.setRenderTooltipContent(b);const a=t.plugins.maps?await t.plugins.maps.createLayerDescriptors.createBasemapLayerDescriptor():null;a&&o.unshift(a),await e.setLayerList(o)}u(e)}()}),[]),Object(l.useEffect)((()=>{d.current&&c&&r&&c.render(d.current)}),[c,d,r]),i.a.createElement(ot,null,i.a.createElement("div",{"data-test-subj":"xpack.apm.regionMap.embeddedPanel",className:"embPanel__content",ref:d}))}ct.displayName="EmbeddedMap";const ut=i.a.memo(ct);function dt(){return i.a.createElement(i.a.Fragment,null,i.a.createElement(r.EuiTitle,{size:"xs"},i.a.createElement("h3",null,k.pageLoadDurationByRegion)),i.a.createElement(r.EuiSpacer,{size:"s"}),i.a.createElement("div",{style:{height:400}},i.a.createElement(ut,null)))}function mt(){return i.a.createElement(r.EuiFlexGroup,{gutterSize:"s",wrap:!0},i.a.createElement(r.EuiFlexItem,{style:{flexBasis:650}},i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(dt,null))),i.a.createElement(r.EuiFlexItem,{style:{flexBasis:650}},i.a.createElement(r.EuiPanel,{hasBorder:!0},i.a.createElement(Ve,null))))}const pt=m()(r.EuiFlexGroup).withConfig({displayName:"ClFlexGroup",componentId:"sc-1pxjjdt-0"})(["flex-direction:row;@media only screen and (max-width:768px){flex-direction:row;justify-content:space-between;}"]);function Et(e,t){return void 0===t?k.dataMissing:V(t,e)}function gt({pageViews:e}){return void 0===e?l.createElement(l.Fragment,null,k.dataMissing):e<1e4?l.createElement(l.Fragment,null,w()(e).format("0,0")):l.createElement(r.EuiToolTip,{content:w()(e).format("0,0")},l.createElement(l.Fragment,null,w()(e).format("0 a")))}function bt(){var e,t,a,n;const i=B(),{data:s,status:o}=Object(z.b)((e=>i?e("GET /internal/apm/ux/client-metrics",{params:{query:{...i}}}):Promise.resolve(null)),[i]),{setSharedData:c}=Object(l.useContext)(Ee);Object(l.useEffect)((()=>{var e,t;c({totalPageViews:null!==(e=null==s||null===(t=s.pageViews)||void 0===t?void 0:t.value)&&void 0!==e?e:0})}),[s,c]);const u={minWidth:"150px",maxWidth:"250px"};return l.createElement(pt,{wrap:!0,responsive:!1},l.createElement(r.EuiFlexItem,{style:u},l.createElement(r.EuiStat,{titleSize:"l",title:Et("ms",null==s||null===(e=s.totalPageLoadDuration)||void 0===e?void 0:e.value),description:l.createElement(l.Fragment,null,k.totalPageLoad,l.createElement(r.EuiIconTip,{content:k.totalPageLoadTooltip,type:"questionInCircle"})),isLoading:"success"!==o})),l.createElement(r.EuiFlexItem,{style:u},l.createElement(r.EuiStat,{titleSize:"l",title:Et("ms",null==s||null===(t=s.backEnd)||void 0===t?void 0:t.value),description:l.createElement(l.Fragment,null,k.backEnd,l.createElement(r.EuiIconTip,{content:k.backEndTooltip,type:"questionInCircle"})),isLoading:"success"!==o})),l.createElement(r.EuiFlexItem,{style:u},l.createElement(r.EuiStat,{titleSize:"l",title:Et("ms",null==s||null===(a=s.frontEnd)||void 0===a?void 0:a.value),description:l.createElement(l.Fragment,null,k.frontEnd,l.createElement(r.EuiIconTip,{content:k.frontEndTooltip,type:"questionInCircle"})),isLoading:"success"!==o})),l.createElement(r.EuiFlexItem,{style:u},l.createElement(r.EuiStat,{titleSize:"l",title:l.createElement(gt,{pageViews:null==s||null===(n=s.pageViews)||void 0===n?void 0:n.value}),description:k.pageViews,isLoading:"success"!==o})))}function ft(){const{urlParams:{percentile:e}}=Object(y.a)();return l.createElement(r.EuiPanel,{hasBorder:!0},l.createElement(r.EuiFlexGroup,{justifyContent:"spaceBetween"},l.createElement(r.EuiFlexItem,{grow:1,"data-cy":"client-metrics"},l.createElement(r.EuiTitle,{size:"xs"},l.createElement("h3",null,k.pageLoad," (",N(e),")")),l.createElement(r.EuiSpacer,{size:"s"}),l.createElement(bt,null))))}function ht(){const{isSmall:e}=Object(T.a)();return i.a.createElement(r.EuiFlexGroup,{direction:e?"row":"column",gutterSize:"s"},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(ft,null)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(be,null)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(De,null)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(mt,null)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(xe,null)))}function vt(){return Object(b.useTrackPageview)({app:"ux",path:"home"}),Object(b.useTrackPageview)({app:"ux",path:"home",delay:15e3}),i.a.createElement(i.a.Fragment,null,i.a.createElement(me,null),i.a.createElement(r.EuiSpacer,{size:"m"}),i.a.createElement(ht,null))}function xt({loading:e,serviceNames:t}){const a=Object(c.useHistory)(),{urlParams:{serviceName:n}}=Object(y.a)(),s=t.map((e=>({text:e,value:e}))),o=Object(l.useCallback)(((e,t)=>{const n={...a.location,search:Object(v.a)({...Object(v.d)(a.location.search),serviceName:e})};t?a.replace(n):a.push(n)}),[a]);return Object(l.useEffect)((()=>{(null==t?void 0:t.length)>0&&(n||o(t[0],!0),n&&!t.includes(n)&&o(t[0],!0)),n&&0===t.length&&!e&&o("")}),[t,n,o,e]),i.a.createElement(r.EuiSelect,{fullWidth:!0,prepend:p.i18n.translate("xpack.apm.ux.localFilters.titles.webApplication",{defaultMessage:"Web application"}),isLoading:e,"data-cy":"serviceNameFilter",options:s,value:n,onChange:e=>{o(e.target.value)}})}var yt=a(80);function Tt(){var e;const{urlParams:{start:t,end:a}}=Object(y.a)(),{data:n,status:r}=Object(z.b)((e=>{if(t&&a)return e("GET /internal/apm/ux/services",{params:{query:{start:t,end:a,uiFilters:JSON.stringify({agentName:yt.b})}}})}),[t,a]),l=null!==(e=null==n?void 0:n.rumServices)&&void 0!==e?e:[];return i.a.createElement(xt,{loading:"success"!==r,serviceNames:l})}var kt=a(207);function St(){const e=Object(c.useHistory)(),{urlParams:{percentile:t}}=Object(y.a)(),a=Object(l.useCallback)(((t,a)=>{const n={...e.location,search:Object(v.a)({...Object(v.d)(e.location.search),percentile:t})};a?e.replace(n):e.push(n)}),[e]);Object(l.useEffect)((()=>{t||a(50,!0)}));const n=[{value:"50",text:k.percentile50thMedian,"data-test-subj":"p50Percentile"},{value:"75",text:k.percentile75th,"data-test-subj":"p75Percentile"},{value:"90",text:k.percentile90th,"data-test-subj":"p90Percentile"},{value:"95",text:k.percentile95th,"data-test-subj":"p95Percentile"},{value:"99",text:k.percentile99th,"data-test-subj":"p99Percentile"}];return i.a.createElement(r.EuiSelect,{fullWidth:!0,prepend:k.percentile,"data-test-subj":"uxPercentileSelect",options:n,onChange:e=>{return t=e.target.value,void a(Number(t));var t}})}var Ot=a(195),wt=a(199);function Ft(){const{urlParams:{rangeFrom:e,rangeTo:t,refreshPaused:a,refreshInterval:n},refreshTimeRange:r}=Object(oe.a)(),{redirect:l,isDateRangeSet:s}=Object(Ot.a)();return s||l(),i.a.createElement(wt.a,{rangeFrom:e,rangeTo:t,refreshPaused:a,refreshInterval:n,onTimeRangeRefresh:({start:e,end:t})=>{r({rangeFrom:e,rangeTo:t})}})}function jt(){return i.a.createElement(r.EuiEmptyPrompt,{body:i.a.createElement(l.Fragment,null,i.a.createElement(r.EuiLoadingSpinner,{size:"xl"}),i.a.createElement(r.EuiSpacer,null),i.a.createElement(r.EuiTitle,{size:"l"},i.a.createElement("h2",null,p.i18n.translate("xpack.apm.emptyState.loadingMessage",{defaultMessage:"Loadingâ€¦"}))))})}const Pt=p.i18n.translate("xpack.apm.ux.title",{defaultMessage:"Dashboard"});function Mt(){const{core:e,observability:t}=Object(et.a)(),a=t.navigation.PageTemplate,{data:n,status:r}=Object(z.b)((e=>e("GET /api/apm/observability_overview/has_rum_data")),[]),s=null!=n&&n.hasData?void 0:{solution:p.i18n.translate("xpack.apm.ux.overview.solutionName",{defaultMessage:"Observability"}),actions:{elasticAgent:{title:p.i18n.translate("xpack.apm.ux.overview.beatsCard.title",{defaultMessage:"Add the APM integration"}),description:p.i18n.translate("xpack.apm.ux.overview.beatsCard.description",{defaultMessage:"Enable RUM with the APM agent to collect user experience data."}),href:e.http.basePath.prepend("/app/home#/tutorial/apm")}},docsLink:e.docLinks.links.observability.guide},o="loading"===r;return i.a.createElement(l.Fragment,null,i.a.createElement(ge,null,i.a.createElement(a,{noDataConfig:o?void 0:s,pageHeader:{children:i.a.createElement(It,null)}},o&&i.a.createElement(jt,null),i.a.createElement("div",{style:{visibility:o?"hidden":"initial"}},i.a.createElement(vt,null)))))}function It(){const e=Object(T.a)().isMedium?{}:{maxWidth:"70%"};return i.a.createElement("div",{style:{width:"100%"}},i.a.createElement(r.EuiFlexGroup,{wrap:!0},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(r.EuiTitle,null,i.a.createElement("h1",{className:"eui-textNoWrap"},Pt))),i.a.createElement(r.EuiFlexItem,{style:{alignItems:"flex-end",...e}},i.a.createElement(Ft,null))),i.a.createElement(r.EuiFlexGroup,{wrap:!0},i.a.createElement(r.EuiFlexItem,null,i.a.createElement(Tt,null)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(St,null)),i.a.createElement(r.EuiFlexItem,null,i.a.createElement(kt.b,null))))}var Lt=a(147),Ct=a(145),_t=a(64),Rt=a(190),At=a(194);const Dt=p.i18n.translate("xpack.apm.analyzeDataButtonLabel",{defaultMessage:"Explore data"}),Nt=p.i18n.translate("xpack.apm.analyzeDataButtonLabel.message",{defaultMessage:"Explore Data allows you to select and filter result data in any dimension and look for the cause or impact of performance problems."});function zt({appMountParameters:e}){var t,a;const{services:{http:n}}=Object(E.useKibana)(),{urlParams:l}=Object(y.a)(),{rangeTo:s,rangeFrom:o,serviceName:c}=l,u=Object(b.createExploratoryViewUrl)({reportType:"kpi-over-time",allSeries:[{dataType:"ux",name:`${c}-page-views`,time:{from:o,to:s},reportDefinitions:{[X.v]:c?[c]:[]},selectedMetricField:b.RECORDS_FIELD}]},null==n?void 0:n.basePath.get()),d=Object(E.useKibana)();return i.a.createElement(b.HeaderMenuPortal,{setHeaderActionMenu:e.setHeaderActionMenu,theme$:e.theme$},i.a.createElement(r.EuiHeaderLinks,{gutterSize:"xs"},i.a.createElement(r.EuiToolTip,{position:"top",content:i.a.createElement("p",null,Nt)},i.a.createElement(r.EuiHeaderLink,{"data-test-subj":"uxAnalyzeBtn",color:"text",href:u,iconType:"visBarVerticalStacked"},Dt)),i.a.createElement(r.EuiHeaderLink,{color:"primary",iconType:"indexOpen",iconSide:"left",href:null===(t=d.services)||void 0===t||null===(a=t.application)||void 0===a?void 0:a.getUrlForApp("/home#/tutorial/apm")},p.i18n.translate("xpack.apm.addDataButtonLabel",{defaultMessage:"Add data"})),i.a.createElement(At.a,null)))}var Bt=a(196),Vt=a(6);const Ut=[{exact:!0,path:"/",render:Object(Bt.b)("/ux"),breadcrumb:Pt}];function Gt(){const[e]=Object(E.useUiSetting$)("theme:darkMode"),{core:t}=Object(et.a)(),a=t.http.basePath.get();return Object(b.useBreadcrumbs)([{text:p.i18n.translate("xpack.apm.ux.breadcrumbs.root",{defaultMessage:"User Experience"}),href:a+"/app/ux"},{text:p.i18n.translate("xpack.apm.ux.breadcrumbs.dashboard",{defaultMessage:"Dashboard"})}]),i.a.createElement(d.ThemeProvider,{theme:t=>({...t,eui:e?n.euiDarkVars:n.euiLightVars,darkMode:e})},i.a.createElement("div",{className:Vt.APP_WRAPPER_CLASS,"data-test-subj":"csmMainContainer",role:"main"},i.a.createElement(c.Route,{component:g.a}),i.a.createElement(Mt,null)))}const Ht=Object(u.d)({});function qt({appMountParameters:e,core:t,deps:a,config:n,corePlugins:{embeddable:l,inspector:s,maps:o,observability:c,data:d},observabilityRuleTypeRegistry:m}){const{history:p}=e,g=t.i18n,f={...a,maps:o},h={appMountParameters:e,config:n,core:t,inspector:s,plugins:f,observability:c,observabilityRuleTypeRegistry:m};return i.a.createElement(E.RedirectAppLinks,{className:Vt.APP_WRAPPER_CLASS,application:t.application},i.a.createElement(Lt.a.Provider,{value:h},i.a.createElement(E.KibanaContextProvider,{services:{...t,...f,embeddable:l,data:d}},i.a.createElement(g.Context,null,i.a.createElement(u.c,{history:p,router:Ht},i.a.createElement(b.InspectorContextProvider,null,i.a.createElement(Ct.b,null,i.a.createElement(r.EuiErrorBoundary,null,i.a.createElement(Gt,null)),i.a.createElement(zt,{appMountParameters:e}))))))))}const Yt=({core:e,deps:t,appMountParameters:a,config:n,corePlugins:r,observabilityRuleTypeRegistry:l})=>{const{element:s,theme$:c}=a;return Object(_t.createCallApmApi)(e),Object(Rt.a)().catch((e=>{console.log("Error creating static data view",e)})),o.a.render(i.a.createElement(E.KibanaThemeProvider,{theme$:c},i.a.createElement(qt,{appMountParameters:a,core:e,deps:t,config:n,corePlugins:r,observabilityRuleTypeRegistry:l})),s),()=>{o.a.unmountComponentAtNode(s)}}},108:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return i}));var n=a(1),r=a.n(n);const l=Object(n.createContext)({incrementTimeRangeId:()=>{},timeRangeId:0});function i({children:e}){const[t,a]=Object(n.useState)(0),i=Object(n.useMemo)((()=>({incrementTimeRangeId:()=>a((e=>e+1)),timeRangeId:t})),[t,a]);return r.a.createElement(l.Provider,{value:i},e)}},53:function(e,t,a){"use strict";a.d(t,"a",(function(){return u})),a.d(t,"b",(function(){return d}));var n=a(0),r=a(1),l=a.n(r),i=a(11),s=a(96),o=a(64),c=a(9);let u;!function(e){e.LOADING="loading",e.SUCCESS="success",e.FAILURE="failure",e.NOT_INITIATED="not_initiated"}(u||(u={}));function d(e,t,a={}){const{notifications:d}=Object(i.useKibana)(),{preservePreviousData:m=!0,showToastOnError:p=!0}=a,[E,g]=Object(r.useState)({data:void 0,status:u.NOT_INITIATED}),[b,f]=Object(r.useState)(0),{timeRangeId:h}=Object(s.a)(),{addInspectorRequest:v}=Object(c.useInspectorContext)();return Object(r.useEffect)((()=>{let t=new AbortController;return async function(){t.abort(),t=new AbortController;const a=t.signal,r=e((e=>(t,a)=>Object(o.callApmApi)(t,{...a,signal:e}))(a));if(r){g((e=>({data:m?e.data:void 0,status:u.LOADING,error:void 0})));try{const e=await r;a.aborted||g({data:e,status:u.SUCCESS,error:void 0})}catch(e){const t=e;if(!a.aborted){const a="response"in t?function(e){var t,a,r,i,s;const o=null!==(t=null===(a=e.body)||void 0===a?void 0:a.message)&&void 0!==t?t:null===(r=e.response)||void 0===r?void 0:r.statusText;return l.a.createElement(l.a.Fragment,null,o," (",null===(i=e.response)||void 0===i?void 0:i.status,")",l.a.createElement("h5",null,n.i18n.translate("xpack.apm.fetcher.error.url",{defaultMessage:"URL"})),null===(s=e.response)||void 0===s?void 0:s.url)}(t):t.message;p&&d.toasts.danger({title:n.i18n.translate("xpack.apm.fetcher.error.title",{defaultMessage:"Error while fetching resource"}),body:l.a.createElement("div",null,l.a.createElement("h5",null,n.i18n.translate("xpack.apm.fetcher.error.status",{defaultMessage:"Error"})),a)}),g({data:void 0,status:u.FAILURE,error:e})}}}}(),()=>{t.abort()}}),[b,m,h,p,...t]),Object(r.useEffect)((()=>{var e;E.error?v({...E,data:null===(e=E.error.body)||void 0===e?void 0:e.attributes}):v(E)}),[v,E]),Object(r.useMemo)((()=>({...E,refetch:()=>{f((e=>e+1))}})),[E])}},96:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(1),r=a(108);function l(){return Object(n.useContext)(r.a)}}}]);