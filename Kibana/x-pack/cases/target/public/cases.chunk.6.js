/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.cases_bundle_jsonpfunction=window.cases_bundle_jsonpfunction||[]).push([[6],{181:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return p}));var a=n(2),l=n.n(a),c=n(11),i=n(64),r=n(3),o=n(13),s=n(48),u=n(90),d=n(85),m=n(60),g=n(65);const b=["urgency","severity","impact","category","subcategory"],E={urgency:[],severity:[],impact:[],category:[],subcategory:[]},p=({isEdit:e=!0,fields:t,connector:n,onChange:p})=>{const f=Object(a.useRef)(!0),{severity:v=null,urgency:y=null,impact:j=null,category:h=null,subcategory:O=null}=null!=t?t:{},{http:x,notifications:S}=Object(o.d)().services,[w,F]=Object(a.useState)(E),I=Object(a.useMemo)((()=>null!=Object(m.a)(n)),[n]),C=Object(a.useMemo)((()=>Object(d.a)(w.category)),[w.category]),M=Object(a.useMemo)((()=>Object(d.a)(w.urgency)),[w.urgency]),N=Object(a.useMemo)((()=>Object(d.a)(w.severity)),[w.severity]),W=Object(a.useMemo)((()=>Object(d.a)(w.impact)),[w.impact]),L=Object(a.useMemo)((()=>Object(d.a)(w.subcategory.filter((e=>e.dependent_value===h)))),[w.subcategory,h]),$=Object(a.useMemo)((()=>{var e,t,n,a,l;return[...null!=y&&y.length>0?[{title:i.m,description:null===(e=M.find((e=>`${e.value}`===y)))||void 0===e?void 0:e.text}]:[],...null!=v&&v.length>0?[{title:i.j,description:null===(t=N.find((e=>`${e.value}`===v)))||void 0===t?void 0:t.text}]:[],...null!=j&&j.length>0?[{title:i.f,description:null===(n=W.find((e=>`${e.value}`===j)))||void 0===n?void 0:n.text}]:[],...null!=h&&h.length>0?[{title:i.c,description:null===(a=C.find((e=>`${e.value}`===h)))||void 0===a?void 0:a.text}]:[],...null!=O&&O.length>0?[{title:i.l,description:null===(l=L.find((e=>`${e.value}`===O)))||void 0===l?void 0:l.text}]:[]]}),[h,C,j,W,v,N,O,L,y,M]),{isLoading:R}=Object(u.a)({http:x,toastNotifications:S.toasts,connector:n,fields:b,onSuccess:e=>{F(e.reduce(((e,t)=>({...e,[t.element]:[...null!=e[t.element]?e[t.element]:[],t]})),E))}}),T=Object(a.useCallback)(((e,n)=>{p({...t,[e]:n})}),[t,p]);return Object(a.useEffect)((()=>{f.current&&(f.current=!1,p({urgency:y,severity:v,impact:j,category:h,subcategory:O}))}),[h,j,p,v,O,y]),l.a.createElement(l.a.Fragment,null,I&&l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(g.a,null))),e?l.a.createElement("div",{"data-test-subj":"connector-fields-sn-itsm"},l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:i.m},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"urgencySelect",options:M,value:null!=y?y:void 0,isLoading:R,disabled:R,hasNoInitialSelection:!0,onChange:e=>T("urgency",e.target.value)})))),l.a.createElement(c.EuiSpacer,{size:"m"}),l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:i.j},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"severitySelect",options:N,value:null!=v?v:void 0,isLoading:R,disabled:R,hasNoInitialSelection:!0,onChange:e=>T("severity",e.target.value)}))),l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:i.f},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"impactSelect",options:W,value:null!=j?j:void 0,isLoading:R,disabled:R,hasNoInitialSelection:!0,onChange:e=>T("impact",e.target.value)})))),l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:i.c},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"categorySelect",options:C,value:null!=h?h:void 0,isLoading:R,disabled:R,hasNoInitialSelection:!0,onChange:e=>p({...t,category:e.target.value,subcategory:null})}))),l.a.createElement(c.EuiFlexItem,null,(null==L?void 0:L.length)>0?l.a.createElement(c.EuiFormRow,{fullWidth:!0,label:i.l},l.a.createElement(c.EuiSelect,{fullWidth:!0,"data-test-subj":"subcategorySelect",options:L,value:null!=O?O:"",isLoading:R,disabled:R,hasNoInitialSelection:!0,onChange:e=>T("subcategory",e.target.value)})):null))):l.a.createElement(c.EuiFlexGroup,null,l.a.createElement(c.EuiFlexItem,null,l.a.createElement(s.a,{connectorType:r.n.serviceNowITSM,title:n.name,listItems:$,isLoading:!1}))))}},48:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var a=n(2),l=n.n(a),c=n(11),i=n(34),r=n.n(i),o=n(13),s=n(47);const u=r.a.span.withConfig({displayName:"StyledText",componentId:"sc-10fyrf5-0"})(["span{display:block;}"]),d=({connectorType:e,title:t,listItems:n,isLoading:i})=>{const{triggersActionsUi:r}=Object(o.d)().services,d=Object(a.useMemo)((()=>l.a.createElement(u,null,n.length>0&&n.map(((e,t)=>l.a.createElement("span",{"data-test-subj":"card-list-item",key:`${e.title}-${t}`},l.a.createElement("strong",null,`${e.title}: `),e.description))))),[n]),m=Object(a.useMemo)((()=>l.a.createElement(c.EuiIcon,{size:"xl",type:Object(s.b)(r,e)})),[e]);return l.a.createElement(l.a.Fragment,null,i&&l.a.createElement(c.EuiLoadingSpinner,{"data-test-subj":"connector-card-loading"}),!i&&l.a.createElement(c.EuiFlexGroup,{direction:"row"},l.a.createElement(c.EuiFlexItem,null,l.a.createElement(c.EuiCard,{"data-test-subj":"connector-card",description:d,display:"plain",layout:"horizontal",paddingSize:"none",title:t,titleSize:"xs"})),l.a.createElement(c.EuiFlexItem,{grow:!1},m)))};d.displayName="ConnectorCardDisplay";const m=Object(a.memo)(d)},56:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=({connector_id:e,service_message:t,...n})=>({...n,actionId:e,...t&&{serviceMessage:t}})},65:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),l=n.n(a),c=n(11),i=n(1);const r=i.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningTitle",{defaultMessage:"This connector type is deprecated"}),o=i.i18n.translate("xpack.cases.connectors.serviceNow.deprecatedConnectorWarningDesc",{defaultMessage:"Update this connector, or create a new one."}),s=({type:e="warning"})=>l.a.createElement(c.EuiCallOut,{title:r,color:e,iconType:"alert","data-test-subj":"deprecated-connector-warning-callout"},o);s.displayName="DeprecatedCallout";const u=l.a.memo(s)},85:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));const a=e=>e.map((e=>({value:e.value,text:e.label})))},90:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var a=n(2),l=n(19),c=n(56);var i=n(64);const r=({http:e,connector:t,toastNotifications:n,fields:r,onSuccess:o})=>{const[s,u]=Object(a.useState)(!1),[d,m]=Object(a.useState)([]),g=Object(a.useRef)(!1),b=Object(a.useRef)(new AbortController);return Object(a.useEffect)((()=>(g.current=!1,b.current.abort(),(async()=>{if(t)try{b.current=new AbortController,u(!0);const E=await async function({http:e,signal:t,connectorId:n,fields:a}){const i=await e.post(Object(l.d)(n),{body:JSON.stringify({params:{subAction:"getChoices",subActionParams:{fields:a}}}),signal:t});return Object(c.a)(i)}({http:e,signal:b.current.signal,connectorId:t.id,fields:r});var a,s;if(!g.current)if(u(!1),m(null!==(a=E.data)&&void 0!==a?a:[]),E.status&&"error"===E.status)n.addDanger({title:i.d,text:`${null!==(s=E.serviceMessage)&&void 0!==s?s:E.message}`});else if(o){var d;o(null!==(d=E.data)&&void 0!==d?d:[])}}catch(e){g.current||(u(!1),"AbortError"!==e.name&&n.addDanger({title:i.d,text:e.message}))}else u(!1)})(),()=>{g.current=!0,b.current.abort()})),[e,t,n,r]),{choices:d,isLoading:s}}}}]);