/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.osquery_bundle_jsonpfunction=window.osquery_bundle_jsonpfunction||[]).push([[7],{173:function(e,t,n){"use strict";n.r(t),n.d(t,"OsqueryAction",(function(){return g})),n.d(t,"default",(function(){return b}));var a=n(14),i=n(11),l=n(0),o=n.n(l),r=n(35),s=n(1),u=n(97),c=n(114),d=n(34),m=n(79),E=n(68),p=n(58),h=n(37);const y=({metadata:e})=>{var t,n,r;const E=Object(d.e)().services.application.capabilities.osquery,h=null!==(t=null==e||null===(n=e.info)||void 0===n||null===(r=n.agent)||void 0===r?void 0:r.id)&&void 0!==t?t:void 0,{data:y,isFetched:g,isLoading:v}=Object(u.a)({agentId:h,silent:!0,skip:!h}),{data:b,isFetched:q,isError:O,isLoading:f}=Object(c.b)({policyId:null==y?void 0:y.policy_id,skip:!y,silent:!0}),_=Object(l.useMemo)((()=>{if(O)return!1;const e=Object(a.find)(null==b?void 0:b.package_policies,["package.name",s.OSQUERY_INTEGRATION_NAME]);return null==e?void 0:e.enabled}),[null==b?void 0:b.package_policies,O]);return E.runSavedQueries||E.writeLiveQueries?v?o.a.createElement(i.EuiLoadingContent,{lines:10}):!h||g&&!y?o.a.createElement(i.EuiEmptyPrompt,{icon:o.a.createElement(p.a,null),title:o.a.createElement("h2",null,"Osquery is not available"),titleSize:"xs",body:o.a.createElement("p",null,"An Elastic Agent is not installed on this host. To run queries, install Elastic Agent on the host, and then add the Osquery Manager integration to the agent policy in Fleet.")}):!q&&f?o.a.createElement(i.EuiLoadingContent,{lines:10}):_?"online"!==(null==y?void 0:y.status)?o.a.createElement(i.EuiEmptyPrompt,{icon:o.a.createElement(p.a,null),title:o.a.createElement("h2",null,"Osquery is not available"),titleSize:"xs",body:o.a.createElement("p",null,"To run queries on this host, the Elastic Agent must be active. Check the status of this agent in Fleet.")}):o.a.createElement(m.a,{formType:"simple",agentId:h}):o.a.createElement(i.EuiEmptyPrompt,{icon:o.a.createElement(p.a,null),title:o.a.createElement("h2",null,"Osquery is not available"),titleSize:"xs",body:o.a.createElement("p",null,"The Osquery Manager integration is not added to the agent policy. To run queries on the host, add the Osquery Manager integration to the agent policy in Fleet.")}):o.a.createElement(i.EuiEmptyPrompt,{icon:o.a.createElement(p.a,null),title:o.a.createElement("h2",null,"Permissions denied"),titleSize:"xs",body:o.a.createElement("p",null,"To access this page, ask your administrator for ",o.a.createElement(i.EuiCode,null,"osquery")," Kibana privileges.")})},g=o.a.memo(y),v=({services:e,...t})=>o.a.createElement(h.f,{theme$:e.theme.theme$},o.a.createElement(d.b,{services:e},o.a.createElement(i.EuiErrorBoundary,null,o.a.createElement(r.QueryClientProvider,{client:E.a},o.a.createElement(g,t))))),b=o.a.memo(v)}}]);