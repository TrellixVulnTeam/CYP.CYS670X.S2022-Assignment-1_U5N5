/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[1],{102:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"b",(function(){return r}));var n=a(16);const i=a.n(n).a.createContext({}),r=()=>{const e=Object(n.useContext)(i);if(void 0===e.combinedQuery||void 0===e.currentDataView||void 0===e.currentSavedSearch||void 0===e.dataViewsContract||void 0===e.kibanaConfig)throw new Error("required attribute is undefined");return e}},103:function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"f",(function(){return r})),a.d(t,"g",(function(){return s})),a.d(t,"i",(function(){return o})),a.d(t,"h",(function(){return c})),a.d(t,"d",(function(){return l})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return d}));a(44);var n=a(90);let i;function r(e){return e===n.c.FAILED}function s(e){return e===n.c.ANALYZING||e===n.c.REINDEXING||e===n.c.STARTED||e===n.c.STARTING}function o(e){return e===n.c.STOPPED}function c(e){return"object"==typeof e&&null!==e&&{}.hasOwnProperty.call(e,"state")&&Object.values(n.c).includes(e.state)&&{}.hasOwnProperty.call(e,"progress")&&Array.isArray(e.progress)}function l(e){let t=0,a=0;for(const n of e.progress)if(t++,a=n.progress_percent,n.progress_percent<100)break;return{currentPhase:t,progress:a,totalPhases:e.progress.length}}a.d(t,"b",(function(){return n.c})),function(e){e.BATCH="batch",e.CONTINUOUS="continuous"}(i||(i={}));const u={configDestIndex:"config.dest.index",configSourceIndex:"config.source.index",configCreateTime:"config.create_time",description:"config.description",id:"id",memoryStatus:"stats.memory_usage.status"};function d(e){const t=function(e){if(c(e))return Math.round(e.progress.reduce(((e,t)=>e+t.progress_percent),0)/e.progress.length)}(e);return e.state===n.c.STOPPED&&100===t}},106:function(e,t,a){"use strict";a.d(t,"g",(function(){return i})),a.d(t,"h",(function(){return r})),a.d(t,"f",(function(){return s})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return l})),a.d(t,"d",(function(){return u})),a.d(t,"a",(function(){return d}));var n=a(90);const i=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return 1===t.length&&t[0]===n.a.OUTLIER_DETECTION},r=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return 1===t.length&&t[0]===n.a.REGRESSION},s=e=>{if("object"!=typeof e||null===e)return!1;const t=Object.keys(e);return 1===t.length&&t[0]===n.a.CLASSIFICATION},o=e=>{let t="";return r(e)&&(t=e.regression.dependent_variable),s(e)&&(t=e.classification.dependent_variable),t},c=e=>{let t;return r(e)&&void 0!==e.regression.prediction_field_name?t=e.regression.prediction_field_name:s(e)&&void 0!==e.classification.prediction_field_name&&(t=e.classification.prediction_field_name),t},l=e=>`${o(e)}_prediction`,u=(e,t,a)=>{const n=c(t);return`${e}.${n||l(t)}`},d=e=>{const t=Object.keys(e||{});return 1===t.length?t[0]:"unknown"}},112:function(e,t,a){"use strict";a.d(t,"c",(function(){return c})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return u})),a.d(t,"d",(function(){return d})),a.d(t,"e",(function(){return f})),a.d(t,"g",(function(){return m})),a.d(t,"h",(function(){return p})),a.d(t,"f",(function(){return b}));var n=a(74),i=a(106),r=a(47),s=a(142),o=a(152);const c=10,l=new Set([r.ES_FIELD_TYPES.UNSIGNED_LONG,r.ES_FIELD_TYPES.LONG,r.ES_FIELD_TYPES.INTEGER,r.ES_FIELD_TYPES.SHORT,r.ES_FIELD_TYPES.BYTE]),u=new Set([r.ES_FIELD_TYPES.DOUBLE,r.ES_FIELD_TYPES.FLOAT,r.ES_FIELD_TYPES.HALF_FLOAT,r.ES_FIELD_TYPES.SCALED_FLOAT]),d="ml__id_copy",f="ml__incremental_id",m=e=>{var t;const{fields:a}=s.a,n=null===(t=a.find((t=>t.name===e)))||void 0===t?void 0:t.type;let i=!1;if(void 0!==n&&n===r.ES_FIELD_TYPES.KEYWORD){const t=s.a.getFieldById(e.replace(/\.keyword$/,""));i=null!==t&&t.type===r.ES_FIELD_TYPES.TEXT}else if(void 0!==n&&n===r.ES_FIELD_TYPES.TEXT){const t=s.a.getFieldById(`${e}.keyword`);i=null!==t&&t.type===r.ES_FIELD_TYPES.KEYWORD}return i},p=(e,t,a)=>{const n=a.dest.results_field;if(Object(i.g)(a.analysis)){if(e===`${n}.${o.c}`)return-1;if(t===`${n}.${o.c}`)return 1}if(Object(i.f)(a.analysis)||Object(i.h)(a.analysis)){const r=Object(i.c)(a.analysis),s=Object(i.d)(n,a.analysis,!0);if(e===`${n}.is_training`)return-1;if(t===`${n}.is_training`)return 1;if(e===s)return-1;if(t===s)return 1;if(e===r||e===r.replace(/\.keyword$/,""))return-1;if(t===r||t===r.replace(/\.keyword$/,""))return 1;if(e===`${n}.prediction_probability`)return-1;if(t===`${n}.prediction_probability`)return 1}const r=typeof e,s=typeof t,c=e.split("."),l=c[0],u=t.split("."),d=u[0];return l===n&&c.length>1&&d!==n?(c.shift(),c.shift(),c.join(".")===t?1:c.join(".").localeCompare(t)):d===n&&u.length>1&&l!==n?(u.shift(),u.shift(),u.join(".")===e?-1:e.localeCompare(u.join("."))):"string"!==r&&"string"===s?1:"string"===r&&"string"!==s?-1:e.localeCompare(t)},b=(e,t,a)=>{const c={selectedFields:[],docFields:[]};if(0===e.length)return c;const l=t.dest.results_field,u=[];let d,f;if(Object(i.g)(t.analysis)&&(e=t.analysis.outlier_detection.compute_feature_influence?e.filter((e=>!e.name.includes(`${l}.${o.b}.`))):e.filter((e=>!e.name.includes(`${l}.${o.b}`))),!0===a&&u.push({id:`${l}.${o.c}`,name:`${l}.${o.c}`,type:r.KBN_FIELD_TYPES.NUMBER})),Object(i.f)(t.analysis)||Object(i.h)(t.analysis)){var m;const c=Object(i.c)(t.analysis);d=null===(m=s.a.getFieldById(c))||void 0===m?void 0:m.type;const p=Object(i.e)(t.analysis),b=Object(n.q)(t.analysis),h=Object(n.p)(t.analysis),g=`${c}_prediction`;f=`${l}.${p||g}`,e=0===(null!=b?b:0)?e.filter((e=>!e.name.includes(`${l}.${o.a}`))):e.filter((e=>!e.name.includes(`${l}.${o.a}.`))),e=0===(null!=h?h:0)?e.filter((e=>!e.name.includes(`${l}.${o.d}`))):e.filter((e=>!e.name.includes(`${l}.${o.d}.`))),!0===a&&u.push({id:`${l}.is_training`,name:`${l}.is_training`,type:r.ES_FIELD_TYPES.BOOLEAN},{id:f,name:f,type:d})}u.push(...e),u.sort((({name:e},{name:a})=>p(e,a,t)));let b=u.filter((e=>e.name===f||!e.name.includes(".keyword")));return b.length>8&&(b=b.slice(0,8)),{selectedFields:b,docFields:u,depVarType:d}}},123:function(e,t,a){"use strict";a.d(t,"e",(function(){return n.i})),a.d(t,"c",(function(){return n.g})),a.d(t,"d",(function(){return n.h})),a.d(t,"g",(function(){return n.k})),a.d(t,"b",(function(){return n.f})),a.d(t,"j",(function(){return n.o})),a.d(t,"h",(function(){return n.l})),a.d(t,"k",(function(){return n.p})),a.d(t,"m",(function(){return n.q})),a.d(t,"i",(function(){return n.m})),a.d(t,"f",(function(){return O})),a.d(t,"l",(function(){return w})),a.d(t,"a",(function(){return me}));var n=a(97),i=a(24),r=a.n(i),s=a(25),o=a(16),c=a.n(o),l=a(131),u=a.n(l),d=a(44),f=a(2),m=a(47);const p=e=>"object"==typeof e&&e.hasOwnProperty("data")&&e.hasOwnProperty("id")&&e.hasOwnProperty("interval")&&e.hasOwnProperty("stats")&&e.hasOwnProperty("type")&&"numeric"===e.type,b=e=>"object"==typeof e&&e.hasOwnProperty("data")&&e.hasOwnProperty("cardinality")&&e.hasOwnProperty("id")&&e.hasOwnProperty("type")&&("ordinal"===e.type||"boolean"===e.type);var h=a(12);const g=new s.BehaviorSubject(null),y=Object(d.euiPaletteColorBlind)()[0],_=Object(d.euiPaletteColorBlind)({rotations:2})[10],O=e=>{if(e===n.c)return;let t;switch(e){case"datetime":t=m.KBN_FIELD_TYPES.DATE;break;case"numeric":t=m.KBN_FIELD_TYPES.NUMBER;break;case"boolean":t=m.KBN_FIELD_TYPES.BOOLEAN;break;case"json":t=m.KBN_FIELD_TYPES.OBJECT;break;default:t=m.KBN_FIELD_TYPES.STRING}return t},j=(e,t=20)=>{if("unsupported"===e.type)return f.i18n.translate("xpack.ml.dataGridChart.histogramNotAvailable",{defaultMessage:"Chart not supported."});if(0===e.data.length)return f.i18n.translate("xpack.ml.dataGridChart.notEnoughData",{defaultMessage:"0 documents contain field."});if("boolean"===e.type)return Object(h.jsx)("table",{className:"mlDataGridChart__legendBoolean"},Object(h.jsx)("tbody",null,Object(h.jsx)("tr",null,void 0!==e.data[0]&&Object(h.jsx)("td",null,e.data[0].key_as_string),void 0!==e.data[1]&&Object(h.jsx)("td",null,e.data[1].key_as_string))));if(b(e)&&e.cardinality<=t)return f.i18n.translate("xpack.ml.dataGridChart.singleCategoryLegend",{defaultMessage:"{cardinality, plural, one {# category} other {# categories}}",values:{cardinality:e.cardinality}});if(b(e)&&e.cardinality>t)return f.i18n.translate("xpack.ml.dataGridChart.topCategoriesLegend",{defaultMessage:"top {maxChartColumns} of {cardinality} categories",values:{cardinality:e.cardinality,maxChartColumns:t}});if(p(e)){const t=Math.round(100*e.stats[0])/100,a=Math.round(100*e.stats[1])/100;return t!==a?`${t} - ${a}`:""+t}return""},E=(e,t,a)=>{const n=O(t.schema),i=u()(g),s=(e=>{switch(e){case m.KBN_FIELD_TYPES.BOOLEAN:case m.KBN_FIELD_TYPES.IP:case m.KBN_FIELD_TYPES.STRING:return"ordinal";case m.KBN_FIELD_TYPES.DATE:return"time";case m.KBN_FIELD_TYPES.NUMBER:return"linear"}})(n),o=a=>null==i||b(e)&&"ordinal"===s&&i._source[t.id]===a.key||p(e)&&"linear"===s&&i._source[t.id]>=+a.key&&i._source[t.id]<+a.key+e.interval||p(e)&&"time"===s&&1e3*r()(i._source[t.id]).unix()>=+a.key&&1e3*r()(i._source[t.id]).unix()<+a.key+e.interval?y:_;let c=[];return b(e)?c=e.data.map((e=>{var t;return{...e,key_as_string:null!==(t=e.key_as_string)&&void 0!==t?t:e.key,color:o(e)}})):p(e)&&(c=e.data.map((e=>({...e,key_as_string:e.key_as_string||e.key,color:o(e)})))),{data:c,legendText:j(e,a),xScaleType:s}};var v=a(13),x=a(81),S=a(64),T=a.n(S),D=a(48);a(416);const I={background:{color:"transparent"},chartMargins:{left:0,right:0,top:0,bottom:1},chartPaddings:{left:0,right:0,top:0,bottom:0},scales:{barsPadding:.1}},C=({chartData:e,columnType:t,dataTestSubj:a,hideLabel:n,maxChartColumns:i})=>{const{data:r,legendText:s}=E(e,t,i);return Object(h.jsx)("div",{"data-test-subj":a},!("object"==typeof(o=e)&&o.hasOwnProperty("type")&&"unsupported"===o.type)&&r.length>0&&Object(h.jsx)("div",{className:"mlDataGridChart__histogram","data-test-subj":`${a}-histogram`},Object(h.jsx)(D.Chart,null,Object(h.jsx)(D.Settings,{theme:I}),Object(h.jsx)(D.BarSeries,{id:"histogram",name:"count",xScaleType:D.ScaleType.Ordinal,yScaleType:D.ScaleType.Linear,xAccessor:"key_as_string",yAccessors:["doc_count"],styleAccessor:e=>e.datum.color,data:r}))),Object(h.jsx)("div",{className:T()("mlDataGridChart__legend",{"mlDataGridChart__legend--numeric":"number"===t.schema}),"data-test-subj":`${a}-legend`},s),!n&&Object(h.jsx)("div",{"data-test-subj":`${a}-id`},t.id));var o},w=(e,t=5,a=n.b,i)=>{const r={pageIndex:0,pageSize:t},[s,c]=Object(o.useState)(!1),[l,u]=Object(o.useState)(""),[d,f]=Object(o.useState)(""),[m,p]=Object(o.useState)(x.b.UNUSED),[b,g]=Object(o.useState)(0),[y,_]=Object(o.useState)(void 0),[O,j]=Object(o.useState)([]),[E,S]=Object(o.useState)([]),[T,D]=Object(o.useState)(r),[I,w]=Object(o.useState)([]),[A,P]=Object(o.useState)(void 0),F=Object(o.useCallback)((e=>{D((t=>({pageIndex:Math.floor(t.pageSize*t.pageIndex/e),pageSize:e})))}),[]),N=Object(o.useCallback)((e=>D((t=>({...t,pageIndex:e})))),[]),[L,M]=Object(o.useState)([]),k=e.map((e=>e.id)),R=(void 0!==i?k.filter(i):k).splice(0,a);Object(o.useEffect)((()=>{M(R)}),[R.join()]);const[B,G]=Object(o.useState)([]),$=Object(o.useCallback)((t=>{const a=t.reduce(((t,a)=>{const n=e.find((e=>e.id===a.id));return"json"===(null==n?void 0:n.schema)&&t.push(a.id),t}),[]);G(a),0===a.length&&w(t)}),[e]),Y=Object(o.useMemo)((()=>e.map(((e,t)=>{const a=O.find((t=>t.id===e.id));return{...e,display:void 0!==a&&!0===A?Object(h.jsx)(C,{chartData:a,columnType:e,dataTestSubj:`mlDataGridChart-${e.id}`}):void 0}})).sort(((e,t)=>-1===L.indexOf(e.id)&&L.indexOf(t.id)>-1?1:-1===L.indexOf(t.id)&&L.indexOf(e.id)>-1?-1:-1===L.indexOf(e.id)&&-1===L.indexOf(t.id)?e.id.localeCompare(t.id):L.indexOf(e.id)-L.indexOf(t.id)))),[e,O,A,JSON.stringify(L)]);return Object(o.useEffect)((()=>{void 0===A&&b>0&&void 0!==y&&P(b<=n.a&&y!==v.a.GTE)}),[A,b,y]),{ccsWarning:s,chartsVisible:A,chartsButtonVisible:!0,columnsWithCharts:Y,errorMessage:d,invalidSortingColumnns:B,noDataMessage:l,onChangeItemsPerPage:F,onChangePage:N,onSort:$,pagination:T,resetPagination:()=>D(r),rowCount:b,rowCountRelation:y,setColumnCharts:j,setCcsWarning:c,setErrorMessage:f,setNoDataMessage:u,setPagination:D,setRowCount:g,setRowCountRelation:_,setSortingColumns:w,setStatus:p,setTableItems:S,setVisibleColumns:M,sortingColumns:I,status:m,tableItems:E,toggleChartVisibility:()=>{void 0!==A&&P(!A)},visibleColumns:L}};var A=a(8),P=a(45),F=a(225),N=a(114),L=a.n(N),M=a(185);const k="feature_name",R="importance",B=1e-5,G=f.i18n.translate("xpack.ml.dataframe.analytics.decisionPathFeatureOtherTitle",{defaultMessage:"other"}),$=e=>Array.isArray(e)&&e.length>0&&3===e[0].length,Y=e=>null==e?"":"boolean"==typeof e?e?"True":"False":"number"==typeof e?e.toString():e,V=({baseline:e,featureImportance:t,predictedValue:a,predictedProbability:n})=>({decisionPathData:Object(o.useMemo)((()=>{if(void 0!==e)return Object(M.c)(e)?H({baseline:e.baseline,featureImportance:t,predictedValue:a}):Object(M.a)(e)?J({baselines:e.classes,featureImportance:t,currentClass:a,predictedProbability:n}):void 0}),[e,t,a])}),H=({baseline:e,featureImportance:t,predictedValue:a})=>{const n=t.map((e=>({...e,absImportance:Math.abs(e.importance)})));if(e&&void 0!==a&&Number.isFinite(a)){const t=a-n.reduce(((e,t)=>e+t.importance),0)-e;n.push({[k]:f.i18n.translate("xpack.ml.dataframe.analytics.decisionPathFeatureBaselineTitle",{defaultMessage:"baseline"}),[R]:e,absImportance:-1}),Math.abs(t)>B&&n.push({[k]:G,[R]:t,absImportance:0})}const i=n.filter((e=>void 0!==e)),r=i.sort(((e,t)=>t.absImportance-e.absImportance)).map((e=>[e.feature_name,e.importance,NaN]));let s=0;for(let e=i.length-1;e>=0;e--)s+=r[e][1],r[e][2]=s;return r},z=({predictedProbability:e,decisionPlotData:t})=>{if(e&&t.length>0){const a=e-t[0][2];Math.abs(a)>B&&(t.forEach((e=>e[2]=e[2]+a)),t.push([G,a,t[t.length-1][2]-a]))}return t},U=({baselines:e,featureImportance:t})=>{let a=0;for(let n=0;n<e.length;n++){let i=0;for(let a=0;a<t.length;a++){const r=t[a],s=Array.isArray(r.classes)?r.classes.find((t=>Y(t.class_name)===Y(e[n].class_name))):r;s&&void 0!==s.importance&&"number"==typeof s.importance&&(i+=s.importance)}a+=Math.exp(e[n].baseline+i)}return a},J=({baselines:e,featureImportance:t,currentClass:a,predictedProbability:n})=>{if(void 0===a||!(Array.isArray(e)&&e.length>=2))return[];const i=t.map((e=>{const t=Array.isArray(e.classes)?e.classes.find((e=>Y(e.class_name)===Y(a))):e;if(t&&"number"==typeof t.importance)return{[k]:e.feature_name,[R]:t.importance,absImportance:Math.abs(t.importance)}})),r=e.find((e=>Y(e.class_name)===Y(a))),s=null!=r&&r.baseline?null==r?void 0:r.baseline:0,o=i.filter((e=>void 0!==e)).sort(((e,t)=>t.absImportance-e.absImportance)).map((e=>[e.feature_name,e.importance,NaN]));return 2===e.length?(({decisionPlotData:e,startingBaseline:t,predictedProbability:a})=>{const n=e;let i=t;for(let e=n.length-1;e>=0;e--){i+=n[e][1];const t=Math.exp(i)/(Math.exp(i)+1);n[e][2]=t}return z({predictedProbability:a,decisionPlotData:n})})({startingBaseline:s,decisionPlotData:o,predictedProbability:n}):(({baselines:e,decisionPlotData:t,startingBaseline:a,featureImportance:n,predictedProbability:i})=>{const r=U({baselines:e,featureImportance:n}),s=a;let o=0;for(let e=t.length-1;e>=0;e--){o+=t[e][1];const a=Math.exp(s+o);t[e][2]=a/r}return z({predictedProbability:i,decisionPlotData:t})})({baselines:e,decisionPlotData:o,startingBaseline:s,featureImportance:t,predictedProbability:n})};var K=a(57),q=a(132);const{euiColorFullShade:W,euiColorMediumShade:Q}=K.euiLightVars,X={line:{strokeWidth:1,stroke:W,opacity:.75},details:{fontFamily:"Arial",fontSize:10,fill:Q,padding:0}},Z={axes:{axisLine:{stroke:Q},tickLabel:{fontSize:10,fill:Q},tickLine:{stroke:Q},gridLine:{horizontal:{dash:[1,2]},vertical:{strokeWidth:0}}}},ee=Object(h.jsx)(d.EuiIcon,{type:"dot",size:"m"}),te=({decisionPathData:e,predictionFieldName:t,minDomain:a,maxDomain:n,baseline:i})=>{const r=Object(o.useMemo)((()=>i&&Object(M.c)(i)?[{dataValue:i.baseline,header:Object(q.a)(i.baseline,"").toString(),details:f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathBaselineText",{defaultMessage:"baseline (average of predictions for all data points in the training data set)"})}]:void 0),[i]),s=r?f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathLinePredictionTitle",{defaultMessage:"Prediction"}):f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathLinePredictionProbabilityTitle",{defaultMessage:"Prediction probability"}),c=Object(o.useCallback)((e=>Object(q.a)(e,"").toString()),[]);return Object(h.jsx)("div",{"data-test-subj":"mlDFADecisionPathChart"},Object(h.jsx)(D.Chart,{size:{height:125+10*e.length}},Object(h.jsx)(D.Settings,{theme:Z,rotation:90}),r&&Object(h.jsx)(D.LineAnnotation,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathBaseline",domainType:D.AnnotationDomainType.YDomain,dataValues:r,style:X,marker:ee}),Object(h.jsx)(D.Axis,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxis",tickFormat:c,title:f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.decisionPathXAxisTitle",{defaultMessage:"{xAxisLabel} for '{predictionFieldName}'",values:{predictionFieldName:t,xAxisLabel:s}}),showGridLines:!1,position:D.Position.Top,showOverlappingTicks:!0,domain:a&&n?{min:a,max:n}:void 0}),Object(h.jsx)(D.Axis,{showGridLines:!0,id:"left",position:D.Position.Left}),Object(h.jsx)(D.LineSeries,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathLine",name:s,xScaleType:D.ScaleType.Ordinal,yScaleType:D.ScaleType.Linear,xAccessor:0,yAccessors:[2],data:e})))},ae=()=>Object(h.jsx)(d.EuiCallOut,{color:"warning"},Object(h.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.regressionDecisionPathDataMissingCallout",defaultMessage:"No decision path data available."})),ne=({baseline:e,featureImportance:t,predictedValue:a,predictionFieldName:n})=>{const{decisionPathData:i}=V({baseline:e,featureImportance:t,predictedValue:a}),r=Object(o.useMemo)((()=>{let t,a;if(i&&$(i)){const[n,r]=L.a.extent(i,(e=>e[2]));t=r,a=n;const s=.1*Math.abs(t-a);t=("number"==typeof e?Math.max(t,e):t)+s,a=("number"==typeof e?Math.min(a,e):a)-s}return{maxDomain:t,minDomain:a}}),[i,e]);return i?Object(h.jsx)(c.a.Fragment,null,void 0===e&&Object(h.jsx)(d.EuiCallOut,{size:"s",heading:"p",title:Object(h.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.missingBaselineCallout",defaultMessage:"Unable to calculate baseline value, which might result in a shifted decision path."}),color:"warning",iconType:"alert"}),Object(h.jsx)(te,{decisionPathData:i,predictionFieldName:n,minDomain:r.minDomain,maxDomain:r.maxDomain,baseline:e})):Object(h.jsx)(ae,null)},ie=({featureImportance:e})=>Object(h.jsx)(d.EuiCodeBlock,{isCopyable:!0},JSON.stringify(e)),re=({featureImportance:e,predictedValue:t,topClasses:a,predictionFieldName:n,predictedProbability:i,baseline:r})=>{const[s,l]=Object(o.useState)(Y(a[0].class_name)),{decisionPathData:u}=V({baseline:r,featureImportance:e,predictedValue:s,predictedProbability:i}),m=Object(o.useMemo)((()=>{const e=Y(t);return Array.isArray(a)?a.map((t=>{const a=Y(t.class_name);return{value:a,inputDisplay:a===e?Object(h.jsx)(d.EuiHealth,{color:"success",style:{lineHeight:"inherit"}},a):a}})):void 0}),[a,t]),p=Object(o.useMemo)((()=>{let e,t;if(u&&$(u)){const[a,n]=L.a.extent(u,(e=>e[2])),i=.1*Math.abs(n-a);e=n+i,t=a-i}return{maxDomain:e,minDomain:t}}),[u]);return u?Object(h.jsx)(c.a.Fragment,null,Object(h.jsx)(d.EuiSpacer,{size:"xs"}),Object(h.jsx)(d.EuiTitle,{size:"xxxs"},Object(h.jsx)("span",null,f.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.classificationDecisionPathClassNameTitle",{defaultMessage:"Class name"}))),void 0!==m&&Object(h.jsx)(d.EuiSuperSelect,{"data-test-subj":"mlDFADecisionPathClassNameSelect",compressed:!0,options:m,valueOfSelected:s,onChange:l}),Object(h.jsx)(te,{decisionPathData:u,predictionFieldName:n,minDomain:p.minDomain,maxDomain:p.maxDomain})):Object(h.jsx)(ae,null)};var se,oe=a(72);!function(e){e.CHART="decision_path_chart",e.JSON="decision_path_json"}(se||(se={}));const ce=({baseline:e,featureImportance:t,predictedValue:a,topClasses:n,analysisType:i,predictionFieldName:r,predictedProbability:s})=>{const[l,u]=Object(o.useState)(se.CHART),{services:{docLinks:f}}=Object(oe.b)(),m=f.links.ml.featureImportance;if(t.length<2)return Object(h.jsx)("div",{"data-test-subj":"mlDFADecisionPathJSONViewer"},Object(h.jsx)(ie,{featureImportance:t}));const p=[{id:se.CHART,name:Object(h.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotTab",defaultMessage:"Decision plot"})},{id:se.JSON,name:Object(h.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathJSONTab",defaultMessage:"JSON"})}];return Object(h.jsx)("div",{"data-test-subj":"mlDFADecisionPathPopover"},Object(h.jsx)("div",{style:{display:"flex",width:300}},Object(h.jsx)(d.EuiTabs,{size:"s"},p.map((e=>Object(h.jsx)(d.EuiTab,{"data-test-subj":`mlDFADecisionPathPopoverTab-${e.id}`,isSelected:e.id===l,onClick:()=>u(e.id),key:e.id},e.name))))),l===se.CHART&&Object(h.jsx)(c.a.Fragment,null,Object(h.jsx)(d.EuiText,{size:"xs",color:"subdued",style:{paddingTop:5}},Object(h.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.decisionPathPlotHelpText",defaultMessage:"SHAP decision plots use {linkedFeatureImportanceValues} to show how models arrive at the predicted value for '{predictionFieldName}'.",values:{predictionFieldName:r,linkedFeatureImportanceValues:Object(h.jsx)(d.EuiLink,{href:m,target:"_blank"},Object(h.jsx)(P.FormattedMessage,{id:"xpack.ml.dataframe.analytics.explorationResults.linkedFeatureImportanceValues",defaultMessage:"feature importance values"}))}})),i===x.a.CLASSIFICATION&&Object(M.a)(e)&&Object(h.jsx)(re,{featureImportance:t,topClasses:n,predictedValue:Y(a),predictedProbability:s,predictionFieldName:r,baseline:e}),i===x.a.REGRESSION&&Object(M.c)(e)&&void 0!==a&&Object(h.jsx)(ne,{featureImportance:t,baseline:e,predictedValue:"string"==typeof a?parseFloat(a):a,predictionFieldName:r})),l===se.JSON&&Object(h.jsx)(ie,{featureImportance:t}))};var le=a(6),ue=a(90);a(421);const de=({title:e})=>Object(h.jsx)(d.EuiTitle,{size:"xs"},Object(h.jsx)("span",null,e));function fe(e){return"string"==typeof(null==e?void 0:e.title)&&""!==(null==e?void 0:e.title)}const me=Object(o.memo)((e=>{const{baseline:t,chartsVisible:a,chartsButtonVisible:i,ccsWarning:r,columnsWithCharts:s,dataTestSubj:c,errorMessage:l,invalidSortingColumnns:u,noDataMessage:m,onChangeItemsPerPage:p,onChangePage:b,onSort:g,pagination:y,setVisibleColumns:_,renderCellValue:O,rowCount:j,sortingColumns:E,status:v,tableItems:S,toastNotifications:T,toggleChartVisibility:D,visibleColumns:I,predictionFieldName:C,resultsField:w,analysisType:A}=e,N=Object(o.useMemo)((()=>A===x.a.REGRESSION||A===x.a.CLASSIFICATION||A===x.a.OUTLIER_DETECTION?{featureImportance:({children:e})=>{var a;const i=null==e||null===(a=e.props)||void 0===a?void 0:a.visibleRowIndex,r=S[i];if(!r)return Object(h.jsx)("div",null);const s=null!=w?w:ue.d;let o,c,l=[];void 0!==C&&r&&void 0!==r[`${s}.${C}`]&&(o=r[`${s}.${C}`],l=Object(n.n)(r,s),c=r[`${s}.prediction_probability`]);const u=l.reduce(((e,t)=>"boolean"==typeof t.class_name||e),!1),d=Object(n.j)(r,s,u);return Object(h.jsx)("div",{"data-test-subj":"mlDFAFeatureImportancePopover"},Object(h.jsx)(ce,{analysisType:A,predictedValue:o,predictedProbability:c,baseline:t,featureImportance:d,topClasses:l,predictionFieldName:C?C.replace("_prediction",""):void 0}))},featureInfluence:({cellContentsElement:e})=>Object(h.jsx)(d.EuiCodeBlock,{isCopyable:!0},e.textContent)}:void 0),[t,S]);Object(o.useEffect)((()=>{u.length>0&&u.forEach((e=>{T.addDanger(f.i18n.translate("xpack.ml.dataGrid.invalidSortingColumnError",{defaultMessage:"The column '{columnId}' cannot be used for sorting.",values:{columnId:e}}))}))}),[u,T]);const L=Object(o.useRef)(null);if(v===x.b.LOADED&&0===S.length)return Object(h.jsx)("div",{"data-test-subj":`${c} empty`},fe(e)&&Object(h.jsx)(de,{title:e.title}),Object(h.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},Object(h.jsx)("p",null,f.i18n.translate("xpack.ml.dataGrid.IndexNoDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure you have sufficient permissions, the index contains documents and your query is not too restrictive."}))));if(""!==m)return Object(h.jsx)("div",{"data-test-subj":`${c} empty`},fe(e)&&Object(h.jsx)(de,{title:e.title}),Object(h.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.dataGridNoDataCalloutTitle",{defaultMessage:"Index preview not available"}),color:"primary"},Object(h.jsx)("p",null,m)));let M;v===x.b.ERROR&&(M=l&&!l.includes("failed to create query")?Object(h.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataframe.analytics.exploration.querySyntaxError",{defaultMessage:"An error occurred loading the index data. Please ensure your query syntax is valid."}),color:"danger",iconType:"cross"},Object(h.jsx)("p",null,l)):Object(h.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.indexDataError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},Object(h.jsx)(d.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},l)));return Object(h.jsx)("div",{"data-test-subj":`${c} ${v===x.b.ERROR?"error":"loaded"}`,ref:L},fe(e)&&Object(h.jsx)(d.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(h.jsx)(d.EuiFlexItem,null,Object(h.jsx)(de,{title:e.title})),e.copyToClipboard&&e.copyToClipboardDescription&&Object(h.jsx)(d.EuiFlexItem,{grow:!1},Object(h.jsx)(d.EuiCopy,{beforeMessage:e.copyToClipboardDescription,textToCopy:e.copyToClipboard},(t=>Object(h.jsx)(d.EuiButtonIcon,{onClick:t,iconType:"copyClipboard","aria-label":e.copyToClipboardDescription}))))),void 0!==M&&Object(h.jsx)("div",{"data-test-subj":`${c} error`},M,Object(h.jsx)(d.EuiSpacer,{size:"m"})),r&&Object(h.jsx)("div",{"data-test-subj":`${c} ccsWarning`},Object(h.jsx)(d.EuiCallOut,{title:f.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutTitle",{defaultMessage:"Cross-cluster search returned no fields data."}),color:"warning"},Object(h.jsx)("p",null,f.i18n.translate("xpack.ml.dataGrid.CcsWarningCalloutBody",{defaultMessage:"There was an issue retrieving data for the data view. Source preview in combination with cross-cluster search is only supported for versions 7.10 and above. You may still configure and create the transform."}))),Object(h.jsx)(d.EuiSpacer,{size:"m"})),Object(h.jsx)(d.EuiMutationObserver,{observerOptions:{subtree:!0,attributes:!0,childList:!0},onMutation:()=>{if(null!==L.current){const e=L.current.querySelectorAll(".euiDataGrid__virtualized");for(const t of Array.from(e))Object(le.b)(t)&&Object(le.b)(t.style)&&"auto"!==t.style.height&&(t.style.height="auto")}}},(t=>Object(h.jsx)("div",{className:"mlDataGrid",ref:t},Object(h.jsx)(d.EuiDataGrid,{"aria-label":fe(e)?e.title:"",columns:s.map((e=>(e.initialWidth=165,e))),columnVisibility:{visibleColumns:I,setVisibleColumns:_},gridStyle:n.d,rowCount:j,renderCellValue:O,sorting:{columns:E,onSort:g},toolbarVisibility:{...n.e,...i?{additionalControls:Object(h.jsx)(d.EuiToolTip,{content:f.i18n.translate("xpack.ml.dataGrid.histogramButtonToolTipContent",{defaultMessage:"Queries run to fetch histogram chart data will use a sample size per shard of {samplerShardSize} documents.",values:{samplerShardSize:F.a}})},Object(h.jsx)(d.EuiButtonEmpty,{"aria-pressed":!0===a,className:"euiDataGrid__controlBtn"+(!0===a?" euiDataGrid__controlBtn--active":""),"data-test-subj":`${c}HistogramButton`,size:"xs",iconType:"visBarVertical",color:"text",onClick:D,disabled:void 0===a},Object(h.jsx)(P.FormattedMessage,{id:"xpack.ml.dataGrid.histogramButtonText",defaultMessage:"Histogram charts"})))}:{}},popoverContents:N,pagination:{...y,pageSizeOptions:[5,10,25],onChangeItemsPerPage:p,onChangePage:b}})))))}),((e,t)=>Object(A.isEqual)(pe(e),pe(t))));function pe(e){return[e.columnsWithCharts,e.dataTestSubj,e.errorMessage,e.invalidSortingColumnns,e.noDataMessage,e.pagination,e.rowCount,e.sortingColumns,e.status,e.tableItems,e.visibleColumns,...fe(e)?[e.copyToClipboard,e.copyToClipboardDescription,e.title]:[]]}},132:function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return s}));var n=a(24),i=a.n(n);function r(e,t,a,n){if(Array.isArray(e)){if(1===e.length)return s(e[0],t,a,n);return`[${e.map((e=>s(e,t,void 0,n)))}]`}return s(e,t,a,n)}function s(e,t,a,n){if(null==e)return"";if("time_of_week"===t){const t=void 0!==n&&void 0!==n.timestamp?new Date(n.timestamp):new Date,a=i.a.utc(t).startOf("week").add(e,"s");return i()(a.valueOf()).format("ddd HH:mm")}if("time_of_day"===t){const t=void 0!==n&&void 0!==n.timestamp?new Date(n.timestamp):new Date,a=i.a.utc(t).startOf("day").add(e,"s");return i()(a.valueOf()).format("HH:mm")}if(void 0!==a)return a.convert(e,"text");{const t=Math.abs(e);if(t>=1e4||t===Math.floor(t))return void 0!==a?a.convert(e,"text"):Number(e.toFixed(0));if(t>=10)return Number(e.toFixed(1));{let t;return t=e>0?Math.pow(10,3-Math.floor(Math.log(e)/Math.LN10)-1):Math.pow(10,3-Math.floor(Math.log(-1*e)/Math.LN10)-1),Math.round(e*t)/t}}}},136:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(5),i=a.n(n),r=a(80),s=a(96),o=a(83);const c=new class FieldFormatService{constructor(){i()(this,"indexPatternIdsByJob",{}),i()(this,"formatsByJob",{})}async populateFormats(e){(await Promise.all(e.map((async e=>{const t=o.a.getJob(e);return{jobId:e,dataViewId:await Object(s.d)(t.datafeed_config.indices.join(","))}})))).forEach((({jobId:e,dataViewId:t})=>{null!==t&&(this.indexPatternIdsByJob[e]=t)}));const t=e.map((e=>Promise.all([this.getFormatsForJob(e)])));try{return(await Promise.all(t)).forEach(((t,a)=>{this.formatsByJob[e[a]]=t[0]})),this.formatsByJob}catch(e){return console.log("Error populating field formats:",e),{formats:{},error:e}}}getFieldFormat(e,t){if(this.formatsByJob.hasOwnProperty(e))return this.formatsByJob[e][t]}getFieldFormatFromIndexPattern(e,t,a){let n;if("cardinality"!==a){const a=e.fields.getByName(t);void 0!==a&&(n=e.getFormatterForField(a))}return n}getFormatsForJob(e){return new Promise(((t,a)=>{const n=o.a.getJob(e).analysis_config.detectors||[],i=[],c=this.indexPatternIdsByJob[e];void 0!==c?Object(s.c)(c).then((e=>{const a=e.fields;n.forEach((t=>{const n=Object(r.q)(t.function);if(void 0!==t.field_name&&"cardinality"!==n){const n=a.getByName(t.field_name);void 0!==n&&(i[t.detector_index]=e.getFormatterForField(n))}})),t(i)})).catch((e=>{a(e)})):t(i)}))}}},142:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(47),i=a(287),r=a(73);class NewJobCapsServiceAnalytics extends i.a{async initializeFromDataVIew(e){try{const t=function(e,t){const a=e[t],i=[],r={};return void 0!==a&&(a.fields.forEach((e=>{e.type===n.ES_FIELD_TYPES.NESTED&&void 0===r[e.name]&&(r[e.name]=!0,i.push(e))})),Object.keys(r).length>0?a.fields.forEach((e=>{if(e.type!==n.ES_FIELD_TYPES.NESTED){const t=e.name.split(".").shift();t&&void 0===r[t]&&i.push(e)}})):i.push(...a.fields)),i}(await r.ml.dataFrameAnalytics.newJobCapsAnalytics(e.title,"rollup"===e.type),e.title),{fieldsPreferringKeyword:a}=Object(i.b)(t);this._fields=a}catch(e){console.error("Unable to load analytics index fields",e)}}}const s=new NewJobCapsServiceAnalytics},152:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return s}));const n="feature_importance",i="feature_influence",r="top_classes",s="outlier_score"},166:function(e,t,a){"use strict";a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return u}));var n=a(2),i=a(73),r=a(81),s=a(103),o=a(90);const c=e=>({}.hasOwnProperty.call(e,"count")&&{}.hasOwnProperty.call(e,"data_frame_analytics")&&Array.isArray(e.data_frame_analytics));function l(e){const t=e.data_frame_analytics.reduce(((e,{state:t})=>(Object(s.f)(t)?e.failed.value=++e.failed.value:Object(s.g)(t)?e.started.value=++e.started.value:Object(s.i)(t)&&(e.stopped.value=++e.stopped.value),e)),{total:{label:n.i18n.translate("xpack.ml.overview.statsBar.totalAnalyticsLabel",{defaultMessage:"Total analytics jobs"}),value:0,show:!0},started:{label:n.i18n.translate("xpack.ml.overview.statsBar.runningAnalyticsLabel",{defaultMessage:"Running"}),value:0,show:!0},stopped:{label:n.i18n.translate("xpack.ml.overview.statsBar.stoppedAnalyticsLabel",{defaultMessage:"Stopped"}),value:0,show:!0},failed:{label:n.i18n.translate("xpack.ml.overview.statsBar.failedAnalyticsLabel",{defaultMessage:"Failed"}),value:0,show:!1}});return t.failed.show=t.failed.value>0,t.total.value=e.count,t}const u=(e,t,a,n,u,d,f)=>{let m=0;const p=async(b=!1)=>{if(!0===b||!1===d){if(r.u.next(r.e.LOADING),m++,m>1)return;try{const d=await i.ml.dataFrameAnalytics.getDataFrameAnalytics(),m=await i.ml.dataFrameAnalytics.getDataFrameAnalyticsStats();let p={};if(f){const e=await i.ml.savedObjects.jobsSpaces();p=e["data-frame-analytics"]}const b=c(m)?l(m):void 0;let h=0;const g=d.data_frame_analytics.reduce(((e,t)=>{var a;const n=c(m)?m.data_frame_analytics.find((e=>t.id===e.id)):void 0;return Object(s.h)(n)?(n.state===o.c.STARTING&&void 0===n.node&&h++,e.push({checkpointing:{},config:t,id:t.id,job_type:Object(r.h)(t.analysis),mode:s.a.BATCH,state:n.state,stats:n,spaceIds:null!==(a=p[t.id])&&void 0!==a?a:[]}),e):e}),[]);e(g),t(b),a(void 0),n(!0),u(h),r.u.next(r.e.IDLE)}catch(i){r.u.next(r.e.ERROR),r.u.next(r.e.IDLE),e([]),t(void 0),a(i),n(!0)}if(m--,m>0)return m=0,void p(!0)}};return p}},184:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(16),i=a(73),r=a(72);function s(){const{services:{mlServices:{httpService:e}}}=Object(r.b)();return Object(n.useMemo)((()=>function(e){const t=Object(i.basePath)();return{getTrainedModels(a,n){let i=null!=a?a:"";return Array.isArray(a)&&(i=a.join(",")),e.http({path:`${t}/trained_models${i&&`/${i}`}`,method:"GET",...n?{query:n}:{}})},getTrainedModelStats(a,n){const i=(Array.isArray(a)?a.join(","):a)||"_all";return e.http({path:`${t}/trained_models/${i}/_stats`,method:"GET"})},getTrainedModelPipelines(a){let n=a;return Array.isArray(a)&&(n=a.join(",")),e.http({path:`${t}/trained_models/${n}/pipelines`,method:"GET"})},deleteTrainedModel:a=>e.http({path:`${t}/trained_models/${a}`,method:"DELETE"}),getTrainedModelsNodesOverview:()=>e.http({path:`${t}/trained_models/nodes_overview`,method:"GET"}),startModelAllocation:a=>e.http({path:`${t}/trained_models/${a}/deployment/_start`,method:"POST"}),stopModelAllocation(a,n={force:!1}){const i=null==n?void 0:n.force;return e.http({path:`${t}/trained_models/${a}/deployment/_stop`,method:"POST",query:{force:i}})}}}(e)),[e])}},185:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"c",(function(){return o}));var n=a(6);function i(e){return void 0!==e.classes}function r(e){return void 0!==e.importance}function s(e){return Object(n.b)(e,["classes"])&&Array.isArray(e.classes)}function o(e){return Object(n.b)(e,["baseline"])}},218:function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(2);function i(e,t){if(void 0===e||void 0===t)return{iconType:"empty",message:""};let a,i="alert",r=0,s=0;if(Array.isArray(e)){if(1!==e.length)return{iconType:"alert",message:n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusualValuesDescription",{defaultMessage:"Unusual values"})};r=e[0]}else r=e;if(Array.isArray(t)?1===t.length&&(s=t[0]):s=t,r===s)a=n.i18n.translate("xpack.ml.formatters.metricChangeDescription.actualSameAsTypicalDescription",{defaultMessage:"actual same as typical"});else{const e=r>s;if(i=e?"sortUp":"sortDown",0!==s&&0!==r){const t=e?r/s:s/r;a=t>1.5?t<=100?e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:Math.round(t)}}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndHalfxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:Math.round(t)}}):e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xHigherDescription",{defaultMessage:"More than 100x higher"}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThan100xLowerDescription",{defaultMessage:"More than 100x lower"}):t>=1.05?e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxHigherDescription",{defaultMessage:"{factor}x higher",values:{factor:t.toPrecision(2)}}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.moreThanOneAndFiveHundredthsxLowerDescription",{defaultMessage:"{factor}x lower",values:{factor:t.toPrecision(2)}}):e?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyHighDescription",{defaultMessage:"Unusually high"}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unusuallyLowDescription",{defaultMessage:"Unusually low"})}else a=0===r?n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedZeroValueDescription",{defaultMessage:"Unexpected zero value"}):n.i18n.translate("xpack.ml.formatters.metricChangeDescription.unexpectedNonZeroValueDescription",{defaultMessage:"Unexpected non-zero value"})}return{iconType:i,message:a}}},223:function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(74),i=a(224);const r=e=>{switch(e){case n.b.CLASSIFICATION:return i.a.NOMINAL;case n.b.REGRESSION:return i.a.QUANTITATIVE;default:return}}},224:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n={NOMINAL:"nominal",QUANTITATIVE:"quantitative"}},225:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n=5e3},287:function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return NewJobCapabilitiesServiceBase}));var n=a(5),i=a.n(n),r=a(47);function s(e){const t=e.filter((e=>e.type===r.ES_FIELD_TYPES.KEYWORD)).map((e=>e.id)),a=e.filter((e=>e.type===r.ES_FIELD_TYPES.TEXT)).map((e=>e.id));return{fieldsPreferringKeyword:e.filter((e=>e.type!==r.ES_FIELD_TYPES.TEXT||e.type===r.ES_FIELD_TYPES.TEXT&&!1===t.includes(`${e.id}.keyword`))),fieldsPreferringText:e.filter((e=>e.type!==r.ES_FIELD_TYPES.KEYWORD||e.type===r.ES_FIELD_TYPES.KEYWORD&&!1===a.includes(e.id.replace(/\.keyword$/,""))))}}class NewJobCapabilitiesServiceBase{constructor(){i()(this,"_fields",void 0),i()(this,"_aggs",void 0),this._fields=[],this._aggs=[]}get fields(){return this._fields}get aggs(){return this._aggs}get newJobCaps(){return{fields:this._fields,aggs:this._aggs}}getFieldById(e){const t=this._fields.find((t=>t.id===e));return void 0===t?null:t}getAggById(e){const t=this._aggs.find((t=>t.id===e));return void 0===t?null:t}}},416:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(417);case"v8light":return a(419)}},417:function(e,t,a){var n=a(78),i=a(418);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var r={insert:"head",singleton:!1};n(i,r);e.exports=i.locals||{}},418:function(e,t,a){(t=a(79)(!1)).push([e.i,".mlDataGridChart__histogram{width:100%;height:72px}.mlDataGridChart__legend{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-size:12px;font-size:.85714rem;line-height:1.14286rem;color:#535966;display:block;overflow-x:hidden;margin:4px 0 0 0;font-style:italic;font-weight:normal;text-align:left}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{width:100%;min-width:112px}.mlDataGridChart__legendBoolean td{text-align:center}\n",""]),e.exports=t},419:function(e,t,a){var n=a(78),i=a(420);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var r={insert:"head",singleton:!1};n(i,r);e.exports=i.locals||{}},420:function(e,t,a){(t=a(79)(!1)).push([e.i,".mlDataGridChart__histogram{width:100%;height:72px}.mlDataGridChart__legend{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;font-size:12px;font-size:.85714rem;line-height:1.14286rem;color:#98A2B3;display:block;overflow-x:hidden;margin:4px 0 0 0;font-style:italic;font-weight:normal;text-align:left}.mlDataGridChart__legend--numeric{text-align:right}.mlDataGridChart__legendBoolean{width:100%;min-width:112px}.mlDataGridChart__legendBoolean td{text-align:center}\n",""]),e.exports=t},421:function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(422);case"v8light":return a(424)}},422:function(e,t,a){var n=a(78),i=a(423);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var r={insert:"head",singleton:!1};n(i,r);e.exports=i.locals||{}},423:function(e,t,a){(t=a(79)(!1)).push([e.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__sortingArrow,.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__icon,.mlDataGrid .euiDataGridHeaderCell .euiPopover{margin-top:auto}\n",""]),e.exports=t},424:function(e,t,a){var n=a(78),i=a(425);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var r={insert:"head",singleton:!1};n(i,r);e.exports=i.locals||{}},425:function(e,t,a){(t=a(79)(!1)).push([e.i,".mlDataGrid .euiDataGridRowCell--boolean{text-transform:none}.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__sortingArrow,.mlDataGrid .euiDataGridHeaderCell .euiDataGridHeaderCell__icon,.mlDataGrid .euiDataGridHeaderCell .euiPopover{margin-top:auto}\n",""]),e.exports=t},74:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"f",(function(){return f})),a.d(t,"i",(function(){return m})),a.d(t,"k",(function(){return p})),a.d(t,"j",(function(){return b})),a.d(t,"e",(function(){return h})),a.d(t,"l",(function(){return g})),a.d(t,"n",(function(){return y})),a.d(t,"d",(function(){return _})),a.d(t,"t",(function(){return O})),a.d(t,"p",(function(){return j})),a.d(t,"q",(function(){return E})),a.d(t,"A",(function(){return v})),a.d(t,"z",(function(){return x})),a.d(t,"w",(function(){return S})),a.d(t,"g",(function(){return T})),a.d(t,"D",(function(){return D})),a.d(t,"E",(function(){return I})),a.d(t,"c",(function(){return C})),a.d(t,"u",(function(){return w})),a.d(t,"h",(function(){return P})),a.d(t,"C",(function(){return F})),a.d(t,"B",(function(){return N}));var n=a(16),i=a(25),r=a(28),s=a(8),o=a(73),c=a(27),l=a(106);a.d(t,"x",(function(){return l.g})),a.d(t,"y",(function(){return l.h})),a.d(t,"v",(function(){return l.f})),a.d(t,"s",(function(){return l.e})),a.d(t,"o",(function(){return l.c})),a.d(t,"r",(function(){return l.d}));var u=a(90);let d,f;a.d(t,"b",(function(){return u.a})),a.d(t,"m",(function(){return l.a})),function(e){e.ALPHA="alpha",e.ETA="eta",e.ETA_GROWTH_RATE_PER_TREE="eta_growth_rate_per_tree",e.DOWNSAMPLE_FACTOR="downsample_factor",e.FEATURE_BAG_FRACTION="feature_bag_fraction",e.FEATURE_INFLUENCE_THRESHOLD="feature_influence_threshold",e.GAMMA="gamma",e.LAMBDA="lambda",e.MAX_TREES="max_trees",e.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER="max_optimization_rounds_per_hyperparameter",e.METHOD="method",e.N_NEIGHBORS="n_neighbors",e.NUM_TOP_CLASSES="num_top_classes",e.NUM_TOP_FEATURE_IMPORTANCE_VALUES="num_top_feature_importance_values",e.OUTLIER_FRACTION="outlier_fraction",e.RANDOMIZE_SEED="randomize_seed",e.SOFT_TREE_DEPTH_LIMIT="soft_tree_depth_limit",e.SOFT_TREE_DEPTH_TOLERANCE="soft_tree_depth_tolerance"}(d||(d={})),function(e){e.LOF="lof",e.LDOF="ldof",e.DISTANCE_KTH_NN="distance_kth_nn",e.DISTANCE_KNN="distance_knn"}(f||(f={}));const m=1e3,p=1,b=100,h=0,g={match_all:{}},y=(e,t)=>({bool:{minimum_should_match:1,should:[{match:{[`${e}.is_training`]:t}}]}});let _;!function(e){e[e.UNUSED=0]="UNUSED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.ERROR=3]="ERROR"}(_||(_={}));const O=e=>{let t;return Object(l.h)(e)&&(t=e.regression.training_percent),Object(l.f)(e)&&(t=e.classification.training_percent),t},j=e=>{let t;return Object(l.f)(e)&&void 0!==e.classification.num_top_classes&&(t=e.classification.num_top_classes),t},E=e=>{let t;return Object(l.h)(e)&&void 0!==e.regression.num_top_feature_importance_values?t=e.regression.num_top_feature_importance_values:Object(l.f)(e)&&void 0!==e.classification.num_top_feature_importance_values&&(t=e.classification.num_top_feature_importance_values),t},v=e=>{if(void 0===e)return!1;const t=Object.keys(e);return 1===t.length&&"bool"===t[0]},x=e=>{var t,a;const n=Object.keys(e);return 1===n.length&&n[0]===u.a.REGRESSION&&void 0!==(null==e||null===(t=e.regression)||void 0===t?void 0:t.mse)&&void 0!==(null==e||null===(a=e.regression)||void 0===a?void 0:a.r_squared)},S=e=>{var t,a;const n=Object.keys(e);return 1===n.length&&n[0]===u.a.CLASSIFICATION&&(void 0!==(null==e||null===(t=e.classification)||void 0===t?void 0:t.multiclass_confusion_matrix)||void 0!==(null==e||null===(a=e.classification)||void 0===a?void 0:a.auc_roc))};let T;!function(e){e.ERROR="error",e.IDLE="idle",e.LOADING="loading",e.REFRESH="refresh"}(T||(T={}));const D=new i.BehaviorSubject(T.IDLE),I=(e={},t=!1)=>(Object(n.useEffect)((()=>{const a=D.pipe(Object(r.distinctUntilChanged)()),n=[];return"function"==typeof e.onRefresh&&(t&&e.onRefresh(),n.push(a.pipe(Object(r.filter)((e=>e===T.REFRESH))).subscribe((()=>{"function"==typeof e.onRefresh&&e.onRefresh()})))),"function"==typeof e.isLoading&&n.push(a.subscribe((t=>"function"==typeof e.isLoading&&e.isLoading(t===T.LOADING)))),()=>{n.map((e=>e.unsubscribe()))}}),[e.onRefresh]),{refresh:()=>{D.next(T.REFRESH),D.next(T.LOADING)}}),C="--";function w(e){const t={mse:C,msle:C,huber:C,r_squared:C};if(null!=e&&e.regression)for(const n in e.regression)if(e.regression.hasOwnProperty(n)){var a;let i=null===(a=e.regression[n])||void 0===a?void 0:a.value;i&&Number.isFinite(i)&&(i=Number(i.toPrecision(3))),t[n]=i}return t}function A({resultsField:e,isTraining:t,searchQuery:a,ignoreDefaultQuery:n}){let i;const r={term:{[`${e}.is_training`]:{value:t}}},o=Object(s.cloneDeep)(a);return v(o)?(void 0===o.bool.must&&(o.bool.must=[]),void 0!==t&&o.bool.must.push(r),i=o):(e=>{if(void 0===e)return!1;const t=Object.keys(e);return 1===t.length&&"query_string"===t[0]})(o)?(i={bool:{must:[o]}},void 0!==t&&i.bool.must.push(r)):i={bool:{must:void 0!==t?[r]:[]}},i}let P;!function(e){e.MSE="mse",e.MSLE="msle",e.R_SQUARED="rSquared",e.HUBER="huber"}(P||(P={}));const F=async({isTraining:e,index:t,dependentVariable:a,resultsField:n,predictionFieldName:i,searchQuery:r,ignoreDefaultQuery:s,jobType:l,requiresKeyword:d,rocCurveClassName:f,includeMulticlassConfusionMatrix:m=!0})=>{const p={success:!1,eval:null,error:null};let b=`${n}.${i||`${a}_prediction`}`;l===u.a.CLASSIFICATION&&!0===d&&(b=`${b}.keyword`);const h={classification:{accuracy:{},recall:{},...m?{multiclass_confusion_matrix:{}}:{},...void 0!==f?{auc_roc:{include_curve:!0,class_name:f}}:{}},regression:{r_squared:{},mse:{},msle:{},huber:{}}},g={index:t,query:A({resultsField:n,isTraining:e,searchQuery:r,ignoreDefaultQuery:s}),evaluation:{[l]:{actual_field:a,predicted_field:b,...l===u.a.CLASSIFICATION?{top_classes_field:`${n}.top_classes`}:{},metrics:h[l]}}};try{const e=await o.ml.dataFrameAnalytics.evaluateDataFrameAnalytics(g);return p.success=!0,p.eval=e,p}catch(e){return p.error=Object(c.b)(e),p}},N=async({ignoreDefaultQuery:e=!0,isTraining:t,searchQuery:a,resultsField:n,destIndex:i})=>{const r=A({resultsField:n,isTraining:t,ignoreDefaultQuery:e,searchQuery:a});try{const e={track_total_hits:!0,query:r},t=await o.ml.esSearch({index:i,size:0,body:e}),a=t.hits.total&&t.hits.total.value;return{docsCount:a,success:void 0!==a}}catch(e){return{docsCount:null,success:!1}}}},81:function(e,t,a){"use strict";a.d(t,"h",(function(){return n.m})),a.d(t,"k",(function(){return n.o})),a.d(t,"o",(function(){return n.s})),a.d(t,"j",(function(){return n.n})),a.d(t,"r",(function(){return n.x})),a.d(t,"u",(function(){return n.D})),a.d(t,"w",(function(){return n.E})),a.d(t,"e",(function(){return n.g})),a.d(t,"d",(function(){return n.f})),a.d(t,"q",(function(){return n.u})),a.d(t,"t",(function(){return n.C})),a.d(t,"s",(function(){return n.B})),a.d(t,"n",(function(){return n.r})),a.d(t,"b",(function(){return n.d})),a.d(t,"f",(function(){return n.i})),a.d(t,"g",(function(){return n.l})),a.d(t,"a",(function(){return n.b})),a.d(t,"i",(function(){return i.f})),a.d(t,"v",(function(){return i.h})),a.d(t,"c",(function(){return i.c})),a.d(t,"l",(function(){return c})),a.d(t,"m",(function(){return u})),a.d(t,"p",(function(){return d.a})),a.d(t,"x",(function(){return O}));var n=a(74),i=a(112),r=a(27),s=a(123),o=a(73);const c=async(e,t,a,c)=>{if(void 0!==e){const{pagination:l,setErrorMessage:u,setRowCount:d,setRowCountRelation:f,setStatus:m,setTableItems:p,sortingColumns:b}=t;u(""),m(n.d.LOADING);try{const t=b.map((e=>{const{id:t}=e;return e.id=Object(i.g)(t)?`${t}.keyword`:t,e})).reduce(((e,t)=>(e[t.id]={order:t.direction},e)),{}),{pageIndex:r,pageSize:u}=l,h=await o.ml.esSearch({index:e.dest.index,body:{fields:["*"],_source:!1,query:a,from:r*u,size:u,...Object.keys(t).length>0?{sort:t}:{}}});c.didCancel||(d("number"==typeof h.hits.total?h.hits.total:h.hits.total.value),f("number"==typeof h.hits.total?"eq":h.hits.total.relation),p(h.hits.hits.map((t=>{var a;return Object(s.i)(null!==(a=t.fields)&&void 0!==a?a:{},(t=>t.startsWith(`${e.dest.results_field}.feature_importance`)))}))),m(n.d.LOADED))}catch(e){u(Object(r.b)(e)),m(n.d.ERROR)}}};var l=a(142);const u=(e,t)=>{const{fields:a}=l.a;if(void 0!==e){const{selectedFields:n,docFields:r}=Object(i.f)(a,e,t),s={},o=[];return r.forEach((e=>{s[e.id]=e.type,o.push(e.id)})),{defaultSelectedFields:n.map((e=>e.id)),fieldTypes:s,tableFields:o}}return{defaultSelectedFields:[],fieldTypes:{},tableFields:[]}};var d=a(223),f=a(16),m=a(2),p=a(96),b=a(102),h=a(166),g=a(184),y=a(77),_=a(106);const O=e=>{const t=Object(b.b)(),a=Object(g.a)(),[n,i]=Object(f.useState)(void 0),[s,c]=Object(f.useState)(void 0),[u,d]=Object(f.useState)(!1),[O,j]=Object(f.useState)(!1),[E,v]=Object(f.useState)(!1),[x,S]=Object(f.useState)(void 0),[T,D]=Object(f.useState)(void 0),[I,C]=Object(f.useState)(void 0),[w,A]=Object(f.useState)(void 0),[P,F]=Object(f.useState)(void 0);return Object(f.useEffect)((()=>{!async function(){v(!1);try{const b=await o.ml.dataFrameAnalytics.getDataFrameAnalytics(e),g=await o.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(e),O=Object(h.b)(g)?g.data_frame_analytics[0]:void 0;if(void 0!==O&&O.state&&A(O.state),Array.isArray(b.data_frame_analytics)&&b.data_frame_analytics.length>0){const o=b.data_frame_analytics[0];if(Object(_.f)(o.analysis)||Object(_.h)(o.analysis))try{var n;const t=(await a.getTrainedModels(`${e}*`,{include:"total_feature_importance"})).find((t=>{var a,n;return(null===(a=t.metadata)||void 0===a||null===(n=a.analytics_config)||void 0===n?void 0:n.id)===e}));var s;if(!0===Array.isArray(null==t||null===(n=t.metadata)||void 0===n?void 0:n.total_feature_importance))F(null==t||null===(s=t.metadata)||void 0===s?void 0:s.total_feature_importance)}catch(e){Object(y.a)().displayErrorToast(e)}try{var u;const e=Array.isArray(o.dest.index)?o.dest.index[0]:o.dest.index,a=null!==(u=await Object(p.d)(e))&&void 0!==u?u:e;let n;try{n=await t.dataViewsContract.get(a),await t.dataViewsContract.refreshFields(n)}catch(e){n=void 0}if(void 0===n){var f;j(!0);const e=o.source.index[0],a=null!==(f=await Object(p.d)(e))&&void 0!==f?f:e;try{n=await t.dataViewsContract.get(a)}catch(e){n=void 0}}void 0!==n?(await l.a.initializeFromDataVIew(n),S(b.data_frame_analytics[0]),i(n),d(!0),v(!1)):c(m.i18n.translate("xpack.ml.dataframe.analytics.results.dataViewMissingErrorMessage",{defaultMessage:"To view this page, a Kibana data view is necessary for either the destination or source index of this analytics job."}))}catch(e){D(Object(r.b)(e)),v(!1)}}}catch(e){C(Object(r.b)(e)),v(!1)}}()}),[]),{indexPattern:n,indexPatternErrorMessage:s,isInitialized:u,isLoadingJobConfig:E,jobCapsServiceErrorMessage:T,jobConfig:x,jobConfigErrorMessage:I,jobStatus:w,needsDestIndexPattern:O,totalFeatureImportance:P}}},90:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return r})),a.d(t,"e",(function(){return s})),a.d(t,"b",(function(){return o}));const n={OUTLIER_DETECTION:"outlier_detection",REGRESSION:"regression",CLASSIFICATION:"classification"},i={ANALYZING:"analyzing",FAILED:"failed",REINDEXING:"reindexing",STARTED:"started",STARTING:"starting",STOPPED:"stopped"},r="ml",s={ANALYTICS:"analytics",TRANSFORM:"transform",INDEX:"index",TRAINED_MODEL:"trainedModel"},o="prepackaged"},96:function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"h",(function(){return c})),a.d(t,"e",(function(){return l})),a.d(t,"d",(function(){return u})),a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return f})),a.d(t,"f",(function(){return m})),a.d(t,"i",(function(){return p})),a.d(t,"g",(function(){return b}));var n=a(2),i=a(26);let r=[],s=null;async function o(e){s=e}function c(){return Object(i.i)().find({type:"search",perPage:1e4}).then((e=>(r=e.savedObjects,r)))}async function l(){if(null===s)throw new Error("Data views are not initialized!");return(await s.getIdsWithTitle()).map((({title:e})=>e))}async function u(e){var t;if(null===s)throw new Error("Data views are not initialized!");const a=(await s.find(e)).find((({title:t})=>t===e));return a?null!==(t=a.id)&&void 0!==t?t:a.title:null}function d(e){if(null===s)throw new Error("Data views are not initialized!");return e?s.get(e):s.create({})}async function f(e){var t;const a={savedSearch:null,dataView:null};if(void 0===e)return a;const n=await async function(e){const t=Object(i.i)(),a=await t.get("search",e);return void 0===a.error?a:null}(e);if(null===n)return a;const r=null===(t=n.references.find((e=>"index-pattern"===e.type)))||void 0===t?void 0:t.id;return a.dataView=await d(r),a.savedSearch=n,a}function m(e){const t=e.attributes.kibanaSavedObjectMeta;return JSON.parse(t.searchSourceJSON)}function p(e,t=!1){if(e.isTimeBased())return!0;if(t){Object(i.l)().addWarning({title:n.i18n.translate("xpack.ml.dataViewNotBasedOnTimeSeriesNotificationTitle",{defaultMessage:"The data view {dataViewName} is not based on a time series",values:{dataViewName:e.title}}),text:n.i18n.translate("xpack.ml.dataViewNotBasedOnTimeSeriesNotificationDescription",{defaultMessage:"Anomaly detection only runs over time-based indices"})})}return!1}function b(e){return e.includes(":")}},97:function(e,t,a){"use strict";a.d(t,"b",(function(){return h})),a.d(t,"a",(function(){return g})),a.d(t,"d",(function(){return y})),a.d(t,"e",(function(){return _})),a.d(t,"k",(function(){return O})),a.d(t,"f",(function(){return j})),a.d(t,"i",(function(){return E})),a.d(t,"c",(function(){return v})),a.d(t,"g",(function(){return x})),a.d(t,"h",(function(){return S})),a.d(t,"j",(function(){return D})),a.d(t,"n",(function(){return I})),a.d(t,"q",(function(){return C})),a.d(t,"l",(function(){return w})),a.d(t,"o",(function(){return A})),a.d(t,"p",(function(){return P})),a.d(t,"m",(function(){return F}));var n=a(54),i=a.n(n),r=a(16),s=a(2),o=a(47),c=a(90),l=a(27),u=a(112),d=a(152),f=a(82),m=a(220),p=a(136),b=a(20);const h=10,g=1e4,y={border:"all",fontSize:"s",cellPadding:"s",stripes:!1,rowHover:"none",header:"shade"},_={showColumnSelector:!0,showDisplaySelector:!1,showSortSelector:!0,showFullScreenSelector:!1},O=e=>{const t=e.fields.map((e=>e.name));return t.filter((a=>{if(e.metaFields.includes(a))return!1;const n=a.split(".");return"keyword"!==n.pop()||!t.includes(n.join("."))}))};function j(e,t){let a={};if(e){const t=null==e?void 0:e.getComputedFields();if(void 0!==(null==t?void 0:t.runtimeFields)){const e=t.runtimeFields;Object(b.b)(e)&&(a={...a,...e})}}if(Object(b.b)(t)&&(a={...a,...t}),Object(b.b)(a))return a}const E=(e,t)=>Object.keys(e).map((a=>{let n;const i=e[a];switch(void 0!==i&&(u.a.has(i)||u.b.has(i))&&(n="numeric"),i){case"date":n="datetime";break;case"nested":case"geo_point":n="json";break;case"boolean":n="boolean";break;case"text":n=v}return a===`${t}.${d.c}`&&(n="numeric"),a.includes(`${t}.${d.d}`)&&(n="json"),a.includes(`${t}.${d.a}`)&&(n="featureImportance"),a===`${t}.${d.b}`&&(n="featureInfluence"),{id:a,schema:n,isSortable:!0}})),v="non-aggregatable",x=e=>{let t;switch(e){case o.ES_FIELD_TYPES.GEO_POINT:case o.ES_FIELD_TYPES.GEO_SHAPE:t="json";break;case o.ES_FIELD_TYPES.BOOLEAN:t="boolean";break;case o.ES_FIELD_TYPES.DATE:case o.ES_FIELD_TYPES.DATE_NANOS:t="datetime";break;case o.ES_FIELD_TYPES.BYTE:case o.ES_FIELD_TYPES.DOUBLE:case o.ES_FIELD_TYPES.FLOAT:case o.ES_FIELD_TYPES.HALF_FLOAT:case o.ES_FIELD_TYPES.INTEGER:case o.ES_FIELD_TYPES.LONG:case o.ES_FIELD_TYPES.SCALED_FLOAT:case o.ES_FIELD_TYPES.SHORT:case"number":t="numeric";break;case o.ES_FIELD_TYPES.KEYWORD:case o.ES_FIELD_TYPES.TEXT:}return t},S=e=>{let t;switch(null==e?void 0:e.type){case o.KBN_FIELD_TYPES.BOOLEAN:t="boolean";break;case o.KBN_FIELD_TYPES.DATE:t="datetime";break;case o.KBN_FIELD_TYPES.GEO_POINT:case o.KBN_FIELD_TYPES.GEO_SHAPE:t="json";break;case o.KBN_FIELD_TYPES.NUMBER:t="numeric";break;case o.KBN_FIELD_TYPES.NESTED:t="json"}return void 0===t&&!1===(null==e?void 0:e.aggregatable)?v:t},T=(e,t)=>t?"true"===e:e,D=(e,t,a=!1)=>{const n=e[`${t}.feature_importance`];return void 0===n?[]:n.map((e=>({feature_name:Array.isArray(e.feature_name)?e.feature_name[0]:e.feature_name,classes:Array.isArray(e.classes)?e.classes.map((e=>{const t=F(e);return{importance:t.importance,class_name:T(t.class_name,a)}})):e.classes,importance:Array.isArray(e.importance)?e.importance[0]:e.importance})))},I=(e,t)=>{const a=e[`${t}.top_classes`];return void 0===a?[]:a.map((e=>F(e)))},C=(e,t,a,n,s)=>Object(r.useMemo)((()=>({rowIndex:l,columnId:u,setCellProps:d})=>{const b=l-t.pageIndex*t.pageSize,h=a[b];if(void 0===h)return null;if(void 0===e)return null;let g;void 0!==e&&(g=p.a.getFieldFormatFromIndexPattern(e,u,""));const y=function(e){if(a.hasOwnProperty(b)){const t=a[b];return t.hasOwnProperty(e)?t[e]:e===`${n}.feature_importance`?D(h,null!=n?n:c.d):e===`${n}.top_classes`?I(h,null!=n?n:c.d):Object(m.a)(a[b],e,null)}return null}(u);if(Object(r.useEffect)((()=>{"function"==typeof s&&s(u,y,h,d)}),[u,y]),"object"==typeof y&&null!==y)return JSON.stringify(y);if(null==y)return null;if(void 0!==g)return g.convert(y,"text");if("string"==typeof y||null===y)return y;const _=e.fields.getByName(u);return(null==_?void 0:_.type)===o.KBN_FIELD_TYPES.DATE?Object(f.c)(1e3*i()(y).unix()):"boolean"==typeof y?y?"true":"false":y}),[null==e?void 0:e.fields,t.pageIndex,t.pageSize,a]),w=(e,t)=>{var a;return null!==(a=Object(m.a)(e,t,null))&&void 0!==a?a:e[t]},A=e=>{const t=(a,n,i=0)=>{const r=e[i];let s=w(a,r.id),o=w(n,r.id);if("number"===r.type){var c,l;if(s=null!==(c=s)&&void 0!==c?c:0,o=null!==(l=o)&&void 0!==l?l:0,s<o)return"asc"===r.direction?-1:1;if(s>o)return"asc"===r.direction?1:-1}if("string"===r.type){var u,d;if(s=null!==(u=s)&&void 0!==u?u:"",o=null!==(d=o)&&void 0!==d?d:"",-1===s.localeCompare(o))return"asc"===r.direction?-1:1;if(1===s.localeCompare(o))return"asc"===r.direction?1:-1}return i+1<e.length?t(a,n,i+1):0};return t},P=(e,t)=>{const a=Object(l.b)(e);t.addDanger(s.i18n.translate("xpack.ml.dataGrid.columnChart.ErrorMessageToast",{defaultMessage:"An error occurred fetching the histogram charts data: {error}",values:{error:""!==a?a:e}}))},F=(e,t)=>{const a={...e};for(const e of Object.keys(a))void 0===t?Array.isArray(a[e])&&1===a[e].length&&(a[e]=a[e][0]):!1===t(e)&&Array.isArray(a[e])&&1===a[e].length&&(a[e]=a[e][0]);return a}}}]);