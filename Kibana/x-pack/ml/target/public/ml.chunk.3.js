/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.ml_bundle_jsonpfunction=window.ml_bundle_jsonpfunction||[]).push([[3,19,20,22],Array(76).concat([function(e,t,a){"use strict";a.d(t,"d",(function(){return d})),a.d(t,"c",(function(){return u})),a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return m})),a.d(t,"e",(function(){return b})),a.d(t,"f",(function(){return f}));var n=a(2),i=a(101),s=a(34),r=a(73),o=a(291);function l(){return new Promise(((e,t)=>{r.ml.checkMlCapabilities().then((t=>{!0===t.upgradeInProgress&&Object(o.b)(!0),e(t)})).catch((()=>{t()}))}))}let c=Object(s.d)();function d(){return new Promise(((e,t)=>{new Promise(((e,t)=>{r.ml.checkManageMLCapabilities().then((t=>{!0===t.upgradeInProgress&&Object(o.b)(!0),e(t)})).catch((()=>{t()}))})).then((({capabilities:a,isPlatinumOrTrialLicense:n,mlFeatureEnabledInSpace:i})=>{c=a;return!0===Object.values(c).every((e=>!0===e))&&!0===n?e({mlFeatureEnabledInSpace:i}):t({capabilities:a,isPlatinumOrTrialLicense:n,mlFeatureEnabledInSpace:i})})).catch((e=>t()))}))}function u(e){return new Promise(((t,a)=>{l().then((async({capabilities:n,isPlatinumOrTrialLicense:i})=>(c=n,c.canGetJobs||!1===i?t(c):(await e(),a())))).catch((async t=>(await e(),a())))}))}function p(e){return new Promise(((t,a)=>{l().then((async({capabilities:n,isPlatinumOrTrialLicense:i})=>(c=n,c.canCreateJob||!1===i?t(c):(await e(),a())))).catch((async t=>(await e(),a())))}))}function m(e){return new Promise(((t,a)=>{l().then((async({capabilities:n})=>(c=n,c.canFindFileStructure?t(c):(await e(),a())))).catch((async t=>(await e(),a())))}))}function b(e){const t=Object(i.c)();return!0===c[e]&&!0!==t}function f(e){let t="";return Object(i.c)()?t=n.i18n.translate("xpack.ml.privilege.licenseHasExpiredTooltip",{defaultMessage:"Your license has expired."}):"canCreateJob"===e?t=n.i18n.translate("xpack.ml.privilege.noPermission.createMLJobsTooltip",{defaultMessage:"You do not have permission to create Machine Learning jobs."}):"canStartStopDatafeed"===e?t=n.i18n.translate("xpack.ml.privilege.noPermission.startOrStopDatafeedsTooltip",{defaultMessage:"You do not have permission to start or stop datafeeds."}):"canUpdateJob"===e?t=n.i18n.translate("xpack.ml.privilege.noPermission.editJobsTooltip",{defaultMessage:"You do not have permission to edit jobs."}):"canDeleteJob"===e?t=n.i18n.translate("xpack.ml.privilege.noPermission.deleteJobsTooltip",{defaultMessage:"You do not have permission to delete jobs."}):"canCreateCalendar"===e?t=n.i18n.translate("xpack.ml.privilege.noPermission.createCalendarsTooltip",{defaultMessage:"You do not have permission to create calendars."}):"canDeleteCalendar"===e?t=n.i18n.translate("xpack.ml.privilege.noPermission.deleteCalendarsTooltip",{defaultMessage:"You do not have permission to delete calendars."}):"canForecastJob"===e&&(t=n.i18n.translate("xpack.ml.privilege.noPermission.runForecastsTooltip",{defaultMessage:"You do not have permission to run forecasts."})),n.i18n.translate("xpack.ml.privilege.pleaseContactAdministratorTooltip",{defaultMessage:"{message} Please contact your administrator.",values:{message:t}})}},,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return m}));var n=a(16),i=a.n(n),s=a(49),r=a(44),o=a(102),l=a(89),c=a(290),d=a(12);const u=({context:e,children:t})=>null===e?Object(d.jsx)(r.EuiLoadingContent,{lines:10}):Object(d.jsx)(o.a.Provider,{value:e},t),p=({children:e})=>{const t=Object(s.useHistory)(),a=Object(s.useLocation)();return Object(n.useEffect)((()=>{a.hash.startsWith("#/")&&t.push(a.hash.replace("#",""))}),[a.hash]),Object(d.jsx)(i.a.Fragment,null,e)},m=({pageDeps:e})=>Object(d.jsx)(s.Router,{history:e.history},Object(d.jsx)(p,null,Object(d.jsx)(l.a,null,Object(d.jsx)(c.a,{pageDeps:e}))))},,function(e,t,a){var n;try{n={cloneDeep:a(539),constant:a(314),defaults:a(540),each:a(315),filter:a(319),find:a(541),flatten:a(545),forEach:a(316),forIn:a(546),has:a(329),isUndefined:a(332),last:a(547),map:a(333),mapValues:a(548),max:a(549),merge:a(551),min:a(563),minBy:a(564),now:a(565),pick:a(567),range:a(572),reduce:a(335),sortBy:a(573),uniqueId:a(579),values:a(340),zipObject:a(581)}}catch(e){}n||(n=window._),e.exports=n},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(16),i=a(307),s=a(214),r=a(12);const o=({children:e})=>{const{setPageTitle:t}=Object(n.useContext)(s.b),a=Object(n.useMemo)((()=>Object(i.c)()),[]);return Object(n.useEffect)((()=>(t(e),()=>{a.unmount(),t(void 0)})),[a,t]),Object(r.jsx)(i.a,{node:a},e)}},function(e,t,a){"use strict";a.d(t,"f",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return c})),a.d(t,"e",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return p}));var n=a(73);let i={anomaly_detectors:{},datafeeds:{}},s={};const r={cloudId:null,isCloud:!1,deploymentId:null};async function o(){try{const e=await n.ml.mlInfo();return i=e.defaults,s=e.limits,r.cloudId=e.cloudId||null,r.isCloud=void 0!==e.cloudId,r.deploymentId=e.cloudId?p(e.cloudId):null,{defaults:i,limits:s,cloudId:r}}catch(e){return{defaults:i,limits:s,cloudId:r}}}function l(){return i}function c(){return s}function d(){return r.isCloud}function u(){return r.deploymentId}function p(e){const t=e.replace(/^(.+)?:/,"");try{const e=atob(t).match(/^.+\$(.+)(?=\$)/);return null!==e&&2===e.length?e[1]:null}catch(e){return null}}},function(e,t,a){"use strict";a.d(t,"j",(function(){return u})),a.d(t,"g",(function(){return p})),a.d(t,"h",(function(){return m})),a.d(t,"f",(function(){return b})),a.d(t,"k",(function(){return h})),a.d(t,"e",(function(){return j})),a.d(t,"d",(function(){return x})),a.d(t,"l",(function(){return v})),a.d(t,"m",(function(){return y})),a.d(t,"a",(function(){return O})),a.d(t,"b",(function(){return E})),a.d(t,"i",(function(){return w})),a.d(t,"c",(function(){return M}));var n=a(2),i=a(99),s=a(94),r=a(128),o=a(47),l=a(120),c=a(83),d=a(84);function u(e,t,a,n=!1){const o=n?function(e,t){return f(e.analysis_config.detectors)}(e):function(e,t){let a=e.analysis_config.detectors;const n=h(e,t);if(void 0!==t.aggregations&&e.analysis_config.detectors[0].function===s.b.NON_ZERO_COUNT&&!1===n){var i,r,o,c,d;const e=null==t||null===(i=t.aggregations)||void 0===i||null===(r=i.buckets)||void 0===r||null===(o=r.aggregations)||void 0===o||null===(c=o.dc_region)||void 0===c||null===(d=c.cardinality)||void 0===d?void 0:d.field;void 0!==e&&(a=[{function:s.b.DISTINCT_COUNT,field_name:e}])}else a=f(a),a=a.map((e=>{switch(e.function){case s.b.NON_ZERO_COUNT:return{...e,field_name:l.a,function:s.b.COUNT};case s.b.HIGH_NON_ZERO_COUNT:return{...e,field_name:l.a,function:s.b.HIGH_COUNT};case s.b.LOW_NON_ZERO_COUNT:return{...e,field_name:l.a,function:s.b.LOW_COUNT};case s.b.NON_NULL_SUM:return{...e,function:s.b.SUM};case s.b.HIGH_NON_NULL_SUM:return{...e,function:s.b.HIGH_SUM};case s.b.LOW_NON_NULL_SUM:return{...e,function:s.b.LOW_SUM};default:return e}}));return a}(e,t),c=(e=>t=>{let a=i.b.getFieldById(t);return null===a&&(t===r.b?a=l.c:e.length&&(a=e.find((e=>e.id===t))||null)),a})(a);return o.map((e=>{var t,a,n;let s=null,r=null,o=null,l=null;return void 0!==e.field_name&&(s=c(e.field_name)),void 0!==e.by_field_name&&(r=c(e.by_field_name)),void 0!==e.over_field_name&&(o=c(e.over_field_name)),void 0!==e.partition_field_name&&(l=c(e.partition_field_name)),{agg:i.b.getAggById(e.function),field:s,byField:r,overField:o,partitionField:l,excludeFrequent:null!==(t=e.exclude_frequent)&&void 0!==t?t:null,description:null!==(a=e.detector_description)&&void 0!==a?a:null,useNull:null!==(n=e.use_null)&&void 0!==n?n:null}}))}function p(e,t){return[...e.filter((e=>e.id!==l.a)).map((e=>({label:e.name}))),...t.filter((t=>!1===e.some((e=>e.id===t.id)))).map((e=>({label:e.id})))].sort(((e,t)=>e.label.localeCompare(t.label)))}function m(e){return null===e?[]:[{label:r.b}]}function b(e){return e?[{label:r.a}]:[{label:r.d}]}function f(e){return e.map((e=>{switch(e.function){case s.b.COUNT:case s.b.HIGH_COUNT:case s.b.LOW_COUNT:case s.b.NON_ZERO_COUNT:case s.b.HIGH_NON_ZERO_COUNT:case s.b.LOW_NON_ZERO_COUNT:case s.b.RARE:case s.b.FREQ_RARE:case s.b.TIME_OF_DAY:case s.b.TIME_OF_WEEK:return{...e,field_name:l.a};default:return e}}))}function h(e,t){var a,n,i,r,o;const l=e.analysis_config.detectors;if(void 0===(null==t||null===(a=t.aggregations)||void 0===a||null===(n=a.buckets)||void 0===n||null===(i=n.aggregations)||void 0===i||null===(r=i.dc_region)||void 0===r||null===(o=r.cardinality)||void 0===o?void 0:o.field))for(const e of l)if(s.c.includes(e.function))return!0;return!1}function g(e,t=!1,a=!1){var n;c.a.tempJobCloningObjects.job=e.jobConfig,c.a.tempJobCloningObjects.datafeed=e.datafeedConfig,c.a.tempJobCloningObjects.createdBy=null!==(n=e.createdBy)&&void 0!==n?n:void 0,c.a.tempJobCloningObjects.skipTimeRangeStep=t,!0===a&&(c.a.tempJobCloningObjects.start=e.start,c.a.tempJobCloningObjects.end=e.end),c.a.tempJobCloningObjects.calendars=e.calendars}function j(e,t){e.createdBy=d.a.MULTI_METRIC,e.modelPlot=!1,g(e,!0,!0),t(`jobs/new_job/${d.f.MULTI_METRIC}`,!0)}function x(e,t){e.createdBy=null,g(e,!0,!0),t(`jobs/new_job/${d.f.ADVANCED}`,!0)}function v(e,t){e.createdBy=null,g(e,!0,!1),t("/jobs/new_job")}function y(e,t){e.jobId="",g(e,!0,!0),t("/jobs/new_job")}function O(e,t){null!==e&&g(e,!1,!1),t("/jobs")}function E(e){return!1===e.some((e=>null===e.agg.dslName))}function w(e){switch(e.type){case d.f.SINGLE_METRIC:return n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.singleMetric",{defaultMessage:"Single metric"});case d.f.MULTI_METRIC:return n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.multiMetric",{defaultMessage:"Multi-metric"});case d.f.POPULATION:return n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.population",{defaultMessage:"Population"});case d.f.ADVANCED:return n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.advanced",{defaultMessage:"Advanced"});case d.f.CATEGORIZATION:return n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.categorization",{defaultMessage:"Categorization"});case d.f.RARE:return n.i18n.translate("xpack.ml.newJob.wizard.jobCreatorTitle.rare",{defaultMessage:"Rare"});default:return""}}function M(e,t){for(const a in e)null!==e[a]&&"object"==typeof e[a]&&("aggregations"!==a&&"aggs"!==a||Object.keys(e[a]).forEach((e=>{"aggregations"!==e&&"aggs"!==e&&t.push({id:e,name:e,type:o.ES_FIELD_TYPES.KEYWORD,aggregatable:!0})})),M(e[a],t))}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"e",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"d",(function(){return u})),a.d(t,"f",(function(){return p}));var n=a(73);let i=0,s=0,r=!1;async function o(e){try{const{count:e,lazyNodeCount:t}=await l();if(!(e>0||t>0))throw Error("Cannot load count of ML nodes");Promise.resolve()}catch(t){console.error(t),await e(),Promise.reject()}}async function l(){try{const e=await n.ml.mlNodeCount();return i=e.count,s=e.lazyNodeCount,r=!0,e}catch(e){return i=0,403===e.statusCode&&(r=!1),{count:0,lazyNodeCount:0}}}function c(){return 0!==i||0!==s}function d(){return 0!==i}function u(){return 0!==s}function p(){return r}},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return u}));var n=a(5),i=a.n(n),s=a(120),r=a(47),o=a(73),l=a(287);const c=[r.ES_FIELD_TYPES.TEXT,r.ES_FIELD_TYPES.KEYWORD,r.ES_FIELD_TYPES.IP];class NewJobCapsService extends l.a{constructor(...e){super(...e),i()(this,"_catFields",[]),i()(this,"_dateFields",[]),i()(this,"_includeEventRateField",!0),i()(this,"_removeTextFields",!0)}get catFields(){return this._catFields}get dateFields(){return this._dateFields}get categoryFields(){return d(this._fields)}async initializeFromDataVIew(e,t=!0,a=!0){try{this._includeEventRateField=t,this._removeTextFields=a;const n=await o.ml.jobs.newJobCaps(e.title,"rollup"===e.type),{fields:i,aggs:c}=function(e,t){const a=e[t],n=[],i=[],s={},r={};void 0!==a&&(a.aggs.forEach((e=>{const t={...e,...void 0!==e.fieldIds?{fields:[]}:{}};s[t.id]=t,i.push(t)})),a.fields.forEach((e=>{const t={...e,aggs:[]};void 0!==t.aggIds&&(r[t.id]=t.aggIds),n.push(t)})),n.forEach((e=>{r[e.id].forEach((t=>{!function(e,t){void 0===t.fields&&(t.fields=[]);void 0===e.aggs&&(e.aggs=[]);t.fields.push(e),e.aggs.push(t)}(e,s[t])}))})));return n.forEach((e=>delete e.aggIds)),i.forEach((e=>delete e.fieldIds)),{fields:n,aggs:i}}(n,e.title);!0===this._includeEventRateField&&function(e,t){const a={id:s.a,name:"Event rate",type:r.ES_FIELD_TYPES.INTEGER,aggregatable:!0,aggs:[]};e.forEach((e=>{void 0!==a.aggs&&void 0===e.fields&&(e.fields=[a],a.aggs.push(e))})),t.splice(0,0,a)}(c,i);const{fieldsPreferringKeyword:d,fieldsPreferringText:u}=Object(l.b)(i),p=u.filter((e=>e.type===r.ES_FIELD_TYPES.KEYWORD||e.type===r.ES_FIELD_TYPES.TEXT)),m=u.filter((e=>e.type===r.ES_FIELD_TYPES.DATE)),b=this._removeTextFields?d:i;this._fields=b,this._catFields=p,this._dateFields=m,this._aggs=c}catch(e){console.error("Unable to load new job capabilities",e)}}}function d(e){return e.filter((e=>c.includes(e.type)))}const u=new NewJobCapsService},function(e,t,a){"use strict";a.d(t,"f",(function(){return F})),a.d(t,"c",(function(){return I})),a.d(t,"d",(function(){return D})),a.d(t,"a",(function(){return A})),a.d(t,"b",(function(){return L})),a.d(t,"e",(function(){return R})),a.d(t,"g",(function(){return N}));var n=a(5),i=a.n(n),s=a(25),r=a(8),o=a(94),l=a(47),c=a(192),d=a(146),u=a(83),p=a(73),m=a(18);const b=250;class job_runner_JobRunner{constructor(e){i()(this,"_jobId",void 0),i()(this,"_datafeedId",void 0),i()(this,"_start",0),i()(this,"_end",0),i()(this,"_datafeedState",m.a.STOPPED),i()(this,"_refreshInterval",b),i()(this,"_progress$",void 0),i()(this,"_percentageComplete",0),i()(this,"_stopRefreshPoll",void 0),i()(this,"_subscribers",void 0),i()(this,"_datafeedStartTime",0),i()(this,"_performRefreshRateAdjustment",!1),i()(this,"_jobAssignedToNode",!1),i()(this,"_jobAssignedToNode$",void 0),this._jobId=e.jobId,this._datafeedId=e.datafeedId,this._start=e.start,this._end=e.end,this._percentageComplete=0,this._stopRefreshPoll=e.stopAllRefreshPolls,this._progress$=new s.BehaviorSubject(this._percentageComplete),this._jobAssignedToNode$=new s.BehaviorSubject(this._jobAssignedToNode),this._subscribers=e.subscribers}get datafeedState(){return this._datafeedState}set refreshInterval(e){this._refreshInterval=e}resetInterval(){this._refreshInterval=b}async openJob(){try{const{node:e}=await u.a.openJob(this._jobId);this._jobAssignedToNode=void 0!==e&&e.length>0,this._jobAssignedToNode$.next(this._jobAssignedToNode)}catch(e){throw e}}async _startDatafeed(e,t,a){try{this._datafeedStartTime=Date.now();const n=!0===a?this._subscribers.map((e=>this._progress$.subscribe(e))):[];await this.openJob();const{started:i}=await u.a.startDatafeed(this._datafeedId,this._jobId,e,t);this._datafeedState=m.a.STARTED,this._percentageComplete=0;const s=async()=>{const{isRunning:e,progress:t,isJobClosed:a}=await this.getProgress(),i=100!==t||!0!==e&&!1!==a?t:t-1;this._adjustRefreshInterval(i),this._percentageComplete=i,this._progress$.next(this._percentageComplete),!0!==e&&!1!==a||!1!==this._stopRefreshPoll.stop?(this._progress$.next(100),n.forEach((e=>e.unsubscribe()))):setTimeout((async()=>{!1===this._stopRefreshPoll.stop&&await s()}),this._refreshInterval)},r=async()=>{this._jobAssignedToNode=await this._isJobAssigned(),this._jobAssignedToNode$.next(this._jobAssignedToNode),!0===this._jobAssignedToNode?await s():setTimeout((async()=>{!1===this._stopRefreshPoll.stop&&await r()}),2e3)};return!0===a&&(!0===this._jobAssignedToNode?await s():await r()),i}catch(e){throw e}}_adjustRefreshInterval(e){if(!1===this._performRefreshRateAdjustment){if(!(Date.now()-this._datafeedStartTime>2e3))return;this._performRefreshRateAdjustment=!0}const t=e-this._percentageComplete;0!==t&&(this._refreshInterval=Math.floor(this._refreshInterval*(2/t)),this._refreshInterval<b&&(this._refreshInterval=b))}async _isJobAssigned(){const{jobs:e}=await p.ml.getJobStats({jobId:this._jobId});return e.length>0&&void 0!==e[0].node}async startDatafeed(){return await this._startDatafeed(this._start,this._end,!0)}async startDatafeedInRealTime(e){const t=e?this._end:this._start;return await this._startDatafeed(t,void 0,!1)}async getProgress(){return await p.ml.jobs.getLookBackProgress(this._jobId,this._start,this._end)}subscribeToProgress(e){this._progress$.subscribe(e)}async isRunning(){const{isRunning:e}=await this.getProgress();return e}isJobAssignedToNode(){return this._jobAssignedToNode}subscribeToJobAssignment(e){return this._jobAssignedToNode$.subscribe(e)}}var f=a(84),h=a(93),g=a(6);function j(e,t){if(!Object(g.b)(t,["runtime_mappings"])||!Object(g.b)(t.runtime_mappings))return{runtime_mappings:{},discarded_mappings:{}};const a=function(e,t){var a;const n=new Set;e.analysis_config.detectors.forEach((e=>{void 0!==e.field_name&&n.add(e.field_name),void 0!==e.by_field_name&&n.add(e.by_field_name),void 0!==e.over_field_name&&n.add(e.over_field_name),void 0!==e.partition_field_name&&n.add(e.partition_field_name)})),void 0!==e.analysis_config.categorization_field_name&&n.add(e.analysis_config.categorization_field_name);void 0!==e.analysis_config.summary_count_field_name&&n.add(e.analysis_config.summary_count_field_name);void 0!==e.analysis_config.influencers&&e.analysis_config.influencers.forEach((e=>n.add(e)));const i=null!==(a=t.aggregations)&&void 0!==a?a:t.aggs;void 0!==i&&x(i).forEach((e=>n.add(e)));const s=t.query;void 0!==s&&v(s).forEach((e=>n.add(e)));return[...n]}(e,t),{runtimeMappings:n,discardedMappings:i}=(s=t.runtime_mappings,{runtimeMappings:(r=a).reduce(((e,t)=>(void 0!==s[t]&&(e[t]=s[t]),e)),{}),discardedMappings:Object.keys(s).reduce(((e,t)=>(!1===r.includes(t)&&void 0!==s[t]&&(e[t]=s[t]),e)),{})});var s,r;return{runtime_mappings:n,discarded_mappings:i}}function x(e){const t=[];return Object.entries(e).forEach((([e,a])=>{Object(g.b)(a)?t.push(...x(a)):"string"==typeof a&&"field"===e&&t.push(a)})),t}function v(e){const t=[];return Object.entries(e).forEach((([e,a])=>{Object(g.b)(a)?(t.push(e),t.push(...v(a))):"string"==typeof a?t.push(a):t.push(e)})),t}var y=a(29),O=a(296),E=a(222);class job_creator_JobCreator{constructor(e,t,a){i()(this,"_type",f.f.SINGLE_METRIC),i()(this,"_indexPattern",void 0),i()(this,"_savedSearch",void 0),i()(this,"_indexPatternTitle",""),i()(this,"_job_config",void 0),i()(this,"_calendars",void 0),i()(this,"_datafeed_config",void 0),i()(this,"_detectors",void 0),i()(this,"_influencers",void 0),i()(this,"_bucketSpanMs",0),i()(this,"_useDedicatedIndex",!1),i()(this,"_start",0),i()(this,"_end",0),i()(this,"_subscribers",[]),i()(this,"_aggs",[]),i()(this,"_fields",[]),i()(this,"_scriptFields",[]),i()(this,"_runtimeFields",[]),i()(this,"_runtimeMappings",null),i()(this,"_filterRuntimeMappingsOnSave",!0),i()(this,"_aggregationFields",[]),i()(this,"_sparseData",!1),i()(this,"_stopAllRefreshPolls",{stop:!1}),i()(this,"_wizardInitialized$",new s.BehaviorSubject(!1)),i()(this,"wizardInitialized$",this._wizardInitialized$.asObservable()),this._indexPattern=e,this._savedSearch=t,this._indexPatternTitle=e.title,this._job_config=Object(d.c)(),this._calendars=[],this._datafeed_config=Object(d.b)(this._indexPatternTitle),this._detectors=this._job_config.analysis_config.detectors,this._influencers=this._job_config.analysis_config.influencers,"string"==typeof e.timeFieldName&&(this._job_config.data_description.time_field=e.timeFieldName),this._extractRuntimeMappings(),this._datafeed_config.query=a}get type(){return this._type}get indexPatternTitle(){return this._indexPatternTitle}_addDetector(e,t,a){this._detectors.push(e),this._aggs.push(t),this._fields.push(a),this._updateSparseDataDetectors()}_editDetector(e,t,a,n){void 0!==this._detectors[n]&&(this._detectors[n]=e,this._aggs[n]=t,this._fields[n]=a,this._updateSparseDataDetectors())}_removeDetector(e){this._detectors.splice(e,1),this._aggs.splice(e,1),this._fields.splice(e,1)}removeAllDetectors(){this._detectors.length=0,this._aggs.length=0,this._fields.length=0}get detectors(){return this._detectors}get aggregationsInDetectors(){return this._aggs}getAggregation(e){const t=this._aggs[e];return void 0!==t?t:null}get aggregations(){return this._aggs}getField(e){const t=this._fields[e];return void 0!==t?t:null}get fields(){return this._fields}set bucketSpan(e){this._job_config.analysis_config.bucket_span=e,this._setBucketSpanMs(e)}get bucketSpan(){return this._job_config.analysis_config.bucket_span}_setBucketSpanMs(e){const t=Object(y.a)(e,!0);this._bucketSpanMs=null===t?0:t.asMilliseconds()}get bucketSpanMs(){return this._bucketSpanMs}addInfluencer(e){!1===this._influencers.includes(e)&&this._influencers.push(e)}removeInfluencer(e){const t=this._influencers.indexOf(e);-1!==t&&this._influencers.splice(t,1)}removeAllInfluencers(){this._influencers.length=0}get influencers(){return this._influencers}set jobId(e){this._job_config.job_id=e,this._datafeed_config.job_id=e,this._datafeed_config.datafeed_id=`datafeed-${e}`,this._useDedicatedIndex&&(this._job_config.results_index_name=e)}get jobId(){return this._job_config.job_id}get datafeedId(){return this._datafeed_config.datafeed_id}set description(e){this._job_config.description=e}get description(){var e;return null!==(e=this._job_config.description)&&void 0!==e?e:""}get groups(){var e;return null!==(e=this._job_config.groups)&&void 0!==e?e:[]}set groups(e){this._job_config.groups=e}get calendars(){return this._calendars}set calendars(e){this._calendars=e}_initModelPlotConfig(){void 0===this._job_config.model_plot_config&&(this._job_config.model_plot_config={enabled:!1}),void 0!==this._job_config.model_plot_config&&void 0===this._job_config.model_plot_config.enabled&&(this._job_config.model_plot_config.enabled=!1),void 0!==this._job_config.model_plot_config&&void 0===this._job_config.model_plot_config.annotations_enabled&&(this._job_config.model_plot_config.annotations_enabled=!1)}set modelPlot(e){this._initModelPlotConfig(),this._job_config.model_plot_config.enabled=e}get modelPlot(){return void 0!==this._job_config.model_plot_config&&!0===this._job_config.model_plot_config.enabled}set modelChangeAnnotations(e){this._initModelPlotConfig(),this._job_config.model_plot_config.annotations_enabled=e}get modelChangeAnnotations(){var e;return!0===(null===(e=this._job_config.model_plot_config)||void 0===e?void 0:e.annotations_enabled)}set useDedicatedIndex(e){this._useDedicatedIndex=e,e?this._job_config.results_index_name=this._job_config.job_id:delete this._job_config.results_index_name}get useDedicatedIndex(){return this._useDedicatedIndex}set modelMemoryLimit(e){null!==e?this._job_config.analysis_limits={model_memory_limit:e}:delete this._job_config.analysis_limits}get modelMemoryLimit(){return this._job_config.analysis_limits&&void 0!==this._job_config.analysis_limits.model_memory_limit?this._job_config.analysis_limits.model_memory_limit:null}set summaryCountFieldName(e){null!==e?this._job_config.analysis_config.summary_count_field_name=e:delete this._job_config.analysis_config.summary_count_field_name}get summaryCountFieldName(){return this._job_config.analysis_config.summary_count_field_name||null}set categorizationFieldName(e){null!==e?this._job_config.analysis_config.categorization_field_name=e:delete this._job_config.analysis_config.categorization_field_name}get categorizationFieldName(){return this._job_config.analysis_config.categorization_field_name||null}addCategorizationFilter(e){void 0===this._job_config.analysis_config.categorization_filters&&(this._job_config.analysis_config.categorization_filters=[]);const t=this._job_config.analysis_config.categorization_filters;!1===t.includes(e)&&t.push(e)}removeCategorizationFilter(e){const t=this._job_config.analysis_config.categorization_filters;if(void 0!==t){const a=t.indexOf(e);-1!==a&&t.splice(a,1),0===t.length&&this.removeCategorizationFilters()}}removeCategorizationFilters(){delete this._job_config.analysis_config.categorization_filters}get categorizationFilters(){return this._job_config.analysis_config.categorization_filters||null}get timeFieldName(){return this._job_config.data_description.time_field}set timeFieldName(e){this._job_config.data_description.time_field=e}get sparseData(){return this._sparseData}set sparseData(e){this._sparseData=e,this._updateSparseDataDetectors()}_updateSparseDataDetectors(){this._detectors.forEach(((e,t)=>{if(void 0!==this._aggs[t])switch(this._aggs[t].id){case o.b.COUNT:e.function=this._sparseData?o.b.NON_ZERO_COUNT:o.b.COUNT;break;case o.b.HIGH_COUNT:e.function=this._sparseData?o.b.HIGH_NON_ZERO_COUNT:o.b.HIGH_COUNT;break;case o.b.LOW_COUNT:e.function=this._sparseData?o.b.LOW_NON_ZERO_COUNT:o.b.LOW_COUNT;break;case o.b.SUM:e.function=this._sparseData?o.b.NON_NULL_SUM:o.b.SUM;break;case o.b.HIGH_SUM:e.function=this._sparseData?o.b.HIGH_NON_NULL_SUM:o.b.HIGH_SUM;break;case o.b.LOW_SUM:e.function=this._sparseData?o.b.LOW_NON_NULL_SUM:o.b.LOW_SUM}}))}async _updateCalendars(){if(0!==this._calendars.length)for(const e of this._calendars)await O.a.assignNewJobId(e,this.jobId)}setTimeRange(e,t){this._start=e,this._end=t}get start(){return this._start}get end(){return this._end}get query(){return this._datafeed_config.query}set query(e){this._datafeed_config.query=e}get queryDelay(){return this._datafeed_config.query_delay||null}set queryDelay(e){null!==e?this._datafeed_config.query_delay=e:delete this._datafeed_config.query_delay}get frequency(){return this._datafeed_config.frequency||null}set frequency(e){null!==e?this._datafeed_config.frequency=e:delete this._datafeed_config.frequency}get scrollSize(){return this._datafeed_config.scroll_size||null}set scrollSize(e){null!==e?this._datafeed_config.scroll_size=e:delete this._datafeed_config.scroll_size}get indices(){return this._datafeed_config.indices}set indices(e){this._datafeed_config.indices=e}get scriptFields(){return this._scriptFields}get runtimeMappings(){return this._runtimeMappings}get runtimeFields(){return this._runtimeFields}get aggregationFields(){return this._aggregationFields}get additionalFields(){return[...this._scriptFields,...this._runtimeFields,...this._aggregationFields]}get subscribers(){return this._subscribers}async createAndStartJob(){try{await this.createJob(),await this.createDatafeed();return await this.startDatafeed()}catch(e){throw e}}async createJob(){try{const{success:e,resp:t}=await u.a.saveNewJob(this._job_config);if(await this._updateCalendars(),!0===e)return t;throw t}catch(e){throw e}}async createDatafeed(){try{const e=this._getDatafeedWithFilteredRuntimeMappings();return await u.a.saveNewDatafeed(e,this._job_config.job_id)}catch(e){throw e}}async startDatafeed(){const e=new job_runner_JobRunner(this);return await e.startDatafeed(),e}_getDatafeedWithFilteredRuntimeMappings(){if(!1===this._filterRuntimeMappingsOnSave)return this._datafeed_config;const{runtime_mappings:e}=j(this._job_config,this._datafeed_config);return{...this._datafeed_config,runtime_mappings:Object.keys(e).length>0?e:void 0}}subscribeToProgress(e){this._subscribers.push(e)}get jobConfig(){return this._job_config}get datafeedConfig(){return this._datafeed_config}get stopAllRefreshPolls(){return this._stopAllRefreshPolls}forceStopRefreshPolls(){this._stopAllRefreshPolls.stop=!0}_setCustomSetting(e,t){null===t?void 0!==this._job_config.custom_settings&&void 0!==this._job_config.custom_settings[e]&&(delete this._job_config.custom_settings[e],0===Object.keys(this._job_config.custom_settings).length&&delete this._job_config.custom_settings):void 0===this._job_config.custom_settings?this._job_config.custom_settings={[e]:t}:this._job_config.custom_settings[e]=t}_getCustomSetting(e){return void 0!==this._job_config.custom_settings&&void 0!==this._job_config.custom_settings[e]?this._job_config.custom_settings[e]:null}set createdBy(e){this._setCustomSetting("created_by",e)}get createdBy(){return this._getCustomSetting("created_by")}set customUrls(e){this._setCustomSetting("custom_urls",e)}get customUrls(){return this._getCustomSetting("custom_urls")}get formattedJobJson(){return JSON.stringify(this._job_config,null,2)}get formattedDatafeedJson(){return JSON.stringify(this._datafeed_config,null,2)}set filterRuntimeMappingsOnSave(e){this._filterRuntimeMappingsOnSave=e}get filterRuntimeMappingsOnSave(){return this._filterRuntimeMappingsOnSave}_initPerPartitionCategorization(){var e,t;void 0===this._job_config.analysis_config.per_partition_categorization&&(this._job_config.analysis_config.per_partition_categorization={}),void 0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.enabled)&&(this._job_config.analysis_config.per_partition_categorization.enabled=!1),void 0===(null===(t=this._job_config.analysis_config.per_partition_categorization)||void 0===t?void 0:t.stop_on_warn)&&(this._job_config.analysis_config.per_partition_categorization.stop_on_warn=!1)}get perPartitionCategorization(){var e;return!0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.enabled)}set perPartitionCategorization(e){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.enabled=e}get perPartitionStopOnWarn(){var e;return!0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.stop_on_warn)}set perPartitionStopOnWarn(e){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.stop_on_warn=e}_extractRuntimeMappings(){const e=this._indexPattern.toSpec().runtimeFieldMap;void 0!==e&&(void 0===this._datafeed_config.runtime_mappings&&(this._datafeed_config.runtime_mappings={}),Object.entries(e).forEach((([e,t])=>{this._datafeed_config.runtime_mappings[e]=t}))),this._populateRuntimeFields()}_populateRuntimeFields(){var e;if(this._runtimeFields=[],this._runtimeMappings=null!==(e=this._datafeed_config.runtime_mappings)&&void 0!==e?e:null,null!==this._runtimeMappings){const e=Object.entries(this._runtimeMappings).map((([e,t])=>({id:e,name:e,type:t.type,aggregatable:!0,aggs:[],runtimeField:t}))),t=Object(r.cloneDeep)([...o.d,...o.e]);this._runtimeFields=Object(c.a)(e,t,{}).fields}}_populateScriptFields(){this._scriptFields=[],void 0!==this._datafeed_config.script_fields&&(this._scriptFields=Object.keys(this._datafeed_config.script_fields).map((e=>({id:e,name:e,type:l.ES_FIELD_TYPES.KEYWORD,aggregatable:!0}))))}_overrideConfigs(e,t){this._job_config=e,this._datafeed_config=t,this._detectors=this._job_config.analysis_config.detectors,this._influencers=this._job_config.analysis_config.influencers,void 0===this._job_config.groups&&(this._job_config.groups=[]),void 0!==this._job_config.analysis_config.influencers&&this._job_config.analysis_config.influencers.forEach((e=>this.addInfluencer(e))),void 0!==this._job_config.results_index_name&&this._job_config.results_index_name!==f.g&&(this.useDedicatedIndex=!0),this._populateScriptFields(),this._populateRuntimeFields(),this._aggregationFields=[];const a=Object(E.b)(this._datafeed_config);if(void 0!==a){const e=Object(g.a)(a);if(void 0!==e&&void 0!==a[e]){const t=a[e];Object(h.c)(t,this._aggregationFields)}}}}class single_metric_job_creator_SingleMetricJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),i()(this,"_type",f.f.SINGLE_METRIC),this.createdBy=f.a.SINGLE_METRIC,this._wizardInitialized$.next(!0)}setDetector(e,t){const a=Object(d.a)(e,t);0===this._detectors.length?this._addDetector(a,e,t):this._editDetector(a,e,t,0),this._createDatafeedAggregations()}set bucketSpan(e){this._job_config.analysis_config.bucket_span=e,this._setBucketSpanMs(e),this._createDatafeedAggregations()}get bucketSpan(){return this._job_config.analysis_config.bucket_span}_createDatafeedAggregations(){if(this._detectors.length&&"string"==typeof this._job_config.analysis_config.bucket_span&&this._aggs.length>0){delete this._job_config.analysis_config.summary_count_field_name,delete this._datafeed_config.aggregations;const e=this._aggs[0].dslName,t=this._job_config.data_description.time_field,a=Object(y.a)(this._job_config.analysis_config.bucket_span,!0);if(null===a)return;const n=1e3*a.asSeconds();let i=null;switch(e){case o.a.COUNT:this._job_config.analysis_config.summary_count_field_name="doc_count",this._datafeed_config.aggregations={buckets:{date_histogram:{field:t,fixed_interval:`${n}ms`},aggregations:{[t]:{max:{field:t}}}}};break;case o.a.AVG:case o.a.SUM:case o.a.MIN:case o.a.MAX:if(i=this._fields[0],null!==i){const a=i.name;this._job_config.analysis_config.summary_count_field_name="doc_count",this._datafeed_config.aggregations={buckets:{date_histogram:{field:t,fixed_interval:.1*n+"ms"},aggregations:{[a]:{[e]:{field:a}},[t]:{max:{field:t}}}}}}break;case o.a.CARDINALITY:if(i=this._fields[0],null!==i){const a=i.name;this._job_config.analysis_config.summary_count_field_name=`dc_${a}`,this._datafeed_config.aggregations={buckets:{date_histogram:{field:t,fixed_interval:`${n}ms`},aggregations:{[t]:{max:{field:t}},[this._job_config.analysis_config.summary_count_field_name]:{[e]:{field:a}}}}};const s=this._detectors[0];s.function=o.b.NON_ZERO_COUNT,s.detector_description=`${e} (${a})`,delete s.field_name}}}}get aggFieldPair(){return 0===this._aggs.length?null:{agg:this._aggs[0],field:this._fields[0]}}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=f.a.SINGLE_METRIC,this._sparseData=Object(h.k)(e,t);const a=Object(h.j)(e,t,this.additionalFields,!1);this.removeAllDetectors();const n=a[0];a.length&&null!==n.agg&&null!==n.field&&this.setDetector(n.agg,n.field)}}class multi_metric_job_creator_MultiMetricJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),i()(this,"_splitField",null),i()(this,"_type",f.f.MULTI_METRIC),this.createdBy=f.a.MULTI_METRIC,this._wizardInitialized$.next(!0)}setSplitField(e){if(this._splitField=e,null===this._splitField)this.removeSplitField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].partition_field_name=this._splitField.id}removeSplitField(){this._detectors.forEach((e=>{delete e.partition_field_name}))}get splitField(){return this._splitField}addDetector(e,t){const a=this._createDetector(e,t);this._addDetector(a,e,t)}editDetector(e,t,a){const n=this._createDetector(e,t);this._editDetector(n,e,t,a)}_createDetector(e,t){const a=Object(d.a)(e,t);return null!==this._splitField&&(a.partition_field_name=this._splitField.id),a}removeDetector(e){this._removeDetector(e)}get aggFieldPairs(){return this.detectors.map(((e,t)=>({field:this._fields[t],agg:this._aggs[t]})))}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=f.a.MULTI_METRIC,this._sparseData=Object(h.k)(e,t);const a=Object(h.j)(e,t,this.additionalFields,!1);void 0!==t.aggregations&&(delete t.aggregations,delete e.analysis_config.summary_count_field_name),this.removeAllDetectors(),a.forEach(((e,t)=>{const n=a[t];null!==n.agg&&null!==n.field&&this.addDetector(n.agg,n.field)})),a.length&&null!==a[0].partitionField&&this.setSplitField(a[0].partitionField)}}class population_job_creator_PopulationJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),i()(this,"_populatonField",null),i()(this,"_byFields",[]),i()(this,"_type",f.f.POPULATION),this.createdBy=f.a.POPULATION,this._wizardInitialized$.next(!0)}setByField(e,t){null===e?this.removeByField(t):void 0!==this._detectors[t]&&(this._byFields[t]=e,this._detectors[t].by_field_name=e.id)}removeByField(e){void 0!==this._detectors[e]&&(this._byFields[e]=null,delete this._detectors[e].by_field_name)}getByField(e){return void 0===this._byFields[e]?null:this._byFields[e]}setPopulationField(e){if(this._populatonField=e,null===this._populatonField)this.removePopulationField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].over_field_name=this._populatonField.id}removePopulationField(){this._detectors.forEach((e=>{delete e.over_field_name}))}get populationField(){return this._populatonField}addDetector(e,t){const a=this._createDetector(e,t);this._addDetector(a,e,t),this._byFields.push(null)}editDetector(e,t,a){const n=this._createDetector(e,t),i=this._byFields[a];null!=i&&(n.by_field_name=i.id),this._editDetector(n,e,t,a)}_createDetector(e,t){const a=Object(d.a)(e,t);return null!==this._populatonField&&(a.over_field_name=this._populatonField.id),a}removeDetector(e){this._removeDetector(e),this._byFields.splice(e,1)}get aggFieldPairs(){return this.detectors.map(((e,t)=>({field:this._fields[t],agg:this._aggs[t],by:{field:this._byFields[t],value:null}})))}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=f.a.POPULATION;const a=Object(h.j)(e,t,this.additionalFields,!1);this.removeAllDetectors(),a.length&&null!==a[0].overField&&this.setPopulationField(a[0].overField),a.forEach(((e,t)=>{const n=a[t];null!==n.agg&&null!==n.field&&(this.addDetector(n.agg,n.field),null!==n.byField&&this.setByField(n.byField,t))}))}}var w=a(143);class advanced_job_creator_AdvancedJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),i()(this,"_type",f.f.ADVANCED),i()(this,"_richDetectors",[]),i()(this,"_queryString",void 0),this._queryString=JSON.stringify(this._datafeed_config.query),this._wizardInitialized$.next(!0)}addDetector(e,t,a,n,i,s,r,o){const{detector:l,richDetector:c}=this._createDetector(e,t,a,n,i,s,r,null,o);this._addDetector(l,e,t),this._richDetectors.push(c)}editDetector(e,t,a,n,i,s,r,o,l){const c=void 0!==this._detectors[o]&&this._detectors[o].custom_rules||null,{detector:d,richDetector:u}=this._createDetector(e,t,a,n,i,s,r,c,l);this._editDetector(d,e,t,o),void 0!==this._richDetectors[o]&&(this._richDetectors[o]=u)}_createDetector(e,t,a,n,i,s,r,o,l){const c=Object(d.a)(e,t);null!==a&&(c.by_field_name=a.id),null!==n&&(c.over_field_name=n.id),null!==i&&(c.partition_field_name=i.id),null!==s&&(c.exclude_frequent=s),null!==r&&(c.detector_description=r),null!==o&&(c.custom_rules=o),null!==l&&(c.use_null=l);return{detector:c,richDetector:{agg:e,field:t,byField:a,overField:n,partitionField:i,excludeFrequent:s,description:r,customRules:o,useNull:l}}}removeDetector(e){this._removeDetector(e),this._richDetectors.splice(e,1)}get richDetectors(){return this._richDetectors}get queryString(){return this._queryString}set queryString(e){this._queryString=e}get isValidQueryString(){return Object(w.c)(this._queryString)}async autoSetTimeRange(){const{start:e,end:t}=await p.ml.getTimeFieldRange({index:this._indexPatternTitle,timeFieldName:this.timeFieldName,query:this.query,runtimeMappings:this.datafeedConfig.runtime_mappings,indicesOptions:this.datafeedConfig.indices_options});this.setTimeRange(e.epoch,t.epoch)}cloneFromExistingJob(e,t){this._overrideConfigs(e,t);const a=Object(h.j)(e,t,this.additionalFields,!0),n=this._detectors.map((e=>e.custom_rules));this.removeAllDetectors(),this._richDetectors.length=0,a.forEach(((e,t)=>{const n=a[t];null!==n.agg&&null!==n.field&&this.addDetector(n.agg,n.field,n.byField,n.overField,n.partitionField,n.excludeFrequent,n.description,n.useNull)})),n.forEach(((e,t)=>{void 0!==e&&(this._detectors[t].custom_rules=e)}))}}var M=a(120),S=a(155),_=a(304),T=a(395),C=a(92),k=a(96);class categorization_job_creator_CategorizationJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),i()(this,"_type",f.f.CATEGORIZATION),i()(this,"_createCountDetector",(()=>{})),i()(this,"_createRareDetector",(()=>{})),i()(this,"_examplesLoader",void 0),i()(this,"_categoryFieldExamples",[]),i()(this,"_validationChecks",[]),i()(this,"_overallValidStatus",S.a.INVALID),i()(this,"_detectorType",o.b.COUNT),i()(this,"_categorizationAnalyzer",{}),i()(this,"_defaultCategorizationAnalyzer",void 0),i()(this,"_partitionFieldName",null),i()(this,"_ccsVersionFailure",!1),this.createdBy=f.a.CATEGORIZATION,this._examplesLoader=new T.a(this,e,a);const{anomaly_detectors:n}=Object(C.c)();this._defaultCategorizationAnalyzer=n.categorization_analyzer||{}}setDefaultDetectorProperties(e,t,a){if(null===e||null===t||null===a)throw Error("event_rate field or count or rare aggregations missing");this._createCountDetector=()=>{this._createDetector(e,a)},this._createRareDetector=()=>{this._createDetector(t,a)}}_createDetector(e,t){const a=Object(d.a)(e,t);a.by_field_name=M.c.id,this.perPartitionCategorization&&null!==this.categorizationPerPartitionField&&(a.partition_field_name=this.categorizationPerPartitionField),this._addDetector(a,e,M.c)}setDetectorType(e){this._detectorType=e,this.removeAllDetectors(),e===o.b.COUNT?(this._createCountDetector(),this.bucketSpan=f.b):(this._createRareDetector(),this.bucketSpan=f.e,this.modelPlot=!1)}set categorizationFieldName(e){null!==e?(this._job_config.analysis_config.categorization_field_name=e,this.setDetectorType(this._detectorType),this.addInfluencer(M.c.id)):(delete this._job_config.analysis_config.categorization_field_name,this._categoryFieldExamples=[],this._validationChecks=[],this._overallValidStatus=S.a.INVALID)}get categorizationFieldName(){return this._job_config.analysis_config.categorization_field_name||null}async loadCategorizationFieldExamples(){const{examples:e,sampleSize:t,overallValidStatus:a,validationChecks:n}=await this._examplesLoader.loadExamples();return this._categoryFieldExamples=e,this._validationChecks=n,this._overallValidStatus=a,this._ccsVersionFailure=this._checkCcsFailure(e,a,n),!0===this._ccsVersionFailure&&(this._overallValidStatus=S.a.VALID),this._wizardInitialized$.next(!0),{examples:e,sampleSize:t,overallValidStatus:a,validationChecks:n,ccsVersionFailure:this._ccsVersionFailure}}_checkCcsFailure(e,t,a){var n;return 0===e.length&&t===S.a.INVALID&&(null===(n=a[0])||void 0===n?void 0:n.id)===_.a.NO_EXAMPLES&&Object(k.g)(this.indexPatternTitle)}get categoryFieldExamples(){return this._categoryFieldExamples}get validationChecks(){return this._validationChecks}get overallValidStatus(){return this._overallValidStatus}get selectedDetectorType(){return this._detectorType}set categorizationAnalyzer(e){this._categorizationAnalyzer=e,Object(r.isEqual)(this._categorizationAnalyzer,this._defaultCategorizationAnalyzer)?delete this._job_config.analysis_config.categorization_analyzer:this._job_config.analysis_config.categorization_analyzer=e}get categorizationAnalyzer(){return this._categorizationAnalyzer}get categorizationPerPartitionField(){return this._partitionFieldName}set categorizationPerPartitionField(e){null===e?(this._detectors.forEach((e=>{delete e.partition_field_name})),null!==this._partitionFieldName&&this.removeInfluencer(this._partitionFieldName),this._partitionFieldName=null):this._partitionFieldName!==e&&(null!==this._partitionFieldName&&this.removeInfluencer(this._partitionFieldName),this.addInfluencer(e),this._partitionFieldName=e,this._detectors.forEach((t=>{t.partition_field_name=e})))}get perPartitionCategorization(){var e;return!0===(null===(e=this._job_config.analysis_config.per_partition_categorization)||void 0===e?void 0:e.enabled)}set perPartitionCategorization(e){this._initPerPartitionCategorization(),this._job_config.analysis_config.per_partition_categorization.enabled=e,!1===e&&(this.categorizationPerPartitionField=null)}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=f.a.CATEGORIZATION;const a=Object(h.j)(e,t,this.additionalFields,!1)[0];if(void 0!==a&&null!==a.agg&&null!==a.field){const t=a.agg.id===o.b.COUNT?o.b.COUNT:o.b.RARE,n=e.analysis_config.bucket_span;this.setDetectorType(t),null!==a.partitionField&&(this.categorizationPerPartitionField=a.partitionField.id),this.bucketSpan=n}}}class rare_job_creator_RareJobCreator extends job_creator_JobCreator{constructor(e,t,a){super(e,t,a),i()(this,"_rareField",null),i()(this,"_populationField",null),i()(this,"_splitField",null),i()(this,"_type",f.f.RARE),i()(this,"_rareInPopulation",!1),i()(this,"_frequentlyRare",!1),i()(this,"_rareAgg",void 0),i()(this,"_freqRareAgg",void 0),this.createdBy=f.a.RARE,this._wizardInitialized$.next(!0),this._rareAgg={},this._freqRareAgg={}}setDefaultDetectorProperties(e,t){if(null===e||null===t)throw Error("rare or freq_rare aggregations missing");this._rareAgg=e,this._freqRareAgg=t}setRareField(e){if(this._rareField=e,null===e)return this.removePopulationField(),this.removeSplitField(),this._removeDetector(0),this._detectors.length=0,void(this._fields.length=0);const t=this._frequentlyRare?this._freqRareAgg:this._rareAgg,a={function:t.id};0===this._detectors.length?this._addDetector(a,t,e):this._editDetector(a,t,e,0),this._detectors[0].by_field_name=e.id}get rareField(){return this._rareField}get rareInPopulation(){return this._rareInPopulation}set rareInPopulation(e){this._rareInPopulation=e,!1===e&&this.removePopulationField()}get frequentlyRare(){return this._frequentlyRare}set frequentlyRare(e){if(this._frequentlyRare=e,this._detectors.length){const t=e?this._freqRareAgg:this._rareAgg;this._detectors[0].function=t.id,this._aggs[0]=t}}setPopulationField(e){if(this._populationField=e,null===this._populationField)this.removePopulationField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].over_field_name=this._populationField.id}removePopulationField(){this._populationField=null,this._detectors.forEach((e=>{delete e.over_field_name}))}get populationField(){return this._populationField}setSplitField(e){if(this._splitField=e,null===this._splitField)this.removeSplitField();else for(let e=0;e<this._detectors.length;e++)this._detectors[e].partition_field_name=this._splitField.id}removeSplitField(){this._detectors.forEach((e=>{delete e.partition_field_name}))}get splitField(){return this._splitField}cloneFromExistingJob(e,t){this._overrideConfigs(e,t),this.createdBy=f.a.RARE,this._sparseData=Object(h.k)(e,t);const a=Object(h.j)(e,t,this.additionalFields,!1);var n;(this.removeSplitField(),this.removePopulationField(),this.removeAllDetectors(),a.length)&&(this.setRareField(a[0].byField),this.frequentlyRare=(null===(n=a[0].agg)||void 0===n?void 0:n.id)===o.b.FREQ_RARE,null!==a[0].overField&&(this.setPopulationField(a[0].overField),this.rareInPopulation=!0),null!==a[0].partitionField&&this.setSplitField(a[0].partitionField))}}function F(e){return e.type===f.f.SINGLE_METRIC}function I(e){return e.type===f.f.MULTI_METRIC}function D(e){return e.type===f.f.POPULATION}function A(e){return e.type===f.f.ADVANCED}function L(e){return e.type===f.f.CATEGORIZATION}function R(e){return e.type===f.f.RARE}const N=e=>(t,a,n)=>{let i;switch(e){case f.f.SINGLE_METRIC:i=single_metric_job_creator_SingleMetricJobCreator;break;case f.f.MULTI_METRIC:i=multi_metric_job_creator_MultiMetricJobCreator;break;case f.f.POPULATION:i=population_job_creator_PopulationJobCreator;break;case f.f.ADVANCED:i=advanced_job_creator_AdvancedJobCreator;break;case f.f.CATEGORIZATION:i=categorization_job_creator_CategorizationJobCreator;break;case f.f.RARE:i=rare_job_creator_RareJobCreator;break;default:i=single_metric_job_creator_SingleMetricJobCreator}return new i(t,a,n)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return f})),a.d(t,"b",(function(){return b})),a.d(t,"c",(function(){return h})),a.d(t,"d",(function(){return g})),a.d(t,"e",(function(){return m}));var n=a(15),i=(a(16),a(2)),s=a(44),r=a(46),o=a(26),l=a(12);let c;function d(){if(void 0===c){const e=i.i18n.translate("xpack.ml.checkLicense.licenseHasExpiredMessage",{defaultMessage:"Your Machine Learning license has expired."}),t=Object(o.g)(),a=Object(o.j)();c=t.banners.add(Object(r.toMountPoint)(Object(r.wrapWithTheme)(Object(l.jsx)(s.EuiCallOut,{iconType:"iInCircle",color:"warning",title:e}),a.theme$)))}}class ml_client_license_MlClientLicense extends n.a{fullLicenseResolver(){return!1===this.isMlEnabled()||!1===this.isMinimumLicense()?u():!1===this.isFullLicense()?(window.location.href="#/datavisualizer",Promise.reject()):(this.hasLicenseExpired()&&d(),Promise.resolve())}basicLicenseResolver(){return!1===this.isMlEnabled()||!1===this.isMinimumLicense()?u():(this.hasLicenseExpired()&&d(),Promise.resolve())}}function u(){return window.location.href="/",Promise.reject()}let p=null;function m(e,t){return p=new ml_client_license_MlClientLicense,p.setup(e.license$,t),p}async function b(){return null===p?(console.error("ML Licensing not initialized"),Promise.reject()):p.fullLicenseResolver()}async function f(){return null===p?(console.error("ML Licensing not initialized"),Promise.reject()):p.basicLicenseResolver()}function h(){return null!==p&&p.hasLicenseExpired()}function g(){return null!==p&&p.isFullLicense()}},,,,,,,function(e,t,a){"use strict";var n=a(88),i=a(121).Graph;function s(e,t,a,i){var s;do{s=n.uniqueId(i)}while(e.hasNode(s));return a.dummy=t,e.setNode(s,a),s}function r(e){return n.max(n.map(e.nodes(),(function(t){var a=e.node(t).rank;if(!n.isUndefined(a))return a})))}e.exports={addDummyNode:s,simplify:function(e){var t=(new i).setGraph(e.graph());return n.forEach(e.nodes(),(function(a){t.setNode(a,e.node(a))})),n.forEach(e.edges(),(function(a){var n=t.edge(a.v,a.w)||{weight:0,minlen:1},i=e.edge(a);t.setEdge(a.v,a.w,{weight:n.weight+i.weight,minlen:Math.max(n.minlen,i.minlen)})})),t},asNonCompoundGraph:function(e){var t=new i({multigraph:e.isMultigraph()}).setGraph(e.graph());return n.forEach(e.nodes(),(function(a){e.children(a).length||t.setNode(a,e.node(a))})),n.forEach(e.edges(),(function(a){t.setEdge(a,e.edge(a))})),t},successorWeights:function(e){var t=n.map(e.nodes(),(function(t){var a={};return n.forEach(e.outEdges(t),(function(t){a[t.w]=(a[t.w]||0)+e.edge(t).weight})),a}));return n.zipObject(e.nodes(),t)},predecessorWeights:function(e){var t=n.map(e.nodes(),(function(t){var a={};return n.forEach(e.inEdges(t),(function(t){a[t.v]=(a[t.v]||0)+e.edge(t).weight})),a}));return n.zipObject(e.nodes(),t)},intersectRect:function(e,t){var a,n,i=e.x,s=e.y,r=t.x-i,o=t.y-s,l=e.width/2,c=e.height/2;if(!r&&!o)throw new Error("Not possible to find intersection inside of the rectangle");Math.abs(o)*l>Math.abs(r)*c?(o<0&&(c=-c),a=c*r/o,n=c):(r<0&&(l=-l),a=l,n=l*o/r);return{x:i+a,y:s+n}},buildLayerMatrix:function(e){var t=n.map(n.range(r(e)+1),(function(){return[]}));return n.forEach(e.nodes(),(function(a){var i=e.node(a),s=i.rank;n.isUndefined(s)||(t[s][i.order]=a)})),t},normalizeRanks:function(e){var t=n.min(n.map(e.nodes(),(function(t){return e.node(t).rank})));n.forEach(e.nodes(),(function(a){var i=e.node(a);n.has(i,"rank")&&(i.rank-=t)}))},removeEmptyRanks:function(e){var t=n.min(n.map(e.nodes(),(function(t){return e.node(t).rank}))),a=[];n.forEach(e.nodes(),(function(n){var i=e.node(n).rank-t;a[i]||(a[i]=[]),a[i].push(n)}));var i=0,s=e.graph().nodeRankFactor;n.forEach(a,(function(t,a){n.isUndefined(t)&&a%s!=0?--i:i&&n.forEach(t,(function(t){e.node(t).rank+=i}))}))},addBorderNode:function(e,t,a,n){var i={width:0,height:0};arguments.length>=4&&(i.rank=a,i.order=n);return s(e,"border",i,t)},maxRank:r,partition:function(e,t){var a={lhs:[],rhs:[]};return n.forEach(e,(function(e){t(e)?a.lhs.push(e):a.rhs.push(e)})),a},time:function(e,t){var a=n.now();try{return t()}finally{console.log(e+" time: "+(n.now()-a)+"ms")}},notime:function(e,t){return t()}}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(16),i=a.n(n),s=a(2),r=a(72);const o=i.a.memo((({docLink:e})=>{const{chrome:t}=Object(r.b)().services;return Object(n.useEffect)((()=>{t.setHelpExtension({appName:s.i18n.translate("xpack.ml.chrome.help.appName",{defaultMessage:"Machine Learning"}),links:[{href:e,linkType:"documentation"}]})}),[]),null}));o.displayName="HelpMenu"},,,,,,function(e,t,a){(function(e){var n=a(170).format_value,i=t.schema={},s=t.properties={CALSCALE:{type:"TEXT"},METHOD:{type:"TEXT"},PRODID:{type:"TEXT"},VERSION:{type:"TEXT"},ATTACH:{type:"URI"},CATEGORIES:{type:"TEXT",list:!0},CLASS:{type:"TEXT"},COMMENT:{type:"TEXT"},DESCRIPTION:{type:"TEXT"},GEO:{type:"FLOAT",list:!0},LOCATION:{type:"TEXT"},"PERCENT-COMPLETE":{type:"INTEGER"},PRIORITY:{type:"INTEGER"},RESOURCES:{type:"TEXT"},STATUS:{type:"TEXT"},SUMMARY:{type:"TEXT"},COMPLETED:{type:"DATE-TIME"},DTEND:{type:"DATE-TIME"},DUE:{type:"DATE-TIME"},DTSTART:{type:"DATE-TIME"},DURATION:{type:"DURATION"},FREEBUSY:{type:"PERIOD"},TRANSP:{type:"TEXT"},TZID:{type:"TEXT"},TZNAME:{type:"TEXT"},TZOFFSETFROM:{type:"UTC-OFFSET"},TZOFFSETTO:{type:"UTC-OFFSET"},TZURL:{type:"URI"},ATTENDEE:{type:"CAL-ADDRESS"},CONTACT:{type:"TEXT"},ORGANIZER:{type:"CAL-ADDRESS"},"RECURRENCE-ID":{type:"DATE-TIME"},"RELATED-TO":{type:"TEXT"},URL:{type:"URI"},UID:{type:"TEXT"},EXDATE:{type:"DATE-TIME",list:!0},RDATE:{type:"DATE-TIME",list:!0},RRULE:{type:"RECUR"},ACTION:{type:"TEXT"},REPEAT:{type:"INTEGER"},TRIGGER:{type:"DURATION"},CREATED:{type:"DATE-TIME"},DTSTAMP:{type:"DATE-TIME"},"LAST-MODIFIED":{type:"DATE-TIME"},SEQUENCE:{type:"INTEGER"},"REQUEST-STATUS":{type:"TEXT"}},r=t.CalendarObject=function(e,t){this.calendar=e,this.element=t,this.components={},this.properties={}};r.create=function(e,t){var a=(i[e]||{}).factory;return void 0!==a?new a(t):new r(t,e)},r.prototype.clone=function(){var e=r.create(this.element,this.calendar);for(var t in this.properties)e.addProperties(this.properties[t]);for(var a=this.getComponents(),n=0;n<a.length;++n)e.addComponent(a[n]);return e},r.prototype.addProperties=function(e){e.forEach(this.addProperty.bind(this))},r.prototype.addProperty=function(e,t,a){if(e instanceof o)e=e.clone();else{if(void 0===t)return;e=new o(e,t,a)}return this.properties[e.name]=this.properties[e.name]||[],this.properties[e.name].push(e),e},r.prototype.setProperty=function(e,t,a){this.removeProperty(e instanceof o?e.name:e),this.addProperty(e,t,a)},r.prototype.addComponent=function(e){if(!(e instanceof r)){var t=(i[e]||{}).factory;e=void 0!==t?new t(this.calendar):new r(this.calendar,e)}return e.calendar&&e.calendar!==this.calendar&&(e=e.clone()),this.components[e.element]=this.components[e.element]||[],this.components[e.element].push(e),e.calendar=this.calendar,e},r.prototype.addComponents=function(e){e.forEach(this.addComponent.bind(this))},r.prototype.getComponents=function(e){if(void 0===e){var t=[];for(var a in this.components)t=t.concat(this.components[a]);return t}return this.components[e]||[]},r.prototype.getProperty=function(e,t){return(this.properties[e]||[])[t||0]},r.prototype.getProperties=function(e){return this.properties[e]||[]},r.prototype.getPropertyValue=function(e,t){return(this.getProperty(e,t)||{}).value},r.prototype.removeProperty=function(e){delete this.properties[e]},r.prototype.validate=function(){var e=this,t=i[e.element];for(var a in t&&t.required_properties&&t.required_properties.forEach((function(t){if(!e.getPropertyValue(t))throw new Error(t+" is a required property of "+e.element)})),e.components)e.components[a].forEach((function(e){e.validate()}))},r.prototype.toString=function(){var e;if("VCALENDAR"==this.element)e=this.format();else{var t=new(a(198).iCalendar);t.addComponent(this),e=t.format()}return e.push(""),e.join("\r\n")},r.prototype.format=function(){var e=["BEGIN:"+this.element];for(var t in this.properties)this.properties[t].forEach((function(t){e.push.apply(e,t.format())}));for(var a in this.components)for(a=this.components[a],t=0;t<a.length;++t)e.push.apply(e,a[t].format());return e.push("END:"+this.element),e};var o=t.CalendarProperty=function(e,t,a){var n=s[e];this.type=n&&n.type?n.type:"TEXT",this.name=e,this.value=t,this.parameters=a||{}};o.prototype.clone=function(){var e=new o(this.name,this.value);for(var t in e.type=this.type,this.parameters)e.parameters[t]=this.parameters[t];return e},o.prototype.getParameter=function(e){return this.parameters[e]},o.prototype.setParameter=function(e,t){this.parameters[e]=t},o.prototype.format=function(){var t=[];for(var a in this.parameters)t.push(a+"="+this.parameters[a]);t.length&&(t=";"+t.join(";"));for(var i,s=new e(this.name+t+":"+n(this.type,this.value,this.parameters)),r=0,o=[];;){for(r+(i=75)>=s.length&&(i=s.length-r);128==(192&s[r+i]);)i--;if(o.push(s.toString("utf8",r,r+i)),r+i>=s.length)break;s[r+=i-1]=32}return o}}).call(this,a(196).Buffer)},function(e,t,a){var n;try{n={clone:a(485),constant:a(314),each:a(315),filter:a(319),has:a(329),isArray:a(122),isEmpty:a(500),isFunction:a(242),isUndefined:a(332),keys:a(172),map:a(333),reduce:a(335),size:a(504),transform:a(510),union:a(513),values:a(340)}}catch(e){}n||(n=window._),e.exports=n},,,function(e,t,a){var n;try{n=a(483)}catch(e){}n||(n=window.graphlib),e.exports=n},function(e,t,a){e.exports=a(23)(210)},,function(e,t,a){"use strict";a.d(t,"k",(function(){return h})),a.d(t,"i",(function(){return j})),a.d(t,"j",(function(){return x})),a.d(t,"g",(function(){return v})),a.d(t,"h",(function(){return y})),a.d(t,"f",(function(){return O})),a.d(t,"m",(function(){return E})),a.d(t,"b",(function(){return M})),a.d(t,"c",(function(){return S})),a.d(t,"l",(function(){return _})),a.d(t,"d",(function(){return T})),a.d(t,"e",(function(){return C})),a.d(t,"a",(function(){return I}));var n=a(8),i=a(2),s=a(83),r=a(77),o=a(26),l=a(73),c=a(98),d=a(96),u=a(18),p=a(295),m=a(29),b=a(296),f=a(6);function h(e){return new Promise(((t,a)=>{l.ml.jobs.jobs([e]).then((a=>{if(!a.length)throw new Error(`Could not find job ${e}`);t(a[0])})).catch((e=>{a(e)}))}))}function g(e){return new Promise(((t,a)=>{l.ml.jobs.jobForCloning(e).then((a=>{if(!a)throw new Error(`Could not find job ${e}`);t(a)})).catch((e=>{a(e)}))}))}function j(e){return e.some((e=>e.datafeedState===u.a.STOPPED&&e.jobState!==u.c.CLOSING))}function x(e){return e.some((e=>e.datafeedState===u.a.STARTED||e.datafeedState===u.a.STARTING))}function v(e){return e.some((e=>e.datafeedState===u.a.STOPPED&&e.jobState!==u.c.CLOSED&&e.jobState!==u.c.CLOSING))}function y(e){return e.some((e=>{var t;return e.jobState===u.c.CLOSED||(null===(t=e.blocked)||void 0===t?void 0:t.reason)===p.a.RESET}))}function O(e,t,a,n=(()=>{})){const r=e.filter((e=>e.hasDatafeed)).map((e=>e.datafeedId));s.a.forceStartDatafeeds(r,t,a).then((e=>{w(e,u.a.STARTED),n()})).catch((e=>{Object(o.l)().addDanger(i.i18n.translate("xpack.ml.jobsList.startJobErrorMessage",{defaultMessage:"Jobs failed to start"}),e),n()}))}function E(e,t=(()=>{})){const a=e.filter((e=>e.hasDatafeed)).map((e=>e.datafeedId));s.a.stopDatafeeds(a).then((e=>{w(e,u.a.STOPPED),t()})).catch((e=>{Object(o.l)().addDanger(i.i18n.translate("xpack.ml.jobsList.stopJobErrorMessage",{defaultMessage:"Jobs failed to stop"}),e),t()}))}function w(e,t){const a=[],n=[];for(const i in e)!0===e[i][t]||!1===e[i][t]&&409===e[i].error.statusCode&&t===u.a.STARTED?a.push(i):n.push({id:i,result:e[i]});let s="",l="";t===u.a.STARTED?(s=i.i18n.translate("xpack.ml.jobsList.startActionStatusText",{defaultMessage:"start"}),l=i.i18n.translate("xpack.ml.jobsList.startedActionStatusText",{defaultMessage:"started"})):t===u.a.STOPPED?(s=i.i18n.translate("xpack.ml.jobsList.stopActionStatusText",{defaultMessage:"stop"}),l=i.i18n.translate("xpack.ml.jobsList.stoppedActionStatusText",{defaultMessage:"stopped"})):t===u.a.DELETED?(s=i.i18n.translate("xpack.ml.jobsList.deleteActionStatusText",{defaultMessage:"delete"}),l=i.i18n.translate("xpack.ml.jobsList.deletedActionStatusText",{defaultMessage:"deleted"})):t===u.c.CLOSED?(s=i.i18n.translate("xpack.ml.jobsList.closeActionStatusText",{defaultMessage:"close"}),l=i.i18n.translate("xpack.ml.jobsList.closedActionStatusText",{defaultMessage:"closed"})):t===p.a.RESET&&(s=i.i18n.translate("xpack.ml.jobsList.resetActionStatusText",{defaultMessage:"reset"}),l=i.i18n.translate("xpack.ml.jobsList.resetActionStatusText",{defaultMessage:"reset"}));const c=Object(o.l)();c.addSuccess(i.i18n.translate("xpack.ml.jobsList.actionExecuteSuccessfullyNotificationMessage",{defaultMessage:"{successesJobsCount, plural, one{{successJob}} other{# jobs}} {actionTextPT} successfully",values:{successesJobsCount:a.length,successJob:a[0],actionTextPT:l}})),n.length>0&&n.forEach((e=>{Object(r.b)(c).displayErrorToast(e.result.error,i.i18n.translate("xpack.ml.jobsList.actionFailedNotificationMessage",{defaultMessage:"{failureId} failed to {actionText}",values:{failureId:e.id,actionText:s}}))}))}async function M(e){try{var t;const[{job:n,datafeed:o},l]=await Promise.all([g(e),h(e)]),c=await Object(d.e)(),u=o.indices.join(",");if(!1===c.includes(u)){const t=i.i18n.translate("xpack.ml.jobsList.managementActions.noSourceDataViewForClone",{defaultMessage:"Unable to clone the anomaly detection job {jobId}. No data view exists for index {dataViewTitle}.",values:{jobId:e,dataViewTitle:u}});return void Object(r.a)().displayDangerToast(t,{"data-test-subj":"mlCloneJobNoDataViewExistsWarningToast"})}var a;if(void 0!==n&&void 0!==(null==l||null===(t=l.custom_settings)||void 0===t?void 0:t.created_by)){if(s.a.tempJobCloningObjects.createdBy=null==l||null===(a=l.custom_settings)||void 0===a?void 0:a.created_by,s.a.tempJobCloningObjects.job=n,void 0!==l.data_counts.earliest_record_timestamp&&void 0!==l.data_counts.latest_record_timestamp&&void 0!==l.data_counts.latest_bucket_timestamp){let e=l.data_counts.earliest_record_timestamp,t=l.data_counts.latest_record_timestamp;if(void 0!==l.datafeed_config.aggregations){const a=Object(m.a)(l.analysis_config.bucket_span).asMilliseconds();e=Math.floor(l.data_counts.earliest_record_timestamp/a)*a,t=l.data_counts.latest_bucket_timestamp+2*a-1}s.a.tempJobCloningObjects.start=e,s.a.tempJobCloningObjects.end=t}}else s.a.tempJobCloningObjects.job=n,s.a.tempJobCloningObjects.createdBy=void 0;void 0!==o&&(s.a.tempJobCloningObjects.datafeed=o),l.calendars&&(s.a.tempJobCloningObjects.calendars=await b.a.fetchCalendarsByIds(l.calendars)),window.location.href="#/jobs/new_job"}catch(t){Object(r.a)().displayErrorToast(t,i.i18n.translate("xpack.ml.jobsList.cloneJobErrorMessage",{defaultMessage:"Could not clone {jobId}. Job could not be found",values:{jobId:e}}))}}function S(e,t=(()=>{})){const a=e.map((e=>e.id));s.a.closeJobs(a).then((e=>{w(e,u.c.CLOSED),t()})).catch((e=>{Object(r.a)().displayErrorToast(e,i.i18n.translate("xpack.ml.jobsList.closeJobErrorMessage",{defaultMessage:"Jobs failed to close"})),t()}))}function _(e,t=(()=>{})){s.a.resetJobs(e).then((e=>{w(e,p.a.RESET),t()})).catch((e=>{Object(r.a)().displayErrorToast(e,i.i18n.translate("xpack.ml.jobsList.resetJobErrorMessage",{defaultMessage:"Jobs failed to reset"})),t()}))}function T(e,t=(()=>{})){const a=e.map((e=>e.id));s.a.deleteJobs(a).then((e=>{w(e,u.c.DELETED),t()})).catch((e=>{Object(r.a)().displayErrorToast(e,i.i18n.translate("xpack.ml.jobsList.deleteJobErrorMessage",{defaultMessage:"Jobs failed to delete"})),t()}))}function C(e,t){if(0===t.length)return e;const a=e.reduce(((e,t)=>(e[t.id]={job:t,count:0},e)),{});t.forEach((t=>{const n="must"===t.match;let i=[];"term"===t.type?i=!0===n?e.filter((e=>Object(c.f)(e.id,t.value)===n||Object(c.f)(e.description,t.value)===n||Object(c.f)(e.memory_status,t.value)===n)):e.filter((e=>Object(c.f)(e.id,t.value)===n&&Object(c.f)(e.description,t.value)===n&&Object(c.f)(e.memory_status,t.value)===n)):Array.isArray(t.value)?"id"===t.field?i=e.filter((e=>t.value.indexOf(k(e,t.field))>=0)):"groups"===t.field?i=e.filter((e=>k(e,t.field).some((e=>t.value.indexOf(e)>=0)))):"job_tags"===t.field&&(i=F(e,t.value)):i="job_tags"===t.field?i=F(e,[t.value]):e.filter((e=>k(e,t.field)===t.value)),i.forEach((e=>a[e.id].count++))}));const i=[];return Object(n.each)(a,(e=>{e.count>=t.length&&i.push(e.job)})),i}function k(e,t){return e[{job_state:"jobState",datafeed_state:"datafeedState",groups:"groups",id:"id",job_tags:"jobTags"}[t]]}function F(e,t){return e.filter((e=>{const a=k(e,"job_tags");return Object.entries(a).map((e=>e.join(":"))).find((e=>t.some((t=>t===e))))}))}function I(){const e=s.a.tempJobCloningObjects.job,t=s.a.tempJobCloningObjects.datafeed;if(void 0!==e){s.a.tempJobCloningObjects.job=void 0,s.a.tempJobCloningObjects.datafeed=void 0,s.a.tempJobCloningObjects.createdBy=void 0;const a=Object(f.b)(t),n=a?t.datafeed_id:"";return{id:e.job_id,hasDatafeed:a,latestTimestampSortValue:0,datafeedId:n}}}},,function(e,t,a){"use strict";a.d(t,"d",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"c",(function(){return c})),a.d(t,"b",(function(){return d}));var n=a(57),i=a(100),s=a(110),r=a(182);function o(){const e=Object(r.a)().get("theme:darkMode")?n.euiDarkVars:n.euiLightVars;return{LINE_COLOR:e.euiColorPrimary,MODEL_COLOR:e.euiColorPrimary,EVENT_RATE_COLOR:e.euiColorPrimary,EVENT_RATE_COLOR_WITH_ANOMALIES:e.euiColorLightShade}}const l={width:"100%",height:"300px",cols:1,intervalMs:0},c={line:{strokeWidth:2,visible:!0,opacity:1},border:{visible:!1,strokeWidth:0},point:{visible:!1,radius:2,strokeWidth:4,opacity:.5},area:{opacity:.25,visible:!1}};function d(e,t){const a={...l,intervalMs:t.getInterval().asMilliseconds()};if(Object(i.d)(e)){const e=Object(s.c)();e.setInterval("auto"),e.setBounds(t.getBounds()),a.intervalMs=e.getInterval().asMilliseconds()}return a.intervalMs<e.bucketSpanMs&&(a.intervalMs=e.bucketSpanMs),(Object(i.c)(e)||Object(i.d)(e))&&(e.aggFieldPairs.length>2&&Object(i.c)(e)?(a.cols=3,a.height="150px",a.intervalMs=3*a.intervalMs):e.aggFieldPairs.length>1&&(a.cols=2,a.height="200px",a.intervalMs=2*a.intervalMs)),a}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d})),a.d(t,"c",(function(){return u})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return m})),a.d(t,"d",(function(){return b}));var n=a(76),i=a(137),s=a(20),r=a(74),o=a(106),l=a(90);let c;!function(e){e.regression="100mb",e.outlier_detection="50mb",e.classification="100mb"}(c||(c={}));const d=0,u="--",p=()=>({advancedEditorMessages:[],advancedEditorRawString:"",disableSwitchToForm:!1,form:{alpha:void 0,computeFeatureInfluence:"true",createIndexPattern:!0,classAssignmentObjective:void 0,dependentVariable:"",description:"",destinationIndex:"",destinationIndexNameExists:!1,destinationIndexNameEmpty:!0,destinationIndexNameValid:!1,destinationIndexPatternTitleExists:!1,earlyStoppingEnabled:void 0,downsampleFactor:void 0,eta:void 0,etaGrowthRatePerTree:void 0,featureBagFraction:void 0,featureInfluenceThreshold:void 0,featureProcessors:void 0,gamma:void 0,includes:[],jobId:"",jobIdExists:!1,jobIdEmpty:!0,jobIdInvalidMaxLength:!1,jobIdValid:!1,jobType:void 0,jobConfigQuery:r.l,jobConfigQueryString:void 0,jobConfigQueryLanguage:void 0,lambda:void 0,lossFunction:void 0,lossFunctionParameter:void 0,loadingFieldOptions:!1,maxNumThreads:1,maxOptimizationRoundsPerHyperparameter:void 0,maxTrees:void 0,method:void 0,modelMemoryLimit:void 0,modelMemoryLimitUnitValid:!0,modelMemoryLimitValidationResult:null,nNeighbors:void 0,numTopFeatureImportanceValues:d,numTopFeatureImportanceValuesValid:!0,numTopClasses:-1,outlierFraction:void 0,predictionFieldName:void 0,previousJobType:null,requiredFieldsError:void 0,randomizeSeed:void 0,resultsField:void 0,runtimeMappings:void 0,runtimeMappingsUpdated:!1,previousRuntimeMapping:void 0,softTreeDepthLimit:void 0,softTreeDepthTolerance:void 0,sourceIndex:"",sourceIndexNameEmpty:!0,sourceIndexNameValid:!1,sourceIndexContainsNumericalFields:!0,sourceIndexFieldsCheckFailed:!1,standardizationEnabled:"true",trainingPercent:80,useEstimatedMml:!0},jobConfig:{},disabled:!Object(i.c)()||!Object(n.e)("canCreateDataFrameAnalytics")||!Object(n.e)("canStartStopDataFrameAnalytics"),indexPatternsMap:{},isAdvancedEditorEnabled:!1,isAdvancedEditorValidJson:!0,hasSwitchedToEditor:!1,isJobCreated:!1,isJobStarted:!1,isValid:!1,jobIds:[],requestMessages:[],estimatedModelMemoryLimit:""}),m=e=>{const t={description:e.description,source:{index:e.sourceIndex.includes(",")?e.sourceIndex.split(",").map((e=>e.trim())):e.sourceIndex,query:e.jobConfigQuery,...Object(s.b)(e.runtimeMappings)?{runtime_mappings:e.runtimeMappings}:{}},dest:{index:e.destinationIndex},analyzed_fields:{includes:e.includes},analysis:{outlier_detection:{}},model_memory_limit:e.modelMemoryLimit};void 0!==e.maxNumThreads&&(t.max_num_threads=e.maxNumThreads);const a="string"==typeof(null==e?void 0:e.resultsField)&&""===(null==e?void 0:e.resultsField.trim());if(t.dest&&!a&&(t.dest.results_field=e.resultsField),e.jobType===l.a.REGRESSION||e.jobType===l.a.CLASSIFICATION){let a={dependent_variable:e.dependentVariable,num_top_feature_importance_values:e.numTopFeatureImportanceValues,training_percent:e.trainingPercent};a=Object.assign(a,e.alpha&&{alpha:e.alpha},e.eta&&{eta:e.eta},e.etaGrowthRatePerTree&&{eta_growth_rate_per_tree:e.etaGrowthRatePerTree},e.downsampleFactor&&{downsample_factor:e.downsampleFactor},e.featureBagFraction&&{feature_bag_fraction:e.featureBagFraction},e.featureProcessors&&{feature_processors:e.featureProcessors},e.gamma&&{gamma:e.gamma},e.lambda&&{lambda:e.lambda},e.lossFunction&&{loss_function:e.lossFunction},e.lossFunctionParameter&&{loss_function_parameter:e.lossFunctionParameter},e.maxOptimizationRoundsPerHyperparameter&&{max_optimization_rounds_per_hyperparameter:e.maxOptimizationRoundsPerHyperparameter},e.maxTrees&&{max_trees:e.maxTrees},e.randomizeSeed&&{randomize_seed:e.randomizeSeed},void 0!==e.earlyStoppingEnabled&&{early_stopping_enabled:e.earlyStoppingEnabled},e.predictionFieldName&&{prediction_field_name:e.predictionFieldName},e.randomizeSeed&&{randomize_seed:e.randomizeSeed},e.softTreeDepthLimit&&{soft_tree_depth_limit:e.softTreeDepthLimit},e.softTreeDepthTolerance&&{soft_tree_depth_tolerance:e.softTreeDepthTolerance}),t.analysis={[e.jobType]:a}}if(void 0!==(null==t?void 0:t.analysis)&&Object(o.f)(null==t?void 0:t.analysis)&&(void 0!==e.numTopClasses&&(t.analysis.classification.num_top_classes=e.numTopClasses),void 0!==e.classAssignmentObjective&&(t.analysis.classification.class_assignment_objective=e.classAssignmentObjective)),e.jobType===l.a.OUTLIER_DETECTION){const a=Object.assign({},void 0!==e.computeFeatureInfluence&&{compute_feature_influence:e.computeFeatureInfluence},e.method&&{method:e.method},e.nNeighbors&&{n_neighbors:e.nNeighbors},e.outlierFraction&&{outlier_fraction:e.outlierFraction},e.featureInfluenceThreshold&&{feature_influence_threshold:e.featureInfluenceThreshold},void 0!==e.standardizationEnabled&&{standardization_enabled:e.standardizationEnabled});t.analysis.outlier_detection=a}return t};function b(e,t=!0){var a,n,i;const s=Object(r.m)(e.analysis),o={jobType:s,description:null!==(a=e.description)&&void 0!==a?a:"",resultsField:e.dest.results_field,sourceIndex:Array.isArray(e.source.index)?e.source.index.join(","):e.source.index,runtimeMappings:e.source.runtime_mappings,modelMemoryLimit:e.model_memory_limit,maxNumThreads:e.max_num_threads,includes:null!==(n=null===(i=e.analyzed_fields)||void 0===i?void 0:i.includes)&&void 0!==n?n:[],jobConfigQuery:e.source.query||r.l};var l;!1===t&&(o.destinationIndex=null!==(l=null==e?void 0:e.dest.index)&&void 0!==l?l:"");const c=e.analysis[s];for(const e in c)if(c.hasOwnProperty(e)){o[e.replace(/_([a-z])/g,(function(e){return e[1].toUpperCase()}))]=c[e]}return o}},,,,,,,function(e,t,a){var n=a(490),i=a(493),s=a(202),r=a(122),o=a(497);e.exports=function(e){return"function"==typeof e?e:null==e?s:"object"==typeof e?r(e)?i(e[0],e[1]):n(e):o(e)}},,,function(e,t,a){"use strict";var n=a(95);a.d(t,"a",(function(){return n.c})),a.d(t,"c",(function(){return n.e})),a.d(t,"b",(function(){return n.d})),a.d(t,"d",(function(){return n.f}))},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return s}));a(16);var n=a(188),i=a(12);const s={TEXT:"text",JSON:"json",XJSON:new n.b},r=({value:e,height:t="500px",width:a="100%",mode:r=s.JSON,readOnly:o=!1,syntaxChecking:l=!0,theme:c="textmate",onChange:d=(()=>{})})=>{if(r===s.XJSON)try{e=Object(n.d)(e)}catch(e){console.error(e)}return Object(i.jsx)(n.a,{value:e,width:a,height:t,mode:r,readOnly:o,wrapEnabled:!0,showPrintMargin:!1,theme:c,editorProps:{$blockScrolling:!0},setOptions:{useWorker:l,tabSize:2,useSoftTabs:!0},onChange:d})}},,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return l})),a.d(t,"a",(function(){return AnnotationUpdatesService}));var n=a(5),i=a.n(n),s=a(25),r=a(28);new s.BehaviorSubject(null);const o=new s.BehaviorSubject(Date.now()),l=()=>o.next(Date.now());class AnnotationUpdatesService{constructor(){i()(this,"_annotation$",new s.BehaviorSubject(null))}update$(){return this._annotation$.asObservable()}isAnnotationInitialized$(){return this._annotation$.asObservable().pipe(Object(r.distinctUntilChanged)(((e,t)=>null!==e&&null!==t)))}setValue(e){this._annotation$.next(e)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(16),i=a(144);const s=Object(n.createContext)(new i.a)},function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a(120),i=a(80);function s(){return{job_id:"",description:"",groups:[],analysis_config:{bucket_span:"",detectors:[],influencers:[]},data_description:{time_field:""}}}function r(e){return{datafeed_id:"",job_id:"",indices:Object(i.t)(e),query:{}}}function o(e,t){const a={function:e.id};return t.id!==n.a&&(a.field_name=t.id),a}},function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"a",(function(){return o}));var n=a(2),i=a(30),s=a(92);function r(e,t,a,r){const l=Object(s.d)();if(e.contains("job_id_empty"))t.jobId.valid=!1;else if(e.contains("job_id_invalid")){t.jobId.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobNameAllowedCharactersDescription",{defaultMessage:"Job ID can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"});t.jobId.message=e}else if(e.contains("job_id_invalid_max_length"))t.jobId.valid=!1,t.jobId.message=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:i.b}});else if(e.contains("job_id_already_exists")){t.jobId.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobNameAlreadyExists",{defaultMessage:"Job ID already exists. A job ID cannot be the same as an existing job or group."});t.jobId.message=e}if(e.contains("job_group_id_invalid")){t.groupIds.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobGroupAllowedCharactersDescription",{defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"});t.groupIds.message=e}else if(e.contains("job_group_id_invalid_max_length"))t.groupIds.valid=!1,t.groupIds.message=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.jobGroupMaxLengthDescription",{defaultMessage:"Job group name must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:i.b}});else if(e.contains("job_group_id_already_exists")){t.groupIds.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.groupNameAlreadyExists",{defaultMessage:"Group ID already exists. A group ID cannot be the same as an existing job or group."});t.groupIds.message=e}if(e.contains("model_memory_limit_units_invalid")){t.modelMemoryLimit.valid=!1;const e=`${i.a.slice(0,i.a.length-1).join(", ")} or ${[...i.a].pop()}`,a=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.modelMemoryLimitUnitsInvalidErrorMessage",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:e}});t.modelMemoryLimit.message=a}if(e.contains("model_memory_limit_invalid")){t.modelMemoryLimit.valid=!1;const e=(l.max_model_memory_limit||"").toUpperCase(),a=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.modelMemoryLimitRangeInvalidErrorMessage",{defaultMessage:"Model memory limit cannot be higher than the maximum value of {maxModelMemoryLimit}",values:{maxModelMemoryLimit:e}});t.modelMemoryLimit.message=a}if(e.contains("detectors_duplicates")){t.duplicateDetectors.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.duplicatedDetectorsErrorMessage",{defaultMessage:"Duplicate detectors were found."});t.duplicateDetectors.message=e}if(e.contains("categorizer_detector_missing_per_partition_field")){t.categorizerMissingPerPartition.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.categorizerMissingPerPartitionFieldMessage",{defaultMessage:'Partition field must be set for detectors that reference "mlcategory" when per-partition categorization is enabled.'});t.categorizerMissingPerPartition.message=e}if(e.contains("categorizer_varying_per_partition_fields")){t.categorizerVaryingPerPartitionField.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.categorizerVaryingPerPartitionFieldNamesMessage",{defaultMessage:'Detectors with keyword "mlcategory" cannot have different partition_field_name when per-partition categorization is enabled.'});t.categorizerVaryingPerPartitionField.message=e}if(e.contains("bucket_span_empty")){t.bucketSpan.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.bucketSpanMustBeSetErrorMessage",{defaultMessage:"Bucket span must be set"});t.bucketSpan.message=e}else e.contains("bucket_span_invalid")&&(t.bucketSpan.valid=!1,t.bucketSpan.message=o(a.analysis_config.bucket_span));if(e.contains("query_empty")){t.query.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.queryCannotBeEmpty",{defaultMessage:"Datafeed query cannot be empty."});t.query.message=e}else if(e.contains("query_invalid")){t.query.valid=!1;const e=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.queryIsInvalidEsQuery",{defaultMessage:"Datafeed query must be a valid elasticsearch query."});t.query.message=e}e.contains("query_delay_invalid")&&(t.queryDelay.valid=!1,t.queryDelay.message=o(r.query_delay)),e.contains("frequency_invalid")&&(t.frequency.valid=!1,t.frequency.message=o(r.frequency)),e.contains("missing_summary_count_field_name")&&(t.summaryCountField.valid=!1,t.summaryCountField.message=n.i18n.translate("xpack.ml.newJob.wizard.validateJob.summaryCountFieldMissing",{defaultMessage:"Required field as the datafeed uses aggregations."}))}function o(e){return n.i18n.translate("xpack.ml.newJob.wizard.validateJob.frequencyInvalidTimeIntervalFormatErrorMessage",{defaultMessage:"{value} is not a valid time interval format e.g. {thirtySeconds}, {tenMinutes}, {oneHour}, {sevenDays}. It also needs to be higher than zero.",values:{value:e,thirtySeconds:"30s",tenMinutes:"10m",oneHour:"1h",sevenDays:"7d"}})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));var n=a(44),i=a(45),s=a(16),r=a.n(s),o=a(12);const l=({jobsCount:e,action:t,message:a})=>Object(o.jsx)(r.a.Fragment,null,Object(o.jsx)(n.EuiSpacer,{size:"s"}),Object(o.jsx)(n.EuiCallOut,{color:"warning"},null!=a?a:Object(o.jsx)(i.FormattedMessage,{id:"xpack.ml.managedJobsWarningCallout",defaultMessage:"{jobsCount, plural, one {This job} other {At least one of these jobs}} is preconfigured by Elastic; {action} {jobsCount, plural, one {it} other {them}} might impact other parts of the product.",values:{jobsCount:e,action:t}})))},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(131),i=a.n(n),s=a(25),r=a(28),o=a(16),l=a(144),c=a(187),d=a(72);const u=()=>{const e=Object(d.g)(),t=()=>{const{from:t,to:a}=e.getTime();return{start:t,end:a}},a=Object(o.useMemo)((()=>Object(s.merge)(c.a,e.getTimeUpdate$().pipe(Object(r.map)((()=>({lastRefresh:Date.now(),timeRange:t()})))),l.b.pipe(Object(r.map)((e=>({lastRefresh:e})))))),[]);return i()(a)}},,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(57),i=a(10);const s=[n.euiDarkVars.euiColorVis0,n.euiDarkVars.euiColorVis1,n.euiDarkVars.euiColorVis2,n.euiDarkVars.euiColorVis3,n.euiDarkVars.euiColorVis4,n.euiDarkVars.euiColorVis5,n.euiDarkVars.euiColorVis6,n.euiDarkVars.euiColorVis7,n.euiDarkVars.euiColorVis8,n.euiDarkVars.euiColorVis9,n.euiDarkVars.euiColorDarkShade,n.euiDarkVars.euiColorPrimary],r={};function o(e){if(void 0===r[e]){const t=Object(i.d)(e),a=s[t%s.length];return r[e]=a,a}return r[e]}},function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r})),a.d(t,"c",(function(){return o}));var n=a(2),i=a(304);const s=5;let r;!function(e){e.VALID="valid",e.PARTIALLY_VALID="partially_valid",e.INVALID="invalid"}(r||(r={}));const o={[i.a.NO_EXAMPLES]:n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNoDataFound",{defaultMessage:"Examples  were successfully loaded."}),[i.a.FAILED_TO_TOKENIZE]:n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validFailureToGetTokens",{defaultMessage:"The examples loaded were tokenized successfully."}),[i.a.TOKEN_COUNT]:n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTokenLength",{defaultMessage:"More than {tokenCount} tokens per example were found in over {percentage}% of the examples loaded.",values:{percentage:Math.floor(75),tokenCount:3}}),[i.a.MEDIAN_LINE_LENGTH]:n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validMedianLineLength",{defaultMessage:"The median line length of the examples loaded was less than {medianCharCount} characters.",values:{medianCharCount:400}}),[i.a.NULL_VALUES]:n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validNullValues",{defaultMessage:"Less than {percentage}% of the examples loaded were null.",values:{percentage:Math.floor(25)}}),[i.a.TOO_MANY_TOKENS]:n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validTooManyTokens",{defaultMessage:"Less than 10000 tokens were found in total in the examples loaded."}),[i.a.INSUFFICIENT_PRIVILEGES]:n.i18n.translate("xpack.ml.models.jobService.categorization.messages.validUserPrivileges",{defaultMessage:"The user has sufficient privileges to perform the checks."})}},function(e,t,a){"use strict";a.d(t,"e",(function(){return d})),a.d(t,"a",(function(){return u})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return f})),a.d(t,"c",(function(){return h}));var n=a(8),i=a(24),s=a.n(i),r=a(59),o=a.n(r),l=a(29),c=a(98);function d(e,t,a,n){const i=e.url_value,r=a[n],o="time_range"in e&&e.time_range?Object(l.a)(e.time_range):null,c={...a};if(i.includes("$earliest$")){const e=s()(r);null!==o?e.subtract(o):e.subtract(t,"s"),c.earliest=e.toISOString()}if(i.includes("$latest$")){const e=s()(r).add(t,"s");null!==o?e.add(o):e.add(t,"s"),c.latest=e.toISOString()}return u(e,c)}function u(e,t){if(!0===m(e))return function(e,t){const a=e.url_value,i=a.includes("language:lucene"),s=i?c.c:b,r=Object(n.flow)(encodeURIComponent),l=e=>{const a=Object(n.flow)(i?e=>e:s,r);return e.replace(/\$([^?&$\'"]+)\$(\/)?/g,((e,i,s="")=>{let r=Object(n.get)(t,i);return r=Array.isArray(r)?r[0]:r,void 0===r?"":a(r)+s}))};return Object(n.flow)(decodeURIComponent,(e=>e.replace("$earliest$",t.earliest).replace("$latest$",t.latest)),(e=>{const a=Object(n.flow)(s,r),i=((e,t)=>(a,i,s,r)=>{let o=2e3-a.length-s.length;const l=i.split(/\sand\s/i).map((e=>(e=>{let t="";for(let a=0;a<e.length;a++)if("$"===e[a]){let n=a;for(let t=n;t>-1;t--)if(":"===e[t]){n=t;break}t=e.slice(0,n).trim();let i=e.slice(n,e.length);const s=i.indexOf("$"),r=i.lastIndexOf("$");if(i=i.slice(s,r+1),i===`$${t}$`)break}return t})(String(e).replace(/\\/g,"")))),d=[],u=" AND ";e:for(let a=0;a<l.length;a++){const i=l[a],s=r?`"${l[a]}"`:Object(c.c)(i);let u=Object(n.get)(e,i)||null;if(null===u)continue;u=Array.isArray(u)?u:[u];let p="";for(let e=0;e<u.length;e++){const a=`${e>0?" OR ":""}${s}:"${t(u[e])}"`;if(o<a.length){p.length>0&&d.push(e>0?`(${p})`:p);break e}p+=a,o-=p.length}p.length>0&&d.push(u.length>1?`(${p})`:p)}return d.join(u)})(t,a),d=e.match(/(.+)(\(.*\blanguage:(?:lucene|kuery)\b.*?\))(.+)/);if(null!==d&&void 0!==d[2]){const[,e,t,a]=d,n=t.indexOf("language:kuery")>-1,s=o.a.decode(t);if(null!==(u=s)&&"object"==typeof u&&s.hasOwnProperty("query")){const[t,r]=[e,a].map(l),c=i(t,s.query,r,n);return`${t}${o.a.encode({...s,query:c})}${r}`}}var u;return e.replace(/(.+&kuery=)(.*?)[^!](&.+)/,((t,a,n,s)=>{const[r,o]=[a,s].map(l);return`${r}${i(r,n,o,e.indexOf("language:kuery")>-1)}${o}`}))}),l)(a)}(e,t);return Object(c.e)(e.url_value,t,!1)}function p(e,t,a){if(!1===/^(?:[a-z]+:)?\/\//i.test(t.url_value))"/"!==e.charAt(0)&&(e=`${a}${m(t)?"/app/":"/"}${e}`),window.open(e,"_blank");else{const t=window.open(e,"_blank","noopener,noreferrer");null!=t&&(t.opener=null)}}function m(e){const t=e.url_value;return t.startsWith("discover#/")||t.startsWith("dashboards#/")||t.startsWith("apm#/")||t.startsWith("metrics/")||t.startsWith("security/")||t.startsWith("siem#/")}function b(e){return String(e).replace(/\"/g,'\\"')}function f(e,t){let a=void 0!==e&&e.trim().length>0;if(!0===a&&void 0!==t){a=!t.map((e=>e.url_name)).includes(e)}return a}function h(e){if(void 0===e||0===e.length||"auto"===e)return!0;return null!==Object(l.a)(e)}},function(e,t,a){"use strict";a.d(t,"d",(function(){return f})),a.d(t,"c",(function(){return h})),a.d(t,"b",(function(){return g})),a.d(t,"e",(function(){return j})),a.d(t,"a",(function(){return x}));var n=a(44),i=a(16),s=a.n(i),r=a(8),o=a(2),l=a(81),c=a(74),d=a(90),u=a(72),p=a(405),m=a(27),b=a(12);function f(e,t=(e=>({allow_lazy_start:{optional:!0,defaultValue:!1},description:{optional:!0,formKey:"description"},analysis:{...Object(c.v)(e.analysis)?{classification:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},num_top_classes:{optional:!0,defaultValue:2,formKey:"numTopClasses"},prediction_field_name:{optional:!0,defaultValue:`${e.analysis.classification.dependent_variable}_prediction`,formKey:"predictionFieldName"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},num_top_feature_importance_values:{optional:!0,defaultValue:p.a,formKey:"numTopFeatureImportanceValues"},class_assignment_objective:{optional:!0,defaultValue:"maximize_minimum_recall"},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},feature_processors:{optional:!0},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{},...Object(l.r)(e.analysis)?{outlier_detection:{standardization_enabled:{defaultValue:!0,optional:!0,formKey:"standardizationEnabled"},compute_feature_influence:{defaultValue:!0,optional:!0,formKey:"computeFeatureInfluence"},outlier_fraction:{defaultValue:.05,optional:!0,formKey:"outlierFraction"},feature_influence_threshold:{optional:!0,formKey:"featureInfluenceThreshold"},method:{optional:!0,formKey:"method"},n_neighbors:{optional:!0,formKey:"nNeighbors"}}}:{},...Object(c.y)(e.analysis)?{regression:{dependent_variable:{optional:!1,formKey:"dependentVariable"},training_percent:{optional:!0,formKey:"trainingPercent"},eta:{optional:!0,formKey:"eta"},feature_bag_fraction:{optional:!0,formKey:"featureBagFraction"},max_trees:{optional:!0,formKey:"maxTrees"},gamma:{optional:!0,formKey:"gamma"},lambda:{optional:!0,formKey:"lambda"},prediction_field_name:{optional:!0,defaultValue:`${e.analysis.regression.dependent_variable}_prediction`,formKey:"predictionFieldName"},num_top_feature_importance_values:{optional:!0,defaultValue:p.a,formKey:"numTopFeatureImportanceValues"},randomize_seed:{optional:!0,ignore:!0,formKey:"randomizeSeed"},loss_function:{optional:!0,defaultValue:"mse"},loss_function_parameter:{optional:!0},feature_processors:{optional:!0},early_stopping_enabled:{optional:!0,ignore:!0},alpha:{optional:!0,formKey:"alpha"},downsample_factor:{optional:!0,formKey:"downsampleFactor"},eta_growth_rate_per_tree:{optional:!0,formKey:"etaGrowthRatePerTree"},max_optimization_rounds_per_hyperparameter:{optional:!0,formKey:"maxOptimizationRoundsPerHyperparameter"},soft_tree_depth_limit:{optional:!0,formKey:"softTreeDepthLimit"},soft_tree_depth_tolerance:{optional:!0,formKey:"softTreeDepthTolerance"}}}:{}},analyzed_fields:{excludes:{optional:!0,defaultValue:[]},includes:{optional:!0,formKey:"includes",defaultValue:[]}},source:{index:{formKey:"sourceIndex",optional:!1},query:{optional:!0,defaultValue:{match_all:{}}},runtime_mappings:{optional:!0,formKey:"runtimeMappings",defaultValue:void 0},_source:{optional:!0}},dest:{index:{optional:!1,formKey:"destinationIndex"},results_field:{optional:!0,formKey:"resultsField",defaultValue:d.d}},model_memory_limit:{optional:!0,formKey:"modelMemoryLimit"},max_num_threads:{optional:!0,formKey:"maxNumThreads"}}))(e)){for(const a in e)if(e.hasOwnProperty(a)){const n=e[a],i=t[a];if(!i)return console.info(`Property "${a}" is unknown.`),!0;if(i.hasOwnProperty("optional")){if(void 0===i.formKey&&!0!==i.ignore&&!Object(r.isEqual)(i.defaultValue,n))return console.info(`Property "${a}" is not supported by the form or has a different value to the default.`),!0}else if(f(n,i))return!0}return!1}function h({id:e,...t}){return Object(r.cloneDeep)({...t,dest:{...t.dest,index:""}})}const g=o.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionNameText",{defaultMessage:"Clone"}),j=()=>{const{services:{notifications:{toasts:e},data:{dataViews:t}}}=Object(u.b)(),a=Object(u.e)();return async n=>{const i=Array.isArray(n.config.source.index)?n.config.source.index.join(","):n.config.source.index;let s;try{const a=(await t.find(i)).find((({title:e})=>e===i));void 0!==a?s=a.id:e.addDanger(o.i18n.translate("xpack.ml.dataframe.analyticsList.noSourceDataViewForClone",{defaultMessage:"Unable to clone the analytics job. No data view exists for index {dataView}.",values:{dataView:i}}))}catch(t){const a=Object(m.b)(t);e.addDanger(o.i18n.translate("xpack.ml.dataframe.analyticsList.fetchSourceDataViewForCloneErrorMessage",{defaultMessage:"An error occurred checking if data view {dataView} exists: {error}",values:{dataView:i,error:a}}))}s&&await a(`/data_frame_analytics/new_job?index=${encodeURIComponent(s)}&jobId=${n.config.id}`)}},x=({isDisabled:e})=>e?Object(b.jsx)(n.EuiToolTip,{position:"top",content:o.i18n.translate("xpack.ml.dataframe.analyticsList.cloneActionPermissionTooltip",{defaultMessage:"You do not have permission to clone analytics jobs."})},Object(b.jsx)(s.a.Fragment,null,g)):Object(b.jsx)(s.a.Fragment,null,g)},function(e,t,a){e.exports=a(23)(938)},,function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a(16);var n=a(44),i=a(12);const s=()=>Object(i.jsx)(n.EuiText,{textAlign:"center"},Object(i.jsx)(n.EuiSpacer,{size:"l"}),Object(i.jsx)(n.EuiLoadingSpinner,{size:"l"}),Object(i.jsx)(n.EuiSpacer,{size:"l"}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(130),i=a(53);const s={[i.FIELD_FORMAT_IDS.DURATION]:{inputFormat:"milliseconds",outputFormat:"humanizePrecise"}};function r(e){const{services:{fieldFormats:t}}=Object(n.a)(),a=t.deserialize({id:e,params:s[e]});return a.convert.bind(a)}},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));a(16);var n=a(12);const i=({stat:e})=>Object(n.jsx)("span",{className:"stat"},Object(n.jsx)("span",null,e.label),":"," ",Object(n.jsx)("strong",{"data-test-subj":e["data-test-subj"]},e.value)),s=({stats:e,dataTestSub:t})=>{const a=Object.keys(e).map((t=>e[t]));return Object(n.jsx)("div",{className:"mlStatsBar","data-test-subj":t},a.filter((e=>e.show)).map((e=>Object(n.jsx)(i,{key:e.label,stat:e}))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c})),a.d(t,"b",(function(){return d}));var n=a(16),i=a.n(n),s=a(44),r=a(45),o=a(137),l=a(12);const c=({jobCount:e})=>!1===Object(o.b)()||0===e?null:Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiCallOut,{title:Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(l.jsx)("div",null,Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There {jobCount, plural, one {is} other {are}} {jobCount, plural, one {# job} other {# jobs}} waiting for machine learning nodes to start.",values:{jobCount:e}}))),Object(l.jsx)(s.EuiSpacer,{size:"m"})),d=()=>!1===Object(o.b)()?null:Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiCallOut,{title:Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsAwaitingNodeWarning.title",defaultMessage:"Awaiting machine learning node"}),color:"primary",iconType:"iInCircle"},Object(l.jsx)("div",null,Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.newJobAwaitingNodeWarning.noMLNodesAvailableDescription",defaultMessage:"There are currently no nodes that can run the job, therefore it will remain in OPENING state until an appropriate node becomes available."}))),Object(l.jsx)(s.EuiSpacer,{size:"m"}));a(37)},,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"d",(function(){return r}));const n=3e4,i=1e3,s=2e3,r=1e3},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(8),i=a(28),s=a(73);const r={getForecastsSummary:function(e,t,a,n){return new Promise(((i,r)=>{const o={success:!0,forecasts:[]},l=[{term:{result_type:"model_forecast_request_stats"}},{term:{job_id:e.job_id}},{range:{timestamp:{gte:a,format:"epoch_millis"}}}];t&&l.push(t),s.ml.results.anomalySearch({size:n,body:{query:{bool:{filter:l}},sort:[{forecast_create_timestamp:{order:"desc"}}]}},[e.job_id]).then((e=>{e.hits.total.value>0&&(o.forecasts=e.hits.hits.map((e=>e._source))),i(o)})).catch((e=>{r(e)}))}))},getForecastDateRange:function(e,t){return new Promise(((a,i)=>{const r={success:!0,earliest:null,latest:null},o=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:!0}},{term:{job_id:e.job_id}},{term:{forecast_id:t}}];s.ml.results.anomalySearch({size:0,body:{query:{bool:{filter:o}},aggs:{earliest:{min:{field:"timestamp"}},latest:{max:{field:"timestamp"}}}}},[e.job_id]).then((e=>{r.earliest=Object(n.get)(e,"aggregations.earliest.value",null),r.latest=Object(n.get)(e,"aggregations.latest.value",null),null===r.earliest||null===r.latest?i(e):a(r)})).catch((e=>{i(e)}))}))},getForecastData:function(e,t,a,r,o,l,c,d){const u=[],p=e.analysis_config.detectors[t];if(void 0!==p.partition_field_name){const e=Object(n.find)(r,{fieldName:p.partition_field_name});void 0!==e&&u.push({fieldName:"partition_field_name",fieldValue:e.fieldName},{fieldName:"partition_field_value",fieldValue:e.fieldValue})}if(void 0!==p.over_field_name){const e=Object(n.find)(r,{fieldName:p.over_field_name});void 0!==e&&u.push({fieldName:"over_field_name",fieldValue:e.fieldName},{fieldName:"over_field_value",fieldValue:e.fieldValue})}if(void 0!==p.by_field_name){const e=Object(n.find)(r,{fieldName:p.by_field_name});void 0!==e&&u.push({fieldName:"by_field_name",fieldValue:e.fieldName},{fieldName:"by_field_value",fieldValue:e.fieldValue})}const m={success:!0,results:{}},b=[{query_string:{query:"result_type:model_forecast",analyze_wildcard:!0}},{term:{job_id:e.job_id}},{term:{forecast_id:a}},{term:{detector_index:t}},{range:{timestamp:{gte:o,lte:l,format:"epoch_millis"}}}];Object(n.each)(u,(e=>{b.push({term:{[e.fieldName]:e.fieldValue}})}));const f=void 0===d?{avg:"avg",max:"max",min:"min"}:{avg:d.avg,max:d.max,min:d.min};return s.ml.results.anomalySearch$({size:0,body:{query:{bool:{filter:b}},aggs:{times:{date_histogram:{field:"timestamp",fixed_interval:`${c}ms`,min_doc_count:1},aggs:{prediction:{[f.avg]:{field:"forecast_prediction"}},forecastUpper:{[f.max]:{field:"forecast_upper"}},forecastLower:{[f.min]:{field:"forecast_lower"}}}}}}},[e.job_id]).pipe(Object(i.map)((e=>{const t=Object(n.get)(e,["aggregations","times","buckets"],[]);return Object(n.each)(t,(e=>{const t=e.key;m.results[t]={prediction:Object(n.get)(e,["prediction","value"]),forecastUpper:Object(n.get)(e,["forecastUpper","value"]),forecastLower:Object(n.get)(e,["forecastLower","value"])}})),m})))},runForecast:function(e,t){return console.log("ML forecast service run forecast with duration:",t),new Promise(((a,n)=>{s.ml.forecast({jobId:e,duration:t}).then((e=>{a(e)})).catch((e=>{n(e)}))}))},getForecastRequestStats:function(e,t){return new Promise(((a,n)=>{const i={success:!0,stats:{}},r=[{query_string:{query:"result_type:model_forecast_request_stats",analyze_wildcard:!0}},{term:{job_id:e.job_id}},{term:{forecast_id:t}}];s.ml.results.anomalySearch({size:1,body:{query:{bool:{filter:r}}}},[e.job_id]).then((e=>{e.hits.total.value>0&&(i.stats=e.hits.hits[0]._source),a(i)})).catch((e=>{n(e)}))}))}}},function(e,t,a){(function(e){var n=a(197).RRule;function i(e,t){t=t||2;var a=e<0;a&&(e*=-1),e=e.toString();return(a?"-":"")+"000000000000000000".substr(0,t-e.length)+e}var s={BINARY:{format:function(e){return e.toString("base64")},parse:function(t){return new e(t,"base64")}},BOOLEAN:{format:function(e){return e?"TRUE":"FALSE"},parse:function(e){return"TRUE"==e.toUpperCase()}},"CAL-ADDRESS":{format:function(e){var t=e.toString();return 0!=t.lastIndexOf("mailto:")&&(t="mailto:"+t),t}},DATE:{format:function(e){return e instanceof Date||(e=new Date(e)),e.getFullYear()+i(e.getMonth()+1)+i(e.getDate())},parse:function(e){var t=new Date(parseInt(e.substr(0,4),10),parseInt(e.substr(4,2),10)-1,parseInt(e.substr(6,2),10),0,0,0);return t.date_only=!0,t}},"DATE-TIME":{format:function(e,t){return e instanceof Date||(e=new Date(e)),e.date_only||"DATE"===t.VALUE?r("DATE",e):e.getUTCFullYear()+i(e.getUTCMonth()+1)+i(e.getUTCDate())+"T"+r("TIME",e)},parse:function(e,t,a){if("DATE"===t.VALUE||e.length<=8)return s.DATE.parse(e);var n=t.TZID,i=[parseInt(e.substr(0,4),10),parseInt(e.substr(4,2),10),parseInt(e.substr(6,2),10),parseInt(e.substr(9,2),10),parseInt(e.substr(11,2),10),parseInt(e.substr(13,2),10)],r=e.length>15&&"Z"===e[15];if(void 0!==n){var o=a.timezone(n);if(!o)throw new Error("Unable to load TZ data for "+n);return o.fromLocalTime(i)}return i[1]-=1,r?new Date(Date.UTC.apply(null,i)):new Date(i[0],i[1],i[2],i[3],i[4],i[5])}},DURATION:{format:function(e){var t=e<0;t&&(e*=-1);var a=Math.floor(e/604800);e-=60*a*60*24*7;var n=Math.floor(e/86400);e-=60*n*60*24;var i=Math.floor(e/3600);e-=60*i*60;var s=Math.floor(e/60),r=e-=60*s,o=["P"];return t&&o.unshift("-"),a&&o.push(a+"W"),n&&o.push(n+"D"),(i||s||r)&&o.push("T"),i&&o.push(i+"H"),s&&o.push(s+"M"),r&&o.push(r+"S"),o.join("")},parse:function(e){for(var t=/(-)?P(\d+W)?(\d+D)?(?:T(\d+H)?(\d+M)?(\d+S)?)?/.exec(e).slice(1),a=[-1,604800,86400,3600,60,1],n=0,i=1;i<t.length;++i)void 0!==t[i]&&(n+=parseInt(t[i],10)*a[i]);return void 0!==t[0]&&(n*=a[0]),n}},FLOAT:{format:function(e){return e.toString()}},INTEGER:{format:function(e){return e.toString()}},PERIOD:{format:function(e){return r("DATE-TIME",e[0])+"/"+r(e[1]instanceof Date?"DATE-TIME":"DURATION",e[1])}},RECUR:{format:function(e){return(e instanceof n?e:new n(e)).toString()},parse:function(e){return n.parse(e)}},TEXT:{format:function(e){return(e||"").toString().replace(/([\\,;])/g,"\\$1").replace(/\n/g,"\\n")},parse:function(e){return e.replace(/\\([\\,;])/g,"$1").replace(/\\[nN]/g,"\n")}},TIME:{format:function(e){return e instanceof Date||(e=new Date(e)),i(e.getUTCHours())+i(e.getUTCMinutes())+i(e.getUTCSeconds())+"Z"},parse:function(e){return e.length>6&&"Z"===e[6]?new Date(Date.UTC(0,0,0,parseInt(e.substr(0,2),10),parseInt(e.substr(2,2),10),parseInt(e.substr(4,2),10))):new Date(0,0,0,parseInt(e.substr(0,2),10),parseInt(e.substr(2,2),10),parseInt(e.substr(4,2),10))}},URI:{format:function(e){return e.toString()}},"UTC-OFFSET":{format:function(e){var t=e<0;return t&&(e*=-1),(t?"-":"+")+i(e,4)}}},r=t.format_value=function(e,t,a){if(void 0===t)return"";var n=s[e||"TEXT"];if(void 0===n)throw Error("Invalid iCalendar datatype: "+e);return Array.isArray(t)&&"PERIOD"!==e||"PERIOD"===e&&t[0]&&Array.isArray(t[0])?t.map((function(e){return n.format(e,a||{})})).join(","):n.format(t,a||{})},o=t.parse_value=function(e,t,a,n,i){if(i)return t.split(",").map((function(t){return o(e,t,a,n)}));var r=s[e||"TEXT"];if(void 0===r)throw Error("Invalid iCalendar datatype: "+e);var l=(a=a||{}).VALUE&&s[a.VALUE];return l&&(r=l),r.parse?r.parse(t,a,n):t}}).call(this,a(196).Buffer)},function(e,t,a){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),a={},n=0;n<t.length;n++)a[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return a},i=/%[sdj%]/g;t.format=function(e){if(!g(e)){for(var t=[],a=0;a<arguments.length;a++)t.push(o(arguments[a]));return t.join(" ")}a=1;for(var n=arguments,s=n.length,r=String(e).replace(i,(function(e){if("%%"===e)return"%";if(a>=s)return e;switch(e){case"%s":return String(n[a++]);case"%d":return Number(n[a++]);case"%j":try{return JSON.stringify(n[a++])}catch(e){return"[Circular]"}default:return e}})),l=n[a];a<s;l=n[++a])f(l)||!v(l)?r+=" "+l:r+=" "+o(l);return r},t.deprecate=function(a,n){if(void 0!==e&&!0===e.noDeprecation)return a;if(void 0===e)return function(){return t.deprecate(a,n).apply(this,arguments)};var i=!1;return function(){if(!i){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),i=!0}return a.apply(this,arguments)}};var s,r={};function o(e,a){var n={seen:[],stylize:c};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),b(a)?n.showHidden=a:a&&t._extend(n,a),j(n.showHidden)&&(n.showHidden=!1),j(n.depth)&&(n.depth=2),j(n.colors)&&(n.colors=!1),j(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=l),d(n,e,n.depth)}function l(e,t){var a=o.styles[t];return a?"["+o.colors[a][0]+"m"+e+"["+o.colors[a][1]+"m":e}function c(e,t){return e}function d(e,a,n){if(e.customInspect&&a&&E(a.inspect)&&a.inspect!==t.inspect&&(!a.constructor||a.constructor.prototype!==a)){var i=a.inspect(n,e);return g(i)||(i=d(e,i,n)),i}var s=function(e,t){if(j(t))return e.stylize("undefined","undefined");if(g(t)){var a="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(a,"string")}if(h(t))return e.stylize(""+t,"number");if(b(t))return e.stylize(""+t,"boolean");if(f(t))return e.stylize("null","null")}(e,a);if(s)return s;var r=Object.keys(a),o=function(e){var t={};return e.forEach((function(e,a){t[e]=!0})),t}(r);if(e.showHidden&&(r=Object.getOwnPropertyNames(a)),O(a)&&(r.indexOf("message")>=0||r.indexOf("description")>=0))return u(a);if(0===r.length){if(E(a)){var l=a.name?": "+a.name:"";return e.stylize("[Function"+l+"]","special")}if(x(a))return e.stylize(RegExp.prototype.toString.call(a),"regexp");if(y(a))return e.stylize(Date.prototype.toString.call(a),"date");if(O(a))return u(a)}var c,v="",w=!1,M=["{","}"];(m(a)&&(w=!0,M=["[","]"]),E(a))&&(v=" [Function"+(a.name?": "+a.name:"")+"]");return x(a)&&(v=" "+RegExp.prototype.toString.call(a)),y(a)&&(v=" "+Date.prototype.toUTCString.call(a)),O(a)&&(v=" "+u(a)),0!==r.length||w&&0!=a.length?n<0?x(a)?e.stylize(RegExp.prototype.toString.call(a),"regexp"):e.stylize("[Object]","special"):(e.seen.push(a),c=w?function(e,t,a,n,i){for(var s=[],r=0,o=t.length;r<o;++r)T(t,String(r))?s.push(p(e,t,a,n,String(r),!0)):s.push("");return i.forEach((function(i){i.match(/^\d+$/)||s.push(p(e,t,a,n,i,!0))})),s}(e,a,n,o,r):r.map((function(t){return p(e,a,n,o,t,w)})),e.seen.pop(),function(e,t,a){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return a[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+a[1];return a[0]+t+" "+e.join(", ")+" "+a[1]}(c,v,M)):M[0]+v+M[1]}function u(e){return"["+Error.prototype.toString.call(e)+"]"}function p(e,t,a,n,i,s){var r,o,l;if((l=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?o=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(o=e.stylize("[Setter]","special")),T(n,i)||(r="["+i+"]"),o||(e.seen.indexOf(l.value)<0?(o=f(a)?d(e,l.value,null):d(e,l.value,a-1)).indexOf("\n")>-1&&(o=s?o.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+o.split("\n").map((function(e){return"   "+e})).join("\n")):o=e.stylize("[Circular]","special")),j(r)){if(s&&i.match(/^\d+$/))return o;(r=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),r=e.stylize(r,"string"))}return r+": "+o}function m(e){return Array.isArray(e)}function b(e){return"boolean"==typeof e}function f(e){return null===e}function h(e){return"number"==typeof e}function g(e){return"string"==typeof e}function j(e){return void 0===e}function x(e){return v(e)&&"[object RegExp]"===w(e)}function v(e){return"object"==typeof e&&null!==e}function y(e){return v(e)&&"[object Date]"===w(e)}function O(e){return v(e)&&("[object Error]"===w(e)||e instanceof Error)}function E(e){return"function"==typeof e}function w(e){return Object.prototype.toString.call(e)}function M(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(a){if(j(s)&&(s=Object({IS_KIBANA_DISTRIBUTABLE:"true"}).NODE_DEBUG||""),a=a.toUpperCase(),!r[a])if(new RegExp("\\b"+a+"\\b","i").test(s)){var n=e.pid;r[a]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",a,n,e)}}else r[a]=function(){};return r[a]},t.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=m,t.isBoolean=b,t.isNull=f,t.isNullOrUndefined=function(e){return null==e},t.isNumber=h,t.isString=g,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=j,t.isRegExp=x,t.isObject=v,t.isDate=y,t.isError=O,t.isFunction=E,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=a(460);var S=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function _(){var e=new Date,t=[M(e.getHours()),M(e.getMinutes()),M(e.getSeconds())].join(":");return[e.getDate(),S[e.getMonth()],t].join(" ")}function T(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",_(),t.format.apply(t,arguments))},t.inherits=a(461),t._extend=function(e,t){if(!t||!v(t))return e;for(var a=Object.keys(t),n=a.length;n--;)e[a[n]]=t[a[n]];return e};var C="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function k(e,t){if(!e){var a=new Error("Promise was rejected with a falsy value");a.reason=e,e=a}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(C&&e[C]){var t;if("function"!=typeof(t=e[C]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,a,n=new Promise((function(e,n){t=e,a=n})),i=[],s=0;s<arguments.length;s++)i.push(arguments[s]);i.push((function(e,n){e?a(e):t(n)}));try{e.apply(this,i)}catch(e){a(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),C&&Object.defineProperty(t,C,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=C,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function a(){for(var a=[],n=0;n<arguments.length;n++)a.push(arguments[n]);var i=a.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var s=this,r=function(){return i.apply(s,arguments)};t.apply(this,a).then((function(t){e.nextTick(r,null,t)}),(function(t){e.nextTick(k,t,r)}))}return Object.setPrototypeOf(a,Object.getPrototypeOf(t)),Object.defineProperties(a,n(t)),a}}).call(this,a(221))},function(e,t,a){e.exports=a(23)(933)},function(e,t,a){e.exports=a(23)(247)},,,,,,function(e,t,a){"use strict";a.d(t,"d",(function(){return n.a})),a.d(t,"b",(function(){return c})),a.d(t,"c",(function(){return d})),a.d(t,"a",(function(){return u})),a.d(t,"e",(function(){return p})),a.d(t,"f",(function(){return b}));var n=a(166),i=a(2),s=a(27),r=a(73),o=a(81),l=a(103);const c=async(e,t,a)=>{try{Object(l.f)(t.state)&&await r.ml.dataFrameAnalytics.stopDataFrameAnalytics(e.id,!0),await r.ml.dataFrameAnalytics.deleteDataFrameAnalytics(e.id),a.displaySuccessToast(i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:e.id}}))}catch(t){a.displayErrorToast(t,i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}}))}o.u.next(o.e.REFRESH)},d=async(e,t,a,n,c)=>{const d=Array.isArray(e.dest.index)?e.dest.index[0]:e.dest.index;try{var u,p,m,b,f,h;Object(l.f)(t.state)&&await r.ml.dataFrameAnalytics.stopDataFrameAnalytics(e.id,!0);const o=await r.ml.dataFrameAnalytics.deleteDataFrameAnalyticsAndDestIndex(e.id,a,n);if(null!==(u=o.analyticsJobDeleted)&&void 0!==u&&u.success&&c.displaySuccessToast(i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsSuccessMessage",{defaultMessage:"Request to delete data frame analytics job {analyticsId} acknowledged.",values:{analyticsId:e.id}})),null!==(p=o.analyticsJobDeleted)&&void 0!==p&&p.error&&c.displayErrorToast(o.analyticsJobDeleted.error,i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}})),null!==(m=o.destIndexDeleted)&&void 0!==m&&m.success&&c.displaySuccessToast(i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexSuccessMessage",{defaultMessage:"Request to delete destination index {destinationIndex} acknowledged.",values:{destinationIndex:d}})),null!==(b=o.destIndexDeleted)&&void 0!==b&&b.error&&c.displayErrorToast(o.destIndexDeleted.error,i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithIndexErrorMessage",{defaultMessage:"An error occurred deleting destination index {destinationIndex}",values:{destinationIndex:d}})),null!==(f=o.destIndexPatternDeleted)&&void 0!==f&&f.success&&c.displaySuccessToast(i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithDataViewSuccessMessage",{defaultMessage:"Request to delete data view {destinationIndex} acknowledged.",values:{destinationIndex:d}})),null!==(h=o.destIndexPatternDeleted)&&void 0!==h&&h.error){const e=Object(s.b)(o.destIndexPatternDeleted.error);c.displayDangerToast(i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsWithDataViewErrorMessage",{defaultMessage:"An error occurred deleting data view {destinationIndex}: {error}",values:{destinationIndex:d,error:e}}))}}catch(t){c.displayErrorToast(t,i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsErrorMessage",{defaultMessage:"An error occurred deleting the data frame analytics job {analyticsId}",values:{analyticsId:e.id}}))}o.u.next(o.e.REFRESH)},u=async(e,t)=>{try{const t=await r.ml.hasPrivileges({index:[{names:[e],privileges:["delete_index"]}]});return!!t&&(!0===t.securityDisabled||!0===t.has_all_requested)}catch(a){const n=Object(s.b)(a);t.displayDangerToast(i.i18n.translate("xpack.ml.dataframe.analyticsList.deleteAnalyticsPrivilegeErrorMessage",{defaultMessage:"User does not have permission to delete index {indexName}: {error}",values:{indexName:e,error:n}}))}},p=async(e,t)=>{try{await r.ml.dataFrameAnalytics.startDataFrameAnalytics(e.config.id),t.displaySuccessToast(i.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {analyticsId} acknowledged.",values:{analyticsId:e.config.id}}))}catch(e){t.displayErrorToast(e,i.i18n.translate("xpack.ml.dataframe.analyticsList.startAnalyticsErrorTitle",{defaultMessage:"Error starting job"}))}o.u.next(o.e.REFRESH)};var m=a(26);const b=async e=>{const t=Object(m.l)();try{await r.ml.dataFrameAnalytics.stopDataFrameAnalytics(e.config.id,Object(l.f)(e.stats.state)),t.addSuccess(i.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsSuccessMessage",{defaultMessage:"Request to stop data frame analytics {analyticsId} acknowledged.",values:{analyticsId:e.config.id}}))}catch(a){t.addDanger(i.i18n.translate("xpack.ml.dataframe.analyticsList.stopAnalyticsErrorMessage",{defaultMessage:"An error occurred stopping the data frame analytics {analyticsId}: {error}",values:{analyticsId:e.config.id,error:JSON.stringify(a)}}))}o.u.next(o.e.REFRESH)}},function(e,t,a){"use strict";a.d(t,"b",(function(){return g})),a.d(t,"a",(function(){return j}));var n=a(16),i=a.n(n),s=a(44),r=a(2),o=a(45),l=(a(638),a(89)),c=a(138),d=a(215),u=a(12);function p({limit:e,maps:t,onLinkClick:a,selectedIds:n,showAllBarBadges:i}){const o=[],l=[];for(let e=0;e<n.length;e++){const a=n[e];void 0!==t.groupsMap[a]&&(l.push(a),o.push(Object(u.jsx)(s.EuiFlexItem,{grow:!1,key:a},Object(u.jsx)(d.a,{id:a,isGroup:!0,numJobs:t.groupsMap[a].length}))))}for(let e=0;e<n.length;e++){const a=n[e];if(void 0===t.groupsMap[a]){if(!1!==(t.jobsMap[a]||[]).some((e=>l.includes(e))))continue;o.push(Object(u.jsx)(s.EuiFlexItem,{grow:!1,key:a},Object(u.jsx)(d.a,{id:a})))}}if(i||o.length<=e)return o.length>e&&o.push(Object(u.jsx)(s.EuiLink,{key:"more-badges-bar-link",onClick:a},Object(u.jsx)(s.EuiText,{grow:!1,size:"xs"},r.i18n.translate("xpack.ml.jobSelector.hideBarBadges",{defaultMessage:"Hide"})))),o;{const t=o.length-e;return o.splice(e),o.push(Object(u.jsx)(s.EuiLink,{key:"more-badges-bar-link",onClick:a},Object(u.jsx)(s.EuiText,{grow:!1,size:"xs"},r.i18n.translate("xpack.ml.jobSelector.showBarBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:t}})))),o}}p.propTypes={limit:c.PropTypes.number,maps:c.PropTypes.shape({jobsMap:c.PropTypes.object,groupsMap:c.PropTypes.object}),onLinkClick:c.PropTypes.func,selectedIds:c.PropTypes.array,showAllBarBadges:c.PropTypes.bool};var m=a(388),b=a(193),f=a(194);function h(e,t,a){if(a)return e;const n=[],i=[];return t.forEach((e=>{n.push(e.groupId),i.push(...e.jobIds)})),e.forEach((e=>{!1===i.includes(e)&&n.push(e)})),n}function g(e){const t={};return e.length&&e.forEach((e=>{t[e.groupId]=e.jobIds})),t}function j({dateFormatTz:e,singleSelection:t,timeseriesOnly:a}){var c,d,j,x;const[v,y]=Object(l.c)("_g"),[O,E]=Object(b.a)(f.a,!0),w=null!==(c=null==v||null===(d=v.ml)||void 0===d?void 0:d.jobIds)&&void 0!==c?c:[],M=null!==(j=null==v||null===(x=v.ml)||void 0===x?void 0:x.groups)&&void 0!==j?j:[],[S,_]=Object(n.useState)({groupsMap:g(M),jobsMap:{}}),[T,C]=Object(n.useState)(h(w,M,t)),[k,F]=Object(n.useState)(!1),[I,D]=Object(n.useState)(!1);function A(){D(!1)}function L(){D(!0)}Object(n.useEffect)((()=>{C(h(w,M,t))}),[JSON.stringify([w,M])]);const R=Object(n.useCallback)((({newSelection:e,jobIds:t,groups:a,time:n})=>{C(e),y({ml:{jobIds:t,groups:a},...void 0!==n?{time:n}:{}}),A()}),[y,C]);return Object(u.jsx)("div",null,Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(s.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},Object(u.jsx)(s.EuiFlexItem,{grow:!1},T.length>0?Object(u.jsx)(s.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs",alignItems:"center","data-test-subj":"mlJobSelectionBadges"},Object(u.jsx)(p,{limit:m.a,maps:S,onLinkClick:()=>F(!k),selectedIds:T,showAllBarBadges:k})):Object(u.jsx)("span",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.jobSelector.noJobsSelectedLabel",defaultMessage:"No jobs selected"}))),Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiButtonEmpty,{size:"xs",iconType:"pencil",onClick:L,"data-test-subj":"mlButtonEditJobSelection"},r.i18n.translate("xpack.ml.jobSelector.jobSelectionButton",{defaultMessage:"Edit job selection"})))),Object(u.jsx)(s.EuiHorizontalRule,{margin:"s"})),function(){if(I)return Object(u.jsx)(s.EuiFlyout,{onClose:A,"data-test-subj":"mlFlyoutJobSelector","aria-labelledby":"jobSelectorFlyout"},Object(u.jsx)(m.b,{dateFormatTz:e,timeseriesOnly:a,singleSelection:t,selectedIds:T,onSelectionConfirmed:R,onJobsFetched:_,onFlyoutClose:A,maps:S,applyTimeRangeConfig:O,onTimeRangeConfigChange:E}))}())}},,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(25);const i=new n.Subject},function(e,t,a){"use strict";a.d(t,"c",(function(){return s})),a.d(t,"d",(function(){return r}));var n=a(60);a.d(t,"a",(function(){return n.EuiCodeEditor}));var i=a(229);a.d(t,"b",(function(){return i.XJsonMode}));const{collapseLiteralStrings:s,expandLiteralStrings:r}=n.XJson},function(e,t,a){e.exports=a(23)(1459)},,function(e,t,a){"use strict";let n;a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return i})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return r})),function(e){e.ANNOTATION="annotation",e.COMMENT="comment"}(n||(n={}));const i=1e3,s="user",r="delayed_data"},function(e,t,a){"use strict";a.d(t,"a",(function(){return r})),a.d(t,"b",(function(){return l}));var n=a(120),i=a(31),s=a(94);function r(e,t,a){const r=function(e){return e.filter((e=>e.type===i.ES_FIELD_TYPES.KEYWORD))}(e),l=function(e){return e.filter((e=>e.type===i.ES_FIELD_TYPES.TEXT))}(e),c=function(e){return e.filter((e=>e.type===i.ES_FIELD_TYPES.LONG||e.type===i.ES_FIELD_TYPES.UNSIGNED_LONG||e.type===i.ES_FIELD_TYPES.INTEGER||e.type===i.ES_FIELD_TYPES.SHORT||e.type===i.ES_FIELD_TYPES.BYTE||e.type===i.ES_FIELD_TYPES.DOUBLE||e.type===i.ES_FIELD_TYPES.FLOAT||e.type===i.ES_FIELD_TYPES.HALF_FLOAT||e.type===i.ES_FIELD_TYPES.SCALED_FLOAT))}(e),d=function(e){return e.filter((e=>e.type===i.ES_FIELD_TYPES.IP))}(e),u=function(e){return e.filter((e=>e.type===i.ES_FIELD_TYPES.GEO_POINT||e.type===i.ES_FIELD_TYPES.GEO_SHAPE))}(e),p=Object.keys(a).length>0,m=function(e,t){return function(a,n){(!1===e||t[a.id]&&t[a.id].find((e=>e.agg===n.dslName)))&&(void 0!==a.aggs&&a.aggs.push(n),void 0!==n.fields&&n.fields.push(a))}}(p,a);return t.forEach((e=>{if(e.type===n.b&&void 0!==e.fields)switch(e.id){case s.b.LAT_LONG:u.forEach((t=>m(t,e)));break;case s.b.INFO_CONTENT:case s.b.HIGH_INFO_CONTENT:case s.b.LOW_INFO_CONTENT:l.forEach((t=>m(t,e)));case s.b.DISTINCT_COUNT:case s.b.HIGH_DISTINCT_COUNT:case s.b.LOW_DISTINCT_COUNT:r.forEach((t=>m(t,e))),d.forEach((t=>m(t,e)));default:c.forEach((t=>{m(t,e)}))}})),{aggs:t,fields:p?o(e):e}}function o(e){return e.filter((e=>e.aggs&&(e.aggs.length>0||0===e.aggs.length&&e.type===i.ES_FIELD_TYPES.DATE)))}function l(e){if(0===e.length)return e;let t;return e[0].id===n.a&&([t]=e.splice(0,1)),e.sort(((e,t)=>e.name.localeCompare(t.name))),void 0!==t&&e.splice(0,0,t),e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(16),i=a(72);function s(e,t){var a;const{services:{storage:s}}=Object(i.b)(),[r,o]=Object(n.useState)(null!==(a=s.get(e))&&void 0!==a?a:t);return[r,Object(n.useCallback)((t=>{try{s.set(e,t),o(t)}catch(e){throw new Error("Unable to update storage with provided value")}}),[])]}},function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i})),a.d(t,"d",(function(){return s})),a.d(t,"c",(function(){return r}));const n="ml.singleMetricViewer.partitionFields",i="ml.jobSelectorFlyout.applyTimeRange",s="ml.gettingStarted.isDismissed",r="ml.frozenDataTierPreference"},function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));const n="_all"},function(e,t,a){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=a(457),i=a(458),s=a(459);function r(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(e,t){if(r()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,a){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,a);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return c(this,e,t,a)}function c(e,t,a,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,a,n){if(t.byteLength,a<0||t.byteLength<a)throw new RangeError("'offset' is out of bounds");if(t.byteLength<a+(n||0))throw new RangeError("'length' is out of bounds");t=void 0===a&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,a):new Uint8Array(t,a,n);l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=p(e,t);return e}(e,t,a,n):"string"==typeof t?function(e,t,a){"string"==typeof a&&""!==a||(a="utf8");if(!l.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');var n=0|b(t,a),i=(e=o(e,n)).write(t,a);i!==n&&(e=e.slice(0,i));return e}(e,t,a):function(e,t){if(l.isBuffer(t)){var a=0|m(t.length);return 0===(e=o(e,a)).length||t.copy(e,0,0,a),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(n=t.length)!=n?o(e,0):p(e,t);if("Buffer"===t.type&&s(t.data))return p(e,t.data)}var n;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=o(e,t<0?0:0|m(t)),!l.TYPED_ARRAY_SUPPORT)for(var a=0;a<t;++a)e[a]=0;return e}function p(e,t){var a=t.length<0?0:0|m(t.length);e=o(e,a);for(var n=0;n<a;n+=1)e[n]=255&t[n];return e}function m(e){if(e>=r())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r().toString(16)+" bytes");return 0|e}function b(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var a=e.length;if(0===a)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return a;case"utf8":case"utf-8":case void 0:return J(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*a;case"hex":return a>>>1;case"base64":return V(e).length;default:if(n)return J(e).length;t=(""+t).toLowerCase(),n=!0}}function f(e,t,a){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===a||a>this.length)&&(a=this.length),a<=0)return"";if((a>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,a);case"utf8":case"utf-8":return S(this,t,a);case"ascii":return T(this,t,a);case"latin1":case"binary":return C(this,t,a);case"base64":return M(this,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,t,a);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function h(e,t,a){var n=e[t];e[t]=e[a],e[a]=n}function g(e,t,a,n,i){if(0===e.length)return-1;if("string"==typeof a?(n=a,a=0):a>2147483647?a=2147483647:a<-2147483648&&(a=-2147483648),a=+a,isNaN(a)&&(a=i?0:e.length-1),a<0&&(a=e.length+a),a>=e.length){if(i)return-1;a=e.length-1}else if(a<0){if(!i)return-1;a=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:j(e,t,a,n,i);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,a):Uint8Array.prototype.lastIndexOf.call(e,t,a):j(e,[t],a,n,i);throw new TypeError("val must be string, number or Buffer")}function j(e,t,a,n,i){var s,r=1,o=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;r=2,o/=2,l/=2,a/=2}function c(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(i){var d=-1;for(s=a;s<o;s++)if(c(e,s)===c(t,-1===d?0:s-d)){if(-1===d&&(d=s),s-d+1===l)return d*r}else-1!==d&&(s-=s-d),d=-1}else for(a+l>o&&(a=o-l),s=a;s>=0;s--){for(var u=!0,p=0;p<l;p++)if(c(e,s+p)!==c(t,p)){u=!1;break}if(u)return s}return-1}function x(e,t,a,n){a=Number(a)||0;var i=e.length-a;n?(n=Number(n))>i&&(n=i):n=i;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");n>s/2&&(n=s/2);for(var r=0;r<n;++r){var o=parseInt(t.substr(2*r,2),16);if(isNaN(o))return r;e[a+r]=o}return r}function v(e,t,a,n){return U(J(t,e.length-a),e,a,n)}function y(e,t,a,n){return U(function(e){for(var t=[],a=0;a<e.length;++a)t.push(255&e.charCodeAt(a));return t}(t),e,a,n)}function O(e,t,a,n){return y(e,t,a,n)}function E(e,t,a,n){return U(V(t),e,a,n)}function w(e,t,a,n){return U(function(e,t){for(var a,n,i,s=[],r=0;r<e.length&&!((t-=2)<0);++r)n=(a=e.charCodeAt(r))>>8,i=a%256,s.push(i),s.push(n);return s}(t,e.length-a),e,a,n)}function M(e,t,a){return 0===t&&a===e.length?n.fromByteArray(e):n.fromByteArray(e.slice(t,a))}function S(e,t,a){a=Math.min(e.length,a);for(var n=[],i=t;i<a;){var s,r,o,l,c=e[i],d=null,u=c>239?4:c>223?3:c>191?2:1;if(i+u<=a)switch(u){case 1:c<128&&(d=c);break;case 2:128==(192&(s=e[i+1]))&&(l=(31&c)<<6|63&s)>127&&(d=l);break;case 3:s=e[i+1],r=e[i+2],128==(192&s)&&128==(192&r)&&(l=(15&c)<<12|(63&s)<<6|63&r)>2047&&(l<55296||l>57343)&&(d=l);break;case 4:s=e[i+1],r=e[i+2],o=e[i+3],128==(192&s)&&128==(192&r)&&128==(192&o)&&(l=(15&c)<<18|(63&s)<<12|(63&r)<<6|63&o)>65535&&l<1114112&&(d=l)}null===d?(d=65533,u=1):d>65535&&(d-=65536,n.push(d>>>10&1023|55296),d=56320|1023&d),n.push(d),i+=u}return function(e){var t=e.length;if(t<=_)return String.fromCharCode.apply(String,e);var a="",n=0;for(;n<t;)a+=String.fromCharCode.apply(String,e.slice(n,n+=_));return a}(n)}t.Buffer=l,t.SlowBuffer=function(e){+e!=e&&(e=0);return l.alloc(+e)},t.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=r(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,a){return c(null,e,t,a)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,a){return function(e,t,a,n){return d(t),t<=0?o(e,t):void 0!==a?"string"==typeof n?o(e,t).fill(a,n):o(e,t).fill(a):o(e,t)}(null,e,t,a)},l.allocUnsafe=function(e){return u(null,e)},l.allocUnsafeSlow=function(e){return u(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var a=e.length,n=t.length,i=0,s=Math.min(a,n);i<s;++i)if(e[i]!==t[i]){a=e[i],n=t[i];break}return a<n?-1:n<a?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var a;if(void 0===t)for(t=0,a=0;a<e.length;++a)t+=e[a].length;var n=l.allocUnsafe(t),i=0;for(a=0;a<e.length;++a){var r=e[a];if(!l.isBuffer(r))throw new TypeError('"list" argument must be an Array of Buffers');r.copy(n,i),i+=r.length}return n},l.byteLength=b,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)h(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)h(this,t,t+3),h(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)h(this,t,t+7),h(this,t+1,t+6),h(this,t+2,t+5),h(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):f.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",a=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,a).match(/.{2}/g).join(" "),this.length>a&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,a,n,i){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===a&&(a=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||a>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=a)return 0;if(n>=i)return-1;if(t>=a)return 1;if(this===e)return 0;for(var s=(i>>>=0)-(n>>>=0),r=(a>>>=0)-(t>>>=0),o=Math.min(s,r),c=this.slice(n,i),d=e.slice(t,a),u=0;u<o;++u)if(c[u]!==d[u]){s=c[u],r=d[u];break}return s<r?-1:r<s?1:0},l.prototype.includes=function(e,t,a){return-1!==this.indexOf(e,t,a)},l.prototype.indexOf=function(e,t,a){return g(this,e,t,a,!0)},l.prototype.lastIndexOf=function(e,t,a){return g(this,e,t,a,!1)},l.prototype.write=function(e,t,a,n){if(void 0===t)n="utf8",a=this.length,t=0;else if(void 0===a&&"string"==typeof t)n=t,a=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(a)?(a|=0,void 0===n&&(n="utf8")):(n=a,a=void 0)}var i=this.length-t;if((void 0===a||a>i)&&(a=i),e.length>0&&(a<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return x(this,e,t,a);case"utf8":case"utf-8":return v(this,e,t,a);case"ascii":return y(this,e,t,a);case"latin1":case"binary":return O(this,e,t,a);case"base64":return E(this,e,t,a);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return w(this,e,t,a);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var _=4096;function T(e,t,a){var n="";a=Math.min(e.length,a);for(var i=t;i<a;++i)n+=String.fromCharCode(127&e[i]);return n}function C(e,t,a){var n="";a=Math.min(e.length,a);for(var i=t;i<a;++i)n+=String.fromCharCode(e[i]);return n}function k(e,t,a){var n=e.length;(!t||t<0)&&(t=0),(!a||a<0||a>n)&&(a=n);for(var i="",s=t;s<a;++s)i+=B(e[s]);return i}function F(e,t,a){for(var n=e.slice(t,a),i="",s=0;s<n.length;s+=2)i+=String.fromCharCode(n[s]+256*n[s+1]);return i}function I(e,t,a){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>a)throw new RangeError("Trying to access beyond buffer length")}function D(e,t,a,n,i,s){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(a+n>e.length)throw new RangeError("Index out of range")}function A(e,t,a,n){t<0&&(t=65535+t+1);for(var i=0,s=Math.min(e.length-a,2);i<s;++i)e[a+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function L(e,t,a,n){t<0&&(t=4294967295+t+1);for(var i=0,s=Math.min(e.length-a,4);i<s;++i)e[a+i]=t>>>8*(n?i:3-i)&255}function R(e,t,a,n,i,s){if(a+n>e.length)throw new RangeError("Index out of range");if(a<0)throw new RangeError("Index out of range")}function N(e,t,a,n,s){return s||R(e,0,a,4),i.write(e,t,a,n,23,4),a+4}function P(e,t,a,n,s){return s||R(e,0,a,8),i.write(e,t,a,n,52,8),a+8}l.prototype.slice=function(e,t){var a,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(a=this.subarray(e,t)).__proto__=l.prototype;else{var i=t-e;a=new l(i,void 0);for(var s=0;s<i;++s)a[s]=this[s+e]}return a},l.prototype.readUIntLE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n},l.prototype.readUIntBE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var n=this[e],i=1,s=0;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,a){e|=0,t|=0,a||I(e,t,this.length);for(var n=t,i=1,s=this[e+--n];n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var a=this[e]|this[e+1]<<8;return 32768&a?4294901760|a:a},l.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var a=this[e+1]|this[e]<<8;return 32768&a?4294901760|a:a},l.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,a,n){(e=+e,t|=0,a|=0,n)||D(this,e,t,a,Math.pow(2,8*a)-1,0);var i=1,s=0;for(this[t]=255&e;++s<a&&(i*=256);)this[t+s]=e/i&255;return t+a},l.prototype.writeUIntBE=function(e,t,a,n){(e=+e,t|=0,a|=0,n)||D(this,e,t,a,Math.pow(2,8*a)-1,0);var i=a-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+a},l.prototype.writeUInt8=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):A(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):A(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,a,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*a-1);D(this,e,t,a,i-1,-i)}var s=0,r=1,o=0;for(this[t]=255&e;++s<a&&(r*=256);)e<0&&0===o&&0!==this[t+s-1]&&(o=1),this[t+s]=(e/r>>0)-o&255;return t+a},l.prototype.writeIntBE=function(e,t,a,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*a-1);D(this,e,t,a,i-1,-i)}var s=a-1,r=1,o=0;for(this[t+s]=255&e;--s>=0&&(r*=256);)e<0&&0===o&&0!==this[t+s+1]&&(o=1),this[t+s]=(e/r>>0)-o&255;return t+a},l.prototype.writeInt8=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):A(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):A(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,a){return e=+e,t|=0,a||D(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,a){return N(this,e,t,!0,a)},l.prototype.writeFloatBE=function(e,t,a){return N(this,e,t,!1,a)},l.prototype.writeDoubleLE=function(e,t,a){return P(this,e,t,!0,a)},l.prototype.writeDoubleBE=function(e,t,a){return P(this,e,t,!1,a)},l.prototype.copy=function(e,t,a,n){if(a||(a=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<a&&(n=a),n===a)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(a<0||a>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-a&&(n=e.length-t+a);var i,s=n-a;if(this===e&&a<t&&t<n)for(i=s-1;i>=0;--i)e[i+t]=this[i+a];else if(s<1e3||!l.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+a];else Uint8Array.prototype.set.call(e,this.subarray(a,a+s),t);return s},l.prototype.fill=function(e,t,a,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,a=this.length):"string"==typeof a&&(n=a,a=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<a)throw new RangeError("Out of range index");if(a<=t)return this;var s;if(t>>>=0,a=void 0===a?this.length:a>>>0,e||(e=0),"number"==typeof e)for(s=t;s<a;++s)this[s]=e;else{var r=l.isBuffer(e)?e:J(new l(e,n).toString()),o=r.length;for(s=0;s<a-t;++s)this[s+t]=r[s%o]}return this};var z=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function J(e,t){var a;t=t||1/0;for(var n=e.length,i=null,s=[],r=0;r<n;++r){if((a=e.charCodeAt(r))>55295&&a<57344){if(!i){if(a>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(r+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=a;continue}if(a<56320){(t-=3)>-1&&s.push(239,191,189),i=a;continue}a=65536+(i-55296<<10|a-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,a<128){if((t-=1)<0)break;s.push(a)}else if(a<2048){if((t-=2)<0)break;s.push(a>>6|192,63&a|128)}else if(a<65536){if((t-=3)<0)break;s.push(a>>12|224,a>>6&63|128,63&a|128)}else{if(!(a<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(a>>18|240,a>>12&63|128,a>>6&63|128,63&a|128)}}return s}function V(e){return n.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function U(e,t,a,n){for(var i=0;i<n&&!(i+a>=t.length||i>=e.length);++i)t[i+a]=e[i];return i}}).call(this,a(133))},function(e,t,a){var n=a(170),i=["FREQ","INTERVAL","COUNT","UNTIL","BYDAY","BYMONTH","BYMONTHDAY"],s=["SU","MO","TU","WE","TH","FR","SA"];function r(e){return Array.isArray(e)?(e=e.slice(0))[1]--:e=[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()],new Date(Date.UTC.apply(null,e))}function o(e){return new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds())}function l(e){return e<0?Math.ceil(e):Math.floor(e)}function c(e){return e.getUTCFullYear()}function d(e){return e.getUTCMonth()+1}function u(e){return e.getUTCDate()}function p(e){return e.getUTCHours()}function m(e){return e.getUTCMinutes()}function b(e){return e.getUTCSeconds()}function f(e){return e.getUTCMilliseconds()}function h(e,t){return e.setUTCMonth(t-1),e}function g(e,t){return e.setUTCDate(t),e}function j(e,t){return e.setUTCHours(t),e}function x(e,t){return e.setUTCMinutes(t),e}function v(e,t){return e.setUTCSeconds(t),e}function y(e,t){return e.setUTCMilliseconds(t),e}function O(e,t){return function(e,t){return e.setUTCFullYear(t),e}(e,c(e)+t)}function E(e,t){return h(e,d(e)+t)}function w(e,t){return g(e,u(e)+t)}function M(e){return e.getUTCDay()}function S(e,t){return(t-e)/864e5}var _=t.RRule=function(e,t,a){for(var n in t instanceof Date&&(t={DTSTART:t,DTEND:a}),t=t||{},this.start=t.DTSTART?r(t.DTSTART):null,this.end=t.DTEND?r(t.DTEND):null,this.exceptions=t.EXDATE||[],"string"==typeof e&&(e=_.parse(e)),this.rule={},e||{}){if(-1==i.indexOf(n))throw new Error(n+" is not currently supported!");this.rule[n]=T[n]?T[n].parse(e[n]):e[n]}};_.parse=function(e){for(var t=e.split(/=|;/),a={},n=0;n<t.length;n+=2)a[t[n]]=t[n+1];return a},_.prototype.setFrequency=function(e){this.rule.FREQ=e},_.prototype.valueOf=function(){return this.rule},_.prototype.toString=function(){var e=["FREQ="+this.rule.FREQ];for(var t in this.rule)"FREQ"!=t&&e.push(t+"="+((T[t]||{}).format?T[t].format(this.rule[t]):this.rule[t]));return e.join(";")},_.prototype.next=function(e){if((!(e=e&&r(e))||e<this.start)&&(e=new Date(this.start.valueOf()-1)),this.until&&e>this.until)return null;var t=C[this.rule.FREQ];if(!t)throw new Error(this.rule.FREQ+" recurrence is not supported");e:for(;;){for(var a=t.next(this.rule,this.start,e),n=o(a),i=0;i<this.exceptions.length;i++){var s=this.exceptions[i];if(s.valueOf()==n.valueOf()||s.date_only&&c(r(s))==c(n)&&d(r(s))==d(n)&&u(r(s))==u(n)){e=a;continue e}}break}return this.until&&a>this.until||this.rule.COUNT&&null!==this.count_end&&(void 0===this.count_end&&(this.count_end=null,this.count_end=this.nextOccurences(this.rule.COUNT).pop()),a>r(this.count_end))||this.rule.UNTIL&&a>r(this.rule.UNTIL)?null:o(a)},_.prototype.nextOccurences=function(e,t){1===arguments.length&&(t=e,e=void 0);var a=[];if(t instanceof Date)for(;(e=this.next(e))&&e<=t;)a.push(e);else for(;t--&&null!==e;)(e=this.next(e))&&a.push(e);return a};var T={INTERVAL:{parse:function(e){return parseInt(e,10)}},UNTIL:{parse:function(e){return e instanceof Date?e:n.parse_value("DATE-TIME",e)},format:function(e){return n.format_value("DATE-TIME",e)}},FREQ:{parse:function(e){return e}},BYMONTH:{parse:function(e){return"number"==typeof e?[e]:e.split(",").map((function(e){return parseInt(e,10)}))},format:function(e){return e.join(",")}},BYDAY:{parse:function(e){var t=e.split(",").map((function(e){var t=e.match(/([+-]?\d)?(SU|MO|TU|WE|TH|FR|SA)/);return[parseInt(t[1],10)||0,s.indexOf(t[2])]}));return t.sort((function(e,t){return e[0]==t[0]?e[1]-t[1]:e[0]-t[0]})),t},format:function(e){return e.map((function(e){return(e[0]||"")+s[e[1]]})).join(",")}},EXDATE:{parse:function(e){return e.split(",").map((function(e){return 8==e.length?n.parse_value("DATE",e):n.parse_value("DATE-TIME",e)}))},format:function(e){return e.map((function(e){return n.format_value(e.date_only?"DATE":"DATE-TIME",e)})).join(",")}}};T.BYMONTHDAY=T.BYMONTH,T.COUNT=T.INTERVAL;var C={DAILY:{next:function(e,t,a){var n=new Date(a);j(n,p(t)),x(n,m(t)),v(n,b(t)),y(n,f(t));var i=e.INTERVAL||1,s=l(S(n,t))%i;s&&w(n,i-s);for(var r=0;r<2&&!((n=A(e.BYDAY,n,a)).valueOf()>a.valueOf());++r)w(n,i);return n}},WEEKLY:{next:function(e,t,a){var n=new Date(a);j(n,p(t)),x(n,m(t)),v(n,b(t)),y(n,f(t));var i=e.INTERVAL||1,s=l(S(t,n)/7)%i;for(s&&w(n,7*(i-s));n=A(e.BYDAY,n,a),e.BYDAY&&e.BYDAY.length||(startDayOfWeek=M(t),nextDayOfWeek=M(n),nextDayOfWeek>startDayOfWeek?w(n,startDayOfWeek-nextDayOfWeek):startDayOfWeek>nextDayOfWeek&&w(n,startDayOfWeek-nextDayOfWeek-7)),!(n.valueOf()>a.valueOf()&&F(e.BYMONTH,n));)w(n,7*i);return n}},MONTHLY:{next:function(e,t,a){var n=new Date(a);j(n,p(t)),x(n,m(t)),v(n,b(t)),y(n,f(t));var i=e.INTERVAL||1,s=d(n)-d(t)+12*(c(n)-c(t));s%i&&E(n,i-s%i);for(var r=0;r<2&&(r&&g(n,1),n=A(e.BYDAY,n,a),n=D(e.BYMONTHDAY,n,a),e.BYDAY&&e.BYDAY.length||e.BYMONTHDAY&&e.BYMONTHDAY.length||g(n,u(t)),!(n.valueOf()>a.valueOf()));++r)E(n,i);return n}},YEARLY:{next:function(e,t,a){var n=new Date(a);j(n,p(t)),x(n,m(t)),v(n,b(t)),y(n,f(t));var i=e.INTERVAL||1,s=(c(a)-c(t))%i;s&&O(n,i-s);for(var r=0;r<2&&(n=I(e.BYMONTH,n),n=D(e.BYMONTHDAY,n,a),n=A(e.BYDAY,n,a),e.BYMONTH&&e.BYMONTH.length||h(n,d(t)),e.BYDAY&&e.BYDAY.length||e.BYMONTHDAY&&e.BYMONTHDAY.length||g(n,u(t)),!(n.valueOf()>a.valueOf()));++r)g(h(O(n,i),1),1);return n}}};function k(e){return e.sort((function(e,t){return null===e&&null===t?0:null===e?1:null===t?-1:e.valueOf()-t.valueOf()}))}function F(e,t){return!e||!e.length||-1!==e.indexOf(d(t))}function I(e,t){return e&&e.length&&k(e.map((function(e){var a=e-d(t);a<0&&(a+=12);var n=E(new Date(t),a);return g(n,1),n}))).shift()||t}function D(e,t,a){return e&&e.length&&k(e.map((function(e){var n=g(new Date(t),e);return n.valueOf()<=a.valueOf()?null:n}))).shift()||t}function A(e,t,a){return e&&e.length&&k(e.map((function(e){(r=e[1]-M(t))<0&&(r+=7);var n=w(new Date(t),r);if(e[0]>0){var i=0|(u(n)-1)/7+1;if(i>e[0])return null;w(n,7*(e[0]-i))}else if(e[0]<0){for(var s=new Date(n),r=[];d(s)===d(n);)r.push(u(s)),w(s,7);g(n,r.reverse()[-e[0]-1])}return n.valueOf()<=a.valueOf()?null:n}))).shift()||t}},function(e,t,a){a(232);var n=a(171),i=a(117).CalendarObject,s=(a(117).CalendarProperty,a(117).schema),r=t.iCalendar=function(e){i.call(this,this,"VCALENDAR"),this.calendar=this,e||(this.addProperty("VERSION","2.0"),this.addProperty("PRODID",a(308).PRODID))};n.inherits(r,i),r.prototype.events=function(){return this.components.VEVENT||[]},r.prototype.timezone=function(e){for(var t=0;t<this.components.VTIMEZONE.length;++t){var a=this.components.VTIMEZONE[t];if(a.getPropertyValue("TZID")==e)return a}},s.VCALENDAR={factory:r,valid_properties:[],required_properties:["PRODID","VERSION"],valid_children:["VEVENT"],required_children:[]},s.VTODO={required_properties:["DTSTAMP","UID"]},s.VJOURNAL={required_properties:["DTSTAMP","UID"]},s.VFREEBUSY={required_properties:["DTSTAMP","UID"]},s.VALARM={required_properties:["ACTION","TRIGGER"]}},function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));var n=a(2),i=a(74),s=a(103);const r=n.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionUnknownJobTypeToolTipContent",{defaultMessage:"There is no results page available for this type of data frame analytics job."}),o=n.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobNotStartedToolTipContent",{defaultMessage:"The data frame analytics job did not start. There is no results page available."}),l=n.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobNotFinishedToolTipContent",{defaultMessage:"The data frame analytics job is not finished. There is no results page available."}),c=n.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionJobFailedToolTipContent",{defaultMessage:"The data frame analytics job failed. There is no results page available."});function d(e){const t={disabled:!1},a=Object(s.d)(e.stats),n=Object(s.f)(e.stats.state),d=1===a.currentPhase&&0===a.progress,u=Object(s.i)(e.stats.state)&&a.currentPhase===a.totalPhases&&100===a.progress,p=!Object(i.y)(e.config.analysis)&&!Object(i.x)(e.config.analysis)&&!Object(i.v)(e.config.analysis);return(!u||n||p)&&(t.disabled=!0,p?t.tooltipContent=r:n?t.tooltipContent=c:d?t.tooltipContent=o:u||(t.tooltipContent=l)),t}},function(e,t,a){var n=a(235),i=a(487)(n);e.exports=i},function(e,t,a){e.exports=a(23)(1284)},function(e,t,a){e.exports=a(23)(929)},function(e,t,a){"use strict";var n=a(88);e.exports={longestPath:function(e){var t={};n.forEach(e.sources(),(function a(i){var s=e.node(i);if(n.has(t,i))return s.rank;t[i]=!0;var r=n.min(n.map(e.outEdges(i),(function(t){return a(t.w)-e.edge(t).minlen})));return r!==Number.POSITIVE_INFINITY&&null!=r||(r=0),s.rank=r}))},slack:function(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}}},function(e,t,a){"use strict";let n,i;Object.defineProperty(t,"__esModule",{value:!0}),t.KBN_FIELD_TYPES=t.ES_FIELD_TYPES=void 0,t.ES_FIELD_TYPES=n,function(e){e._ID="_id",e._INDEX="_index",e._SOURCE="_source",e._TYPE="_type",e.STRING="string",e.TEXT="text",e.KEYWORD="keyword",e.VERSION="version",e.BOOLEAN="boolean",e.OBJECT="object",e.DATE="date",e.DATE_NANOS="date_nanos",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.FLOAT="float",e.HALF_FLOAT="half_float",e.SCALED_FLOAT="scaled_float",e.DOUBLE="double",e.INTEGER="integer",e.LONG="long",e.SHORT="short",e.UNSIGNED_LONG="unsigned_long",e.FLOAT_RANGE="float_range",e.DOUBLE_RANGE="double_range",e.INTEGER_RANGE="integer_range",e.LONG_RANGE="long_range",e.NESTED="nested",e.BYTE="byte",e.IP="ip",e.IP_RANGE="ip_range",e.ATTACHMENT="attachment",e.TOKEN_COUNT="token_count",e.MURMUR3="murmur3",e.HISTOGRAM="histogram"}(n||(t.ES_FIELD_TYPES=n={})),t.KBN_FIELD_TYPES=i,function(e){e._SOURCE="_source",e.ATTACHMENT="attachment",e.BOOLEAN="boolean",e.DATE="date",e.DATE_RANGE="date_range",e.GEO_POINT="geo_point",e.GEO_SHAPE="geo_shape",e.IP="ip",e.IP_RANGE="ip_range",e.MURMUR3="murmur3",e.NUMBER="number",e.NUMBER_RANGE="number_range",e.STRING="string",e.UNKNOWN="unknown",e.CONFLICT="conflict",e.OBJECT="object",e.NESTED="nested",e.HISTOGRAM="histogram",e.MISSING="missing"}(i||(t.KBN_FIELD_TYPES=i={}))},,,function(e,t,a){"use strict";a.r(t),a.d(t,"AnomalyTimelineService",(function(){return AnomalyTimelineService}));var n=a(5),i=a.n(n),s=a(47),r=a(110),o=a(85),l=a(17);class AnomalyTimelineService{constructor(e,t,a){i()(this,"timeBuckets",void 0),i()(this,"_customTimeRange",void 0),this.timeFilter=e,this.mlResultsService=a,this.timeBuckets=new r.a({"histogram:maxBars":t.get(s.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":t.get(s.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:t.get("dateFormat"),"dateFormat:scaled":t.get("dateFormat:scaled")}),this.timeFilter.enableTimeRangeSelector()}static isSwimlaneData(e){return Object(l.isPopulatedObject)(e,["interval","points","laneLabels"])}static isOverallSwimlaneData(e){return this.isSwimlaneData(e)&&Object(l.isPopulatedObject)(e,["earliest","latest"])&&1===e.laneLabels.length&&e.laneLabels[0]===o.g}setTimeRange(e){this._customTimeRange=e}getSwimlaneBucketInterval(e,t){const a=this.getTimeBounds();if(void 0===a)throw new Error("timeRangeSelectorEnabled has to be enabled");this.timeBuckets.setInterval("auto"),this.timeBuckets.setBounds(a);const n=this.timeBuckets.getInterval().asSeconds(),i=(a.max.valueOf()-a.min.valueOf())/1e3/n;Math.floor(t/i*100)/100<8&&this.timeBuckets.setInterval(2*n+"s");const s=e.reduce(((e,t)=>Math.max(e,t.bucketSpanSeconds)),0);return s>n&&(this.timeBuckets.setInterval(s+"s"),this.timeBuckets.setBounds(a)),this.timeBuckets.getInterval()}async loadOverallData(e,t,a,n){const i=null!=a?a:this.getSwimlaneBucketInterval(e,t);if(!e||!e.length)throw new Error("Explorer jobs collection is required");const s=this.getTimeBounds(),o=Object(r.b)(s,i,!1),l=e.map((e=>e.id)),c=Object(r.b)(s,i,!0),d=await this.mlResultsService.getOverallBucketScores(l,1,c.min.valueOf(),c.max.valueOf(),i.asSeconds()+"s",n);return this.processOverallResults(d.results,o,i.asSeconds())}async loadViewBySwimlane(e,t,a,n,i,s,l,c,d,u,p){const m=this.getTimeBounds();if(void 0===m)throw new Error("timeRangeSelectorEnabled has to be enabled");const b=null!=u?u:this.getSwimlaneBucketInterval(a,c),f=Object(r.b)(m,b,!1),h=a.map((e=>e.id)),g=b.asMilliseconds();let j;if(n===o.j){const t=void 0!==e&&e.length>0?e:h;j=await this.mlResultsService.getScoresByBucket(t,f.min.valueOf(),f.max.valueOf(),g,s,l,p)}else j=await this.mlResultsService.getInfluencerValueMaxScoreByTime(h,n,e,f.min.valueOf(),f.max.valueOf(),g,i,s,l,d,p);if(void 0===j)return;return this.processViewByResults(j.results,j.cardinality,e,t,n,b.asSeconds())}async loadViewByTopFieldValuesForSelectedTime(e,t,a,n,i,s,r,l,c,d){const u=a.map((e=>e.id));if(n!==o.j){const a=await this.mlResultsService.getTopInfluencers(u,e,t,i,s,r,c,d);if(void 0===a.influencers[n])return[];const o=[],l=a.influencers[n];return Array.isArray(l)&&l.forEach((e=>{e.maxAnomalyScore>0&&o.push(e.influencerFieldValue)})),o}{const n=await this.mlResultsService.getScoresByBucket(u,e,t,this.getSwimlaneBucketInterval(a,l).asMilliseconds(),s,r,i);return Object.keys(n.results)}}getTimeBounds(){return void 0!==this._customTimeRange?this.timeFilter.calculateBounds(this._customTimeRange):this.timeFilter.getBounds()}processOverallResults(e,t,a){const n=o.g,i={laneLabels:[n],points:[],interval:a,earliest:t.min.valueOf()/1e3,latest:t.max.valueOf()/1e3};return Object.entries(e).forEach((([e,t])=>{const a=+e/1e3;i.points.push({laneLabel:n,time:a,value:t}),i.earliest=Math.min(a,i.earliest),i.latest=Math.max(a+i.interval,i.latest)})),i}processViewByResults(e,t,a,n,i,s){const r={fieldName:i,points:[],laneLabels:[],interval:s,earliest:n.earliest,latest:n.latest,cardinality:t},o={};Object.entries(e).forEach((([e,t])=>{r.laneLabels.push(e),o[e]=0,Object.entries(t).forEach((([t,a])=>{const n=+t/1e3;r.points.push({laneLabel:e,time:n,value:a}),o[e]=Math.max(o[e],a)}))}));const l=a.length;return r.laneLabels=0===l?r.laneLabels.sort(((e,t)=>o[t]-o[e])):r.laneLabels.sort(((e,t)=>{let n=a.indexOf(e),i=a.indexOf(t);return n=n>-1?n:l,i=i>-1?i:l,n-i})),r}}},,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(51),i=a(16),s=n.__importDefault(a(259));t.default=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=[]);var n=s.default(e,t),r=n[0],o=n[1],l=n[2];return i.useEffect(l,a),[r,o]}},,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return df})),a.d(t,"a",(function(){return mf}));var n={};a.r(n),a.d(n,"overviewRouteFactory",(function(){return A})),a.d(n,"appRootRouteFactory",(function(){return R})),a.d(n,"jobListRouteFactory",(function(){return Y})),a.d(n,"indexOrSearchRouteFactory",(function(){return re})),a.d(n,"dataVizIndexOrSearchRouteFactory",(function(){return oe})),a.d(n,"jobTypeRouteFactory",(function(){return xe})),a.d(n,"newJobRouteFactory",(function(){return ye})),a.d(n,"singleMetricRouteFactory",(function(){return Bs})),a.d(n,"multiMetricRouteFactory",(function(){return Js})),a.d(n,"populationRouteFactory",(function(){return Vs})),a.d(n,"advancedRouteFactory",(function(){return Us})),a.d(n,"categorizationRouteFactory",(function(){return Gs})),a.d(n,"rareRouteFactory",(function(){return qs})),a.d(n,"recognizeRouteFactory",(function(){return or})),a.d(n,"checkViewOrCreateRouteFactory",(function(){return lr})),a.d(n,"selectorRouteFactory",(function(){return mr})),a.d(n,"indexBasedRouteFactory",(function(){return hr})),a.d(n,"fileBasedRouteFactory",(function(){return xr})),a.d(n,"settingsRouteFactory",(function(){return wr})),a.d(n,"calendarListRouteFactory",(function(){return Br})),a.d(n,"newCalendarRouteFactory",(function(){return Ur})),a.d(n,"editCalendarRouteFactory",(function(){return Gr})),a.d(n,"filterListRouteFactory",(function(){return ro})),a.d(n,"newFilterListRouteFactory",(function(){return co})),a.d(n,"editFilterListRouteFactory",(function(){return uo})),a.d(n,"analyticsJobsListRouteFactory",(function(){return bo})),a.d(n,"analyticsJobExplorationRouteFactory",(function(){return cc})),a.d(n,"analyticsJobsCreationRouteFactory",(function(){return Fd})),a.d(n,"analyticsMapRouteFactory",(function(){return Dd})),a.d(n,"timeSeriesExplorerRouteFactory",(function(){return vm})),a.d(n,"explorerRouteFactory",(function(){return Db})),a.d(n,"accessDeniedRouteFactory",(function(){return Pb})),a.d(n,"modelsListRouteFactory",(function(){return Zb})),a.d(n,"nodesListRouteFactory",(function(){return af}));var i=a(16),s=a.n(i),r=a(44),o=a(2),l=a(49),c=a(89),d=a(72),u=a(101),p=a(0),m=a(76);function b(e){const t=Object(d.d)(),a=Object(d.e)(),n=!Object(u.d)(),s=Object(m.e)("canViewMlNodes"),[r]=Object(c.c)("_g"),l=Object(i.useMemo)((()=>void 0!==(null==r?void 0:r.refreshInterval)?{globalState:{refreshInterval:r.refreshInterval}}:void 0),[null==r?void 0:r.refreshInterval]),b=Object(i.useCallback)((async e=>{const n=await t.getUrl({page:e,pageState:l});await a(n,!1)}),[l]),f=Object(i.useMemo)((()=>{const e=n;return[{id:"main_section",name:"",items:[{id:"overview",pathId:p.b.OVERVIEW,name:o.i18n.translate("xpack.ml.navMenu.overviewTabLinkText",{defaultMessage:"Overview"}),disabled:e,testSubj:"mlMainTab overview"}]},{id:"anomaly_detection_section",name:o.i18n.translate("xpack.ml.navMenu.anomalyDetectionTabLinkText",{defaultMessage:"Anomaly Detection"}),items:[{id:"anomaly_detection",name:o.i18n.translate("xpack.ml.navMenu.anomalyDetection.jobsManagementText",{defaultMessage:"Jobs"}),disabled:e,pathId:p.b.ANOMALY_DETECTION_JOBS_MANAGE,testSubj:"mlMainTab anomalyDetection"},{id:"anomaly_explorer",name:o.i18n.translate("xpack.ml.navMenu.anomalyDetection.anomalyExplorerText",{defaultMessage:"Anomaly Explorer"}),disabled:e,pathId:p.b.ANOMALY_EXPLORER,testSubj:"mlMainTab anomalyExplorer"},{id:"single_metric_viewer",name:o.i18n.translate("xpack.ml.navMenu.anomalyDetection.singleMetricViewerText",{defaultMessage:"Single Metric Viewer"}),pathId:p.b.SINGLE_METRIC_VIEWER,disabled:e,testSubj:"mlMainTab singleMetricViewer"},{id:"settings",pathId:p.b.SETTINGS,name:o.i18n.translate("xpack.ml.navMenu.settingsTabLinkText",{defaultMessage:"Settings"}),disabled:e,testSubj:"mlMainTab settings",highlightNestedRoutes:!0}]},{id:"data_frame_analytics_section",name:o.i18n.translate("xpack.ml.navMenu.dataFrameAnalyticsTabLinkText",{defaultMessage:"Data Frame Analytics"}),disabled:e,items:[{id:"data_frame_analytics_jobs",pathId:p.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,name:o.i18n.translate("xpack.ml.navMenu.dataFrameAnalytics.jobsManagementText",{defaultMessage:"Jobs"}),disabled:e,testSubj:"mlMainTab dataFrameAnalytics"}]},{id:"model_management",name:o.i18n.translate("xpack.ml.navMenu.modelManagementText",{defaultMessage:"Model Management"}),disabled:e,items:[{id:"trained_models",pathId:p.b.TRAINED_MODELS_MANAGE,name:o.i18n.translate("xpack.ml.navMenu.trainedModelsText",{defaultMessage:"Trained Models"}),disabled:e,testSubj:"mlMainTab trainedModels"},{id:"nodes_overview",pathId:p.b.TRAINED_MODELS_NODES,name:o.i18n.translate("xpack.ml.navMenu.nodesOverviewText",{defaultMessage:"Nodes"}),disabled:e||!s,testSubj:"mlMainTab nodesOverview"}]},{id:"datavisualizer",name:o.i18n.translate("xpack.ml.navMenu.dataVisualizerTabLinkText",{defaultMessage:"Data Visualizer"}),disabled:!1,pathId:p.b.DATA_VISUALIZER,testSubj:"mlMainTab dataVisualizer",items:[{id:"filedatavisualizer",pathId:p.b.DATA_VISUALIZER_FILE,name:o.i18n.translate("xpack.ml.navMenu.fileDataVisualizerLinkText",{defaultMessage:"File"}),disabled:!1,testSubj:"mlMainTab fileDataVisualizer"},{id:"data_view_datavisualizer",pathId:p.b.DATA_VISUALIZER_INDEX_SELECT,name:o.i18n.translate("xpack.ml.navMenu.dataViewDataVisualizerLinkText",{defaultMessage:"Data View"}),disabled:!1,testSubj:"mlMainTab indexDataVisualizer"}]}]}),[n,s]),h=Object(i.useCallback)((t=>{const{id:a,disabled:n,items:i,onClick:s,pathId:r,name:o,testSubj:l,highlightNestedRoutes:c}=t,d=null!=s?s:r?b.bind(null,r):void 0,u=`/${r}`===(null==e?void 0:e.path)||!!c&&(null==e?void 0:e.path.includes(`${r}/`));return{id:a,name:o,isSelected:u,disabled:n,...d?{onClick:d}:{},"data-test-subj":l+(u?" selected":""),items:i?i.map(h):void 0,forceOpen:!0}}),[null==e?void 0:e.path,b]);return Object(i.useMemo)((()=>f.map(h)),[f,h])}var f=a(75),h=a.n(f),g=a(86),j=a(96),x=a(8),v=a(150),y=a(47),O=a(115);const E={bool:{must:[{match_all:{}}]}};function w(){return Object(x.cloneDeep)(E)}var M=a(113);const S=(e,t,a,n,s)=>{const r=Object(d.f)(),l=Object.keys(s),c=Object.values(s),u=l.reduce(((e,t)=>(e[t]={},e)),{}),[m,b]=Object(i.useState)(null),[f,h]=Object(i.useState)(u),g=Object(M.a)(p.b.ANOMALY_DETECTION_JOBS_MANAGE);return Object(i.useEffect)((()=>{(async()=>{try{(await Promise.all(c.map((e=>e())))).forEach(((e,t)=>u[l[t]]=e)),h(u)}catch(e){return}try{if(""===e)throw new Error(o.i18n.translate("xpack.ml.useResolver.errorIndexPatternIdEmptyString",{defaultMessage:"dataViewId must not be empty string."}));let i={savedSearch:null,dataView:null};void 0!==t?i=await Object(j.b)(t):void 0!==e&&(i.dataView=await Object(j.c)(e));const{savedSearch:s,dataView:r}=i,{combinedQuery:l}=function(e,t,a){let n={query:"",language:"lucene"},i=w();if(null!==a){const s=Object(j.f)(a);n=s.query;const r=s.filter,o=Array.isArray(r)?r:[];if(n.language===O.c.KUERY){const e=Object(v.d)(n.query);""!==n.query&&(i=Object(v.f)(e,t));const a=Object(v.b)(o,t);!1===Array.isArray(i.bool.filter)&&(i.bool.filter=void 0===i.bool.filter?[]:[i.bool.filter]),!1===Array.isArray(i.bool.must_not)&&(i.bool.must_not=void 0===i.bool.must_not?[]:[i.bool.must_not]),i.bool.filter=[...i.bool.filter,...a.filter],i.bool.must_not=[...i.bool.must_not,...a.must_not]}else{const a=Object(y.getEsQueryConfig)(e);i=Object(v.a)(t,[n],o,a)}}return{query:n,combinedQuery:i}}(a,null!==r?r:void 0,s);b({combinedQuery:l,currentDataView:r,currentSavedSearch:s,dataViewsContract:n,kibanaConfig:a})}catch(e){r.toasts.addError(new Error(e),{title:o.i18n.translate("xpack.ml.useResolver.errorTitle",{defaultMessage:"An error has occurred"})}),await g()}})()}),[]),{context:m,results:f}};var _=a(137),T=a(92);const C={ML_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.machineLearningBreadcrumbLabel",{defaultMessage:"Machine Learning"}),href:"/"}),SETTINGS_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.settingsBreadcrumbLabel",{defaultMessage:"Settings"}),href:"/settings"}),ANOMALY_DETECTION_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.anomalyDetectionBreadcrumbLabel",{defaultMessage:"Anomaly Detection"}),href:"/jobs"}),DATA_FRAME_ANALYTICS_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.dataFrameAnalyticsLabel",{defaultMessage:"Data Frame Analytics"}),href:"/data_frame_analytics"}),TRAINED_MODELS:Object.freeze({text:o.i18n.translate("xpack.ml.modelManagementLabel",{defaultMessage:"Model Management"}),href:"/trained_models"}),DATA_VISUALIZER_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.datavisualizerBreadcrumbLabel",{defaultMessage:"Data Visualizer"}),href:"/datavisualizer"}),CREATE_JOB_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.createJobsBreadcrumbLabel",{defaultMessage:"Create job"}),href:"/jobs/new_job"}),CALENDAR_MANAGEMENT_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagementLabel",{defaultMessage:"Calendar management"}),href:"/settings/calendars_list"}),FILTER_LISTS_BREADCRUMB:Object.freeze({text:o.i18n.translate("xpack.ml.settings.breadcrumbs.filterListsLabel",{defaultMessage:"Filter lists"}),href:"/settings/filter_lists"})},k=(e,t)=>a=>{a.preventDefault(),t(e)},F=(e,t,a)=>({text:C[e].text,...t?{href:`${a}/app/ml${C[e].href}`,onClick:k(C[e].href,t)}:{}});var I=a(12);const D=s.a.lazy((()=>a.e(21).then(a.bind(null,765)))),A=(e,t)=>({id:"overview",path:"/overview",title:o.i18n.translate("xpack.ml.overview.overviewLabel",{defaultMessage:"Overview"}),enableDatePicker:!0,render:(e,t)=>Object(I.jsx)(L,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.overview.overviewLabel",{defaultMessage:"Overview"})}],"data-test-subj":"mlPageOverview"}),L=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=S(void 0,void 0,e.config,e.dataViewsContract,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(m.c)(t),getMlNodeCount:_.a,loadMlServerInfo:T.f});return Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1}),Object(I.jsx)(g.b,{context:a},Object(I.jsx)(i.Suspense,{fallback:null},Object(I.jsx)(D,null)))},R=(e,t)=>({id:"",path:"/",render:()=>Object(I.jsx)(N,null),breadcrumbs:[]}),N=()=>Object(I.jsx)(l.Redirect,{to:"/overview"});var P=a(131),z=a.n(P),B=a(168),J=a(187),V=a(95);const U=({dataViewsContract:e,redirectToMlAccessDeniedPage:t})=>({checkFullLicense:u.b,getMlNodeCount:V.c,loadMlServerInfo:T.f,cacheDataViewsContract:()=>Object(j.a)(e),checkGetJobsCapabilities:()=>Object(m.c)(t),loadSavedSearches:j.h});var G=a(274),q=a(144),W=a(145),H=a(183);const Y=(e,t)=>({id:"anomaly_detection",title:o.i18n.translate("xpack.ml.anomalyDetection.jobs.docTitle",{defaultMessage:"Anomaly Detection Jobs"}),path:"/jobs",render:(e,t)=>Object(I.jsx)($,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.anomalyDetection.jobsManagementLabel",{defaultMessage:"Jobs"})}],"data-test-subj":"mlPageJobManagement",enableDatePicker:!0}),$=({deps:e})=>{var t,a,n;const{context:s}=S(void 0,void 0,e.config,e.dataViewsContract,U(e)),r=Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!0}),o=Object(H.a)(),l=z()(J.a),c=null!==(t=null==l?void 0:l.lastRefresh)&&void 0!==t?t:0,u=null!==(a=o.value)&&void 0!==a?a:0,p=null===(n=o.pause)||void 0===n||n,m=0===u||!0===p;Object(i.useEffect)((()=>{const e=0===u&&!0===p?{pause:!1,value:B.a}:{pause:p,value:u};r.setRefreshInterval(e)}),[]);const b=Object(i.useMemo)((()=>new q.a),[]);return Object(I.jsx)(g.b,{context:s},Object(I.jsx)(W.a.Provider,{value:b},Object(I.jsx)(G.a,{blockRefresh:m,lastRefresh:c})))};var X=a(45),K=a(63),Q=a(91);const Z=({nextStepPath:e})=>{const{uiSettings:t,savedObjects:a}=Object(d.b)().services,n=Object(d.e)();return Object(I.jsx)("div",{"data-test-subj":"mlPageSourceSelection"},Object(I.jsx)(r.EuiPageBody,{restrictWidth:1200},Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.selectDataViewOrSavedSearch",defaultMessage:"Select data view or saved search"})),Object(I.jsx)(r.EuiPageContent,{hasShadow:!1,hasBorder:!0},Object(I.jsx)(K.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:(t,a)=>{n(`${e}?${"index-pattern"===a?"index":"savedSearchId"}=${encodeURIComponent(t)}`)},showFilter:!0,noItemsMessage:o.i18n.translate("xpack.ml.newJob.wizard.searchSelection.notFoundLabel",{defaultMessage:"No matching data views or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:o.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:o.i18n.translate("xpack.ml.newJob.wizard.searchSelection.savedObjectType.dataView",{defaultMessage:"Data view"})}],fixedPageSize:20,uiSettings:t,savedObjects:a}))))};var ee,te=a(83),ae=a(84);async function ne(e,t,a){const{createdBy:n,job:i,datafeed:s}=te.a.tempJobCloningObjects;if(!i||!s)return Promise.resolve();{const i=await async function(e,t){var a;if(null===t)throw new Error("Data views are not initialized!");const[n]=await(null==t?void 0:t.find(e.indices.join(",")));if(!n)return null;return null!==(a=n.id)&&void 0!==a?a:n.title}(s,e);if(null===i)return Promise.resolve();try{const e=await async function(e,t){let a="";switch(e){case ae.a.SINGLE_METRIC:a=ae.f.SINGLE_METRIC;break;case ae.a.MULTI_METRIC:a=ae.f.MULTI_METRIC;break;case ae.a.POPULATION:a=ae.f.POPULATION;break;case ae.a.CATEGORIZATION:a=ae.f.CATEGORIZATION;break;case ae.a.RARE:a=ae.f.RARE;break;default:a=ae.f.ADVANCED}return`jobs/new_job/${a}?index=${t}&_g=()`}(n,i);return await a(`${t}/app/ml/${e}`),Promise.reject()}catch(e){return Promise.resolve()}}}!function(e){e[e.NEW_JOB=0]="NEW_JOB",e[e.DATAVISUALIZER=1]="DATAVISUALIZER"}(ee||(ee={}));const ie=(e,t)=>[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.createJobLabel",{defaultMessage:"Create job"})}],se=(e,t)=>[F("ML_BREADCRUMB",e,t),F("DATA_VISUALIZER_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.selectDateViewLabel",{defaultMessage:"Data View"})}],re=(e,t)=>({path:"/jobs/new_job/step/index_or_search",render:(e,t)=>Object(I.jsx)(le,h()({},e,{nextStepPath:"/jobs/new_job/step/job_type",deps:t,mode:ee.NEW_JOB})),breadcrumbs:ie(e,t)}),oe=(e,t)=>({id:"data_view_datavisualizer",path:"/datavisualizer_index_select",title:o.i18n.translate("xpack.ml.selectDataViewLabel",{defaultMessage:"Select Data View"}),render:(e,t)=>Object(I.jsx)(le,h()({},e,{nextStepPath:"/jobs/new_job/datavisualizer",deps:t,mode:ee.DATAVISUALIZER})),breadcrumbs:se(e,t)}),le=({nextStepPath:e,deps:t,mode:a})=>{const{services:{http:{basePath:n},application:{navigateToUrl:i}}}=Object(d.b)(),{redirectToMlAccessDeniedPage:s}=t,r={...U(t),preConfiguredJobRedirect:()=>ne(t.dataViewsContract,n.get(),i)},o={checkBasicLicense:u.a,cacheDataViewsContract:()=>Object(j.a)(t.dataViewsContract),checkGetJobsCapabilities:()=>Object(m.c)(s)},{context:l}=S(void 0,void 0,t.config,t.dataViewsContract,a===ee.NEW_JOB?r:o);return Object(I.jsx)(g.b,{context:l},Object(I.jsx)(Z,{nextStepPath:e}))};var ce=a(153),de=a(102);function ue(e){return null!==e}const pe=({icon:e,iconAreaLabel:t,title:a,description:n,onClick:i,href:s,isDisabled:o,"data-test-subj":l})=>{const c={...s?{href:s}:{},...i?{onClick:i}:{}};return Object(I.jsx)(r.EuiPanel,{style:{cursor:o?"not-allowed":void 0},hasShadow:!1,hasBorder:!0},Object(I.jsx)(r.EuiLink,h()({style:{display:"block",pointerEvents:o?"none":void 0,background:"transparent",outline:"none"},"data-test-subj":l,color:"subdued"},c),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"l",responsive:!0},Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{paddingTop:"8px"}},"string"==typeof e?Object(I.jsx)(r.EuiIcon,{size:"xl",type:e,"aria-label":t}):e),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h3",null,a)),Object(I.jsx)(r.EuiText,{color:"subdued"},Object(I.jsx)("p",null,n))))))},me=({config:e,indexPattern:t,savedSearch:a})=>{const{services:{http:{basePath:n}}}=Object(d.b)(),i=null===a?`index=${t.id}`:`savedSearchId=${a.id}`,s=`${n.get()}/app/ml/jobs/new_job/recognize?id=${e.id}&${i}`;let o=null;return o=e.logo&&e.logo.icon?Object(I.jsx)(r.EuiIcon,{type:e.logo.icon,size:"xl"}):e.logo&&e.logo.src?Object(I.jsx)("img",{alt:"",src:e.logo.src}):Object(I.jsx)("h3",{className:"euiTitle euiTitle--small"},e.id),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(pe,{"data-test-subj":`mlRecognizerCard ${e.id}`,href:s,title:e.title,description:e.description,icon:o}))};var be=a(73);class data_recognizer_DataRecognizer extends i.Component{constructor(e){super(e),this.state={results:[]},this.indexPattern=e.indexPattern,this.savedSearch=e.savedSearch,this.className=e.className,this.results=e.results}componentDidMount(){be.ml.recognizeIndex({indexPatternTitle:this.indexPattern.title}).then((e=>{e.sort(((e,t)=>e.title.localeCompare(t.title)));const t=e.map((e=>Object(I.jsx)(me,{key:e.id,config:e,indexPattern:this.indexPattern,savedSearch:this.savedSearch})));"object"==typeof this.results&&(this.results.count=t.length,"function"==typeof this.results.onChange&&this.results.onChange()),this.setState({results:t})})).catch((e=>{console.error("Error attempting to recognize index",e)}))}render(){return Object(I.jsx)(s.a.Fragment,null,this.state.results)}}var fe=a(190);const he=Object(I.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(I.jsx)("path",{d:"M16 32C7.16344 32 0 24.8366 0 16C0 7.16344 7.16344 0 16 0C24.8366 0 32 7.16344 32 16H30C30 8.26801 23.732 2 16 2C8.26801 2 2 8.26801 2 16C2 23.732 8.26801 30 16 30V32Z",fill:"#343741"}),Object(I.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 15H23V17H17V23H15V17H9V15H15V9H17V15ZM32 30V32H20V30H32ZM32 22L20 22V24L32 24V22ZM32 26V28H20V26H32Z",fill:"#017D73"})),ge=Object(I.jsx)("svg",{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Object(I.jsx)("path",{d:"M16 32C7.16344 32 0 24.8366 0 16C0 7.16344 7.16344 0 16 0C24.8366 0 32 7.16344 32 16H30C30 8.26801 23.732 2 16 2C8.26801 2 2 8.26801 2 16C2 23.732 8.26801 30 16 30V32Z",fill:"#343741"}),Object(I.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M17 15H23V17H17V23H15V17H9V15H15V9H17V15ZM32 30V32H20V30H32ZM32 22L20 22V24L32 24V22ZM32 26V28H20V26H32Z",fill:"#017D73"})),je=()=>{const{services:{share:e}}=Object(d.b)(),t=Object(de.b)(),a=Object(d.e)(),n=Object(M.a)(p.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX),[l,c]=Object(i.useState)(0),{currentSavedSearch:u,currentDataView:m}=t,b=Object(j.i)(m),f=!b&&ue(u)?o.i18n.translate("xpack.ml.newJob.wizard.jobType.dataViewFromSavedSearchNotTimeBasedMessage",{defaultMessage:"{savedSearchTitle} uses data view {dataViewName} which is not time based",values:{savedSearchTitle:u.attributes.title,dataViewName:m.title}}):o.i18n.translate("xpack.ml.newJob.wizard.jobType.dataViewNotTimeBasedMessage",{defaultMessage:"Data view {dataViewName} is not time based",values:{dataViewName:m.title}}),h=ue(u)?o.i18n.translate("xpack.ml.newJob.wizard.jobType.savedSearchPageTitleLabel",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:u.attributes.title}}):o.i18n.translate("xpack.ml.newJob.wizard.jobType.dataViewPageTitleLabel",{defaultMessage:"data view {dataViewName}",values:{dataViewName:m.title}}),g={count:0,onChange(){c(g.count)}},x=()=>ue(u)?`?savedSearchId=${u.id}`:`?index=${m.id}`,v=[{onClick:()=>a(`/jobs/new_job/single_metric${x()}`),icon:{type:"createSingleMetricJob",ariaLabel:o.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricAriaLabel",{defaultMessage:"Single metric job"})},title:o.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricTitle",{defaultMessage:"Single metric"}),description:o.i18n.translate("xpack.ml.newJob.wizard.jobType.singleMetricDescription",{defaultMessage:"Detect anomalies in a single time series."}),id:"mlJobTypeLinkSingleMetricJob"},{onClick:()=>a(`/jobs/new_job/multi_metric${x()}`),icon:{type:"createMultiMetricJob",ariaLabel:o.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricAriaLabel",{defaultMessage:"Multi-metric job"})},title:o.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricTitle",{defaultMessage:"Multi-metric"}),description:o.i18n.translate("xpack.ml.newJob.wizard.jobType.multiMetricDescription",{defaultMessage:"Detect anomalies with one or more metrics and optionally split the analysis."}),id:"mlJobTypeLinkMultiMetricJob"},{onClick:()=>a(`/jobs/new_job/population${x()}`),icon:{type:"createPopulationJob",ariaLabel:o.i18n.translate("xpack.ml.newJob.wizard.jobType.populationAriaLabel",{defaultMessage:"Population job"})},title:o.i18n.translate("xpack.ml.newJob.wizard.jobType.populationTitle",{defaultMessage:"Population"}),description:o.i18n.translate("xpack.ml.newJob.wizard.jobType.populationDescription",{defaultMessage:"Detect activity that is unusual compared to the behavior of the population."}),id:"mlJobTypeLinkPopulationJob"},{onClick:()=>a(`/jobs/new_job/advanced${x()}`),icon:{type:"createAdvancedJob",ariaLabel:o.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedAriaLabel",{defaultMessage:"Advanced job"})},title:o.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedTitle",{defaultMessage:"Advanced"}),description:o.i18n.translate("xpack.ml.newJob.wizard.jobType.advancedDescription",{defaultMessage:"Use the full range of options to create a job for more advanced use cases."}),id:"mlJobTypeLinkAdvancedJob"},{onClick:()=>a(`/jobs/new_job/categorization${x()}`),icon:{type:he,ariaLabel:o.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationAriaLabel",{defaultMessage:"Categorization job"})},title:o.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationTitle",{defaultMessage:"Categorization"}),description:o.i18n.translate("xpack.ml.newJob.wizard.jobType.categorizationDescription",{defaultMessage:"Group log messages into categories and detect anomalies within them."}),id:"mlJobTypeLinkCategorizationJob"},{onClick:()=>a(`/jobs/new_job/rare${x()}`),icon:{type:ge,ariaLabel:o.i18n.translate("xpack.ml.newJob.wizard.jobType.rareAriaLabel",{defaultMessage:"Rare job"})},title:o.i18n.translate("xpack.ml.newJob.wizard.jobType.rareTitle",{defaultMessage:"Rare"}),description:o.i18n.translate("xpack.ml.newJob.wizard.jobType.rareDescription",{defaultMessage:"Detect rare values in time series data."}),id:"mlJobTypeLinkrareJob"}];return Object(I.jsx)("div",{"data-test-subj":"mlPageJobTypeSelection"},Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.createJobFromTitle",defaultMessage:"Create a job from the {pageTitleLabel}",values:{pageTitleLabel:h}})),!1===b&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiCallOut,{title:f,color:"warning",iconType:"alert"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.howToRunAnomalyDetectionDescription",defaultMessage:"Anomaly detection can only be run over indices which are time based."}),Object(I.jsx)("br",null),Object(I.jsx)(r.EuiLink,{onClick:n},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.selectDifferentIndexLinkText",defaultMessage:"Select a different data view or saved search"}))),Object(I.jsx)(r.EuiSpacer,{size:"xxl"})),Object(I.jsx)("div",{hidden:0===l},Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationTitle",defaultMessage:"Use preconfigured jobs"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useSuppliedConfigurationDescription",defaultMessage:"The fields in your data match known configurations. Create a set of preconfigured jobs."}))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGrid,{gutterSize:"l",columns:4},Object(I.jsx)(data_recognizer_DataRecognizer,{indexPattern:m,savedSearch:u,results:g})),Object(I.jsx)(r.EuiSpacer,{size:"xxl"})),Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.useWizardTitle",defaultMessage:"Use a wizard"}))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGrid,{gutterSize:"l",columns:4},v.map((({onClick:e,icon:t,title:a,description:n,id:i})=>Object(I.jsx)(r.EuiFlexItem,{key:i},Object(I.jsx)(pe,{"data-test-subj":i,onClick:e,icon:t.type,iconAreaLabel:t.ariaLabel,title:a,description:n,isDisabled:!b}))))),Object(I.jsx)(r.EuiSpacer,{size:"xxl"}),Object(I.jsx)(r.EuiText,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataTitle",defaultMessage:"Learn more about your data"}))),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.learnMoreAboutDataDescription",defaultMessage:"If you're not sure what type of job to create, first explore the fields and metrics in your data."}))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGrid,{gutterSize:"l",columns:4},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(pe,{icon:"dataVisualizer",iconAreaLabel:o.i18n.translate("xpack.ml.newJob.wizard.jobType.dataVisualizerAriaLabel",{defaultMessage:"Data Visualizer"}),title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerTitle",defaultMessage:"Data Visualizer"}),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobType.dataVisualizerDescription",defaultMessage:"Learn more about the characteristics of your data and identify the fields for analysis with machine learning."}),onClick:async()=>{const t=ue(u)?u.attributes.title:m.title,n=e.url.locators.get(p.a),i=await n.getUrl({page:p.b.DATA_VISUALIZER_INDEX_VIEWER,pageState:{...null!=u&&u.id?{savedSearchId:u.id}:{index:m.id}}},{absolute:!0});Object(fe.a)(p.b.DATA_VISUALIZER_INDEX_VIEWER,t,i),a(`/jobs/new_job/datavisualizer${x()}`)}}))))},xe=(e,t)=>({path:"/jobs/new_job/step/job_type",render:(e,t)=>Object(I.jsx)(ve,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.selectJobType",{defaultMessage:"Create job"}),href:""}]}),ve=({location:e,deps:t})=>{const{index:a,savedSearchId:n}=Object(ce.parse)(e.search,{sort:!1}),{context:i}=S(a,n,t.config,t.dataViewsContract,U(t));return Object(I.jsx)(g.b,{context:i},Object(I.jsx)(je,null))},ye=()=>({path:"/jobs/new_job",render:()=>Object(I.jsx)(Oe,null),breadcrumbs:[]}),Oe=()=>Object(I.jsx)(l.Redirect,{to:"/jobs/new_job/step/index_or_search"});var Ee=a(25),we=a(28),Me=a(5),Se=a.n(Me),_e=a(80),Te=a(100),Ce=a(147);let ke;!function(e){e[e.ERROR=0]="ERROR",e[e.WARNING=1]="WARNING"}(ke||(ke={}));const Fe=o.i18n.translate("xpack.ml.newJob.wizard.validateJob.asyncJobNameAlreadyExists",{defaultMessage:"Job ID already exists. A job ID cannot be the same as an existing job or group."}),Ie=o.i18n.translate("xpack.ml.newJob.wizard.validateJob.asyncGroupNameAlreadyExists",{defaultMessage:"Group ID already exists. A group ID cannot be the same as an existing group or job."});function De(e){return e.pipe(Object(we.map)((e=>e.jobId)),Object(we.distinctUntilChanged)(((e,t)=>e===t)),Object(we.switchMap)((e=>be.ml.jobs.jobsExist$([e],!0))),Object(we.map)((e=>{const t=Object.values(e),a=!1===(null==t?void 0:t[0].exists);return{jobIdExists:{valid:a,...a?{}:{message:Fe}}}})))}function Ae(e){return e.pipe(Object(we.map)((e=>e.groups)),Object(we.distinctUntilChanged)(((e,t)=>JSON.stringify(e)===JSON.stringify(t))),Object(we.switchMap)((e=>be.ml.jobs.jobsExist$(e,!0))),Object(we.map)((e=>{const t=!1===Object.values(e).some((e=>!0===e.exists&&!1===e.isGroup));return{groupIdsExist:{valid:t,...t?{}:{message:Ie}}}})))}var Le=a(155);class job_validator_JobValidator{constructor(e){var t;Se()(this,"_jobCreator",void 0),Se()(this,"_validationSummary",void 0),Se()(this,"_lastJobConfig",void 0),Se()(this,"_lastDatafeedConfig",void 0),Se()(this,"_validateTimeout",null),Se()(this,"_asyncValidators$",[]),Se()(this,"_asyncValidatorsResult$",void 0),Se()(this,"_basicValidations",{jobId:{valid:!0},groupIds:{valid:!0},modelMemoryLimit:{valid:!0},bucketSpan:{valid:!0},duplicateDetectors:{valid:!0},query:{valid:!0},queryDelay:{valid:!0},frequency:{valid:!0},scrollSize:{valid:!0},categorizerMissingPerPartition:{valid:!0},categorizerVaryingPerPartitionField:{valid:!0},summaryCountField:{valid:!0}}),Se()(this,"_advancedValidations",{categorizationFieldValid:{valid:!0}}),Se()(this,"_validating",!1),Se()(this,"_basicValidationResult$",new Ee.ReplaySubject(2)),Se()(this,"_jobCreatorSubject$",new Ee.Subject),Se()(this,"validationResult$",void 0),Se()(this,"latestValidationResult",this._basicValidations),this._jobCreator=e,this._lastJobConfig=this._jobCreator.formattedJobJson,this._lastDatafeedConfig=this._jobCreator.formattedDatafeedJson,this._validationSummary={basic:!1,advanced:!1},this._asyncValidators$=[(t=this._jobCreatorSubject$,Object(Ee.combineLatest)([t.pipe(Object(we.pluck)("modelPlot")),t.pipe(Object(we.filter)((e=>null==e?void 0:e.modelPlot)),Object(we.map)((e=>({jobCreator:e,analysisConfigString:JSON.stringify(e.jobConfig.analysis_config,null,2)}))),Object(we.distinctUntilChanged)(((e,t)=>e.analysisConfigString===t.analysisConfigString)),Object(we.switchMap)((({jobCreator:e})=>be.ml.validateCardinality$({...e.jobConfig,datafeed_config:e.datafeedConfig}).pipe(Object(we.map)((e=>{for(const t of e)if(void 0!==t.modelPlotCardinality)return{highCardinality:{value:t.modelPlotCardinality,severity:ke.WARNING}};return null}))))),Object(we.startWith)(null))]).pipe(Object(we.map)((([e,t])=>e?t:null)))),De(this._jobCreatorSubject$),Ae(this._jobCreatorSubject$)],this._asyncValidatorsResult$=Object(Ee.combineLatest)(this._asyncValidators$).pipe(Object(we.map)((e=>e.reduce(((e,t)=>({...e,...t||{}})),{}))),Object(we.startWith)({})),this.validationResult$=Object(Ee.combineLatest)([this._basicValidationResult$,this._asyncValidatorsResult$]).pipe(Object(we.map)((([e,t])=>({...e,...t}))),Object(we.tap)((e=>{this.latestValidationResult=e})))}validate(e,t=!1){this._validating=!0;const a=this._jobCreator.formattedJobJson,n=this._jobCreator.formattedDatafeedJson;this._runAdvancedValidation(),t||a!==this._lastJobConfig||n!==this._lastDatafeedConfig?(null!==this._validateTimeout&&clearTimeout(this._validateTimeout),this._lastJobConfig=a,this._lastDatafeedConfig=n,this._validateTimeout=setTimeout((()=>{this._runBasicValidation(),this._jobCreatorSubject$.next(this._jobCreator),this._validating=!1,this._validateTimeout=null,e()}),500)):this._validating=null!==this._validateTimeout,e()}_resetBasicValidations(){this._validationSummary.basic=!0,Object.values(this._basicValidations).forEach((e=>{e.valid=!0,delete e.message}))}_runBasicValidation(){this._resetBasicValidations();const e=this._jobCreator.jobConfig,t=this._jobCreator.datafeedConfig,a=Object(T.d)(),n=Object(_e.e)(e,void 0,a);Object(Ce.b)(n,this._basicValidations,e,t);const i=Object(_e.c)(t);Object(Ce.b)(i,this._basicValidations,e,t);const s=Object(_e.d)(e,t);Object(Ce.b)(s,this._basicValidations,e,t),this._validationSummary.basic=this._isOverallBasicValid(),this._basicValidationResult$.next(this._basicValidations)}_runAdvancedValidation(){Object(Te.b)(this._jobCreator)&&(this._advancedValidations.categorizationFieldValid.valid=this._jobCreator.overallValidStatus!==Le.a.INVALID)}_isOverallBasicValid(){return!1===Object.values(this._basicValidations).some((e=>!1===e.valid))}get validationSummary(){return this._validationSummary}get bucketSpan(){return this._basicValidations.bucketSpan}get summaryCountField(){return this._basicValidations.summaryCountField}get duplicateDetectors(){return this._basicValidations.duplicateDetectors}get jobId(){return this._basicValidations.jobId}get groupIds(){return this._basicValidations.groupIds}get modelMemoryLimit(){return this._basicValidations.modelMemoryLimit}get query(){return this._basicValidations.query}get queryDelay(){return this._basicValidations.queryDelay}get frequency(){return this._basicValidations.frequency}get scrollSize(){return this._basicValidations.scrollSize}set advancedValid(e){this._validationSummary.advanced=e}get validating(){return this._validating}get categorizationField(){return this._advancedValidations.categorizationFieldValid.valid}set categorizationField(e){this._advancedValidations.categorizationFieldValid.valid=e}get categorizerMissingPerPartition(){return this._basicValidations.categorizerMissingPerPartition}get categorizerVaryingPerPartitionField(){return this._basicValidations.categorizerVaryingPerPartitionField}get isPickFieldsStepValid(){return this._jobCreator.detectors.length>0&&(this._jobCreator.type!==ae.f.ADVANCED||this._jobCreator.type===ae.f.ADVANCED&&this.modelMemoryLimit.valid)&&this.bucketSpan.valid&&this.duplicateDetectors.valid&&this.categorizerMissingPerPartition.valid&&this.categorizerVaryingPerPartitionField.valid&&this.summaryCountField.valid&&!this.validating&&(this._jobCreator.type!==ae.f.CATEGORIZATION||this._jobCreator.type===ae.f.CATEGORIZATION&&this.categorizationField)}get isModelMemoryEstimationPayloadValid(){return this._jobCreator.detectors.length>0&&this.bucketSpan.valid&&this.duplicateDetectors.valid&&(this._jobCreator.type!==ae.f.CATEGORIZATION||this._jobCreator.type===ae.f.CATEGORIZATION&&this.categorizationField)}}var Re=a(27);const Ne=(e,t,a,n)=>{const{services:{notifications:s}}=Object(d.b)(),r=Object(i.useMemo)((()=>((e,t)=>{const a=new Ee.Subject,n=new Ee.Subject;return{get error$(){return n.asObservable()},get updates$(){return Object(Ee.combineLatest)([e.wizardInitialized$.pipe(Object(we.skipWhile)((e=>!1===e))),a]).pipe(Object(we.map)((([,e])=>e)),Object(we.debounceTime)(600),Object(we.map)(x.cloneDeep),Object(we.distinctUntilChanged)(x.isEqual),Object(we.filter)((()=>t.isModelMemoryEstimationPayloadValid)),Object(we.switchMap)((e=>be.ml.calculateModelMemoryLimit$(e).pipe(Object(we.pluck)("modelMemoryLimit"),Object(we.catchError)((e=>(console.error("Model memory limit could not be calculated",e.body),n.next(e),Object(Ee.of)(ae.c))))))))},update(e){a.next(e)}}})(e,t)),[]);Object(i.useEffect)((()=>{const t=new Ee.Subscription;return t.add(r.updates$.pipe(Object(we.startWith)(e.modelMemoryLimit),Object(we.pairwise)()).subscribe((([t,n])=>{null!==e.modelMemoryLimit&&e.modelMemoryLimit!==t||(e.modelMemoryLimit=n,a())}))),t.add(r.error$.subscribe((e=>{s.toasts.addWarning({title:o.i18n.translate("xpack.ml.newJob.wizard.estimateModelMemoryError",{defaultMessage:"Model memory limit could not be calculated"}),text:Object(Re.b)(e)})}))),()=>{t.unsubscribe()}}),[]),Object(i.useEffect)((()=>{r.update({datafeedConfig:e.datafeedConfig,analysisConfig:e.jobConfig.analysis_config,indexPattern:e.indexPatternTitle,query:e.datafeedConfig.query,timeFieldName:e.jobConfig.data_description.time_field,earliestMs:e.start,latestMs:e.end})}),[n])};let Pe;!function(e){e[e.TIME_RANGE=0]="TIME_RANGE",e[e.ADVANCED_CONFIGURE_DATAFEED=1]="ADVANCED_CONFIGURE_DATAFEED",e[e.PICK_FIELDS=2]="PICK_FIELDS",e[e.JOB_DETAILS=3]="JOB_DETAILS",e[e.VALIDATION=4]="VALIDATION",e[e.SUMMARY=5]="SUMMARY"}(Pe||(Pe={}));const ze=Object(i.createContext)({jobCreatorUpdated:0,jobCreatorUpdate:()=>{},jobCreator:{},chartLoader:{},resultsLoader:{},chartInterval:{},jobValidator:{},jobValidatorUpdated:0,fields:[],aggs:[],existingJobsAndGroups:{}});var Be=a(99),Je=a(24),Ve=a.n(Je);const Ue=({previous:e,previousActive:t=!0,next:a,nextActive:n=!0,children:s})=>Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,null),Object(I.jsx)(r.EuiFlexGroup,null,e&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Ge,{previous:e,previousActive:t})),a&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(qe,{next:a,nextActive:n})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},s),Object(I.jsx)(r.EuiFlexItem,null))),Ge=({previous:e,previousActive:t=!0})=>Object(I.jsx)(r.EuiButtonEmpty,{disabled:!t,onClick:e,iconType:"arrowLeft",iconSide:"left","data-test-subj":"mlJobWizardNavButtonPrevious"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.previousStepButton",defaultMessage:"Previous"})),qe=({next:e,nextActive:t=!0})=>Object(I.jsx)(r.EuiButton,{fill:!0,disabled:!t,onClick:e,iconSide:"right",iconType:"arrowRight","data-test-subj":"mlJobWizardNavButtonNext"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.nextStepButton",defaultMessage:"Next"}));var We=a(36),He=a.n(We),Ye=a(26),$e=a(6);const Xe=e=>{const t={term:{_tier:{value:"data_frozen"}}};if(!e)return{bool:{must_not:[t]}};const a=Object(x.cloneDeep)(e);return delete a.match_all,Object($e.b)(a.bool)?Array.isArray(a.bool.must_not)?a.bool.must_not.push(t):(Object($e.b)(a.bool.must_not)&&(a.bool.must_not=[a.bool.must_not,t]),void 0===a.bool.must_not&&(a.bool.must_not=[t])):a.bool={must_not:[t]},a};function Ke(){const e=Object(Ye.k)(),t=He.a.parse(e.getTime().from),a=He.a.parse(e.getTime().to),n=void 0!==t?t.valueOf():0;return{to:void 0!==a?a.valueOf():0,from:n}}var Qe=a(193),Ze=a(194);const et="exclude-frozen",tt="include-frozen",at=({dataView:e,query:t,disabled:a,callback:n})=>{async function s(e,t,a=!0){const i=await async function(e,t,a){try{const n=Object(Ye.k)(),i=e.getComputedFields().runtimeFields,s=await be.ml.getTimeFieldRange({index:e.title,timeFieldName:e.timeFieldName,query:a?Xe(t):t,...Object($e.b)(i)?{runtimeMappings:i}:{}});return n.setTime({from:Ve()(s.start.epoch).toISOString(),to:Ve()(s.end.epoch).toISOString()}),s}catch(e){return Object(Ye.l)().addDanger(o.i18n.translate("xpack.ml.fullTimeRangeSelector.errorSettingTimeRangeNotification",{defaultMessage:"An error occurred setting the time range."})),e}}(e,t,a);"function"==typeof n&&n(i)}const[l,c]=Object(i.useState)(!1),[d,u]=Object(Qe.a)(Ze.c,et),p=()=>{c(!1)},m=Object(i.useMemo)((()=>[{id:et,label:o.i18n.translate("xpack.ml.fullTimeRangeSelector.useFullDataExcludingFrozenMenuLabel",{defaultMessage:"Exclude frozen data tier"})},{id:tt,label:o.i18n.translate("xpack.ml.fullTimeRangeSelector.useFullDataIncludingFrozenMenuLabel",{defaultMessage:"Include frozen data tier"})}]),[]),b=Object(i.useCallback)((a=>{u(a),s(e,t,a===et),p()}),[]),f=Object(i.useMemo)((()=>Object(I.jsx)(r.EuiPanel,null,Object(I.jsx)(r.EuiRadioGroup,{options:m,idSelected:d,onChange:b,compressed:!0}))),[d,m]),h=Object(i.useMemo)((()=>d===et?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.fullTimeRangeSelector.useFullDataExcludingFrozenButtonTooltip",defaultMessage:"Use full range of data excluding frozen data tier."}):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.fullTimeRangeSelector.useFullDataIncludingFrozenButtonTooltip",defaultMessage:"Use full range of data including frozen data tier, which might have slower search results."})),[d]);return Object(I.jsx)(r.EuiFlexGroup,{responsive:!1,gutterSize:"xs",alignItems:"center"},Object(I.jsx)(r.EuiToolTip,{content:h},Object(I.jsx)(r.EuiButton,{isDisabled:a,onClick:()=>s(e,t,!0),"data-test-subj":"mlButtonUseFullData"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.fullTimeRangeSelector.useFullDataButtonLabel",defaultMessage:"Use full data"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiPopover,{id:"mlFullTimeRangeSelectorOption",button:Object(I.jsx)(r.EuiButtonIcon,{display:"base",size:"m",iconType:"boxesVertical","aria-label":"More",onClick:()=>{c(!l)}}),isOpen:l,closePopover:p,panelPaddingSize:"none",anchorPosition:"downRight"},f)))};var nt=a(216),it=a(154);const st=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.title",{defaultMessage:"Groups"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.description",defaultMessage:" Optional grouping for jobs. New groups can be created or picked from the list of existing groups."})},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))})),rt=Object(i.memo)((({existingGroups:e,selectedGroups:t,onChange:a,validation:n})=>{const i=e.map((e=>({label:e,color:Object(it.a)(e)}))),s=t.map((e=>({label:e,color:Object(it.a)(e)})));function l(e){a(e.map((e=>e.label)))}return Object(I.jsx)(st,{validation:n},Object(I.jsx)(r.EuiComboBox,{placeholder:o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:i,selectedOptions:s,onChange:l,onCreateOption:function(e,t){const a=e.trim().toLowerCase();if(!a)return;const n={label:e,color:Object(it.a)(e)};-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&i.push(n),l([...s,n])},isClearable:!0,isInvalid:!n.valid,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))})),ot=({setTimeRange:e,timeRange:t})=>{const a=Object(de.b)().kibanaConfig.get("dateFormat"),[n,s]=Object(i.useState)(Ve()(t.start)),[l,c]=Object(i.useState)(Ve()(t.end));return Object(i.useEffect)((()=>{void 0!==n&&void 0!==l&&e({start:n.valueOf(),end:l.valueOf()})}),[n,l]),Object(i.useEffect)((()=>{s(Ve()(t.start)),c(Ve()(t.end))}),[JSON.stringify(t)]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)("div",{style:{minWidth:"512px"},"data-test-subj":"mlJobWizardDateRange"},Object(I.jsx)(r.EuiDatePickerRange,{fullWidth:!0,startDateControl:Object(I.jsx)(r.EuiDatePicker,{selected:n,onChange:function(e){s(e||void 0)},startDate:n,endDate:l,"aria-label":o.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.startDateLabel",{defaultMessage:"Start date"}),showTimeSelect:!0,dateFormat:a,maxDate:l}),endDateControl:Object(I.jsx)(r.EuiDatePicker,{selected:l,onChange:function(e){c(e||void 0)},startDate:n,endDate:l,"aria-label":o.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.timeRangePicker.endDateLabel",{defaultMessage:"End date"}),showTimeSelect:!0,dateFormat:a,minDate:n})})))},lt=({setCurrentStep:e,isCurrentStep:t})=>{const{services:a}=Object(d.b)(),n=Object(de.b)(),{jobCreator:s,jobCreatorUpdate:l,jobCreatorUpdated:c,chartLoader:u,chartInterval:p}=Object(i.useContext)(ze),[m,b]=Object(i.useState)({start:s.start,end:s.end}),[f,h]=Object(i.useState)([]),[g,j]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{const{start:e,end:t}=m;s.setTimeRange(e,t),p.setBounds({min:Ve()(e),max:Ve()(t)});const{timefilter:n}=a.data.query.timefilter;n.setTime({from:Ve()(e).toISOString(),to:Ve()(t).toISOString()}),l(),async function(){j(!0);try{var e;const t=await u.loadEventRateChart(s.start,s.end,p.getInterval().asMilliseconds(),null!==(e=s.runtimeMappings)&&void 0!==e?e:void 0,s.datafeedConfig.indices_options);h(t)}catch(e){h([])}j(!1)}()}),[JSON.stringify(m)]),Object(i.useEffect)((()=>{b({start:s.start,end:s.end})}),[c]),Object(I.jsx)(i.Fragment,null,t&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(ot,{setTimeRange:b,timeRange:m})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(at,{dataView:n.currentDataView,query:n.combinedQuery,disabled:!1,callback:function(e){if(null!==e.start.epoch&&null!==e.end.epoch)b({start:e.start.epoch,end:e.end.epoch});else{const{toasts:e}=a.notifications;e.addDanger(o.i18n.translate("xpack.ml.newJob.wizard.timeRangeStep.fullTimeRangeError",{defaultMessage:"An error occurred obtaining the time range for the index"}))}}})),Object(I.jsx)(r.EuiFlexItem,null)),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(nt.a,{eventRateChartData:f,height:"300px",width:"100%",showAxis:!0,loading:g}),Object(I.jsx)(Ue,{next:()=>e(s.type===ae.f.ADVANCED?Pe.ADVANCED_CONFIGURE_DATAFEED:Pe.PICK_FIELDS),nextActive:!0})))},ct=({fields:e,changeHandler:t,selectedOptions:a,removeOptions:n})=>{const{jobValidator:s,jobValidatorUpdated:o}=Object(i.useContext)(ze),[l,c]=Object(i.useState)(s.duplicateDetectors),d=n.map(dt),u=e.map((e=>{const t={label:e.name,options:[]};return void 0!==e.aggs&&(t.options=e.aggs.filter((e=>null!==e.dslName)).map((t=>({label:`${t.title}(${e.name})`,agg:t,field:e}))).filter((e=>!1===d.includes(e.label)))),t}));return Object(i.useEffect)((()=>{c(s.duplicateDetectors)}),[o]),Object(I.jsx)(r.EuiFormRow,{error:l.message,isInvalid:!1===l.valid,"data-test-subj":"mlJobWizardAggSelection"},Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:u,selectedOptions:a,onChange:t,isClearable:!1,isInvalid:!1===l.valid}))};function dt(e){return`${e.agg.title}(${e.field.name})`}var ut=a(192),pt=a(48),mt=a(305),bt=a(126);const ft={...bt.c,area:{...bt.c.area,visible:!0},line:{...bt.c.line,strokeWidth:1,opacity:.4}},ht=({modelData:e})=>{const{MODEL_COLOR:t}=Object(bt.d)(),a=void 0===e?[]:e;return Object(I.jsx)(pt.AreaSeries,{id:"model",xScaleType:pt.ScaleType.Time,yScaleType:pt.ScaleType.Linear,xAccessor:"time",yAccessors:["modelUpper"],y0Accessors:["modelLower"],data:a,curve:pt.CurveType.CURVE_MONOTONE_X,areaSeriesStyle:ft,color:t})},gt={...bt.c},jt=({chartData:e})=>{const{LINE_COLOR:t}=Object(bt.d)();return Object(I.jsx)(pt.LineSeries,{id:"line",xScaleType:pt.ScaleType.Time,yScaleType:pt.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:e,curve:pt.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:gt,color:t})},xt={...bt.c,line:{...bt.c.line,visible:!1},point:{...bt.c.point,visible:!0}},vt=({chartData:e})=>{const{LINE_COLOR:t}=Object(bt.d)();return Object(I.jsx)(pt.LineSeries,{id:"scatter",xScaleType:pt.ScaleType.Time,yScaleType:pt.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:e,curve:pt.CurveType.CURVE_MONOTONE_X,lineSeriesStyle:xt,color:t})};var yt=a(302),Ot=a(303),Et=a(286);let wt;!function(e){e[e.LINE=0]="LINE",e[e.SCATTER=1]="SCATTER"}(wt||(wt={}));const Mt=({chartType:e,chartData:t=[],modelData:a,anomalyData:n,height:i,width:s,loading:r=!1})=>{const o=e===wt.SCATTER?function(e){return e.reduce(((e,t)=>(e.push(...t.values.map((e=>({time:t.time,value:e.value})))),e)),[])}(t):t,l=Object(Ot.a)(o);return Object(I.jsx)("div",{style:{width:s,height:i},"data-test-subj":`mlAnomalyChart ${wt[e]}`},Object(I.jsx)(Et.a,{height:i,hasData:o.length>0,loading:r},Object(I.jsx)(pt.Chart,null,Object(I.jsx)(pt.Settings,{xDomain:l,tooltip:pt.TooltipType.None}),Object(I.jsx)(yt.a,{chartData:o}),Object(I.jsx)(mt.a,{anomalyData:n}),Object(I.jsx)(ht,{modelData:a}),e===wt.LINE&&Object(I.jsx)(jt,{chartData:o}),e===wt.SCATTER&&Object(I.jsx)(vt,{chartData:o}))))};var St=a(77);const _t=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n,chartLoader:s,chartInterval:r}=Object(i.useContext)(ze),o=t,l=Object(i.useMemo)((()=>Object(ut.b)([...Be.b.fields,...o.runtimeFields])),[]),[c,d]=Object(i.useState)(null!==o.aggFieldPair?[{label:dt(o.aggFieldPair)}]:[]),[u,p]=Object(i.useState)(o.aggFieldPair),[m,b]=Object(i.useState)({}),[f,h]=Object(i.useState)(!1),[g,j]=Object(i.useState)(o.start),[x,v]=Object(i.useState)(o.end),[y,O]=Object(i.useState)(o.bucketSpanMs);async function E(){if(null!==u){h(!0);try{const e=Object(bt.b)(o,r),t=await s.loadLineCharts(o.start,o.end,[u],null,null,e.intervalMs,o.runtimeMappings,o.datafeedConfig.indices_options);void 0!==t[0]&&b(t)}catch(e){Object(St.a)().displayErrorToast(e),b({})}h(!1)}}return Object(i.useEffect)((()=>{null!==u&&(o.setDetector(u.agg,u.field),a(),E(),e(null!==u))}),[u]),Object(i.useEffect)((()=>{o.start===g&&o.end===x||(j(o.start),v(o.end),E()),o.bucketSpanMs!==y&&(O(o.bucketSpanMs),E())}),[n]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(ct,{fields:l,changeHandler:function(e){if(d(e),e.length){const t=e[0];p(void 0!==t?{agg:t.agg,field:t.field}:null)}},selectedOptions:c,removeOptions:[]}),(void 0!==m[0]||!0===f)&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Mt,{chartType:wt.LINE,chartData:m[0],modelData:[],anomalyData:[],height:"300px",width:"100%",loading:f})))},Tt=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:n}=Object(i.useContext)(ze),s=e,[r,o]=Object(i.useState)({}),[l,c]=Object(i.useState)(!1),[d,u]=Object(i.useState)([]),[p,m]=Object(i.useState)([]);function b(e){const t=e.model[0];void 0!==t&&u(t);const a=e.anomalies[0];void 0!==a&&m(a)}return Object(i.useEffect)((()=>{const e=a.subscribeToResults(b);return async function(){if(null!==s.aggFieldPair){c(!0);try{const e=Object(bt.b)(s,n),a=await t.loadLineCharts(s.start,s.end,[s.aggFieldPair],null,null,e.intervalMs,s.runtimeMappings,s.datafeedConfig.indices_options);void 0!==a[0]&&o(a)}catch(e){Object(St.a)().displayErrorToast(e),o({})}c(!1)}}(),()=>{e.unsubscribe()}}),[]),Object(I.jsx)(i.Fragment,null,(void 0!==r[0]||!0===l)&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Mt,{chartType:wt.LINE,chartData:r[0],modelData:d,anomalyData:p,height:"300px",width:"100%",loading:l})))};var Ct=a(93);const kt=({bucketSpan:e,setBucketSpan:t,isInvalid:a,disabled:n})=>Object(I.jsx)(r.EuiFieldText,{disabled:n,placeholder:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.placeholder",{defaultMessage:"Bucket span"}),value:e,onChange:e=>t(e.target.value),isInvalid:a,"data-test-subj":"mlJobWizardInputBucketSpan"}),Ft=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.title",{defaultMessage:"Bucket span"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpan.description",defaultMessage:"Set the interval for time series analysis, typically between 15m to 1h."})},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))}));var It=a(128),Dt=a(120);let At;!function(e){e[e.NOT_RUNNING=0]="NOT_RUNNING",e[e.RUNNING=1]="RUNNING"}(At||(At={}));const Lt=({setEstimating:e})=>{const{jobCreator:t,jobCreatorUpdate:a}=Object(i.useContext)(ze),{status:n,estimateBucketSpan:s}=function(){var e;const{jobCreator:t,jobCreatorUpdate:a}=Object(i.useContext)(ze),n=Object(de.b)(),[s,r]=Object(i.useState)(At.NOT_RUNNING),l={aggTypes:t.aggregations.map((e=>e.dslName)),duration:{start:t.start,end:t.end},fields:t.fields.map((e=>e.id===Dt.a?null:e.id)),index:n.currentDataView.title,query:n.combinedQuery,splitField:void 0,timeField:n.currentDataView.timeFieldName,runtimeMappings:null!==(e=t.runtimeMappings)&&void 0!==e?e:void 0,indicesOptions:t.datafeedConfig.indices_options};if(Object(Te.c)(t)&&null!==t.splitField)l.splitField=t.splitField.id;else if(Object(Te.d)(t)&&null!==t.populationField)l.splitField=t.populationField.id;else if(Object(Te.e)(t)){var c;l.fields=[null],t.populationField?l.splitField=t.populationField.id:l.splitField=null===(c=t.rareField)||void 0===c?void 0:c.id}else Object(Te.a)(t)&&t.richDetectors.some((e=>null!==e.partitionField?(l.splitField=e.partitionField.id,!0):null!==e.overField?(l.splitField=e.overField.id,!0):null!==e.byField?(l.splitField=e.byField.id,!0):void 0));return{status:s,estimateBucketSpan:async function(){r(At.RUNNING);const{name:e,error:n,message:i}=await be.ml.estimateBucketSpan(l);if(r(At.NOT_RUNNING),!0===n){const e=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.bucketSpanEstimator.errorTitle",{defaultMessage:"Bucket span could not be estimated"});Object(St.a)().displayWarningToast({title:e,text:i})}else t.bucketSpan=e,a()}}}(),[l,c]=Object(i.useState)(0===t.detectors.length),[d,u]=Object(i.useState)(p());function p(){return Object(Te.a)(t)&&t.detectors.some((e=>{if(e.partition_field_name===It.b||e.over_field_name===It.b||e.by_field_name===It.b)return!0}))}return Object(i.useEffect)((()=>{e(n===At.RUNNING)}),[n]),Object(i.useEffect)((()=>{c(0===t.detectors.length),u(p())}),[a]),Object(I.jsx)(r.EuiButton,{disabled:n===At.RUNNING||!0===l||!0===d,onClick:s},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.bucketSpanEstimatorButton",defaultMessage:"Estimate bucket span"}))},Rt=({setIsValid:e,hideEstimateButton:t=!1})=>{const{jobCreator:a,jobCreatorUpdate:n,jobCreatorUpdated:s,jobValidator:o,jobValidatorUpdated:l}=Object(i.useContext)(ze),[c,d]=Object(i.useState)(a.bucketSpan),[u,p]=Object(i.useState)(o.bucketSpan),[m,b]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{a.bucketSpan=c,n()}),[c]),Object(i.useEffect)((()=>{d(a.bucketSpan)}),[s]),Object(i.useEffect)((()=>{p(o.bucketSpan)}),[l]),Object(i.useEffect)((()=>{e(!1===m)}),[m]),Object(I.jsx)(Ft,{validation:u},Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(kt,{setBucketSpan:d,bucketSpan:c,isInvalid:!1===u.valid,disabled:m})),!1===t&&Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Lt,{setEstimating:b}))))},Nt=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.sparseData.description",defaultMessage:"Select if you wish to ignore empty buckets from being considered anomalous. Available for count and sum analysis."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))}));var Pt=a(94);const zt=()=>{const{jobCreator:e,jobCreatorUpdated:t,jobCreatorUpdate:a}=Object(i.useContext)(ze),[n,s]=Object(i.useState)(e.sparseData),[l,c]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{e.sparseData=n,a()}),[n]),Object(i.useEffect)((()=>{const t=[Pt.a.COUNT,Pt.a.SUM],a=e.aggregations.some((e=>null!==e.dslName&&t.includes(e.dslName)));c(a),!1===a&&!0===n&&s(!1)}),[t]),Object(I.jsx)(Nt,null,Object(I.jsx)(r.EuiSwitch,{name:"switch",disabled:!1===l,checked:n,onChange:function(){s(!n)},"data-test-subj":"mlJobWizardSwitchSparseData",label:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.sparseData.title",{defaultMessage:"Sparse data"})}))},Bt=({setIsValid:e})=>{const{jobCreator:t}=Object(i.useContext)(ze),a=Object(d.e)();return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Rt,{setIsValid:e})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(zt,null))),Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{onClick:()=>{Object(Ct.e)(t,a)}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.singleMetricView.convertToMultiMetricButton",defaultMessage:"Convert to multi-metric job"})))))},Jt=({isActive:e,setCanProceed:t})=>{const[a,n]=Object(i.useState)(!1),[s,o]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(I.jsx)(i.Fragment,null,!1===e?Object(I.jsx)(Tt,null):Object(I.jsx)(i.Fragment,null,Object(I.jsx)(_t,{setIsValid:n}),a&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(Bt,{setIsValid:o}))))},Vt=({fields:e,detectorChangeHandler:t,selectedOptions:a,maxWidth:n,removeOptions:i})=>Object(I.jsx)(r.EuiFlexGroup,{style:{maxWidth:void 0!==n?n:560}},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.multiMetricView.addMetric",{defaultMessage:"Add metric"})},Object(I.jsx)(ct,{fields:e,changeHandler:t,selectedOptions:a,removeOptions:i})))),Ut=Object(i.memo)((({fieldValues:e,splitField:t,children:a,numberOfDetectors:n,jobType:o,animate:l=!1})=>{const c=[];return Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlDataSplit"},(0===e.length||0===n)&&Object(I.jsx)(s.a.Fragment,null,a),e.length>0&&n>0&&null!==t&&Object(I.jsx)(i.Fragment,null,o===ae.f.MULTI_METRIC&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)("div",{style:{fontSize:"small"},"data-test-subj":`mlDataSplitTitle ${t.name}`},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitCards.dataSplitBy",defaultMessage:"Data split by {field}",values:{field:t.name}})),Object(I.jsx)(r.EuiSpacer,{size:"m"})),function(){c.length=0;const t=[...e];t.shift();let a=5;const n=t.map(((e,t)=>a+=10-t)).reverse();return!0===l&&setTimeout((()=>{c.forEach((e=>e.panel.style.marginBottom=`${e.marginBottom}px`))}),100),t.map(((e,a)=>{const i=-100+(a+1)*(10/t.length*1.6),s=n[a],o={height:"100px",marginBottom:"-100px",marginLeft:`${s}px`,marginRight:`${s}px`,...l?{transition:"margin 0.5s"}:{}};return Object(I.jsx)("div",{key:e,ref:e=>function(e,t){null!==e&&(!1===l&&(e.style.marginBottom=`${t}px`),c.push({panel:e,marginBottom:t}))}(e,i),style:o},Object(I.jsx)(r.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard back"},Object(I.jsx)("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},e)))}))}(),Object(I.jsx)(r.EuiPanel,{paddingSize:"m",style:{paddingTop:"4px"},"data-test-subj":"mlSplitCard front"},Object(I.jsx)("div",{style:{fontWeight:"bold",fontSize:"small"},"data-test-subj":"mlSplitCardTitle"},e[0]),Object(I.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(I.jsx)(s.a.Fragment,null,a)))))}));function Gt(){const[e,t]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{setTimeout((()=>{t(!0)}),1e3)}),[]),e}const qt=({index:e,agg:t,field:a,byField:n,deleteDetector:i,children:s})=>{const l=!1===s&&void 0!==n?n.field:null;return Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s",justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)("span",{style:{fontSize:"small"},"data-test-subj":"mlDetectorTitle"},function(e,t,a){const n=`${e.title}(${t.name})`;return null===a?n:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.detectorTitle.placeholder",{defaultMessage:"{title} split by {field}",values:{title:n,field:a.name}})}(t,a,l))),!1!==s&&Object(I.jsx)(r.EuiFlexItem,{style:{width:"100%",maxWidth:"400px"}},s),Object(I.jsx)(r.EuiFlexItem,{grow:!1},void 0!==i&&Object(I.jsx)(r.EuiButtonIcon,{color:"danger",onClick:()=>i(e),iconType:"cross",size:"s","aria-label":"Next"})))};const Wt=({aggFieldPairList:e,chartSettings:t,splitField:a,fieldValues:n,lineChartsData:s,modelData:o,anomalyData:l,deleteDetector:c,jobType:d,loading:u=!1})=>{const p=Gt();return Object(I.jsx)(Ut,{fieldValues:n,splitField:a,numberOfDetectors:e.length,jobType:d,animate:p},Object(I.jsx)(r.EuiFlexGrid,{columns:t.cols},e.map(((a,n)=>Object(I.jsx)(r.EuiFlexItem,{key:n,"data-test-subj":`mlDetector ${n}`},Object(I.jsx)(i.Fragment,null,Object(I.jsx)(qt,{index:n,agg:e[n].agg,field:e[n].field,deleteDetector:c}),Object(I.jsx)(Mt,{chartType:wt.LINE,chartData:s[n],modelData:o[n],anomalyData:l[n],height:t.height,width:t.width,loading:u})))))))},Ht=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n,chartLoader:s,chartInterval:r}=Object(i.useContext)(ze),o=t,l=Object(i.useMemo)((()=>Object(ut.b)([...Be.b.fields,...o.runtimeFields])),[]),[c,d]=Object(i.useState)([]),[u,p]=Object(i.useState)(o.aggFieldPairs),[m,b]=Object(i.useState)({}),[f,h]=Object(i.useState)(!1),[g,j]=Object(i.useState)(o.start),[x,v]=Object(i.useState)(o.end),[y,O]=Object(i.useState)(o.bucketSpanMs),[E,w]=Object(i.useState)(bt.a),[M,S]=Object(i.useState)(o.splitField),[_,T]=Object(i.useState)([]),[C,k]=Object(i.useState)(!1);async function F(){if(C&&u.length>0&&(null===M||null!==M&&_.length>0)){h(!0);try{const e=Object(bt.b)(o,r);w(e);const t=await s.loadLineCharts(o.start,o.end,u,o.splitField,_.length>0?_[0]:null,e.intervalMs,o.runtimeMappings,o.datafeedConfig.indices_options);b(t)}catch(e){Object(St.a)().displayErrorToast(e),b([])}h(!1)}}return Object(i.useEffect)((()=>{k(!0)}),[]),Object(i.useEffect)((()=>{o.removeAllDetectors(),u.forEach((e=>{o.addDetector(e.agg,e.field)})),a(),F(),e(u.length>0)}),[u.length]),Object(i.useEffect)((()=>{o.start===g&&o.end===x||(j(o.start),v(o.end),F()),o.bucketSpanMs!==y&&(O(o.bucketSpanMs),F()),S(o.splitField)}),[n]),Object(i.useEffect)((()=>{null!==M?s.loadFieldExampleValues(M,o.runtimeMappings,o.datafeedConfig.indices_options).then(T).catch((e=>{Object(St.a)().displayErrorToast(e)})):T([])}),[M]),Object(i.useEffect)((()=>{F()}),[_]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Wt,{aggFieldPairList:u,chartSettings:E,splitField:M,fieldValues:_,lineChartsData:m,modelData:[],anomalyData:[],deleteDetector:function(e){u.splice(e,1),p([...u])},jobType:o.type,loading:f}),Object(I.jsx)(Vt,{fields:l,detectorChangeHandler:function(e){!function(e){if(null!==e&&e.length){const t=e[0];if(void 0!==t){const e={agg:t.agg,field:t.field};p([...u,e]),d([])}else p([])}}(e)},selectedOptions:c,removeOptions:u}))},Yt=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:n}=Object(i.useContext)(ze),s=e,[r,o]=Object(i.useState)({}),[l,c]=Object(i.useState)(!1),[d,u]=Object(i.useState)([]),[p,m]=Object(i.useState)([]),[b,f]=Object(i.useState)(bt.a),[h,g]=Object(i.useState)([]);function j(e){u(e.model),m(e.anomalies)}function x(){return s.aggFieldPairs.length>0&&(null===s.splitField||null!==s.splitField&&h.length>0)}return Object(i.useEffect)((()=>{const e=a.subscribeToResults(j);return(async()=>{if(null!==s.splitField)try{const e=await t.loadFieldExampleValues(s.splitField,s.runtimeMappings,s.datafeedConfig.indices_options);g(e)}catch(e){Object(St.a)().displayErrorToast(e)}})(),()=>{e.unsubscribe()}}),[]),Object(i.useEffect)((()=>{x()&&async function(){if(x()){c(!0);try{const e=Object(bt.b)(s,n);f(e);const a=await t.loadLineCharts(s.start,s.end,s.aggFieldPairs,s.splitField,h.length>0?h[0]:null,e.intervalMs,s.runtimeMappings,s.datafeedConfig.indices_options);o(a)}catch(e){Object(St.a)().displayErrorToast(e),o({})}c(!1)}}()}),[h]),Object(I.jsx)(i.Fragment,null,Object.keys(r).length&&Object(I.jsx)(Wt,{aggFieldPairList:s.aggFieldPairs,chartSettings:b,splitField:s.splitField,fieldValues:h,lineChartsData:r,modelData:d,anomalyData:p,deleteDetector:void 0,jobType:s.type,loading:l}))},$t=({fields:e,changeHandler:t,selectedField:a,isClearable:n,testSubject:i,placeholder:s})=>{const o=e.map((e=>({label:e.name,field:e}))),l=[];return null!==a&&l.push({label:a.name,field:a}),Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:o,selectedOptions:l,onChange:function(e){const a=e[0];t(void 0!==a?a.field:null)},isClearable:n,placeholder:s,"data-test-subj":i})},Xt=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.splitField.title",{defaultMessage:"Split field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.splitField.description",defaultMessage:"Select a field to split analysis by. Each value of this field will be modeled independently."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),Kt=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,s=Object(i.useMemo)((()=>Object(Be.a)(n.runtimeFields)),[]),r=function(e,t,a){const[n,s]=Object(i.useState)(e);return Object(i.useEffect)((()=>{if(Object(Te.c)(t))s(e);else{const a=t.rareField,n=t.populationField;s(null!==a||null!==n?e.filter((({name:e})=>e!==(null==a?void 0:a.name)&&e!==(null==n?void 0:n.name))):e)}}),[a]),n}(Object(i.useMemo)((()=>[...Be.b.categoryFields,...s]),[]),n,a),[o,l]=Object(i.useState)(n.splitField);return Object(i.useEffect)((()=>{n.setSplitField(o),null!==o&&!1===n.influencers.includes(o.name)&&n.addInfluencer(o.name),t()}),[o]),Object(i.useEffect)((()=>{l(n.splitField)}),[a]),Object(I.jsx)(Xt,null,Object(I.jsx)($t,{fields:r,changeHandler:l,selectedField:o,isClearable:!0,testSubject:"mlMultiMetricSplitFieldSelect"}))};const Qt=({fields:e,changeHandler:t,selectedInfluencers:a})=>{const{jobCreator:n}=Object(i.useContext)(ze),s=[...Object(Ct.g)(e,n.additionalFields),...Object(Ct.h)(n.categorizationFieldName)],o=a.map((e=>({label:e})));return Object(I.jsx)(r.EuiComboBox,{options:s,selectedOptions:o,onChange:function(e){t(e.map((e=>e.label)))},isClearable:!1,"data-test-subj":"mlInfluencerSelect"})},Zt=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.influencers.title",{defaultMessage:"Influencers"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.influencers.description",defaultMessage:"Select which categorical fields have influence on the results. Who/what might you 'blame' for an anomaly? Recommend 1-3 influencers."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),ea=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,{fields:s}=Be.b,[r,o]=Object(i.useState)([...n.influencers]);return Object(i.useEffect)((()=>{n.removeAllInfluencers(),r.forEach((e=>n.addInfluencer(e))),t()}),[r.join()]),Object(i.useEffect)((()=>{o([...n.influencers])}),[a]),Object(I.jsx)(Zt,null,Object(I.jsx)(Qt,{fields:s,changeHandler:o,selectedInfluencers:r}))},ta=({setIsValid:e})=>Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Kt,null)),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ea,null))),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Rt,{setIsValid:e})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(zt,null)))),aa=({isActive:e,setCanProceed:t})=>{const[a,n]=Object(i.useState)(!1),[s,o]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(I.jsx)(i.Fragment,null,!1===e?Object(I.jsx)(Yt,null):Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Ht,{setIsValid:n}),a&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(ta,{setIsValid:o}))))},na=({fields:e,detectorChangeHandler:t,selectedOptions:a,maxWidth:n,removeOptions:i})=>Object(I.jsx)(r.EuiFlexGroup,{style:{maxWidth:void 0!==n?n:560}},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationView.addMetric",{defaultMessage:"Add metric"})},Object(I.jsx)(ct,{fields:e,changeHandler:t,selectedOptions:a,removeOptions:i})))),ia=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.title",{defaultMessage:"Population field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationField.description",defaultMessage:"All values in the selected field will be modeled together as a population. This analysis type is recommended for high cardinality data."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),sa=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,s=Object(i.useMemo)((()=>Object(Be.a)(n.runtimeFields)),[]),r=function(e,t,a){const[n,s]=Object(i.useState)(e);return Object(i.useEffect)((()=>{if(Object(Te.d)(t))s(e);else{const a=t.rareField,n=t.splitField;s(null!==a||null!==n?e.filter((({name:e})=>e!==(null==a?void 0:a.name)&&e!==(null==n?void 0:n.name))):e)}}),[a]),n}(Object(i.useMemo)((()=>[...Be.b.categoryFields,...s]),[]),n,a),[o,l]=Object(i.useState)(n.populationField);return Object(i.useEffect)((()=>{n.setPopulationField(o),null!==o&&!1===n.influencers.includes(o.name)&&n.addInfluencer(o.name),t()}),[o]),Object(i.useEffect)((()=>{l(n.populationField)}),[a]),Object(I.jsx)(ia,null,Object(I.jsx)($t,{fields:r,changeHandler:l,selectedField:o,isClearable:!1,testSubject:"mlPopulationSplitFieldSelect"}))};const ra=({detectorIndex:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n}=Object(i.useContext)(ze),s=t,r=Object(i.useMemo)((()=>Object(Be.a)(s.runtimeFields)),[]),l=Object(i.useMemo)((()=>[...Be.b.categoryFields,...r]),[]),[c,d]=Object(i.useState)(s.getByField(e)),u=function(e,t,a){const[n,s]=Object(i.useState)(e);return Object(i.useEffect)((()=>{const a=t.populationField;s(null!==a?e.filter((({name:e})=>e!==a.name)):e)}),[a]),n}(l,s,n);return Object(i.useEffect)((()=>{s.setByField(c,e),null!==c&&!1===s.influencers.includes(c.name)&&s.addInfluencer(c.name),a()}),[c]),Object(i.useEffect)((()=>{const t=s.getByField(e);d(t)}),[n]),Object(I.jsx)($t,{fields:u,changeHandler:d,selectedField:c,isClearable:!0,testSubject:"mlByFieldSelect",placeholder:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.populationField.placeholder",{defaultMessage:"Split data"})})};const oa=({aggFieldPairList:e,chartSettings:t,splitField:a,lineChartsData:n,modelData:s,anomalyData:o,deleteDetector:l,jobType:c,fieldValuesPerDetector:d,loading:u=!1})=>{const p=Gt();return Object(I.jsx)(r.EuiFlexGrid,{columns:t.cols},e.map(((m,b)=>Object(I.jsx)(r.EuiFlexItem,{key:b,"data-test-subj":`mlDetector ${b}`},Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(qt,{index:b,agg:e[b].agg,field:e[b].field,byField:e[b].by,deleteDetector:l},void 0!==l&&Object(I.jsx)(ra,{detectorIndex:b})),c===ae.f.POPULATION&&Object(I.jsx)(r.EuiSpacer,{size:"s"}))),Object(I.jsx)(Ut,{fieldValues:d[b]||[],splitField:a,numberOfDetectors:e.length,jobType:c,animate:p},Object(I.jsx)(Mt,{chartType:wt.SCATTER,chartData:n[b],modelData:s[b],anomalyData:o[b],height:t.height,width:t.width,loading:u})))))))},la=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n,chartLoader:s,chartInterval:o}=Object(i.useContext)(ze),l=t,c=Object(i.useMemo)((()=>Object(ut.b)([...Be.b.fields,...l.runtimeFields])),[]),[d,u]=Object(i.useState)([]),[p,m]=Object(i.useState)(l.aggFieldPairs),[b,f]=Object(i.useState)({}),[h,g]=Object(i.useState)(!1),[j,x]=Object(i.useState)(l.start),[v,y]=Object(i.useState)(l.end),[O,E]=Object(i.useState)(l.bucketSpanMs),[w,M]=Object(i.useState)(bt.a),[S,_]=Object(i.useState)(l.populationField),[T,C]=Object(i.useState)({}),[k,F]=Object(i.useReducer)((e=>e+1),0),[D,A]=Object(i.useState)(!1),L=()=>F(0);async function R(){if(function(){let e=p.length>0;return p.forEach((t=>{void 0!==t.by&&null!==t.by.field&&(e=e&&null!==t.by.value)})),e}()){g(!0);try{const e=Object(bt.b)(l,o);M(e);const t=await s.loadPopulationCharts(l.start,l.end,p,l.populationField,e.intervalMs,l.runtimeMappings,l.datafeedConfig.indices_options);f(t)}catch(e){Object(St.a)().displayErrorToast(e),f([])}g(!1)}}return Object(i.useEffect)((()=>{A(!0)}),[]),Object(i.useEffect)((()=>{l.removeAllDetectors(),p.forEach(((e,t)=>{l.addDetector(e.agg,e.field),void 0!==e.by&&l.setByField(e.by.field,t)})),a(),R(),e(p.length>0)}),[p.length]),Object(i.useEffect)((()=>{R()}),[JSON.stringify(T),S,D]),Object(i.useEffect)((()=>{l.start===j&&l.end===v||(x(l.start),y(l.end),R()),l.bucketSpanMs!==O&&(E(l.bucketSpanMs),R()),_(l.populationField);let e=!1;const t=[...p];t.forEach(((t,a)=>{const n=l.getByField(a);void 0!==t.by&&t.by.field!==n&&(t.by.field=n,e=!0)})),e&&(m(t),L())}),[n]),Object(i.useEffect)((()=>{!async function(){const e=[];p.forEach(((t,a)=>{void 0!==t.by&&null!==t.by.field&&e.push((async(e,t)=>({index:e,fields:await s.loadFieldExampleValues(t,l.runtimeMappings,l.datafeedConfig.indices_options)}))(a,t.by.field))}));const t=(await Promise.all(e)).reduce(((e,t)=>(e[t.index]=t.fields,e)),{}),a=p.map(((e,a)=>({...e,...void 0===e.by||null===e.by.field?{}:{by:{...e.by,value:t[a][0]}}})));m([...a]),C(t)}()}),[S,k]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(sa,null),null!==S&&Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),null!==S&&Object(I.jsx)(oa,{aggFieldPairList:p,chartSettings:w,splitField:S,lineChartsData:b,modelData:[],anomalyData:[],deleteDetector:function(e){p.splice(e,1),m([...p]),L()},jobType:l.type,fieldValuesPerDetector:T,loading:h}),null!==S&&Object(I.jsx)(na,{fields:c,detectorChangeHandler:function(e){!function(e){if(null!==e&&e.length){const t=e[0];if(void 0!==t){const e={agg:t.agg,field:t.field,by:{field:null,value:null}};m([...p,e]),u([])}else m([])}}(e)},selectedOptions:d,removeOptions:[]}))},ca=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:n}=Object(i.useContext)(ze),s=e,[o,l]=Object(i.useState)(s.aggFieldPairs),[c,d]=Object(i.useState)({}),[u,p]=Object(i.useState)(!1),[m,b]=Object(i.useState)([]),[f,h]=Object(i.useState)([]),[g,j]=Object(i.useState)(bt.a),[x,v]=Object(i.useState)({});function y(e){b(e.model),h(e.anomalies)}function O(){let e=o.length>0;return o.forEach((t=>{void 0!==t.by&&null!==t.by.field&&(e=e&&null!==t.by.value)})),e}return Object(i.useEffect)((()=>{const e=a.subscribeToResults(y);return()=>{e.unsubscribe()}}),[]),Object(i.useEffect)((()=>{O()&&async function(){if(O()){p(!0);try{const e=Object(bt.b)(s,n);j(e);const a=await t.loadPopulationCharts(s.start,s.end,o,s.populationField,e.intervalMs,s.runtimeMappings,s.datafeedConfig.indices_options);d(a)}catch(e){Object(St.a)().displayErrorToast(e),d({})}p(!1)}}()}),[JSON.stringify(x),s.populationField]),Object(i.useEffect)((()=>{!async function(){const e=[];o.forEach(((a,n)=>{void 0!==a.by&&null!==a.by.field&&e.push((async(e,a)=>({index:e,fields:await t.loadFieldExampleValues(a,s.runtimeMappings,s.datafeedConfig.indices_options)}))(n,a.by.field))}));const a=(await Promise.all(e)).reduce(((e,t)=>(e[t.index]=t.fields,e)),{}),n=o.map(((e,t)=>({...e,...void 0===e.by||null===e.by.field?{}:{by:{...e.by,value:a[t][0]}}})));l([...n]),v(a)}()}),[s.populationField]),Object(I.jsx)(i.Fragment,null,null!==s.populationField&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.populationView.splitFieldTitle",defaultMessage:"Population split by {field}",values:{field:s.populationField.name}}),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(oa,{aggFieldPairList:s.aggFieldPairs,chartSettings:g,splitField:s.populationField,lineChartsData:c,modelData:m,anomalyData:f,jobType:s.type,fieldValuesPerDetector:x,loading:u})))},da=({setIsValid:e})=>Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Rt,{setIsValid:e})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ea,null)))),ua=({isActive:e,setCanProceed:t})=>{const[a,n]=Object(i.useState)(!1),[s,o]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(I.jsx)(i.Fragment,null,!1===e?Object(I.jsx)(ca,null):Object(I.jsx)(i.Fragment,null,Object(I.jsx)(la,{setIsValid:n}),a&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(da,{setIsValid:o}))))},pa=({onCreateClick:e,closeModal:t,saveEnabled:a,children:n})=>Object(I.jsx)(r.EuiModal,{onClose:t,maxWidth:1200,"data-test-subj":"mlCreateDetectorModal"},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiModalHeaderTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.title",defaultMessage:"Create detector"}))),Object(I.jsx)(r.EuiModalBody,null,n),Object(I.jsx)(r.EuiModalFooter,null,Object(I.jsx)(r.EuiButtonEmpty,{onClick:t,"data-test-subj":"mlCreateDetectorModalCancelButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.cancelButton",defaultMessage:"Cancel"})),Object(I.jsx)(r.EuiButton,{onClick:e,isDisabled:!1===a,fill:!0,"data-test-subj":"mlCreateDetectorModalSaveButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.saveButton",defaultMessage:"Save"}))));var ma=a(98),ba=a(146);const fa=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.title",{defaultMessage:"Function"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.aggSelect.description",defaultMessage:"Analysis functions to be performed e.g. sum, count."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),ha=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.title",{defaultMessage:"Field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.fieldSelect.description",defaultMessage:"Required for functions: sum, mean, median, max, min, info_content, distinct_count, lat_long."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),ga=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.title",{defaultMessage:"By field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.byFieldSelect.description",defaultMessage:"Required for individual analysis where anomalies are detected compared to an entity's own past behavior."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),ja=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.title",{defaultMessage:"Over field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.overFieldSelect.description",defaultMessage:"Required for population analysis where anomalies are detected compared to the behavior of the population."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),xa=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.title",{defaultMessage:"Partition field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.partitionFieldSelect.description",defaultMessage:"Allows segmentation of modeling into logical groups."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),va=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.title",{defaultMessage:"Exclude frequent"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.excludeFrequent.description",defaultMessage:"If set, it will automatically identify and exclude frequently occurring entities which may otherwise have dominated results."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),ya=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.title",{defaultMessage:"Description"});return Object(I.jsx)(r.EuiDescribedFormGroup,{fullWidth:!0,title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorModal.description.description",defaultMessage:"Override the default detector description with a meaningful description of what the detector is analyzing."})},Object(I.jsx)(r.EuiFormRow,{label:t,fullWidth:!0},Object(I.jsx)(s.a.Fragment,null,e)))})),Oa={label:""},Ea=[{label:"all"},{label:"none"},{label:"by"},{label:"over"}],wa=({payload:e,fields:t,aggs:a,detectorChangeHandler:n,closeModal:s})=>{const{jobCreator:o}=Object(i.useContext)(ze),l=o,[c,d]=Object(i.useState)(e.detector),[u,p]=Object(i.useState)(Ma(c.agg)),[m,b]=Object(i.useState)(Sa(c.field)),[f,h]=Object(i.useState)(Sa(c.byField)),[g,j]=Object(i.useState)(Sa(c.overField)),[x,v]=Object(i.useState)(Sa(c.partitionField)),[y,O]=Object(i.useState)(function(e){if(null===e)return Oa;return{label:e}}(c.excludeFrequent)),[E,w]=Object(i.useState)(c.description||""),[M,S]=Object(i.useState)(!0),[_,T]=Object(i.useState)(!0),[C,k]=Object(i.useState)(!0),{descriptionPlaceholder:F,setDescriptionPlaceholder:D}=function(e){const[t,a]=Object(i.useState)(Ca(e));function n(e){a(Ca(e))}return{descriptionPlaceholder:t,setDescriptionPlaceholder:n}}(c),A=l.additionalFields.length>0,L=a.filter((e=>function(e,t){return void 0!==e.fields&&(t||e.fields.length)}(e,A))).map(Ma),{currentFieldOptions:R,setCurrentFieldOptions:N}=function(e,t,a){const[n,s]=Object(i.useState)(Ta(e,t));return{currentFieldOptions:n,setCurrentFieldOptions:e=>s(Ta(e,t))}}(c.agg,l.additionalFields),P=[...[...Object(Ct.g)(t,l.additionalFields)].sort(Fa),...Object(Ct.h)(l.categorizationFieldName)].sort(Fa),z=t.find((e=>e.id===Dt.a)),B=e=>t=>{e(t[0]||Oa)};function J(e){return a.find((t=>t.id===e))||null}function V(e){return e===Dt.c.id?Dt.c:t.find((t=>t.id===e))||l.additionalFields.find((t=>t.id===e))||null}return Object(i.useEffect)((()=>{const e=J(u.label);let t=V(m.label);const a=V(f.label),n=V(g.label),i=V(x.label);null!==e?(N(e),_a(e)&&void 0!==z?(S(!0),b(Oa),k(!1),t=z):(S(null!==t),k(!0)),T(null!==a||null!==n)):(S(!1),k(!1));const s={agg:e,field:t,byField:a,overField:n,partitionField:i,excludeFrequent:""!==y.label?y.label:null,description:""!==E?E:null,customRules:null,useNull:null};d(s),D(s)}),[u,m,f,g,x,y,E]),Object(i.useEffect)((()=>{const e=J(u.label);if(S(""!==u.label),null!==e){k(!1===_a(e));const t=V(f.label),a=V(g.label);T(null!==t||null!==a)}}),[]),Object(i.useEffect)((()=>{!1===_&&O(Oa)}),[_]),Object(I.jsx)(pa,{onCreateClick:function(){n(c,e.index)},closeModal:s,saveEnabled:M&&(!1===C||!0===C&&""!==m.label)},Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlAdvancedFunctionSelect"},Object(I.jsx)(fa,null,Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:L,selectedOptions:ka(u,L),onChange:B(p),isClearable:!0}))),Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlAdvancedFieldSelect"},Object(I.jsx)(ha,null,Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:R,selectedOptions:ka(m,R),onChange:B(b),isClearable:!0,isDisabled:!1===C})))),Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(r.EuiFlexGrid,{columns:2},Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlAdvancedByFieldSelect"},Object(I.jsx)(ga,null,Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:P,selectedOptions:ka(f,P),onChange:B(h),isClearable:!0,isDisabled:!1===M}))),Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlAdvancedOverFieldSelect"},Object(I.jsx)(ja,null,Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:P,selectedOptions:ka(g,P),onChange:B(j),isClearable:!0,isDisabled:!1===M}))),Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlAdvancedPartitionFieldSelect"},Object(I.jsx)(xa,null,Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:P,selectedOptions:ka(x,P),onChange:B(v),isClearable:!0,isDisabled:!1===M}))),Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlAdvancedExcludeFrequentSelect"},Object(I.jsx)(va,null,Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:Ea,selectedOptions:ka(y,Ea),onChange:B(O),isClearable:!0,isDisabled:!1===M||!1===_})))),Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ya,null,Object(I.jsx)(r.EuiTextArea,{rows:2,fullWidth:!0,placeholder:F,value:E,onChange:e=>w(e.target.value),"data-test-subj":"mlAdvancedDetectorDescriptionInput"}))))))};function Ma(e){return null===e?Oa:{label:e.id}}function Sa(e){return null===e?Oa:{label:e.name}}function _a(e){return e.fields&&1===e.fields.length&&e.fields[0].id===Dt.a}function Ta(e,t){return Object(Ct.g)(null!==e&&void 0!==e.fields?e.fields:[],t)}function Ca(e){if(null===e.agg||null===e.field)return"";const t=Object(ba.a)(e.agg,e.field);return t.by_field_name=e.byField?e.byField.id:void 0,t.over_field_name=e.overField?e.overField.id:void 0,t.partition_field_name=e.partitionField?e.partitionField.id:void 0,t.exclude_frequent=e.excludeFrequent?e.excludeFrequent:void 0,Object(ma.b)(t)}function ka(e,t){return 1===t.length&&t[0].label!==e.label||""===e.label?[]:[e]}function Fa(e,t){return e.label.localeCompare(t.label)}const Ia=({payload:e,fields:t,aggs:a,detectorChangeHandler:n,closeModal:s,showModal:o})=>Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{style:{maxWidth:560}},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,null,Object(I.jsx)(r.EuiButton,{onClick:o,"data-test-subj":"mlAddDetectorButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.addDetectorButton",defaultMessage:"Add detector"}))))),null!==e&&Object(I.jsx)(wa,{payload:e,fields:t,aggs:a,detectorChangeHandler:n,closeModal:s})),Da=({isActive:e,onEditJob:t,onDeleteJob:a})=>{const{jobCreator:n,jobCreatorUpdated:s,jobValidator:l,jobValidatorUpdated:c}=Object(i.useContext)(ze),d=n,[u,p]=Object(i.useState)(d.detectors),[m,b]=Object(i.useState)(l.duplicateDetectors);Object(i.useEffect)((()=>{p(d.detectors)}),[s]),Object(i.useEffect)((()=>{l.duplicateDetectors.valid||b(l.duplicateDetectors),l.categorizerVaryingPerPartitionField.valid||b(l.categorizerVaryingPerPartitionField),l.categorizerMissingPerPartition.valid||b(l.categorizerMissingPerPartition)}),[c]);const f=({index:e})=>Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiButtonIcon,{color:"primary",onClick:()=>t(e),iconType:"pencil","aria-label":o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.editButton",{defaultMessage:"Edit"}),"data-test-subj":"mlAdvancedDetectorEditButton"})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiButtonIcon,{color:"danger",onClick:()=>a(e),iconType:"trash","aria-label":o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.deleteButton",{defaultMessage:"Delete"}),"data-test-subj":"mlAdvancedDetectorDeleteButton"})));return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"xs"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.advancedDetectorList.title",defaultMessage:"Detectors"}))),Object(I.jsx)(Aa,{show:0===u.length}),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGrid,{columns:3},u.map(((t,a)=>Object(I.jsx)(r.EuiFlexItem,{key:a,"data-test-subj":`mlAdvancedDetector ${a}`},Object(I.jsx)(r.EuiPanel,{paddingSize:"m"},Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,void 0!==t.detector_description?Object(I.jsx)("div",{style:{fontWeight:"bold"},"data-test-subj":"mlDetectorDescription"},t.detector_description):Object(I.jsx)(Ra,{detector:t})),e&&Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{margin:"8px"}},Object(I.jsx)(f,{index:a}))),void 0!==t.detector_description&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{margin:"s"}),Object(I.jsx)(Ra,{detector:t}))))))),Object(I.jsx)(La,{validation:m}))},Aa=({show:e})=>!1===e?null:Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.title",{defaultMessage:"No detectors"}),iconType:"alert","data-test-subj":"mlAdvancedNoDetectorsMessage"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.noDetectorsCallout.message",defaultMessage:"At least one detector is needed to create a job."})),Object(I.jsx)(r.EuiSpacer,{size:"s"})),La=({validation:e})=>!0===e.valid?null:Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFormRow,{error:e.message,isInvalid:!1===e.valid},Object(I.jsx)(i.Fragment,null)),Object(I.jsx)(r.EuiSpacer,{size:"s"})),Ra=({detector:e})=>Object(I.jsx)("div",{"data-test-subj":"mlDetectorIdentifier"},Object(ma.b)(e)),Na={agg:null,field:null,byField:null,overField:null,partitionField:null,excludeFrequent:null,description:null,customRules:null,useNull:null},Pa=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n}=Object(i.useContext)(ze),s=t,{fields:r,aggs:o}=Be.b,[l,c]=Object(i.useState)(null);return Object(i.useEffect)((()=>{e(s.detectors.length>0)}),[n]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Da,{isActive:!0,onEditJob:function(e){const t=s.richDetectors[e];void 0!==t&&c({detector:t,index:e})},onDeleteJob:function(e){s.removeDetector(e),a()}}),Object(I.jsx)(Ia,{payload:l,fields:r,aggs:o,detectorChangeHandler:function(e,t){void 0===t?s.addDetector(e.agg,e.field,e.byField,e.overField,e.partitionField,e.excludeFrequent,e.description,e.useNull):s.editDetector(e.agg,e.field,e.byField,e.overField,e.partitionField,e.excludeFrequent,e.description,t,e.useNull),a(),c(null)},showModal:function(){c({detector:Na})},closeModal:function(){c(null)}}))},za=()=>Object(I.jsx)(Da,{isActive:!1,onEditJob:()=>{},onDeleteJob:()=>{}}),Ba=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.title",{defaultMessage:"Model memory limit"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.modelMemoryLimit.description",defaultMessage:"Set an approximate upper limit for the amount of memory that can be used by the analytical models."})},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))})),Ja=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a,jobValidator:n,jobValidatorUpdated:s}=Object(i.useContext)(ze),[o,l]=Object(i.useState)(n.modelMemoryLimit),[c,d]=Object(i.useState)(null===e.modelMemoryLimit?"":e.modelMemoryLimit),{anomaly_detectors:u}=Object(T.c)(),{model_memory_limit:p}=u;return Object(i.useEffect)((()=>{e.modelMemoryLimit=""===c?null:c,t()}),[c]),Object(i.useEffect)((()=>{d(null===e.modelMemoryLimit?"":e.modelMemoryLimit)}),[a]),Object(i.useEffect)((()=>{l(n.modelMemoryLimit)}),[s]),Object(I.jsx)(Ba,{validation:o},Object(I.jsx)(r.EuiFieldText,{value:c,placeholder:p,onChange:e=>d(e.target.value),isInvalid:!1===o.valid,"data-test-subj":"mlJobWizardInputModelMemoryLimit"}))},Va=({setIsValid:e})=>Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Rt,{setIsValid:e})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ea,null))),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Ja,null)),Object(I.jsx)(r.EuiFlexItem,null))),Ua=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:n}=Object(i.useContext)(ze),s=[...Object(Ct.f)(n.aggregationFields.length>0),...Object(Ct.g)(e,n.additionalFields)],o=[];return null!==a&&o.push({label:a}),Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:s,selectedOptions:o,onChange:function(e){const a=e[0];t(void 0!==a?a.label:null)},isClearable:!0,"data-test-subj":"mlSummaryCountFieldNameSelect"})},Ga=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.title",{defaultMessage:"Summary count field"}),{services:{docLinks:n}}=Object(d.b)(),i=n.links.ml.aggregations;return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.description",defaultMessage:"If the input data is {aggregated}, specify the field that contains the document count.",values:{aggregated:Object(I.jsx)(r.EuiLink,{href:i,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.summaryCountField.aggregatedText",defaultMessage:"aggregated"}))}})},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))})),qa=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a,jobValidator:n,jobValidatorUpdated:s}=Object(i.useContext)(ze),r=e,{fields:o}=Be.b,[l,c]=Object(i.useState)(r.summaryCountFieldName),[d,u]=Object(i.useState)(n.summaryCountField);return Object(i.useEffect)((()=>{u(n.summaryCountField)}),[s]),Object(i.useEffect)((()=>{r.summaryCountFieldName=l,t()}),[l]),Object(i.useEffect)((()=>{c(r.summaryCountFieldName)}),[a]),Object(I.jsx)(Ga,{validation:d},Object(I.jsx)(Ua,{fields:o,changeHandler:c,selectedField:l}))},Wa=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:n,jobCreatorUpdated:s}=Object(i.useContext)(ze),o=Object(i.useMemo)((()=>[...Object(Ct.g)(e,n.additionalFields)]),[e,s]),l=Object(i.useMemo)((()=>{const e=[];return null!==a&&e.push({label:a}),e}),[a]),c=Object(i.useCallback)((e=>{var a;return t(null!==(a=e[0]&&e[0].label)&&void 0!==a?a:null)}),[t]);return Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:o,selectedOptions:l,onChange:c,isClearable:!0,"data-test-subj":"mlCategorizationFieldNameSelect"})},Ha=Object(i.memo)((({children:e,isOptional:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.title",{defaultMessage:"Categorization field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(s.a.Fragment,null,t?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldOptional.description",defaultMessage:"Optional, for use if analyzing unstructured log data. Using text data types is recommended."}):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationField.description",defaultMessage:"Specifies which field will be categorized. Using text data types is recommended. Categorization works best on machine written log messages, typically logging written by a developer for the purpose of system troubleshooting."}))},Object(I.jsx)(r.EuiFormRow,{label:a},Object(I.jsx)(s.a.Fragment,null,e)))})),Ya=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,{catFields:s}=Be.b,[r,o]=Object(i.useState)(n.categorizationFieldName),l=Object(Te.b)(n);return Object(i.useEffect)((()=>{n.categorizationFieldName!==r&&(n.categorizationFieldName=r,t())}),[r]),Object(i.useEffect)((()=>{o(n.categorizationFieldName)}),[a]),Object(I.jsx)(Ha,{isOptional:!1===l},Object(I.jsx)(Wa,{fields:s,changeHandler:o,selectedField:r}))},$a=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.perPartitionCategorization.enable.title",{defaultMessage:"Enable per-partition categorization"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorization.enable.description",defaultMessage:"If per-partition categorization is enabled then categories are determined independently for each value of the partition field."})},Object(I.jsx)(s.a.Fragment,null,e))})),Xa=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,[s,o]=Object(i.useState)(n.perPartitionCategorization),l=Object(i.useCallback)((()=>o(!s)),[s]);return Object(i.useEffect)((()=>{o(n.perPartitionCategorization)}),[a]),Object(i.useEffect)((()=>{!1===s&&(n.perPartitionStopOnWarn=!1),n.perPartitionCategorization=s,t()}),[s]),Object(I.jsx)(r.EuiSwitch,{name:"categorizationPerPartitionSwitch",disabled:!1,checked:s,onChange:l,"data-test-subj":"mlJobWizardSwitchCategorizationPerPartition",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorizationSwitchLabel",defaultMessage:"Enable per-partition categorization"})})},Ka=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,[s,o]=Object(i.useState)(n.perPartitionStopOnWarn),l=Object(i.useCallback)((()=>o(!s)),[s]);return Object(i.useEffect)((()=>{n.perPartitionStopOnWarn=s,t()}),[s]),Object(i.useEffect)((()=>{o(n.perPartitionStopOnWarn)}),[a]),Object(I.jsx)(r.EuiSwitch,{name:"categorizationPerPartitionStopOnWarnSwitch",disabled:!1,checked:s,onChange:l,"data-test-subj":"mlJobWizardSwitchCategorizationPerPartitionStopOnWarn",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.perPartitionCategorizationtopOnWarnSwitchLabel",defaultMessage:"Stop on warn"})})},Qa=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:n,jobCreatorUpdated:s}=Object(i.useContext)(ze),o=Object(i.useMemo)((()=>[...Object(Ct.g)(e,n.additionalFields)]),[e,s]),l=Object(i.useMemo)((()=>{const e=[];return null!==a&&e.push({label:a}),e}),[a]),c=Object(i.useCallback)((e=>{var a;return t(null!==(a=e[0]&&e[0].label)&&void 0!==a?a:null)}),[t]);return Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:o,selectedOptions:l,onChange:c,isClearable:!0,"data-test-subj":"mlJobWizardCategorizationPerPartitionFieldNameSelect"})},Za=({setEnablePerPartitionCategorization:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n}=Object(i.useContext)(ze),s=t,[o,l]=Object(i.useState)(s.categorizationPerPartitionField),{categoryFields:c}=Be.b,d=Object(i.useMemo)((()=>c.filter((e=>e.id!==s.categorizationFieldName))),[c,n]);return Object(i.useEffect)((()=>{s.categorizationPerPartitionField=o,a()}),[o]),Object(i.useEffect)((()=>{s.perPartitionCategorization&&null===s.categorizationPerPartitionField&&d.length>0&&(s.categorizationPerPartitionField=d[0].id),l(s.categorizationPerPartitionField),e(s.perPartitionCategorization)}),[n]),Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.categorizationPerPartitionFieldLabel",defaultMessage:"Partition field"})},Object(I.jsx)(Qa,{fields:d,changeHandler:l,selectedField:o||""}))},en=()=>{const{jobCreator:e,jobCreatorUpdated:t}=Object(i.useContext)(ze),a=e,[n,o]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{o(a.perPartitionCategorization)}),[t]),Object(I.jsx)($a,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.perPartitionCategorizationLabel",defaultMessage:"Enable per-partition categorization"})},Object(I.jsx)(Xa,null)),n&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.extraStep.categorizationJob.stopOnWarnLabel",defaultMessage:"Stop on warn"})},Object(I.jsx)(Ka,null))),Object(Te.b)(a)&&n&&Object(I.jsx)(Za,{setEnablePerPartitionCategorization:o}))},tn=()=>{const{jobCreator:e}=Object(i.useContext)(ze),t=Object(Te.a)(e)&&null!==e.categorizationFieldName;return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Ya,null)),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(qa,null))),t&&Object(I.jsx)(en,null))},an=({isActive:e,setCanProceed:t})=>{const[a,n]=Object(i.useState)(!1),[s,o]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{"function"==typeof t&&t(a&&s)}),[a,s]),Object(I.jsx)(i.Fragment,null,!1===e?Object(I.jsx)(za,null):Object(I.jsx)(i.Fragment,null,Object(I.jsx)(tn,null),Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(Pa,{setIsValid:n}),Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(Va,{setIsValid:o})))},nn=({onClick:e,isSelected:t})=>Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorCountCard"+(t?" selected":""),title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.title",{defaultMessage:"Count"}),description:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.countCard.description",defaultMessage:"Look for anomalies in the event rate of a particular category."})),selectable:{onClick:e,isSelected:t}})),sn=({onClick:e,isSelected:t})=>Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.title",{defaultMessage:"Rare"}),description:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.rareCard.description",defaultMessage:"Look for categories that occur rarely in time."})),selectable:{onClick:e,isSelected:t}})),rn=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,[o,l]=Object(i.useState)(n.selectedDetectorType);return Object(i.useEffect)((()=>{o!==n.selectedDetectorType&&(n.setDetectorType(o),t())}),[o]),Object(i.useEffect)((()=>{l(n.selectedDetectorType)}),[a]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"xs"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationDetectorSelect.title",defaultMessage:"Categorization detector"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"l",style:{maxWidth:"824px"}},Object(I.jsx)(nn,{onClick:function(){l(Pt.b.COUNT)},isSelected:o===Pt.b.COUNT}),Object(I.jsx)(sn,{onClick:function(){l(Pt.b.RARE)},isSelected:o===Pt.b.RARE})))},on=({fieldExamples:e})=>{if(null===e||0===e.length)return null;const t=[{field:"example",name:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldExamples.title",{defaultMessage:"Examples"}),render:e=>Object(I.jsx)(r.EuiCodeBlock,{fontSize:"s",paddingSize:"none",transparentBackground:!0,style:{maxHeight:"200px"}},e)}],a=e.map(((e,t)=>{const a=[];let n=0,i="",s=0;for(;s<e.text.length;){const r=e.tokens[n];r&&s===r.start_offset?(a.push(i),i="",a.push(Object(I.jsx)(ln,{key:`${t}${s}`},r.token)),s+=r.end_offset-r.start_offset,n++):(i+=e.text[s],s++)}return a.push(i),{example:a}}));return Object(I.jsx)(r.EuiBasicTable,{columns:t,items:a,"data-test-subj":"mlJobWizardCategorizationExamplesTable"})},ln=({children:e})=>Object(I.jsx)("span",{style:{backgroundColor:"#b0ccf7"}},e);var cn=a(140),dn=a(143);const un=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(i.useContext)(ze),a=e,[n,s]=Object(i.useState)(!1),[l,c]=Object(i.useState)(!1),[d,u]=Object(i.useState)(JSON.stringify(a.categorizationAnalyzer,null,2));function p(e){u(e);const t=Object(dn.c)(e);c(t)}return Object(i.useEffect)((()=>{!0===n&&u(JSON.stringify(a.categorizationAnalyzer,null,2))}),[n]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(pn,{onClick:function(){c(!1),s(!n)}}),!0===n&&Object(I.jsx)(r.EuiFlyout,{onClose:()=>s(!1),hideCloseButton:!0,size:"m"},Object(I.jsx)(r.EuiFlyoutBody,null,Object(I.jsx)(mn,{onChange:p,title:o.i18n.translate("xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.title",{defaultMessage:"Edit categorization analyzer JSON"}),value:d})),Object(I.jsx)(r.EuiFlyoutFooter,null,Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:()=>s(!1),flush:"left"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.closeButton",defaultMessage:"Close"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!0}),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{onClick:function(){const{anomaly_detectors:e}=Object(T.c)();p(JSON.stringify(e.categorization_analyzer,null,2))}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.useDefaultButton",defaultMessage:"Use default ML analyzer"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:function(){a.categorizationAnalyzer=JSON.parse(d),t(),s(!1)},fill:!0,isDisabled:!1===l},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.categorizationAnalyzerFlyout.saveButton",defaultMessage:"Save"})))))))},pn=({onClick:e})=>Object(I.jsx)(r.EuiButtonEmpty,{onClick:e,flush:"left","data-test-subj":"mlJobWizardButtonPreviewJobJson"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.editCategorizationAnalyzerFlyoutButton",defaultMessage:"Edit categorization analyzer"})),mn=({title:e,value:t,onChange:a})=>Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h5",null,e)),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(cn.a,{value:t,height:"800px",readOnly:!1,onChange:a})),bn=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.allChecksButton",{defaultMessage:"View all checks performed"}),fn=({overallValidStatus:e,validationChecks:t,categorizationAnalyzer:a})=>{const n=Object(I.jsx)(hn,{categorizationAnalyzer:a});let i="success",s=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.valid",{defaultMessage:"Selected category field is valid"});return e===Le.a.INVALID?(i="danger",s=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.invalid",{defaultMessage:"Selected category field is invalid"})):e===Le.a.PARTIALLY_VALID&&(i="warning",s=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldCalloutTitle.possiblyInvalid",{defaultMessage:"Selected category field is possibly invalid"})),Object(I.jsx)(r.EuiCallOut,{color:i,title:s,"data-test-subj":`mlJobWizardCategorizationExamplesCallout ${e}`},t.map(((e,t)=>Object(I.jsx)("div",{key:t},e.message))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),n,Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiAccordion,{id:"all-checks",buttonContent:bn},Object(I.jsx)(gn,{validationChecks:t})))},hn=({categorizationAnalyzer:e})=>{let t="";return void 0!==(null==e?void 0:e.tokenizer)?t=e.tokenizer:void 0!==(null==e?void 0:e.analyzer)&&(t=e.analyzer),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationFieldAnalyzer",defaultMessage:"Analyzer used: {analyzer}",values:{analyzer:t}})),Object(I.jsx)("div",null,Object(I.jsx)(un,null)))},gn=({validationChecks:e})=>{const t=Object.keys(Le.c).map(((t,a)=>{const n=e.find((e=>e.id===a));return void 0!==n&&(null==n?void 0:n.valid)!==Le.a.VALID?{iconType:"cross",label:n.message,size:"s"}:{iconType:"check",label:Le.c[a],size:"s"}}));return Object(I.jsx)(r.EuiListGroup,{listItems:t,maxWidth:!1})},jn=()=>Object(I.jsx)(r.EuiCallOut,{color:"warning",title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.invalidCssVersionCallout.title",{defaultMessage:"The data view appears to be cross-cluster"})},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.invalidCssVersionCallout.mesage",defaultMessage:"No example categories could be found, this could be due to one of the clusters being an unsupported version."})),xn=({setIsValid:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n}=Object(i.useContext)(ze),o=t,[l,c]=Object(i.useState)(!1),[d,u]=Object(i.useState)(!1),[p,m]=Object(i.useState)(o.start),[b,f]=Object(i.useState)(o.end),[h,g]=Object(i.useState)(JSON.stringify(o.categorizationAnalyzer)),[j,x]=Object(i.useState)(null),[v,y]=Object(i.useState)(Le.a.INVALID),[O,E]=Object(i.useState)([]),[w,M]=Object(i.useState)(o.categorizationFieldName);async function S(){if(null!==w){c(!0);try{const{examples:e,overallValidStatus:t,validationChecks:a,ccsVersionFailure:n}=await o.loadCategorizationFieldExamples();x(e),y(t),E(a),u(n),c(!1)}catch(e){c(!1),x(null),E([]),y(Le.a.INVALID),Object(St.a)().displayErrorToast(e),u(!1)}}else x(null),E([]),y(Le.a.INVALID),u(!1);e(null!==w)}return Object(i.useEffect)((()=>{o.categorizationFieldName!==w&&(o.categorizationFieldName=w,a()),S()}),[w]),Object(i.useEffect)((()=>{let e=!1;o.start===p&&o.end===b||(m(o.start),f(o.end),e=!0);const t=JSON.stringify(o.categorizationAnalyzer);t!==h&&(g(t),e=!0),e&&S(),o.categorizationFieldName!==w&&M(o.categorizationFieldName)}),[n]),Object(i.useEffect)((()=>{a()}),[v]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(rn,null),Object(I.jsx)(r.EuiHorizontalRule,null),Object(I.jsx)(Ya,null),!0===l&&Object(I.jsx)(Et.a,{hasData:!1,loading:!0},Object(I.jsx)("div",null)),!1===d&&null!==j&&!1===l&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(fn,{overallValidStatus:v,validationChecks:O,categorizationAnalyzer:o.categorizationAnalyzer}),Object(I.jsx)(on,{fieldExamples:j})),!0===d&&Object(I.jsx)(jn,null),Object(I.jsx)(r.EuiHorizontalRule,null),Object(I.jsx)(en,null))},vn=()=>{const{jobCreator:e,resultsLoader:t}=Object(i.useContext)(ze),a=e,[n,o]=Object(i.useState)([]),[l,c]=Object(i.useState)(0);function d(e){!async function(){const e=await be.ml.jobs.topCategories(a.jobId,Le.b);o(e.categories.map((e=>{var t;return{count:e.count,example:null!==(t=e.category.examples)&&void 0!==t&&t.length?e.category.examples[0]:""}}))),c(e.total)}()}Object(i.useEffect)((()=>{const e=t.subscribeToResults(d);return()=>{e.unsubscribe()}}),[]);const u=[...a.modelPlot?[{field:"count",name:"count",width:"100px",render:e=>Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)("code",null,e))}]:[],{field:"example",name:"Example",render:e=>Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)("code",null,e))}];return Object(I.jsx)(s.a.Fragment,null,l>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationTotalCategories",defaultMessage:"Total categories: {totalCategories}",values:{totalCategories:l}})),Object(I.jsx)(r.EuiBasicTable,{columns:u,items:n})))},yn=()=>{const{jobCreator:e,resultsLoader:t}=Object(i.useContext)(ze),a=e,[n,l]=Object(i.useState)([]),[c,d]=Object(i.useState)(),u=Object(i.useMemo)((()=>[{field:"partitionName",name:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsPreviewColumnName",{defaultMessage:"Stopped partition names"}),render:e=>Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)("code",null,e))}]),[]),p=Object(i.useCallback)((async()=>{try{const{jobs:e}=await be.ml.results.getCategoryStoppedPartitions([a.jobId]);if(!Array.isArray(e)&&Array.isArray(e[a.jobId])&&e[a.jobId].length>0)return e[a.jobId]}catch(e){const t=Object(Re.c)(e);404!==t.statusCode&&d(t.message)}}),[a.jobId]);return Object(i.useEffect)((()=>{if(a.perPartitionCategorization&&a.perPartitionStopOnWarn){const e=t.results$.pipe(Object(we.switchMap)((()=>Object(Ee.from)(p()))),Object(we.tap)((e=>{Array.isArray(e)&&l(e.slice(0,5).map((e=>({partitionName:e}))))})),Object(we.takeWhile)((e=>!e||Array.isArray(e)&&e.length<=5))).subscribe();return()=>e.unsubscribe()}}),[]),Object(I.jsx)(s.a.Fragment,null,c&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiCallOut,{color:"danger",size:"s",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsErrorCallout",defaultMessage:"An error occurred while fetching list of stopped partitions."})})),Array.isArray(n)&&n.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)("div",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.categorizationStoppedPartitionsTitle",defaultMessage:"Stopped partitions"})),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiCallOut,{color:"warning",size:"s",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.stoppedPartitionsExistCallout",defaultMessage:"Per-partition categorization and stop_on_warn settings are enabled. Some partitions in job '{jobId}' are unsuitable for categorization and have been excluded from further categorization or anomaly detection analysis.",values:{jobId:a.jobId}})}),Object(I.jsx)(r.EuiBasicTable,{columns:u,items:n})))},On=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:n}=Object(i.useContext)(ze),r=e,[o,l]=Object(i.useState)(!1),[c,d]=Object(i.useState)([]),[u,p]=Object(i.useState)([]),[m,b]=Object(i.useState)(!1);function f(e){const t=e.anomalies[0];void 0!==t&&d(t)}function h(e){b(e>0)}return Object(i.useEffect)((()=>{const e=a.subscribeToResults(f);return r.subscribeToProgress(h),async function(){l(!0);try{var e;const a=await t.loadEventRateChart(r.start,r.end,n.getInterval().asMilliseconds(),null!==(e=r.runtimeMappings)&&void 0!==e?e:void 0,r.datafeedConfig.indices_options);p(a)}catch(e){p([])}l(!1)}(),()=>{e.unsubscribe()}}),[]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(nt.a,{eventRateChartData:u,anomalyData:c,height:"300px",width:"100%",showAxis:!0,loading:o,fadeChart:m}),Object(I.jsx)(vn,null),Object(I.jsx)(yn,null))},En=({setIsValid:e})=>Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Rt,{setIsValid:e,hideEstimateButton:!0})))),wn=({isActive:e,setCanProceed:t})=>{const[a,n]=Object(i.useState)(!1),[o,l]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{"function"==typeof t&&t(a&&o)}),[a,o]),!1===e?Object(I.jsx)(On,null):Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(xn,{setIsValid:n}),a&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(En,{setIsValid:l})))},Mn=({fields:e,changeHandler:t,selectedField:a,testSubject:n,placeholder:i})=>{const s=e.map((e=>({label:e.name,field:e}))),o=[];return null!==a&&o.push({label:a.name,field:a}),Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:s,selectedOptions:o,onChange:function(e){const a=e[0];t(void 0!==a?a.field:null)},placeholder:i,"data-test-subj":n,isClearable:!1})},Sn=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.splitRareField.title",{defaultMessage:"Rare field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareField.description",defaultMessage:"Select a field in which to detect rare values."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),_n=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,s=Object(i.useMemo)((()=>Object(Be.a)(n.runtimeFields)),[]),r=function(e,t,a){const[n,s]=Object(i.useState)(e);return Object(i.useEffect)((()=>{const a=t.populationField,n=t.splitField;s(null!==a||null!==n?e.filter((({name:e})=>e!==(null==a?void 0:a.name)&&e!==(null==n?void 0:n.name))):e)}),[a]),n}(Object(i.useMemo)((()=>[...Be.b.categoryFields,...s]),[]),n,a),[o,l]=Object(i.useState)(n.rareField);return Object(i.useEffect)((()=>{n.setRareField(o),null!==o&&!1===n.influencers.includes(o.name)&&n.addInfluencer(o.name),t()}),[o]),Object(i.useEffect)((()=>{l(n.rareField)}),[a]),Object(I.jsx)(Sn,null,Object(I.jsx)(Mn,{fields:r,changeHandler:l,selectedField:o,testSubject:"mlRareFieldSelect"}))};const Tn=({onClick:e,isSelected:t})=>Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rareCard.title",{defaultMessage:"Rare"}),description:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rareCard.description",defaultMessage:"Find rare values over time."})),selectable:{onClick:e,isSelected:t}})),Cn=({onClick:e,isSelected:t})=>Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rarePopulationCard.title",{defaultMessage:"Rare in population"}),description:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.rarePopulationCard.description",defaultMessage:"Find members of a population that have rare values over time."})),selectable:{onClick:e,isSelected:t}})),kn=({onClick:e,isSelected:t})=>Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{"data-test-subj":"mlJobWizardCategorizationDetectorRareCard"+(t?" selected":""),title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.freqRareCard.title",{defaultMessage:"Frequently rare in population"}),description:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.freqRareCard.description",defaultMessage:"Find members of a population that frequently have rare values."})),selectable:{onClick:e,isSelected:t}})),Fn=({onChange:e})=>{const{jobCreator:t,jobCreatorUpdate:a}=Object(i.useContext)(ze),n=t,[o,l]=Object(i.useState)(null);return Object(i.useEffect)((()=>{null!==n.rareField?null===n.populationField?l(Rn.RARE):l(n.frequentlyRare?Rn.FREQ_RARE_POPULATION:Rn.RARE_POPULATION):l(Rn.RARE)}),[]),Object(i.useEffect)((()=>{null!==o&&(e(o),o===Rn.RARE&&null!==n.populationField&&n.removePopulationField(),n.frequentlyRare=o===Rn.FREQ_RARE_POPULATION,a())}),[o]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"xs"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.pickFieldsStep.rareDetectorSelect.title",defaultMessage:"Rare detector"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"l",style:{maxWidth:"824px"}},Object(I.jsx)(Tn,{onClick:function(){l(Rn.RARE)},isSelected:o===Rn.RARE}),Object(I.jsx)(Cn,{onClick:function(){l(Rn.RARE_POPULATION)},isSelected:o===Rn.RARE_POPULATION}),Object(I.jsx)(kn,{onClick:function(){l(Rn.FREQ_RARE_POPULATION)},isSelected:o===Rn.FREQ_RARE_POPULATION})))},In=({detectorType:e})=>{const{jobCreator:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=t,[s,l]=Object(i.useState)(null);return Object(i.useEffect)((()=>{const t=function(e,t){var a,n;if(null===e.rareField)return null;const i=e.rareField.id,s=null===(a=e.populationField)||void 0===a?void 0:a.id,r=null===(n=e.splitField)||void 0===n?void 0:n.id,l=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rareSummary",{defaultMessage:"Detects rare {rareFieldName} values.",values:{rareFieldName:i}}),c=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rareSplitSummary",{defaultMessage:"For each {splitFieldName}, detects rare {rareFieldName} values.",values:{splitFieldName:r,rareFieldName:i}}),d=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.freqRarePopulationSummary",{defaultMessage:"Detects {populationFieldName} values that frequently have rare {rareFieldName} values relative to the population.",values:{populationFieldName:s,rareFieldName:i}}),u=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.freqRareSplitPopulationSummary",{defaultMessage:"For each {splitFieldName}, detects {populationFieldName} values that frequently have rare {rareFieldName} values relative to the population.",values:{splitFieldName:r,populationFieldName:s,rareFieldName:i}}),p=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rarePopulationSummary",{defaultMessage:"Detects {populationFieldName} values that have rare {rareFieldName} values relative to the population.",values:{populationFieldName:s,rareFieldName:i}}),m=o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.rareSplitPopulationSummary",{defaultMessage:"For each {splitFieldName}, detects {populationFieldName} values that have rare {rareFieldName} values relative to the population.",values:{splitFieldName:r,populationFieldName:s,rareFieldName:i}});if(t===Rn.RARE)return void 0!==r?c:l;if(t===Rn.FREQ_RARE_POPULATION)return void 0!==r?u:d;if(t===Rn.RARE_POPULATION)return void 0!==r?m:p;return null}(n,e);l(t)}),[a]),null===s?null:Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.newJob.wizard.pickFieldsStep.rareField.plainText.calloutTitle",{defaultMessage:"Job summary"})},Object(I.jsx)("ul",null,Object(I.jsx)("li",null,s)))};const Dn=({setIsValid:e,rareDetectorType:t,setRareDetectorType:a})=>{const{jobCreator:n,jobCreatorUpdated:o}=Object(i.useContext)(ze),l=n,[c,d]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{let a=!1;null!==l.rareField&&(t===Rn.RARE||null!==l.populationField)&&(a=!0),e(a),d(a)}),[o]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Fn,{onChange:a}),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,null),Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(_n,null)),Object(I.jsx)(r.EuiFlexItem,null,t!==Rn.RARE&&Object(I.jsx)(sa,null))),c&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(In,{detectorType:t}))))},An=()=>{const{jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:n,jobCreatorUpdated:o}=Object(i.useContext)(ze),l=e,[c,d]=Object(i.useState)(!1),[u,p]=Object(i.useState)([]),[m,b]=Object(i.useState)([]),[f,h]=Object(i.useState)(!1),g=Object(i.useMemo)((()=>null!==l.rareField?null===l.populationField?Rn.RARE:l.frequentlyRare?Rn.FREQ_RARE_POPULATION:Rn.RARE_POPULATION:Rn.RARE),[o]);function j(e){const t=e.anomalies[0];void 0!==t&&p(t)}function x(e){h(e>0)}return Object(i.useEffect)((()=>{const e=a.subscribeToResults(j);return l.subscribeToProgress(x),async function(){d(!0);try{var e;const a=await t.loadEventRateChart(l.start,l.end,n.getInterval().asMilliseconds(),null!==(e=l.runtimeMappings)&&void 0!==e?e:void 0,l.datafeedConfig.indices_options);b(a)}catch(e){b([])}d(!1)}(),()=>{e.unsubscribe()}}),[]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(In,{detectorType:g}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(nt.a,{eventRateChartData:m,anomalyData:u,height:"300px",width:"100%",showAxis:!0,loading:c,fadeChart:f}))},Ln=({setIsValid:e})=>Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Kt,null)),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ea,null))),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Rt,{setIsValid:e})),Object(I.jsx)(r.EuiFlexItem,null)));let Rn;!function(e){e[e.RARE=0]="RARE",e[e.RARE_POPULATION=1]="RARE_POPULATION",e[e.FREQ_RARE_POPULATION=2]="FREQ_RARE_POPULATION"}(Rn||(Rn={}));const Nn=({isActive:e,setCanProceed:t})=>{const[a,n]=Object(i.useState)(!1),[o,l]=Object(i.useState)(!1),[c,d]=Object(i.useState)(Rn.RARE);return Object(i.useEffect)((()=>{"function"==typeof t&&t(a&&o)}),[a,o]),!1===e?Object(I.jsx)(An,null):Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Dn,{setIsValid:n,rareDetectorType:c,setRareDetectorType:d}),a&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{margin:"l"}),Object(I.jsx)(Ln,{setIsValid:l})))};var Pn=a(188);const zn=({combinedJob:e,heightOffset:t=0})=>{const{jobs:{datafeedPreview:a}}=Object(d.a)(),n=Object(i.useMemo)((()=>window.innerHeight-230-t+"px"),[t]),[s,l]=Object(i.useState)(!1),[c,u]=Object(i.useState)(""),[p,m]=Object(i.useState)(!1),[b,f]=Object(i.useState)("");Object(i.useEffect)((()=>{try{null!==e&&(""===b?h():m(JSON.stringify(e)!==b))}catch(e){}}),[e]);const h=Object(i.useCallback)((async()=>{if(u(""),null!==e)if(l(!0),f(JSON.stringify(e)),e.datafeed_config&&e.datafeed_config.indices.length){try{const{datafeed_config:t,...n}=e;if(0===n.analysis_config.detectors.length)u(o.i18n.translate("xpack.ml.newJob.wizard.datafeedPreviewFlyout.noDetectors",{defaultMessage:"No detectors configured"}));else{const e=await a(void 0,n,t);u(JSON.stringify(e,null,2))}}catch(e){u(JSON.stringify(e,null,2))}l(!1),m(!1)}else{const e=o.i18n.translate("xpack.ml.newJob.wizard.datafeedPreviewFlyout.datafeedDoesNotExistLabel",{defaultMessage:"Datafeed does not exist"});u(e)}}),[e]);return Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h5",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedPreviewFlyout.title",defaultMessage:"Datafeed preview"})))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},p&&Object(I.jsx)(r.EuiButton,{size:"s",onClick:h,iconType:"refresh"},"Refresh"))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),!0===s?Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiSpacer,{size:"xxl"}),Object(I.jsx)(r.EuiLoadingSpinner,{size:"l"}))):Object(I.jsx)(cn.a,{value:c,height:n,readOnly:!0}))};let Bn;!function(e){e[e.HIDDEN=0]="HIDDEN",e[e.READONLY=1]="READONLY",e[e.EDITABLE=2]="EDITABLE"}(Bn||(Bn={}));let Jn;!function(e){e[e.HIDDEN=0]="HIDDEN",e[e.READONLY=1]="READONLY",e[e.EDITABLE=2]="EDITABLE"}(Jn||(Jn={}));const Vn=({isDisabled:e,jobEditorMode:t,datafeedEditorMode:a})=>{const{jobCreator:n,jobCreatorUpdate:l,jobCreatorUpdated:c}=Object(i.useContext)(ze),{displayErrorToast:d}=Object(St.c)(),[u,p]=Object(i.useState)(!1),[m,b]=Object(i.useState)(!1),[f,h]=Object(i.useState)(n.formattedJobJson),[g,j]=Object(i.useState)(n.formattedDatafeedJson),[x,v]=Object(i.useState)(!1),[y,O]=Object(i.useState)(null);Object(i.useEffect)((()=>{h(n.formattedJobJson),j(n.formattedDatafeedJson)}),[c]),Object(i.useEffect)((()=>{!0===u?(h(n.formattedJobJson),j(n.formattedDatafeedJson),O({...JSON.parse(n.formattedJobJson),datafeed_config:JSON.parse(n.formattedDatafeedJson)}),b(!1)):O(null)}),[u]);const E=t===Jn.EDITABLE||a===Jn.EDITABLE,w=t===Jn.READONLY&&a===Jn.READONLY;return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Un,{onClick:function(){v(!1),p(!u)},isDisabled:e,editJsonMode:E}),!0===u&&!1===e&&Object(I.jsx)(r.EuiFlyout,{onClose:()=>p(!1),hideCloseButton:!0,size:"l"},Object(I.jsx)(r.EuiFlyoutBody,null,Object(I.jsx)(r.EuiFlexGroup,null,t!==Jn.HIDDEN&&Object(I.jsx)(Gn,{editJson:t===Jn.EDITABLE,onChange:function(e){h(e);const t=Object(dn.c)(e);O(t?{...JSON.parse(e),datafeed_config:JSON.parse(g)}:null),v(t)},title:o.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.job.title",{defaultMessage:"Job configuration JSON"}),value:f,heightOffset:m?100:0}),a!==Jn.HIDDEN&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Gn,{editJson:a===Jn.EDITABLE,onChange:function(e){j(e);const t=Object(Pn.c)(e);let a=Object(dn.c)(t);if(a){const e=JSON.parse(t),i=n.indices.sort();a=i.length===e.indices.length&&i.every(((t,a)=>t===e.indices[a])),b(!1===a),O({...JSON.parse(f),datafeed_config:e})}else b(!1),O(null);v(a)},title:o.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.datafeed.title",{defaultMessage:"Datafeed configuration JSON"}),value:g,heightOffset:m?100:0}),a===Jn.EDITABLE&&Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(zn,{combinedJob:y,heightOffset:m?100:0})))),m&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiCallOut,{color:"warning",size:"s",title:o.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.indicesChange.calloutTitle",{defaultMessage:"Indices have changed"})},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.indicesChange.calloutText",defaultMessage:"You cannot alter the indices being used by the datafeed here. To select a different data view or saved search, go to step 1 of the wizard and select the Change data view option."})))),Object(I.jsx)(r.EuiFlyoutFooter,null,Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:()=>p(!1),flush:"left"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.closeButton",defaultMessage:"Close"}))),!1===w&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:async function(){const e=JSON.parse(f),t=JSON.parse(Object(Pn.c)(g));if(n.cloneFromExistingJob(e,t),Object(Te.a)(n))try{await n.autoSetTimeRange()}catch(e){const t=o.i18n.translate("xpack.ml.newJob.wizard.jsonFlyout.autoSetJobCreatorTimeRange.error",{defaultMessage:"Error retrieving beginning and end times of index"});d(e,t)}l(),p(!1)},fill:!0,isDisabled:!1===x},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jsonFlyout.saveButton",defaultMessage:"Save"})))))))},Un=({isDisabled:e,onClick:t,editJsonMode:a})=>{const n=o.i18n.translate("xpack.ml.newJob.wizard.previewJsonButton",{defaultMessage:"Preview JSON"}),i=o.i18n.translate("xpack.ml.newJob.wizard.editJsonButton",{defaultMessage:"Edit JSON"});return Object(I.jsx)(r.EuiButtonEmpty,{onClick:t,isDisabled:e,"data-test-subj":"mlJobWizardButtonPreviewJobJson"},a?i:n)},Gn=({title:e,value:t,editJson:a,onChange:n,heightOffset:s=0})=>{const o=Object(i.useMemo)((()=>window.innerHeight-230-s+"px"),[s]);return Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h5",null,e)),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(cn.a,{value:t,height:o,mode:cn.b.XJSON,readOnly:!1===a,onChange:n}))},qn=({setCurrentStep:e,isCurrentStep:t})=>{const{jobCreator:a,jobValidator:n,jobValidatorUpdated:s}=Object(i.useContext)(ze),[r,o]=Object(i.useState)(!1),[l,c]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{o(l&&n.isPickFieldsStepValid)}),[s,l]),Object(I.jsx)(i.Fragment,null,t&&Object(I.jsx)(i.Fragment,null,Object(Te.f)(a)&&Object(I.jsx)(Jt,{isActive:t,setCanProceed:c}),Object(Te.c)(a)&&Object(I.jsx)(aa,{isActive:t,setCanProceed:c}),Object(Te.d)(a)&&Object(I.jsx)(ua,{isActive:t,setCanProceed:c}),Object(Te.a)(a)&&Object(I.jsx)(an,{isActive:t,setCanProceed:c}),Object(Te.b)(a)&&Object(I.jsx)(wn,{isActive:t,setCanProceed:c}),Object(Te.e)(a)&&Object(I.jsx)(Nn,{isActive:t,setCanProceed:c}),Object(I.jsx)(Ue,{previous:()=>e(Object(Te.a)(a)?Pe.ADVANCED_CONFIGURE_DATAFEED:Pe.TIME_RANGE),next:()=>e(Pe.JOB_DETAILS),nextActive:r},Object(Te.a)(a)&&Object(I.jsx)(Vn,{isDisabled:!1,jobEditorMode:Jn.EDITABLE,datafeedEditorMode:Jn.EDITABLE}))))},Wn=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.title",{defaultMessage:"Job ID"}),n=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobId.description",{defaultMessage:'A unique identifier for the job. Spaces and the characters  / ? , " < > | * are not allowed'});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:n},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))})),Hn=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:n}=Object(i.useContext)(ze),[s,o]=Object(i.useState)(e.jobId),l=Object(i.useMemo)((()=>{var e,t,n;return{valid:!0===(""===s)||!0===a.jobId.valid&&!0===(null===(e=a.latestValidationResult.jobIdExists)||void 0===e?void 0:e.valid),message:null!==(t=a.jobId.message)&&void 0!==t?t:null===(n=a.latestValidationResult.jobIdExists)||void 0===n?void 0:n.message}}),[n]);return Object(i.useEffect)((()=>{e.jobId=s,t()}),[s]),Object(I.jsx)(Wn,{validation:l},Object(I.jsx)(r.EuiFieldText,{value:s,onChange:e=>o(e.target.value),isInvalid:!1===l.valid,"data-test-subj":"mlJobWizardInputJobId"}))},Yn=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.title",{defaultMessage:"Job description"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.jobDescription.description",defaultMessage:"Optional descriptive text"})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),$n=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(i.useContext)(ze),[a,n]=Object(i.useState)(e.description);return Object(i.useEffect)((()=>{e.description=a,t()}),[a]),Object(I.jsx)(Yn,null,Object(I.jsx)(r.EuiTextArea,{value:a,onChange:e=>n(e.target.value),"data-test-subj":"mlJobWizardInputJobDescription"}))},Xn=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:n}=Object(i.useContext)(ze),{existingJobsAndGroups:s}=Object(i.useContext)(ze),[l,c]=Object(i.useState)(e.groups),d=Object(i.useMemo)((()=>{var e,t,n;return{valid:!0===a.groupIds.valid&&!0===(null===(e=a.latestValidationResult.groupIdsExist)||void 0===e?void 0:e.valid),message:null!==(t=a.groupIds.message)&&void 0!==t?t:null===(n=a.latestValidationResult.groupIdsExist)||void 0===n?void 0:n.message}}),[n]);Object(i.useEffect)((()=>{e.groups=l,t()}),[l.join()]);const u=s.groupIds.map((e=>({label:e,color:Object(it.a)(e)}))),p=l.map((e=>({label:e,color:Object(it.a)(e)})));return Object(I.jsx)(st,{validation:d},Object(I.jsx)(r.EuiComboBox,{placeholder:o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.jobGroupSelect.placeholder",{defaultMessage:"Select or create groups"}),options:u,selectedOptions:p,onChange:function(e){c(e.map((e=>e.label)))},onCreateOption:function(e,t){const a=e.trim().toLowerCase();if(!a)return;const n={label:e,color:Object(it.a)(e)};-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&u.push(n),c([...p,n].map((e=>e.label)))},isClearable:!0,isInvalid:!1===d.valid,"data-test-subj":"mlJobWizardComboBoxJobGroups"}))},Kn=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.description",defaultMessage:"Select to store additional model information used for plotting model bounds. This will add overhead to the performance of the system and is not recommended for high cardinality data."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),Qn=()=>{const{jobCreator:e,jobValidator:t,jobValidatorUpdated:a}=Object(i.useContext)(ze),[n,s]=Object(i.useState)(null);return Object(i.useEffect)((()=>{var e,a,n;const i=null!==(e=null===(a=t.latestValidationResult)||void 0===a||null===(n=a.highCardinality)||void 0===n?void 0:n.value)&&void 0!==e?e:null;s(i)}),[a]),e.modelPlot&&null!==n?Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.title",defaultMessage:"Proceed with caution!"}),color:"warning",iconType:"help"},Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.mmlWarning.message",defaultMessage:"Creating model plots is resource intensive and not recommended where the cardinality of the selected fields is greater than 100. Estimated cardinality for this job is {highCardinality}. If you enable model plot with this configuration we recommend you use a dedicated results index.",values:{highCardinality:n}}))):null},Zn=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),[n,l]=Object(i.useState)(e.modelPlot),[c,d]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{e.modelPlot=n,t()}),[n]),Object(i.useEffect)((()=>{const t=[Pt.b.RARE],a=Object(Te.b)(e)&&e.aggregations.some((e=>t.includes(e.id)));d(!1===a)}),[a]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Kn,null,Object(I.jsx)(r.EuiSwitch,{name:"switch",disabled:!1===c,checked:n,onChange:function(){l(!n)},"data-test-subj":"mlJobWizardSwitchModelPlot",label:o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlot.title",{defaultMessage:"Enable model plot"})})),Object(I.jsx)(Qn,null),Object(I.jsx)(r.EuiSpacer,null))},ei=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.title",{defaultMessage:"Enable model change annotations"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.description",defaultMessage:"Select to generate annotations when the model changes significantly. For example, when step changes, periodicity or trends are detected."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),ti=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),[n,l]=Object(i.useState)(e.modelChangeAnnotations),[c,d]=Object(i.useState)(e.modelPlot&&!e.modelChangeAnnotations);return Object(i.useEffect)((()=>{e.modelChangeAnnotations=n,t()}),[n]),Object(i.useEffect)((()=>{d(e.modelPlot&&!n)}),[a,n]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(ei,null,Object(I.jsx)(r.EuiSwitch,{name:"switch",checked:n,onChange:function(){l(!n)},"data-test-subj":"mlJobWizardSwitchAnnotations",label:o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.enableModelPlotAnnotations.title",{defaultMessage:"Enable model change annotations"})})),c&&Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.annotationsSwitchCallout.title",defaultMessage:"If you enable model plot with this configuration, we recommend you also enable annotations."}),color:"primary",iconType:"help"}),Object(I.jsx)(r.EuiSpacer,null))},ai=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.description",defaultMessage:"Store results in a separate index for this job."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),ni=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(i.useContext)(ze),[a,n]=Object(i.useState)(e.useDedicatedIndex);return Object(i.useEffect)((()=>{e.useDedicatedIndex=a,t()}),[a]),Object(I.jsx)(ai,null,Object(I.jsx)(r.EuiSwitch,{name:"switch",checked:a,onChange:function(){n(!a)},"data-test-subj":"mlJobWizardSwitchUseDedicatedIndex",label:o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSection.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"})}))},ii=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.advancedSectionButton",{defaultMessage:"Advanced"}),si=({advancedExpanded:e,setAdvancedExpanded:t})=>{const{jobCreator:a}=Object(i.useContext)(ze);return a.type===ae.f.ADVANCED?Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{margin:"xl"}),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Zn,null),Object(I.jsx)(ti,null)),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ni,null)))):Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"xl"}),Object(I.jsx)(r.EuiAccordion,{id:"advanced-section",buttonContent:ii,onToggle:t,initialIsOpen:e,"data-test-subj":"mlJobWizardToggleAdvancedSection"},Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"},"data-test-subj":"mlJobWizardAdvancedSection"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Zn,null),Object(I.jsx)(ti,null),Object(I.jsx)(Ja,null)),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ni,null)))))},ri=Object(i.memo)((({children:e})=>{const{services:{docLinks:t}}=Object(d.b)(),a=t.links.ml.calendars,n=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.title",{defaultMessage:"Calendars"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,n),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.description",defaultMessage:"Contains a list of scheduled events that you want to ignore, such as planned system outages or public holidays. {learnMoreLink}",values:{learnMoreLink:Object(I.jsx)(r.EuiLink,{href:a,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},Object(I.jsx)(r.EuiFormRow,null,Object(I.jsx)(s.a.Fragment,null,e)))}));var oi=a(4),li=a(195);const ci=()=>{const{services:{application:{getUrlForApp:e}}}=Object(d.b)(),{jobCreator:t,jobCreatorUpdate:a}=Object(i.useContext)(ze),[n,s]=Object(i.useState)(t.calendars),[l,c]=Object(i.useState)([]),[u,m]=Object(i.useState)([]),[b,f]=Object(i.useState)(!1);async function g(){f(!0);const e=(await be.ml.calendars()).filter((e=>!1===e.job_ids.includes(li.a)));m(e.map((e=>({label:e.calendar_id,value:e})))),c(n.map((e=>({label:e.calendar_id,value:e})))),f(!1)}Object(i.useEffect)((()=>{g()}),[]),Object(i.useEffect)((()=>{t.calendars=n,a()}),[n.join()]);const j={async:!0,options:u,selectedOptions:l,isLoading:b,onChange:e=>{c(e),s(e.map((e=>e.value)))}},x=e(oi.e,{path:p.b.CALENDARS_MANAGE});return Object(I.jsx)(ri,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiComboBox,h()({},j,{"data-test-subj":"mlJobWizardComboBoxCalendars"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiToolTip,{position:"right",content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",defaultMessage:"Refresh calendars"})},Object(I.jsx)(r.EuiButtonIcon,{iconType:"refresh",color:"primary","aria-label":o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.refreshCalendarsButtonLabel",{defaultMessage:"Refresh calendars"}),onClick:g})))),Object(I.jsx)(r.EuiSpacer,{size:"xs"}),Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)(r.EuiLink,{href:x,target:"_blank",external:!0},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.calendarsSelection.manageCalendarsButtonLabel",defaultMessage:"Manage calendars"}))))};var di=a(273);const ui=Object(i.memo)((({children:e})=>{const{services:{docLinks:t}}=Object(d.b)(),a=t.links.ml.customUrls,n=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrls.title",{defaultMessage:"Custom URLs"});return Object(I.jsx)(r.EuiDescribedFormGroup,{fullWidth:!0,className:"ml-custom-urls-selection",title:Object(I.jsx)("h3",null,n),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.description",defaultMessage:"Provide links from anomalies to Kibana dashboards, the Discovery page, or other web pages. {learnMoreLink}",values:{learnMoreLink:Object(I.jsx)(r.EuiLink,{href:a,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.jobDetailsStep.additionalSection.customUrlsSelection.learnMoreLinkText",defaultMessage:"Learn more"}))}})},Object(I.jsx)(r.EuiFormRow,{fullWidth:!0},Object(I.jsx)(s.a.Fragment,null,e)))})),pi=()=>{var e;const{jobCreator:t,jobCreatorUpdate:a}=Object(i.useContext)(ze),n={...t.jobConfig,datafeed_config:t.datafeedConfig};return Object(I.jsx)(ui,null,Object(I.jsx)(di.a,{job:n,jobCustomUrls:null!==(e=t.customUrls)&&void 0!==e?e:[],setCustomUrls:e=>{t.customUrls=e,a()},editMode:"modal"}))},mi=o.i18n.translate("xpack.ml.newJob.wizard.jobDetailsStep.additionalSectionButton",{defaultMessage:"Additional settings"}),bi=({additionalExpanded:e,setAdditionalExpanded:t})=>Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiAccordion,{id:"additional-section",buttonContent:mi,onToggle:t,initialIsOpen:e,"data-test-subj":"mlJobWizardToggleAdditionalSettingsSection"},Object(I.jsx)("section",{"data-test-subj":"mlJobWizardAdditionalSettingsSection"},Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(pi,null))),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl",style:{marginLeft:"0px",marginRight:"0px"}},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ci,null)),Object(I.jsx)(r.EuiFlexItem,null))))),fi=({setCurrentStep:e,isCurrentStep:t,advancedExpanded:a,setAdvancedExpanded:n,additionalExpanded:s,setAdditionalExpanded:o})=>{const{jobCreator:l,jobValidator:c,jobValidatorUpdated:d}=Object(i.useContext)(ze),[u,p]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{var e,t;const a=c.jobId.valid&&c.modelMemoryLimit.valid&&c.groupIds.valid&&!0===(null===(e=c.latestValidationResult.jobIdExists)||void 0===e?void 0:e.valid)&&!0===(null===(t=c.latestValidationResult.groupIdsExist)||void 0===t?void 0:t.valid)&&!1===c.validating;p(a)}),[d]),Object(I.jsx)(i.Fragment,null,t&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(Hn,null),Object(I.jsx)(Xn,null)),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)($n,null))),Object(I.jsx)(bi,{additionalExpanded:s,setAdditionalExpanded:o}),Object(I.jsx)(si,{advancedExpanded:a,setAdvancedExpanded:n}),Object(I.jsx)(Ue,{previous:()=>e(Pe.PICK_FIELDS),next:()=>e(Pe.VALIDATION),nextActive:u},Object(Te.a)(l)&&Object(I.jsx)(Vn,{isDisabled:!1,jobEditorMode:Jn.EDITABLE,datafeedEditorMode:Jn.EDITABLE}))))};var hi=a(138),gi=a.n(hi),ji=a(30),xi=a(10);const vi=Object(x.once)((e=>({categorizer_detector_missing_per_partition_field:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.categorizerMissingPerPartitionFieldMessage",{defaultMessage:'Partition field must be set for detectors that reference "mlcategory" when per-partition categorization is enabled.'}),url:null==e?void 0:e.links.ml.anomalyDetectionConfiguringCategories},categorizer_varying_per_partition_fields:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.categorizerVaryingPerPartitionFieldNamesMessage",{defaultMessage:'Detectors with keyword "mlcategory" cannot have different partition_field_name when per-partition categorization is enabled. Found [{fields}].',values:{fields:'"{{fields}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionConfiguringCategories},field_not_aggregatable:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.fieldNotAggregatableMessage",{defaultMessage:"Detector field {fieldName} is not an aggregatable field.",values:{fieldName:'"{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.aggregrations},fields_not_aggregatable:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.fieldsNotAggregatableMessage",{defaultMessage:"One of the detector fields is not an aggregatable field."}),url:null==e?void 0:e.links.ml.aggregrations},cardinality_no_results:{status:ji.c.WARNING,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityNoResultsHeading",{defaultMessage:"Field cardinality"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityNoResultsMessage",{defaultMessage:"Cardinality checks could not be run. The query to validate fields didn't return any documents."})},cardinality_field_not_exists:{status:ji.c.WARNING,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityFieldNotExistsHeading",{defaultMessage:"Field cardinality"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityFieldNotExistsMessage",{defaultMessage:"Cardinality checks could not be run for field {fieldName}. The query to validate the field didn't return any documents.",values:{fieldName:'"{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.aggregrations},cardinality_by_field:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityByFieldMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000 and might result in high memory usage.",values:{fieldName:'by_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_over_field_low:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityOverFieldLowMessage",{defaultMessage:"Cardinality of {fieldName} is below 10 and might not be suitable for population analysis.",values:{fieldName:'over_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_over_field_high:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityOverFieldHighMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000000 and might result in high memory usage.",values:{fieldName:'over_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_partition_field:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityPartitionFieldMessage",{defaultMessage:"Cardinality of {fieldName} is above 1000 and might result in high memory usage.",values:{fieldName:'partition_field "{{fieldName}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},cardinality_model_plot_high:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.cardinalityModelPlotHighMessage",{defaultMessage:"The estimated cardinality of {modelPlotCardinality} of fields relevant to creating model plots might result in resource intensive jobs.",values:{modelPlotCardinality:"{{modelPlotCardinality}}"}})},categorization_filters_valid:{status:ji.c.SUCCESS,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.categorizationFiltersValidMessage",{defaultMessage:"Categorization filters checks passed."}),url:null==e?void 0:e.links.ml.anomalyDetectionConfiguringCategories},categorization_filters_invalid:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.categorizationFiltersInvalidMessage",{defaultMessage:"The categorization filters configuration is invalid. Make sure filters are valid regular expressions and {categorizationFieldName} is set.",values:{categorizationFieldName:'"categorization_field_name"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_empty:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEmptyMessage",{defaultMessage:"The bucket span field must be specified."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_estimation_mismatch:{status:ji.c.INFO,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEstimationMismatchHeading",{defaultMessage:"Bucket span"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanEstimationMismatchMessage",{defaultMessage:"Current bucket span is {currentBucketSpan}, but bucket span estimation returned {estimateBucketSpan}.",values:{currentBucketSpan:'"{{currentBucketSpan}}"',estimateBucketSpan:'"{{estimateBucketSpan}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionBucketSpan},bucket_span_high:{status:ji.c.INFO,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanHighHeading",{defaultMessage:"Bucket span"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanHighMessage",{defaultMessage:"Bucket span is 1 day or more. Be aware that days are considered as UTC days, not local days."}),url:null==e?void 0:e.links.ml.anomalyDetectionBucketSpan},bucket_span_valid:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanValidHeading",{defaultMessage:"Bucket span"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanValidMessage",{defaultMessage:"Format of {bucketSpan} is valid.",values:{bucketSpan:'"{{bucketSpan}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},bucket_span_invalid:{status:ji.c.ERROR,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanInvalidHeading",{defaultMessage:"Bucket span"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.bucketSpanInvalidMessage",{defaultMessage:"The specified bucket span is not a valid time interval format e.g. 10m, 1h. It also needs to be higher than zero."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResourceAnalysisConfig},detectors_duplicates:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsDuplicatesMessage",{defaultMessage:"Duplicate detectors were found. Detectors having the same combined configuration for {functionParam}, {fieldNameParam}, {byFieldNameParam}, {overFieldNameParam} and {partitionFieldNameParam} are not allowed within the same job.",values:{functionParam:"'function'",fieldNameParam:"'field_name'",byFieldNameParam:"'by_field_name'",overFieldNameParam:"'over_field_name'",partitionFieldNameParam:"'partition_field_name'"}}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},detectors_empty:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsEmptyMessage",{defaultMessage:"No detectors were found. At least one detector must be specified."}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},detectors_function_empty:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionEmptyMessage",{defaultMessage:"One of the detector functions is empty."}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},detectors_function_not_empty:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionNotEmptyHeading",{defaultMessage:"Detector functions"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.detectorsFunctionNotEmptyMessage",{defaultMessage:"Presence of detector functions validated in all detectors."}),url:null==e?void 0:e.links.ml.anomalyDetectionDetectors},index_fields_invalid:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.indexFieldsInvalidMessage",{defaultMessage:"Could not load fields from index."})},index_fields_valid:{status:ji.c.SUCCESS,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.indexFieldsValidMessage",{defaultMessage:"Index fields are present in the datafeed."})},influencer_high:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.influencerHighMessage",{defaultMessage:"The job configuration includes more than 3 influencers. Consider using fewer influencers or creating multiple jobs."}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},influencer_low:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowMessage",{defaultMessage:"No influencers have been configured. Picking an influencer is strongly recommended."}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},influencer_low_suggestion:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowSuggestionMessage",{defaultMessage:"No influencers have been configured. Consider using {influencerSuggestion} as an influencer.",values:{influencerSuggestion:"{{influencerSuggestion}}"}}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},influencer_low_suggestions:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.influencerLowSuggestionsMessage",{defaultMessage:"No influencers have been configured. Consider using one or more of {influencerSuggestion}.",values:{influencerSuggestion:"{{influencerSuggestion}}"}}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},job_id_empty:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdEmptyMessage",{defaultMessage:"Job ID field must not be empty."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_id_invalid:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdInvalidMessage",{defaultMessage:"Job ID is invalid. It can contain lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores and must start and end with an alphanumeric character."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_id_invalid_max_length:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:ji.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_id_valid:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdValidHeading",{defaultMessage:"Job ID format is valid"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobIdValidMessage",{defaultMessage:"Lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores, starts and ends with an alphanumeric character, and is no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:ji.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_group_id_invalid:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdInvalidMessage",{defaultMessage:"One of the job group names is invalid. They can contain lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores and must start and end with an alphanumeric character."}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_group_id_invalid_max_length:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job group name must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:ji.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},job_group_id_valid:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdValidHeading",{defaultMessage:"Job group id formats are valid"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.jobGroupIdValidMessage",{defaultMessage:"Lowercase alphanumeric (a-z and 0-9) characters, hyphens or underscores, starts and ends with an alphanumeric character, and is no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:ji.b}}),url:null==e?void 0:e.links.ml.anomalyDetectionJobResource},missing_summary_count_field_name:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.missingSummaryCountFieldNameMessage",{defaultMessage:"A job configured with a datafeed with aggregations must set summary_count_field_name; use doc_count or suitable alternative."})},skipped_extended_tests:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.skippedExtendedTestsMessage",{defaultMessage:"Skipped additional checks because the basic requirements of the job configuration were not met."})},success_cardinality:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.successCardinalityHeading",{defaultMessage:"Cardinality"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.successCardinalityMessage",{defaultMessage:"Cardinality of detector fields is within recommended bounds."}),url:null==e?void 0:e.links.ml.anomalyDetectionCardinality},success_bucket_span:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.successBucketSpanHeading",{defaultMessage:"Bucket span"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.successBucketSpanMessage",{defaultMessage:"Format of {bucketSpan} is valid and passed validation checks.",values:{bucketSpan:'"{{bucketSpan}}"'}}),url:null==e?void 0:e.links.ml.anomalyDetectionBucketSpan},success_influencers:{status:ji.c.SUCCESS,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.successInfluencersMessage",{defaultMessage:"Influencer configuration passed the validation checks."}),url:null==e?void 0:e.links.ml.anomalyDetectionInfluencers},estimated_mml_greater_than_max_mml:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.estimatedMmlGreaterThanMaxMmlMessage",{defaultMessage:"The estimated model memory limit is greater than the max model memory limit configured for this cluster."})},mml_greater_than_effective_max_mml:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.mmlGreaterThanEffectiveMaxMmlMessage",{defaultMessage:"Job will not be able to run in the current cluster because model memory limit is higher than {effectiveMaxModelMemoryLimit}.",values:{effectiveMaxModelMemoryLimit:"{{effectiveMaxModelMemoryLimit}}"}})},mml_greater_than_max_mml:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.mmlGreaterThanMaxMmlMessage",{defaultMessage:"The model memory limit is greater than the max model memory limit configured for this cluster."})},mml_value_invalid:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.mmlValueInvalidMessage",{defaultMessage:"{mml} is not a valid value for model memory limit. The value needs to be at least 1MB and should be specified in bytes e.g. 10MB.",values:{mml:"{{mml}}"}}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},half_estimated_mml_greater_than_mml:{status:ji.c.WARNING,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.halfEstimatedMmlGreaterThanMmlMessage",{defaultMessage:"The specified model memory limit is less than half of the estimated model memory limit and will likely hit the hard limit."}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},estimated_mml_greater_than_mml:{status:ji.c.INFO,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.estimatedMmlGreaterThanMmlMessage",{defaultMessage:"The estimated model memory limit is greater than the model memory limit you have configured."}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},success_mml:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.successMmlHeading",{defaultMessage:"Model memory limit"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.successMmlMessage",{defaultMessage:"Valid and within the estimated model memory limit."}),url:null==e?void 0:e.links.ml.anomalyDetectionModelMemoryLimits},success_time_range:{status:ji.c.SUCCESS,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.successTimeRangeHeading",{defaultMessage:"Time range"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.successTimeRangeMessage",{defaultMessage:"Valid and long enough to model patterns in the data."})},time_field_invalid:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.timeFieldInvalidMessage",{defaultMessage:"{timeField} cannot be used as the time field because it is not a field of type 'date' or 'date_nanos'.",values:{timeField:"'{{timeField}}'"}})},time_range_short:{status:ji.c.WARNING,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeShortHeading",{defaultMessage:"Time range"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeShortMessage",{defaultMessage:"The selected or available time range might be too short. The recommended minimum time range should be at least {minTimeSpanReadable} and {bucketSpanCompareFactor} times the bucket span.",values:{minTimeSpanReadable:"{{minTimeSpanReadable}}",bucketSpanCompareFactor:"{{bucketSpanCompareFactor}}"}})},time_range_before_epoch:{status:ji.c.WARNING,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeBeforeEpochHeading",{defaultMessage:"Time range"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.timeRangeBeforeEpochMessage",{defaultMessage:"The selected or available time range contains data with timestamps before the UNIX epoch beginning. Timestamps before 01/01/1970 00:00:00 (UTC) are not supported for machine learning jobs."})},datafeed_preview_no_documents:{status:ji.c.WARNING,heading:o.i18n.translate("xpack.ml.models.jobValidation.messages.datafeedPreviewNoDocumentsHeading",{defaultMessage:"Datafeed preview"}),text:o.i18n.translate("xpack.ml.models.jobValidation.messages.datafeedPreviewNoDocumentsMessage",{defaultMessage:"Running the datafeed preview over the current job configuration produces no results. If the index contains no documents this warning can be ignored, otherwise the job may be misconfigured."})},datafeed_preview_failed:{status:ji.c.ERROR,text:o.i18n.translate("xpack.ml.models.jobValidation.messages.datafeedPreviewFailedMessage",{defaultMessage:"The datafeed preview failed. This may be due to an error in the job or datafeed configurations."})}}))),yi=e=>{switch(e){case ji.c.INFO:return"primary";case ji.c.ERROR:return"danger";default:return e}},Oi=e=>{switch(e){case ji.c.INFO:return"iInCircle";case ji.c.ERROR:return"cross";case ji.c.SUCCESS:return"check";case ji.c.WARNING:return"alert";default:return e}},Ei=({url:e})=>Object(I.jsx)(r.EuiLink,{href:e,target:"_BLANK"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.validateJob.learnMoreLinkText",defaultMessage:"Learn more"})),wi=({text:e,url:t})=>Object(I.jsx)(s.a.Fragment,null,e," ",t&&Object(I.jsx)(Ei,{url:t})),Mi=({heading:e,status:t,text:a,url:n})=>Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiCallOut,{"data-test-subj":"mlValidationCallout",color:yi(t),size:"s",title:e||Object(I.jsx)(wi,{text:a,url:n}),iconType:t?Oi(t):"questionInCircle"},e&&Object(I.jsx)(wi,{text:a,url:n})),Object(I.jsx)(r.EuiSpacer,{size:"m"}));var Si=a(46);const _i="questionInCircle",Ti=()=>({ui:{iconType:_i,isLoading:!0,isModalVisible:!1},data:{messages:[],success:!1},title:""}),Ci=({messages:e,idFilterList:t})=>{const a=e.filter((e=>!1===t.includes(e.id))).map(((e,t)=>Object(I.jsx)(Mi,h()({key:`${e.id}_${t}`},e)))),n=Object(I.jsx)(Mi,{text:o.i18n.translate("xpack.ml.validateJob.allPassed",{defaultMessage:"All validation checks passed successfully"}),status:ji.c.SUCCESS});return Object(I.jsx)(s.a.Fragment,null,a.length?a:n)},ki=()=>Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiLoadingSpinner,{size:"xl"}))),Fi=({close:e,title:t,children:a})=>Object(I.jsx)(r.EuiModal,{onClose:e,style:{width:"800px"}},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiModalHeaderTitle,null,t)),Object(I.jsx)(r.EuiModalBody,null,a),Object(I.jsx)(r.EuiModalFooter,null,Object(I.jsx)(r.EuiButton,{onClick:e,size:"s",fill:!0},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.validateJob.modal.closeButtonLabel",defaultMessage:"Close"}))));Fi.propType={close:gi.a.func.isRequired,title:gi.a.string};class validate_job_view_ValidateJobUI extends i.Component{constructor(e){super(e),Se()(this,"closeModal",(()=>{const e=Ti();e.ui.iconType=this.state.ui.iconType,this.setState(e)})),Se()(this,"validate",(()=>{const e=this.props.getJobConfig(),t=this.props.getDuration,a="function"==typeof t?t():void 0,n=this.props.fields;if("object"==typeof e)if("object"==typeof a&&null!==a.start&&null!==a.end){let t=!0;this.props.ml.validateJob({duration:a,fields:n,job:e}).then((a=>{const n=((e,t)=>{const a=vi(t);return e.map((e=>{const t=e.id,n=a[t];return void 0!==n?(void 0!==n.heading&&(e.heading=Object(xi.c)(n.heading,e)),e.text=Object(xi.c)(n.text,e),void 0!==n.url&&(e.url=n.url),e.status=n.status):e.text=o.i18n.translate("xpack.ml.models.jobValidation.unknownMessageIdErrorMessage",{defaultMessage:"{messageId} (unknown message id)",values:{messageId:t}}),e}))})(a,Object(Ye.c)());t=!1;const i=n.some((e=>e.status===ji.c.ERROR));i&&n.push({id:"job_validation_includes_error",text:o.i18n.translate("xpack.ml.validateJob.jobValidationIncludesErrorText",{defaultMessage:"Job validation has failed, but you can still continue and create the job. Please be aware the job may encounter problems when running."}),status:ji.c.WARNING}),this.setState({...this.state,ui:{...this.state.ui,iconType:Oi(Object(dn.b)(n)),isLoading:!1,isModalVisible:!0},data:{messages:n,success:!0},title:e.job_id}),"function"==typeof this.props.setIsValid&&this.props.setIsValid(!i)})).catch((e=>{const{toasts:t}=this.props.kibana.services.notifications;Object(St.b)(t).displayErrorToast(e,o.i18n.translate("xpack.ml.jobService.validateJobErrorTitle",{defaultMessage:"Job Validation Error"}))}));setTimeout((()=>{t&&this.setState({...this.state,ui:{...this.state.ui,isLoading:!0,isModalVisible:!1}})}),250)}else this.setState({...this.state,ui:{...this.state.ui,iconType:Oi(ji.c.WARNING),isLoading:!1,isModalVisible:!0},data:{messages:[{id:"job_validation_skipped",text:o.i18n.translate("xpack.ml.validateJob.jobValidationSkippedText",{defaultMessage:"Job validation could not be run because of insufficient sample data. Please be aware the job may encounter problems when running."}),status:ji.c.WARNING}],success:!0},title:e.job_id}),"function"==typeof this.props.setIsValid&&this.props.setIsValid(!0)})),this.state=Ti()}componentDidMount(){!0===this.props.embedded&&this.validate()}render(){const e=Object(Ye.c)().links.ml.anomalyDetectionJobTips,t=!1!==this.props.fill,a=!0===this.props.isCurrentJobConfig,n=!0===this.props.isDisabled,s=!0===this.props.embedded,o=this.props.idFilterList||[],l=this.state.ui.isLoading;return Object(I.jsx)(i.Fragment,null,!1===s?Object(I.jsx)("div",null,Object(I.jsx)(r.EuiButton,{onClick:this.validate,size:"s",fill:t,iconType:a?this.state.ui.iconType:_i,iconSide:"right",isDisabled:n,isLoading:l},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.validateJob.validateJobButtonLabel",defaultMessage:"Validate Job"})),!n&&this.state.ui.isModalVisible&&Object(I.jsx)(Fi,{close:this.closeModal,title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.validateJob.modal.validateJobTitle",defaultMessage:"Validate job {title}",values:{title:this.state.title}})},l?Object(I.jsx)(ki,null):Object(I.jsx)(Ci,{messages:this.state.data.messages,idFilterList:o}),Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.validateJob.modal.jobValidationDescriptionText",defaultMessage:"Job validation performs certain checks against job configurations and underlying source data and provides specific advice on how to adjust settings that are more likely to produce insightful results."})),Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText",defaultMessage:"For more information, see {mlJobTipsLink}.",values:{mlJobTipsLink:Object(I.jsx)(r.EuiLink,{href:e,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.validateJob.modal.linkToJobTipsText.mlJobTipsLinkText",defaultMessage:"Machine Learning Job Tips"}))}})))):Object(I.jsx)(i.Fragment,null,l?Object(I.jsx)(ki,null):Object(I.jsx)(Ci,{messages:this.state.data.messages,idFilterList:o})))}}const Ii=Object(Si.withKibana)(validate_job_view_ValidateJobUI),Di=["job_id_valid","job_group_id_valid","detectors_function_not_empty","success_bucket_span"],Ai=({setCurrentStep:e,isCurrentStep:t})=>{const{jobCreator:a,jobCreatorUpdate:n,jobValidator:s}=Object(i.useContext)(ze),[r,o]=Object(i.useState)(!1);return a.type===ae.f.ADVANCED&&Di.push("time_range_short","success_time_range"),Object(i.useEffect)((()=>{s.validate((()=>{}),!0),n()}),[]),Object(I.jsx)(i.Fragment,null,t&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Ii,{getJobConfig:function(){return{...a.jobConfig,datafeed_config:a.datafeedConfig}},getDuration:function(){return{start:a.start,end:a.end}},ml:be.ml,embedded:!0,setIsValid:function(e){s.advancedValid=e,o(e)},idFilterList:Di}),Object(I.jsx)(Ue,{previous:()=>e(Pe.JOB_DETAILS),next:()=>e(Pe.SUMMARY),nextActive:r})),!1===t&&Object(I.jsx)(i.Fragment,null))},Li=o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.trueLabel",{defaultMessage:"True"}),Ri=o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.falseLabel",{defaultMessage:"False"}),Ni=o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.defaultString",{defaultMessage:"default"}),Pi=()=>Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobConfig.title",defaultMessage:"Job configuration"}))),zi=()=>Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.datafeedConfig.title",defaultMessage:"Datafeed configuration"}))),Bi=({children:e})=>Object(I.jsx)("span",{style:{fontStyle:"italic"}},e),Ji=()=>{const{jobCreator:e}=Object(i.useContext)(ze),t=Object(de.b)().kibanaConfig.get("dateFormat"),{anomaly_detectors:a}=Object(T.c)(),n=Object(Te.a)(e),s=a.model_memory_limit||"",l=null!==e.modelMemoryLimit?e.modelMemoryLimit:Object(I.jsx)(Bi,null,`${s} (${Ni})`),c=[{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDetails.title",{defaultMessage:"Job ID"}),description:e.jobId},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.title",{defaultMessage:"Job description"}),description:e.description.length>0?e.description:Object(I.jsx)(Bi,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.jobDescription.placeholder",defaultMessage:"No description provided"}))},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.title",{defaultMessage:"Groups"}),description:e.groups.length>0?e.groups.join(", "):Object(I.jsx)(Bi,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.groups.placeholder",defaultMessage:"No groups selected"}))}],d=[{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.bucketSpan.title",{defaultMessage:"Bucket span"}),description:e.bucketSpan}];Object(Te.c)(e)&&d.push({title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.title",{defaultMessage:"Split field"}),description:Object(Te.c)(e)&&null!==e.splitField?e.splitField.name:Object(I.jsx)(Bi,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.splitField.placeholder",defaultMessage:"No split field selected"}))}),Object(Te.d)(e)&&d.push({title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.title",{defaultMessage:"Population field"}),description:Object(Te.d)(e)&&null!==e.populationField?e.populationField.name:Object(I.jsx)("span",{style:{fontStyle:null!==e.populationField?"inherit":"italic"}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.populationField.placeholder",defaultMessage:"No population field selected"}))}),n&&null!==e.categorizationFieldName&&d.push({title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.categorizationField.title",{defaultMessage:"Categorization field"}),description:e.categorizationFieldName}),n&&null!==e.summaryCountFieldName&&d.push({title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.summaryCountField.title",{defaultMessage:"Summary count field"}),description:e.summaryCountFieldName}),d.push({title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.title",{defaultMessage:"Influencers"}),description:e.influencers.length>0?e.influencers.join(", "):Object(I.jsx)(Bi,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.jobDetails.influencers.placeholder",defaultMessage:"No influencers selected"}))});const u=[{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.enableModelPlot.title",{defaultMessage:"Enable model plot"}),description:e.modelPlot?Li:Ri},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.useDedicatedIndex.title",{defaultMessage:"Use dedicated index"}),description:e.useDedicatedIndex?Li:Ri},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.jobDetails.modelMemoryLimit.title",{defaultMessage:"Model memory limit"}),description:l}],p=[{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.start.title",{defaultMessage:"Start"}),description:Ve()(e.start).format(t)},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.timeRange.end.title",{defaultMessage:"End"}),description:Ve()(e.end).format(t)}];return Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:c})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:d})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:u})),!1===n&&Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:p})))},Vi=()=>{const{jobCreator:e}=Object(i.useContext)(ze),{datafeeds:t}=Object(T.c)(),a=JSON.stringify(e.query,null,2),n=Object(_e.f)(e.bucketSpanMs/1e3),s=t.scroll_size||"",l=e.queryDelay||Object(I.jsx)(Bi,null,`${ae.d} (${Ni})`),c=e.frequency||Object(I.jsx)(Bi,null,`${n}s (${Ni})`),d=null!==e.scrollSize?`${e.scrollSize}`:Object(I.jsx)(Bi,null,`${s} (${Ni})`),u=[{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.timeField.title",{defaultMessage:"Time field"}),description:e.timeFieldName},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.queryDelay.title",{defaultMessage:"Query delay"}),description:l},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.frequency.title",{defaultMessage:"Frequency"}),description:c},{title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.scrollSize.title",{defaultMessage:"Scroll size"}),description:d}],p=o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.datafeedDetails.query.title",{defaultMessage:"Elasticsearch query"});return Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:p,fullWidth:!0},Object(I.jsx)(cn.a,{value:a,height:"200px",readOnly:!0}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:u})))},Ui=()=>{const{jobCreator:e}=Object(i.useContext)(ze);return Object(I.jsx)(i.Fragment,null,e.type===ae.f.SINGLE_METRIC&&Object(I.jsx)(Jt,{isActive:!1}),e.type===ae.f.MULTI_METRIC&&Object(I.jsx)(aa,{isActive:!1}),e.type===ae.f.POPULATION&&Object(I.jsx)(ua,{isActive:!1}),e.type===ae.f.ADVANCED&&Object(I.jsx)(an,{isActive:!1}),e.type===ae.f.CATEGORIZATION&&Object(I.jsx)(wn,{isActive:!1}),e.type===ae.f.RARE&&Object(I.jsx)(Nn,{isActive:!1}))},Gi=({progress:e})=>e>0&&e<100?Object(I.jsx)(r.EuiProgress,{value:e,color:"primary",size:"xs",max:100}):null;var qi=a(18),Wi=a(228);const Hi=({jobRunner:e})=>{const{services:{notifications:t}}=Object(d.b)(),{jobCreator:a}=Object(i.useContext)(ze),[n,s]=Object(i.useState)(qi.a.STOPPED),[l,c]=Object(i.useState)(!1);return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{isDisabled:n===qi.a.STARTING||n===qi.a.STARTED,onClick:async function(){const{toasts:n}=t;if(s(qi.a.STARTING),null!==e)try{const t=await e.startDatafeedInRealTime(!0);s(!0===t?qi.a.STARTED:qi.a.STOPPED),n.addSuccess({title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeSuccess",{defaultMessage:"Job {jobId} started",values:{jobId:a.jobId}})})}catch(e){s(qi.a.STOPPED),n.addDanger({title:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTimeError",{defaultMessage:"Error starting job"}),text:Object(Re.b)(e)})}},"data-test-subj":"mlJobWizardButtonRunInRealTime"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.startJobInRealTime",defaultMessage:"Start job running in real time"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{isDisabled:n===qi.a.STOPPED||n===qi.a.STARTING,onClick:c.bind(null,!0),"data-test-subj":"mlJobWizardButtonCreateAlert"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.postSaveOptions.createAlert",defaultMessage:"Create alert rule"}))),n===qi.a.STARTED&&l&&Object(I.jsx)(Wi.c,{jobIds:[a.jobId],onCloseFlyout:c.bind(null,!1)}))},Yi=({startDatafeed:e,setStartDatafeed:t,disabled:a=!1})=>Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiFormRow,{helpText:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.startDatafeedCheckboxHelpText",{defaultMessage:"If unselected, job can be started later from the jobs list."})},Object(I.jsx)(r.EuiSwitch,{"data-test-subj":"mlJobWizardStartDatafeedCheckbox",label:o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.startDatafeedCheckbox",{defaultMessage:"Start immediately"}),checked:e,onChange:e=>t(e.target.checked),disabled:a})));var $i=a(165);const Xi=({setCurrentStep:e,isCurrentStep:t})=>{const{services:{notifications:a,http:{basePath:n}}}=Object(d.b)(),s=Object(d.e)(),{jobCreator:l,jobValidator:c,jobValidatorUpdated:u,resultsLoader:p}=Object(i.useContext)(ze),[m,b]=Object(i.useState)(p.progress),[f,h]=Object(i.useState)(!1),[g,j]=Object(i.useState)(c.validationSummary.basic),[x,v]=Object(i.useState)(null),[y,O]=Object(i.useState)(!0),[E,w]=Object(i.useState)(!1),M=Object(Te.a)(l),S=M?Jn.EDITABLE:Jn.READONLY;async function _(e=!0){try{await l.createJob(),await l.createDatafeed(),Object(Ct.a)(e?l:null,s)}catch(e){T(e)}}function T(e){const{displayErrorToast:t}=Object(St.b)(a.toasts);t(e,o.i18n.translate("xpack.ml.newJob.wizard.summaryStep.createJobError",{defaultMessage:"Job creation error"})),h(!1)}Object(i.useEffect)((()=>{l.subscribeToProgress(b)}),[]),Object(i.useEffect)((()=>{let e=null;return null!==x&&(e=x.subscribeToJobAssignment((e=>w(!e)))),()=>{var t;null!==e&&(null===(t=e)||void 0===t||t.unsubscribe())}}),[x]);return Object(i.useEffect)((()=>{j(c.validationSummary.basic)}),[u]),Object(I.jsx)(i.Fragment,null,t&&Object(I.jsx)(i.Fragment,null,M&&Object(I.jsx)(Pi,null),Object(I.jsx)(Ui,null),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(Gi,{progress:m}),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(Ji,null),!1===M&&Object(I.jsx)(Yi,{startDatafeed:y,setStartDatafeed:O,disabled:f}),M&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,null),Object(I.jsx)(zi,null),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(Vi,null)),Object(I.jsx)(r.EuiHorizontalRule,null),E&&Object(I.jsx)($i.b,{jobType:"anomaly-detector"}),Object(I.jsx)(r.EuiFlexGroup,null,m<100&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Ge,{previous:()=>e(Pe.VALIDATION),previousActive:!1===f&&!0===g})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:async function(){h(!0),M?await _():!0===y?await async function(){try{const e=await l.createAndStartJob();v(e)}catch(e){T(e)}}():await _(!1)},isDisabled:!0===f||!1===g,"data-test-subj":"mlJobWizardButtonCreateJob",fill:!0},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.createJobButton",defaultMessage:"Create job"})))),!1===f&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Vn,{isDisabled:m>0,jobEditorMode:S,datafeedEditorMode:S})),!1===M&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{onClick:()=>{Object(Ct.d)(l,s)}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.convertToAdvancedButton",defaultMessage:"Convert to advanced job"})))),m>0&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:function(){const e=te.a.createResultsUrl([l.jobId],l.start,l.end,!0===Object(Te.f)(l)?"timeseriesexplorer":"explorer");s(`${n.get()}/app/ml/${e}`)},"data-test-subj":"mlJobWizardButtonViewResults"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.viewResultsButton",defaultMessage:"View results"})))),100===m&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:function(){Object(Ct.m)(l,s)},"data-test-subj":"mlJobWizardButtonResetJob"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.summaryStep.resetJobButton",defaultMessage:"Reset job"}))),Object(I.jsx)(Hi,{jobRunner:x})))))},Ki=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.query.title",{defaultMessage:"Elasticsearch query"});return Object(I.jsx)(r.EuiFormRow,{label:t,describedByIds:["description"],fullWidth:!0},Object(I.jsx)(s.a.Fragment,null,e))})),Qi=({setIsValidQuery:e})=>{const{jobCreator:t,jobCreatorUpdate:a,jobCreatorUpdated:n}=Object(i.useContext)(ze),s=t,[r,o]=Object(i.useState)(JSON.stringify(s.query,null,2));return Object(i.useEffect)((()=>{const t=Object(dn.c)(r);e(t),t&&(s.query=JSON.parse(r),a())}),[r]),Object(i.useEffect)((()=>{if(Object(dn.c)(r)){const e=JSON.parse(r),t=JSON.stringify(e,null,2),a=JSON.stringify(s.query,null,2);t!==a&&o(a)}}),[n]),Object(i.useEffect)((()=>{const t=Object(dn.c)(r);e(t)}),[]),Object(I.jsx)(Ki,null,Object(I.jsx)(cn.a,{value:r,height:"400px",readOnly:!1,onChange:function(e){o(e)}}))},Zi=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.queryDelay.title",{defaultMessage:"Query delay"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.queryDelay.description",defaultMessage:"Time delay in seconds, between current time and latest input data time."})},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))}));function es(e){const[t,a]=Object(i.useState)(n(e));function n(e){return null===e?"":e}return{value:t,setValue:function(e){a(n(e))}}}const ts=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:n}=Object(i.useContext)(ze),[s,o]=Object(i.useState)(a.queryDelay),{value:l,setValue:c}=es(e.queryDelay);return Object(i.useEffect)((()=>{e.queryDelay=""===l?null:l,t()}),[l]),Object(i.useEffect)((()=>{c(null===e.queryDelay?"":e.queryDelay)}),[t]),Object(i.useEffect)((()=>{o(a.queryDelay)}),[n]),Object(I.jsx)(Zi,{validation:s},Object(I.jsx)(r.EuiFieldText,{value:l,placeholder:ae.d,onChange:e=>c(e.target.value),isInvalid:!1===s.valid,"data-test-subj":"mlJobWizardInputQueryDelay"}))},as=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.frequency.title",{defaultMessage:"Frequency"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.frequency.description",defaultMessage:"The interval between searches."})},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))})),ns=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a,jobValidator:n,jobValidatorUpdated:s}=Object(i.useContext)(ze),[o,l]=Object(i.useState)(n.frequency),{value:c,setValue:d}=es(e.frequency),[u,p]=Object(i.useState)(m());function m(){return`${Object(_e.f)(e.bucketSpanMs/1e3)}s`}return Object(i.useEffect)((()=>{e.frequency=""===c?null:c,t()}),[c]),Object(i.useEffect)((()=>{d(e.frequency);const t=m();p(t)}),[a]),Object(i.useEffect)((()=>{l(n.frequency)}),[s]),Object(I.jsx)(as,{validation:o},Object(I.jsx)(r.EuiFieldText,{value:c,placeholder:u,onChange:e=>d(e.target.value),isInvalid:!1===o.valid,"data-test-subj":"mlJobWizardInputFrequency"}))},is=Object(i.memo)((({children:e,validation:t})=>{const a=o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.scrollSize.title",{defaultMessage:"Scroll size"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,a),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.scrollSize.description",defaultMessage:"The maximum number of documents to return in each search request."})},Object(I.jsx)(r.EuiFormRow,{label:a,error:t.message,isInvalid:!1===t.valid},Object(I.jsx)(s.a.Fragment,null,e)))})),ss=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobValidator:a,jobValidatorUpdated:n}=Object(i.useContext)(ze),[s,o]=Object(i.useState)(a.scrollSize),[l,c]=Object(i.useState)(null===e.scrollSize?"":`${e.scrollSize}`),{datafeeds:d}=Object(T.c)(),u=void 0!==d.scroll_size?`${d.scroll_size}`:"";return Object(i.useEffect)((()=>{e.scrollSize=""===l?null:+l,t()}),[l]),Object(i.useEffect)((()=>{c(null===e.scrollSize?"":`${e.scrollSize}`)}),[t]),Object(i.useEffect)((()=>{o(a.scrollSize)}),[n]),Object(I.jsx)(is,{validation:s},Object(I.jsx)(r.EuiFieldNumber,{min:0,placeholder:u,value:""===l?l:+l,onChange:e=>c(e.target.value),isInvalid:!1===s.valid,"data-test-subj":"mlJobWizardInputScrollSize"}))},rs=()=>{const{jobCreator:e,jobCreatorUpdate:t}=Object(i.useContext)(ze),[a,n]=Object(i.useState)(!1),[l]=Object(i.useState)(JSON.stringify(w(),null,2)),c=()=>n(!1);return Object(I.jsx)(s.a.Fragment,null,a&&Object(I.jsx)(r.EuiConfirmModal,{title:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.title",{defaultMessage:"Reset datafeed query"}),onCancel:c,onConfirm:function(){e.query=w(),t(),c()},cancelButtonText:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.cancel",{defaultMessage:"Cancel"}),confirmButtonText:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.confirm",{defaultMessage:"Confirm"}),defaultFocusedButton:"confirm"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.resetQueryConfirm.description",defaultMessage:"Set the datafeed query to be the default."}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiCodeBlock,{language:"js",fontSize:"m",paddingSize:"s"},l)),Object(I.jsx)(r.EuiButtonEmpty,{size:"s",onClick:()=>n(!0)},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.resetQueryButton",defaultMessage:"Reset datafeed query to default"})))},os=({fields:e,changeHandler:t,selectedField:a})=>{const{jobCreator:n}=Object(i.useContext)(ze),s=Object(Ct.g)(e,n.additionalFields),o=[];return null!==a&&o.push({label:a}),Object(I.jsx)(r.EuiComboBox,{singleSelection:{asPlainText:!0},options:s,selectedOptions:o,onChange:function(e){const a=e[0];void 0!==a&&t(a.label)},isClearable:!1,"data-test-subj":"mlTimeFieldNameSelect"})},ls=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.timeField.title",{defaultMessage:"Time field"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.timeField.description",defaultMessage:"The default time field for the data view is automatically selected, but can be overridden."})},Object(I.jsx)(r.EuiFormRow,{label:t},Object(I.jsx)(s.a.Fragment,null,e)))})),cs=()=>{const{jobCreator:e,jobCreatorUpdate:t,jobCreatorUpdated:a}=Object(i.useContext)(ze),n=e,{dateFields:s}=Be.b,[r,o]=Object(i.useState)(n.timeFieldName);return Object(i.useEffect)((()=>{n.timeFieldName=r,t()}),[r]),Object(i.useEffect)((()=>{o(n.timeFieldName)}),[a]),Object(I.jsx)(ls,null,Object(I.jsx)(os,{fields:s,changeHandler:o,selectedField:r}))},ds=Object(i.memo)((({children:e})=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.title",{defaultMessage:"Data view"});return Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h3",null,t),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.description",defaultMessage:"The data view that is currently used for this job."})},Object(I.jsx)(r.EuiFormRow,null,Object(I.jsx)(s.a.Fragment,null,e)))}));var us;!function(e){e[e.PICK_DATA_VIEW=0]="PICK_DATA_VIEW",e[e.VALIDATE=1]="VALIDATE"}(us||(us={}));const ps=({onClose:e})=>{const{services:{savedObjects:t,uiSettings:a,data:{dataViews:n}}}=Object(d.b)(),l=Object(d.e)(),{validateDatafeedPreview:c}=Object(d.a)(),{jobCreator:u}=Object(i.useContext)(ze),p=u,[m,b]=Object(i.useState)(!1),[f,h]=Object(i.useState)(us.PICK_DATA_VIEW),[g,j]=Object(i.useState)(""),[x,v]=Object(i.useState)(""),[y,O]=Object(i.useState)(null);Object(i.useEffect)((function(){j(p.indexPatternTitle)}),[]),Object(i.useEffect)((function(){f===us.PICK_DATA_VIEW&&O(null)}),[f]);const E=Object(i.useCallback)((async e=>{b(!0);const{title:t}=await n.get(e);v(t);const a=t.split(",");if(p.detectors.length){const e={...p.datafeedConfig,indices:a},t=await c({job:{...p.jobConfig,datafeed_config:e}});O(t)}b(!1)}),[n,c,p]),w=Object(i.useCallback)((()=>{const e=x.split(",");p.indices=e,Object(Ct.l)(p,l)}),[p,x,l]);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiModal,{onClose:e,"data-test-subj":"mlJobMgmtImportJobsFlyout"},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiModalHeaderTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step0.title",defaultMessage:"Change data view"}))),Object(I.jsx)(r.EuiModalBody,null,f===us.PICK_DATA_VIEW&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step1.title",defaultMessage:"Select new data view for the job"}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(K.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:function(e){!1===m&&(h(us.VALIDATE),E(e))},showFilter:!0,noItemsMessage:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.step1.noMatchingError",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.step1.dataView",{defaultMessage:"Data view"})}],fixedPageSize:8,uiSettings:a,savedObjects:t})),f===us.VALIDATE&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.title",defaultMessage:"Changing {dv1} for {dv2}",values:{dv1:g,dv2:x}}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),!0===m?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiLoadingSpinner,null),Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.validatingText",defaultMessage:"Checking data view and job compatibility"})):Object(I.jsx)(ms,{validationResponse:y,dataViewTitle:x}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{onClick:h.bind(null,us.PICK_DATA_VIEW),isDisabled:m,flush:"left"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.backButton",defaultMessage:"Back"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:()=>w(),isDisabled:m,"data-test-subj":"mlJobsImportButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.step2.ApplyButton",defaultMessage:"Apply"}))))))))},ms=({validationResponse:e,dataViewTitle:t})=>null===e?Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.noDetectors.title",{defaultMessage:"Data view valid"}),color:"primary"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.noDetectors.message",defaultMessage:"No detectors have been configured; this data view can be applied to the job."})):!0===e.valid?!0===e.documentsFound?Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.valid.title",{defaultMessage:"Data view valid"}),color:"primary"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.valid.message",defaultMessage:"This data view can be applied to this job."})):Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.possiblyInvalid.title",{defaultMessage:"Data view possibly invalid"}),color:"warning"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.possiblyInvalid.message",defaultMessage:"This data view produced no results when previewing the datafeed. There may be no documents in {dataViewTitle}.",values:{dataViewTitle:t}})):Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.newJob.wizard.datafeedStep.dataView.validation.invalid.title",{defaultMessage:"Data view invalid"}),color:"danger"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.invalid.message",defaultMessage:"This data view produced an error when attempting to preview the datafeed. The fields selected for this job might not exist in {dataViewTitle}.",values:{dataViewTitle:t}}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.validation.invalid.reason",defaultMessage:"Reason:"}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),e.error?Object(Re.b)(e.error):null),bs=({isDisabled:e})=>{const[t,a]=Object(i.useState)(!1);return Object(I.jsx)(s.a.Fragment,null,t&&Object(I.jsx)(ps,{onClose:a.bind(null,!1)}),Object(I.jsx)(ds,null,Object(I.jsx)(r.EuiButtonEmpty,{onClick:a.bind(null,!0),isDisabled:e,"data-test-subj":"mlJobsImportButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.datafeedStep.dataView.changeDataView.button",defaultMessage:"Change data view"}))))},fs=({setCurrentStep:e,isCurrentStep:t})=>{const{jobValidator:a,jobValidatorUpdated:n}=Object(i.useContext)(ze),[s,o]=Object(i.useState)(!1),[l,c]=Object(i.useState)(!1);return Object(i.useEffect)((()=>{const e=l&&a.queryDelay.valid&&a.frequency.valid&&a.scrollSize.valid&&!1===a.validating;o(e)}),[n,l]),Object(I.jsx)(i.Fragment,null,t&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,{"data-test-subj":"mlAdvancedDatafeedQueryEditor"},Object(I.jsx)(Qi,{setIsValidQuery:c})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(ts,null),Object(I.jsx)(ns,null),Object(I.jsx)(ss,null),Object(I.jsx)(cs,null),Object(I.jsx)(bs,{isDisabled:!1}))),Object(I.jsx)(rs,null),Object(I.jsx)(Ue,{next:()=>e(Pe.PICK_FIELDS),nextActive:s},Object(I.jsx)(Vn,{isDisabled:!1,jobEditorMode:Jn.EDITABLE,datafeedEditorMode:Jn.EDITABLE}))))},hs=({currentStep:e,setCurrentStep:t})=>{const a=Object(de.b)(),[n,s]=Object(i.useState)(!1),[r,l]=Object(i.useState)(!1);return Object(I.jsx)(i.Fragment,null,e===Pe.TIME_RANGE&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(gs,{"data-test-subj":"mlJobWizardStepTitleTimeRange"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.timeRangeTitle",defaultMessage:"Time range"})),Object(I.jsx)(lt,{isCurrentStep:e===Pe.TIME_RANGE,setCurrentStep:t})),e===Pe.ADVANCED_CONFIGURE_DATAFEED&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(gs,{"data-test-subj":"mlJobWizardStepTitleConfigureDatafeed"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.configureDatafeedTitle",defaultMessage:"Configure datafeed"})),Object(I.jsx)(fs,{isCurrentStep:e===Pe.ADVANCED_CONFIGURE_DATAFEED,setCurrentStep:t})),e===Pe.PICK_FIELDS&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(gs,{"data-test-subj":"mlJobWizardStepTitlePickFields"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.pickFieldsTitle",defaultMessage:"Pick fields"})),Object(I.jsx)(qn,{isCurrentStep:e===Pe.PICK_FIELDS,setCurrentStep:t})),e===Pe.JOB_DETAILS&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(gs,{"data-test-subj":"mlJobWizardStepTitleJobDetails"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.jobDetailsTitle",defaultMessage:"Job details"})),Object(I.jsx)(fi,{isCurrentStep:e===Pe.JOB_DETAILS,setCurrentStep:t,advancedExpanded:n,setAdvancedExpanded:s,additionalExpanded:r,setAdditionalExpanded:l})),e===Pe.VALIDATION&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(gs,{"data-test-subj":"mlJobWizardStepTitleValidation"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.wizard.stepComponentWrapper.validationTitle",defaultMessage:"Validation"})),Object(I.jsx)(Ai,{isCurrentStep:e===Pe.VALIDATION,setCurrentStep:t})),e===Pe.SUMMARY&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(gs,{"data-test-subj":"mlJobWizardStepTitleSummary"},null!==a.currentSavedSearch?o.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleSavedSearch",{defaultMessage:"New job from saved search {title}",values:{title:a.currentSavedSearch.attributes.title}}):void 0!==a.currentDataView.id?o.i18n.translate("xpack.ml.newJob.wizard.stepComponentWrapper.summaryTitleDataView",{defaultMessage:"New job from data view {dataViewName}",values:{dataViewName:a.currentDataView.title}}):""),Object(I.jsx)(Xi,{isCurrentStep:e===Pe.SUMMARY,setCurrentStep:t})))},gs=({"data-test-subj":e,children:t})=>Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h2",{"data-test-subj":e},t)),Object(I.jsx)(r.EuiSpacer,null)),js=({currentStep:e,highestStep:t,setCurrentStep:a,disableSteps:n,jobType:i})=>{const s=[{title:o.i18n.translate("xpack.ml.newJob.wizard.step.timeRangeTitle",{defaultMessage:"Time range"}),...l(Pe.TIME_RANGE)},{title:o.i18n.translate("xpack.ml.newJob.wizard.step.pickFieldsTitle",{defaultMessage:"Pick fields"}),...l(Pe.PICK_FIELDS)},{title:o.i18n.translate("xpack.ml.newJob.wizard.step.jobDetailsTitle",{defaultMessage:"Job details"}),...l(Pe.JOB_DETAILS)},{title:o.i18n.translate("xpack.ml.newJob.wizard.step.validationTitle",{defaultMessage:"Validation"}),...l(Pe.VALIDATION)},{title:o.i18n.translate("xpack.ml.newJob.wizard.step.summaryTitle",{defaultMessage:"Summary"}),...l(Pe.SUMMARY)}];function l(i){return{onClick:()=>function(e){e<=t&&a(e)}(i),isSelected:e===i,isComplete:e>i,disabled:n||t<i}}return i===ae.f.ADVANCED&&s.splice(0,1,{title:o.i18n.translate("xpack.ml.newJob.wizard.step.configureDatafeedTitle",{defaultMessage:"Configure datafeed"}),...l(Pe.ADVANCED_CONFIGURE_DATAFEED)}),Object(I.jsx)(r.EuiStepsHorizontal,{steps:s,style:{backgroundColor:"inherit"}})},xs=({jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:n,jobValidator:s,existingJobsAndGroups:r,firstWizardStep:o=Pe.TIME_RANGE})=>{const[l,c]=Object(i.useReducer)((e=>e+1),0),d=()=>c(l),[u,p]=Object(i.useReducer)((e=>e+1),0),m={jobCreatorUpdated:l,jobCreatorUpdate:d,jobCreator:e,chartLoader:t,resultsLoader:a,chartInterval:n,jobValidator:s,jobValidatorUpdated:u,fields:Be.b.fields,aggs:Be.b.aggs,existingJobsAndGroups:r},b=e.type===ae.f.ADVANCED?Pe.ADVANCED_CONFIGURE_DATAFEED:Pe.TIME_RANGE,[f,h]=Object(i.useState)(b),[g,j]=Object(i.useState)(b),[x,v]=Object(i.useState)(!1),[y,O]=Object(i.useState)(a.progress),[E,w]=Object(i.useState)(vs(e.jobConfig,e.datafeedConfig));return Object(i.useEffect)((()=>{const e=s.validationResult$.subscribe((()=>{p(u)}));return()=>e.unsubscribe()}),[]),Object(i.useEffect)((()=>{s.validate((()=>{p(u)}));const t=vs(e.jobConfig,e.datafeedConfig);t!==E&&(j(f),w(t))}),[l]),Object(i.useEffect)((()=>{e.subscribeToProgress(O),h(o)}),[]),Object(i.useEffect)((()=>{v(y>0)}),[y]),Object(i.useEffect)((()=>{f>=g&&j(f)}),[f]),Ne(e,s,d,l),Object(I.jsx)(ze.Provider,{value:m},Object(I.jsx)(js,{currentStep:f,highestStep:g,setCurrentStep:h,disableSteps:x,jobType:e.type}),Object(I.jsx)(hs,{currentStep:f,setCurrentStep:h}))};function vs(e,t){return JSON.stringify(e)+JSON.stringify(t)}var ys=a(231),Os=a.n(ys),Es=a(135);function ws(e,t,a,n,i,s){return new Promise(((r,o)=>{be.ml.esSearch({index:e,size:0,body:{query:n,aggs:{catFields:{terms:{field:t,size:a}}},...void 0!==i?{runtime_mappings:i}:{}},...null!=s?s:{}}).then((e=>{const t=Object(x.get)(e,["aggregations","catFields","buckets"],[]);r({success:!0,results:t.map((e=>e.key))})})).catch((e=>{o(e)}))}))}const Ms=(e,t)=>Object(x.isEqual)(e,t);class chart_loader_ChartLoader{constructor(e,t){Se()(this,"_indexPatternTitle",""),Se()(this,"_timeFieldName",""),Se()(this,"_query",{}),Se()(this,"_newJobLineChart",Os()(be.ml.jobs.newJobLineChart,Ms)),Se()(this,"_newJobPopulationsChart",Os()(be.ml.jobs.newJobPopulationsChart,Ms)),Se()(this,"_getEventRateData",Os()(Es.mlResultsService.getEventRateData,Ms)),Se()(this,"_getCategoryFields",Os()(ws,Ms)),this._indexPatternTitle=e.title,this._query=t,"string"==typeof e.timeFieldName&&(this._timeFieldName=e.timeFieldName)}async loadLineCharts(e,t,a,n,i,s,r,o){if(""!==this._timeFieldName){if(!1===Object(Ct.b)(a))return{};const l=null!==n?n.name:null,c=a.map(Ss);return(await this._newJobLineChart(this._indexPatternTitle,this._timeFieldName,e,t,s,this._query,c,l,i,null!=r?r:void 0,o)).results}return{}}async loadPopulationCharts(e,t,a,n,i,s,r){if(""!==this._timeFieldName){if(!1===Object(Ct.b)(a))return{};const o=null!==n?n.name:"",l=a.map(Ss);return(await this._newJobPopulationsChart(this._indexPatternTitle,this._timeFieldName,e,t,i,this._query,l,o,null!=s?s:void 0,r)).results}return{}}async loadEventRateChart(e,t,a,n,i){if(""!==this._timeFieldName){const s=await this._getEventRateData(this._indexPatternTitle,this._query,this._timeFieldName,e,t,3*a,n,i);if(void 0!==s.error)throw s.error;return Object.entries(s.results).map((([e,t])=>({time:+e,value:t})))}return[]}async loadFieldExampleValues(e,t,a){const{results:n}=await this._getCategoryFields(this._indexPatternTitle,e.name,10,this._query,null!=t?t:void 0,a);return n}}function Ss(e){const t=void 0!==e.by&&null!==e.by.field&&null!==e.by.value?{field:e.by.field.id,value:e.by.value}:{field:null,value:null};return{agg:e.agg.dslName||"",field:e.field.id,by:t}}var _s=a(395),Ts=a(110);const Cs=({existingJobsAndGroups:e,jobType:t})=>{const a=Object(de.b)(),n=Object(i.useMemo)((()=>Object(Te.g)(t)(a.currentDataView,a.currentSavedSearch,a.combinedQuery)),[t]),{displayErrorToast:s}=Object(St.c)(),{from:l,to:c}=Ke();n.setTimeRange(l,c);let d=t===ae.f.ADVANCED?Pe.ADVANCED_CONFIGURE_DATAFEED:Pe.TIME_RANGE,u=!1;if(void 0!==te.a.tempJobCloningObjects.job&&void 0!==te.a.tempJobCloningObjects.datafeed){const e=te.a.tempJobCloningObjects.job,a=te.a.cloneDatafeed(te.a.tempJobCloningObjects.datafeed);p(),n.cloneFromExistingJob(e,a),!1===te.a.tempJobCloningObjects.skipTimeRangeStep?n.jobId="":t!==ae.f.ADVANCED&&(d=Pe.PICK_FIELDS),te.a.tempJobCloningObjects.skipTimeRangeStep=!1,te.a.tempJobCloningObjects.job=void 0,te.a.tempJobCloningObjects.datafeed=void 0,te.a.tempJobCloningObjects.createdBy=void 0,void 0!==te.a.tempJobCloningObjects.start&&void 0!==te.a.tempJobCloningObjects.end?(n.setTimeRange(te.a.tempJobCloningObjects.start,te.a.tempJobCloningObjects.end),te.a.tempJobCloningObjects.start=void 0,te.a.tempJobCloningObjects.end=void 0):u=Object(Te.a)(n),te.a.tempJobCloningObjects.calendars&&(n.calendars=te.a.tempJobCloningObjects.calendars,te.a.tempJobCloningObjects.calendars=void 0)}else if(n.bucketSpan=ae.b,n.type!==ae.f.POPULATION&&n.type!==ae.f.ADVANCED&&n.type!==ae.f.CATEGORIZATION&&(n.modelMemoryLimit=ae.c),n.type===ae.f.SINGLE_METRIC&&(n.modelPlot=!0,n.modelChangeAnnotations=!0),null!==a.currentSavedSearch&&(n.createdBy=null),u=Object(Te.a)(n),p(),Object(Te.b)(n)){const{catFields:e}=Be.b;1===e.length&&(n.categorizationFieldName=e[0].name)}function p(){if(Object(Te.b)(n)){const e=Be.b.getAggById("count"),t=Be.b.getAggById("rare"),a=Be.b.getFieldById(Dt.a);n.setDefaultDetectorProperties(e,t,a);const{anomaly_detectors:i}=Object(T.c)();n.categorizationAnalyzer=i.categorization_analyzer}else if(Object(Te.e)(n)){const e=Be.b.getAggById("rare"),t=Be.b.getAggById("freq_rare");n.setDefaultDetectorProperties(e,t)}}u&&Object(Te.a)(n)&&n.autoSetTimeRange().catch((e=>{const t=o.i18n.translate("xpack.ml.newJob.wizard.autoSetJobCreatorTimeRange.error",{defaultMessage:"Error retrieving beginning and end times of index"});s(e,t)}));const m=Object(Ts.c)();m.setBarTarget(600),m.setMaxBars(1200),m.setInterval("auto");const b=Object(i.useMemo)((()=>new chart_loader_ChartLoader(a.currentDataView,a.combinedQuery)),[]),f=Object(i.useMemo)((()=>new job_validator_JobValidator(n)),[n]),h=Object(i.useMemo)((()=>new _s.b(n,m,b)),[]);Object(i.useEffect)((()=>()=>{n.forceStopRefreshPolls()}));const g=Object(Ct.i)(n);return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.page.createJob",defaultMessage:"Create job"}),":"," ",g),Object(I.jsx)("div",{style:{backgroundColor:"inherit"},"data-test-subj":`mlPageJobWizard ${t}`},Object(I.jsx)(r.EuiPageContentHeader,null,Object(I.jsx)(r.EuiPageContentHeaderSection,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.page.createJob.dataViewName",defaultMessage:"Using data view {dataViewName}",values:{dataViewName:n.indexPatternTitle}}))),Object(I.jsx)(xs,{jobCreator:n,chartLoader:b,resultsLoader:h,chartInterval:m,jobValidator:f,existingJobsAndGroups:e,firstWizardStep:d})))};var ks=a(142);const Fs="anomaly-detector";function Is(e,t,a,n){return new Promise((async(i,s)=>{try{const r=n===Fs?Be.b:ks.a;if(void 0!==e){const t=await a.get(e);await r.initializeFromDataVIew(t),i(r.newJobCaps)}else if(void 0!==t){const{dataView:e}=await Object(j.b)(t);if(null===e)return console.error("Cannot retrieve data view from saved search"),void s();await r.initializeFromDataVIew(e),i(r.newJobCaps)}else s()}catch(e){s(e)}}))}const Ds=(e,t)=>[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),F("CREATE_JOB_BREADCRUMB",e,t)],As=(e,t)=>[...Ds(e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.singleMetricLabel",{defaultMessage:"Single metric"}),href:""}],Ls=(e,t)=>[...Ds(e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.multiMetricLabel",{defaultMessage:"Multi-metric"}),href:""}],Rs=(e,t)=>[...Ds(e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.populationLabel",{defaultMessage:"Population"}),href:""}],Ns=(e,t)=>[...Ds(e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.advancedConfigurationLabel",{defaultMessage:"Advanced configuration"}),href:""}],Ps=(e,t)=>[...Ds(e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.categorizationLabel",{defaultMessage:"Categorization"}),href:""}],zs=(e,t)=>[...Ds(e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.rareLabel",{defaultMessage:"Rare"}),href:""}],Bs=(e,t)=>({path:"/jobs/new_job/single_metric",render:(e,t)=>Object(I.jsx)(Ws,h()({},e,{jobType:ae.f.SINGLE_METRIC,deps:t})),breadcrumbs:As(e,t)}),Js=(e,t)=>({path:"/jobs/new_job/multi_metric",render:(e,t)=>Object(I.jsx)(Ws,h()({},e,{jobType:ae.f.MULTI_METRIC,deps:t})),breadcrumbs:Ls(e,t)}),Vs=(e,t)=>({path:"/jobs/new_job/population",render:(e,t)=>Object(I.jsx)(Ws,h()({},e,{jobType:ae.f.POPULATION,deps:t})),breadcrumbs:Rs(e,t)}),Us=(e,t)=>({path:"/jobs/new_job/advanced",render:(e,t)=>Object(I.jsx)(Ws,h()({},e,{jobType:ae.f.ADVANCED,deps:t})),breadcrumbs:Ns(e,t)}),Gs=(e,t)=>({path:"/jobs/new_job/categorization",render:(e,t)=>Object(I.jsx)(Ws,h()({},e,{jobType:ae.f.CATEGORIZATION,deps:t})),breadcrumbs:Ps(e,t)}),qs=(e,t)=>({path:"/jobs/new_job/rare",render:(e,t)=>Object(I.jsx)(Ws,h()({},e,{jobType:ae.f.RARE,deps:t})),breadcrumbs:zs(e,t)}),Ws=({location:e,jobType:t,deps:a})=>{const n=Object(M.a)(p.b.ANOMALY_DETECTION_JOBS_MANAGE),{index:i,savedSearchId:s}=Object(ce.parse)(e.search,{sort:!1}),{context:r,results:o}=S(i,s,a.config,a.dataViewsContract,{...U(a),privileges:()=>Object(m.a)(n),jobCaps:()=>Is(i,s,a.dataViewsContract,Fs),existingJobsAndGroups:te.a.getJobAndGroupIds});return Object(I.jsx)(g.b,{context:r},Object(I.jsx)(Cs,{jobType:t,existingJobsAndGroups:o.existingJobsAndGroups}))},Hs=Object(i.memo)((({saveState:e,resultsUrl:t,onReset:a})=>e===ir.NOT_SAVED?null:Object(I.jsx)(s.a.Fragment,null,e===ir.SAVED&&Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsCreatedTitle",defaultMessage:"Jobs created"}),color:"success",iconType:"checkInCircleFilled"}),e===ir.FAILED&&Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.simple.recognize.jobsCreationFailedTitle",defaultMessage:"Jobs creation failed"}),color:"danger",iconType:"alert"}),e===ir.PARTIAL_FAILURE&&Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailedTitle",defaultMessage:"Some jobs failed to be created"}),color:"warning",iconType:"alert"}),Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd",alignItems:"center"},e!==ir.SAVING&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{color:"primary",fill:!1,"aria-label":o.i18n.translate("xpack.ml.newJob.recognize.jobsCreationFailed.resetButtonAriaLabel",{defaultMessage:"Reset"}),onClick:a},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.someJobsCreationFailed.resetButtonLabel",defaultMessage:"Reset"}))),(e===ir.SAVED||e===ir.PARTIAL_FAILURE)&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{color:"primary",fill:!0,href:t,"aria-label":o.i18n.translate("xpack.ml.newJob.recognize.viewResultsAriaLabel",{defaultMessage:"View results"})},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.viewResultsLinkText",defaultMessage:"View results"}))))))),Ys=Object(i.memo)((({objectType:e,kibanaObjects:t,isSaving:a})=>{const n={dashboard:o.i18n.translate("xpack.ml.newJob.recognize.dashboardsLabel",{defaultMessage:"Dashboards"}),search:o.i18n.translate("xpack.ml.newJob.recognize.searchesLabel",{defaultMessage:"Searches"}),visualization:o.i18n.translate("xpack.ml.newJob.recognize.visualizationsLabel",{defaultMessage:"Visualizations"})};return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h4",null,n[e])),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)("ul",null,t.map((({id:e,title:n,success:i,exists:s,error:l},c)=>Object(I.jsx)("li",{key:e},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"s",color:s?"subdued":"success"},n),!1===i&&void 0!==l&&Object(I.jsx)(r.EuiText,{size:"xs",color:"danger"},Object(Re.b)(l))),s&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs",color:"default"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.alreadyExistsLabel",defaultMessage:"(already exists)"}))))),!s&&Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{width:"60px"}},Object(I.jsx)(r.EuiText,{textAlign:"center"},a?Object(I.jsx)(r.EuiLoadingSpinner,{size:"m"}):null,void 0!==i?Object(I.jsx)(r.EuiIcon,{type:i?"check":"cross",color:i?"success":"danger","aria-label":i?o.i18n.translate("xpack.ml.newJob.recognize.results.savedAriaLabel",{defaultMessage:"Saved"}):o.i18n.translate("xpack.ml.newJob.recognize.results.saveFailedAriaLabel",{defaultMessage:"Save failed"})}):null))),(1===t.length||c<t.length-1)&&Object(I.jsx)(r.EuiHorizontalRule,{margin:"s"}))))))})),$s=Object(i.memo)((({job:e,jobOverride:t,isSaving:a,jobPrefix:n,onEditRequest:i})=>{const{id:s,config:{description:l,groups:c},datafeedResult:d,setupResult:u}=e,p=t&&t.groups||c;return Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",justifyContent:"spaceBetween",responsive:!1},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"s",color:"success"},n,s)),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiToolTip,{position:"right",content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",defaultMessage:"Override job configuration"})},Object(I.jsx)(r.EuiButtonIcon,{"aria-label":o.i18n.translate("xpack.ml.newJob.recognize.job.overrideJobConfigurationLabel",{defaultMessage:"Override job configuration"}),iconType:"pencil",onClick:()=>i(e)})))),Object(I.jsx)(r.EuiText,{size:"s",color:"subdued"},l),Object(I.jsx)(r.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs"},(null!=p?p:[]).map((e=>Object(I.jsx)(r.EuiFlexItem,{grow:!1,key:e},Object(I.jsx)(r.EuiBadge,{color:Object(it.a)(e)},e))))),u&&u.error&&Object(I.jsx)(r.EuiText,{size:"xs",color:"danger"},Object(Re.b)(u.error)),d&&d.error&&Object(I.jsx)(r.EuiText,{size:"xs",color:"danger"},Object(Re.b)(d.error))),Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{width:er}},a&&Object(I.jsx)(r.EuiLoadingSpinner,{size:"m"}),u&&d&&Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s",wrap:!1,responsive:!1,justifyContent:"spaceAround"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIcon,{type:u.success?"check":"cross",color:u.success?"success":"danger",size:"m","aria-label":u.success?o.i18n.translate("xpack.ml.newJob.recognize.job.savedAriaLabel",{defaultMessage:"Saved"}):o.i18n.translate("xpack.ml.newJob.recognize.job.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIcon,{type:d.success?"check":"cross",color:d.success?"success":"danger",size:"m","aria-label":u.success?o.i18n.translate("xpack.ml.newJob.recognize.datafeed.savedAriaLabel",{defaultMessage:"Saved"}):o.i18n.translate("xpack.ml.newJob.recognize.datafeed.saveFailedAriaLabel",{defaultMessage:"Save failed"})})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIcon,{type:Xs(d).type,color:Xs(d).color,size:"m","aria-label":u.success?o.i18n.translate("xpack.ml.newJob.recognize.running.startedAriaLabel",{defaultMessage:"Started"}):o.i18n.translate("xpack.ml.newJob.recognize.running.startFailedAriaLabel",{defaultMessage:"Start failed"})})))))}));function Xs({awaitingMlNodeAllocation:e,success:t}){return!0===e?{type:"alert",color:"warning"}:t?{type:"check",color:"success"}:{type:"cross",color:"danger"}}function Ks(e){const[t,a]=Object(i.useState)(e);return[t,e=>{a({...t,...e})}]}var Qs=a(19);const Zs=({job:e,jobOverride:t,existingGroupIds:a,onClose:n})=>{var s;const[o,l]=Ks({jobGroups:t&&t.groups||e.config.groups}),[c,d]=Object(i.useState)({}),u=Object(Qs.a)((e=>Object(_e.i)(e)?null:{pattern:!0}),Object(Qs.b)(ji.b));Object(i.useEffect)((()=>{(()=>{var e;const t=(null!==(e=o.jobGroups)&&void 0!==e?e:[]).map((e=>u(e))).filter((e=>null!==e));d({jobGroups:t,formValid:0===t.length})})()}),[o.jobGroups]);return Object(I.jsx)(r.EuiFlyout,{onClose:()=>n(null)},Object(I.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(I.jsx)(r.EuiTitle,{size:"m"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.overrideConfigurationHeader",defaultMessage:"Override configuration for {jobID}",values:{jobID:e.id}})))),Object(I.jsx)(r.EuiFlyoutBody,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiForm,null,Object(I.jsx)(r.EuiFormRow,{fullWidth:!0},Object(I.jsx)(rt,{existingGroups:a,selectedGroups:null!==(s=o.jobGroups)&&void 0!==s?s:[],onChange:e=>{l({jobGroups:e})},validation:{valid:!c.jobGroups||0===c.jobGroups.length,message:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobGroupAllowedCharactersDescription",defaultMessage:"Job group names can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})}}))),Object(I.jsx)(r.EuiSpacer,null)),Object(I.jsx)(r.EuiFlyoutFooter,null,Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:()=>n(null),flush:"left"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.cancelJobOverrideLabel",defaultMessage:"Close"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:()=>(()=>{const t={job_id:e.id,groups:o.jobGroups};n(t)})(),fill:!0,disabled:!c.formValid},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.saveJobOverrideLabel",defaultMessage:"Save"}))))))},er="200px",tr=({jobs:e,jobPrefix:t,jobOverrides:a,saveState:n,existingGroupIds:o,onJobOverridesChange:l})=>{const c=n===ir.SAVING,[d,u]=Object(i.useState)(null),p=e=>a[e.id],m=null!==d?Object(I.jsx)(Zs,{job:d,jobOverride:p(d),onClose:e=>{u(null),null!==e&&l(e)},existingGroupIds:o}):null;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobsTitle",defaultMessage:"Jobs"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),n!==ir.SAVING&&n!==ir.NOT_SAVED&&Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1,gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{style:{width:er},grow:!1},Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround",responsive:!1,gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{grow:1},Object(I.jsx)(r.EuiText,{size:"s",textAlign:"center"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabel",defaultMessage:"Job"}))),Object(I.jsx)(r.EuiFlexItem,{grow:1},Object(I.jsx)(r.EuiText,{size:"s",textAlign:"center"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.datafeedLabel",defaultMessage:"Datafeed"}))),Object(I.jsx)(r.EuiFlexItem,{grow:1},Object(I.jsx)(r.EuiText,{size:"s",textAlign:"center"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.runningLabel",defaultMessage:"Running"})))))),Object(I.jsx)("ul",null,e.map(((a,n)=>Object(I.jsx)("li",{key:a.id},Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)($s,{jobPrefix:t,job:a,jobOverride:p(a),isSaving:c,onEditRequest:()=>u(a)}))),n<e.length-1&&Object(I.jsx)(r.EuiHorizontalRule,{margin:"s"}))))),m)};const ar=({onSubmit:e,onChange:t,saveState:a,jobs:n})=>{const{from:l,to:c}=Ke(),{currentDataView:d}=Object(de.b)(),u=Object(Qs.a)(Object(Qs.e)(/^([a-z0-9]+[a-z0-9\-_]*)?$/),Object(Qs.b)(ji.b-Math.max(...n.map((({id:e})=>e.length))))),[p,m]=Ks({jobPrefix:"",startDatafeedAfterSave:!0,useFullIndexData:!0,timeRange:{start:l,end:c},useDedicatedIndex:!1}),[b,f]=Object(i.useState)({});return Object(i.useEffect)((()=>{(()=>{const e=u(p.jobPrefix);f({jobPrefix:e,formValid:!e})})()}),[p.jobPrefix]),Object(i.useEffect)((()=>{t(p)}),[p]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiForm,null,Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"})),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.tooltips.newJobRecognizerJobPrefixTooltip",defaultMessage:"The prefix is added to the beginning of each job ID."})},Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobIdPrefixLabel",defaultMessage:"Job ID prefix"}),isInvalid:!!b.jobPrefix,error:Object(I.jsx)(s.a.Fragment,null,b.jobPrefix&&b.jobPrefix.maxLength?Object(I.jsx)("div",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobPrefixInvalidMaxLengthErrorMessage",defaultMessage:"Job ID prefix must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:b.jobPrefix.maxLength.requiredLength}})):null,b.jobPrefix&&b.jobPrefix.pattern&&Object(I.jsx)("div",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobLabelAllowedCharactersDescription",defaultMessage:"Job label can contain lowercase alphanumeric (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"})))},Object(I.jsx)(r.EuiFieldText,{name:"jobPrefix",value:p.jobPrefix,onChange:({target:{value:e}})=>(e=>{m({jobPrefix:e&&e.toLowerCase()})})(e),isInvalid:!!b.jobPrefix}))),Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiFormRow,null,Object(I.jsx)(r.EuiSwitch,{id:"startDataFeed",name:"startDataFeed",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.startDatafeedAfterSaveLabel",defaultMessage:"Start datafeed after save"}),checked:p.startDatafeedAfterSave,onChange:({target:{checked:e}})=>{m({startDatafeedAfterSave:e})}})),Object(I.jsx)(r.EuiFormRow,null,Object(I.jsx)(r.EuiSwitch,{id:"useFullData",name:"useFullData",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.useFullDataLabel",defaultMessage:"Use full {indexPatternTitle} data",values:{indexPatternTitle:d.title}}),checked:p.useFullIndexData,onChange:({target:{checked:e}})=>{m({useFullIndexData:e})}})),!p.useFullIndexData&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(ot,{setTimeRange:e=>{m({timeRange:e})},timeRange:p.timeRange})),Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiAccordion,{id:"advancedOptions","aria-label":o.i18n.translate("xpack.ml.newJob.recognize.advancedSettingsAriaLabel",{defaultMessage:"Advanced settings"}),buttonContent:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.advancedLabel",defaultMessage:"Advanced"}),paddingSize:"l"},Object(I.jsx)(r.EuiDescribedFormGroup,{title:Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.useDedicatedIndexLabel",defaultMessage:"Use dedicated index"})),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.tooltips.newJobDedicatedIndexTooltip",defaultMessage:"Store results in a separate index for this job."})},Object(I.jsx)(r.EuiFormRow,{describedByIds:["ml_aria_label_new_job_dedicated_index"]},Object(I.jsx)(r.EuiSwitch,{id:"useDedicatedIndex",name:"useDedicatedIndex",checked:p.useDedicatedIndex,onChange:({target:{checked:e}})=>{m({useDedicatedIndex:e})},label:o.i18n.translate("xpack.ml.newJob.recognize.useDedicatedIndexLabel",{defaultMessage:"Use dedicated index"})})))),Object(I.jsx)(r.EuiSpacer,{size:"l"})),Object(I.jsx)(r.EuiTextAlign,{textAlign:"right"},Object(I.jsx)(r.EuiButton,{fill:!0,type:"submit",isLoading:a===ir.SAVING,disabled:!b.formValid||a===ir.SAVING,onClick:()=>{e(p)},"aria-label":o.i18n.translate("xpack.ml.newJob.recognize.createJobButtonAriaLabel",{defaultMessage:"Create job"})},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.createJobButtonLabel",defaultMessage:"Create {numberOfJobs, plural, zero {job} one {job} other {jobs}}",values:{numberOfJobs:n.length}}))))};var nr=a(141);let ir;!function(e){e[e.NOT_SAVED=0]="NOT_SAVED",e[e.SAVING=1]="SAVING",e[e.SAVED=2]="SAVED",e[e.FAILED=3]="FAILED",e[e.PARTIAL_FAILURE=4]="PARTIAL_FAILURE"}(ir||(ir={}));const sr=({moduleId:e,existingGroupIds:t})=>{const{services:{notifications:a}}=Object(d.b)(),n=Object(d.d)(),[l,c]=Object(i.useState)(""),[u,m]=Object(i.useState)([]),[b,f]=Object(i.useState)({}),[h,g]=Object(i.useState)({}),[j,v]=Object(i.useState)(ir.NOT_SAVED),[y,O]=Object(i.useState)(""),[E,w]=Object(i.useState)(t),[M,S]=Object(i.useState)(0),{currentSavedSearch:_,currentDataView:T,combinedQuery:C}=Object(de.b)(),k=null!==_?o.i18n.translate("xpack.ml.newJob.recognize.savedSearchPageTitle",{defaultMessage:"saved search {savedSearchTitle}",values:{savedSearchTitle:_.attributes.title}}):o.i18n.translate("xpack.ml.newJob.recognize.dataViewPageTitle",{defaultMessage:"data view {dataViewName}",values:{dataViewName:T.title}}),F=null!==_,D=null===_?void 0:C,A=async()=>{try{const t=await be.ml.getDataRecognizerModule({moduleId:e});m(t.jobs);const a=await(async e=>{const t=Object(Ye.i)();try{return await Object.keys(e).reduce((async(a,n)=>{const i=await a,{savedObjects:s}=await t.find({type:n,perPage:1e3});return i[n]=e[n].map((e=>{const t=s.find((t=>t.attributes.title===e.title));return{...e,exists:!!t,id:!!t&&t.id||e.id}})),Promise.resolve(i)}),Promise.resolve({}))}catch(e){console.error("Could not load saved objects",e)}return Promise.resolve(e)})(t.kibana);g(a),v(ir.NOT_SAVED);const n=[...t.jobs.map((e=>e.config.groups||[]))].flat();w([...new Set([...E,...n])])}catch(e){console.error(e)}};Object(i.useEffect)((()=>{A()}),[]);const L=[ir.NOT_SAVED,ir.SAVING].includes(j);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.newJobFromTitle",defaultMessage:"New job from {pageTitle}",values:{pageTitle:k}})),F&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.searchWillBeOverwrittenLabel",defaultMessage:"Search will be overwritten"}),color:"warning",iconType:"alert"},Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.usingSavedSearchDescription",defaultMessage:"Using a saved search will mean the query used in the datafeeds will be different from the default ones we supply in the {moduleId} module.",values:{moduleId:e}}))),Object(I.jsx)(r.EuiSpacer,{size:"l"})),M>0&&Object(I.jsx)($i.a,{jobCount:M}),Object(I.jsx)(r.EuiFlexGroup,{wrap:!0,gutterSize:"m"},Object(I.jsx)(r.EuiFlexItem,{grow:1},Object(I.jsx)(r.EuiPanel,{grow:!1,hasShadow:!1,hasBorder:!0},Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.newJob.recognize.jobSettingsTitle",defaultMessage:"Job settings"}))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),L&&Object(I.jsx)(ar,{onSubmit:async t=>{v(ir.SAVING);const{jobPrefix:i,startDatafeedAfterSave:s,useDedicatedIndex:r,useFullIndexData:l,timeRange:c}=t,d=await(async(e,t)=>{if(e){const e=T.getComputedFields().runtimeFields,{start:t,end:a}=await be.ml.getTimeFieldRange({index:T.title,timeFieldName:T.timeFieldName,query:Xe(C),...Object($e.b)(e)?{runtimeMappings:e}:{}});return{start:t.epoch,end:a.epoch}}return Promise.resolve(t)})(l,c);try{let t=Object.values(b);t=t.length>0?t:null;const a=await be.ml.setupDataRecognizerConfig({moduleId:e,prefix:i,query:D,indexPatternName:T.title,useDedicatedIndex:r,startDatafeed:s,...null!==t?{jobOverrides:t}:{},...d}),{datafeeds:o,jobs:l,kibana:c}=a;if(m(u.map((e=>({...e,datafeedResult:o.find((({id:t})=>t.endsWith(e.id))),setupResult:l.find((({id:t})=>t===i+e.id))})))),g(Object(x.merge)(h,c)),n){const e=await n.getUrl({page:p.b.ANOMALY_EXPLORER,pageState:{jobIds:l.filter((({success:e})=>e)).map((({id:e})=>e)),timeRange:{from:Ve()(d.start).format(nr.a),to:Ve()(d.end).format(nr.a),mode:"absolute"}}});O(e)}const f=l.reduce(((e,{success:t})=>t?e:e+1),0),j=o.reduce(((e,{awaitingMlNodeAllocation:t})=>!0===t?e+1:e),0);S(j),v(0===f?ir.SAVED:f===u.length?ir.FAILED:ir.PARTIAL_FAILURE)}catch(t){v(ir.FAILED),console.error("Error setting up module",t);const{toasts:n}=a;n.addDanger({title:o.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningTitle",{defaultMessage:"Error setting up module {moduleId}",values:{moduleId:e}}),text:o.i18n.translate("xpack.ml.newJob.recognize.moduleSetupFailedWarningDescription",{defaultMessage:"An error occurred trying to create the {count, plural, one {job} other {jobs}} in the module.",values:{count:u.length}})})}},onChange:e=>{c(e.jobPrefix)},saveState:j,jobs:u}),Object(I.jsx)(Hs,{saveState:j,resultsUrl:y,onReset:A}))),Object(I.jsx)(r.EuiFlexItem,{grow:2},Object(I.jsx)(r.EuiPanel,{grow:!1,hasShadow:!1,hasBorder:!0},Object(I.jsx)(tr,{jobs:u,jobPrefix:l,saveState:j,existingGroupIds:E,jobOverrides:b,onJobOverridesChange:e=>{if(f({...b,[e.job_id]:e}),void 0!==e.groups){const t=[...new Set([...E,...e.groups])];w(t)}}})),Object.keys(h).length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiPanel,{grow:!1,hasShadow:!1,hasBorder:!0},Object.keys(h).map(((e,t)=>Object(I.jsx)(i.Fragment,{key:e},Object(I.jsx)(Ys,{objectType:e,kibanaObjects:h[e],isSaving:j===ir.SAVING}),t<Object.keys(h).length-1&&Object(I.jsx)(r.EuiSpacer,{size:"s"})))))))),Object(I.jsx)(r.EuiSpacer,{size:"l"}))};var rr=a(297);const or=(e,t)=>({path:"/jobs/new_job/recognize",render:(e,t)=>Object(I.jsx)(cr,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),F("CREATE_JOB_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.jobsBreadcrumbs.selectIndexOrSearchLabelRecognize",{defaultMessage:"Recognized index"}),href:""}]}),lr=()=>({path:"/modules/check_view_or_create",render:(e,t)=>Object(I.jsx)(dr,h()({},e,{deps:t})),breadcrumbs:[]}),cr=({location:e,deps:t})=>{const{id:a,index:n,savedSearchId:i}=Object(ce.parse)(e.search,{sort:!1}),{context:s,results:r}=S(n,i,t.config,t.dataViewsContract,{...U(t),existingJobsAndGroups:te.a.getJobAndGroupIds});return Object(I.jsx)(g.b,{context:s},Object(I.jsx)(sr,{moduleId:a,existingGroupIds:r.existingJobsAndGroups.groupIds}))},dr=({location:e,deps:t})=>{const{id:a,index:n}=Object(ce.parse)(e.search,{sort:!1}),{createLinkWithUserDefaults:i}=Object(rr.a)(),s=Object(d.e)();return S(void 0,void 0,t.config,t.dataViewsContract,{checkViewOrCreateJobs:()=>function(e,t,a,n){return new Promise(((i,s)=>{be.ml.dataRecognizerModuleJobsExist({moduleId:e}).then((async i=>{if(!0===i.jobsExist){const e=a("explorer",i.jobs);await n(e),s()}else await n(`/jobs/new_job/recognize?id=${e}&index=${t}`),s()})).catch((async t=>{console.error(`Error checking whether jobs in module ${e} exists`,t),Object(Ye.l)().addWarning({title:o.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningTitle",{defaultMessage:"Error checking module {moduleId}",values:{moduleId:e}}),text:o.i18n.translate("xpack.ml.newJob.recognize.moduleCheckJobsExistWarningDescription",{defaultMessage:"An error occurred trying to check whether the jobs in the module have been created."})}),await n("/jobs"),s()}))}))}(a,n,i,s)}),null};var ur=a(111);const pr=()=>{Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{licenseManagement:e,http:{basePath:t},docLinks:a,dataVisualizer:n}}=Object(d.b)(),o=a.links.ml.guide,l=Object(d.e)(),c=void 0!==e&&!0===e.enabled&&!1===Object(u.d)();if(void 0===n)return console.error("File data visualizer plugin not available"),null;const p=n.getMaxBytesFormatted();return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{"data-test-subj":"mlPageDataVisualizerSelector"},Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerTitle",defaultMessage:"Data Visualizer"})),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.dataVisualizerDescription",defaultMessage:"The Machine Learning Data Visualizer tool helps you understand your data, by analyzing the metrics and fields in a log file or an existing Elasticsearch index."})))),Object(I.jsx)(r.EuiSpacer,{size:"xl"}),Object(I.jsx)(r.EuiFlexGrid,{gutterSize:"xl",columns:2,style:{maxWidth:"1000px"}},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{hasBorder:!0,icon:Object(I.jsx)(r.EuiIcon,{size:"xxl",type:"addDataApp"}),title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataTitle",defaultMessage:"Visualize data from a file"}),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.importDataDescription",defaultMessage:"Import data from a log file. You can upload files up to {maxFileSize}.",values:{maxFileSize:p}}),footer:Object(I.jsx)(r.EuiButton,{target:"_self",onClick:()=>l("/filedatavisualizer"),"data-test-subj":"mlDataVisualizerUploadFileButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.uploadFileButtonLabel",defaultMessage:"Select file"})),"data-test-subj":"mlDataVisualizerCardImportData"})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{hasBorder:!0,icon:Object(I.jsx)(r.EuiIcon,{size:"xxl",type:"dataVisualizer"}),title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectDataViewTitle",defaultMessage:"Visualize data from a data view"}),description:"",footer:Object(I.jsx)(r.EuiButton,{target:"_self",onClick:()=>l("/datavisualizer_index_select"),"data-test-subj":"mlDataVisualizerSelectIndexButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.selectDataViewButtonLabel",defaultMessage:"Select data view"})),"data-test-subj":"mlDataVisualizerCardIndexData"}))),!0===c&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"xxl"}),Object(I.jsx)(r.EuiSpacer,{size:"xxl"}),Object(I.jsx)(r.EuiFlexGrid,{gutterSize:"xl",columns:2,style:{maxWidth:"1000px"}},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiCard,{hasBorder:!0,title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialTitle",defaultMessage:"Start trial"}),description:Object(I.jsx)("span",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.fullMLFeaturesDescription",defaultMessage:"To experience the full Machine Learning features that a {subscriptionsLink} offers, start a 30-day trial.",values:{subscriptionsLink:Object(I.jsx)(r.EuiLink,{href:"https://www.elastic.co/subscriptions",target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.startTrial.subscriptionsLinkText",defaultMessage:"Platinum or Enterprise subscription"}))}})),footer:Object(I.jsx)(r.EuiButton,{target:"_blank",href:`${t.get()}/app/management/stack/license_management/home`,"data-test-subj":"mlDataVisualizerStartTrialButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.datavisualizer.selector.startTrialButtonLabel",defaultMessage:"Start trial"})),"data-test-subj":"mlDataVisualizerCardStartTrial"}))))),Object(I.jsx)(ur.a,{docLink:o}))},mr=(e,t)=>({id:"datavisualizer",path:"/datavisualizer",title:o.i18n.translate("xpack.ml.dataVisualizer.docTitle",{defaultMessage:"Data Visualizer"}),render:(e,t)=>Object(I.jsx)(br,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("DATA_VISUALIZER_BREADCRUMB")]}),br=({location:e,deps:t})=>{const{redirectToMlAccessDeniedPage:a}=t,{context:n}=S(void 0,void 0,t.config,t.dataViewsContract,{checkBasicLicense:u.a,checkFindFileStructurePrivilege:()=>Object(m.b)(a)});return Object(I.jsx)(g.b,{context:n},Object(I.jsx)(pr,null))},fr=()=>{Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{docLinks:e,dataVisualizer:t,data:{dataViews:{get:a}}}}=Object(d.b)(),n=Object(d.d)();Object(V.c)();const[r,l]=Object(i.useState)(null);Object(i.useEffect)((()=>{if(void 0!==t){const{getIndexDataVisualizerComponent:e}=t;e().then(l)}}),[]);const c=Object(i.useMemo)((()=>[{id:"create_ml_ad_job",title:o.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.anomalyDetectionTitle",{defaultMessage:"Advanced anomaly detection"}),description:o.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.anomalyDetectionDescription",{defaultMessage:"Create a job with the full range of options for more advanced use cases."}),icon:"createAdvancedJob",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await n.getUrl({page:p.b.ANOMALY_DETECTION_CREATE_JOB_ADVANCED,pageState:{index:e,globalState:t}}),canDisplay:async({indexPatternId:e})=>{try{const{timeFieldName:t}=await a(e);return Object(u.d)()&&void 0!==t&&Object(m.e)("canCreateJob")&&Object(V.e)()}catch(e){return!1}},dataTestSubj:"dataVisualizerCreateAdvancedJobCard"},{id:"create_ml_dfa_job",title:o.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.dataframeTitle",{defaultMessage:"Data frame analytics"}),description:o.i18n.translate("xpack.ml.indexDatavisualizer.actionsPanel.dataframeDescription",{defaultMessage:"Create outlier detection, regression, or classification analytics."}),icon:"classificationJob",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await n.getUrl({page:p.b.DATA_FRAME_ANALYTICS_CREATE_JOB,pageState:{index:e,globalState:t}}),canDisplay:async()=>Object(u.d)()&&Object(m.e)("canCreateDataFrameAnalytics")&&Object(V.e)(),dataTestSubj:"dataVisualizerCreateDataFrameAnalyticsCard"}]),[]);return r?Object(I.jsx)(i.Fragment,null,null!==r?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataVisualizer.pageHeader",defaultMessage:"Data Visualizer"})),Object(I.jsx)(r,{additionalLinks:c})):null,Object(I.jsx)(ur.a,{docLink:e.links.ml.guide})):Object(I.jsx)(i.Fragment,null)},hr=(e,t)=>({id:"data_view_datavisualizer",path:"/jobs/new_job/datavisualizer",title:o.i18n.translate("xpack.ml.dataVisualizer.dataView.docTitle",{defaultMessage:"Index Data Visualizer"}),render:(e,t)=>Object(I.jsx)(gr,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("DATA_VISUALIZER_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataViewLabel",{defaultMessage:"Data View"})}]}),gr=({location:e,deps:t})=>{const{redirectToMlAccessDeniedPage:a}=t,{index:n,savedSearchId:i}=Object(ce.parse)(e.search,{sort:!1}),{context:s}=S(n,i,t.config,t.dataViewsContract,{checkBasicLicense:u.a,cacheDataViewsContract:()=>Object(j.a)(t.dataViewsContract),checkGetJobsCapabilities:()=>Object(m.c)(a)});return Object(I.jsx)(g.b,{context:s},Object(I.jsx)(fr,null))},jr=()=>{Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const{services:{docLinks:e,dataVisualizer:t,data:{dataViews:{get:a}}}}=Object(d.b)(),n=Object(d.d)();Object(V.c)();const[r,l]=Object(i.useState)(null),c=Object(i.useMemo)((()=>[{id:"create_ml_job",title:o.i18n.translate("xpack.ml.fileDatavisualizer.actionsPanel.anomalyDetectionTitle",{defaultMessage:"Create new ML job"}),description:"",icon:"machineLearningApp",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await n.getUrl({page:p.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_TYPE,pageState:{index:e,globalState:t}}),canDisplay:async({indexPatternId:e})=>{try{const{timeFieldName:t}=await a(e);return Object(u.d)()&&void 0!==t&&Object(m.e)("canCreateJob")&&Object(V.e)()}catch(e){return!1}}},{id:"open_in_data_viz",title:o.i18n.translate("xpack.ml.fileDatavisualizer.actionsPanel.dataframeTitle",{defaultMessage:"Open in Data Visualizer"}),description:"",icon:"dataVisualizer",type:"file",getUrl:async({indexPatternId:e,globalState:t})=>await n.getUrl({page:p.b.DATA_VISUALIZER_INDEX_VIEWER,pageState:{index:e,globalState:t}}),canDisplay:async({indexPatternId:e})=>""!==e}]),[]);return Object(i.useEffect)((()=>{if(void 0!==t){Object(V.c)();const{getFileDataVisualizerComponent:e}=t;e().then(l)}}),[]),Object(I.jsx)(i.Fragment,null,null!==r?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataVisualizer.pageHeader",defaultMessage:"Data Visualizer"})),Object(I.jsx)(r,{additionalLinks:c})):null,Object(I.jsx)(ur.a,{docLink:e.links.ml.guide}))},xr=(e,t)=>({id:"filedatavisualizer",path:"/filedatavisualizer",title:o.i18n.translate("xpack.ml.dataVisualizer.file.docTitle",{defaultMessage:"File Data Visualizer"}),render:(e,t)=>Object(I.jsx)(vr,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("DATA_VISUALIZER_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.dataVisualizer.fileBasedLabel",{defaultMessage:"File"})}]}),vr=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=S(void 0,void 0,e.config,e.dataViewsContract,{checkBasicLicense:u.a,cacheDataViewsContract:()=>Object(j.a)(e.dataViewsContract),checkFindFileStructurePrivilege:()=>Object(m.b)(t)});return Object(I.jsx)(g.b,{context:a},Object(I.jsx)(jr,null))},yr=Object(i.createContext)({canGetFilters:!1,canCreateFilter:!1,canGetCalendars:!1,canCreateCalendar:!1}),Or=()=>{const[e,t]=Object(i.useState)(0),[a,n]=Object(i.useState)(0),{canGetFilters:s,canCreateFilter:l,canGetCalendars:c,canCreateCalendar:u}=Object(i.useContext)(yr),{toasts:m}=Object(d.f)(),b=Object(M.a)(p.b.CALENDARS_MANAGE),f=Object(M.a)(p.b.CALENDARS_NEW),h=Object(M.a)(p.b.FILTER_LISTS_MANAGE),g=Object(M.a)(p.b.FILTER_LISTS_NEW);return Object(i.useEffect)((()=>{!async function(){if(!0===c)try{const e=await be.ml.calendars();t(e.length)}catch(e){m.addDanger(o.i18n.translate("xpack.ml.settings.anomalyDetection.loadingCalendarsCountErrorMessage",{defaultMessage:"An error occurred obtaining the count of calendars"}))}if(!0===s)try{const e=await be.ml.filters.filtersStats();n(e.length)}catch(e){m.addDanger(o.i18n.translate("xpack.ml.settings.anomalyDetection.loadingFilterListCountErrorMessage",{defaultMessage:"An error occurred obtaining the count of filter lists"}))}}()}),[]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiPageContentHeader,null,Object(I.jsx)(r.EuiTitle,null,Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.anomalyDetectionTitle",defaultMessage:"Anomaly Detection"})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,{grow:5},Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsTitle",defaultMessage:"Calendars"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsText",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays."})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center"},c&&Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{display:"block"}},Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.calendarsSummaryCount",defaultMessage:"You have {calendarsCountBadge} {calendarsCount, plural, one {calendar} other {calendars}}",values:{calendarsCountBadge:Object(I.jsx)(r.EuiBadge,null,e),calendarsCount:e}}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{"data-test-subj":"mlCalendarsMngButton",flush:"left",color:"primary",onClick:b,isDisabled:!1===c},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.manageCalendarsLink",defaultMessage:"Manage"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{"data-test-subj":"mlCalendarsCreateButton",flush:"left",color:"primary",onClick:f,isDisabled:!1===u},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.createCalendarLink",defaultMessage:"Create"}))))),Object(I.jsx)(r.EuiFlexItem,{grow:5},Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsTitle",defaultMessage:"Filter Lists"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsText",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis."})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center"},s&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.filterListsSummaryCount",defaultMessage:"You have {filterListsCountBadge} {filterListsCount, plural, one {filter list} other {filter lists}}",values:{filterListsCountBadge:Object(I.jsx)(r.EuiBadge,null,a),filterListsCount:a}}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{"data-test-subj":"mlFilterListsMngButton",flush:"left",color:"primary",onClick:h,isDisabled:!1===s},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.manageFilterListsLink",defaultMessage:"Manage"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{"data-test-subj":"mlFilterListsCreateButton",color:"primary",onClick:g,isDisabled:!1===l},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.anomalyDetection.createFilterListsLink",defaultMessage:"Create"})))))))},Er=()=>{const{services:{docLinks:e}}=Object(d.b)(),t=e.links.ml.guide;return Object(I.jsx)(i.Fragment,null,Object(I.jsx)("div",{"data-test-subj":"mlPageSettings"},Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.title",defaultMessage:"Settings"})),Object(I.jsx)(Or,null)),Object(I.jsx)(ur.a,{docLink:t}))},wr=(e,t)=>({id:"settings",path:"/settings",title:o.i18n.translate("xpack.ml.settings.docTitle",{defaultMessage:"Settings"}),render:(e,t)=>Object(I.jsx)(Mr,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),F("SETTINGS_BREADCRUMB")]}),Mr=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=S(void 0,void 0,e.config,e.dataViewsContract,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(m.c)(t),getMlNodeCount:V.c});Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const n=Object(m.e)("canGetFilters"),i=Object(m.e)("canCreateFilter"),s=Object(m.e)("canGetCalendars"),r=Object(m.e)("canCreateCalendar");return Object(I.jsx)(g.b,{context:a},Object(I.jsx)(yr.Provider,{value:{canGetFilters:n,canCreateFilter:i,canGetCalendars:s,canCreateCalendar:r}},Object(I.jsx)(Er,null)))};function Sr(){return Math.random().toString(36).substr(2,9)}function _r({onClick:e,testSubj:t,disabled:a}){return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiButtonEmpty,{size:"xs",color:"danger",onClick:e,isDisabled:a,"data-test-subj":t},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.deleteButtonLabel",defaultMessage:"Delete"})))}const Tr=({canCreateCalendar:e,canDeleteCalendar:t,eventsList:a,onDeleteClick:n,showSearchBar:s,showImportModal:l,showNewEventModal:c,loading:d,saving:u})=>{const p=[{field:"description",name:o.i18n.translate("xpack.ml.calendarsEdit.eventsTable.descriptionColumnName",{defaultMessage:"Description"}),sortable:!0,truncateText:!0,scope:"row"},{field:"start_time",name:o.i18n.translate("xpack.ml.calendarsEdit.eventsTable.startColumnName",{defaultMessage:"Start"}),sortable:!0,render:e=>Ve()(e).format(nr.a)},{field:"end_time",name:o.i18n.translate("xpack.ml.calendarsEdit.eventsTable.endColumnName",{defaultMessage:"End"}),sortable:!0,render:e=>Ve()(e).format(nr.a)},{field:"",name:"",render:e=>Object(I.jsx)(_r,{testSubj:"mlCalendarEventDeleteButton",disabled:!1===t||!0===u||!0===d,onClick:()=>{n(e.event_id)}})}],m={toolsRight:[Object(I.jsx)(r.EuiButton,{isDisabled:!1===e||!0===u||!0===d,key:"ml_new_event","data-test-subj":"mlCalendarNewEventButton",size:"s",iconType:"plusInCircle",onClick:c},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.newEventButtonLabel",defaultMessage:"New event"})),Object(I.jsx)(r.EuiButton,{isDisabled:!1===e||!0===u||!0===d,key:"ml_import_event","data-test-subj":"mlCalendarImportEventsButton",size:"s",iconType:"importAction",onClick:l},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsButtonLabel",defaultMessage:"Import events"}))],box:{incremental:!0},filters:[]};return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiInMemoryTable,{items:a,itemId:"event_id",columns:p,pagination:{initialPageSize:5,pageSizeOptions:[5,10]},sorting:{sort:{field:"description",direction:"asc"}},search:s?m:void 0,"data-test-subj":"mlCalendarEventsTable",rowProps:e=>({"data-test-subj":`mlCalendarEventListRow row-${e.description}`})}))};function Cr({calendarId:e,description:t}){return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)("span",{"data-test-subj":"mlCalendarTitle"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarTitle",defaultMessage:"Calendar {calendarId}",values:{calendarId:e}}))),t?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,{"data-test-subj":"mlCalendarDescriptionText"},Object(I.jsx)("p",null,t)),Object(I.jsx)(r.EuiSpacer,{size:"l"})):null)}Tr.defaultProps={showSearchBar:!1,canCreateCalendar:!0,canDeleteCalendar:!0};const kr=({calendarId:e,canCreateCalendar:t,canDeleteCalendar:a,description:n,eventsList:l,groupIds:c,isEdit:d,isNewCalendarIdValid:u,jobIds:m,onCalendarIdChange:b,onCreate:f,onCreateGroupOption:h,onDescriptionChange:g,onEdit:j,onEventDelete:x,onGroupSelection:v,showImportModal:y,onJobSelection:O,saving:E,loading:w,selectedGroupOptions:S,selectedJobOptions:_,showNewEventModal:T,isGlobalCalendar:C,onGlobalCalendarChange:k})=>{const F=o.i18n.translate("xpack.ml.calendarsEdit.calendarForm.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),D=!0!==u||d?void 0:F,A=!1!==u||d?void 0:[F],L=!1===t||E||!u||""===e||!0===w,R=Object(M.a)(p.b.CALENDARS_MANAGE);return Object(I.jsx)(r.EuiForm,{"data-test-subj":"mlCalendarForm"+(!0===d?"Edit":"New")},!0===d?Object(I.jsx)(Cr,{calendarId:e,description:n}):Object(I.jsx)(i.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.createCalendarTitle",defaultMessage:"Create new calendar"})),Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.calendarIdLabel",defaultMessage:"Calendar ID"}),helpText:D,error:A,isInvalid:!u},Object(I.jsx)(r.EuiFieldText,{name:"calendarId",value:e,onChange:b,disabled:!0===d||!0===E||!0===w,"data-test-subj":"mlCalendarIdInput"})),Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.descriptionLabel",defaultMessage:"Description"})},Object(I.jsx)(r.EuiFieldText,{name:"description",value:n,onChange:g,disabled:!0===d||!0===E||!0===w,"data-test-subj":"mlCalendarDescriptionInput"})),Object(I.jsx)(r.EuiSpacer,{size:"m"})),Object(I.jsx)(r.EuiSwitch,{name:"switch",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.allJobsLabel",defaultMessage:"Apply calendar to all jobs"}),checked:C,onChange:k,disabled:!0===E||!1===t||!0===w,"data-test-subj":"mlCalendarApplyToAllJobsSwitch"}),!1===C&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.jobsLabel",defaultMessage:"Jobs"})},Object(I.jsx)(r.EuiComboBox,{options:m,selectedOptions:_,onChange:O,isDisabled:!0===E||!1===t||!0===w,"data-test-subj":"mlCalendarJobSelection"})),Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.groupsLabel",defaultMessage:"Groups"})},Object(I.jsx)(r.EuiComboBox,{onCreateOption:h,options:c,selectedOptions:S,onChange:v,isDisabled:!0===E||!1===t||!0===w,"data-test-subj":"mlCalendarJobGroupSelection"}))),Object(I.jsx)(r.EuiSpacer,{size:"xl"}),Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.eventsLabel",defaultMessage:"Events"}),fullWidth:!0},Object(I.jsx)(Tr,{canCreateCalendar:t,canDeleteCalendar:a,eventsList:l,onDeleteClick:x,showImportModal:y,showNewEventModal:T,loading:w,saving:E,showSearchBar:!0})),Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{isDisabled:E,onClick:R},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{"data-test-subj":"mlSaveCalendarButton",fill:!0,onClick:d?j:f,isDisabled:L},E?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.savingButtonLabel",defaultMessage:"Saving…"}):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.calendarForm.saveButtonLabel",defaultMessage:"Save"})))))};class new_event_modal_NewEventModal extends i.Component{constructor(e){super(e),Se()(this,"onDescriptionChange",(e=>{this.setState({description:e.target.value})})),Se()(this,"handleAddEvent",(()=>{const{description:e,startDate:t,endDate:a}=this.state,n=Sr(),i={description:e,start_time:t.valueOf(),end_time:a.valueOf(),event_id:n};this.props.addEvent(i)})),Se()(this,"handleChangeStart",(e=>{let t=null,a=this.state.endDate;const n=Ve()(e),i=Ve()(e);t=n.startOf("day"),t>a&&(a=i.startOf("day").add(1,"days")),this.setState({startDate:t,endDate:a,startDateString:t.format(nr.a),endDateString:a.format(nr.a)})})),Se()(this,"handleChangeEnd",(e=>{let t=this.state.startDate,a=null;const n=Ve()(e);a=Ve()(e).startOf("day"),t>a&&(t=n.startOf("day").subtract(1,"days")),this.setState({startDate:t,endDate:a,startDateString:t.format(nr.a),endDateString:a.format(nr.a)})})),Se()(this,"handleTimeStartChange",(e=>{const t=e.target.value;let a=!1;19===t.length?a=Ve()(t).isValid(nr.a,!0):this.setState({startDateString:t}),a&&this.setState({startDateString:t,startDate:Ve()(t)})})),Se()(this,"handleTimeEndChange",(e=>{const t=e.target.value;let a=!1;19===t.length?a=Ve()(t).isValid(nr.a,!0):this.setState({endDateString:t}),a&&this.setState({endDateString:t,endDate:Ve()(t)})})),Se()(this,"renderRangedDatePicker",(()=>{const{startDate:e,endDate:t,startDateString:a,endDateString:n}=this.state,s=Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.fromLabel",defaultMessage:"From:"}),helpText:nr.a},Object(I.jsx)(r.EuiFieldText,{name:"startTime",onChange:this.handleTimeStartChange,placeholder:nr.a,value:a}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.toLabel",defaultMessage:"To:"}),helpText:nr.a},Object(I.jsx)(r.EuiFieldText,{name:"endTime",onChange:this.handleTimeEndChange,placeholder:nr.a,value:n})))));return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"s"}),s,Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFormRow,{fullWidth:!0},Object(I.jsx)(r.EuiDatePickerRange,{fullWidth:!0,iconType:!1,startDateControl:Object(I.jsx)(r.EuiDatePicker,{fullWidth:!0,inline:!0,selected:e,onChange:this.handleChangeStart,startDate:e,endDate:t,isInvalid:e>t,"aria-label":o.i18n.translate("xpack.ml.calendarsEdit.newEventModal.startDateAriaLabel",{defaultMessage:"Start date"}),timeFormat:nr.a,dateFormat:nr.a}),endDateControl:Object(I.jsx)(r.EuiDatePicker,{fullWidth:!0,inline:!0,selected:t,onChange:this.handleChangeEnd,startDate:e,endDate:t,isInvalid:e>t,"aria-label":o.i18n.translate("xpack.ml.calendarsEdit.newEventModal.endDateAriaLabel",{defaultMessage:"End date"}),timeFormat:nr.a,dateFormat:nr.a})})))}));const t=Ve()().startOf("day"),a=Ve()().startOf("day").add(1,"days");this.state={startDate:t,endDate:a,description:"",startDateString:t.format(nr.a),endDateString:a.format(nr.a)}}render(){const{closeModal:e}=this.props,{description:t}=this.state;return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiModal,{onClose:e,initialFocus:"[name=eventDescription]",maxWidth:!1,"data-test-subj":"mlCalendarEventForm"},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiModalHeaderTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.createNewEventTitle",defaultMessage:"Create new event"}))),Object(I.jsx)(r.EuiModalBody,null,Object(I.jsx)(r.EuiForm,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.descriptionLabel",defaultMessage:"Description"}),fullWidth:!0},Object(I.jsx)(r.EuiFieldText,{name:"eventDescription",onChange:this.onDescriptionChange,isInvalid:!t,fullWidth:!0,"data-test-subj":"mlCalendarEventDescriptionInput"})),Object(I.jsx)(r.EuiSpacer,{size:"m"}),this.renderRangedDatePicker())),Object(I.jsx)(r.EuiModalFooter,null,Object(I.jsx)(r.EuiButtonEmpty,{onClick:e,"data-test-subj":"mlCalendarCancelEventButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(I.jsx)(r.EuiButton,{onClick:this.handleAddEvent,fill:!0,disabled:!t,"data-test-subj":"mlCalendarAddEventButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.newEventModal.addButtonLabel",defaultMessage:"Add"})))))}}function Fr({events:e,showRecurringWarning:t,includePastEvents:a,onCheckboxToggle:n,onEventDelete:s}){return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiText,null,Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.eventsToImportTitle",defaultMessage:"Events to import: {eventsCount}",values:{eventsCount:e.length}})),t&&Object(I.jsx)(r.EuiText,{color:"danger"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.recurringEventsNotSupportedDescription",defaultMessage:"Recurring events not supported. Only the first event will be imported."}))))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Tr,{eventsList:e,onDeleteClick:s})),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiCheckbox,{id:"ml-include-past-events",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.importedEvents.includePastEventsLabel",defaultMessage:"Include past events"}),checked:a,onChange:n})))}var Ir=a(308),Dr=a.n(Ir);function Ar(e){const t=Ve()().valueOf();return e.filter((e=>e.start_time>t))}function Lr(e){return function(e){const t=e.events(),a=[];return t.forEach((e=>{if("VEVENT"===e.element){const t=e.properties.SUMMARY,n=e.properties.DTSTART,i=e.properties.DTEND,s=void 0!==e.properties.RRULE;if(t&&n&&i&&t.length&&n.length&&i.length){const e=Sr();a.push({event_id:e,description:t[0].value,start_time:n[0].value.valueOf(),end_time:i[0].value.valueOf(),asterisk:s})}}})),a}(Dr.a.parse_calendar(e+"\n"))}class import_modal_ImportModal extends i.Component{constructor(e){super(e),Se()(this,"handleImport",(async e=>{const t=e[0],a=o.i18n.translate("xpack.ml.calendarsEdit.importModal.couldNotParseICSFileErrorMessage",{defaultMessage:"Could not parse ICS file."});let n=[];if(t&&t.size<=1e8){this.setState({fileLoading:!0,fileLoaded:!0});try{n=Lr((await(i=t,new Promise(((e,t)=>{if(i&&i.size){const a=new FileReader;a.readAsText(i),a.onload=()=>{const n=a.result;""===n?t():e({data:n})}}else t()})))).data),this.setState({allImportedEvents:n,selectedEvents:Ar(n),fileLoading:!1,errorMessage:null,includePastEvents:!1})}catch(e){console.log(a,e),this.setState({errorMessage:a,fileLoading:!1})}}else t&&t.size>1e8?this.setState({fileLoading:!1,errorMessage:a}):this.setState({fileLoading:!1,errorMessage:null});var i})),Se()(this,"onEventDelete",(e=>{this.setState((t=>({allImportedEvents:t.allImportedEvents.filter((t=>t.event_id!==e)),selectedEvents:t.selectedEvents.filter((t=>t.event_id!==e))})))})),Se()(this,"onCheckboxToggle",(e=>{this.setState({includePastEvents:e.target.checked})})),Se()(this,"handleEventsAdd",(()=>{const{allImportedEvents:e,selectedEvents:t,includePastEvents:a}=this.state,n=(a?e:t).map((e=>({description:e.description,start_time:e.start_time,end_time:e.end_time,event_id:e.event_id})));this.props.addImportedEvents(n)})),Se()(this,"renderCallout",(()=>Object(I.jsx)(r.EuiCallOut,{color:"danger"},Object(I.jsx)("p",null,this.state.errorMessage)))),this.state={includePastEvents:!1,allImportedEvents:[],selectedEvents:[],fileLoading:!1,fileLoaded:!1,errorMessage:null}}render(){const{closeImportModal:e}=this.props,{fileLoading:t,fileLoaded:a,allImportedEvents:n,selectedEvents:s,errorMessage:l,includePastEvents:c}=this.state;let d,u=!1;return d=c?n:s,void 0!==d.find((e=>e.asterisk))&&(u=!0),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiModal,{onClose:e,maxWidth:!0},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiModalHeaderTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsTitle",defaultMessage:"Import events"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importEventsDescription",defaultMessage:"Import events from an ICS file."}))))),Object(I.jsx)(r.EuiModalBody,null,Object(I.jsx)(r.EuiFlexGroup,{direction:"column"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFilePicker,{compressed:!0,initialPromptText:o.i18n.translate("xpack.ml.calendarsEdit.importModal.selectOrDragAndDropFilePromptText",{defaultMessage:"Select or drag and drop a file"}),onChange:this.handleImport,disabled:t})),null!==l&&this.renderCallout(),n.length>0&&Object(I.jsx)(Fr,{events:d,showRecurringWarning:u,includePastEvents:c,onCheckboxToggle:this.onCheckboxToggle,onEventDelete:this.onEventDelete}))),Object(I.jsx)(r.EuiModalFooter,null,Object(I.jsx)(r.EuiButtonEmpty,{onClick:e},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.cancelButtonLabel",defaultMessage:"Cancel"})),Object(I.jsx)(r.EuiButton,{onClick:this.handleEventsAdd,fill:!0,disabled:!1===a||null!==l},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsEdit.eventsTable.importButtonLabel",defaultMessage:"Import"})))))}}class new_calendar_NewCalendarUI extends i.Component{constructor(e){super(e),Se()(this,"returnToCalendarsManagementPage",(async()=>{const{services:{http:{basePath:e},application:{navigateToUrl:t}}}=this.props.kibana;await t(`${e.get()}/app/ml/${p.b.CALENDARS_MANAGE}`,!0)})),Se()(this,"isDuplicateId",(()=>{const{calendars:e,formCalendarId:t}=this.state;for(let a=0;a<e.length;a++)if(e[a].calendar_id===t)return!0;return!1})),Se()(this,"onCreate",(async()=>{const{formCalendarId:e}=this.state;if(this.isDuplicateId()){const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.calendarsEdit.canNotCreateCalendarWithExistingIdErrorMessag",{defaultMessage:"Cannot create calendar with id [{formCalendarId}] as it already exists.",values:{formCalendarId:e}}))}else{const e=this.setUpCalendarForApi();this.setState({saving:!0});try{await be.ml.addCalendar(e),await this.returnToCalendarsManagementPage()}catch(t){console.log("Error saving calendar",t),this.setState({saving:!1});const{toasts:a}=this.props.kibana.services.notifications;a.addDanger(o.i18n.translate("xpack.ml.calendarsEdit.errorWithCreatingCalendarErrorMessage",{defaultMessage:"An error occurred creating calendar {calendarId}",values:{calendarId:e.calendarId}}))}}})),Se()(this,"onEdit",(async()=>{const e=this.setUpCalendarForApi();this.setState({saving:!0});try{await be.ml.updateCalendar(e),await this.returnToCalendarsManagementPage()}catch(t){console.log("Error saving calendar",t),this.setState({saving:!1});const{toasts:a}=this.props.kibana.services.notifications;a.addDanger(o.i18n.translate("xpack.ml.calendarsEdit.errorWithUpdatingCalendarErrorMessage",{defaultMessage:"An error occurred saving calendar {calendarId}. Try refreshing the page.",values:{calendarId:e.calendarId}}))}})),Se()(this,"setUpCalendarForApi",(()=>{const{formCalendarId:e,description:t,events:a,selectedGroupOptions:n,selectedJobOptions:i,isGlobalCalendar:s}=this.state,r=s?[li.a]:[...i.map((e=>e.label)),...n.map((e=>e.label))];return{calendarId:e,description:t,events:a.map((e=>({description:e.description,start_time:e.start_time,end_time:e.end_time}))),job_ids:r}})),Se()(this,"onCreateGroupOption",(e=>{const t={label:e};this.setState((e=>({selectedGroupOptions:e.selectedGroupOptions.concat(t)})))})),Se()(this,"onGlobalCalendarChange",(({currentTarget:e})=>{this.setState({isGlobalCalendar:e.checked})})),Se()(this,"onJobSelection",(e=>{this.setState({selectedJobOptions:e})})),Se()(this,"onGroupSelection",(e=>{this.setState({selectedGroupOptions:e})})),Se()(this,"onCalendarIdChange",(e=>{const t=function(e){let t=!0;return(""===e||void 0===e||!1===Object(_e.i)(e))&&(t=!1),t}(e.target.value);this.setState({formCalendarId:e.target.value,isNewCalendarIdValid:t})})),Se()(this,"onDescriptionChange",(e=>{this.setState({description:e.target.value})})),Se()(this,"showImportModal",(()=>{this.setState((e=>({isImportModalVisible:!e.isImportModalVisible})))})),Se()(this,"closeImportModal",(()=>{this.setState({isImportModalVisible:!1})})),Se()(this,"onEventDelete",(e=>{this.setState((t=>({events:t.events.filter((t=>t.event_id!==e))})))})),Se()(this,"closeNewEventModal",(()=>{this.setState({isNewEventModalVisible:!1})})),Se()(this,"showNewEventModal",(()=>{this.setState({isNewEventModalVisible:!0})})),Se()(this,"addEvent",(e=>{this.setState((t=>({events:[...t.events,e],isNewEventModalVisible:!1})))})),Se()(this,"addImportedEvents",(e=>{this.setState((t=>({events:[...t.events,...e],isImportModalVisible:!1})))})),this.state={isNewEventModalVisible:!1,isImportModalVisible:!1,isNewCalendarIdValid:null,loading:!0,jobIds:[],jobIdOptions:[],groupIds:[],groupIdOptions:[],calendars:[],formCalendarId:"",description:"",selectedJobOptions:[],selectedGroupOptions:[],events:[],saving:!1,selectedCalendar:void 0,isGlobalCalendar:!1}}componentDidMount(){this.formSetup()}async formSetup(){try{const{jobIds:e,groupIds:t,calendars:a}=await new Promise((async(e,t)=>{try{const[t,a,n]=await Promise.all([new Promise(((e,t)=>{be.ml.jobs.jobsSummary().then((t=>{e(t.map((e=>e.id)))})).catch((e=>{const a=o.i18n.translate("xpack.ml.calendarsEdit.errorWithFetchingJobSummariesErrorMessage",{defaultMessage:"Error fetching job summaries: {err}",values:{err:e}});console.log(a),t(a)}))})),new Promise(((e,t)=>{be.ml.jobs.groups().then((t=>{e(t.map((e=>e.id)))})).catch((e=>{const a=o.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingGroupsErrorMessage",{defaultMessage:"Error loading groups: {err}",values:{err:e}});console.log(a),t(a)}))})),new Promise(((e,t)=>{be.ml.calendars().then((t=>{e(t)})).catch((e=>{const a=o.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarsErrorMessage",{defaultMessage:"Error loading calendars: {err}",values:{err:e}});console.log(a),t(a)}))}))]);e({jobIds:t,groupIds:a,calendars:n})}catch(e){console.log(e),t(e)}})),n=e.map((e=>({label:e}))),i=t.map((e=>({label:e}))),s=[],r=[];let l,c=[],d="",u=!1;void 0!==this.props.calendarId&&(l=a.find((e=>e.calendar_id===this.props.calendarId)),l&&(d=l.calendar_id,c=l.events,l.job_ids.includes(li.a)?u=!0:l.job_ids.forEach((a=>{e.find((e=>e===a))?s.push({label:a}):t.find((e=>e===a))&&r.push({label:a})})))),this.setState({events:c,formCalendarId:d,jobIds:e,jobIdOptions:n,groupIds:t,groupIdOptions:i,calendars:a,loading:!1,selectedJobOptions:s,selectedGroupOptions:r,selectedCalendar:l,isGlobalCalendar:u})}catch(e){console.log(e),this.setState({loading:!1});const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.calendarsEdit.errorWithLoadingCalendarFromDataErrorMessage",{defaultMessage:"An error occurred loading calendar form data. Try refreshing the page."}))}}render(){const{events:e,isNewEventModalVisible:t,isImportModalVisible:a,isNewCalendarIdValid:n,formCalendarId:s,description:o,groupIdOptions:l,jobIdOptions:c,saving:d,loading:u,selectedCalendar:p,selectedJobOptions:m,selectedGroupOptions:b,isGlobalCalendar:f}=this.state,h=Object(Ye.c)().links.ml.calendars;let g="";return t?g=Object(I.jsx)(new_event_modal_NewEventModal,{addEvent:this.addEvent,closeModal:this.closeNewEventModal}):a&&(g=Object(I.jsx)(import_modal_ImportModal,{addImportedEvents:this.addImportedEvents,closeImportModal:this.closeImportModal})),Object(I.jsx)(i.Fragment,null,Object(I.jsx)("div",{"data-test-subj":"mlPageCalendarEdit"},Object(I.jsx)(r.EuiPageBody,null,Object(I.jsx)(kr,{calendarId:p?p.calendar_id:s,canCreateCalendar:this.props.canCreateCalendar,canDeleteCalendar:this.props.canDeleteCalendar,description:p?p.description:o,eventsList:e,groupIds:l,isEdit:void 0!==p,isNewCalendarIdValid:!(!p&&null!==n)||n,jobIds:c,onCalendarIdChange:this.onCalendarIdChange,onCreate:this.onCreate,onDescriptionChange:this.onDescriptionChange,onEdit:this.onEdit,onEventDelete:this.onEventDelete,onGroupSelection:this.onGroupSelection,showImportModal:this.showImportModal,onJobSelection:this.onJobSelection,saving:d,loading:u,selectedGroupOptions:b,selectedJobOptions:m,onCreateGroupOption:this.onCreateGroupOption,showNewEventModal:this.showNewEventModal,isGlobalCalendar:f,onGlobalCalendarChange:this.onGlobalCalendarChange}),g)),Object(I.jsx)(ur.a,{docLink:h}))}}const Rr=Object(Si.withKibana)(new_calendar_NewCalendarUI);const Nr=Object(Si.withKibana)((function({totalCount:e,refreshCalendars:t,kibana:a}){const n=a.services.docLinks.links.ml.calendars;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsTitle",defaultMessage:"Calendars"})),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsListTotalCount",defaultMessage:"{totalCount} in total",values:{totalCount:e}})))))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:t,"data-test-subj":"mlCalendarListRefreshButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription",defaultMessage:"Calendars contain a list of scheduled events for which you do not want to generate anomalies, such as planned system outages or public holidays. The same calendar can be assigned to multiple jobs.{br}{learnMoreLink}",values:{br:Object(I.jsx)("br",null),learnMoreLink:Object(I.jsx)(r.EuiLink,{href:n,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.calendars.listHeader.calendarsDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}))})),Pr=({calendarsList:e,onDeleteClick:t,setSelectedCalendarList:a,loading:n,canCreateCalendar:i,canDeleteCalendar:s,mlNodesAvailable:c,itemsSelected:d})=>{const u=Object(M.a)(p.b.CALENDARS_NEW),m=[{field:"calendar_id",name:o.i18n.translate("xpack.ml.calendarsList.table.idColumnName",{defaultMessage:"ID"}),sortable:!0,truncateText:!0,scope:"row",render:e=>Object(I.jsx)(l.Link,{to:`/${p.b.CALENDARS_EDIT}/${e}`,"data-test-subj":"mlEditCalendarLink"},e),"data-test-subj":"mlCalendarListColumnId"},{field:"job_ids_string",name:o.i18n.translate("xpack.ml.calendarsList.table.jobsColumnName",{defaultMessage:"Jobs"}),sortable:!0,truncateText:!0,render:e=>e===li.a?Object(I.jsx)("span",{style:{fontStyle:"italic"}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsList.table.allJobsLabel",defaultMessage:"Applies to all jobs"})):e,"data-test-subj":"mlCalendarListColumnJobs"},{field:"events_length",name:o.i18n.translate("xpack.ml.calendarsList.table.eventsColumnName",{defaultMessage:"Events"}),sortable:!0,render:e=>o.i18n.translate("xpack.ml.calendarsList.table.eventsCountLabel",{defaultMessage:"{eventsLength, plural, one {# event} other {# events}}",values:{eventsLength:e}}),"data-test-subj":"mlCalendarListColumnEvents"}],b={onSelectionChange:e=>a(e)},f={toolsRight:[Object(I.jsx)(r.EuiButton,{size:"s","data-test-subj":"mlCalendarButtonCreate",key:"new_calendar_button",onClick:u,isDisabled:!1===i||!1===c},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsList.table.newButtonLabel",defaultMessage:"New"})),Object(I.jsx)(r.EuiButton,{size:"s",color:"danger",iconType:"trash",onClick:t,isDisabled:!1===s||!1===c||!1===d,"data-test-subj":"mlCalendarButtonDelete",key:"delete_calendar_button"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsList.table.deleteButtonLabel",defaultMessage:"Delete"}))],box:{incremental:!0},filters:[]};return Object(I.jsx)("div",{"data-test-subj":"mlCalendarTableContainer"},Object(I.jsx)(r.EuiInMemoryTable,{items:e,itemId:"calendar_id",columns:m,search:f,pagination:{initialPageSize:20,pageSizeOptions:[10,20]},sorting:{sort:{field:"calendar_id",direction:"asc"}},loading:n,selection:b,isSelectable:!0,"data-test-subj":n?"mlCalendarTable loading":"mlCalendarTable loaded",rowProps:e=>({"data-test-subj":`mlCalendarListRow row-${e.calendar_id}`})}))};class calendars_list_CalendarsListUI extends i.Component{constructor(e){super(e),Se()(this,"loadCalendars",(async()=>{this.setState({loading:!0});try{const e=await be.ml.calendars();this.setState({calendars:e,loading:!1,isDestroyModalVisible:!1})}catch(e){console.log(e),this.setState({loading:!1});const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.calendarsList.errorWithLoadingListOfCalendarsErrorMessage",{defaultMessage:"An error occurred loading the list of calendars."}))}})),Se()(this,"closeDestroyModal",(()=>{this.setState({isDestroyModalVisible:!1,calendarId:null})})),Se()(this,"showDestroyModal",(()=>{this.setState({isDestroyModalVisible:!0})})),Se()(this,"setSelectedCalendarList",(e=>{this.setState({selectedForDeletion:e})})),Se()(this,"deleteCalendars",(()=>{const{selectedForDeletion:e}=this.state;this.closeDestroyModal(),async function(e,t){if(void 0===e||0===e.length)return;const a=Object(Ye.l)(),n=e.length>1?o.i18n.translate("xpack.ml.calendarsList.deleteCalendars.calendarsLabel",{defaultMessage:"{calendarsToDeleteCount} calendars",values:{calendarsToDeleteCount:e.length}}):`${e[0].calendar_id}`;a.add(o.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarsNotificationMessage",{defaultMessage:"Deleting {messageId}",values:{messageId:n}}));for(const t of e){const e=t.calendar_id;try{await be.ml.deleteCalendar({calendarId:e})}catch(e){console.log("Error deleting calendar:",e),a.addDanger({title:o.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarErrorMessage",{defaultMessage:"An error occurred deleting calendar {calendarId}",values:{calendarId:t.calendar_id}}),text:Object(Re.b)(e)})}}a.addSuccess(o.i18n.translate("xpack.ml.calendarsList.deleteCalendars.deletingCalendarSuccessNotificationMessage",{defaultMessage:"{messageId} deleted",values:{messageId:n}})),t()}(e,this.loadCalendars)})),Se()(this,"addRequiredFieldsToList",((e=[])=>{for(let t=0;t<e.length;t++)e[t].job_ids_string=e[t].job_ids.join(", "),e[t].events_length=e[t].events.length;return e})),this.state={loading:!0,calendars:[],isDestroyModalVisible:!1,calendarId:null,selectedForDeletion:[],nodesAvailable:Object(V.e)()}}componentDidMount(){this.loadCalendars()}render(){const{calendars:e,selectedForDeletion:t,loading:a,nodesAvailable:n}=this.state,{canCreateCalendar:i,canDeleteCalendar:o}=this.props;let l="";const c=Object(Ye.c)().links.ml.calendars;return this.state.isDestroyModalVisible&&(l=Object(I.jsx)(r.EuiConfirmModal,{"data-test-subj":"mlCalendarDeleteConfirmation",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteMultipleCalendarsTitle",defaultMessage:"Delete {calendarsCount, plural, one {{calendarsList}} other {# calendars}}?",values:{calendarsCount:t.length,calendarsList:t.map((e=>e.calendar_id)).join(", ")}}),onCancel:this.closeDestroyModal,onConfirm:this.deleteCalendars,cancelButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.calendarsList.deleteCalendarsModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:r.EUI_MODAL_CONFIRM_BUTTON})),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{"data-test-subj":"mlPageCalendarManagement"},Object(I.jsx)(Nr,{totalCount:e.length,refreshCalendars:this.loadCalendars}),Object(I.jsx)(Pr,{loading:a,calendarsList:this.addRequiredFieldsToList(e),onDeleteClick:this.showDestroyModal,canCreateCalendar:i,canDeleteCalendar:o,mlNodesAvailable:n,setSelectedCalendarList:this.setSelectedCalendarList,itemsSelected:t.length>0}),l),Object(I.jsx)(ur.a,{docLink:c}))}}const zr=Object(Si.withKibana)(calendars_list_CalendarsListUI),Br=(e,t)=>({path:"/settings/calendars_list",title:o.i18n.translate("xpack.ml.settings.calendarList.docTitle",{defaultMessage:"Calendars"}),render:(e,t)=>Object(I.jsx)(Jr,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),F("SETTINGS_BREADCRUMB",e,t),F("CALENDAR_MANAGEMENT_BREADCRUMB")]}),Jr=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=S(void 0,void 0,e.config,e.dataViewsContract,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(m.c)(t),getMlNodeCount:V.c});Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const n=Object(m.e)("canCreateCalendar"),i=Object(m.e)("canDeleteCalendar");return Object(I.jsx)(g.b,{context:a},Object(I.jsx)(zr,{canCreateCalendar:n,canDeleteCalendar:i}))};var Vr;!function(e){e[e.NEW=0]="NEW",e[e.EDIT=1]="EDIT"}(Vr||(Vr={}));const Ur=(e,t)=>({path:"/settings/calendars_list/new_calendar",title:o.i18n.translate("xpack.ml.settings.createCalendar.docTitle",{defaultMessage:"Create Calendar"}),render:(e,t)=>Object(I.jsx)(qr,h()({},e,{deps:t,mode:Vr.NEW})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),F("SETTINGS_BREADCRUMB",e,t),F("CALENDAR_MANAGEMENT_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.createLabel",{defaultMessage:"Create"})}]}),Gr=(e,t)=>({path:"/settings/calendars_list/edit_calendar/:calendarId",title:o.i18n.translate("xpack.ml.settings.editCalendar.docTitle",{defaultMessage:"Edit Calendar"}),render:(e,t)=>Object(I.jsx)(qr,h()({},e,{deps:t,mode:Vr.EDIT})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("SETTINGS_BREADCRUMB",e,t),F("CALENDAR_MANAGEMENT_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.settings.breadcrumbs.calendarManagement.editLabel",{defaultMessage:"Edit"})}]}),qr=({location:e,mode:t,deps:a})=>{let n;if(t===Vr.EDIT){const t=e.pathname.match(/.+\/(.+)$/);n=t&&t.length>1?t[1]:void 0}const{redirectToMlAccessDeniedPage:i}=a,s=Object(M.a)(p.b.ANOMALY_DETECTION_JOBS_MANAGE),{context:r}=S(void 0,void 0,a.config,a.dataViewsContract,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(m.c)(i),checkMlNodesAvailable:()=>Object(V.a)(s)});Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const o=Object(m.e)("canCreateCalendar"),l=Object(m.e)("canDeleteCalendar");return Object(I.jsx)(g.b,{context:r},Object(I.jsx)(Rr,{calendarId:n,canCreateCalendar:o,canDeleteCalendar:l}))};class edit_description_popover_EditDescriptionPopover extends i.Component{constructor(e){super(e),Se()(this,"onChange",(e=>{this.setState({value:e.target.value})})),Se()(this,"onButtonClick",(()=>{!1===this.state.isPopoverOpen?this.setState({isPopoverOpen:!this.state.isPopoverOpen,value:this.props.description}):this.closePopover()})),Se()(this,"closePopover",(()=>{!0===this.state.isPopoverOpen&&(this.setState({isPopoverOpen:!1}),this.props.updateDescription(this.state.value))})),this.state={isPopoverOpen:!1,value:e.description}}render(){const{isPopoverOpen:e,value:t}=this.state,a=Object(I.jsx)(r.EuiButtonIcon,{size:"s",color:"primary",onClick:this.onButtonClick,iconType:"pencil","aria-label":o.i18n.translate("xpack.ml.settings.filterLists.editDescriptionPopover.editDescriptionAriaLabel",{defaultMessage:"Edit description"}),isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListEditDescriptionButton"});return Object(I.jsx)("div",null,Object(I.jsx)(r.EuiPopover,{id:"filter_list_description_popover",ownFocus:!0,button:a,isOpen:e,closePopover:this.closePopover},Object(I.jsx)("div",{style:{width:"300px"}},Object(I.jsx)(r.EuiForm,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editDescriptionPopover.filterListDescriptionAriaLabel",defaultMessage:"Filter list description"})},Object(I.jsx)(r.EuiFieldText,{name:"filter_list_description",value:t,onChange:this.onChange,"data-test-subj":"mlFilterListDescriptionInput"}))))))}}Se()(edit_description_popover_EditDescriptionPopover,"displayName","EditDescriptionPopover");class filter_list_usage_popover_FilterListUsagePopover extends i.Component{constructor(e){super(e),Se()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),Se()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),this.state={isPopoverOpen:!1}}render(){const{entityType:e,entityValues:t}=this.props,a=`${t.length} ${e}${1!==t.length?"s":""}`,n=t.map((e=>Object(I.jsx)("li",{key:e},e))),i=Object(I.jsx)(r.EuiButtonEmpty,{size:"s",color:"primary",onClick:this.onButtonClick},a);return Object(I.jsx)("div",null,Object(I.jsx)(r.EuiPopover,{id:`${e}_filter_list_usage`,panelClassName:"ml-filter-list-usage-popover",ownFocus:!0,button:i,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},Object(I.jsx)("ul",null,n)))}}const Wr=({canCreateFilter:e,filterId:t,totalItemCount:a,description:n,updateDescription:i,newFilterId:l,isNewFilterIdInvalid:c,updateNewFilterId:d,usedBy:u})=>{const p=void 0!==t?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListTitle",defaultMessage:"Filter list {filterId}",values:{filterId:t}}):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.createFilterListTitle",defaultMessage:"Create new filter list"});let m,b,f;if(void 0===t){const e=o.i18n.translate("xpack.ml.settings.filterLists.editFilterHeader.allowedCharactersDescription",{defaultMessage:"Use lowercase alphanumerics (a-z and 0-9), hyphens or underscores; must start and end with an alphanumeric character"}),t=!1===c?e:void 0,a=!0===c?[e]:void 0;m=Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterHeader.filterListIdAriaLabel",defaultMessage:"Filter list ID"}),helpText:t,error:a,isInvalid:c},Object(I.jsx)(r.EuiFieldText,{name:"new_filter_id",value:l,isInvalid:c,onChange:e=>d(e.target.value),"data-test-subj":"mlNewFilterListIdInput"}))}return b=void 0!==n&&n.length>0?Object(I.jsx)(r.EuiText,{"data-test-subj":"mlNewFilterListDescriptionText"},Object(I.jsx)("p",null,n)):Object(I.jsx)(r.EuiText,null,Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.addDescriptionText",defaultMessage:"Add a description"}))),void 0!==t&&(f=void 0!==u&&u.jobs.length>0?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{className:"ml-filter-list-usage"},Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsUsedInJobsDescription",defaultMessage:"This filter list is used in"})),Object(I.jsx)(filter_list_usage_popover_FilterListUsagePopover,{entityType:"detector",entityValues:u.detectors}),Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.acrossText",defaultMessage:"across"})),Object(I.jsx)(filter_list_usage_popover_FilterListUsagePopover,{entityType:"job",entityValues:u.jobs})),Object(I.jsx)(r.EuiSpacer,{size:"s"})):Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.filterIsNotUsedInJobsDescription",defaultMessage:"This filter list is not used by any jobs."}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}))),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Q.a,null,p),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.totalItemsDescription",defaultMessage:"{totalItemCount, plural, one {# item} other {# items}} in total",values:{totalItemCount:a}}))))))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),m,Object(I.jsx)(r.EuiFlexGroup,{alignItems:"baseline",gutterSize:"s",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},b),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(edit_description_popover_EditDescriptionPopover,{canCreateFilter:e,description:n,updateDescription:i}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),f)};Wr.displayName="EditFilterListHeader";class add_item_popover_AddItemPopover extends i.Component{constructor(e){super(e),Se()(this,"onItemsTextChange",(e=>{this.setState({itemsText:e.target.value})})),Se()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),Se()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),Se()(this,"onAddButtonClick",(()=>{const e=this.state.itemsText.split("\n"),t=[];e.forEach((e=>{-1===t.indexOf(e)&&e.length>0&&t.push(e)})),this.props.addItems(t),this.setState({isPopoverOpen:!1,itemsText:""})})),this.state={isPopoverOpen:!1,itemsText:""}}render(){const e=Object(I.jsx)(r.EuiButton,{size:"s",color:"primary",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick,isDisabled:!1===this.props.canCreateFilter,"data-test-subj":"mlFilterListOpenNewItemsPopoverButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addItemButtonLabel",defaultMessage:"Add item"}));return Object(I.jsx)("div",null,Object(I.jsx)(r.EuiPopover,{id:"add_item_popover",panelClassName:"ml-add-filter-item-popover",ownFocus:!0,button:e,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover},Object(I.jsx)(r.EuiForm,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.itemsLabel",defaultMessage:"Items"})},Object(I.jsx)(r.EuiTextArea,{value:this.state.itemsText,onChange:this.onItemsTextChange,"data-test-subj":"mlFilterListAddItemTextArea"}))),Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.enterItemPerLineDescription",defaultMessage:"Enter one item per line"})),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:this.onAddButtonClick,disabled:0===this.state.itemsText.length,"data-test-subj":"mlFilterListAddItemsButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.addItemPopover.addButtonLabel",defaultMessage:"Add"}))))))}}function Hr({canCreateFilter:e,canDeleteFilter:t,onSearchChange:a,addItems:n,deleteSelectedItems:i,selectedItemCount:o}){const l=function(e,t,a,n,i){return[Object(I.jsx)(add_item_popover_AddItemPopover,{addItems:a,canCreateFilter:e,key:"add_item_btn"}),Object(I.jsx)(r.EuiButton,{color:"danger",size:"s",disabled:0===i||!1===t,onClick:n,key:"delete_item_btn","data-test-subj":"mlFilterListDeleteItemButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.toolbar.deleteItemButtonLabel",defaultMessage:"Delete item"}))]}(e,t,n,i,o);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"xl"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiSearchBar,{toolsRight:l,onChange:a,filters:[]}))))}function Yr(e,t){return e===t?"check":"empty"}Se()(add_item_popover_AddItemPopover,"displayName","AddItemPopover");class items_grid_pagination_ItemsGridPagination extends i.Component{constructor(e){super(e),Se()(this,"onButtonClick",(()=>{this.setState({isPopoverOpen:!this.state.isPopoverOpen})})),Se()(this,"closePopover",(()=>{this.setState({isPopoverOpen:!1})})),Se()(this,"onPageClick",(e=>{this.props.setActivePage(e)})),Se()(this,"onChangeItemsPerPage",(e=>{this.closePopover(),this.props.setItemsPerPage(e)})),this.state={isPopoverOpen:!1}}render(){const{itemCount:e,itemsPerPage:t,itemsPerPageOptions:a,activePage:n}=this.props,i=Object(I.jsx)(r.EuiButtonEmpty,{size:"s",color:"text",iconType:"arrowDown",iconSide:"right",onClick:this.onButtonClick},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsPerPageButtonLabel",defaultMessage:"Items per page: {itemsPerPage}",values:{itemsPerPage:t}})),s=Math.ceil(e/t),o=a.map((e=>Object(I.jsx)(r.EuiContextMenuItem,{key:`${e} items`,icon:Yr(e,t),onClick:()=>{this.onChangeItemsPerPage(e)}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.itemsGrid.itemsCountLabel",defaultMessage:"{pageSize} items",values:{pageSize:e}}))));return Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiPopover,{id:"customizablePagination",button:i,isOpen:this.state.isPopoverOpen,closePopover:this.closePopover,panelPaddingSize:"none"},Object(I.jsx)(r.EuiContextMenuPanel,{items:o,className:"ml-items-grid-page-size-menu"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiPagination,{pageCount:s,activePage:n,onPageClick:this.onPageClick})))}}function $r({numberColumns:e,totalItemCount:t,items:a,selectedItems:n,itemsPerPage:i,itemsPerPageOptions:s,setItemsPerPage:o,setItemSelected:l,activePage:c,setActivePage:d}){if(void 0===a||0===a.length)return Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,null,Object(I.jsx)("h4",null,0===t?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.itemsGrid.noItemsAddedTitle",defaultMessage:"No items have been added"}):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.itemsGrid.noMatchingItemsTitle",defaultMessage:"No matching items"})))));const u=c*i,p=a.slice(u,u+i).map(((e,t)=>Object(I.jsx)(r.EuiFlexItem,{key:`ml_grid_item_${t}`,"data-test-subj":`mlGridItem ${e}`},Object(I.jsx)(r.EuiCheckbox,{id:`ml_grid_item_${t}`,label:e,checked:n.indexOf(e)>=0,onChange:t=>{l(e,t.target.checked)},"data-test-subj":"mlGridItemCheckbox"}))));return Object(I.jsx)("div",null,Object(I.jsx)(r.EuiFlexGrid,{columns:e,className:"eui-textBreakWord",gutterSize:"m"},p),Object(I.jsx)(items_grid_pagination_ItemsGridPagination,{itemCount:a.length,itemsPerPage:i,itemsPerPageOptions:s,setItemsPerPage:o,activePage:c,setActivePage:d}))}function Xr(e,t,a,n){return new Promise(((i,s)=>{void 0===n||void 0===n.filter_id?function(e,t,a){const n=o.i18n.translate("xpack.ml.settings.filterLists.filterWithIdExistsErrorMessage",{defaultMessage:"A filter with id {filterId} already exists",values:{filterId:e}});return new Promise(((i,s)=>{be.ml.filters.filtersStats().then((r=>{if(-1===r.map((e=>e.filter_id)).indexOf(e))be.ml.filters.addFilter(e,t,a).then((e=>{i(e)})).catch((e=>{s(e)}));else{Object(Ye.l)().addDanger(n),s(new Error(n))}})).catch((e=>{s(e)}))}))}(e,t,a).then((e=>{i(e)})).catch((e=>{s(e)})):function(e,t,a){return new Promise(((n,i)=>{const s=e.items,r=a.filter((e=>!1===s.includes(e))),o=s.filter((e=>!1===a.includes(e)));be.ml.filters.updateFilter(e.filter_id,t,r,o).then((e=>{n(e)})).catch((e=>{i(e)}))}))}(n,t,a).then((e=>{i(e)})).catch((e=>{s(e)}))}))}$r.defaultProps={numberColumns:4,itemsPerPage:50,itemsPerPageOptions:[50,100,500,1e3]};function Kr(e,t){if(void 0===t)return[];if(void 0===e)return[...t];const a=t.map((e=>({value:e})));return r.EuiSearchBar.Query.execute(e,a,{defaultFields:["value"]}).map((e=>e.value))}function Qr(e,t,a){let n=e;return t*e>a&&(n=Math.max(Math.ceil(a/t)-1,0)),n}class edit_filter_list_EditFilterListUI extends i.Component{constructor(e){super(e),Se()(this,"returnToFiltersList",(async()=>{const{services:{http:{basePath:e},application:{navigateToUrl:t}}}=this.props.kibana;await t(`${e.get()}/app/ml/${p.b.FILTER_LISTS_MANAGE}`,!0)})),Se()(this,"loadFilterList",(e=>{be.ml.filters.filters({filterId:e}).then((e=>{this.setLoadedFilterState(e)})).catch((t=>{console.log(`Error loading filter ${e}:`,t);const{toasts:a}=this.props.kibana.services.notifications;a.addDanger(o.i18n.translate("xpack.ml.settings.filterLists.editFilterList.loadingDetailsOfFilterErrorMessage",{defaultMessage:"An error occurred loading details of filter {filterId}",values:{filterId:e}}))}))})),Se()(this,"setLoadedFilterState",(e=>{this.setState((t=>{const{itemsPerPage:a,searchQuery:n}=t,i=Kr(n,e.items),s=Qr(t.activePage,a,i.length);return{description:e.description,items:void 0!==e.items?[...e.items]:[],matchingItems:i,selectedItems:[],loadedFilter:e,isNewFilterIdInvalid:!1,activePage:s,searchQuery:n,saveInProgress:!1}}))})),Se()(this,"updateNewFilterId",(e=>{var t;this.setState({newFilterId:e,isNewFilterIdInvalid:(t=e,!(void 0!==t&&t.length>0&&Object(_e.i)(t)))})})),Se()(this,"updateDescription",(e=>{this.setState({description:e})})),Se()(this,"addItems",(e=>{this.setState((t=>{const{itemsPerPage:a,searchQuery:n}=t,i=[...t.items],s=[];if(e.forEach((e=>{-1===i.indexOf(e)?i.push(e):s.push(e)})),i.sort(((e,t)=>e.localeCompare(t))),s.length>0){const{toasts:e}=this.props.kibana.services.notifications;e.addWarning(o.i18n.translate("xpack.ml.settings.filterLists.editFilterList.duplicatedItemsInFilterListWarningMessage",{defaultMessage:"The following items were already in the filter list: {alreadyInFilter}",values:{alreadyInFilter:s}}))}const r=Kr(n,i),l=Qr(t.activePage,a,r.length);return{items:i,matchingItems:r,activePage:l,searchQuery:n}}))})),Se()(this,"deleteSelectedItems",(()=>{this.setState((e=>{const{selectedItems:t,itemsPerPage:a,searchQuery:n}=e,i=[...e.items];t.forEach((e=>{const t=i.indexOf(e);-1!==t&&i.splice(t,1)}));const s=Kr(n,i),r=Qr(e.activePage,a,s.length);return{items:i,matchingItems:s,selectedItems:[],activePage:r,searchQuery:n}}))})),Se()(this,"onSearchChange",(({query:e})=>{this.setState((t=>{const{items:a,itemsPerPage:n}=t,i=Kr(e,a);return{matchingItems:i,activePage:Qr(t.activePage,n,i.length),searchQuery:e}}))})),Se()(this,"setItemSelected",((e,t)=>{this.setState((a=>{const n=[...a.selectedItems],i=n.indexOf(e);return!0===t&&-1===i?n.push(e):!1===t&&-1!==i&&n.splice(i,1),{selectedItems:n}}))})),Se()(this,"setActivePage",(e=>{this.setState({activePage:e})})),Se()(this,"setItemsPerPage",(e=>{this.setState({itemsPerPage:e,activePage:0})})),Se()(this,"save",(()=>{this.setState({saveInProgress:!0});const{loadedFilter:e,newFilterId:t,description:a,items:n}=this.state,i=void 0!==this.props.filterId?this.props.filterId:t;Xr(i,a,n,e).then((e=>{this.setLoadedFilterState(e),this.returnToFiltersList()})).catch((e=>{console.log(`Error saving filter ${i}:`,e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.settings.filterLists.editFilterList.savingFilterErrorMessage",{defaultMessage:"An error occurred saving filter {filterId}",values:{filterId:i}})),this.setState({saveInProgress:!1})}))})),this.state={description:"",items:[],matchingItems:[],selectedItems:[],loadedFilter:{},newFilterId:"",isNewFilterIdInvalid:!0,activePage:0,itemsPerPage:50,saveInProgress:!1}}componentDidMount(){const e=this.props.filterId;void 0!==e?this.loadFilterList(e):this.setState({newFilterId:""})}render(){const{loadedFilter:e,newFilterId:t,isNewFilterIdInvalid:a,description:n,items:i,matchingItems:o,selectedItems:l,itemsPerPage:c,activePage:d,saveInProgress:u}=this.state,{canCreateFilter:p,canDeleteFilter:m}=this.props,b=void 0!==i?i.length:0,f=Object(Ye.c)().links.ml.customRules;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{"data-test-subj":"mlPageFilterListEdit"},Object(I.jsx)(Wr,{canCreateFilter:p,filterId:this.props.filterId,newFilterId:t,isNewFilterIdInvalid:a,updateNewFilterId:this.updateNewFilterId,description:n,updateDescription:this.updateDescription,totalItemCount:b,usedBy:e.used_by}),Object(I.jsx)(Hr,{canCreateFilter:p,canDeleteFilter:m,onSearchChange:this.onSearchChange,addItems:this.addItems,deleteSelectedItems:this.deleteSelectedItems,selectedItemCount:l.length}),Object(I.jsx)(r.EuiSpacer,{size:"xl"}),Object(I.jsx)($r,{totalItemCount:b,items:o,selectedItems:l,itemsPerPage:c,setItemsPerPage:this.setItemsPerPage,setItemSelected:this.setItemSelected,activePage:d,setActivePage:this.setActivePage}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"flexEnd"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{"data-test-subj":"mlFilterListCancelButton",onClick:()=>this.returnToFiltersList()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:this.save,disabled:!0===u||!0===a||!1===p,fill:!0,"data-test-subj":"mlFilterListSaveButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.editFilterList.saveButtonLabel",defaultMessage:"Save"}))))),Object(I.jsx)(ur.a,{docLink:f}))}}Se()(edit_filter_list_EditFilterListUI,"displayName","EditFilterList");const Zr=Object(Si.withKibana)(edit_filter_list_EditFilterListUI);const eo=Object(Si.withKibana)((function({totalCount:e,refreshFilterLists:t,kibana:a}){const n=a.services.docLinks.links.ml.customRules;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsTitle",defaultMessage:"Filter Lists"})),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"baseline"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsDescription",defaultMessage:"{totalCount} in total",values:{totalCount:e}})))))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"baseline",gutterSize:"m",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{size:"s",iconType:"refresh",onClick:()=>t(),"data-test-subj":"mlFilterListRefreshButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.refreshButtonLabel",defaultMessage:"Refresh"})))))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(r.EuiTextColor,{color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription",defaultMessage:"Filter lists contain values that you can use to include or exclude events from the machine learning analysis.\nYou can use the same filter list in multiple jobs.{br}{learnMoreLink}",values:{br:Object(I.jsx)("br",null),learnMoreLink:Object(I.jsx)(r.EuiLink,{href:n,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.listHeader.filterListsContainsNotAllowedValuesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}))}));class delete_filter_list_modal_DeleteFilterListModal extends i.Component{constructor(e){super(e),Se()(this,"closeModal",(()=>{this.setState({isModalVisible:!1})})),Se()(this,"showModal",(()=>{this.setState({isModalVisible:!0})})),Se()(this,"onConfirmDelete",(()=>{this.doDelete()})),this.state={isModalVisible:!1}}async doDelete(){const{selectedFilterLists:e,refreshFilterLists:t}=this.props;await async function(e){if(void 0===e||0===e.length)return;const t=Object(Ye.l)();t.add(o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingNotificationMessage",{defaultMessage:"Deleting {filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}}",values:{filterListsToDeleteLength:e.length,filterListToDeleteId:!!e.length&&e[0].filter_id}}));for(const a of e){const e=a.filter_id;try{await be.ml.filters.deleteFilter(e)}catch(e){console.log("Error deleting filter list:",e),t.addDanger(o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.deletingErrorMessage",{defaultMessage:"An error occurred deleting filter list {filterListId}{respMessage}",values:{filterListId:a.filter_id,respMessage:e.message?` : ${e.message}`:""}}))}}t.addSuccess(o.i18n.translate("xpack.ml.settings.filterLists.deleteFilterLists.filtersSuccessfullyDeletedNotificationMessage",{defaultMessage:"{filterListsToDeleteLength, plural, one {{filterListToDeleteId}} other {# filter lists}} deleted",values:{filterListsToDeleteLength:e.length,filterListToDeleteId:!!e.length&&e[0].filter_id}}))}(e),t(),this.closeModal()}render(){const{selectedFilterLists:e,canDeleteFilter:t}=this.props;let a;if(this.state.isModalVisible){const t=Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.modalTitle",defaultMessage:"Delete {selectedFilterListsLength, plural, one {{selectedFilterId}} other {# filter lists}}?",values:{selectedFilterListsLength:e.length,selectedFilterId:!!e.length&&e[0].filter_id}});a=Object(I.jsx)(r.EuiConfirmModal,{title:t,className:"eui-textBreakWord",onCancel:this.closeModal,onConfirm:this.onConfirmDelete,cancelButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.confirmButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:r.EUI_MODAL_CONFIRM_BUTTON,"data-test-subj":"mlFilterListDeleteConfirmation"})}return Object(I.jsx)("div",null,Object(I.jsx)(r.EuiButton,{key:"delete_filter_list",iconType:"trash",color:"danger",onClick:this.showModal,isDisabled:void 0===e||0===e.length||!1===t,"data-test-subj":"mlFilterListsDeleteButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.deleteFilterListModal.deleteButtonLabel",defaultMessage:"Delete"})),a)}}function to({usedBy:e}){let t;return t=void 0!==e&&e.jobs.length>0?Object(I.jsx)(r.EuiIcon,{type:"check","aria-label":o.i18n.translate("xpack.ml.settings.filterLists.table.inUseAriaLabel",{defaultMessage:"In use"}),"data-test-subj":"mlFilterListUsedByIcon inUse"}):Object(I.jsx)(r.EuiIcon,{type:"cross","aria-label":o.i18n.translate("xpack.ml.settings.filterLists.table.notInUseAriaLabel",{defaultMessage:"Not in use"}),"data-test-subj":"mlFilterListUsedByIcon notInUse"}),t}function ao({canCreateFilter:e}){const t=Object(M.a)(p.b.FILTER_LISTS_NEW);return Object(I.jsx)(r.EuiButton,{key:"new_filter_list",onClick:t,isDisabled:!1===e,"data-test-subj":"mlFilterListsButtonCreate"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.newButtonLabel",defaultMessage:"New"}))}function no(e,t,a,n){return[Object(I.jsx)(ao,{key:"new_filter_list",canCreateFilter:e}),Object(I.jsx)(delete_filter_list_modal_DeleteFilterListModal,{canDeleteFilter:t,selectedFilterLists:a,refreshFilterLists:n})]}function io({canCreateFilter:e,canDeleteFilter:t,filterLists:a,selectedFilterLists:n,setSelectedFilterLists:i,refreshFilterLists:c}){const d={toolsRight:no(e,t,n,c),box:{incremental:!0},filters:[]},u={selectable:e=>void 0===e.used_by||0===e.used_by.jobs.length,selectableMessage:()=>{},onSelectionChange:e=>i(e)};return Object(I.jsx)(s.a.Fragment,null,void 0===a||0===a.length?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{alignItems:"flexEnd",justifyContent:"flexEnd"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(ao,null))),Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,null,Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.settings.filterLists.table.noFiltersCreatedTitle",defaultMessage:"No filters have been created"})))))):Object(I.jsx)("div",{"data-test-subj":"mlFilterListTableContainer"},Object(I.jsx)(r.EuiInMemoryTable,{className:"ml-filter-lists-table",items:a,itemId:"filter_id",columns:[{field:"filter_id",name:o.i18n.translate("xpack.ml.settings.filterLists.table.idColumnName",{defaultMessage:"ID"}),render:e=>Object(I.jsx)(l.Link,{to:`/${p.b.FILTER_LISTS_EDIT}/${e}`,"data-test-subj":"mlEditFilterListLink"},e),sortable:!0,scope:"row","data-test-subj":"mlFilterListColumnId"},{field:"description",name:o.i18n.translate("xpack.ml.settings.filterLists.table.descriptionColumnName",{defaultMessage:"Description"}),sortable:!0,"data-test-subj":"mlFilterListColumnDescription"},{field:"item_count",name:o.i18n.translate("xpack.ml.settings.filterLists.table.itemCountColumnName",{defaultMessage:"Item count"}),sortable:!0,"data-test-subj":"mlFilterListColumnItemCount"},{field:"used_by",name:o.i18n.translate("xpack.ml.settings.filterLists.table.inUseColumnName",{defaultMessage:"In use"}),render:e=>Object(I.jsx)(to,{usedBy:e}),sortable:!0,"data-test-subj":"mlFilterListColumnInUse"}],search:d,pagination:!0,sorting:{sort:{field:"filter_id",direction:"asc"}},selection:u,isSelectable:!0,"data-test-subj":"mlFilterListsTable",rowProps:e=>({"data-test-subj":`mlFilterListRow row-${e.filter_id}`})})))}Se()(delete_filter_list_modal_DeleteFilterListModal,"displayName","DeleteFilterListModal"),to.propTypes={usedBy:gi.a.object},to.displayName="UsedByIcon";class filter_lists_FilterListsUI extends i.Component{constructor(e){super(e),Se()(this,"setFilterLists",(e=>{this.setState((t=>{const a=e.map((e=>e.filter_id)),n=t.selectedFilterLists.filter((e=>-1!==a.indexOf(e.filter_id)));return{filterLists:e,selectedFilterLists:n}}))})),Se()(this,"setSelectedFilterLists",(e=>{this.setState({selectedFilterLists:e})})),Se()(this,"refreshFilterLists",(()=>{be.ml.filters.filtersStats().then((e=>{this.setFilterLists(e)})).catch((e=>{console.log("Error loading list of filters:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.settings.filterLists.filterLists.loadingFilterListsErrorMessage",{defaultMessage:"An error occurred loading the filter lists"}))}))})),this.state={filterLists:[],selectedFilterLists:[]}}componentDidMount(){this.refreshFilterLists()}render(){const{filterLists:e,selectedFilterLists:t}=this.state,{canCreateFilter:a,canDeleteFilter:n}=this.props,i=Object(Ye.c)().links.ml.customRules;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{"data-test-subj":"mlPageFilterListManagement"},Object(I.jsx)(eo,{totalCount:e.length,refreshFilterLists:this.refreshFilterLists}),Object(I.jsx)(io,{canCreateFilter:a,canDeleteFilter:n,filterLists:e,selectedFilterLists:t,setSelectedFilterLists:this.setSelectedFilterLists,refreshFilterLists:this.refreshFilterLists})),Object(I.jsx)(ur.a,{docLink:i}))}}Se()(filter_lists_FilterListsUI,"displayName","FilterLists");const so=Object(Si.withKibana)(filter_lists_FilterListsUI),ro=(e,t)=>({path:"/settings/filter_lists",title:o.i18n.translate("xpack.ml.settings.filterList.docTitle",{defaultMessage:"Filters"}),render:(e,t)=>Object(I.jsx)(oo,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),F("SETTINGS_BREADCRUMB",e,t),F("FILTER_LISTS_BREADCRUMB")]}),oo=({deps:e})=>{const{redirectToMlAccessDeniedPage:t}=e,{context:a}=S(void 0,void 0,e.config,e.dataViewsContract,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(m.c)(t),getMlNodeCount:V.c});Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const n=Object(m.e)("canCreateFilter"),i=Object(m.e)("canDeleteFilter");return Object(I.jsx)(g.b,{context:a},Object(I.jsx)(so,{canCreateFilter:n,canDeleteFilter:i}))};var lo;!function(e){e[e.NEW=0]="NEW",e[e.EDIT=1]="EDIT"}(lo||(lo={}));const co=(e,t)=>({path:"/settings/filter_lists/new_filter_list",title:o.i18n.translate("xpack.ml.settings.createFilter.docTitle",{defaultMessage:"Create Filter"}),render:(e,t)=>Object(I.jsx)(po,h()({},e,{mode:lo.NEW,deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),F("SETTINGS_BREADCRUMB",e,t),F("FILTER_LISTS_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.createLabel",{defaultMessage:"Create"})}]}),uo=(e,t)=>({path:"/settings/filter_lists/edit_filter_list/:filterId",title:o.i18n.translate("xpack.ml.settings.editFilter.docTitle",{defaultMessage:"Edit Filter"}),render:(e,t)=>Object(I.jsx)(po,h()({},e,{mode:lo.EDIT,deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("SETTINGS_BREADCRUMB",e,t),F("FILTER_LISTS_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.settings.breadcrumbs.filterLists.editLabel",{defaultMessage:"Edit"})}]}),po=({location:e,mode:t,deps:a})=>{let n;if(t===lo.EDIT){const t=e.pathname.match(/.+\/(.+)$/);n=t&&t.length>1?t[1]:void 0}const{redirectToMlAccessDeniedPage:i}=a,s=Object(M.a)(p.b.ANOMALY_DETECTION_JOBS_MANAGE),{context:r}=S(void 0,void 0,a.config,a.dataViewsContract,{checkFullLicense:u.b,checkGetJobsCapabilities:()=>Object(m.c)(i),checkMlNodesAvailable:()=>Object(V.a)(s)});Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!1});const o=Object(m.e)("canCreateFilter"),l=Object(m.e)("canDeleteFilter");return Object(I.jsx)(g.b,{context:r},Object(I.jsx)(Zr,{filterId:n,canCreateFilter:o,canDeleteFilter:l}))};var mo=a(272);const bo=(e,t)=>({id:"data_frame_analytics",path:"/data_frame_analytics",title:o.i18n.translate("xpack.ml.dataFrameAnalytics.jobs.docTitle",{defaultMessage:"Data Frame Analytics Jobs"}),render:(e,t)=>Object(I.jsx)(fo,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.jobsManagementLabel",{defaultMessage:"Jobs"})}],"data-test-subj":"mlPageDataFrameAnalytics",enableDatePicker:!0}),fo=({location:e,deps:t})=>{const{context:a}=S(void 0,void 0,t.config,t.dataViewsContract,U(t));return Object(I.jsx)(g.b,{context:a},Object(I.jsx)(mo.a,null))};var ho=a(119),go=a(112);const jo=(e,t,a,n="")=>Object(i.useMemo)((()=>{const i=[];return void 0===e||void 0===t?i:(t.length>1?i.push(...t.filter((t=>e.fields.some((e=>e.name===t&&"number"===e.type))))):i.push(...e.fields.filter((t=>"number"===t.type&&!e.metaFields.includes(t.name)&&!t.name.startsWith(`${n}.`)&&t.name!==go.e)).map((e=>e.name))),Array.isArray(a)&&a.length>0?i.filter((e=>!a.includes(e))):i)}),[e,t,a]);var xo=a(17),vo=a(20),yo=a(123);const Oo=()=>Object(I.jsx)(r.EuiText,{textAlign:"center"},Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiLoadingSpinner,{size:"l"}),Object(I.jsx)(r.EuiSpacer,{size:"l"})),Eo=s.a.lazy((()=>a.e(11).then(a.bind(null,760)))),wo=e=>Object(I.jsx)(r.EuiErrorBoundary,null,Object(I.jsx)(i.Suspense,{fallback:Object(I.jsx)(Oo,null)},Object(I.jsx)(Eo,e)));var Mo=a(224);const So=Object(r.euiPaletteColorBlind)()[0],_o=Object(r.euiPaletteNegative)(2)[1],To=Object(r.euiPaletteColorBlind)({rotations:2}),Co=Object(r.euiPalettePositive)(5);function ko(e){return e.replace(/([\.|\[|\]])/g,"\\$1")}const Fo=(e,t,a,n,i,s,r)=>{const l=e,c=t.map(ko),d=void 0!==n,u=`${n}\\.outlier_score`,p=((e,t,a,n)=>"string"==typeof t?{condition:{value:_o,test:`(datum['${t}'] >= mlOutlierScoreThreshold.cutoff)`},value:e.euiColorMediumShade}:void 0!==a&&void 0!==n?{field:ko(a),type:n,scale:{range:n===Mo.a.NOMINAL?To:Co}}:{value:So})(a,n&&u,i,s);return{$schema:"https://vega.github.io/schema/vega-lite/v4.17.0.json",background:"transparent",view:{fill:"transparent",stroke:a.euiColorLightestShade},padding:10,config:{axis:{domainColor:a.euiColorLightShade,gridColor:a.euiColorLightestShade,tickColor:a.euiColorLightestShade,labelColor:a.euiTextSubduedColor,titleColor:a.euiTextSubduedColor},legend:{orient:"right",labelColor:a.euiTextSubduedColor,titleColor:a.euiTextSubduedColor}},repeat:{column:c,row:c.slice().reverse()},spec:{data:{values:[...l]},mark:{...d&&r?{type:"circle",strokeWidth:1.2,strokeOpacity:.75,fillOpacity:.1}:{type:"circle",opacity:.75,size:8}},encoding:{color:p,...r?{stroke:p,opacity:{condition:{value:1,test:`(datum['${u}'] >= mlOutlierScoreThreshold.cutoff)`},value:.5}}:{},...d?{order:{field:u},size:{...r?{type:Mo.a.QUANTITATIVE,field:u,scale:{type:"linear",range:[8,200],domain:[0,1]}}:{condition:{value:40,test:`(datum['${u}'] >= mlOutlierScoreThreshold.cutoff)`},value:8}}}:{},x:{type:Mo.a.QUANTITATIVE,field:{repeat:"column"},scale:{zero:!1}},y:{type:Mo.a.QUANTITATIVE,field:{repeat:"row"},scale:{zero:!1}},tooltip:[...void 0!==i?[{type:p.type,field:ko(i)}]:[],...c.map((e=>({type:Mo.a.QUANTITATIVE,field:e}))),...d?[{type:Mo.a.QUANTITATIVE,field:u,format:".3f"}]:[]]},...d?{selection:{mlOutlierScoreThreshold:{type:"single",fields:["cutoff"],bind:{input:"range",max:1,min:0,name:o.i18n.translate("xpack.ml.splomSpec.outlierScoreThresholdName",{defaultMessage:"Outlier score threshold: "}),step:.01},init:{cutoff:.99}}}}:{},width:125,height:125}}};a(614);const Io=o.i18n.translate("xpack.ml.splom.toggleOn",{defaultMessage:"On"}),Do=o.i18n.translate("xpack.ml.splom.toggleOff",{defaultMessage:"Off"}),Ao=[100,1e3,1e4].map((e=>({value:e,text:""+e}))),Lo=({label:e,tooltip:t})=>Object(I.jsx)(s.a.Fragment,null,e,Object(I.jsx)(r.EuiIconTip,{content:t,iconProps:{className:"eui-alignTop"},size:"s"})),Ro=({fields:e,index:t,resultsField:a,color:n,legendType:l,searchQuery:c,runtimeMappings:u,indexPattern:p})=>{const{esSearch:m}=Object(d.a)(),[b,f]=Object(i.useState)(!1),[h,g]=Object(i.useState)([]);Object(i.useEffect)((()=>{const t=e.length>4?e.slice(0,4):e;g(t)}),[e]);const[j,x]=Object(i.useState)(1e3),[v,y]=Object(i.useState)(!1),[O,E]=Object(i.useState)(!1),[w,M]=Object(i.useState)(),S=Object(i.useMemo)((()=>e.map((e=>({label:e})))),[e]),{euiTheme:_}=Object(ho.e)();Object(i.useEffect)((()=>{if(0===h.length)return M({columns:[],items:[],messages:[]}),void E(!1);const e={didCancel:!1};return async function(e){E(!0);const i=[];try{const s=`${a}.outlier_score`,r=void 0!==a,l=[...h,...void 0!==n?[n]:[],...r?[s]:[]],d=v?{function_score:{query:c,random_score:{seed:10,field:"_seq_no"}}}:c,b=p&&Object(yo.b)(p,u),f=await m({index:t,body:{fields:l,_source:!1,query:d,from:0,size:j,...Object(vo.b)(b)?{runtime_mappings:b}:{}}});if(!e.didCancel){const e=f.hits.hits.map((e=>{var t;return Object(yo.i)(null!==(t=e.fields)&&void 0!==t?t:{},(e=>e.startsWith(`${a}.feature_importance`)))})).filter((e=>!Object.keys(e).some((t=>Array.isArray(e[t]))))),t=f.hits.hits.length,n=t-e.length;t===n?i.push(o.i18n.translate("xpack.ml.splom.allDocsFilteredWarningMessage",{defaultMessage:"All fetched documents included fields with arrays of values and cannot be visualized."})):f.hits.hits.length!==e.length&&i.push(o.i18n.translate("xpack.ml.splom.arrayFieldsWarningMessage",{defaultMessage:"{filteredDocsCount} out of {originalDocsCount} fetched documents include fields with arrays of values and cannot be visualized.",values:{originalDocsCount:t,filteredDocsCount:n}})),M({columns:h,items:e,messages:i}),E(!1)}}catch(e){E(!1),M({columns:[],items:[],messages:[Object(xo.extractErrorMessage)(e)]})}}(e),()=>{e.didCancel=!0}}),[j,JSON.stringify({fields:h,searchQuery:c}),t,v,a]);const T=Object(i.useMemo)((()=>{if(void 0===w)return;const{items:e,columns:t}=w;return Fo(e,t,_,a,n,l,b)}),[a,w,n,l,b]);return Object(I.jsx)(s.a.Fragment,null,void 0===w||void 0===T?Object(I.jsx)(Oo,null):Object(I.jsx)("div",{"data-test-subj":"mlScatterplotMatrix "+(O?"loading":"loaded")},Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(Lo,{label:o.i18n.translate("xpack.ml.splom.fieldSelectionLabel",{defaultMessage:"Fields"}),tooltip:o.i18n.translate("xpack.ml.splom.fieldSelectionInfoTooltip",{defaultMessage:"Pick fields to explore their relationships."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(r.EuiComboBox,{compressed:!0,fullWidth:!0,placeholder:o.i18n.translate("xpack.ml.splom.fieldSelectionPlaceholder",{defaultMessage:"Select fields"}),options:S,selectedOptions:h.map((e=>({label:e}))),onChange:e=>{g(e.map((e=>e.label)))},isClearable:!0,"data-test-subj":"mlScatterplotMatrixFieldsComboBox"}))),Object(I.jsx)(r.EuiFlexItem,{style:{width:"200px"},grow:!1},Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(Lo,{label:o.i18n.translate("xpack.ml.splom.sampleSizeLabel",{defaultMessage:"Sample size"}),tooltip:o.i18n.translate("xpack.ml.splom.sampleSizeInfoTooltip",{defaultMessage:"Amount of documents to display in the scatterplot matrix."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(r.EuiSelect,{"data-test-subj":"mlScatterplotMatrixSampleSizeSelect",compressed:!0,options:Ao,value:j,onChange:e=>{x(Math.min(Math.max(parseInt(e.target.value,10),1),1e4))}}))),Object(I.jsx)(r.EuiFlexItem,{style:{width:"120px"},grow:!1},Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(Lo,{label:o.i18n.translate("xpack.ml.splom.randomScoringLabel",{defaultMessage:"Random scoring"}),tooltip:o.i18n.translate("xpack.ml.splom.randomScoringInfoTooltip",{defaultMessage:"Uses a function score query to get randomly selected documents as the sample."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(r.EuiSwitch,{"data-test-subj":"mlScatterplotMatrixRandomizeQuerySwitch",name:"mlScatterplotMatrixRandomizeQuery",label:v?Io:Do,checked:v,onChange:()=>{y(!v)},disabled:O}))),void 0!==a&&void 0===l&&Object(I.jsx)(r.EuiFlexItem,{style:{width:"120px"},grow:!1},Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(Lo,{label:o.i18n.translate("xpack.ml.splom.dynamicSizeLabel",{defaultMessage:"Dynamic size"}),tooltip:o.i18n.translate("xpack.ml.splom.dynamicSizeInfoTooltip",{defaultMessage:"Scales the size of each point by its outlier score."})}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(r.EuiSwitch,{name:"mlScatterplotMatrixDynamicSize",label:b?Io:Do,checked:b,onChange:()=>{f(!b)},disabled:O})))),w.messages.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiCallOut,{color:"warning"},w.messages.map((e=>Object(I.jsx)("span",{key:Object(xi.d)(e)},e,Object(I.jsx)("br",null)))))),w.items.length>0&&Object(I.jsx)(wo,{vegaSpec:T})))};var No=a(81),Po=a(152);a(354);function zo(e){return{queryText:"",queryLanguage:O.c.KUERY,pageIndex:0,pageSize:25,analysis:!1,evaluation:!0,feature_importance:!0,results:!0,splom:!0,...Object($e.b)(e)?e:{}}}function Bo(e){return Object(c.b)(p.b.DATA_FRAME_ANALYTICS_EXPLORATION,zo(e))}const Jo="header_items_loading",Vo=({headerItems:e,content:t,isExpanded:a,contentPadding:n=!1,dataTestId:o,title:l,docsLink:c,urlStateKey:d})=>{const u=Object(i.useMemo)((()=>void 0!==a?{[d]:a}:void 0),[d,a]),[p,m]=Bo(u),b=void 0!==a&&p[d]===zo(u)[d]?a:p[d],f=Object(i.useCallback)((()=>{m({[d]:!b})}),[b,m,d]);return Object(I.jsx)(r.EuiPanel,{paddingSize:"none","data-test-subj":`mlDFExpandableSection-${o}`,hasShadow:!1,hasBorder:!0},Object(I.jsx)("div",{className:"mlExpandableSection"},Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"none"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{onClick:f,iconType:b?"arrowUp":"arrowDown",iconSide:"right",flush:"left","data-test-subj":`mlDFExpandableSection-${o}-toggle-button`},l)),void 0!==c&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},c)),e===Jo&&Object(I.jsx)(r.EuiLoadingContent,{lines:1}),(h=e,Array.isArray(h)&&Object(I.jsx)(r.EuiFlexGroup,null,e.map((({label:e,value:t,id:a})=>Object(I.jsx)(r.EuiFlexItem,{grow:!1,key:a,"data-test-subj":`mlDFExpandableSectionItem-${o}-${a}`},void 0!==e&&void 0!==t&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(I.jsx)("p",null,e)))),Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiBadge,null,t)))),void 0===e&&Object(I.jsx)(r.EuiText,{size:"xs",color:"subdued"},t))))))),b&&Object(I.jsx)("div",{className:n?"mlExpandableSection-contentPadding":"","data-test-subj":`mlDFExpandableSection-${o}-content`},t));var h};var Uo=a(166),Go=a(103),qo=a(391);const Wo=({jobId:e})=>{const[t,a]=Object(i.useState)();Object(i.useEffect)((()=>{(async()=>{const t=await be.ml.dataFrameAnalytics.getDataFrameAnalytics(e),n=await be.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(e),i=t.data_frame_analytics[0],s=Object(Uo.b)(n)?n.data_frame_analytics[0]:void 0;if(void 0===s)return;const r={checkpointing:{},config:i,id:i.id,job_type:Object(No.h)(i.analysis),mode:Go.a.BATCH,state:s.state,stats:s};a(r)})()}),[e]);const n=(e=>{if(void 0===e)return Jo;const t=Array.isArray(e.config.source.index)?e.config.source.index.join():e.config.source.index;return[{id:"analysisTypeLabel",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisTypeLabel",defaultMessage:"Type"}),value:e.job_type},{id:"analysisSourceIndexLabel",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisSourceIndexLabel",defaultMessage:"Source index"}),value:t},{id:"analysisDestinationIndexLabel",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisDestinationIndexLabel",defaultMessage:"Destination index"}),value:e.config.dest.index}]})(t),o=Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{size:"full",margin:"none"}),void 0===t&&Object(I.jsx)(r.EuiText,{textAlign:"center"},Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiLoadingSpinner,{size:"l"}),Object(I.jsx)(r.EuiSpacer,{size:"l"})),void 0!==t&&Object(I.jsx)(qo.a,{item:t}));return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Vo,{dataTestId:"analysis",content:o,headerItems:n,urlStateKey:"analysis",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.analysisSectionTitle",defaultMessage:"Analysis"})}),Object(I.jsx)(r.EuiSpacer,{size:"m"}))};var Ho=a(106),Yo=a(13);const $o=({destIndex:e})=>{const{services:{http:{basePath:t},application:{capabilities:a}}}=Object(d.b)(),n=Object(i.useMemo)((()=>!0===a.savedObjectsManagement.edit||!0===a.indexPatterns.save),[a]);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,{size:"xs",color:"warning"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.dataViewPromptMessage",defaultMessage:"No data view exists for index {destIndex}. ",values:{destIndex:e}}),!0===n?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.dataViewPromptLink",defaultMessage:"{linkToDataViewManagement} for {destIndex}.",values:{destIndex:e,linkToDataViewManagement:Object(I.jsx)(r.EuiLink,{href:`${t.get()}/app/management/kibana/dataViews/create`,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.dataViewPromptLinkText",defaultMessage:"Create a data view"}))}}):null))},Xo=o.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.documentsShownHelpText",{defaultMessage:"Showing documents for which predictions exist"}),Ko=o.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.firstDocumentsShownHelpText",{defaultMessage:"Showing first {searchSize} documents for which predictions exist",values:{searchSize:No.f}}),Qo=({colorRange:e,indexData:t,indexPattern:a,jobConfig:n,needsDestIndexPattern:i,searchQuery:l})=>{const{columnsWithCharts:c,status:d,tableItems:u}=t,p=((e,t,a,n,i,s)=>e.length>0&&(a.length>0||t===No.b.LOADED)?[{id:"explorationTableTotalDocs",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.explorationTableTotalDocsLabel",defaultMessage:"Total docs"}),value:`${i===Yo.a.GTE?">":""}${n}`},...void 0!==s?[{id:"colorRangeLegend",value:Object(I.jsx)(ho.c,{colorRange:s,title:o.i18n.translate("xpack.ml.dataframe.analytics.exploration.colorRangeLegendTitle",{defaultMessage:"Feature influence score"})})}]:[]]:Jo)(c,d,u,t.rowCount,t.rowCountRelation,e),m=n&&n.analysis?Object(No.h)(n.analysis):void 0,b=Object(I.jsx)(s.a.Fragment,null,void 0!==n&&i&&Object(I.jsx)("div",{className:"mlExpandableSection-contentPadding"},Object(I.jsx)($o,{destIndex:n.dest.index})),void 0!==n&&(Object(Ho.h)(n.analysis)||Object(Ho.f)(n.analysis))&&Object(I.jsx)(r.EuiText,{size:"xs",color:"subdued",className:"mlExpandableSection-contentPadding"},u.length===No.f?Ko:Xo),(c.length>0||l!==No.g)&&void 0!==a&&Object(I.jsx)(s.a.Fragment,null,c.length>0&&(u.length>0||d===No.b.LOADED)&&Object(I.jsx)(yo.a,h()({},t,{analysisType:m,dataTestSubj:"mlExplorationDataGrid",toastNotifications:Object(Ye.l)()}))));return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Vo,{urlStateKey:"results",dataTestId:"results",content:b,headerItems:p,title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.explorationTableTitle",defaultMessage:"Results"})}),Object(I.jsx)(r.EuiSpacer,{size:"m"}))},Zo=e=>{const t=Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiHorizontalRule,{size:"full",margin:"none"}),Object(I.jsx)("div",{className:"mlExpandableSection-contentPadding"},Object(I.jsx)(Ro,e)));return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Vo,{dataTestId:"splom",urlStateKey:"splom",content:t,headerItems:undefined,isExpanded:!0,title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.splomSectionTitle",defaultMessage:"Scatterplot matrix"})}),Object(I.jsx)(r.EuiSpacer,{size:"m"}))};var el=a(107);const tl=({indexPattern:e,setSearchQuery:t,filters:a,query:n})=>{const[s,l]=Object(i.useState)(n),[c,d]=Object(i.useState)({}),[u,p]=Object(i.useState)(void 0),m=Object(i.useMemo)((()=>new RegExp(`${null==a?void 0:a.columnId}\\s*:\\s*(true|false)`,"g")),[null==a?void 0:a.columnId]);Object(i.useEffect)((function(){if(void 0!==a){const e=n.query.match(m);let t;null!==e&&e[0].includes("true")?t=Object.keys(a.key).find((e=>!0===a.key[e])):null!==e&&e[0].includes("false")&&(t=Object.keys(a.key).find((e=>!1===a.key[e]))),t&&d({[t]:!0})}}),[]),Object(i.useEffect)((()=>{try{let a={};switch(n.language){case O.c.KUERY:a=Object(v.f)(Object(v.d)(n.query),e);break;case O.c.LUCENE:a=Object(v.e)(n.query);break;default:return void p({query:n.query,message:o.i18n.translate("xpack.ml.queryBar.queryLanguageNotSupported",{defaultMessage:"Query language is not supported"})})}t({queryString:n.query,query:a,language:n.language})}catch(e){p({query:n.query,message:e.message})}}),[n.query]);const b=(e,a)=>{void 0===a&&d({}),t({queryString:e.query,language:e.language})},f=Object(x.debounce)(((e,t)=>{let n="";const i=null==a?void 0:a.key[e],r=`${null==a?void 0:a.columnId}:${i}`;!1===t[e]?n=""!==s.query?Object(el.s)(s.query,null==a?void 0:a.columnId,String(i)):"":!0===t[e]&&(n=""===s.query?r:null!==s.query.match(m)?s.query.replace(m,r):`${s.query} and ${r}`);const o={...s,query:n};l(o),b(o,!0)}),200);return Object(I.jsx)(r.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>p(void 0),input:Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(y.QueryStringInput,{bubbleSubmitEvent:!1,query:s,indexPatterns:[e],onChange:e=>l(e),onSubmit:b,placeholder:s.language===O.c.KUERY?o.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderKql",{defaultMessage:"Search for e.g. {example}",values:{example:'method : "GET" or status : "404"'}}):o.i18n.translate("xpack.ml.stepDefineForm.queryPlaceholderLucene",{defaultMessage:"Search for e.g. {example}",values:{example:"method:GET OR status:404"}}),disableAutoFocus:!0,dataTestSubj:"mlDFAnalyticsQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"})),a&&a.options&&Object(I.jsx)(r.EuiFlexItem,{grow:!1,"data-test-subj":"mlDFAnalyticsExplorationQueryBarFilterButtons"},Object(I.jsx)(r.EuiButtonGroup,{legend:o.i18n.translate("xpack.ml.dataframe.analytics.explorationQueryBar.buttonGroupLegend",{defaultMessage:"Analytics query bar filter buttons"}),options:a.options,type:"multi",idToSelectedMap:c,onChange:e=>{const t={[e]:!c[e]};d(t),f(e,t)}}))),isOpen:(null==u?void 0:u.query)===s.query&&""!==(null==u?void 0:u.message)},Object(I.jsx)(r.EuiCode,null,o.i18n.translate("xpack.ml.stepDefineForm.invalidQuery",{defaultMessage:"Invalid Query"}),": ",null==u?void 0:u.message.split("\n")[0]))},al=e=>`${e.dest.results_field}.${Po.c}`,nl=(e,t=[])=>{if(0===t.length)return 0;const a=t[0];return Array.isArray(a[`${e}.${Po.b}`])?a[`${e}.${Po.b}`].length:0};var il=a(225);class data_loader_DataLoader{constructor(e,t){Se()(this,"_indexPattern",void 0),Se()(this,"_runtimeMappings",void 0),Se()(this,"_indexPatternTitle",""),Se()(this,"_maxExamples",10),this._indexPattern=e,this._runtimeMappings=this._indexPattern.getComputedFields().runtimeFields,this._indexPatternTitle=e.title}async loadFieldHistograms(e,t,a=il.a,n){return await be.ml.getVisualizerFieldHistograms({indexPattern:this._indexPatternTitle,query:t,fields:e,samplerShardSize:a,runtimeMappings:n||this._runtimeMappings})}set maxExamples(e){this._maxExamples=e}get maxExamples(){return this._maxExamples}isDisplayField(e){return!It.c.includes(e)}}var sl=a(90),rl=a(623),ol=a.n(rl),ll=a(97);const cl=(e,t=ll.b,a)=>{const[n,s]=Bo(),r=Object(yo.l)(e,25,t,a);return r.pagination=Object(i.useMemo)((()=>({pageSize:n.pageSize,pageIndex:n.pageIndex})),[n.pageSize,n.pageIndex]),r.setPagination=Object(i.useCallback)((e=>{s({...e})}),[s]),r.onChangePage=Object(i.useCallback)((e=>{s({pageIndex:e})}),[s]),r.onChangeItemsPerPage=Object(i.useCallback)((e=>{s({pageSize:e})}),[s]),r.resetPagination=Object(i.useCallback)((()=>{const e=zo();s({pageSize:e.pageSize,pageIndex:e.pageIndex})}),[s]),ol()((function(){r.resetPagination()}),[n.queryText]),r},dl=(e,t,a)=>{var n;const s=void 0!==e&&e.title===(null==t?void 0:t.source.index[0]),r=Object(i.useMemo)((()=>{const a=[];if(void 0!==t&&void 0!==e){const e=t.dest.results_field,{fieldTypes:n}=Object(No.m)(t,s);a.push(...Object(yo.e)(n,e).sort(((e,a)=>Object(go.h)(e.id,a.id,t))))}return a}),[t,e]),o=cl(r,8,(e=>!e.includes(`.${Po.b}.`)&&e!==go.d&&e!==go.e));Object(i.useEffect)((()=>{void 0!==t&&o.setSortingColumns([{id:al(t),direction:"desc"}])}),[t&&t.id]),Object(i.useEffect)((()=>{const e={didCancel:!1};return Object(No.l)(t,o,a,e),()=>{e.didCancel=!0}}),[t&&t.id,o.pagination,a,o.sortingColumns]);const l=Object(i.useMemo)((()=>void 0!==e?new data_loader_DataLoader(e,Object(Ye.l)()):void 0),[e]);Object(i.useEffect)((()=>{o.chartsVisible&&async function(){try{if(void 0!==t&&void 0!==l){const e=await l.loadFieldHistograms(r.filter((e=>o.visibleColumns.includes(e.id))).map((e=>({fieldName:e.id,type:Object(yo.f)(e.schema)}))),a);o.setColumnCharts(e)}}catch(e){Object(yo.k)(e,Object(Ye.l)())}}()}),[o.chartsVisible,null==t?void 0:t.dest.index,JSON.stringify([a,[...o.visibleColumns].sort()])]);const c=Object(ho.d)(ho.a.BLUE,ho.b.INFLUENCER,void 0!==t?nl(t.dest.results_field,o.tableItems):1),d=Object(yo.m)(e,o.pagination,o.tableItems,null!==(n=null==t?void 0:t.dest.results_field)&&void 0!==n?n:sl.d,((e,a,n,i)=>{var s;let r;const o=n[`${null!==(s=null==t?void 0:t.dest.results_field)&&void 0!==s?s:""}.${Po.b}`];if(Array.isArray(o)){const t=o.find((t=>e===t.feature_name[0]));t&&(r=c(t.influence[0]))}void 0!==r&&i({style:{backgroundColor:String(r)}})}));return{...o,renderCellValue:d}},ul=s.a.memo((({jobId:e})=>{var t,a,n,l;const{indexPattern:c,indexPatternErrorMessage:d,jobConfig:u,needsDestIndexPattern:p}=Object(No.x)(e),[m,b]=Bo(),[f,h]=Object(i.useState)(No.g),g=dl(c,u,f),j=Object(i.useCallback)((e=>{e.query&&h(e.query),e.queryString!==m.queryText&&b({queryText:e.queryString,queryLanguage:e.language})}),[m,b]),x={query:m.queryText,language:m.queryLanguage},{columnsWithCharts:v,tableItems:y}=g,O=nl((null==u||null===(t=u.dest)||void 0===t?void 0:t.results_field)||"",y),E=Object(ho.d)(ho.a.BLUE,ho.b.INFLUENCER,O),w=O>0&&Object(No.r)(null==u?void 0:u.analysis)&&!0===(null==u?void 0:u.analysis.outlier_detection.compute_feature_influence),M=null!==(a=null==u?void 0:u.dest.results_field)&&void 0!==a?a:"",S=!p&&Object(No.r)(null==u?void 0:u.analysis)&&!0===(null==u?void 0:u.analysis.outlier_detection.compute_feature_influence)&&-1===v.findIndex((e=>e.id===`${M}.${Po.b}`)),_=jo(c,null==u||null===(n=u.analyzed_fields)||void 0===n?void 0:n.includes,null==u||null===(l=u.analyzed_fields)||void 0===l?void 0:l.excludes,M);return void 0!==d?Object(I.jsx)(r.EuiPanel,{grow:!1,hasShadow:!1,hasBorder:!0},Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.dataframe.analytics.exploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},Object(I.jsx)("p",null,d))):Object(I.jsx)(s.a.Fragment,null,void 0!==(null==u?void 0:u.description)&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,null,null==u?void 0:u.description),Object(I.jsx)(r.EuiSpacer,{size:"m"})),(v.length>0||f!==No.g)&&void 0!==c&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(tl,{indexPattern:c,setSearchQuery:j,query:x}),Object(I.jsx)(r.EuiSpacer,{size:"m"})),"string"==typeof(null==u?void 0:u.id)&&Object(I.jsx)(Wo,{jobId:null==u?void 0:u.id}),"string"==typeof(null==u?void 0:u.id)&&_.length>1&&Object(I.jsx)(Zo,{fields:_,index:null==u?void 0:u.dest.index,resultsField:null==u?void 0:u.dest.results_field,searchQuery:f}),S&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiCallOut,{size:"s",title:o.i18n.translate("xpack.ml.dataframe.analytics.outlierExploration.legacyFeatureInfluenceFormatCalloutTitle",{defaultMessage:"Color coded table cells based on feature influence are not available because the results index uses an unsupported legacy format. Please clone and rerun the job."}),iconType:"pin"}),Object(I.jsx)(r.EuiSpacer,{size:"m"})),Object(I.jsx)(Qo,{colorRange:w&&!S?E:void 0,indexData:g,indexPattern:c,jobConfig:u,needsDestIndexPattern:p,searchQuery:f}))}));var pl=a(74),ml=a(184);const bl=(e,t,a,n,s)=>{var r;const[l,c]=Object(i.useState)(),d=Object(ml.a)(),u=void 0!==e&&e.title===(null==t?void 0:t.source.index[0]),p=[];if(void 0!==t){const e=t.dest.results_field,{fieldTypes:a}=Object(No.m)(t,u);p.push(...Object(yo.e)(a,e).sort(((e,a)=>Object(go.h)(e.id,a.id,t))))}const m=cl(p,8,(e=>!e.includes(`.${Po.a}.`)&&!e.includes(`.${Po.d}.`)&&e!==go.d));Object(i.useEffect)((()=>{const e={didCancel:!1};return Object(No.l)(t,m,a,e),()=>{e.didCancel=!0}}),[t&&t.id,m.pagination,a,m.sortingColumns]);const b=Object(i.useMemo)((()=>void 0!==e?new data_loader_DataLoader(e,n):void 0),[e]);Object(i.useEffect)((()=>{m.chartsVisible&&async function(){try{if(void 0!==t&&void 0!==b){const e=await b.loadFieldHistograms(p.filter((e=>m.visibleColumns.includes(e.id))).map((e=>({fieldName:e.id,type:Object(yo.f)(e.schema)}))),a);m.setColumnCharts(e)}}catch(e){Object(yo.k)(e,n)}}()}),[m.chartsVisible,null==t?void 0:t.dest.index,JSON.stringify([a,m.visibleColumns])]);const f=Object(i.useMemo)((()=>{var e;if(t)return null!==(e=Object(Ho.e)(t.analysis))&&void 0!==e?e:Object(Ho.b)(t.analysis)}),[t]),h=Object(i.useCallback)((async()=>{try{if(void 0!==t&&void 0!==t.analysis&&(Object(pl.y)(t.analysis)||Object(Ho.f)(t.analysis))){var e;const n=t.id,i=(await d.getTrainedModels(`${n}*`,{include:"feature_importance_baseline"})).find((e=>{var t,a;return(null===(t=e.metadata)||void 0===t||null===(a=t.analytics_config)||void 0===a?void 0:a.id)===n}));var a;if(void 0!==(null==i||null===(e=i.metadata)||void 0===e?void 0:e.feature_importance_baseline))c(null==i||null===(a=i.metadata)||void 0===a?void 0:a.feature_importance_baseline)}}catch(e){const t=Object(Re.b)(e);n.addDanger({title:o.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.baselineErrorMessageToast",{defaultMessage:"An error occurred getting feature importance baseline"}),text:t})}}),[s,t]);Object(i.useEffect)((()=>{h()}),[t]);const g=null!==(r=null==t?void 0:t.dest.results_field)&&void 0!==r?r:sl.d,j=Object(yo.m)(e,m.pagination,m.tableItems,g);return{...m,renderCellValue:j,baseline:l,predictionFieldName:f,resultsField:g}},fl=s.a.memo((({indexPattern:e,jobConfig:t,needsDestIndexPattern:a,searchQuery:n})=>{const{services:{mlServices:{mlApiServices:i}}}=Object(d.b)(),s=bl(e,t,n,Object(Ye.l)(),i);return void 0===t||void 0===s?null:Object(I.jsx)("div",{"data-test-subj":"mlDFAnalyticsExplorationTablePanel"},Object(I.jsx)(Qo,{indexData:s,indexPattern:e,jobConfig:t,needsDestIndexPattern:a,searchQuery:n}))})),hl=o.i18n.translate("xpack.ml.dataframe.analytics.jobConfig.errorTitle",{defaultMessage:"Unable to fetch results. An error occurred loading the job configuration data."}),gl=o.i18n.translate("xpack.ml.dataframe.analytics.jobCaps.errorTitle",{defaultMessage:"Unable to fetch results. An error occurred loading the index's field data."}),jl=({jobCapsServiceErrorMessage:e,jobConfigErrorMessage:t,title:a})=>{const{services:{application:{getUrlForApp:n}}}=Object(d.b)(),s="string"==typeof e&&e.includes("locate that index-pattern")&&e.includes("click here to re-create"),o=Object(I.jsx)("p",null,t||e),l=Object(i.useMemo)((()=>n("management",{path:"kibana/indexPatterns"})),[]),c=s?Object(I.jsx)(r.EuiLink,{href:l,target:"_blank"},o):o;return Object(I.jsx)(r.EuiPanel,{grow:!1},Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiCallOut,{title:t?hl:gl,color:"danger",iconType:"cross"},c))},xl=()=>Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiPanel,{className:"eui-textCenter"},Object(I.jsx)(r.EuiLoadingSpinner,{size:"xl"})),Object(I.jsx)(r.EuiSpacer,{size:"m"}));function vl(e){return{options:[{id:"training",label:o.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.trainingSubsetLabel",{defaultMessage:"Training"})},{id:"testing",label:o.i18n.translate("xpack.ml.dataframe.analytics.explorationResults.testingSubsetLabel",{defaultMessage:"Testing"})}],columnId:`${e}.is_training`,key:{training:!0,testing:!1}}}const yl=({jobId:e,title:t,EvaluatePanel:a,FeatureImportanceSummaryPanel:n})=>{var l,c,d;const{indexPattern:u,indexPatternErrorMessage:p,isInitialized:m,isLoadingJobConfig:b,jobCapsServiceErrorMessage:f,jobConfig:h,jobConfigErrorMessage:g,jobStatus:j,needsDestIndexPattern:x,totalFeatureImportance:v}=Object(No.x)(e),[y,O]=Bo(),[E,w]=Object(i.useState)(No.g),M=Object(i.useCallback)((e=>{e.query&&w(e.query),e.queryString!==y.queryText&&O({queryText:e.queryString,queryLanguage:e.language})}),[y,O]),S={query:y.queryText,language:y.queryLanguage},_=null!==(l=null==h?void 0:h.dest.results_field)&&void 0!==l?l:"",T=jo(u,null==h||null===(c=h.analyzed_fields)||void 0===c?void 0:c.includes,null==h||null===(d=h.analyzed_fields)||void 0===d?void 0:d.excludes,_);if(void 0!==p)return Object(I.jsx)(r.EuiPanel,{grow:!1},Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.dataframe.analytics.exploration.indexError",{defaultMessage:"An error occurred loading the index data."}),color:"danger",iconType:"cross"},Object(I.jsx)("p",null,p)));if(void 0!==g||void 0!==f)return Object(I.jsx)(jl,{jobCapsServiceErrorMessage:f,jobConfigErrorMessage:g,title:t});const C=h&&h.analysis?Object(Ho.a)(null==h?void 0:h.analysis):void 0;return Object(I.jsx)(s.a.Fragment,null,void 0!==(null==h?void 0:h.description)&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,null,null==h?void 0:h.description),Object(I.jsx)(r.EuiSpacer,{size:"m"})),void 0!==u&&h&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{direction:"column"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(tl,{indexPattern:u,setSearchQuery:M,query:S,filters:vl(h.dest.results_field)}))))),Object(I.jsx)(r.EuiSpacer,{size:"m"})),!0===b&&void 0===h&&Object(I.jsx)(xl,null),!1===b&&void 0!==h&&!0===m&&Object(I.jsx)(Wo,{jobId:h.id}),!0===b&&void 0===h&&Object(I.jsx)(xl,null),!1===b&&void 0!==h&&!0===m&&Object(I.jsx)(a,{jobConfig:h,jobStatus:j,searchQuery:E}),!0===b&&void 0!==h&&void 0===v&&Object(I.jsx)(xl,null),!1===b&&void 0!==h&&void 0!==v&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(n,{totalFeatureImportance:v,jobConfig:h})),Object(I.jsx)(r.EuiSpacer,{size:"m"}),!0===b&&void 0===h&&Object(I.jsx)(xl,null),!1===b&&void 0!==h&&!0===m&&"string"==typeof(null==h?void 0:h.id)&&T.length>1&&void 0!==(null==h?void 0:h.analysis)&&Object(I.jsx)(Zo,{fields:T,index:null==h?void 0:h.dest.index,color:C===pl.b.REGRESSION||C===pl.b.CLASSIFICATION?Object(Ho.c)(h.analysis):void 0,legendType:Object(No.p)(C),searchQuery:E}),!0===b&&void 0===h&&Object(I.jsx)(xl,null),!1===b&&void 0!==h&&void 0!==u&&!0===m&&Object(I.jsx)(fl,{indexPattern:u,jobConfig:h,jobStatus:j,needsDestIndexPattern:x,searchQuery:E}))},Ol={[pl.h.MSE]:o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorText",{defaultMessage:"Mean squared error"}),[pl.h.MSLE]:o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.msleText",{defaultMessage:"Mean squared logarithmic error"}),[pl.h.R_SQUARED]:o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredText",{defaultMessage:"R squared"}),[pl.h.HUBER]:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.huberText",defaultMessage:"{wikiLink}",values:{wikiLink:Object(I.jsx)(r.EuiLink,{href:"https://en.wikipedia.org/wiki/Huber_loss#Pseudo-Huber_loss_function",target:"_blank",external:!0},o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.huberLinkText",{defaultMessage:"Pseudo Huber loss function"}))}})},El={[pl.h.MSE]:o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.meanSquaredErrorTooltipContent",{defaultMessage:"Measures how well the regression analysis model is performing. Mean squared sum of the difference between true and predicted values."}),[pl.h.MSLE]:o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.msleTooltipContent",{defaultMessage:"Average squared difference between the logarithm of the predicted values and the logarithm of the actual (ground truth) value"}),[pl.h.R_SQUARED]:o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.rSquaredTooltipContent",{defaultMessage:"Represents the goodness of fit. Measures how well the observed outcomes are replicated by the model."})},wl=({isLoading:e,statType:t,title:a,dataTestSubj:n})=>Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs","data-test-subj":n},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiStat,{reverse:!0,isLoading:e,title:a,description:Ol[t],titleSize:"xxs"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},t!==pl.h.HUBER&&Object(I.jsx)(r.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsRegression__evaluateStat",content:El[t]}))),Ml={mse:pl.c,msle:pl.c,huber:pl.c,rSquared:pl.c},Sl={...Ml,error:null},_l=({jobConfig:e,jobStatus:t,searchQuery:a})=>{const{services:{docLinks:n}}=Object(d.b)(),l=n.links.ml.regressionEvaluation,[c,u]=Object(i.useState)(Sl),[p,m]=Object(i.useState)(Sl),[b,f]=Object(i.useState)(!1),[h,g]=Object(i.useState)(!1),[j,x]=Object(i.useState)(void 0),[v,y]=Object(i.useState)(null),[O,E]=Object(i.useState)(null),w=e.dest.index,M=Object(No.k)(e.analysis),S=Object(No.o)(e.analysis),_=e.dest.results_field,T=async()=>{(async(e=!0)=>{g(!0);const t=await Object(No.t)({isTraining:!1,index:w,dependentVariable:M,resultsField:_,predictionFieldName:S,searchQuery:a,ignoreDefaultQuery:e,jobType:pl.b.REGRESSION});if(!0===t.success&&t.eval&&Object(pl.z)(t.eval)){const{mse:e,msle:a,huber:n,r_squared:i}=Object(No.q)(t.eval);m({mse:e,msle:a,huber:n,rSquared:i,error:null}),g(!1)}else g(!1),m({...Ml,error:t.error})})(!1);const t=await Object(No.s)({ignoreDefaultQuery:!1,isTraining:!1,searchQuery:a,resultsField:_,destIndex:e.dest.index});!0===t.success?E(t.docsCount):E(null),(async(e=!0)=>{f(!0);const t=await Object(No.t)({isTraining:!0,index:w,dependentVariable:M,resultsField:_,predictionFieldName:S,searchQuery:a,ignoreDefaultQuery:e,jobType:pl.b.REGRESSION});if(!0===t.success&&t.eval&&Object(pl.z)(t.eval)){const{mse:e,msle:a,huber:n,r_squared:i}=Object(No.q)(t.eval);u({mse:e,msle:a,huber:n,rSquared:i,error:null}),f(!1)}else f(!1),u({...Ml,error:t.error})})(!1);const n=await Object(No.s)({ignoreDefaultQuery:!1,isTraining:!0,searchQuery:a,resultsField:_,destIndex:e.dest.index});!0===n.success?y(n.docsCount):y(null)};return Object(i.useEffect)((()=>{let e;const t=Object(pl.A)(a)&&(a.bool.should||a.bool.filter);if(void 0!==t&&!1!==t)for(let a=0;a<t.length;a++){const n=t[a];if(n.match&&void 0!==n.match[`${_}.is_training`]){e=n.match[`${_}.is_training`];break}if(n.bool&&(void 0!==n.bool.should||void 0!==n.bool.filter)){const t=n.bool.should||n.bool.filter;if(void 0!==t)for(let a=0;a<t.length;a++){const n=t[a];if(n.match&&void 0!==n.match[`${_}.is_training`]){e=n.match[`${_}.is_training`];break}}}}x(e),T()}),[JSON.stringify(a)]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Vo,{urlStateKey:"evaluation",dataTestId:"RegressionEvaluation",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.evaluateSectionTitle",defaultMessage:"Model evaluation"}),docsLink:Object(I.jsx)(r.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:l},o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.regressionDocsLink",{defaultMessage:"Regression evaluation docs "})),headerItems:void 0!==t?[{id:"jobStatus",label:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateJobStatusLabel",{defaultMessage:"Job status"}),value:t}]:[],contentPadding:!0,content:Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiTitle,{size:"xxs"},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.generalizationErrorTitle",{defaultMessage:"Generalization error"}))),null!==O&&Object(I.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.generalizationDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:O}}),!0===j&&0===O&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.generalizationFilterText",defaultMessage:". Filtering for training data."})),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionGenMSEstat",isLoading:h,title:p.mse,statType:pl.h.MSE})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionGenRSquaredStat",isLoading:h,title:p.rSquared,statType:pl.h.R_SQUARED})))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionGenMsleStat",isLoading:h,title:p.msle,statType:pl.h.MSLE})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionGenHuberStat",isLoading:h,title:p.huber,statType:pl.h.HUBER})))))),null!==p.error&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs",color:"danger"},!0===j&&0===O&&p.error.includes("No documents found")?o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateNoTestingDocsError",{defaultMessage:"No testing documents found"}):p.error)))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiTitle,{size:"xxs"},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.trainingErrorTitle",{defaultMessage:"Training error"}))),null!==v&&Object(I.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.trainingDocsCount",defaultMessage:"{docsCount, plural, one {# doc} other {# docs}} evaluated",values:{docsCount:v}}),!1===j&&0===v&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.regressionExploration.trainingFilterText",defaultMessage:". Filtering for testing data."})),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionTrainingMSEstat",isLoading:b,title:c.mse,statType:pl.h.MSE})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionTrainingRSquaredStat",isLoading:b,title:c.rSquared,statType:pl.h.R_SQUARED})))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionTrainingMsleStat",isLoading:b,title:c.msle,statType:pl.h.MSLE})),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(wl,{dataTestSubj:"mlDFAnalyticsRegressionTrainingHuberStat",isLoading:b,title:c.huber,statType:pl.h.HUBER})))))),null!==c.error&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs",color:"danger"},!1===j&&0===v&&c.error.includes("No documents found")?o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.evaluateNoTrainingDocsError",{defaultMessage:"No training documents found"}):c.error)))))}),Object(I.jsx)(r.EuiSpacer,{size:"m"}))};var Tl=a(57),Cl=a(185);const{euiColorMediumShade:kl}=Tl.euiLightVars,Fl={axes:{axisLine:{stroke:kl},tickLabel:{fontSize:12,fill:kl},tickLine:{stroke:kl},gridLine:{horizontal:{dash:[1,2]},vertical:{strokeWidth:0}}},legend:{spacingBuffer:100}},Il=o.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceSummaryTooltipContent",{defaultMessage:"Total feature importance values indicate how significantly a field affects the predictions across all the training data."}),Dl=e=>e.classes.reduce(((e,t)=>e+t.importance.mean_magnitude),0),Al=({totalFeatureImportance:e,jobConfig:t})=>{const{services:{docLinks:a}}=Object(d.b)(),[n,l,c,u]=Object(i.useMemo)((()=>{let t=[],a={xAccessor:"featureName",yAccessors:["meanImportance"],name:o.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceYSeriesName",{defaultMessage:"magnitude"})},n="";if(e.length<1)return[t,a,void 0,void 0];Object(Cl.b)(e[0])&&(2===e[0].classes.length&&(n="binary_classification",t=e.map((e=>({featureName:e.feature_name,meanImportance:e.classes[0].importance.mean_magnitude}))).sort(((e,t)=>t.meanImportance-e.meanImportance))),e[0].classes.length>2&&(n="multiclass_classification",e.sort(((e,t)=>Dl(t)-Dl(e))).forEach((e=>{const a=e.classes.sort(((e,t)=>t.importance.mean_magnitude-e.importance.mean_magnitude));t.push(...a.map((t=>({featureName:e.feature_name,meanImportance:t.importance.mean_magnitude,className:t.class_name}))))})),a={xAccessor:"featureName",yAccessors:["meanImportance"],splitSeriesAccessors:["className"],stackAccessors:["featureName"]})),Object(Cl.d)(e[0])&&(n="regression",t=e.map((e=>({featureName:e.feature_name,meanImportance:e.importance.mean_magnitude}))).sort(((e,t)=>t.meanImportance-e.meanImportance)));const i="multiclass_classification"===n,s=e.length*(e.length<5?40:20)+50;return[t,a,i,s]}),[e]),p=a.links.ml.featureImportance,m=Object(i.useCallback)((e=>Number(e.toPrecision(3)).toString()),[]),b=Object(i.useMemo)((()=>{if(0===e.length&&(null!=t&&t.analysis&&Object(pl.y)(null==t?void 0:t.analysis)||Object(pl.v)(null==t?void 0:t.analysis))){const e=Object(No.h)(t.analysis);return"unknown"!==e&&0===t.analysis[e].num_top_feature_importance_values?Object(I.jsx)(r.EuiCallOut,{"data-test-subj":"mlTotalFeatureImportanceNotCalculatedCallout",size:"s",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.totalFeatureImportanceNotCalculatedCalloutMessage",defaultMessage:"Feature importance was not calculated because num_top_feature_importance values is set to 0."})}):Object(I.jsx)(r.EuiCallOut,{"data-test-subj":"mlNoTotalFeatureImportanceCallout",size:"s",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.noTotalFeatureImportanceCalloutMessage",defaultMessage:"Total feature importance data is not available; the data set is uniform and the features have no significant impact on the prediction."})})}}),[e,t]);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Vo,{urlStateKey:"feature_importance",isExpanded:void 0===b,dataTestId:"FeatureImportanceSummary",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.featureImportanceSummaryTitle",defaultMessage:"Total feature importance"}),docsLink:Object(I.jsx)(r.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:p},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.exploration.featureImportanceDocsLink",defaultMessage:"Feature importance docs"})),headerItems:[{id:"FeatureImportanceSummary",value:Il}],content:b||Object(I.jsx)("div",{"data-test-subj":"mlTotalFeatureImportanceChart"},Object(I.jsx)(pt.Chart,{size:{width:"100%",height:u}},Object(I.jsx)(pt.Settings,{rotation:90,theme:Fl,showLegend:c}),Object(I.jsx)(pt.Axis,{id:"x-axis",title:o.i18n.translate("xpack.ml.dataframe.analytics.exploration.featureImportanceXAxisTitle",{defaultMessage:"Feature importance average magnitude"}),position:pt.Position.Bottom,tickFormat:m}),Object(I.jsx)(pt.Axis,{id:"y-axis",title:"",position:pt.Position.Left}),Object(I.jsx)(pt.BarSeries,h()({id:"magnitude",xScaleType:pt.ScaleType.Ordinal,yScaleType:pt.ScaleType.Linear,data:n},l))))}),Object(I.jsx)(r.EuiSpacer,{size:"m"}))},Ll=({jobId:e})=>Object(I.jsx)(yl,{jobId:e,title:o.i18n.translate("xpack.ml.dataframe.analytics.regressionExploration.tableJobIdTitle",{defaultMessage:"Destination index for regression job ID {jobId}",values:{jobId:e}}),EvaluatePanel:_l,FeatureImportanceSummaryPanel:Al});a(625);const Rl=({error:e})=>{let t=Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.generalErrorTitle",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},Object(I.jsx)("p",null,e));return"string"==typeof e&&e.includes("index_not_found")?t=Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.evaluateErrorTitle",{defaultMessage:"An error occurred loading the data."}),color:"danger",iconType:"cross"},Object(I.jsx)("p",null,o.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noIndexCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the destination index exists and contains documents."}))):"string"==typeof e&&e.includes("No documents found")?t=Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noDataCalloutTitle",{defaultMessage:"Empty index query result."}),color:"primary"},Object(I.jsx)("p",null,o.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.noDataCalloutBody",{defaultMessage:"The query for the index returned no results. Please make sure the job has completed and the index contains documents."}))):"string"==typeof e&&e.includes("userProvidedQueryBuilder")&&(t=Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.queryParsingErrorTitle",{defaultMessage:"Unable to parse query."}),color:"primary"},Object(I.jsx)("p",null,o.i18n.translate("xpack.ml.dataframe.analytics.errorCallout.queryParsingErrorBody",{defaultMessage:"The query syntax is invalid and returned no results. Please check the query syntax and try again."})))),Object(I.jsx)(i.Fragment,null,t)},Nl=({isLoading:e,title:t,description:a,dataTestSubj:n,tooltipContent:i})=>Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs","data-test-subj":n},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiStat,{reverse:!0,isLoading:e,title:null!==t?Math.round(1e3*t)/1e3:pl.c,description:a,titleSize:"xs"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIconTip,{anchorClassName:"mlDataFrameAnalyticsRegression__evaluateStat",content:i}))),Pl=[{field:"className",name:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.recallAndAccuracyClassColumn",{defaultMessage:"Class"}),sortable:!0,truncateText:!0},{field:"accuracy",name:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.recallAndAccuracyAccuracyColumn",{defaultMessage:"Accuracy"}),render:e=>Math.round(1e3*e)/1e3},{field:"recall",name:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.recallAndAccuracyRecallColumn",{defaultMessage:"Recall"}),render:e=>Math.round(1e3*e)/1e3}],zl=({evaluationMetricsItems:e})=>Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiAccordion,{id:"recall-and-accuracy",buttonContent:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionRecallAndAccuracy",defaultMessage:"Per class recall and accuracy"})},Object(I.jsx)(r.EuiPanel,null,Object(I.jsx)(r.EuiInMemoryTable,{items:e,columns:Pl,pagination:!0,sorting:!0})))),Bl=Object(r.euiPaletteGray)(1)[0],Jl="baseline",Vl=300;const Ul=(e,t,a,n)=>{t.push({tpr:0,fpr:0,threshold:1,class_name:Jl}),t.push({tpr:1,fpr:1,threshold:1,class_name:Jl});const i=function(e){const t=[...e,Jl].sort().indexOf(Jl),a=Object(r.euiPaletteColorBlind)({rotations:2}).slice(0,e.length);return a.splice(t,0,Bl),a}(e);return{$schema:"https://vega.github.io/schema/vega-lite/v4.8.1.json",background:"transparent",padding:{left:45,top:0,right:0,bottom:0},config:{legend:{orient:"right",labelColor:n.euiTextSubduedColor,titleColor:n.euiTextSubduedColor},view:{continuousHeight:Vl,continuousWidth:Vl}},data:{name:"roc-curve-data"},datasets:{"roc-curve-data":t},encoding:{color:{field:"class_name",type:Mo.a.NOMINAL,scale:{range:i},legend:{title:a}},size:{value:2},strokeDash:{condition:{test:`(datum.class_name === '${Jl}')`,value:[5,5]},value:[0]},x:{field:"fpr",sort:null,title:o.i18n.translate("xpack.ml.dataframe.analytics.rocChartSpec.xAxisTitle",{defaultMessage:"False Positive Rate (FPR)"}),type:"quantitative",axis:{tickColor:Bl,labelColor:n.euiTextSubduedColor,domainColor:Bl,titleColor:n.euiTextSubduedColor}},y:{field:"tpr",title:o.i18n.translate("xpack.ml.dataframe.analytics.rocChartSpec.yAxisTitle",{defaultMessage:"True Positive Rate (TPR) (a.k.a Recall)"}),type:"quantitative",axis:{tickColor:Bl,labelColor:n.euiTextSubduedColor,domainColor:Bl,titleColor:n.euiTextSubduedColor}},tooltip:[{type:Mo.a.NOMINAL,field:"class_name"},{type:Mo.a.QUANTITATIVE,field:"fpr"},{type:Mo.a.QUANTITATIVE,field:"tpr"}]},height:Vl,width:Vl,mark:{type:"line",strokeCap:"round",strokeJoin:"round"}}},Gl="actual_class",ql="other";function Wl(e,t){return[{id:"actions",width:60,headerCellRender:()=>Object(I.jsx)("span",null,`${e} more`),rowCellRender:function(){const[e,a]=Object(i.useState)(!1);return Object(I.jsx)(r.EuiPopover,{isOpen:e,anchorPosition:"upCenter",button:Object(I.jsx)(r.EuiButtonIcon,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showActions",{defaultMessage:"Show actions"}),iconType:"boxesHorizontal",color:"text",onClick:()=>a(!e)}),closePopover:()=>a(!1),ownFocus:!0},Object(I.jsx)(r.EuiButtonEmpty,{onClick:()=>t(!0)},Object(I.jsx)(r.EuiText,{size:"s",grow:!1,textAlign:"center"},o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.showAllColumns",{defaultMessage:"Show all columns"}))))}}]}function Hl(e,t){let a;const n=Object(pl.A)(e)&&(e.bool.should||e.bool.filter);if(void 0!==n&&!1!==n)for(let e=0;e<n.length;e++){const i=n[e];if(i.match&&void 0!==i.match[`${t}.is_training`]){a=i.match[`${t}.is_training`];break}if(i.bool&&(void 0!==i.bool.should||void 0!==i.bool.filter)){const e=i.bool.should||i.bool.filter;if(void 0!==e)for(let n=0;n<e.length;n++){const i=e[n];if(i.match&&void 0!==i.match[`${t}.is_training`]){a=i.match[`${t}.is_training`];break}}}}return a}const Yl=1e5;const $l=(e,t)=>{const[a,n]=Object(i.useState)([]),[s,r]=Object(i.useState)(null),[o,l]=Object(i.useState)(null),[c,d]=Object(i.useState)([]),[u,p]=Object(i.useState)(!1),[m,b]=Object(i.useState)(null),[f,h]=Object(i.useState)(null);return Object(i.useEffect)((()=>{!async function(){p(!0);let a=!1;const i=Object(No.k)(e.analysis),s=e.dest.results_field,o=Hl(t,s);try{a=Object(go.g)(i)}catch(e){console.error("Unable to load new field types",e)}const c=await Object(No.t)({isTraining:o,index:e.dest.index,dependentVariable:i,resultsField:s,predictionFieldName:Object(No.o)(e.analysis),searchQuery:t,jobType:pl.b.CLASSIFICATION,requiresKeyword:a}),u=await Object(No.s)({isTraining:o,searchQuery:t,resultsField:s,destIndex:e.dest.index});if(!0===c.success&&c.eval&&Object(pl.w)(c.eval)){var m,f,g,j,x,v,y,O,E,w;const e=null===(m=c.eval)||void 0===m||null===(f=m.classification)||void 0===f||null===(g=f.multiclass_confusion_matrix)||void 0===g?void 0:g.confusion_matrix;h(null),n(e||[]),l((null===(j=c.eval)||void 0===j||null===(x=j.classification)||void 0===x||null===(v=x.recall)||void 0===v?void 0:v.avg_recall)||null),r((null===(y=c.eval)||void 0===y||null===(O=y.classification)||void 0===O||null===(E=O.accuracy)||void 0===E?void 0:E.overall_accuracy)||null),d(function(e){var t,a;if(void 0===e)return[];const n=(null===(t=e.accuracy)||void 0===t?void 0:t.classes)||[],i=(null===(a=e.recall)||void 0===a?void 0:a.classes)||[],s=n.reduce(((e,t)=>(e[t.class_name]={className:t.class_name,accuracy:t.value},e)),{});return i.forEach((e=>{void 0!==s[e.class_name]?s[e.class_name]={recall:e.value,...s[e.class_name]}:s[e.class_name]={className:e.class_name,recall:e.value}})),Object.values(s)}(null===(w=c.eval)||void 0===w?void 0:w.classification)),p(!1)}else p(!1),n([]),h(c.error);!0===u.success?b(u.docsCount):b(null)}()}),[JSON.stringify([e,t])]),{avgRecall:o,confusionMatrixData:a,docsCount:m,error:f,isLoading:u,overallAccuracy:s,evaluationMetricsItems:c}};a(630);const Xl=({onClick:e})=>Object(I.jsx)(r.EuiButtonIcon,{className:"mlHelpPopover__buttonIcon",size:"s",iconType:"help","aria-label":o.i18n.translate("xpack.ml.helpPopover.ariaLabel",{defaultMessage:"Help"}),onClick:e}),Kl=({anchorPosition:e,button:t,children:a,closePopover:n,isOpen:i,title:s})=>Object(I.jsx)(r.EuiPopover,{anchorPosition:e,button:t,className:"mlHelpPopover",closePopover:n,isOpen:i,ownFocus:!0,panelClassName:"mlHelpPopover__panel",panelPaddingSize:"none"},s&&Object(I.jsx)(r.EuiPopoverTitle,{paddingSize:"s"},s),Object(I.jsx)(r.EuiText,{className:"mlHelpPopover__content",size:"s"},a)),Ql=()=>{const[e,t]=Object(i.useState)(!1);return Object(I.jsx)(Kl,{anchorPosition:"upCenter",button:Object(I.jsx)(Xl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:o.i18n.translate("xpack.ml.dataframe.analytics.confusionMatrixPopoverTitle",{defaultMessage:"Normalized confusion matrix"})},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixBasicExplanation",defaultMessage:"The multiclass confusion matrix provides a summary of the performance of the classification analysis. It contains the proportion of the data points that the analysis classified correctly with their actual class as well as the proportion of the misclassified data points."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixAxisExplanation",defaultMessage:"The matrix contains the actual labels on the left side while the predicted labels are on the top. The proportion of correct and incorrect predictions is broken down for each class. This enables you to examine how the classification analysis confused the different classes while it made its predictions. If you want to see the exact number of occurrences, select a cell in the matrix and click the appearing icon."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixShadeExplanation",defaultMessage:"As the number of classes in the classification analysis increases, the confusion matrix also increases in complexity. For an easier overview, darker cells indicate higher percentage of the predictions."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.confusionMatrixColumnExplanation",defaultMessage:"The Columns selector enables you to toggle between showing or hiding some of the columns or all of them."})))},Zl=()=>{const[e,t]=Object(i.useState)(!1);return Object(I.jsx)(Kl,{anchorPosition:"upCenter",button:Object(I.jsx)(Xl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:o.i18n.translate("xpack.ml.dataframe.analytics.rocCurvePopoverTitle",{defaultMessage:"Receiver operating characteristic (ROC) curve"})},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.rocCurveBasicExplanation",defaultMessage:"The ROC curve is a plot that represents the performance of the classification process at different predicted probability thresholds."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.rocCurveCompute",defaultMessage:"It compares the true positive rate (y-axis) for a specific class against the false positive rate (x-axis) at the different threshold levels to create the curve."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.rocCurveAuc",defaultMessage:"From this plot, the area under the curve (AUC) value can be computed, which is a number between 0 and 1. The closer to 1, the better the algorithm performance."})))};var ec;!function(e){e.TRAINING="training",e.TESTING="testing",e.ENTIRE="entire"}(ec||(ec={}));const tc=o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixEntireHelpText",{defaultMessage:"Normalized confusion matrix for entire dataset"}),ac=o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTestingHelpText",{defaultMessage:"Normalized confusion matrix for testing dataset"}),nc=o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixTrainingHelpText",{defaultMessage:"Normalized confusion matrix for training dataset"}),ic=o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluationQualityMetricsHelpText",{defaultMessage:"Evaluation quality metrics"});function sc(e){let t=tc;return e===ec.TESTING?t=ac:e===ec.TRAINING&&(t=nc),t}const rc=({jobConfig:e,jobStatus:t,searchQuery:a})=>{const{services:{docLinks:n}}=Object(d.b)(),{euiTheme:l}=Object(ho.e)(),[c,u]=Object(i.useState)([]),[p,m]=Object(i.useState)([]),[b,f]=Object(i.useState)(!1),[h,g]=Object(i.useState)({}),[j,x]=Object(i.useState)(ec.ENTIRE),[v,y]=Object(i.useState)((()=>c.map((({id:e})=>e)))),O=Hl(a,e.dest.results_field),{avgRecall:E,confusionMatrixData:w,docsCount:M,error:S,isLoading:_,overallAccuracy:T,evaluationMetricsItems:C}=$l(e,a);Object(i.useEffect)((()=>{x(void 0===O?ec.ENTIRE:O&&!0===O?ec.TRAINING:ec.TESTING)}),[O]),Object(i.useEffect)((()=>{if(w.length>0){const{columns:e,columnData:t}=function(e){const t=[],a=[{id:Gl,display:Object(I.jsx)("span",null),initialWidth:165}];let n=!1;for(const i of e){const e=i.other_predicted_class_doc_count;e>0&&(n=!0);const s={actual_class:i.actual_class,actual_class_doc_count:i.actual_class_doc_count,other:e,predicted_classes_count:{}},r=i.predicted_classes||[];a.push({id:i.actual_class,initialWidth:165});for(let e=0;e<r.length;e++){const t=r[e].predicted_class,a=r[e].count;s.predicted_classes_count[t]=a}t.push(s)}return n&&a.push({id:ql,initialWidth:165}),{columns:a,columnData:t}}(w);y((()=>e.map((({id:e})=>e)))),u(e),m(t),g({numeric:({cellContentsElement:e,children:a})=>{var n,i;const s=null==a||null===(n=a.props)||void 0===n?void 0:n.rowIndex,r=null==a||null===(i=a.props)||void 0===i?void 0:i.columnId,o=t[s];if(void 0!==o&&r!==Gl){return`${o.predicted_classes_count[r]} / ${o.actual_class_doc_count} * 100 = ${e.textContent}`}return e.textContent}})}}),[w]);const{rocCurveData:k,classificationClasses:F,error:D,isLoading:A}=((e,t,a)=>{const n=a.filter((e=>e!==Gl&&e!==ql));n.length<=2&&n.splice(1);const[s,r]=Object(i.useState)([]),[o,l]=Object(i.useState)(!1),[c,d]=Object(i.useState)(null);return Object(i.useEffect)((()=>{!async function(){l(!0);const a=Object(No.k)(e.analysis),i=e.dest.results_field,s=[];let o=!1;const c=[];try{o=Object(go.g)(a)}catch(e){console.error("Unable to load new field types",e)}for(let r=0;r<n.length;r++){const l=n[r],d=await Object(No.t)({isTraining:Hl(t,i),index:e.dest.index,dependentVariable:a,resultsField:i,predictionFieldName:Object(No.o)(e.analysis),searchQuery:t,jobType:pl.b.CLASSIFICATION,requiresKeyword:o,rocCurveClassName:l,includeMulticlassConfusionMatrix:!1});if(!0===d.success&&d.eval&&Object(pl.w)(d.eval)){var u,p,m,b,f,h;const e=(null===(u=d.eval)||void 0===u||null===(p=u.classification)||void 0===p||null===(m=p.auc_roc)||void 0===m?void 0:m.value)||0,t=n.length>2?n[r]:"ROC",a=((null===(b=d.eval)||void 0===b||null===(f=b.classification)||void 0===f||null===(h=f.auc_roc)||void 0===h?void 0:h.curve)||[]).map((a=>({class_name:`${t} (AUC: ${Math.round(e*Yl)/Yl})`,...a})));s.push(...a)}else null!==d.error&&c.push(d.error)}d(c.length>0?c:null),r(s),l(!1)}()}),[JSON.stringify([e,t,a])]),{rocCurveData:s,classificationClasses:n.length>2?n:["ROC"],error:c,isLoading:o}})(e,a,c.map((e=>e.id))),L=n.links.ml.classificationEvaluation,R=p.length>6,N=p.length-6,P=!0===R&&!1===b?c.slice(0,7):c,z=!0===R&&!1===b?6:p.length;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Vo,{urlStateKey:"evaluation",dataTestId:"ClassificationEvaluation",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionTitle",defaultMessage:"Model evaluation"}),docsLink:Object(I.jsx)(r.EuiButtonEmpty,{target:"_blank",iconType:"help",iconSide:"left",color:"primary",href:L},o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.classificationDocsLink",{defaultMessage:"Classification evaluation docs "})),headerItems:_?Jo:[...void 0!==t?[{id:"jobStatus",label:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateJobStatusLabel",{defaultMessage:"Job status"}),value:t}]:[],...null!==M?[{id:"docsEvaluated",label:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.generalizationDocsCount",{defaultMessage:"{docsCount, plural, one {doc} other {docs}} evaluated",values:{docsCount:M}}),value:M}]:[]],contentPadding:!0,content:Object(I.jsx)(s.a.Fragment,null,_?null:Object(I.jsx)(s.a.Fragment,null,null!==S&&Object(I.jsx)(Rl,{error:S}),null===S&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(I.jsx)(r.EuiTitle,{size:"xxs"},Object(I.jsx)("span",null,sc(j))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Ql,null))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)("div",{className:"mlDataFrameAnalyticsClassification__evaluateSectionContent"},Object(I.jsx)("div",{className:"mlDataFrameAnalyticsClassification__actualLabel"},Object(I.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixActualLabel",defaultMessage:"Actual class"}))),Object(I.jsx)("div",{className:"mlDataFrameAnalyticsClassification__dataGridMinWidth"},c.length>0&&p.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",null,Object(I.jsx)(r.EuiText,{size:"xs",color:"subdued"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixPredictedLabel",defaultMessage:"Predicted class"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiDataGrid,{"data-test-subj":"mlDFAnalyticsClassificationExplorationConfusionMatrix","aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.confusionMatrixLabel",{defaultMessage:"Classification confusion matrix"}),columns:P,columnVisibility:{visibleColumns:v,setVisibleColumns:y},rowCount:z,renderCellValue:({rowIndex:e,columnId:t,setCellProps:a})=>{const n=t===Gl?p[e][t]:p[e].predicted_classes_count[t],s=p[e]&&p[e].actual_class_doc_count;let r="0%";if(t!==Gl&&s&&"number"==typeof n){let e=n/s;e=Math.round(100*e)/100,r=`${Math.round(100*e)}%`}return Object(i.useEffect)((()=>{t!==Gl&&a({style:{backgroundColor:`rgba(0, 179, 164, ${r})`}})}),[e,t,a]),Object(I.jsx)("span",null,t===Gl?n:r)},inMemory:{level:"sorting"},toolbarVisibility:{showColumnSelector:!0,showDisplaySelector:!1,showFullScreenSelector:!1,showSortSelector:!1},popoverContents:h,gridStyle:{border:"all",fontSize:"s",cellPadding:"s",stripes:!1,rowHover:"none",header:"shade"},trailingControlColumns:!0===R&&!1===b?Wl(N,f):void 0})))))),Object(I.jsx)(r.EuiSpacer,{size:"xl"}),Object(I.jsx)(r.EuiTitle,{size:"xxs"},Object(I.jsx)("span",null,ic)),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{direction:"column",justifyContent:"center",className:"mlDataFrameAnalyticsClassification__evaluationMetrics"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"l"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Nl,{dataTestSubj:"mlDFAEvaluateSectionOverallAccuracyStat",title:T,isLoading:_,description:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionOverallAccuracyStat",{defaultMessage:"Overall accuracy"}),tooltipContent:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionOverallAccuracyTooltip",{defaultMessage:"The ratio of the number of correct class predictions to the total number of predictions."})})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Nl,{dataTestSubj:"mlDFAEvaluateSectionAvgRecallStat",title:E,isLoading:_,description:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionMeanRecallStat",{defaultMessage:"Mean recall"}),tooltipContent:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionAvgRecallTooltip",{defaultMessage:"Mean recall shows how many of the data points that are actual class members were identified correctly as class members."})})))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(zl,{evaluationMetricsItems:C}))),Object(I.jsx)(r.EuiSpacer,{size:"l"}),Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(I.jsx)(r.EuiTitle,{size:"xxs"},Object(I.jsx)("span",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.classificationExploration.evaluateSectionRocTitle",defaultMessage:"Receiver operating characteristic (ROC) curve"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Zl,null))),Array.isArray(D)&&Object(I.jsx)(Rl,{error:Object(I.jsx)(s.a.Fragment,null,D.map((e=>Object(I.jsx)(s.a.Fragment,null,e,Object(I.jsx)("br",null)))))}),!A&&null===D&&k.length>0&&Object(I.jsx)("div",{className:"mlDataFrameAnalyticsClassification__evaluateSectionContent","data-test-subj":"mlDFAnalyticsClassificationExplorationRocCurveChart"},Object(I.jsx)(wo,{vegaSpec:Ul(F,k,Object(No.k)(e.analysis),l)})),A&&Object(I.jsx)(Oo,null))}),Object(I.jsx)(r.EuiSpacer,{size:"m"}))},oc=({jobId:e})=>Object(I.jsx)("div",{className:"mlDataFrameAnalyticsClassification"},Object(I.jsx)(yl,{jobId:e,title:o.i18n.translate("xpack.ml.dataframe.analytics.classificationExploration.tableJobIdTitle",{defaultMessage:"Destination index for classification job ID {jobId}",values:{jobId:e}}),EvaluatePanel:rc,FeatureImportanceSummaryPanel:Al})),lc=({jobId:e,analysisType:t})=>{const{services:{docLinks:a}}=Object(d.b)(),n=a.links.ml.dataFrameAnalytics;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{"data-test-subj":"mlPageDataFrameAnalyticsExploration"},Object(I.jsx)(Q.a,null,e),t===sl.a.OUTLIER_DETECTION&&Object(I.jsx)(ul,{jobId:e}),t===sl.a.REGRESSION&&Object(I.jsx)(Ll,{jobId:e}),t===sl.a.CLASSIFICATION&&Object(I.jsx)(oc,{jobId:e})),Object(I.jsx)(ur.a,{docLink:n}))},cc=(e,t)=>({path:"/data_frame_analytics/exploration",render:(e,t)=>Object(I.jsx)(dc,h()({},e,{deps:t})),title:o.i18n.translate("xpack.ml.dataFrameAnalytics.exploration.docTitle",{defaultMessage:"Exploration"}),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameExplorationLabel",{defaultMessage:"Exploration"})}]}),dc=({location:e,deps:t})=>{const{context:a}=S(void 0,void 0,t.config,t.dataViewsContract,U(t)),[n]=Object(c.c)("_g"),i=Object(d.d)(),{services:{application:{navigateToUrl:s}}}=Object(d.b)(),r=n.ml.jobId,o=n.ml.analysisType;return o||(async()=>{if(!i)return;const e=await i.getUrl({page:p.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});await s(e)})(),Object(I.jsx)(g.b,{context:a},Object(I.jsx)(lc,{jobId:r,analysisType:o}))};var uc=a(405);const pc=({messages:e})=>Object(I.jsx)(s.a.Fragment,null,e.map(((e,t)=>Object(I.jsx)(i.Fragment,{key:t},Object(I.jsx)(r.EuiCallOut,{"data-test-subj":`analyticsWizardCreationCallout_${t}`,title:e.message,color:void 0!==e.error?"danger":"primary",iconType:void 0!==e.error?"alert":"checkInCircleFilled",size:"s"},void 0!==e.error&&Object(I.jsx)(r.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",isCopyable:!0},e.error)),Object(I.jsx)(r.EuiSpacer,{size:"s"})))));var mc=a(127);const bc=async e=>{const t=Object(mc.f)(e);let a="",n="",i=!0,s="",r=[],o=!1;try{var l;delete t.dest,delete t.model_memory_limit;const e=await be.ml.dataFrameAnalytics.explainDataFrameAnalytics(t);s=null===(l=e.memory_estimation)||void 0===l?void 0:l.expected_memory_without_disk,r=e.field_selection||[]}catch(e){const t=Object(Re.c)(e);i=!1,a=t.message,t.causedBy&&(n=t.causedBy)}return a.includes("status_exception")&&a.includes("Unable to estimate memory usage as no documents")&&(o=!0),{success:i,expectedMemory:s,fieldSelection:r,errorMessage:a,errorReason:n,noDocsContainMappedFields:o}},fc=()=>{const e=Object(d.c)({page:p.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:Object(I.jsx)(r.EuiIcon,{size:"xxl",type:"list"}),title:o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardTitle",{defaultMessage:"Data Frame Analytics"}),description:o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsListCardDescription",{defaultMessage:"Return to the analytics management page."}),href:e,"data-test-subj":"analyticsWizardCardManagement"}))},hc=({jobId:e,analysisType:t})=>{const a=Object(d.c)({page:p.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:e,analysisType:t}});return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiCard,{className:"dfAnalyticsCreationWizard__card",icon:Object(I.jsx)(r.EuiIcon,{size:"xxl",type:"visTable"}),title:o.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardTitle",{defaultMessage:"View Results"}),description:o.i18n.translate("xpack.ml.dataframe.analytics.create.viewResultsCardDescription",{defaultMessage:"View results for the analytics job."}),href:a,"data-test-subj":"analyticsWizardViewResultsCard"}))},gc=({currentProgress:e,failedJobMessage:t})=>void 0===e?null:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,null),void 0!==t&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiCallOut,{"data-test-subj":"analyticsWizardProgressCallout",title:o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutTitle",{defaultMessage:"Job failed"}),color:"danger",iconType:"alert",size:"s"},Object(I.jsx)("p",null,t)),Object(I.jsx)(r.EuiSpacer,{size:"s"})),Object(I.jsx)(r.EuiText,{size:"m"},Object(I.jsx)("strong",null,o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressTitle",{defaultMessage:"Progress"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)("strong",null,o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressPhaseTitle",{defaultMessage:"Phase"})," ",e.currentPhase,"/",e.totalPhases))),Object(I.jsx)(r.EuiFlexItem,{style:{width:"400px"},grow:!1},Object(I.jsx)(r.EuiProgress,{value:e.progress,max:100,color:"primary",size:"l","data-test-subj":"mlAnalyticsCreationWizardProgress"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"s"},`${e.progress}%`)))),jc=({jobId:e,jobType:t,showProgress:a})=>{const[n,l]=Object(i.useState)(!1),[c,u]=Object(i.useState)(void 0),[p,m]=Object(i.useState)(!1),[b,f]=Object(i.useState)(void 0),[h,g]=Object(i.useState)(!1),{services:{notifications:j}}=Object(d.b)();return Object(i.useEffect)((()=>{l(!0)}),[]),Object(i.useEffect)((()=>{if(!1===a)return;const t=setInterval((async()=>{try{const a=await be.ml.dataFrameAnalytics.getDataFrameAnalyticsStats(e),n=Object(Uo.b)(a)?a.data_frame_analytics[0]:void 0;if(g((null==n?void 0:n.state)===Go.b.STARTING&&void 0===(null==n?void 0:n.node)),void 0!==n){const a=Object(Go.d)(n);n.state===Go.b.FAILED&&(clearInterval(t),u(n.failure_reason||o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressCalloutMessage",{defaultMessage:"Analytics job {jobId} has failed.",values:{jobId:e}}))),f(a),(a.currentPhase===a.totalPhases&&100===a.progress||n.state===Go.b.STOPPED&&(1!==a.currentPhase||0!==a.progress))&&(clearInterval(t),m(a.currentPhase===a.totalPhases&&100===a.progress))}else clearInterval(t)}catch(a){j.toasts.addDanger(o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsProgressErrorMessage",{defaultMessage:"An error occurred getting progress stats for analytics job {jobId}",values:{jobId:e}})),clearInterval(t)}}),1e3);return()=>clearInterval(t)}),[n]),Object(I.jsx)(s.a.Fragment,null,h&&Object(I.jsx)($i.b,{jobType:"data-frame-analytics"}),Object(I.jsx)(r.EuiFlexGroup,{direction:"column"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},a&&Object(I.jsx)(gc,{currentProgress:b,failedJobMessage:c})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiHorizontalRule,null),Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(fc,null)),!0===p?Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(hc,{jobId:e,analysisType:t})):null))))},xc=({actions:e,state:t,step:a})=>{const{services:{application:{capabilities:n}}}=Object(d.b)(),s=Object(i.useMemo)((()=>!0===n.savedObjectsManagement.edit||!0===n.indexPatterns.save),[n]),{createAnalyticsJob:l,setFormState:c,startAnalyticsJob:u}=e,{isAdvancedEditorValidJson:p,isJobCreated:m,isJobStarted:b,isValid:f,requestMessages:h}=t,{createIndexPattern:g,destinationIndex:j,destinationIndexPatternTitleExists:x,jobId:v,jobType:y}=t.form,[O,E]=Object(i.useState)(!0),[w,M]=Object(i.useState)(!1),[S,_]=Object(i.useState)(!1);if(Object(i.useEffect)((()=>{!1===s&&c({createIndexPattern:!1})}),[n]),a!==Cd.CREATE)return null;return Object(I.jsx)("div",{"data-test-subj":"mlAnalyticsCreateJobWizardCreateStep active"},!m&&!b&&Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"m",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFormRow,{helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.startCheckboxHelpText",{defaultMessage:"If unselected, job can be started later by returning to the jobs list."})},Object(I.jsx)(r.EuiCheckbox,{"data-test-subj":"mlAnalyticsCreateJobWizardStartJobCheckbox",id:"dataframe-create-start-checkbox",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.wizardStartCheckbox",{defaultMessage:"Start immediately"}),checked:O,onChange:e=>{E(e.target.checked),!1===e.target.checked&&c({createIndexPattern:!1})}}))),O?Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,isInvalid:g&&x||!1===g||!1===s,error:[...!1===s?[Object(I.jsx)(r.EuiText,{size:"xs",color:"warning"},o.i18n.translate("xpack.ml.dataframe.analytics.create.dataViewPermissionWarning",{defaultMessage:"You need permission to create data views."}))]:[],...g&&x?[o.i18n.translate("xpack.ml.dataframe.analytics.create.dataViewExistsError",{defaultMessage:"A data view with the title {title} already exists.",values:{title:j}})]:[],...g||x?[]:[Object(I.jsx)(r.EuiText,{size:"xs",color:"warning"},o.i18n.translate("xpack.ml.dataframe.analytics.create.shouldCreateDataViewMessage",{defaultMessage:"You may not be able to view job results if a data view is not created for the destination index."}))]]},Object(I.jsx)(r.EuiCheckbox,{disabled:m||!1===s,name:"mlDataFrameAnalyticsCreateIndexPattern",id:"dataframe-create-data-view-checkbox",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.createDataViewLabel",{defaultMessage:"Create data view"}),checked:!0===g,onChange:()=>c({createIndexPattern:!g}),"data-test-subj":"mlAnalyticsCreateJobWizardCreateIndexPatternCheckbox"}))):null)),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{className:"mlAnalyticsCreateWizard__footerButton",disabled:!f||!p||!0===x&&!0===g,onClick:async()=>{M(!0);const e=await l();!1===e&&M(!1),O&&!0===e&&(_(!0),u())},fill:!0,isLoading:w,"data-test-subj":"mlAnalyticsCreateJobWizardCreateButton"},o.i18n.translate("xpack.ml.dataframe.analytics.create.wizardCreateButton",{defaultMessage:"Create"})))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(pc,{messages:h}),!0===m?Object(I.jsx)(jc,{jobId:v,jobType:y,showProgress:S}):null)},vc=e=>{const{actions:t,state:a}=e,{setAdvancedEditorRawString:n,setFormState:s}=t,{advancedEditorMessages:l,advancedEditorRawString:c,isJobCreated:u}=a,{jobId:p,jobIdEmpty:m,jobIdExists:b,jobIdValid:f}=a.form,g=Object(i.useRef)(null),{toasts:j}=Object(d.f)(),v=Object(i.useMemo)((()=>Object(x.debounce)((async()=>{try{const e=await be.ml.dataFrameAnalytics.jobsExist([p],!0);s({jobIdExists:e[p].exists})}catch(e){j.addDanger(o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(Re.b)(e)}}))}}),400)),[p]);return Object(i.useEffect)((()=>{if(null===g.current)return;const e=document.createEvent("MouseEvents");e.initEvent("mouseup",!0,!0),g.current.dispatchEvent(e)}),[]),Object(i.useEffect)((()=>(!0===f?v():"string"==typeof p&&""===p.trim()&&!0===b&&s({jobIdExists:!1}),()=>{v.cancel()})),[p]),Object(I.jsx)(r.EuiForm,{className:"mlDataFrameAnalyticsCreateForm"},Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdLabel",{defaultMessage:"Analytics job ID"}),isInvalid:!m&&!f||b,error:[...m||f?[]:[o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...b?[o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[]]},Object(I.jsx)(r.EuiFieldText,{inputRef:e=>{e&&(g.current=e)},disabled:u,placeholder:"analytics job ID",value:p,onChange:e=>s({jobId:e.target.value}),"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!m&&!f||b})),Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.configRequestBody",{defaultMessage:"Configuration request body"}),style:{maxWidth:"100%"}},Object(I.jsx)(Si.CodeEditor,{languageId:"json",height:500,languageConfiguration:{autoClosingPairs:[{open:"{",close:"}"}]},value:c,onChange:e=>{n(e)},options:{ariaLabel:o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditor.codeEditorAriaLabel",{defaultMessage:"Advanced analytics job editor"}),automaticLayout:!0,readOnly:u,fontSize:12,scrollBeyondLastLine:!1,quickSuggestions:!0,minimap:{enabled:!1},wordWrap:"on",wrappingIndent:"indent"}})),Object(I.jsx)(r.EuiSpacer,null),l.map(((e,t)=>Object(I.jsx)(i.Fragment,{key:t},Object(I.jsx)(r.EuiCallOut,{title:""!==e.message?e.message:e.error,color:void 0!==e.error?"danger":"primary",iconType:void 0!==e.error?"alert":"checkInCircleFilled",size:"s"},""!==e.message&&void 0!==e.error?Object(I.jsx)("p",null,e.error):null),Object(I.jsx)(r.EuiSpacer,null)))),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(xc,h()({},e,{step:Cd.CREATE})))},yc=({setCurrentStep:e,state:t})=>{const a=Object(de.b)(),{currentDataView:n}=a,{form:s,isJobCreated:l}=t,{dependentVariable:c,includes:d,jobConfigQueryString:u,jobType:p,trainingPercent:m}=s,b=p===pl.b.REGRESSION||p===pl.b.CLASSIFICATION,f=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.sourceIndex",{defaultMessage:"Source index"}),description:n.title||mc.c},{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.Query",{defaultMessage:"Query"}),description:u||mc.c}],h=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobType",{defaultMessage:"Job type"}),description:p}],g=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFields",{defaultMessage:"Included fields"}),description:d.length>5?o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.includedFieldsAndMoreDescription",{defaultMessage:"{includedFields} ... (and {extraCount} more)",values:{extraCount:d.length-5,includedFields:d.slice(0,5).join(", ")}}):d.join(", ")}];return b&&(h.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.trainingPercent",{defaultMessage:"Training percent"}),description:`${m}`}),g.unshift({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.dependentVariable",{defaultMessage:"Dependent variable"}),description:c})),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:f})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:h})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:g}))),Object(I.jsx)(r.EuiSpacer,null),!l&&Object(I.jsx)(r.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(Cd.CONFIGURATION)}},o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.editButtonText",{defaultMessage:"Edit"})))};var Oc=a(223);const Ec=new Set(["ip","keyword"]),wc=(e,t,a)=>{if(e===Dt.a)return!1;const n=go.a.has(t),i=n||Ec.has(t)||t===y.ES_FIELD_TYPES.BOOLEAN;return a===pl.b.REGRESSION?n||go.b.has(t):a===pl.b.CLASSIFICATION?i:void 0},Mc=(e,t,a)=>{let n,i,s,r;return a===pl.b.CLASSIFICATION&&(e.includes("must have at most")||e.includes("must have at least"))?n=e:e.includes("status_exception")&&e.includes("unsupported type")?i=e:e.includes("status_exception")&&e.includes("Unable to estimate memory usage as no documents")?s=o.i18n.translate("xpack.ml.dataframe.analytics.create.allDocsMissingFieldsErrorMessage",{defaultMessage:"Unable to estimate memory usage. There are mapped fields for source index [{index}] that do not exist in any indexed documents. You will have to switch to the JSON editor for explicit field selection and include only fields that exist in indexed documents.",values:{index:t}}):r={title:o.i18n.translate("xpack.ml.dataframe.analytics.create.unableToFetchExplainDataMessage",{defaultMessage:"An error occurred fetching analysis fields data."}),text:e},{maxDistinctValuesErrorMessage:n,unsupportedFieldsErrorMessage:i,toastNotificationDanger:r,toastNotificationWarning:s}},Sc=o.i18n.translate("xpack.ml.dataframe.analytics.creation.continueButtonText",{defaultMessage:"Continue"}),_c=({isDisabled:e,onClick:t})=>Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{"data-test-subj":"mlAnalyticsCreateJobWizardContinueButton",isDisabled:e,size:"s",onClick:t},Sc))),Tc={[sl.a.OUTLIER_DETECTION]:{helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionHelpText",{defaultMessage:"Outlier detection identifies unusual data points in the data set."}),icon:"outlierDetectionJob",title:o.i18n.translate("xpack.ml.dataframe.analytics.create.outlierDetectionTitle",{defaultMessage:"Outlier detection"})},[sl.a.REGRESSION]:{helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.regressionHelpText",{defaultMessage:"Regression predicts numerical values in the data set."}),icon:"regressionJob",title:o.i18n.translate("xpack.ml.dataframe.analytics.create.regressionTitle",{defaultMessage:"Regression"})},[sl.a.CLASSIFICATION]:{helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.classificationHelpText",{defaultMessage:"Classification predicts classes of data points in the data set."}),icon:"classificationJob",title:o.i18n.translate("xpack.ml.dataframe.analytics.create.classificationTitle",{defaultMessage:"Classification"})}},Cc=({type:e,setFormState:t})=>{const[a,n]=Object(i.useState)({});return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardJobTypeSelect"},Object.keys(Tc).map((i=>Object(I.jsx)(r.EuiFlexItem,{key:i,grow:1},Object(I.jsx)(r.EuiCard,{icon:Object(I.jsx)(r.EuiIcon,{size:"xl",type:Tc[i].icon}),title:Tc[i].title,description:Tc[i].helpText,"data-test-subj":`mlAnalyticsCreation-${i}-option${e===i?" selectedJobType":""}`,selectable:{onClick:()=>{!0!==a[i]&&(t({previousJobType:e,jobType:i,requiredFieldsError:void 0}),n({[i]:!a[i]}))},isSelected:!0===a[i]||e===i}}))))),Object(I.jsx)(r.EuiSpacer,{size:"m"}))},kc={[pl.b.CLASSIFICATION]:({name:e,type:t})=>!It.c.includes(e)&&e!==Dt.a&&(go.a.has(t)||Ec.has(t)||t===y.ES_FIELD_TYPES.BOOLEAN),[pl.b.REGRESSION]:({name:e,type:t})=>!It.c.includes(e)&&e!==Dt.a&&(go.a.has(t)||go.b.has(t)),[pl.b.OUTLIER_DETECTION]:({name:e,type:t})=>!It.c.includes(e)&&e!==Dt.a&&(go.a.has(t)||go.b.has(t))},Fc={[pl.b.CLASSIFICATION]:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectClassificationHelpText",defaultMessage:"This data view does not contain any supported fields. Classification jobs require categorical, numeric, or boolean fields."}),[pl.b.REGRESSION]:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectRegressionHelpText",defaultMessage:"This data view does not contain any supported fields. Regression jobs require numeric fields."}),[pl.b.OUTLIER_DETECTION]:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceObjectHelpText",defaultMessage:"This data view does not contain any numeric type fields. The analytics job may not be able to come up with any outliers."})},Ic=({jobType:e})=>{const[t,a]=Object(i.useState)(!0),[n,s]=Object(i.useState)(!1),{fields:o}=ks.a;return Object(i.useEffect)((()=>{void 0!==e&&(()=>{if(o&&void 0!==e)try{const t=o.some(kc[e]);a(t),s(!1)}catch(e){s(!0)}})()}),[e]),!0===t?null:!0===n?Object(I.jsx)(i.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.sourceIndexFieldsCheckError",defaultMessage:"There was a problem checking for supported fields for job type. Please refresh the page and try again."}),Object(I.jsx)(r.EuiSpacer,{size:"s"})):Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiText,{size:"xs",color:"danger"},void 0!==e&&Fc[e]),Object(I.jsx)(r.EuiSpacer,{size:"s"}))};var Dc=a(61),Ac=a(404);const Lc=o.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.minimumFieldsMessage",{defaultMessage:"At least one field must be selected."}),Rc=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.analysisFieldsTable.fieldNameColumn",{defaultMessage:"Field name"}),id:"name",isSortable:!0,alignment:Dc.LEFT_ALIGNMENT},{id:"mapping_types",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.mappingColumn",{defaultMessage:"Mapping"}),isSortable:!1,alignment:Dc.LEFT_ALIGNMENT},{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isIncludedColumn",{defaultMessage:"Is included"}),id:"is_included",alignment:Dc.LEFT_ALIGNMENT,isSortable:!0,render:({is_included:e})=>e?"Yes":"No"},{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.isRequiredColumn",{defaultMessage:"Is required"}),id:"is_required",alignment:Dc.LEFT_ALIGNMENT,isSortable:!0,render:({is_required:e})=>e?"Yes":"No"},{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.analyticsTable.reasonColumn",{defaultMessage:"Reason"}),id:"reason",alignment:Dc.LEFT_ALIGNMENT,isSortable:!1}],Nc=e=>!0===e.is_required||e.reason&&e.reason.includes("unsupported type"),Pc=s.a.memo((({dependentVariable:e,includes:t,isJobTypeWithDepVar:a,setFormState:n,minimumFieldsRequiredMessage:s,setMinimumFieldsRequiredMessage:l,tableItems:c,unsupportedFieldsError:d,setUnsupportedFieldsError:u})=>{const[p,m]=Object(i.useState)(),[b,f]=Object(i.useState)({pageIndex:0,itemsPerPage:5});Object(i.useEffect)((()=>{if(0===t.length&&c.length>0){const e=[];c.forEach((t=>{!0===t.is_included&&e.push(t.name)})),n({includes:e})}else t.length>0&&n({includes:e&&t.includes(e)||!a?t:[...t,e]});l(void 0)}),[c]),Object(i.useEffect)((()=>{let e=[];e=[{name:"name",getValue:e=>e.name.toLowerCase(),isAscending:!0},{name:"is_included",getValue:e=>e.is_included,isAscending:!0},{name:"is_required",getValue:e=>e.is_required,isAscending:!0}];const t=new Dc.SortableProperties(e,"name");m(t)}),[]);const h=[{type:"field_value_toggle_group",field:"is_included",items:[{value:!0,name:o.i18n.translate("xpack.ml.dataframe.analytics.create.isIncludedOption",{defaultMessage:"Is included"})},{value:!1,name:o.i18n.translate("xpack.ml.dataframe.analytics.create.isNotIncludedOption",{defaultMessage:"Is not included"})}]}];return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardIncludesTable",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsLabel",{defaultMessage:"Included fields"}),fullWidth:!0,isInvalid:void 0!==s||void 0!==d,error:[...void 0!==s?[s]:[],...void 0!==d?[o.i18n.translate("xpack.ml.dataframe.analytics.create.unsupportedFieldsError",{defaultMessage:"Invalid. {message}",values:{message:d}})]:[]]},Object(I.jsx)(i.Fragment,null)),c.length>0&&void 0===s&&Object(I.jsx)(r.EuiText,{size:"xs"},o.i18n.translate("xpack.ml.dataframe.analytics.create.includedFieldsCount",{defaultMessage:"{numFields, plural, one {# field} other {# fields}} included in the analysis",values:{numFields:t.length}})),0===c.length&&Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.calloutTitle",{defaultMessage:"Analysis fields not available"})},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.calloutMessage",defaultMessage:"Additional data required to load analysis fields."})),c.length>0&&Object(I.jsx)(r.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardIncludesSelect"},Object(I.jsx)(Ac.a,{currentPage:b.pageIndex,"data-test-subj":"mlAnalyticsCreationAnalysisFieldsTable",checkboxDisabledCheck:Nc,columns:Rc,filters:h,items:c,itemsPerPage:b.itemsPerPage,onTableChange:t=>{a&&void 0!==e&&""!==e&&0===t.length&&(t=[e]),0===t.length?(l(Lc),u(void 0)):(l(void 0),n({includes:t}))},selectedIds:t,setCurrentPaginationData:f,singleSelection:!1,sortableProperties:p,tableItemId:"name"})),Object(I.jsx)(r.EuiSpacer,null))}),((e,t)=>e.dependentVariable===t.dependentVariable&&Object(x.isEqual)(e.includes,t.includes)&&Object(x.isEqual)(e.tableItems,t.tableItems)&&e.unsupportedFieldsError===t.unsupportedFieldsError));function zc(e){return Object.keys(e).map((t=>{const a=e[t],n=Object(yo.c)(a.type);return{id:t,schema:n,isExpandable:"boolean"!==n,isRuntimeFieldColumn:!0}}))}function Bc(e,t){const{fields:a}=ks.a;return a.filter((e=>t.includes(e.name))).map((e=>{const t=Object(yo.c)(e.type)||Object(yo.d)(e);return{id:e.name,schema:t,isExpandable:"boolean"!==t,isRuntimeFieldColumn:!1}}))}function Jc(){const[e,t]=Object(i.useState)(void 0),[a,n]=Object(i.useState)(void 0),s=Object(de.b)(),{currentSavedSearch:r,currentDataView:o,kibanaConfig:l}=s;return Object(i.useEffect)((()=>{(()=>{let e,a={};if(null!==r){const{query:i}=Object(j.f)(r),s=i.language;if(e=i.query,s===O.c.KUERY){const t=Object(v.d)(e);a=Object(v.f)(t,o)}else a=Object(v.e)(e),Object(v.c)(a,l.get("query:queryString:options"));t(a),n(e)}else t(null),n(null)})()}),[]),{savedSearchQuery:e,savedSearchQueryStr:a}}var Vc=a(229),Uc=a(60);const Gc=Object(i.memo)((({convertToJson:e,xJsonMode:t,setAdvancedRuntimeMappingsConfig:a,setIsRuntimeMappingsEditorApplyButtonEnabled:n,advancedEditorRuntimeMappingsLastApplied:i,advancedRuntimeMappingsConfig:s})=>Object(I.jsx)("div",{"data-test-subj":"mlDataFrameAnalyticsAdvancedRuntimeMappingsEditor"},Object(I.jsx)(Si.CodeEditor,{height:250,languageId:"json",onChange:t=>{if(a(t),i!==t)if(""!==t)try{const a=JSON.parse(e(t));n(Object(vo.b)(a))}catch(e){n(!1)}else n(!0);else n(!1)},options:{ariaLabel:o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeMappings.advancedEditorAriaLabel",{defaultMessage:"Advanced runtime editor"}),automaticLayout:!0,fontSize:12,scrollBeyondLastLine:!1,quickSuggestions:!0,minimap:{enabled:!1},wordWrap:"on",wrappingIndent:"indent"},value:s}))),((e,t)=>Object(x.isEqual)(qc(e),qc(t))));function qc(e){return[e.advancedEditorRuntimeMappingsLastApplied,e.advancedRuntimeMappingsConfig]}const Wc=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalTitle",{defaultMessage:"Edits will be lost"}),Hc=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalCancelButtonText",{defaultMessage:"Cancel"}),Yc=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalConfirmButtonText",{defaultMessage:"Close editor"}),$c=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeEditorSwitchModalBodyText",{defaultMessage:"The changes in the editor haven't been applied yet. By closing the editor you will lose your edits."}),Xc=({onCancel:e,onConfirm:t})=>Object(I.jsx)(r.EuiConfirmModal,{title:Wc,onCancel:e,onConfirm:t,cancelButtonText:Hc,confirmButtonText:Yc,buttonColor:"danger",defaultFocusedButton:"confirm"},Object(I.jsx)("p",null,$c)),Kc="220px",Qc=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.indexPreview.copyRuntimeMappingsClipboardTooltip",{defaultMessage:"Copy Dev Console statement of the runtime fields to the clipboard."}),Zc=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedSourceEditorApplyButtonText",{defaultMessage:"Apply changes"}),ed=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedRuntimeFieldsEditorHelpText",{defaultMessage:"The advanced editor allows you to edit the runtime fields of the source."}),td=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.advancedEditorRuntimeFieldsSwitchLabel",{defaultMessage:"Edit runtime fields"}),ad=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.runtimeFieldsLabel",{defaultMessage:"Runtime fields"}),{useXJsonMode:nd}=Uc.XJson,id=new Vc.XJsonMode,sd=({actions:e,state:t})=>{const[a,n]=Object(i.useState)(!1),[o,l]=Object(i.useState)(!1),[c,d]=Object(i.useState)(!1),[u,p]=Object(i.useState)(),{setFormState:m}=e,{jobType:b,previousRuntimeMapping:f,runtimeMappings:h}=t.form,{convertToJson:g,setXJson:j,xJson:x}=nd(h||""),v=Object(de.b)(),{currentDataView:y}=v,O=(e=!1)=>{!0===e&&(m({runtimeMappingsUpdated:!1}),j(null!=u?u:"")),n(!a),d(Object(xo.isRuntimeMappings)(h))};return Object(i.useEffect)((function(){const e=Object(ll.f)(y,h),t=JSON.stringify(e,null,2);e&&(j(t),p(t),m({runtimeMappings:e}))}),[]),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:ad},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"baseline",justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!0},Object($e.b)(h)?Object(I.jsx)(r.EuiText,{size:"s",grow:!1},Object.keys(h).join(",")):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.createWizard.noRuntimeFieldLabel",defaultMessage:"No runtime field"}),a&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(Gc,{advancedEditorRuntimeMappingsLastApplied:u,advancedRuntimeMappingsConfig:x,setIsRuntimeMappingsEditorApplyButtonEnabled:d,setAdvancedRuntimeMappingsConfig:j,convertToJson:g,xJsonMode:id}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{width:Kc}},Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs",direction:"column",justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiSwitch,{disabled:void 0===b,label:td,checked:a,onChange:()=>{a&&x!==u?l(!0):O()},"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsEditorSwitch"}),o&&Object(I.jsx)(Xc,{onCancel:()=>l(!1),onConfirm:()=>{l(!1),O(!0)}})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiCopy,{beforeMessage:Qc,textToCopy:null!=x?x:""},(e=>Object(I.jsx)(r.EuiButtonIcon,{onClick:e,iconType:"copyClipboard","aria-label":Qc})))))),a&&Object(I.jsx)(r.EuiFlexItem,{style:{width:Kc}},Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiText,{size:"xs"},ed),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiButton,{style:{width:"fit-content"},size:"s",fill:!0,onClick:()=>{const e=""===x,t=e?void 0:JSON.parse(x),a=e?"":JSON.stringify(t,null,2);m({runtimeMappings:t,runtimeMappingsUpdated:!0,previousRuntimeMapping:void 0===f&&void 0===h?t:h}),j(a),p(a),d(!1)},disabled:!c,"data-test-subj":"mlDataFrameAnalyticsRuntimeMappingsApplyButton"},Zc)))))),Object(I.jsx)(r.EuiSpacer,{size:"s"}))},rd="runtime_mapping",od=o.i18n.translate("xpack.ml.dataframe.analytics.createWizard.requiredFieldsErrorMessage",{defaultMessage:"At least one field must be included in the analysis in addition to the dependent variable."});function ld(e,t){const a=[];return Object.keys(t).forEach((n=>{const i=t[n];Object(vo.a)(i)&&wc(n,i.type,e)&&a.push({label:n})})),a}const cd=({actions:e,isClone:t,state:a,setCurrentStep:n})=>{const l=Object(de.b)(),{currentSavedSearch:c,currentDataView:d}=l,{savedSearchQuery:u,savedSearchQueryStr:p}=Jc(),[m,b]=Object(i.useState)(!1),[f,h]=Object(i.useState)(!1),[g,j]=Object(i.useState)(!1),[v,y]=Object(i.useState)([]),[E,w]=Object(i.useState)([]),[M,S]=Object(i.useState)(!1),[_,T]=Object(i.useState)(),[C,k]=Object(i.useState)(),[F,D]=Object(i.useState)(!1),[A,L]=Object(i.useState)(),{setEstimatedModelMemoryLimit:R,setFormState:N}=e,{cloneJob:P,estimatedModelMemoryLimit:z,form:B,isJobCreated:J,requestMessages:V}=a,U=Object(i.useRef)(!0),{dependentVariable:G,includes:q,jobConfigQuery:W,jobConfigQueryLanguage:H,jobConfigQueryString:Y,jobType:$,modelMemoryLimit:X,previousJobType:K,requiredFieldsError:Q,runtimeMappings:Z,previousRuntimeMapping:ee,runtimeMappingsUpdated:te,sourceIndex:ae,trainingPercent:ne,useEstimatedMml:ie}=B,se=$===pl.b.REGRESSION||$===pl.b.CLASSIFICATION,re=se&&""===G,oe=void 0!==$,le=se&&""!==G||$===pl.b.OUTLIER_DETECTION,[ce,ue]=Object(i.useState)({query:null!=Y?Y:"",language:null!=H?H:O.c.KUERY}),pe=Object(Ye.l)(),me=((e,t,a,n)=>{const[s,r]=Object(i.useState)();Object(i.useEffect)((()=>{!async function(){m(""),h(pl.d.LOADING);const t={index:e.title,body:{fields:["*"],_source:!1,query:{function_score:{query:{match_all:{}},random_score:{}}},size:500}};try{const a=(await be.ml.esSearch(t)).hits.hits.map((e=>{var t;return Object(yo.i)(null!==(t=e.fields)&&void 0!==t?t:{})})),n=Object(yo.g)(e),i=[...new Set(a.map(Object.keys).flat(1))].filter((e=>n.includes(e))).sort();h(pl.d.LOADED),r(i)}catch(e){m(Object(Re.b)(e)),h(pl.d.ERROR)}}()}),[]);const o=Object(i.useMemo)((()=>Object(yo.b)(e,n)),[e,n]),[l,c]=Object(i.useState)([]);Object(i.useEffect)((()=>{Array.isArray(s)&&c([...Bc(0,s),...o?zc(o):[]])}),[e,s,o]);const d=Object(yo.l)(l),{pagination:u,resetPagination:p,setErrorMessage:m,setRowCount:b,setRowCountRelation:f,setStatus:h,setTableItems:g,sortingColumns:j,tableItems:x}=d;Object(i.useEffect)((()=>{p()}),[JSON.stringify(t)]),Object(i.useEffect)((()=>{void 0!==s&&void 0!==t&&async function(){m(""),h(pl.d.LOADING);const a=j.reduce(((e,t)=>(e[t.id]={order:t.direction},e)),{}),n={index:e.title,body:{query:t,from:u.pageIndex*u.pageSize,size:u.pageSize,fields:[...null!=s?s:[],...Object(vo.b)(o)?Object.keys(o):[]],_source:!1,...Object.keys(a).length>0?{sort:a}:{},...Object(vo.b)(o)?{runtime_mappings:o}:{}}};try{const e=await be.ml.esSearch(n),t=e.hits.hits.map((e=>{var t;return Object(yo.i)(null!==(t=e.fields)&&void 0!==t?t:{})}));b("number"==typeof e.hits.total?e.hits.total:e.hits.total.value),f("number"==typeof e.hits.total?"eq":e.hits.total.relation),g(t),h(pl.d.LOADED)}catch(e){m(Object(Re.b)(e)),h(pl.d.ERROR)}}()}),[e.title,s,JSON.stringify([t,u,j,o])]);const v=Object(i.useMemo)((()=>new data_loader_DataLoader(e,a)),[e]);Object(i.useEffect)((()=>{d.chartsVisible&&void 0!==t&&async function(e){try{const t=await v.loadFieldHistograms(l.filter((e=>d.visibleColumns.includes(e.id))).map((e=>({fieldName:e.id,type:Object(yo.f)(e.schema)}))),e,il.a,o);d.setColumnCharts(t)}catch(e){Object(yo.k)(e,a)}}(t)}),[d.chartsVisible,e.title,JSON.stringify([t,d.visibleColumns,n])]);const y=Object(yo.m)(e,u,x);return{...d,indexPatternFields:s,renderCellValue:y}})(d,function(e,t){if(void 0!==e)return null!==e?e:t}(u,W),pe,Z),fe={...me,dataTestSubj:"mlAnalyticsCreationDataGrid",toastNotifications:pe},he=re||void 0===$||void 0!==_||void 0!==A||void 0!==Q||void 0!==C||M,ge=Object(x.debounce)((async()=>{S(!0);const e=K!==$,t=!(U.current&&X||!0!==ie),a=!U.current||!X||""===z;U.current&&(U.current=!1);const n=se&&q.length>0&&!1===q.includes(G),i=n&&Z&&Object.keys(Z).includes(G);let s=B;(i||n)&&(s=Object(x.cloneDeep)(B),s.includes=[...q,G]);const{success:r,expectedMemory:o,fieldSelection:l,errorMessage:c,noDocsContainMappedFields:d}=await bc(s);if(r){a&&R(o);const r=l.some((e=>!0===e.is_included&&!1===e.is_required)),c={...t?{modelMemoryLimit:o}:{},...i||e||n?{includes:s.includes}:{},requiredFieldsError:r?void 0:od};e&&(b(!1),T(void 0),k(void 0),D(!1),w(l||[])),N(c),S(!1)}else{const{maxDistinctValuesErrorMessage:e,unsupportedFieldsErrorMessage:a,toastNotificationDanger:n,toastNotificationWarning:i}=Mc(c,ae,$);n&&pe.addDanger(n),i&&pe.addWarning(i);const s=void 0!==$?mc.a[$]:mc.a.outlier_detection;R(s),b(!0),T(e),k(a),D(d),S(!1),N({...t?{modelMemoryLimit:s}:{}})}}),300);Object(i.useEffect)((()=>{N({sourceIndex:d.title})}),[]);const je=Object(i.useMemo)((()=>void 0!==(null==me?void 0:me.indexPatternFields)?me.indexPatternFields.map((e=>({name:e,is_included:!1,is_required:!1}))):[]),[`${null==me?void 0:me.indexPatternFields}`]);Object(i.useEffect)((()=>{"string"==typeof p&&N({jobConfigQuery:u,jobConfigQueryString:p})}),[JSON.stringify(u),p]),Object(i.useEffect)((()=>{if(se){const e=Object(ll.f)(d);let t;e&&(t=ld($,e)),(async(e,t=[])=>{h(!0),T(void 0);try{if(void 0!==d){const a=[];let n=e.dependentVariable;const{fields:i}=ks.a;let s=!0;for(const t of i)wc(t.id,t.type,$)&&(a.push({label:t.id}),e.dependentVariable===t.id&&(s=!1));Object(vo.b)(e.runtimeMappings)&&Object.keys(e.runtimeMappings).includes(B.dependentVariable)&&(s=!1,a.push({label:B.dependentVariable,key:`runtime_mapping_${B.dependentVariable}`})),s&&(n=""),y([...t,...a]),h(!1),j(!1),N({dependentVariable:n})}}catch(e){h(!1),j(!0)}})(B,t)}}),[$]);const xe=Object(i.useCallback)((async()=>{if(te){let e=!1;if(se){const t=v.filter((t=>{var a,n;return t.label===G&&null!==(a=t.key)&&void 0!==a&&a.includes(rd)&&(e=!0),!(null!==(n=t.key)&&void 0!==n&&n.includes(rd))}));if(void 0===Z&&!0===te)y(t);else if(Z){const e=ld($,Z);y([...t,...e])}}const t=q.filter((e=>!(ee&&ee[e])));if(e&&(N({dependentVariable:"",includes:t}),w(E.filter((({name:e})=>!(ee&&ee[e]))))),!e&&oe&&le){const e=Object(x.cloneDeep)(B),a=se&&Z&&Object.keys(Z).includes(G)&&e.includes.length>0&&!1===e.includes.includes(G);e.includes=a?[...t,G]:t;const{success:n,fieldSelection:i,errorMessage:s,noDocsContainMappedFields:r}=await bc(e);if(n){const e=i.some((e=>!0===e.is_included&&!1===e.is_required));let a;Object(vo.b)(Z)&&(a=i.map((e=>{var a;return void 0!==Z[e.name]&&!1===e.is_included&&null!==(a=e.reason)&&void 0!==a&&a.includes("field not in includes list")&&(t.push(e.name),e.is_included=!0),e}))),w(a||i),T(void 0),k(void 0),D(r),N({includes:t,requiredFieldsError:e?void 0:od})}else{const{maxDistinctValuesErrorMessage:e,unsupportedFieldsErrorMessage:t,toastNotificationDanger:a,toastNotificationWarning:n}=Mc(s,ae,$);a&&pe.addDanger(a),n&&pe.addWarning(n),T(e),k(t),D(r)}}}}),[JSON.stringify(Z)]);Object(i.useEffect)((()=>{xe()}),[JSON.stringify(Z)]),Object(i.useEffect)((()=>(oe&&le&&ge(),()=>{ge.cancel()})),[$,G,ne,JSON.stringify(q),Y]);const ve=Object(i.useMemo)((()=>({color:se?G:void 0,fields:E.filter((e=>"numerical"===e.feature_type&&e.is_included)).map((e=>e.name)),index:d.title,legendType:Object(Oc.a)($),searchQuery:W,runtimeMappings:Z,indexPattern:d})),[d.title,G,E,se,W,$]),ye=Object(i.useMemo)((()=>($===pl.b.OUTLIER_DETECTION||se&&!re)&&ve.fields.length>1),[re,$,ve.fields.length]);if(void 0===u)return null;const Oe=E.length>0&&!F?E:je;return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(pc,{messages:V}),Object(I.jsx)(Ic,{jobType:$}),Object(I.jsx)(Cc,{type:$,setFormState:N}),null===u&&Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.sourceQueryLabel",{defaultMessage:"Query"}),fullWidth:!0},Object(I.jsx)(tl,{indexPattern:d,setSearchQuery:e=>{e.query&&N({jobConfigQuery:e.query,jobConfigQueryLanguage:e.language,jobConfigQueryString:e.queryString}),ue({query:e.queryString,language:e.language})},query:ce})),(t&&P||!t)&&Object(I.jsx)(sd,{actions:e,state:a}),Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(i.Fragment,null,null!==u&&Object(I.jsx)(r.EuiText,null,o.i18n.translate("xpack.ml.dataframe.analytics.create.savedSearchLabel",{defaultMessage:"Saved search"})),Object(I.jsx)(r.EuiBadge,{color:"hollow"},null!==u?null==c?void 0:c.attributes.title:d.title)),fullWidth:!0},Object(I.jsx)(yo.a,fe)),se&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:o.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableLabel",{defaultMessage:"Dependent variable"}),helpText:0===v.length&&!1===g&&d&&o.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsNoNumericalFields",{defaultMessage:"No numeric type fields were found for this data view."}),isInvalid:void 0!==_,error:[...!0===g?[Object(I.jsx)(i.Fragment,null,o.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableOptionsFetchError",{defaultMessage:"There was a problem fetching fields. Please refresh the page and try again."}))]:[],...!0===m&&void 0!==_?[Object(I.jsx)(i.Fragment,null,o.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableMaxDistictValuesError",{defaultMessage:"Invalid. {message}",values:{message:_}}))]:[]]},Object(I.jsx)(r.EuiComboBox,{fullWidth:!0,"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableInputAriaLabel",{defaultMessage:"Enter field to be used as dependent variable."}),placeholder:$===pl.b.REGRESSION?o.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableRegressionPlaceholder",{defaultMessage:"Select the numeric field that you want to predict."}):o.i18n.translate("xpack.ml.dataframe.analytics.create.dependentVariableClassificationPlaceholder",{defaultMessage:"Select the numeric, categorical, or boolean field that you want to predict."}),isDisabled:J,isLoading:f,singleSelection:!0,options:v,selectedOptions:G?[{label:G}]:[],onChange:e=>{N({dependentVariable:e[0].label||""})},isClearable:!1,isInvalid:""===G,"data-test-subj":"mlAnalyticsCreateJobWizardDependentVariableSelect"+(f?" loading":" loaded")}))),Object(I.jsx)(Pc,{dependentVariable:G,includes:q,isJobTypeWithDepVar:se,minimumFieldsRequiredMessage:A,setMinimumFieldsRequiredMessage:L,tableItems:U.current?E:Oe,unsupportedFieldsError:C,setUnsupportedFieldsError:k,setFormState:N}),Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,isInvalid:void 0!==Q,error:o.i18n.translate("xpack.ml.dataframe.analytics.create.requiredFieldsError",{defaultMessage:"Invalid. {message}",values:{message:Q}})},Object(I.jsx)(i.Fragment,null)),Object(I.jsx)(r.EuiSpacer,null),ye&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFormRow,{"data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixFormRow",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabel",{defaultMessage:"Scatterplot matrix"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.scatterplotMatrixLabelHelpText",{defaultMessage:"Visualizes the relationships between pairs of selected included fields."}),fullWidth:!0},Object(I.jsx)(i.Fragment,null)),Object(I.jsx)(r.EuiPanel,{paddingSize:"m","data-test-subj":"mlAnalyticsCreateJobWizardScatterplotMatrixPanel"},Object(I.jsx)(Ro,ve)),Object(I.jsx)(r.EuiSpacer,null)),se&&Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:o.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentLabel",{defaultMessage:"Training percent"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.trainingPercentHelpText",{defaultMessage:"Defines the percentage of eligible documents that will be used for training."})},Object(I.jsx)(r.EuiRange,{fullWidth:!0,min:pl.k,max:pl.j,step:1,showLabels:!0,showRange:!0,showValue:!0,value:ne,onChange:e=>N({trainingPercent:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardTrainingPercentSlider"})),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(_c,{isDisabled:he,onClick:()=>{n(Cd.ADVANCED)}}))},dd=({actions:e,state:t,setCurrentStep:a,step:n,stepActivated:i,isClone:s})=>{const o=n===Cd.CONFIGURATION,l=n!==Cd.CONFIGURATION&&!0===i,c=`mlAnalyticsCreateJobWizardConfigurationStep${o?" active":""}${l?" summary":""}`;return Object(I.jsx)(r.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":c},o&&Object(I.jsx)(cd,{actions:e,isClone:s,state:t,setCurrentStep:a}),l&&Object(I.jsx)(yc,{setCurrentStep:a,state:t}))},ud=({actions:e,state:t,advancedParamErrors:a})=>{const{setFormState:n}=e,{alpha:s,downsampleFactor:l,eta:c,etaGrowthRatePerTree:d,featureBagFraction:u,gamma:p,lambda:m,maxOptimizationRoundsPerHyperparameter:b,maxTrees:f,softTreeDepthLimit:h,softTreeDepthTolerance:g}=t.form;return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaLabel",{defaultMessage:"Lambda"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaHelpText",{defaultMessage:"A multiplier of the leaf weights in loss calculations. Must be a nonnegative value."}),isInvalid:void 0!==a[pl.a.LAMBDA],error:a[pl.a.LAMBDA]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.lambdaInputAriaLabel",{defaultMessage:"A multiplier of leaf weights in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutLambdaInput",onChange:e=>n({lambda:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:gd(m)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesLabel",{defaultMessage:"Max trees"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesText",{defaultMessage:"The maximum number of decision trees in the forest."}),isInvalid:void 0!==a[pl.a.MAX_TREES],error:a[pl.a.MAX_TREES]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.maxTreesInputAriaLabel",{defaultMessage:"The maximum number of decision trees in the forest."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutMaxTreesInput",onChange:e=>n({maxTrees:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==f&&!Number.isInteger(f),step:1,min:1,max:2e3,value:gd(f)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.gammaLabel",{defaultMessage:"Gamma"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.gammaText",{defaultMessage:"A multiplier of the tree size in loss calcuations. Must be nonnegative value."}),isInvalid:void 0!==a[pl.a.GAMMA],error:a[pl.a.GAMMA]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.gammaInputAriaLabel",{defaultMessage:"A multiplier of the tree size in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardGammaInput",onChange:e=>n({gamma:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:gd(p)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.etaLabel",{defaultMessage:"Eta"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.etaText",{defaultMessage:"The shrinkage applied to the weights. Must be between 0.001 and 1."}),isInvalid:void 0!==a[pl.a.ETA],error:a[pl.a.ETA]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.etaInputAriaLabel",{defaultMessage:"The shrinkage applied to the weights."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaInput",onChange:e=>n({eta:""===e.target.value?void 0:+e.target.value}),step:.001,min:.001,max:1,value:gd(c)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionLabel",{defaultMessage:"Feature bag fraction"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionText",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split."}),isInvalid:void 0!==a[pl.a.FEATURE_BAG_FRACTION],error:a[pl.a.FEATURE_BAG_FRACTION]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.featureBagFractionInputAriaLabel",{defaultMessage:"The fraction of features used when selecting a random bag for each candidate split"}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureBagFractionInput",onChange:e=>n({featureBagFraction:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==u&&(u>1||u<=0),step:.001,max:1,value:gd(u)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.alphaLabel",{defaultMessage:"Alpha"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.alphaText",{defaultMessage:"A multiplier of the tree depth in loss calculations. Must be greater than or equal to 0."}),isInvalid:void 0!==a[pl.a.ALPHA],error:a[pl.a.ALPHA]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.alphaInputAriaLabel",{defaultMessage:"A multiplier of the tree depth in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardAlphaInput",onChange:e=>n({alpha:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:gd(s)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorLabel",{defaultMessage:"Downsample factor"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorText",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training. Must be between 0 and 1."}),isInvalid:void 0!==a[pl.a.DOWNSAMPLE_FACTOR],error:a[pl.a.DOWNSAMPLE_FACTOR]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.downsampleFactorInputAriaLabel",{defaultMessage:"The fraction of data used to compute derivatives of the loss function for tree training."}),"data-test-subj":"mlAnalyticsCreateJobWizardDownsampleFactorInput",onChange:e=>n({downsampleFactor:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:gd(l)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeLabel",{defaultMessage:"Eta growth rate per tree"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeText",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest. Must be between 0.5 and 2."}),isInvalid:void 0!==a[pl.a.ETA_GROWTH_RATE_PER_TREE],error:a[pl.a.ETA_GROWTH_RATE_PER_TREE]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.etaGrowthRatePerTreeInputAriaLabel",{defaultMessage:"The rate at which eta increases for each new tree that is added to the forest."}),"data-test-subj":"mlAnalyticsCreateJobWizardEtaGrowthRatePerTreeInput",onChange:e=>n({etaGrowthRatePerTree:""===e.target.value?void 0:+e.target.value}),step:.001,min:.5,max:2,value:gd(d)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterLabel",{defaultMessage:"Max optimization rounds per hyperparameter"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterText",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter."}),isInvalid:void 0!==a[pl.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER],error:a[pl.a.MAX_OPTIMIZATION_ROUNDS_PER_HYPERPARAMETER]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.maxOptimizationRoundsPerHyperparameterInputAriaLabel",{defaultMessage:"The maximum number of optimization rounds for each undefined hyperparameter. Must be an integer between 0 and 20."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxOptimizationRoundsPerHyperparameterInput",onChange:e=>n({maxOptimizationRoundsPerHyperparameter:""===e.target.value?void 0:+e.target.value}),min:0,max:20,step:1,value:gd(b)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitLabel",{defaultMessage:"Soft tree depth limit"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitText",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations. Must be greater than or equal to 0. "}),isInvalid:void 0!==a[pl.a.SOFT_TREE_DEPTH_LIMIT],error:a[pl.a.SOFT_TREE_DEPTH_LIMIT]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthLimitInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthLimitInput",onChange:e=>n({softTreeDepthLimit:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,value:gd(h)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceLabel",{defaultMessage:"Soft tree depth tolerance"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceText",{defaultMessage:"Controls how quickly the loss increases when tree depths exceed soft limits. The smaller the value, the faster the loss increases. Must be greater than or equal to 0.01. "}),isInvalid:void 0!==a[pl.a.SOFT_TREE_DEPTH_TOLERANCE],error:a[pl.a.SOFT_TREE_DEPTH_TOLERANCE]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.softTreeDepthToleranceInputAriaLabel",{defaultMessage:"Decision trees that exceed this depth are penalized in loss calculations."}),"data-test-subj":"mlAnalyticsCreateJobWizardSoftTreeDepthToleranceInput",onChange:e=>n({softTreeDepthTolerance:""===e.target.value?void 0:+e.target.value}),step:.001,min:.01,value:gd(g)}))))};var pd=a(311);const md=({actions:e,state:t,advancedParamErrors:a})=>{const{setFormState:n}=e,{method:s,nNeighbors:l,outlierFraction:c,standardizationEnabled:d}=t.form;return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.methodLabel",{defaultMessage:"Method"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.methodHelpText",{defaultMessage:"Sets the method that outlier detection uses. If not set, uses an ensemble of different methods, normalizes and combines their individual outlier scores to obtain the overall outlier score. It is recommended to use the ensemble method."}),isInvalid:void 0!==a[pl.a.METHOD],error:a[pl.a.METHOD]},Object(I.jsx)(r.EuiSelect,{options:Object.values(pl.f).map((e=>({value:e,text:e}))),value:s,hasNoInitialSelection:!0,onChange:e=>{n({method:e.target.value})},"data-test-subj":"mlAnalyticsCreateJobWizardMethodInput"}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsLabel",{defaultMessage:"N neighbors"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsHelpText",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score. When not set, different values are used for different ensemble members. Must be a positive integer."}),isInvalid:void 0!==a[pl.a.N_NEIGHBORS],error:a[pl.a.N_NEIGHBORS]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.nNeighborsInputAriaLabel",{defaultMessage:"The value for how many nearest neighbors each method of outlier detection uses to calculate its outlier score."}),"data-test-subj":"mlAnalyticsCreateJobWizardnNeighborsInput",onChange:e=>n({nNeighbors:""===e.target.value?void 0:+e.target.value}),step:1,min:1,value:gd(l)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionLabel",{defaultMessage:"Outlier fraction"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionHelpText",{defaultMessage:"Sets the proportion of the data set that is assumed to be outlying prior to outlier detection."}),isInvalid:void 0!==a[pl.a.OUTLIER_FRACTION],error:a[pl.a.OUTLIER_FRACTION]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.outlierFractionInputAriaLabel",{defaultMessage:"Sets the proportion of the data set that is assumed to be outlying prior to outlier detection."}),"data-test-subj":"mlAnalyticsCreateJobWizardoutlierFractionInput",onChange:e=>n({outlierFraction:""===e.target.value?void 0:+e.target.value}),step:.001,min:0,max:1,value:gd(c)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledLabel",{defaultMessage:"Standardization enabled"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledHelpText",{defaultMessage:"If true, the following operation is performed on the columns before computing outlier scores: (x_i - mean(x_i)) / sd(x_i)."})},Object(I.jsx)(r.EuiSelect,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledInputAriaLabel",{defaultMessage:"Sets standardization enabled setting."}),"data-test-subj":"mlAnalyticsCreateJobWizardStandardizationEnabledInput",options:[{value:"true",text:o.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledTrueValue",{defaultMessage:"True"})},{value:"false",text:o.i18n.translate("xpack.ml.dataframe.analytics.create.standardizationEnabledFalseValue",{defaultMessage:"False"})}],value:d,hasNoInitialSelection:!0,onChange:e=>{n({standardizationEnabled:e.target.value})}}))))},bd={label:o.i18n.translate("xpack.ml.dataframe.analytics.create.allClassesLabel",{defaultMessage:"All classes"}),value:-1},fd=Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassTypeWarning",defaultMessage:"Value must be an integer of -1 or greater, where -1 indicates all classes."});function hd(e){return-1===e?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})," ",Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.allClassesMessage",defaultMessage:"If you have a large number of classes there could be a significant effect on the size of your destination index."})):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.numTopClassesHelpText",defaultMessage:"The number of categories for which the predicted probabilities are reported."})}function gd(e){return void 0===e?"":+e}const jd=({actions:e,state:t,setCurrentStep:a})=>{var n;const[l,c]=Object(i.useState)({}),[u,p]=Object(i.useState)(!1),{services:{docLinks:m}}=Object(d.b)(),b=m.links.ml.classificationAucRoc,{setEstimatedModelMemoryLimit:f,setFormState:h}=e,{form:g,isJobCreated:j,estimatedModelMemoryLimit:x}=t,{alpha:v,computeFeatureInfluence:y,downsampleFactor:O,eta:E,etaGrowthRatePerTree:w,featureBagFraction:M,featureInfluenceThreshold:S,gamma:_,jobType:T,lambda:C,maxNumThreads:k,maxOptimizationRoundsPerHyperparameter:F,maxTrees:D,method:A,modelMemoryLimit:L,modelMemoryLimitValidationResult:R,nNeighbors:N,numTopClasses:P,numTopFeatureImportanceValues:z,numTopFeatureImportanceValuesValid:B,outlierFraction:J,predictionFieldName:V,randomizeSeed:U,softTreeDepthLimit:G,softTreeDepthTolerance:q,useEstimatedMml:W}=g,[H,Y]=Object(i.useState)([bd]),[$,K]=Object(i.useState)(function(e){const t=[];return-1===e?t.push(bd):void 0!==e&&t.push({label:`${e}`}),t}(P)),Q=$[0]&&(null!==(n=$[0].value)&&void 0!==n?n:Number($[0].label)),Z=void 0!==(ee=Q)&&(isNaN(ee)||ee<-1||ee-Math.floor(ee)!=0);var ee;const te=Object(i.useMemo)((()=>Object(pd.a)(R)),[R]),ae=T===pl.b.REGRESSION||T===pl.b.CLASSIFICATION,ne=null!==R&&(void 0!==R.invalidUnits||!0===R.required),ie=Z||ne||Object.keys(l).length>0||!0===u||0===k;Object(i.useEffect)((()=>{p(!0),async function(){const{success:e,errorMessage:t,errorReason:a,expectedMemory:n}=await bc(g),i={};e?L!==n&&(f(n),!0===W&&h({modelMemoryLimit:n})):Object.values(pl.a).forEach((e=>{t.includes(`[${e}]`)?i[e]=t:null!=a&&a.includes(`[${e}]`)&&(i[e]=a)})),p(!1),c(i)}()}),[v,O,E,w,M,S,_,C,k,F,D,A,N,P,z,J,U,G,q]);const se=Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabel",{defaultMessage:"Compute feature influence"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceLabelHelpText",{defaultMessage:"Specifies whether the feature influence calculation is enabled. Defaults to true."})},Object(I.jsx)(r.EuiSelect,{"data-test-subj":"mlAnalyticsCreateJobWizardComputeFeatureInfluenceLabelInput",options:[{value:"true",text:o.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceTrueValue",{defaultMessage:"True"})},{value:"false",text:o.i18n.translate("xpack.ml.dataframe.analytics.create.computeFeatureInfluenceFalseValue",{defaultMessage:"False"})}],value:y,hasNoInitialSelection:!1,onChange:e=>{h({computeFeatureInfluence:e.target.value})}}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdLabel",{defaultMessage:"Feature influence threshold"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.featureInfluenceThresholdHelpText",{defaultMessage:"The minimum outlier score that a document needs to have in order to calculate its feature influence score. Value range: 0-1. Defaults to 0.1."}),isInvalid:void 0!==l[pl.a.FEATURE_INFLUENCE_THRESHOLD],error:l[pl.a.FEATURE_INFLUENCE_THRESHOLD]},Object(I.jsx)(r.EuiFieldNumber,{onChange:e=>h({featureInfluenceThreshold:""===e.target.value?void 0:+e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardFeatureInfluenceThresholdInput",min:0,max:1,step:.001,value:gd(S)})))),re=Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesLabel",{defaultMessage:"Feature importance values"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesHelpText",{defaultMessage:"Specify the maximum number of feature importance values per document to return."}),isInvalid:!1===B,error:[...!1===B?[Object(I.jsx)(i.Fragment,null,o.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesErrorText",{defaultMessage:"Invalid maximum number of feature importance values."}))]:[]]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.numTopFeatureImportanceValuesInputAriaLabel",{defaultMessage:"Maximum number of feature importance values per document."}),"data-test-subj":"mlAnalyticsCreateJobFlyoutnumTopFeatureImportanceValuesInput",isInvalid:!1===B,min:pl.e,onChange:e=>h({numTopFeatureImportanceValues:""===e.target.value?void 0:+e.target.value}),step:1,value:gd(z)}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameLabel",{defaultMessage:"Prediction field name"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.predictionFieldNameHelpText",{defaultMessage:"Defines the name of the prediction field in the results. Defaults to <dependent_variable>_prediction."})},Object(I.jsx)(r.EuiFieldText,{disabled:j,value:V,onChange:e=>h({predictionFieldName:e.target.value}),"data-test-subj":"mlAnalyticsCreateJobWizardPredictionFieldNameInput"}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedLabel",{defaultMessage:"Randomize seed"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedText",{defaultMessage:"The seed for the random generator used to pick training data."}),isInvalid:void 0!==l[pl.a.RANDOMIZE_SEED],error:l[pl.a.RANDOMIZE_SEED]},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.randomizeSeedInputAriaLabel",{defaultMessage:"The seed for the random generator used to pick training data."}),"data-test-subj":"mlAnalyticsCreateJobWizardRandomizeSeedInput",onChange:e=>h({randomizeSeed:""===e.target.value?void 0:+e.target.value}),isInvalid:void 0!==U&&"number"!=typeof U,value:gd(U),step:1}))));return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"xs"},Object(I.jsx)("h3",null,o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigSectionTitle",{defaultMessage:"Advanced configuration"}))),Object(I.jsx)(r.EuiFlexGrid,{columns:3},T===pl.b.OUTLIER_DETECTION&&se,ae&&re,T===pl.b.CLASSIFICATION&&Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesLabel",{defaultMessage:"Top classes"}),helpText:hd(Q),isInvalid:0===Q||Z,error:[...0===Q?[(oe=b,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.zeroClassesMessage",defaultMessage:"To evaluate the {wikiLink}, select all classes or a value greater than the total number of categories.",values:{wikiLink:Object(I.jsx)(r.EuiLink,{href:oe,target:"_blank",external:!0},o.i18n.translate("xpack.ml.dataframe.analytics.create.aucRocLabel",{defaultMessage:"AUC ROC"}))}}))]:[],...Z?[fd]:[]]},Object(I.jsx)(r.EuiComboBox,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.numTopClassesInputAriaLabel",{defaultMessage:"The number of categories for which the predicted probabilities are reported"}),singleSelection:!0,options:H,selectedOptions:$,onCreateOption:(e,t=[])=>{const a=e.trim().toLowerCase();if(""===a)return;const n={label:e};-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&Y([...H,n]),K([n])},onChange:e=>{K(e)},isClearable:!0,isInvalid:void 0!==Q&&Q<-1,"data-test-subj":"mlAnalyticsCreateJobWizardnumTopClassesInput"}))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitLabel",{defaultMessage:"Model memory limit"}),isInvalid:null!==R,error:te,helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryLimitHelpText",{defaultMessage:"The approximate maximum amount of memory resources that are permitted for analytical processing."})},Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFieldText,{placeholder:void 0!==T?mc.a[T]:mc.a.outlier_detection,disabled:j||W,value:W?x:L||"",onChange:e=>h({modelMemoryLimit:e.target.value}),isInvalid:null!==R,"data-test-subj":"mlAnalyticsCreateJobWizardModelMemoryInput"}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiSwitch,{disabled:j,name:"mlDataFrameAnalyticsUseEstimatedMml",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.useEstimatedMmlLabel",{defaultMessage:"Use estimated model memory limit"}),checked:!0===W,onChange:()=>h({useEstimatedMml:!W}),"data-test-subj":"mlAnalyticsCreateJobWizardUseEstimatedMml"})))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsLabel",{defaultMessage:"Maximum number of threads"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsHelpText",{defaultMessage:"The maximum number of threads to be used by the analysis. The default value is 1."}),isInvalid:0===k,error:0===k&&o.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsError",{defaultMessage:"The minimum value is 1."})},Object(I.jsx)(r.EuiFieldNumber,{"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.maxNumThreadsInputAriaLabel",{defaultMessage:"The maximum number of threads to be used by the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardMaxNumThreadsInput",min:1,onChange:e=>h({maxNumThreads:""===e.target.value?void 0:+e.target.value}),step:1,value:gd(k)})))),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiAccordion,{id:"hyper-parameters",buttonContent:Object(I.jsx)(r.EuiTitle,{size:"xs"},Object(I.jsx)("h3",null,o.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersSectionTitle",{defaultMessage:"Hyperparameters"}))),initialIsOpen:!1,"data-test-subj":"mlAnalyticsCreateJobWizardHyperParametersSection"},Object(I.jsx)(r.EuiFlexGrid,{columns:3},T===pl.b.OUTLIER_DETECTION&&Object(I.jsx)(md,{actions:e,state:t,advancedParamErrors:l}),ae&&Object(I.jsx)(ud,{actions:e,state:t,advancedParamErrors:l}))),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(_c,{isDisabled:ie,onClick:()=>{h({numTopClasses:!1===Z?Q:void 0}),a(Cd.DETAILS)}}));var oe};function xd(e){return"number"==typeof e?`${e}`:mc.c}const vd=({setCurrentStep:e,state:t})=>{const{form:a,isJobCreated:n}=t,{computeFeatureInfluence:s,dependentVariable:l,eta:c,featureBagFraction:d,featureInfluenceThreshold:u,gamma:p,jobType:m,lambda:b,method:f,maxNumThreads:h,maxTrees:g,modelMemoryLimit:j,nNeighbors:x,numTopClasses:v,numTopFeatureImportanceValues:y,outlierFraction:O,predictionFieldName:E,randomizeSeed:w,standardizationEnabled:M}=a,S=m===pl.b.REGRESSION||m===pl.b.CLASSIFICATION,_=[],T=[],C=[],k=[],F=[],D=[];return m===pl.b.OUTLIER_DETECTION&&(_.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.computeFeatureInfluence",{defaultMessage:"Compute feature influence"}),description:s}),T.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureInfluenceThreshold",{defaultMessage:"Feature influence threshold"}),description:xd(u)}),C.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:`${j}`}),k.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.nNeighbors",{defaultMessage:"N neighbors"}),description:xd(x)},{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.outlierFraction",{defaultMessage:"Outlier fraction"}),description:xd(O)}),F.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.method",{defaultMessage:"Method"}),description:void 0!==f?f:mc.c}),D.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.standardizationEnabled",{defaultMessage:"Standardization enabled"}),description:`${M}`})),S&&(_.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopFeatureImportanceValues",{defaultMessage:"Top feature importance values"}),description:`${y}`}),k.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.lambdaFields",{defaultMessage:"Lambda"}),description:xd(b)},{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.eta",{defaultMessage:"Eta"}),description:xd(c)}),T.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.predictionFieldName",{defaultMessage:"Prediction field name"}),description:E||`${l}_prediction`},{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.randomizedSeed",{defaultMessage:"Randomized seed"}),description:xd(w)}),F.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxTreesFields",{defaultMessage:"Max trees"}),description:xd(g)},{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.featureBagFraction",{defaultMessage:"Feature bag fraction"}),description:xd(d)}),C.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.modelMemoryLimit",{defaultMessage:"Model memory limit"}),description:`${j}`}),D.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.gamma",{defaultMessage:"Gamma"}),description:xd(p)})),m===pl.b.CLASSIFICATION&&C.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.numTopClasses",{defaultMessage:"Top classes"}),description:-1===v?o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.allClasses",{defaultMessage:"All classes"}):xd(v)}),void 0!==h&&_.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.maxNumThreads",{defaultMessage:"Maximum number of threads"}),description:`${h}`}),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiTitle,{size:"xs"},Object(I.jsx)("h3",null,o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedConfigDetailsTitle",{defaultMessage:"Advanced configuration"}))),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:_})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:T})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:C}))),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiTitle,{size:"xs"},Object(I.jsx)("h3",null,o.i18n.translate("xpack.ml.dataframe.analytics.create.hyperParametersDetailsTitle",{defaultMessage:"Hyperparameters"}))),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:k})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:F})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:D}))),Object(I.jsx)(r.EuiSpacer,null),!n&&Object(I.jsx)(r.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(Cd.ADVANCED)}},o.i18n.translate("xpack.ml.dataframe.analytics.create.advancedDetails.editButtonText",{defaultMessage:"Edit"})))},yd=({actions:e,state:t,step:a,setCurrentStep:n,stepActivated:i})=>{const s=a===Cd.ADVANCED,o=a!==Cd.ADVANCED&&!0===i,l=`mlAnalyticsCreateJobWizardAdvancedStep${s?" active":""}${o?" summary":""}`;return Object(I.jsx)(r.EuiForm,{"data-test-subj":l},s&&Object(I.jsx)(jd,{actions:e,state:t,setCurrentStep:n}),o&&Object(I.jsx)(vd,{setCurrentStep:n,state:t}))},Od=({setCurrentStep:e,state:t})=>{const{form:a,isJobCreated:n}=t,{description:s,jobId:l,destinationIndex:c,resultsField:d}=a,u=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobId",{defaultMessage:"Job ID"}),description:l}];void 0!==d&&"string"==typeof d&&""!==d.trim()&&u.push({title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.resultsField",{defaultMessage:"Results field"}),description:d});const p=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.jobDescription",{defaultMessage:"Job description"}),description:s}],m=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.configDetails.destIndex",{defaultMessage:"Destination index"}),description:c||""}];return Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{style:{width:"70%"},justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:u})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:p})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:m}))),Object(I.jsx)(r.EuiSpacer,null),!n&&Object(I.jsx)(r.EuiButtonEmpty,{iconType:"pencil",size:"s",onClick:()=>{e(Cd.DETAILS)}},o.i18n.translate("xpack.ml.dataframe.analytics.create.detailsDetails.editButtonText",{defaultMessage:"Edit"})))},Ed=o.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexHelpText",{defaultMessage:"An index with this name already exists. Be aware that running this analytics job will modify this destination index."}),wd=({actions:e,state:t,setCurrentStep:a})=>{const{services:{docLinks:n,notifications:s}}=Object(d.b)(),l=n.links.apis.createIndex,{setFormState:c}=e,{form:u,cloneJob:p,hasSwitchedToEditor:m,isJobCreated:b}=t,{description:f,destinationIndex:h,destinationIndexNameEmpty:g,destinationIndexNameExists:j,destinationIndexNameValid:v,jobId:y,jobIdEmpty:O,jobIdExists:E,jobIdInvalidMaxLength:w,jobIdValid:M,resultsField:S}=u,[_,T]=Object(i.useState)(void 0===p&&!1===m),[C,k]=Object(i.useState)(void 0===p&&!1===m&&void 0===S||void 0!==p&&"ml"===S),F=Object(i.useRef)(null),D=!0===O||!0===E||!1===M||!0===g||!1===v,A=Object(x.debounce)((async()=>{try{const e=await be.ml.checkIndicesExists({indices:[h]});c({destinationIndexNameExists:e[h].exists})}catch(e){s.toasts.addDanger(o.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingIndexExists",{defaultMessage:"The following error occurred getting the existing index names: {error}",values:{error:Object(Re.b)(e)}}))}}),400),L=Object(i.useMemo)((()=>Object(x.debounce)((async()=>{try{const e=await be.ml.dataFrameAnalytics.jobsExist([y],!0);c({jobIdExists:e[y].exists})}catch(e){s.toasts.addDanger(o.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingJobIdExists",{defaultMessage:"The following error occurred checking if job id exists: {error}",values:{error:Object(Re.b)(e)}}))}}),400)),[y]);return Object(i.useEffect)((()=>(!0===M?L():"string"==typeof y&&""===y.trim()&&!0===E&&c({jobIdExists:!1}),()=>{L.cancel()})),[y]),Object(i.useEffect)((()=>(!0===v?A():"string"==typeof h&&""===h.trim()&&!0===j&&c({destinationIndexNameExists:!1}),()=>{A.cancel()})),[h]),Object(i.useEffect)((()=>{!0===_&&!O&&M?c({destinationIndex:y}):!1===_&&!1===m&&c({destinationIndex:""})}),[_,y]),Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:o.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdLabel",{defaultMessage:"Job ID"}),isInvalid:!O&&!M||E||w,error:[...O||M?[]:[o.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidError",{defaultMessage:"Must contain lowercase alphanumeric characters (a-z and 0-9), hyphens, and underscores only and must start and end with alphanumeric characters."})],...E?[o.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdExistsError",{defaultMessage:"An analytics job with this ID already exists."})]:[],...w?[o.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInvalidMaxLengthErrorMessage",{defaultMessage:"Job ID must be no more than {maxLength, plural, one {# character} other {# characters}} long.",values:{maxLength:ji.b}})]:[]]},Object(I.jsx)(r.EuiFieldText,{fullWidth:!0,inputRef:e=>{e&&(F.current=e)},disabled:b,placeholder:o.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdPlaceholder",{defaultMessage:"Job ID"}),value:y,onChange:e=>c({jobId:e.target.value}),"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.jobIdInputAriaLabel",{defaultMessage:"Choose a unique analytics job ID."}),isInvalid:!O&&!M||E||O,"data-test-subj":"mlAnalyticsCreateJobFlyoutJobIdInput"})),Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:o.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.label",{defaultMessage:"Job description"})},Object(I.jsx)(r.EuiTextArea,{fullWidth:!0,value:f,placeholder:o.i18n.translate("xpack.ml.dataframe.analytics.create.jobDescription.helpText",{defaultMessage:"Optional descriptive text"}),rows:2,onChange:e=>{const t=e.target.value;c({description:t})},"data-test-subj":"mlDFAnalyticsJobCreationJobDescription"})),Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,helpText:!0===_&&j&&Ed},Object(I.jsx)(r.EuiSwitch,{disabled:b,name:"mlDataFrameAnalyticsDestIndexSameAsId",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.DestIndexSameAsIdLabel",{defaultMessage:"Destination index same as job ID"}),checked:!0===_,onChange:()=>T(!_),"data-test-subj":"mlAnalyticsCreateJobWizardDestIndexSameAsIdSwitch"})),!1===_&&Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:o.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexLabel",{defaultMessage:"Destination index"}),isInvalid:g||!g&&!v,helpText:j&&Ed,error:!g&&!v&&[Object(I.jsx)(i.Fragment,null,o.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexInvalidError",{defaultMessage:"Invalid destination index name."}),Object(I.jsx)("br",null),Object(I.jsx)(r.EuiLink,{href:l,target:"_blank"},o.i18n.translate("xpack.ml.dataframe.stepDetailsForm.destinationIndexInvalidErrorLink",{defaultMessage:"Learn more about index name limitations."})))]},Object(I.jsx)(r.EuiFieldText,{fullWidth:!0,disabled:b,placeholder:"destination index",value:h,onChange:e=>c({destinationIndex:e.target.value}),"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexInputAriaLabel",{defaultMessage:"Choose a unique destination index name."}),isInvalid:!g&&!v,"data-test-subj":"mlAnalyticsCreateJobFlyoutDestinationIndexInput"})),Object(I.jsx)(r.EuiFormRow,{fullWidth:!0},Object(I.jsx)(r.EuiSwitch,{disabled:b,name:"mlDataFrameAnalyticsUseResultsFieldDefault",label:o.i18n.translate("xpack.ml.dataframe.analytics.create.UseResultsFieldDefaultLabel",{defaultMessage:'Use results field default value "{defaultValue}"',values:{defaultValue:"ml"}}),checked:!0===C,onChange:()=>{!0==!C&&c({resultsField:void 0}),k(!C)},"data-test-subj":"mlAnalyticsCreateJobWizardUseResultsFieldDefault"})),!1===C&&Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:o.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldLabel",{defaultMessage:"Results field"}),helpText:o.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldHelpText",{defaultMessage:"Defines the name of the field in which to store the results of the analysis. Defaults to ml."})},Object(I.jsx)(r.EuiFieldText,{disabled:b,placeholder:"results field",value:S,onChange:e=>c({resultsField:e.target.value}),"aria-label":o.i18n.translate("xpack.ml.dataframe.analytics.create.resultsFieldInputAriaLabel",{defaultMessage:"The name of the field in which to store the results of the analysis."}),"data-test-subj":"mlAnalyticsCreateJobWizardResultsFieldInput"})),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(_c,{isDisabled:D,onClick:()=>{a(Cd.VALIDATION)}}))},Md=({actions:e,state:t,setCurrentStep:a,step:n,stepActivated:i})=>{const s=n===Cd.DETAILS,o=n!==Cd.DETAILS&&!0===i,l=`mlAnalyticsCreateJobWizardDetailsStep${s?" active":""}${o?" summary":""}`;return Object(I.jsx)(r.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":l},s&&Object(I.jsx)(wd,{actions:e,state:t,setCurrentStep:a}),o&&Object(I.jsx)(Od,{setCurrentStep:a,state:t}))},Sd=({checksInProgress:e,validationMessages:t,setCurrentStep:a})=>{const n=t.map(((e,t)=>Object(I.jsx)(Mi,h()({key:`${e.id}_${t}`},e))));return Object(I.jsx)(s.a.Fragment,null,e&&Object(I.jsx)(r.EuiLoadingSpinner,{size:"xl"}),!e&&Object(I.jsx)(s.a.Fragment,null,n,Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(_c,{isDisabled:!1,onClick:()=>{a(Cd.CREATE)}})))},_d=({setCurrentStep:e,state:t,validationSummary:a})=>{const{isJobCreated:n}=t,i=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.successfulChecks",{defaultMessage:"Successful checks"}),description:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"s"},a.success)),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIcon,{type:"check"}))))}],l=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.create.validatioinDetails.warnings",{defaultMessage:"Warnings"}),description:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"s"},a.warning)),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIcon,{type:"alert"}))))}];return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{style:{width:"70%"}},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{compressed:!0,listItems:i})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiDescriptionList,{style:{wordBreak:"break-word"},compressed:!0,listItems:l}))),Object(I.jsx)(r.EuiSpacer,null),!n&&Object(I.jsx)(r.EuiButtonEmpty,{size:"s",onClick:()=>{e(Cd.VALIDATION)}},o.i18n.translate("xpack.ml.dataframe.analytics.create.validationDetails.viewButtonText",{defaultMessage:"View"})))},Td=({state:e,setCurrentStep:t,step:a,stepActivated:n})=>{const[s,l]=Object(i.useState)(!1),[c,u]=Object(i.useState)([]),[p,m]=Object(i.useState)(),{form:b,jobConfig:f,isAdvancedEditorEnabled:h}=e,{dependentVariable:g,jobType:j,trainingPercent:v,numTopFeatureImportanceValues:y,numTopClasses:O,includes:E}=b,w=a===Cd.VALIDATION,M=a!==Cd.VALIDATION&&!0===n,{dataFrameAnalytics:{validateDataFrameAnalytics:S}}=Object(d.a)(),_=`mlAnalyticsCreateJobWizardValidationStepWrapper${w?" active":""}${M?" summary":""}`,T=Object(x.debounce)((async()=>{l(!0);try{const e=h?f:Object(mc.f)(b),t=await S(e);u(t),m(void 0),l(!1)}catch(e){m({heading:o.i18n.translate("xpack.ml.dataframe.analytics.validation.validationFetchErrorMessage",{defaultMessage:"Error validating job"}),id:"error",status:ji.c.ERROR,text:Object(Re.b)(e)}),l(!1)}}),500);Object(i.useEffect)((function(){void 0===j||!w&&!0!==n||T()}),[w,g,v,y,O,E]),void 0!==p&&c.push(p);const C=Object(i.useMemo)((()=>c.reduce(((e,t)=>((null==t?void 0:t.status)===ji.c.WARNING?e.warning+=1:(null==t?void 0:t.status)===ji.c.SUCCESS&&(e.success+=1),e)),{warning:0,success:0})),[c]);return Object(I.jsx)(r.EuiForm,{className:"mlDataFrameAnalyticsCreateForm","data-test-subj":_},w&&Object(I.jsx)(Sd,{checksInProgress:s,validationMessages:c,setCurrentStep:t}),M&&Object(I.jsx)(_d,{setCurrentStep:t,state:e,validationSummary:C}))};let Cd;!function(e){e[e.CONFIGURATION=0]="CONFIGURATION",e[e.ADVANCED=1]="ADVANCED",e[e.DETAILS=2]="DETAILS",e[e.VALIDATION=3]="VALIDATION",e[e.CREATE=4]="CREATE"}(Cd||(Cd={}));const kd=({jobId:e})=>{const[t,a]=Object(i.useState)(Cd.CONFIGURATION),[n,s]=Object(i.useState)([!0,!1,!1,!1,!1]),l=Object(de.b)(),{currentDataView:c}=l,d=Object(uc.b)(),{state:u}=d,{isAdvancedEditorEnabled:p,disableSwitchToForm:m,isJobCreated:b}=u,{jobType:f}=u.form,{initiateWizard:g,setJobClone:j,switchToAdvancedEditor:x,switchToForm:v}=d.actions;Object(i.useEffect)((()=>{g(),c&&async function(){if(void 0!==e){const t=await be.ml.dataFrameAnalytics.getDataFrameAnalytics(e,!0);if(Array.isArray(t.data_frame_analytics)&&t.data_frame_analytics.length>0){const e=t.data_frame_analytics[0];await j(e)}}}()}),[]),Object(i.useEffect)((()=>{!1===n[t]&&(n.splice(t,1,!0),s(n))}),[t]);const y=[{title:o.i18n.translate("xpack.ml.dataframe.analytics.creation.configurationStepTitle",{defaultMessage:"Configuration"}),children:Object(I.jsx)(dd,h()({},d,{isClone:void 0!==e,setCurrentStep:a,step:t,stepActivated:n[Cd.CONFIGURATION]})),status:t>=Cd.CONFIGURATION?void 0:"incomplete"},{title:o.i18n.translate("xpack.ml.dataframe.analytics.creation.advancedStepTitle",{defaultMessage:"Additional options"}),children:Object(I.jsx)(yd,h()({},d,{setCurrentStep:a,step:t,stepActivated:n[Cd.ADVANCED]})),status:t>=Cd.ADVANCED?void 0:"incomplete"},{title:o.i18n.translate("xpack.ml.dataframe.analytics.creation.detailsStepTitle",{defaultMessage:"Job details"}),children:Object(I.jsx)(Md,h()({},d,{setCurrentStep:a,step:t,stepActivated:n[Cd.DETAILS]})),status:t>=Cd.DETAILS?void 0:"incomplete"},{title:o.i18n.translate("xpack.ml.dataframe.analytics.creation.validationStepTitle",{defaultMessage:"Validation"}),children:Object(I.jsx)(Td,h()({},d,{setCurrentStep:a,step:t,stepActivated:n[Cd.VALIDATION]})),status:t>=Cd.VALIDATION?void 0:"incomplete"},{title:o.i18n.translate("xpack.ml.dataframe.analytics.creation.createStepTitle",{defaultMessage:"Create"}),children:Object(I.jsx)(xc,h()({},d,{step:t})),status:t>=Cd.CREATE?void 0:"incomplete"}];return Object(I.jsx)("div",{"data-test-subj":"mlAnalyticsCreationContainer"},Object(I.jsx)(Q.a,null,Object(I.jsx)("span",{"data-test-subj":"mlDataFrameAnalyticsWizardHeaderTitle"},void 0===e&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageTitle",defaultMessage:"Create job"}),void 0!==e&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.clone.creationPageTitle",defaultMessage:"Clone job from {jobId}",values:{jobId:e}}))),Object(I.jsx)(r.EuiPageBody,{restrictWidth:1200},Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.dataframe.analytics.creationPageSourceIndexTitle",defaultMessage:"Source data view: {dataViewTitle}",values:{dataViewTitle:c.title}}))))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFormRow,{helpText:m&&o.i18n.translate("xpack.ml.dataframe.analytics.create.jsonEditorDisabledSwitchText",{defaultMessage:"Configuration contains advanced fields not supported by the form. You cannot switch back to the form."})},Object(I.jsx)(r.EuiSwitch,{disabled:void 0===f||m||b,label:o.i18n.translate("xpack.ml.dataframe.analytics.create.switchToJsonEditorSwitch",{defaultMessage:"Switch to json editor"}),checked:p,onChange:e=>{!0===e.target.checked?x():v()},"data-test-subj":"mlAnalyticsCreateJobWizardAdvancedEditorSwitch"})))),Object(I.jsx)(r.EuiSpacer,null),!0===p&&Object(I.jsx)(vc,d),!1===p&&Object(I.jsx)(r.EuiSteps,{"data-test-subj":"mlAnalyticsCreateJobWizardSteps",steps:y})))},Fd=(e,t)=>({path:"/data_frame_analytics/new_job",render:(e,t)=>Object(I.jsx)(Id,h()({},e,{deps:t})),title:o.i18n.translate("xpack.ml.dataFrameAnalytics.createJob.docTitle",{defaultMessage:"Create Job"}),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.dataFrameCreationLabel",{defaultMessage:"Create Job"})}]}),Id=({location:e,deps:t})=>{const{index:a,jobId:n,savedSearchId:i}=Object(ce.parse)(e.search,{sort:!1}),{context:s}=S(a,i,t.config,t.dataViewsContract,{...U(t),analyticsFields:()=>Is(a,i,t.dataViewsContract,"data-frame-analytics")});return Object(I.jsx)(g.b,{context:s},Object(I.jsx)(kd,{jobId:n}))},Dd=(e,t)=>({path:"/data_frame_analytics/map",render:(e,t)=>Object(I.jsx)(Ad,h()({},e,{deps:t})),title:o.i18n.translate("xpack.ml.dataFrameAnalytics.analyticsMap.docTitle",{defaultMessage:"Analytics Map"}),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("DATA_FRAME_ANALYTICS_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.dataFrameAnalyticsBreadcrumbs.analyticsMapLabel",{defaultMessage:"Analytics Map"})}]}),Ad=({deps:e})=>{const{context:t}=S(void 0,void 0,e.config,e.dataViewsContract,U(e));return Object(I.jsx)(g.b,{context:t},Object(I.jsx)(mo.a,null))};var Ld=a(674),Rd=a.n(Ld),Nd=a(54),Pd=a.n(Nd),zd=a(3);const Bd=()=>{const[e,t]=Object(i.useState)(!1);return Object(I.jsx)(Kl,{anchorPosition:"upCenter",button:Object(I.jsx)(Xl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:o.i18n.translate("xpack.ml.timeSeriesExplorer.popoverTitle",{defaultMessage:"Single time series analysis"})},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverBasicExplanation",defaultMessage:"This chart illustrates the actual data values over time for a specific detector. You can examine an event by sliding the time selector and changing its length. For the most accurate view, set the zoom size to auto."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverAnomalyExplanation",defaultMessage:"An anomaly score is calculated for each bucket time interval, with a value from 0 to 100. Anomalous events are highlighted in colors that indicate their severity. If an anomaly is depicted with a cross symbol instead of a dot, it has a medium or high multi-bucket impact. This extra analysis can catch anomalies even when they fall within the bounds of expected behavior."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverForecastExplanation",defaultMessage:"If you create a forecast, predicted data values are added to the chart. A shaded area around these values represents the confidence level; as you forecast further into the future, the confidence level generally decreases."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverAnnotationsExplanation",defaultMessage:"You can also optionally annotate your job results by drag-selecting a period of time in the chart and adding a description. Some annotations are generated automatically to indicate noteworthy occurrences."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.popoverModelPlotExplanation",defaultMessage:"If model plot is enabled, you can optionally show model bounds, which are represented by a shaded area in the chart. As the job analyzes more data, it learns to more closely predict the expected patterns of behavior."})))};var Jd=a(275),Vd=a(284),Ud=a(82),Gd=a(218);function qd({actual:e,typical:t}){const{iconType:a,message:n}=Object(Gd.a)(e,t);return Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},void 0!==a&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIcon,{type:a,size:"s"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs"},n)))}function Wd({detectorDescription:e,numberOfRules:t}){let a;return void 0!==t&&t>0&&(a=Object(I.jsx)(r.EuiToolTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.detectorCell.rulesConfiguredTooltip",defaultMessage:"rules have been configured for this detector"})},Object(I.jsx)(r.EuiIcon,{type:"controlsHorizontal",className:"detector-rules-icon"}))),Object(I.jsx)(s.a.Fragment,null,e,a)}var Hd=a(181),Yd=a(7),$d=a(248);function Xd({entityName:e,entityValue:t,filter:a}){if(void 0!==a)return Object(I.jsx)(r.EuiToolTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.addFilterTooltip",defaultMessage:"Add filter"})},Object(I.jsx)(r.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object($d.a)((()=>{a(e,t,Yd.a.ADD)})),iconType:"plusInCircle","aria-label":o.i18n.translate("xpack.ml.anomaliesTable.entityCell.addFilterAriaLabel",{defaultMessage:"Add filter"})}))}function Kd({entityName:e,entityValue:t,filter:a}){if(void 0!==a)return Object(I.jsx)(r.EuiToolTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.entityCell.removeFilterTooltip",defaultMessage:"Remove filter"})},Object(I.jsx)(r.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object($d.a)((()=>{a(e,t,Yd.a.REMOVE)})),iconType:"minusInCircle","aria-label":o.i18n.translate("xpack.ml.anomaliesTable.entityCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))}const Qd=({entityName:e,entityValue:t,filter:a,wrapText:n=!1})=>{let i=""===t?Object(I.jsx)("i",null,Hd.a):t;e===It.b&&(i=`${It.b} ${i}`);const o={maxWidth:"100%"},l=n?"field-value-long":"field-value-short",c=void 0!==a&&void 0!==e&&void 0!==t;return!0===n?Object(I.jsx)("div",null,Object(I.jsx)("span",{className:l},i),c&&Object(I.jsx)(s.a.Fragment,null,Xd({entityName:e,entityValue:t,filter:a}),Kd({entityName:e,entityValue:t,filter:a}))):Object(I.jsx)(r.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:o},Object(I.jsx)(r.EuiText,{size:"xs",className:l},i)),c&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{direction:"row",alignItems:"center",gutterSize:"none"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Xd({entityName:e,entityValue:t,filter:a})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Kd({entityName:e,entityValue:t,filter:a})))))};class influencers_cell_InfluencersCell extends i.Component{constructor(e){super(e),this.state={showAll:!1}}toggleAllInfluencers(){this.setState({showAll:!this.state.showAll})}renderInfluencers(e){const t=!1===this.state.showAll?this.props.limit:e.length,a=e.slice(0,t),{influencerFilter:n}=this.props;let i=Math.max(e.length-t,0);1===i&&(a.push(e[this.props.limit]),i=0);const l=a.map(((e,t)=>Object(I.jsx)("div",{key:t},e.influencerFieldName,": ",e.influencerFieldValue,void 0!==n&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiToolTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.addFilterTooltip",defaultMessage:"Add filter"})},Object(I.jsx)(r.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object($d.a)((()=>{n(e.influencerFieldName,e.influencerFieldValue,"+")})),iconType:"plusInCircle","aria-label":o.i18n.translate("xpack.ml.anomaliesTable.influencersCell.addFilterAriaLabel",{defaultMessage:"Add filter"})})),Object(I.jsx)(r.EuiToolTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.removeFilterTooltip",defaultMessage:"Remove filter"})},Object(I.jsx)(r.EuiButtonIcon,{size:"s",className:"filter-button",onClick:Object($d.a)((()=>{n(e.influencerFieldName,e.influencerFieldValue,"-")})),iconType:"minusInCircle","aria-label":o.i18n.translate("xpack.ml.anomaliesTable.influencersCell.removeFilterAriaLabel",{defaultMessage:"Remove filter"})}))))));return Object(I.jsx)(s.a.Fragment,null,l,this.renderOthers(e.length,i))}renderOthers(e,t){return t>0?Object(I.jsx)("div",null,Object(I.jsx)(r.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.moreInfluencersLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:t}}))):e>this.props.limit+1?Object(I.jsx)("div",null,Object(I.jsx)(r.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.influencersCell.showLessInfluencersLinkText",defaultMessage:"show less"}))):void 0}render(){const e=this.props.influencers||[],t=[];return e.forEach((e=>{Object(x.each)(e,((e,a)=>{t.push({influencerFieldName:a,influencerFieldValue:e})}))})),Object(I.jsx)("div",null,this.renderInfluencers(t),this.renderOthers(t))}}var Zd=a(59),eu=a.n(Zd),tu=a(635),au=a(29),nu=a(156);const iu=e=>{const[t,a]=Object(i.useState)(),[n,s]=Object(i.useState)(),l=Object(Yd.m)(e.anomaly),c=e.onItemClick,u=Object(d.b)(),{services:{share:b,application:f}}=u;Object(i.useEffect)((()=>{let t=!1;const n=b.url.locators.get("DISCOVER_APP_LOCATOR");if(!n){const e=o.i18n.translate("xpack.ml.anomaliesTable.linksMenu.discoverLocatorMissingErrorMessage",{defaultMessage:"No locator for Discover detected"});return void(t||s(e))}const i=async()=>{const a=te.a.getJob(e.anomaly.jobId).datafeed_config.indices[0],n=await Object(j.d)(a);if(!n&&!t){const e=o.i18n.translate("xpack.ml.anomaliesTable.linksMenu.autoGeneratedDiscoverLinkErrorMessage",{defaultMessage:"Unable to link to Discover; no data view exists for index '{index}'",values:{index:a}});s(e)}return n};return l?i():(async()=>{const s=e.interval,r=await i(),o=e.anomaly.source,l=Ve()(o.timestamp).startOf(s);"hour"===s&&l.subtract(1,"h");let c=Ve()(o.timestamp).add(o.bucket_span,"s");!0===e.isAggregatedData&&(c=Ve()(o.timestamp).endOf(s),"hour"===s&&c.add(1,"h"));const d=Object(Ud.d)(1e3*l.unix()),u=Object(Ud.d)(1e3*c.unix());let p="";o.influencers&&(p=o.influencers.map((e=>{var t;return`"${e.influencer_field_name}":"${null!==(t=e.influencer_field_values[0])&&void 0!==t?t:""}"`})).join(" AND "));const m=await n.getRedirectUrl({indexPatternId:r,refreshInterval:{display:"Off",pause:!0,value:0},timeRange:{from:d,to:u,mode:"absolute"},query:{language:"kuery",query:p},sort:[["timestamp, asc"]]});t||a(m)})(),()=>{t=!0}}),[JSON.stringify(e.anomaly)]);const h=async()=>{const t=b.url.locators.get(p.a),a=e.anomaly.source,n=e.bounds;if(!t)return void console.error("Unable to detect locator for ML or bounds");if(!n||!n.min||!n.max)return void console.error("Invalid bounds");const i=n.min.toISOString(),s=n.max.toISOString(),r=Ve()(a.timestamp),o=r.subtract(50*a.bucket_span,"s").toISOString(),l=r.add(100*a.bucket_span,"s").toISOString(),c={};void 0!==a.partition_field_name&&void 0!==a.partition_field_value&&(c[a.partition_field_name]=a.partition_field_value),void 0!==a.over_field_name&&void 0!==a.over_field_value&&(c[a.over_field_name]=a.over_field_value),void 0!==a.by_field_name&&void 0!==a.by_field_value&&(c[a.by_field_name]=a.by_field_value);const d=await t.getUrl({page:p.b.SINGLE_METRIC_VIEWER,pageState:{jobIds:[a.job_id],refreshInterval:{display:"Off",pause:!0,value:0},timeRange:{from:i,to:s,mode:"absolute"},zoom:{from:o,to:l},detectorIndex:a.detector_index,entities:c,query_string:{analyze_wildcard:!0,query:"*"}}},{absolute:!0});window.open(d,"_blank")},g=()=>{const t=e.anomaly.entityValue,a=e.anomaly.source,n=te.a.getJob(e.anomaly.jobId);if(void 0===n){console.log(`viewExamples(): no job found with ID: ${e.anomaly.jobId}`);const{toasts:t}=u.services.notifications;return void t.addDanger(o.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToViewExamplesErrorMessage",{defaultMessage:"Unable to view examples as no details could be found for job ID {jobId}",values:{jobId:e.anomaly.jobId}}))}const i=n.analysis_config.categorization_field_name,s=n.datafeed_config.indices;let r=0;!function e(n){(function(e,t){return new Promise(((a,n)=>{""!==e?be.ml.getFieldCaps({index:e,fields:[t]}).then((e=>{let t="";Object(x.each)(e.fields,(e=>{Object(x.each)(e,(e=>{""===t&&(t=e.type)}))})),a(t)})).catch((e=>{n(e)})):n()}))})(n,i).then((n=>{""!==n?((e,n)=>{be.ml.results.getCategoryDefinition(a.job_id,t).then((async t=>{const s=await Object(j.d)(e);if(!s)return;let r=null;if(n===tu.ES_FIELD_TYPES.KEYWORD)t.regex&&(r={language:O.c.LUCENE,query:`${i}:/${t.regex}/`});else if(t.terms){const e=Object(el.b)(t.terms);r={language:O.c.KUERY,query:`${i}:"`+e.split(" ").join(`" and ${i}:"`)+'"'}}const o=Ve()(a.timestamp),l=o.toISOString(),c=o.add(a.bucket_span,"s").toISOString(),d=eu.a.encode({refreshInterval:{display:"Off",pause:!0,value:0},time:{from:l,to:c,mode:"absolute"}}),p={index:s,filters:[]};null!==r&&(p.query=r);const m=eu.a.encode(p),{basePath:b}=u.services.http;let f=b.get();f+="/app/discover#/",f+="?_g="+d,f+="&_a="+encodeURIComponent(m),window.open(f,"_blank")})).catch((e=>{console.log("viewExamples(): error loading categoryDefinition:",e);const{toasts:a}=u.services.notifications;a.addDanger(o.i18n.translate("xpack.ml.anomaliesTable.linksMenu.loadingDetailsErrorMessage",{defaultMessage:"Unable to view examples as an error occurred loading details on category ID {categoryId}",values:{categoryId:t}}))}))})(s.join(),n):(r++,r<s.length?e(s[r]):l())})).catch((()=>{l()}))}(s[r]);const l=()=>{console.log(`viewExamples(): error finding type of field ${i} in indices:`,s);const{toasts:e}=u.services.notifications;e.addDanger(o.i18n.translate("xpack.ml.anomaliesTable.linksMenu.noMappingCouldBeFoundErrorMessage",{defaultMessage:"Unable to view examples of documents with mlcategory {categoryId} as no mapping could be found for the categorization field {categorizationFieldName}",values:{categoryId:t,categorizationFieldName:i}}))}},{anomaly:v,showViewSeriesLink:y}=e,E=Object(Yd.n)(v.source)&&Object(m.e)("canUpdateJob"),w=Object(i.useMemo)((()=>{var a,i;const s=[];if(void 0!==v.customUrls&&v.customUrls.forEach(((t,a)=>{s.push(Object(I.jsx)(r.EuiContextMenuItem,{key:`custom_url_${a}`,icon:"popout",onClick:()=>{c(),(t=>{const{anomaly:a,interval:n,isAggregatedData:i}=e;console.log("Anomalies Table - open customUrl for record:",a);const s=Object(x.cloneDeep)(a.source),r=s.timestamp,l=t.url_value,c=void 0!==t.time_range?Object(au.a)(t.time_range):null,d=u.services.http.basePath.get();if(l.includes("$earliest$")){let e=Ve()(r);null!==c?e.subtract(c):(e=Ve()(r).startOf(n),"hour"===n&&e.subtract(1,"h")),s.earliest=e.toISOString()}if(l.includes("$latest$")){let e=Ve()(r).add(s.bucket_span,"s");null!==c?e.add(c):!0===i&&(e=Ve()(r).endOf(n),"hour"===n&&e.add(1,"h")),s.latest=e.toISOString()}if((l.includes("$mlcategoryterms$")||l.includes("$mlcategoryregex$"))&&void 0!==s.mlcategory){const e=s.job_id,a=s.mlcategory[0];be.ml.results.getCategoryDefinition(e,a).then((e=>{const a=e.terms.split(" ").map((e=>`+${e}`));s.mlcategoryterms=a.join(" "),s.mlcategoryregex=e.regex;const n=Object(ma.e)(t.url_value,s,!0);Object(nu.d)(n,t,d)})).catch((e=>{console.log("openCustomUrl(): error loading categoryDefinition:",e);const{toasts:t}=u.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.anomaliesTable.linksMenu.unableToOpenLinkErrorMessage",{defaultMessage:"Unable to open link as an error occurred loading details on category ID {categoryId}",values:{categoryId:a}}))}))}else{const e=Object(nu.a)(t,s);Object(nu.d)(e,t,d)}})(t)},"data-test-subj":`mlAnomaliesListRowActionCustomUrlButton_${a}`},t.url_name))})),null!==(a=f.capabilities.discover)&&void 0!==a&&a.show&&!l){const e=void 0===n&&void 0===t;s.push(Object(I.jsx)(r.EuiContextMenuItem,{key:"auto_raw_data_url",icon:"discoverApp",disabled:void 0!==n||e,href:t,"data-test-subj":"mlAnomaliesListRowAction_viewInDiscoverButton"},n?Object(I.jsx)(r.EuiToolTip,{content:n},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewInDiscover",defaultMessage:"View in Discover"})):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewInDiscover",defaultMessage:"View in Discover"}),e?Object(I.jsx)(r.EuiProgress,{size:"xs",color:"accent"}):null))}return!0===y&&!0===v.isTimeSeriesViewRecord&&s.push(Object(I.jsx)(r.EuiContextMenuItem,{key:"view_series",icon:"visLine",onClick:()=>{c(),h()},"data-test-subj":"mlAnomaliesListRowActionViewSeriesButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewSeriesLabel",defaultMessage:"View series"}))),null!==(i=f.capabilities.discover)&&void 0!==i&&i.show&&l&&s.push(Object(I.jsx)(r.EuiContextMenuItem,{key:"view_examples",icon:"popout",onClick:()=>{c(),g()},"data-test-subj":"mlAnomaliesListRowActionViewExamplesButton",disabled:void 0!==n},void 0!==n?Object(I.jsx)(r.EuiToolTip,{content:n},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewExamplesLabel",defaultMessage:"View examples"})):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.viewExamplesLabel",defaultMessage:"View examples"}))),E&&s.push(Object(I.jsx)(r.EuiContextMenuItem,{key:"create_rule",icon:"controlsHorizontal",onClick:()=>{c(),e.showRuleEditorFlyout(v)},"data-test-subj":"mlAnomaliesListRowActionConfigureRulesButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.linksMenu.configureRulesLabel",defaultMessage:"Configure job rules"}))),s}),[t,n,g,h,E,l]);return Object(I.jsx)(r.EuiContextMenuPanel,{hasFocus:void 0!==n||!!t,items:w,"data-test-subj":"mlAnomaliesListRowActionsMenu"})},su=e=>{const[t,a]=Object(i.useState)(!1),n=a.bind(null,!t),s=a.bind(null,!1),l=Object(I.jsx)(r.EuiButtonIcon,{size:"s",color:"text",onClick:n,iconType:"gear","aria-label":o.i18n.translate("xpack.ml.anomaliesTable.linksMenu.selectActionAriaLabel",{defaultMessage:"Select action for anomaly at {time}",values:{time:Object(Ud.c)(e.anomaly.time)}}),"data-test-subj":"mlAnomaliesListRowActionsButton"});return Object(I.jsx)("div",null,Object(I.jsx)(r.EuiPopover,{button:l,isOpen:t,closePopover:s,panelPaddingSize:"none",anchorPosition:"downLeft"},Object(I.jsx)(iu,h()({},e,{onItemClick:s}))))};var ru=a(136),ou=a(132);const lu=0,cu=1,du=500;var uu=a(14);const pu=Object(i.memo)((({score:e,multiBucketImpact:t})=>{const a=Object(Yd.g)(e),n=Object(Yd.j)(e);return t>=uu.a.MEDIUM?Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)("svg",{width:"16",height:"16",viewBox:"-2 -2 20 20",fill:n},Object(I.jsx)("path",{d:"M-6.708203932499369,-2.23606797749979H-2.23606797749979V-6.708203932499369H2.23606797749979V-2.23606797749979H6.708203932499369V2.23606797749979H2.23606797749979V6.708203932499369H-2.23606797749979V2.23606797749979H-6.708203932499369Z",transform:"translate(8,8)"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},a)):Object(I.jsx)(r.EuiHealth,{color:n},a)}));function mu(e,t){return Object(Yd.n)(e.source)&&Object(m.e)("canUpdateJob")||t&&e.isTimeSeriesViewRecord||"mlcategory"===e.entityName||void 0!==e.customUrls}function bu(e,t,a,n,i,s,l,c,d,u,p,m){const b=[{name:Object(I.jsx)(r.EuiScreenReaderOnly,null,Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each anomaly"}))),render:e=>Object(I.jsx)(r.EuiButtonIcon,{onClick:()=>u(e),iconType:d[e.rowId]?"arrowDown":"arrowRight","aria-label":d[e.rowId]?o.i18n.translate("xpack.ml.anomaliesTable.hideDetailsAriaLabel",{defaultMessage:"Hide details"}):o.i18n.translate("xpack.ml.anomaliesTable.showDetailsAriaLabel",{defaultMessage:"Show details"}),"data-row-id":e.rowId,"data-test-subj":"mlAnomaliesListRowDetailsToggle"})},{field:"time","data-test-subj":"mlAnomaliesListColumnTime",name:o.i18n.translate("xpack.ml.anomaliesTable.timeColumnName",{defaultMessage:"Time"}),dataType:"date",scope:"row",render:e=>function(e,t){return"hour"===t?Object(Ud.b)(e):"second"===t?Object(Ud.c)(e):Object(Ud.a)(e)}(e,i),textOnly:!0,sortable:!0},{field:"severity","data-test-subj":"mlAnomaliesListColumnSeverity",name:Object(I.jsx)(r.EuiToolTip,{content:o.i18n.translate("xpack.ml.overview.anomalyDetection.tableSeverityTooltip",{defaultMessage:"A normalized score between 0-100, which indicates the relative significance of the anomaly record results."})},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.anomaliesTable.severityColumnName",{defaultMessage:"Severity"}),Object(I.jsx)(r.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(e,t)=>Object(I.jsx)(pu,{score:e,multiBucketImpact:t.source.multi_bucket_impact}),sortable:!0},{field:"detector","data-test-subj":"mlAnomaliesListColumnDetector",name:o.i18n.translate("xpack.ml.anomaliesTable.detectorColumnName",{defaultMessage:"Detector"}),render:(e,t)=>Object(I.jsx)(Wd,{detectorDescription:e,numberOfRules:t.rulesLength}),textOnly:!0,sortable:!0}];if(e.some((e=>void 0!==e.entityValue))&&b.push({field:"entityValue","data-test-subj":"mlAnomaliesListColumnFoundFor",name:o.i18n.translate("xpack.ml.anomaliesTable.entityValueColumnName",{defaultMessage:"Found for"}),render:(e,t)=>Object(I.jsx)(Qd,{entityName:t.entityName,entityValue:e,filter:p,wrapText:!0}),textOnly:!0,sortable:!0}),e.some((e=>void 0!==e.influencers))&&b.push({field:"influencers","data-test-subj":"mlAnomaliesListColumnInfluencers",name:o.i18n.translate("xpack.ml.anomaliesTable.influencersColumnName",{defaultMessage:"Influenced by"}),render:e=>Object(I.jsx)(influencers_cell_InfluencersCell,{limit:5,influencers:e,influencerFilter:m}),textOnly:!0,sortable:!0}),e.some((e=>void 0!==e.actual))&&b.push({field:"actualSort","data-test-subj":"mlAnomaliesListColumnActual",name:Object(I.jsx)(r.EuiToolTip,{content:o.i18n.translate("xpack.ml.overview.anomalyDetection.tableActualTooltip",{defaultMessage:"The actual values in the anomaly record results."})},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.anomaliesTable.actualSortColumnName",{defaultMessage:"Actual"}),Object(I.jsx)(r.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(e,t)=>{const a=ru.a.getFieldFormat(t.jobId,t.source.detector_index);return Object(ou.b)(t.actual,t.source.function,a,t.source)},sortable:!0}),e.some((e=>void 0!==e.typical))){b.push({field:"typicalSort","data-test-subj":"mlAnomaliesListColumnTypical",name:Object(I.jsx)(r.EuiToolTip,{content:o.i18n.translate("xpack.ml.overview.anomalyDetection.tableTypicalTooltip",{defaultMessage:"The typical values in the anomaly record results."})},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.anomaliesTable.typicalSortColumnName",{defaultMessage:"Typical"}),Object(I.jsx)(r.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),render:(e,t)=>{const a=ru.a.getFieldFormat(t.jobId,t.source.detector_index);return Object(ou.b)(t.typical,t.source.function,a,t.source)},sortable:!0});!0===e.some((e=>{const t=e.source.function;return"time_of_day"!==t&&"time_of_week"!==t}))&&b.push({field:"metricDescriptionSort","data-test-subj":"mlAnomaliesListColumnDescription",name:o.i18n.translate("xpack.ml.anomaliesTable.metricDescriptionSortColumnName",{defaultMessage:"Description"}),render:(e,t)=>Object(I.jsx)(qd,{actual:t.actual,typical:t.typical}),textOnly:!0,sortable:!0})}t&&t.length>1&&b.push({field:"jobId","data-test-subj":"mlAnomaliesListColumnJobID",name:o.i18n.translate("xpack.ml.anomaliesTable.jobIdColumnName",{defaultMessage:"Job ID"}),sortable:!0});!0===e.some((e=>"mlcategory"===e.entityName))&&b.push({"data-test-subj":"mlAnomaliesListColumnCategoryExamples",name:o.i18n.translate("xpack.ml.anomaliesTable.categoryExamplesColumnName",{defaultMessage:"Category examples"}),truncateText:!0,render:e=>{const t=Object(x.get)(a,[e.jobId,e.entityValue],[]);return Object(I.jsx)(r.EuiLink,{className:"mlAnomalyCategoryExamples__link",onClick:()=>u(e,cu)},t.map(((e,t)=>Object(I.jsx)("span",{key:`example${t}`,className:"category-example"},e))))},width:"13%"});return!0===e.some((e=>mu(e,l)))&&b.push({"data-test-subj":"mlAnomaliesListColumnAction",name:o.i18n.translate("xpack.ml.anomaliesTable.actionsColumnName",{defaultMessage:"Actions"}),render:e=>!0===mu(e,l)?Object(I.jsx)(su,{anomaly:e,bounds:s,showViewSeriesLink:l,isAggregatedData:n,interval:i,showRuleEditorFlyout:c}):null}),b}function fu(e,t,a){return Object(I.jsx)(Qd,{entityName:e,entityValue:t,filter:a})}class anomaly_details_AnomalyDetails extends i.Component{constructor(e){super(e),this.state={showAllInfluencers:!1},void 0!==this.props.examples&&this.props.examples.length>0&&(this.tabs=[{id:"Details",name:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detailsTitle",{defaultMessage:"Details"}),content:Object(I.jsx)(i.Fragment,null,Object(I.jsx)("div",{className:"ml-anomalies-table-details","data-test-subj":"mlAnomaliesListRowDetails"},this.renderDescription(),Object(I.jsx)(r.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers()))},{id:"category-examples",name:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.categoryExamplesTitle",{defaultMessage:"Category examples"}),content:Object(I.jsx)(i.Fragment,null,this.renderCategoryExamples())}])}toggleAllInfluencers(){this.setState({showAllInfluencers:!this.state.showAllInfluencers})}renderCategoryExamples(){const{examples:e,definition:t}=this.props;return Object(I.jsx)(r.EuiFlexGroup,{direction:"column",justifyContent:"center",gutterSize:"m",className:"mlAnomalyCategoryExamples"},void 0!==t&&t.terms&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{key:"example-terms"},Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)("h4",{className:"mlAnomalyCategoryExamples__header"},o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsTitle",{defaultMessage:"Terms"}))," ",Object(I.jsx)(r.EuiIconTip,{"aria-label":o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.termsDescriptionTooltip",defaultMessage:"A space separated list of the common tokens that are matched in values of the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:du}})})),Object(I.jsx)(r.EuiText,{size:"xs"},t.terms)),Object(I.jsx)(r.EuiSpacer,{size:"xs"})),void 0!==t&&t.regex&&Object(I.jsx)(i.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{key:"example-regex"},Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)("h4",{className:"mlAnomalyCategoryExamples__header"},o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexTitle",{defaultMessage:"Regex"}))," ",Object(I.jsx)(r.EuiIconTip,{"aria-label":o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionAriaLabel",{defaultMessage:"Description"}),type:"questionInCircle",color:"subdued",size:"s",content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.regexDescriptionTooltip",defaultMessage:"The regular expression that is used to search for values that match the category (may have been truncated to a max character limit of {maxChars})",values:{maxChars:du}})})),Object(I.jsx)(r.EuiText,{size:"xs"},t.regex)),Object(I.jsx)(r.EuiSpacer,{size:"xs"})),e.map(((e,a)=>Object(I.jsx)(r.EuiFlexItem,{key:`example${a}`},0===a&&void 0!==t&&Object(I.jsx)(r.EuiText,{size:"s"},Object(I.jsx)("h4",null,o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.examplesTitle",{defaultMessage:"Examples"}))),Object(I.jsx)("span",{className:"mlAnomalyCategoryExamples__item"},e)))))}renderDescription(){const e=this.props.anomaly,t=e.source;let a,n=o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyInLabel",{defaultMessage:"{anomalySeverity} anomaly in {anomalyDetector}",values:{anomalySeverity:Object(Yd.i)(e.severity).label,anomalyDetector:e.detector}});return void 0!==e.entityName&&(n+=o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.foundForLabel",{defaultMessage:" found for {anomalyEntityName} {anomalyEntityValue}",values:{anomalyEntityName:e.entityName,anomalyEntityValue:e.entityValue}})),void 0!==t.partition_field_name&&t.partition_field_name!==e.entityName&&(n+=o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.detectedInLabel",{defaultMessage:" detected in {sourcePartitionFieldName} {sourcePartitionFieldValue}",values:{sourcePartitionFieldName:t.partition_field_name,sourcePartitionFieldValue:t.partition_field_value}})),void 0!==t.correlated_by_field_value&&(a=o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multivariateDescription",{defaultMessage:"multivariate correlations found in {sourceByFieldName}; {sourceByFieldValue} is considered anomalous given {sourceCorrelatedByFieldValue}",values:{sourceByFieldName:t.by_field_name,sourceByFieldValue:t.by_field_value,sourceCorrelatedByFieldValue:t.correlated_by_field_value}})),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.descriptionTitle",defaultMessage:"Description"})),n),void 0!==a&&Object(I.jsx)(r.EuiText,{size:"xs"},a))}renderDetails(){const e=function(e,t){const a=e.source;let n=[];const i=a.causes||[];let s,l;1===i.length?void 0!==i[0].by_field_name&&(s=i[0].by_field_name,l=i[0].by_field_value):n=i.map((e=>{const t=Object(x.pick)(e,"typical","actual","probability");return t.entityName=e.by_field_name?e.by_field_name:e.over_field_name,t.entityValue=e.by_field_value?e.by_field_value:e.over_field_value,t}));const c=[];void 0!==a.partition_field_value&&c.push({title:a.partition_field_name,description:fu(a.partition_field_name,a.partition_field_value,t)}),void 0!==a.by_field_value&&c.push({title:a.by_field_name,description:fu(a.by_field_name,a.by_field_value,t)}),void 0!==s&&c.push({title:s,description:fu(s,l,t)}),void 0!==a.over_field_value&&c.push({title:a.over_field_name,description:fu(a.over_field_name,a.over_field_value,t)});const d=a.timestamp;let u=`${Object(Ud.c)(d)}`;if(void 0!==a.bucket_span){const e=d+1e3*a.bucket_span;u=o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.anomalyTimeRangeLabel",{defaultMessage:"{anomalyTime} to {anomalyEndTime}",values:{anomalyTime:Object(Ud.c)(d),anomalyEndTime:Object(Ud.c)(e)}})}c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.timeTitle",{defaultMessage:"Time"}),description:u}),c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.functionTitle",{defaultMessage:"Function"}),description:a.function!==Pt.b.METRIC?a.function:a.function_description}),void 0!==a.field_name&&c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.fieldNameTitle",{defaultMessage:"Field name"}),description:a.field_name});const p=a.function_description||"";return void 0!==e.actual&&!0===Object(Yd.o)(p)&&c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.actualTitle",{defaultMessage:"Actual"}),description:Object(ou.b)(e.actual,a.function,void 0,a)}),void 0!==e.typical&&!0===Object(Yd.p)(p)&&c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.typicalTitle",{defaultMessage:"Typical"}),description:Object(ou.b)(e.typical,a.function,void 0,a)}),c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.jobIdTitle",{defaultMessage:"Job ID"}),description:e.jobId}),void 0!==a.multi_bucket_impact&&a.multi_bucket_impact>=uu.a.LOW&&c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.multiBucketImpactTitle",{defaultMessage:"Multi-bucket impact"}),description:Object(Yd.h)(a.multi_bucket_impact)}),c.push({title:Object(I.jsx)(r.EuiToolTip,{position:"left",content:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.recordScoreTooltip",{defaultMessage:"A normalized score between 0-100, which indicates the relative significance of the anomaly record result. This value might change as new data is analyzed."})},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.recordScoreTitle",{defaultMessage:"Record score"}),Object(I.jsx)(r.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),description:Math.floor(1e3*a.record_score)/1e3}),c.push({title:Object(I.jsx)(r.EuiToolTip,{position:"left",content:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.initialRecordScoreTooltip",{defaultMessage:"A normalized score between 0-100, which indicates the relative significance of the anomaly record when the bucket was initially processed."})},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.initialRecordScoreTitle",{defaultMessage:"Initial record score"}),Object(I.jsx)(r.EuiIcon,{size:"s",color:"subdued",type:"questionInCircle",className:"eui-alignTop"}))),description:Math.floor(1e3*a.initial_record_score)/1e3}),c.push({title:o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.probabilityTitle",{defaultMessage:"Probability"}),description:void 0!==a.probability?Number.parseFloat(a.probability).toPrecision(3):""}),n.length>1&&n.forEach(((e,t)=>{const n=0===t?o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesTitle",{defaultMessage:"{causeEntityName} values",values:{causeEntityName:e.entityName}}):"",i=o.i18n.translate("xpack.ml.anomaliesTable.anomalyDetails.causeValuesDescription",{defaultMessage:"{causeEntityValue} (actual {actualValue}, typical {typicalValue}, probability {probabilityValue})",values:{causeEntityValue:e.entityValue,actualValue:Object(ou.b)(e.actual,a.function),typicalValue:Object(ou.b)(e.typical,a.function),probabilityValue:e.probability}});c.push({title:n,description:i})})),c}(this.props.anomaly,this.props.filter),t=Object(x.get)(this.props.anomaly,"source.is_interim",!1);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,{size:"xs"},!0===this.props.isAggregatedData?Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.detailsOnHighestSeverityAnomalyTitle",defaultMessage:"Details on highest severity anomaly"})):Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDetailsTitle",defaultMessage:"Anomaly details"})),!0===t&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiIcon,{type:"alert"}),Object(I.jsx)("span",{className:"interim-result"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.interimResultLabel",defaultMessage:"Interim result"})))),Object(I.jsx)(r.EuiDescriptionList,{type:"column",listItems:e,className:"anomaly-description-list"}))}renderInfluencers(){const e=this.props.anomaly.influencers;let t=[],a=0,n=0;if(void 0!==e&&(n=!0===this.state.showAllInfluencers?e.length:Math.min(this.props.influencersLimit,e.length),a=Math.max(e.length-n,0),1===a&&(n++,a=0),t=function(e,t,a){const n=[];for(let i=0;i<a;i++)Object.keys(e[i]).forEach((a=>{const s=e[i][a];n.push({title:a,description:fu(a,s,t)})}));return n}(e,this.props.influencerFilter,n)),t.length>0)return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.influencersTitle",defaultMessage:"Influencers"}))),Object(I.jsx)(r.EuiDescriptionList,{type:"column",listItems:t,className:"anomaly-description-list"}),a>0&&Object(I.jsx)(r.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionListMoreLinkText",defaultMessage:"and {othersCount} more",values:{othersCount:a}})),n>this.props.influencersLimit+1&&Object(I.jsx)(r.EuiLink,{onClick:()=>this.toggleAllInfluencers()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.anomalyDetails.anomalyDescriptionShowLessLinkText",defaultMessage:"Show less"})))}render(){const{tabIndex:e}=this.props;return void 0!==this.tabs?Object(I.jsx)(r.EuiTabbedContent,{tabs:this.tabs,size:"s",initialSelectedTab:this.tabs[e],onTabClick:()=>{}}):Object(I.jsx)("div",{className:"ml-anomalies-table-details","data-test-subj":"mlAnomaliesListRowDetails"},this.renderDescription(),Object(I.jsx)(r.EuiSpacer,{size:"m"}),this.renderDetails(),this.renderInfluencers())}}var hu=a(230);function gu({job:e,detector:t,anomaly:a}){const n=[{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.jobIdTitle",defaultMessage:"Job ID"}),description:e.job_id},{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.detectorTitle",defaultMessage:"Detector"}),description:t.detector_description}];if(void 0!==a.actual){const e=Object(ou.b)(a.actual,a.source.function),t=Object(ou.b)(a.typical,a.source.function);n.push({title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyTitle",defaultMessage:"Selected anomaly"}),description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.detectorDescriptionList.selectedAnomalyDescription",defaultMessage:"actual {actual}, typical {typical}",values:{actual:e,typical:t}})})}return Object(I.jsx)(r.EuiDescriptionList,{className:"rule-detector-description-list",type:"column",listItems:n})}var ju=a(32);function xu({actions:e,onSkipResultChange:t,onSkipModelUpdateChange:a}){return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.chooseActionsDescription",defaultMessage:"Choose the actions to take when the job rule matches an anomaly."}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiCheckbox,{id:"skip_result_cb",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipResultLabel",defaultMessage:"Skip result (recommended)"}),checked:e.indexOf(ju.a.SKIP_RESULT)>-1,onChange:t})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIconTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.resultWillNotBeCreatedTooltip",defaultMessage:"The result will not be created."}),size:"s",position:"right"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiCheckbox,{id:"skip_model_update_cb",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.skipModelUpdateLabel",defaultMessage:"Skip model update"}),checked:e.indexOf(ju.a.SKIP_MODEL_UPDATE)>-1,onChange:a})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiIconTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.actionsSection.valueWillNotBeUsedToUpdateModelTooltip",defaultMessage:"The value for that series will not be used to update the model."}),size:"s",position:"right"}))))}function vu(){return{applies_to:ju.b.ACTUAL,operator:ju.e.LESS_THAN,value:1}}function yu(){return{actions:[ju.a.SKIP_RESULT],conditions:[]}}function Ou(e){let t=!1;if(e.actions.length>0){const a=e.conditions;if(void 0!==a&&a.length>0)t=!0;else{const a=e.scope;void 0!==a&&(t=Object.keys(a).some((e=>!0===a[e].enabled)))}}return t}function Eu(e,t,a){const n=e.job_id,i={detectors:[{detector_index:t,custom_rules:a}]};let s={};return void 0!==e.custom_settings&&(s={...e.custom_settings},Object(_e.r)(s),i.custom_settings=s),new Promise(((e,t)=>{be.ml.updateJob({jobId:n,job:i}).then((()=>{te.a.refreshJob(n).then((()=>{e({success:!0})})).catch((e=>{t(e)}))})).catch((e=>{t(e)}))}))}function wu(e){const{actions:t,conditions:a,scope:n}=e;let i="",s="",r="";if(t.forEach(((e,t)=>{switch(t>0&&(i+=" AND "),e){case ju.a.SKIP_RESULT:i+=o.i18n.translate("xpack.ml.ruleEditor.ruleDescription.resultActionTypeText",{defaultMessage:"result",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText +xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"});break;case ju.a.SKIP_MODEL_UPDATE:i+=o.i18n.translate("xpack.ml.ruleEditor.ruleDescription.modelUpdateActionTypeText",{defaultMessage:"model update",description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}})),void 0!==a&&a.forEach(((e,t)=>{t>0&&(s+=" AND "),s+=o.i18n.translate("xpack.ml.ruleEditor.ruleDescription.conditionsText",{defaultMessage:"{appliesTo} is {operator} {value}",values:{appliesTo:Su(e.applies_to),operator:_u(e.operator),value:e.value},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})})),void 0!==n){void 0!==a&&a.length>0&&(r+=" AND ");Object.keys(n).forEach(((e,t)=>{t>0&&(r+=" AND ");const a=n[e];r+=o.i18n.translate("xpack.ml.ruleEditor.ruleDescription.filtersText",{defaultMessage:"{fieldName} is {filterType} {filterId}",values:{fieldName:e,filterType:Mu(a.filter_type),filterId:a.filter_id},description:"Part of composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText"})}))}return o.i18n.translate("xpack.ml.ruleEditor.ruleDescription",{defaultMessage:"skip {actions} when {conditions}{filters}",values:{actions:i,conditions:s,filters:r},description:"Composite text: xpack.ml.ruleEditor.ruleDescription.[actionName]ActionTypeText + xpack.ml.ruleEditor.ruleDescription.conditionsText + xpack.ml.ruleEditor.ruleDescription.filtersText. (Example: skip model update when actual is less than 1 AND ip is in xxx)"})}function Mu(e){switch(e){case ju.d.INCLUDE:return o.i18n.translate("xpack.ml.ruleEditor.includeFilterTypeText",{defaultMessage:"in"});case ju.d.EXCLUDE:return o.i18n.translate("xpack.ml.ruleEditor.excludeFilterTypeText",{defaultMessage:"not in"});default:return void 0!==e?e:""}}function Su(e){switch(e){case ju.b.ACTUAL:return o.i18n.translate("xpack.ml.ruleEditor.actualAppliesTypeText",{defaultMessage:"actual"});case ju.b.TYPICAL:return o.i18n.translate("xpack.ml.ruleEditor.typicalAppliesTypeText",{defaultMessage:"typical"});case ju.b.DIFF_FROM_TYPICAL:return o.i18n.translate("xpack.ml.ruleEditor.diffFromTypicalAppliesTypeText",{defaultMessage:"diff from typical"});default:return void 0!==e?e:""}}function _u(e){switch(e){case ju.e.LESS_THAN:return o.i18n.translate("xpack.ml.ruleEditor.lessThanOperatorTypeText",{defaultMessage:"less than"});case ju.e.LESS_THAN_OR_EQUAL:return o.i18n.translate("xpack.ml.ruleEditor.lessThanOrEqualToOperatorTypeText",{defaultMessage:"less than or equal to"});case ju.e.GREATER_THAN:return o.i18n.translate("xpack.ml.ruleEditor.greaterThanOperatorTypeText",{defaultMessage:"greater than"});case ju.e.GREATER_THAN_OR_EQUAL:return o.i18n.translate("xpack.ml.ruleEditor.greaterThanOrEqualToOperatorTypeText",{defaultMessage:"greater than or equal to"});default:return void 0!==e?e:""}}const Tu={zIndex:"200"};class condition_expression_ConditionExpression extends i.Component{constructor(e){super(e),Se()(this,"openAppliesTo",(()=>{this.setState({isAppliesToOpen:!0,isOperatorValueOpen:!1})})),Se()(this,"closeAppliesTo",(()=>{this.setState({isAppliesToOpen:!1})})),Se()(this,"openOperatorValue",(()=>{this.setState({isAppliesToOpen:!1,isOperatorValueOpen:!0})})),Se()(this,"closeOperatorValue",(()=>{this.setState({isOperatorValueOpen:!1})})),Se()(this,"changeAppliesTo",(e=>{const{index:t,operator:a,value:n,updateCondition:i}=this.props;i(t,e.target.value,a,n)})),Se()(this,"changeOperator",(e=>{const{index:t,appliesTo:a,value:n,updateCondition:i}=this.props;i(t,a,e.target.value,n)})),Se()(this,"changeValue",(e=>{const{index:t,appliesTo:a,operator:n,updateCondition:i}=this.props;i(t,a,n,+e.target.value)})),this.state={isAppliesToOpen:!1,isOperatorValueOpen:!1}}renderAppliesToPopover(){return Object(I.jsx)("div",{style:Tu},Object(I.jsx)(r.EuiPopoverTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToPopoverTitle",defaultMessage:"When"})),Object(I.jsx)("div",{className:"euiExpression",style:{width:200}},Object(I.jsx)(r.EuiSelect,{value:this.props.appliesTo,onChange:this.changeAppliesTo,options:[{value:ju.b.ACTUAL,text:Su(ju.b.ACTUAL)},{value:ju.b.TYPICAL,text:Su(ju.b.TYPICAL)},{value:ju.b.DIFF_FROM_TYPICAL,text:Su(ju.b.DIFF_FROM_TYPICAL)}]})))}renderOperatorValuePopover(){return Object(I.jsx)("div",{style:Tu},Object(I.jsx)(r.EuiPopoverTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValuePopoverTitle",defaultMessage:"Is"})),Object(I.jsx)("div",{className:"euiExpression"},Object(I.jsx)(r.EuiFlexGroup,{style:{maxWidth:450}},Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{width:250}},Object(I.jsx)(r.EuiSelect,{value:this.props.operator,onChange:this.changeOperator,options:[{value:ju.e.LESS_THAN,text:_u(ju.e.LESS_THAN)},{value:ju.e.LESS_THAN_OR_EQUAL,text:_u(ju.e.LESS_THAN_OR_EQUAL)},{value:ju.e.GREATER_THAN,text:_u(ju.e.GREATER_THAN)},{value:ju.e.GREATER_THAN_OR_EQUAL,text:_u(ju.e.GREATER_THAN_OR_EQUAL)}]})),Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{width:200}},Object(I.jsx)(r.EuiFieldNumber,{value:+this.props.value,onChange:this.changeValue})))))}render(){const{index:e,appliesTo:t,operator:a,value:n,deleteCondition:i}=this.props;return Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"m"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiPopover,{id:"appliesToPopover",button:Object(I.jsx)(r.EuiExpression,{description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.appliesToButtonLabel",defaultMessage:"when"}),value:Su(t),isActive:this.state.isAppliesToOpen,onClick:this.openAppliesTo}),isOpen:this.state.isAppliesToOpen,closePopover:this.closeAppliesTo,panelPaddingSize:"none",ownFocus:!0,anchorPosition:"downLeft"},this.renderAppliesToPopover())),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiPopover,{id:"operatorValuePopover",button:Object(I.jsx)(r.EuiExpression,{description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionExpression.operatorValueButtonLabel",defaultMessage:"is {operator}",values:{operator:_u(a)}}),value:`${n}`,isActive:this.state.isOperatorValueOpen,onClick:this.openOperatorValue}),isOpen:this.state.isOperatorValueOpen,closePopover:this.closeOperatorValue,panelPaddingSize:"none",ownFocus:!0,withTitle:!0,anchorPosition:"downLeft"},this.renderOperatorValuePopover())),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>i(e),iconType:"trash","aria-label":o.i18n.translate("xpack.ml.ruleEditor.conditionExpression.deleteConditionButtonAriaLabel",{defaultMessage:"Delete condition"})})))}}function Cu({isEnabled:e,conditions:t,addCondition:a,updateCondition:n,deleteCondition:i}){if(!1===e)return null;let o=[];return void 0!==t&&(o=t.map(((e,t)=>Object(I.jsx)(condition_expression_ConditionExpression,{key:t,index:t,appliesTo:e.applies_to,operator:e.operator,value:e.value,updateCondition:n,deleteCondition:i})))),Object(I.jsx)(s.a.Fragment,null,o,Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiButtonEmpty,{onClick:()=>a()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.conditionsSection.addNewConditionButtonLabel",defaultMessage:"Add new condition"})))}const ku={zIndex:"200"};function Fu(e){return e.map((e=>({value:e,text:e})))}class scope_expression_ScopeExpression extends i.Component{constructor(e){super(e),Se()(this,"openFilterList",(()=>{this.setState({isFilterListOpen:!0})})),Se()(this,"closeFilterList",(()=>{this.setState({isFilterListOpen:!1})})),Se()(this,"onChangeFilterType",(e=>{const{fieldName:t,filterId:a,enabled:n,updateScope:i}=this.props;i(t,a,e.target.value,n)})),Se()(this,"onChangeFilterId",(e=>{const{fieldName:t,filterType:a,enabled:n,updateScope:i}=this.props;i(t,e.target.value,a,n)})),Se()(this,"onEnableChange",(e=>{const{fieldName:t,filterId:a,filterType:n,updateScope:i}=this.props;i(t,a,n,e.target.checked)})),this.state={isFilterListOpen:!1}}renderFilterListPopover(){const{filterId:e,filterType:t,filterListIds:a}=this.props;return Object(I.jsx)("div",{style:ku},Object(I.jsx)(r.EuiPopoverTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypePopoverTitle",defaultMessage:"Is"})),Object(I.jsx)("div",{className:"euiExpression"},Object(I.jsx)(r.EuiFlexGroup,{style:{maxWidth:450}},Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{width:150}},Object(I.jsx)(r.EuiSelect,{value:t,onChange:this.onChangeFilterType,options:[{value:ju.d.INCLUDE,text:Mu(ju.d.INCLUDE)},{value:ju.d.EXCLUDE,text:Mu(ju.d.EXCLUDE)}]})),Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{width:300}},Object(I.jsx)(r.EuiSelect,{value:e,onChange:this.onChangeFilterId,options:Fu(a)})))))}render(){const{fieldName:e,filterId:t,filterType:a,enabled:n,filterListIds:i}=this.props;return Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"m"},Object(I.jsx)(r.EuiFlexItem,{grow:!1,className:"scope-field-checkbox"},Object(I.jsx)(r.EuiCheckbox,{id:`scope_cb_${e}`,checked:n,onChange:this.onEnableChange})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiExpression,{className:"scope-field-button",description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFieldWhenLabel",defaultMessage:"when"}),value:e,isActive:!1,onClick:e=>e.preventDefault()})),void 0!==i&&i.length>0&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiPopover,{id:"operatorValuePopover",button:Object(I.jsx)(r.EuiExpression,{description:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeExpression.scopeFilterTypeButtonLabel",defaultMessage:"is {filterType}",values:{filterType:Mu(a)}}),value:t||"",isActive:this.state.isFilterListOpen,onClick:this.openFilterList}),isOpen:this.state.isFilterListOpen,closePopover:this.closeFilterList,panelPaddingSize:"none",ownFocus:!0,anchorPosition:"downLeft"},this.renderFilterListPopover())))}}function Iu(){const e=Object(d.d)(),t=Object(d.e)();return Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noFilterListsConfiguredTitle",defaultMessage:"No filter lists configured"}),iconType:"gear"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription",defaultMessage:"To configure scope, you must first use the {filterListsLink} settings page to create the list of values you want to include or exclude in the job rule.",values:{filterListsLink:Object(I.jsx)(r.EuiLink,{onClick:async()=>{const a=await e.getUrl({page:p.b.FILTER_LISTS_MANAGE});await t(a,!0)}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.createFilterListsDescription.filterListsLinkText",defaultMessage:"Filter Lists"}))}})))}function Du(){return Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.noPermissionToViewFilterListsTitle",defaultMessage:"You do not have permission to view filter lists"}),iconType:"gear"})}function Au({isEnabled:e,onEnabledChange:t,partitioningFieldNames:a,filterListIds:n,scope:i,updateScope:o}){const l=Object(m.e)("canGetFilters");if(null===a||0===a.length)return null;let c;return c=n.length>0?a.map(((e,t)=>{let a;return a=void 0!==i&&void 0!==i[e]?i[e]:function(e){const t={filter_type:ju.d.INCLUDE,enabled:!1};return void 0!==e&&e.length>0&&(t.filter_id=e[0]),t}(n),Object(I.jsx)(scope_expression_ScopeExpression,{key:t,fieldName:e,filterId:a.filter_id,filterType:a.filter_type,enabled:a.enabled,filterListIds:n,updateScope:o})})):!1===l?Object(I.jsx)(Du,null):Object(I.jsx)(Iu,null),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiTitle,null,Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.scopeTitle",defaultMessage:"Scope"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiCheckbox,{id:"enable_scope_checkbox",label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.scopeSection.addFilterListLabel",defaultMessage:"Add a filter list to limit where the job rule applies."}),checked:e,onChange:t}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),e&&Object(I.jsx)(s.a.Fragment,null,c),Object(I.jsx)(r.EuiSpacer,{size:"xxl"}))}function Lu({fieldValue:e,filterId:t,addItemToFilterList:a}){return Object(I.jsx)(r.EuiLink,{onClick:()=>a(e,t,!0)},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.addValueToFilterListLinkText",defaultMessage:"Add {fieldValue} to {filterId}",values:{fieldValue:e,filterId:t}}))}class delete_rule_modal_DeleteRuleModal extends i.Component{constructor(e){super(e),Se()(this,"deleteRule",(()=>{const{ruleIndex:e,deleteRuleAtIndex:t}=this.props;t(e),this.closeModal()})),Se()(this,"closeModal",(()=>{this.setState({isModalVisible:!1})})),Se()(this,"showModal",(()=>{this.setState({isModalVisible:!0})})),this.state={isModalVisible:!1}}render(){let e;return this.state.isModalVisible&&(e=Object(I.jsx)(r.EuiConfirmModal,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleTitle",defaultMessage:"Delete rule?"}),onCancel:this.closeModal,onConfirm:this.deleteRule,buttonColor:"danger",cancelButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteButtonLabel",defaultMessage:"Delete"}),defaultFocusedButton:r.EUI_MODAL_CONFIRM_BUTTON})),Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiLink,{color:"danger",onClick:()=>this.showModal()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.deleteRuleModal.deleteRuleLinkText",defaultMessage:"Delete rule"})),e)}}class edit_condition_link_EditConditionLink extends i.Component{constructor(e){super(e),Se()(this,"onChangeValue",(e=>{const t=e.target.value;this.setState({value:""!==t?+t:""})})),Se()(this,"onUpdateClick",(()=>{const{conditionIndex:e,updateConditionValue:t}=this.props;t(e,this.state.value)}));let t="";const a=this.props.anomaly,n=function(e,t){let a,n;const i=e.actual;void 0!==i&&(a=Array.isArray(i)?i[0]:i);const s=e.typical;switch(void 0!==s&&(n=Array.isArray(s)?s[0]:s),t){case ju.b.ACTUAL:return a;case ju.b.TYPICAL:return n;case ju.b.DIFF_FROM_TYPICAL:if(void 0!==i&&void 0!==s)return Math.abs(a-n)}}(a,e.appliesTo);void 0!==n&&(t=+Object(ou.b)(n,a.source.function)),this.state={value:t}}render(){const e=this.state.value;return Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateRuleConditionFromText",defaultMessage:"Update rule condition from {conditionValue} to",values:{conditionValue:this.props.conditionValue}}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1,className:"condition-edit-value-field"},Object(I.jsx)(r.EuiFieldNumber,{placeholder:o.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterValuePlaceholder",{defaultMessage:"Enter value"}),compressed:!0,value:e,onChange:this.onChangeValue,"aria-label":o.i18n.translate("xpack.ml.ruleEditor.editConditionLink.enterNumericValueForConditionAriaLabel",{defaultMessage:"Enter numeric value for condition"})})),""!==e&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiLink,{size:"s",onClick:()=>this.onUpdateClick()},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.editConditionLink.updateLinkText",defaultMessage:"Update"}))))}}class rule_action_panel_RuleActionPanel extends i.Component{constructor(e){super(e),Se()(this,"getEditRuleLink",(()=>{const{ruleIndex:e,setEditRuleIndex:t}=this.props;return Object(I.jsx)(r.EuiLink,{onClick:()=>t(e)},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.editRuleLinkText",defaultMessage:"Edit rule"}))})),Se()(this,"getDeleteRuleLink",(()=>{const{ruleIndex:e,deleteRuleAtIndex:t}=this.props;return Object(I.jsx)(delete_rule_modal_DeleteRuleModal,{ruleIndex:e,deleteRuleAtIndex:t})})),Se()(this,"getQuickEditConditionLink",(()=>{const e=this.rule.conditions;let t=null;return void 0!==this.rule.conditions&&1===e.length&&(t=Object(I.jsx)(edit_condition_link_EditConditionLink,{conditionIndex:0,conditionValue:e[0].value,appliesTo:e[0].applies_to,anomaly:this.props.anomaly,updateConditionValue:this.updateConditionValue})),t})),Se()(this,"getQuickAddToFilterListLink",(()=>{const{anomaly:e,addItemToFilterList:t}=this.props,a=this.rule.scope,n=Object.keys(a)[0],i=e.source[n],s=a[n].filter_id;return Object(I.jsx)(Lu,{fieldValue:i[0],filterId:s,addItemToFilterList:t})})),Se()(this,"updateConditionValue",((e,t)=>{const{job:a,anomaly:n,ruleIndex:i,updateRuleAtIndex:s}=this.props,r=a.analysis_config.detectors[n.detectorIndex],o=Object(x.cloneDeep)(r.custom_rules[i]),l=o.conditions;e<l.length&&(l[e].value=t),s(i,o)}));const{job:t,anomaly:a,ruleIndex:n}=this.props,i=t.analysis_config.detectors[a.detectorIndex].custom_rules;void 0!==i&&n<i.length&&(this.rule=i[n]),this.state={showAddToFilterListLink:!1}}componentDidMount(){const e=this.rule.scope;if(void 0!==e&&1===Object.keys(e).length){const t=Object.keys(e)[0],a=this.props.anomaly.source[t];if(void 0!==e[t]&&void 0!==a&&1===a.length&&a[0].length>0){const n=e[t].filter_id;be.ml.filters.filters({filterId:n}).then((e=>{-1===e.items.indexOf(a[0])&&this.setState({showAddToFilterListLink:!0})})).catch((e=>{console.log(`Error loading filter ${n}:`,e)}))}}}render(){if(void 0===this.rule)return null;const e=[{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.ruleTitle",defaultMessage:"Rule"}),description:wu(this.rule,this.props.anomaly)},{title:"",description:this.getEditRuleLink()},{title:"",description:this.getDeleteRuleLink()}],t=this.getQuickEditConditionLink();if(null!==t&&e.splice(1,0,{title:"",description:t}),!0===this.state.showAddToFilterListLink){const t=this.getQuickAddToFilterListLink();e.splice(e.length-2,0,{title:"",description:t})}return e[1].title=Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleActionPanel.actionsTitle",defaultMessage:"Actions"}),Object(I.jsx)(r.EuiPanel,{paddingSize:"m",className:"select-rule-action-panel"},Object(I.jsx)(r.EuiDescriptionList,{type:"column",listItems:e}))}}function Ru({job:e,anomaly:t,setEditRuleIndex:a,updateRuleAtIndex:n,deleteRuleAtIndex:i,addItemToFilterList:o}){const l=t.detectorIndex,c=e.analysis_config.detectors[l],d=c.custom_rules||[];let u;return d.length>0&&(u=d.map(((l,c)=>Object(I.jsx)(s.a.Fragment,{key:`rule_panel_${c}_${d.length}`},Object(I.jsx)(rule_action_panel_RuleActionPanel,{job:e,ruleIndex:c,anomaly:t,setEditRuleIndex:a,updateRuleAtIndex:n,deleteRuleAtIndex:i,addItemToFilterList:o}),Object(I.jsx)(r.EuiSpacer,{size:"l"}))))),Object(I.jsx)("div",{className:"select-rule-action"},d.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(gu,{job:e,detector:c,anomaly:t}),Object(I.jsx)(r.EuiSpacer,{size:"m"}),u,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiText,{style:{display:"inline"}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.orText",defaultMessage:"Or "}))),Object(I.jsx)(r.EuiLink,{onClick:()=>a(d.length)},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.selectRuleAction.createRuleLinkText",defaultMessage:"create a rule"})))}class rule_editor_flyout_RuleEditorFlyoutUI extends i.Component{constructor(e){super(e),Se()(this,"showFlyout",(e=>{let t=-1;const a=te.a.getJob(e.jobId);if(void 0===a){const{toasts:t}=this.props.kibana.services.notifications;return t.addDanger(o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.unableToConfigureRulesNotificationMesssage",{defaultMessage:"Unable to configure job rules as an error occurred obtaining details for job ID {jobId}",values:{jobId:e.jobId}})),void this.setState({job:a,isFlyoutVisible:!1})}this.partitioningFieldNames=Object(_e.h)(a,e.detectorIndex);const n=e.detectorIndex;void 0===a.analysis_config.detectors[n].custom_rules&&(t=0);let i=!1;0===t&&(i=0===this.partitioningFieldNames.length),this.setState({anomaly:e,job:a,ruleIndex:t,isConditionsEnabled:i,isScopeEnabled:!1,isFlyoutVisible:!0}),this.partitioningFieldNames.length>0&&this.canGetFilters&&be.ml.filters.filters().then((e=>{const t=e.map((e=>e.filter_id));this.setState({filterListIds:t})})).catch((e=>{console.log("Error loading list of filters:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithLoadingFilterListsNotificationMesssage",{defaultMessage:"Error loading the filter lists used in the job rule scope"}))}))})),Se()(this,"closeFlyout",(()=>{this.setState({isFlyoutVisible:!1})})),Se()(this,"setEditRuleIndex",(e=>{const t=this.state.anomaly.detectorIndex,a=this.state.job.analysis_config.detectors[t].custom_rules,n=void 0===a||e>=a.length?yu():a[e],i=0===this.partitioningFieldNames.length||void 0!==n.conditions&&n.conditions.length>0,s=void 0!==n.scope&&Object.keys(n.scope).length>0;!0===s&&Object.keys(n.scope).forEach((e=>{n.scope[e].enabled=!0})),this.setState({ruleIndex:e,rule:n,isConditionsEnabled:i,isScopeEnabled:s})})),Se()(this,"onSkipResultChange",(e=>{const t=e.target.checked;this.setState((e=>{const a=[...e.rule.actions],n=a.indexOf(ju.a.SKIP_RESULT);return-1===n&&t?a.push(ju.a.SKIP_RESULT):n>-1&&!t&&a.splice(n,1),{rule:{...e.rule,actions:a}}}))})),Se()(this,"onSkipModelUpdateChange",(e=>{const t=e.target.checked;this.setState((e=>{const a=[...e.rule.actions],n=a.indexOf(ju.a.SKIP_MODEL_UPDATE);return-1===n&&t?a.push(ju.a.SKIP_MODEL_UPDATE):n>-1&&!t&&a.splice(n,1),{rule:{...e.rule,actions:a}}}))})),Se()(this,"onConditionsEnabledChange",(e=>{const t=e.target.checked;this.setState((e=>{let a;return a=!1===t?[]:[vu()],{rule:{...e.rule,conditions:a},isConditionsEnabled:t}}))})),Se()(this,"addCondition",(()=>{this.setState((e=>{const t=[...e.rule.conditions];return t.push(vu()),{rule:{...e.rule,conditions:t}}}))})),Se()(this,"updateCondition",((e,t,a,n)=>{this.setState((i=>{const s=[...i.rule.conditions];return e<s.length&&(s[e]={applies_to:t,operator:a,value:n}),{rule:{...i.rule,conditions:s}}}))})),Se()(this,"deleteCondition",(e=>{this.setState((t=>{const a=[...t.rule.conditions];return e<a.length&&a.splice(e,1),{rule:{...t.rule,conditions:a}}}))})),Se()(this,"onScopeEnabledChange",(e=>{const t=e.target.checked;this.setState((e=>{const a={...e.rule};return!1===t&&delete a.scope,{rule:a,isScopeEnabled:t}}))})),Se()(this,"updateScope",((e,t,a,n)=>{this.setState((i=>{let s={...i.rule.scope};return void 0===s&&(s={}),s[e]={filter_id:t,filter_type:a,enabled:n},{rule:{...i.rule,scope:s}}}))})),Se()(this,"saveEdit",(()=>{const{rule:e,ruleIndex:t}=this.state;this.updateRuleAtIndex(t,e)})),Se()(this,"updateRuleAtIndex",((e,t)=>{const{toasts:a}=this.props.kibana.services.notifications,{job:n,anomaly:i}=this.state,s=n.job_id;(function(e,t,a,n){const i=e.analysis_config.detectors[t],s=Object(x.cloneDeep)(n),r=s.scope;void 0!==r&&Object.keys(r).forEach((e=>{!1===r[e].enabled?delete r[e]:delete r[e].enabled}));let o=[];return void 0===i.custom_rules?o=[s]:(o=Object(x.cloneDeep)(i.custom_rules),a<o.length?o[a]=s:o.push(s)),Eu(e,t,o)})(n,i.detectorIndex,e,t).then((e=>{e.success?(a.add({title:o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageTitle",{defaultMessage:"Changes to {jobId} detector rules saved",values:{jobId:s}}),color:"success",iconType:"check",text:o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.changesToJobDetectorRulesSavedNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})}),this.closeFlyout()):a.addDanger(o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:s}}))})).catch((e=>{console.error(e),a.addDanger(o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithSavingChangesToJobDetectorRulesNotificationMessage",{defaultMessage:"Error saving changes to {jobId} detector rules",values:{jobId:s}}))}))})),Se()(this,"deleteRuleAtIndex",(e=>{const{toasts:t}=this.props.kibana.services.notifications,{job:a,anomaly:n}=this.state,i=a.job_id,s=n.detectorIndex;(function(e,t,a){const n=e.analysis_config.detectors[t];let i=[];return void 0!==n.custom_rules&&a<n.custom_rules.length?(i=Object(x.cloneDeep)(n.custom_rules),i.splice(a,1),Eu(e,t,i)):Promise.reject(new Error(o.i18n.translate("xpack.ml.ruleEditor.deleteJobRule.ruleNoLongerExistsErrorMessage",{defaultMessage:"Rule no longer exists for detector index {detectorIndex} in job {jobId}",values:{detectorIndex:t,jobId:e.job_id}})))})(a,s,e).then((e=>{if(e.success){t.addSuccess(o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.ruleDeletedFromJobDetectorNotificationMessage",{defaultMessage:"Rule deleted from {jobId} detector",values:{jobId:i}}));const e=te.a.getJob(n.jobId);e.analysis_config.detectors[s].custom_rules?this.setState({job:{...e}}):this.closeFlyout()}else t.addDanger(o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:i}}))})).catch((e=>{console.error(e);let a=o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithDeletingRuleFromJobDetectorNotificationMessage",{defaultMessage:"Error deleting rule from {jobId} detector",values:{jobId:i}});e.error&&(a+=` : ${Object(Re.b)(e.error)}`),t.addDanger(a)}))})),Se()(this,"addItemToFilterList",((e,t,a)=>{const{toasts:n}=this.props.kibana.services.notifications;(function(e,t){return new Promise(((a,n)=>{be.ml.filters.updateFilter(t,void 0,[e],void 0).then((e=>{a(e)})).catch((e=>{n(e)}))}))})(e,t).then((()=>{!0===a&&(n.add({title:o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageTitle",{defaultMessage:"Added {item} to {filterId}",values:{item:e,filterId:t}}),color:"success",iconType:"check",text:o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.addedItemToFilterListNotificationMessageDescription",{defaultMessage:"Note that changes will take effect for new results only."})}),this.closeFlyout())})).catch((a=>{console.log(`Error adding ${e} to filter ${t}:`,a),n.addDanger(o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.errorWithAddingItemToFilterListNotificationMessage",{defaultMessage:"An error occurred adding {item} to filter {filterId}",values:{item:e,filterId:t}}))}))})),this.state={anomaly:{},job:{},ruleIndex:-1,rule:yu(),skipModelUpdate:!1,isConditionsEnabled:!1,isScopeEnabled:!1,filterListIds:[],isFlyoutVisible:!1},this.partitioningFieldNames=[],this.canGetFilters=Object(m.e)("canGetFilters")}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showFlyout)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}render(){const e=this.props.kibana.services.docLinks.links.ml.customRules,{isFlyoutVisible:t,job:a,anomaly:n,ruleIndex:i,rule:l,filterListIds:c,isConditionsEnabled:d,isScopeEnabled:u}=this.state;if(!1===t)return null;let p;if(-1===i)p=Object(I.jsx)(r.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},Object(I.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(I.jsx)(r.EuiTitle,{size:"m"},Object(I.jsx)("h1",{id:"flyoutTitle"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRulesTitle",defaultMessage:"Edit job rules"})))),Object(I.jsx)(r.EuiFlyoutBody,null,Object(I.jsx)(Ru,{job:a,anomaly:n,setEditRuleIndex:this.setEditRuleIndex,updateRuleAtIndex:this.updateRuleAtIndex,deleteRuleAtIndex:this.deleteRuleAtIndex,addItemToFilterList:this.addItemToFilterList})),Object(I.jsx)(r.EuiFlyoutFooter,null,Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))))));else{const t=n.detectorIndex,s=a.analysis_config.detectors[t],m=s.custom_rules,b=void 0===m||i>=m.length,f=this.partitioningFieldNames&&this.partitioningFieldNames.length>0,h=-1===ju.c.indexOf(n.source.function),g=o.i18n.translate("xpack.ml.ruleEditor.ruleEditorFlyout.conditionsDescription",{defaultMessage:"Add numeric conditions for when the job rule applies. Multiple conditions are combined using AND."});p=Object(I.jsx)(r.EuiFlyout,{className:"ml-rule-editor-flyout",onClose:this.closeFlyout,"aria-labelledby":"flyoutTitle"},Object(I.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(I.jsx)(r.EuiTitle,{size:"m"},Object(I.jsx)("h1",{id:"flyoutTitle"},!0===b?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.createRuleTitle",defaultMessage:"Create job rule"}):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.editRuleTitle",defaultMessage:"Edit job rule"})))),Object(I.jsx)(r.EuiFlyoutBody,null,Object(I.jsx)(gu,{job:a,detector:s,anomaly:n}),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiText,null,Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription",defaultMessage:"Job rules instruct anomaly detectors to change their behavior based on domain-specific knowledge that you provide. When you create a job rule, you can specify conditions, scope, and actions. When the conditions of a job rule are satisfied, its actions are triggered. {learnMoreLink}",values:{learnMoreLink:Object(I.jsx)(r.EuiLink,{href:e,target:"_blank"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rulesDescription.learnMoreLinkText",defaultMessage:"Learn more"}))}}))),Object(I.jsx)(r.EuiSpacer,null),Object(I.jsx)(r.EuiTitle,null,Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.actionTitle",defaultMessage:"Action"}))),Object(I.jsx)(xu,{actions:l.actions,onSkipResultChange:this.onSkipResultChange,onSkipModelUpdateChange:this.onSkipModelUpdateChange}),Object(I.jsx)(r.EuiSpacer,{size:"xl"}),Object(I.jsx)(r.EuiTitle,null,Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsTitle",defaultMessage:"Conditions"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),!0===h?Object(I.jsx)(r.EuiCheckbox,{id:"enable_conditions_checkbox",className:"scope-enable-checkbox",label:g,checked:d,onChange:this.onConditionsEnabledChange,disabled:!h||!f}):Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.conditionsNotSupportedTitle",defaultMessage:"Conditions are not supported for detectors using the {functionName} function",values:{functionName:n.source.function}}),iconType:"iInCircle"}),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(Cu,{isEnabled:d,conditions:l.conditions,addCondition:this.addCondition,updateCondition:this.updateCondition,deleteCondition:this.deleteCondition}),Object(I.jsx)(r.EuiSpacer,{size:"xl"}),Object(I.jsx)(Au,{isEnabled:u,onEnabledChange:this.onScopeEnabledChange,partitioningFieldNames:this.partitioningFieldNames,filterListIds:c,scope:l.scope,updateScope:this.updateScope}),Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.rerunJobTitle",defaultMessage:"Rerun job"}),color:"warning",iconType:"help"},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.whenChangesTakeEffectDescription",defaultMessage:"Changes to job rules take effect for new results only."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.howToApplyChangesToExistingResultsDescription",defaultMessage:"To apply these changes to existing results you must clone and rerun the job. Note rerunning the job may take some time and should only be done once you have completed all your changes to the rules for this job."})))),Object(I.jsx)(r.EuiFlyoutFooter,null,Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:this.closeFlyout,flush:"left"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.closeButtonLabel",defaultMessage:"Close"}))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{onClick:this.saveEdit,isDisabled:!Ou(l),fill:!0},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.ruleEditor.ruleEditorFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return Object(I.jsx)(s.a.Fragment,null,p)}}const Nu=Object(Si.withKibana)(rule_editor_flyout_RuleEditorFlyoutUI);class anomalies_table_AnomaliesTableInternal extends i.Component{constructor(e){super(e),Se()(this,"isShowingAggregatedData",(()=>"second"!==this.props.tableData.interval)),Se()(this,"toggleRow",(async(e,t=lu)=>{const a={...this.state.itemIdToExpandedRowMap};if(a[e.rowId])delete a[e.rowId];else{const n="mlcategory"===e.entityName?Object(x.get)(this.props.tableData,["examplesByJobId",e.jobId,e.entityValue]):void 0;let i;if(void 0!==n)try{i=await be.ml.results.getCategoryDefinition(e.jobId,e.source.mlcategory[0]),i.terms&&i.terms.length>du&&(i.terms=`${i.terms.substring(0,du)}...`),i.regex&&i.regex.length>du&&(i.terms=`${i.regex.substring(0,du)}...`)}catch(e){console.log("Error fetching category definition for row item.",e)}a[e.rowId]=Object(I.jsx)(anomaly_details_AnomalyDetails,{tabIndex:t,anomaly:e,examples:n,definition:i,isAggregatedData:this.isShowingAggregatedData(),filter:this.props.filter,influencerFilter:this.props.influencerFilter,influencersLimit:5})}this.setState({itemIdToExpandedRowMap:a})})),Se()(this,"onMouseOverRow",(e=>{void 0!==this.mouseOverRecord?this.mouseOverRecord.rowId!==e.rowId&&(hu.a.rowMouseleave$.next({record:this.mouseOverRecord}),hu.a.rowMouseenter$.next({record:e})):hu.a.rowMouseenter$.next({record:e}),this.mouseOverRecord=e})),Se()(this,"onMouseLeaveRow",(()=>{void 0!==this.mouseOverRecord&&(hu.a.rowMouseleave$.next({record:this.mouseOverRecord}),this.mouseOverRecord=void 0)})),Se()(this,"setShowRuleEditorFlyoutFunction",(e=>{this.setState({showRuleEditorFlyout:e})})),Se()(this,"unsetShowRuleEditorFlyoutFunction",(()=>{this.setState({showRuleEditorFlyout:()=>{}})})),Se()(this,"onTableChange",(({page:e,sort:t})=>{const{tableState:a,updateTableState:n}=this.props;n({pageIndex:e&&void 0!==e.index?e.index:a.pageIndex,pageSize:e&&void 0!==e.size?e.size:a.pageSize,sortField:t&&void 0!==t.field&&"string"==typeof t.field?t.field:a.sortField,sortDirection:t&&void 0!==t.direction?t.direction:a.sortDirection})})),this.state={itemIdToExpandedRowMap:{},showRuleEditorFlyout:()=>{}}}static getDerivedStateFromProps(e,t){const a=t.itemIdToExpandedRowMap;return void 0!==Object.keys(a).find((t=>void 0===e.tableData.anomalies.find((e=>e.rowId===t))))?{itemIdToExpandedRowMap:{}}:null}render(){const{bounds:e,tableData:t,filter:a,influencerFilter:n,tableState:i}=this.props;if(void 0===t||void 0===t.anomalies||0===t.anomalies.length)return Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,null,Object(I.jsx)("h4",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomaliesTable.noMatchingAnomaliesFoundTitle",defaultMessage:"No matching anomalies found"})))));const o=bu(t.anomalies,t.jobIds,t.examplesByJobId,this.isShowingAggregatedData(),t.interval,e,t.showViewSeriesLink,this.state.showRuleEditorFlyout,this.state.itemIdToExpandedRowMap,this.toggleRow,a,n),l={sort:{field:i.sortField,direction:i.sortDirection}},c={pageIndex:i.pageIndex,pageSize:i.pageSize,totalItemCount:t.anomalies.length,pageSizeOptions:[10,25,100]};return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Nu,{setShowFunction:this.setShowRuleEditorFlyoutFunction,unsetShowFunction:this.unsetShowRuleEditorFlyoutFunction}),Object(I.jsx)(r.EuiInMemoryTable,{className:"ml-anomalies-table eui-textOverflowWrap",items:t.anomalies,columns:o,pagination:c,sorting:l,itemId:"rowId",itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,compressed:!0,rowProps:e=>({onMouseOver:()=>this.onMouseOverRow(e),onMouseLeave:()=>this.onMouseLeaveRow(),"data-test-subj":`mlAnomaliesListRow row-${e.rowId}`}),"data-test-subj":"mlAnomaliesTable",onTableChange:this.onTableChange}))}}const Pu=e=>{const[t,a]=Object(c.b)("mlAnomaliesTable",{pageIndex:0,pageSize:25,sortField:"severity",sortDirection:"desc"});return Object(I.jsx)(anomalies_table_AnomaliesTableInternal,h()({},e,{tableState:t,updateTableState:a}))},zu="error",Bu="info",Ju="success",Vu="warning";function Uu({message:e,status:t,...a}){return Object(I.jsx)(r.EuiCallOut,h()({size:"s"},function(e,t){switch(t){case zu:return{title:e,iconType:"cross",color:"danger"};case Vu:return{title:e,iconType:"alert",color:"warning"};case Ju:return{title:e,iconType:"check",color:"success"};case Bu:return{title:e,iconType:"iInCircle",color:"primary"}}}(e,t),a))}function Gu(e){return[{field:"forecast_create_timestamp",name:o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.createdColumnName",{defaultMessage:"Created"}),dataType:"date",render:e=>Object(Ud.c)(e),sortable:!0},{field:"forecast_start_timestamp",name:o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:e=>Object(Ud.c)(e),sortable:!0},{field:"forecast_end_timestamp",name:o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.toColumnName",{defaultMessage:"To"}),dataType:"date",render:e=>Object(Ud.c)(e),sortable:!0},{name:o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewColumnName",{defaultMessage:"View"}),width:"60px",render:t=>{const a=o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastsList.viewForecastAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:Object(Ud.c)(t.forecast_create_timestamp)}});return Object(I.jsx)(r.EuiButtonIcon,{onClick:()=>e(t.forecast_id),iconType:"visLine","aria-label":a})}}]}function qu({forecasts:e,viewForecast:t}){return Object(I.jsx)(r.EuiText,null,Object(I.jsx)("h3",{"aria-describedby":"ml_aria_description_forecasting_modal_view_list",style:{display:"inline",paddingRight:"5px"}},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.previousForecastsTitle",defaultMessage:"Previous forecasts"})),Object(I.jsx)(r.EuiToolTip,{position:"right",content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastsList.listsOfFiveRecentlyRunForecastsTooltip",defaultMessage:"Lists a maximum of five of the most recently run forecasts."})},Object(I.jsx)(r.EuiIcon,{type:"questionInCircle",size:"s"})),Object(I.jsx)(r.EuiInMemoryTable,{items:e,columns:Gu(t),pagination:!1,"data-test-subj":"mlModalForecastTable",rowProps:e=>({"data-test-subj":`mlForecastsListRow row-${e.rowId}`})}))}qu.propType={forecasts:gi.a.array,viewForecast:gi.a.func.isRequired};const Wu=-1,Hu=0,Yu=1,$u=-10;function Xu({state:e}){return e===Hu?Object(I.jsx)(r.EuiLoadingSpinner,{size:"m"}):e===Yu?Object(I.jsx)(r.EuiIcon,{type:"check",size:"m",color:"primary"}):e===$u?Object(I.jsx)(r.EuiIcon,{type:"cross",size:"m",color:"danger"}):void 0}function Ku({forecastProgress:e,jobOpeningState:t,jobClosingState:a}){return Object(I.jsx)("div",null,t!==Wu&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.openingJobTitle",defaultMessage:"Opening job…"})))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Xu,{state:t}))),Object(I.jsx)(r.EuiSpacer,{size:"s"})),e!==Wu&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.runningForecastTitle",defaultMessage:"Running forecast…"})))),e>=0&&Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiToolTip,{position:"top",content:e+"%"},Object(I.jsx)(r.EuiProgress,{size:"l",value:e,max:100}))),e===$u&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Xu,{state:$u}))),Object(I.jsx)(r.EuiSpacer,{size:"s"})),a!==Wu&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiText,{size:"xs"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closingJobTitle",defaultMessage:"Closing job…"})))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Xu,{state:a})))))}function Qu({job:e,newForecastDuration:t,isNewForecastDurationValid:a,newForecastDurationErrors:n,onNewForecastDurationChange:i,runForecast:s,isForecastRequested:l,forecastProgress:c,jobOpeningState:d,jobClosingState:u}){const p=function(e,t){return!1===Object(V.b)()?{isDisabled:!0,isDisabledToolTipText:o.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.noMLNodesAvailableTooltip",{defaultMessage:"There are no ML nodes available."})}:!1===Object(m.e)("canForecastJob")?{isDisabled:!0,isDisabledToolTipText:Object(m.f)("canForecastJob")}:e.state!==qi.c.OPENED&&e.state!==qi.c.CLOSED?{isDisabled:!0,isDisabledToolTipText:o.i18n.translate("xpack.ml.timeSeriesExplorer.runControls.forecastsCanNotBeRunOnJobsTooltip",{defaultMessage:"Forecasts cannot be run on {jobState} jobs",values:{jobState:e.state}})}:{isDisabled:t}}(e,l),b=Object(I.jsx)(r.EuiFieldText,{name:"forecastDuration",value:t,disabled:p.isDisabled,isInvalid:!a,onChange:i,fullWidth:!0}),f=Object(I.jsx)(r.EuiButton,{onClick:s,isDisabled:p.isDisabled||!a,"data-test-subj":"mlModalForecastButtonRun"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runButtonLabel",defaultMessage:"Run"}));return Object(I.jsx)("div",null,Object(I.jsx)(r.EuiText,null,Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.runNewForecastTitle",defaultMessage:"Run a new forecast"}))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiForm,null,Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.durationLabel",defaultMessage:"Duration"}),fullWidth:!0,isInvalid:!a,error:n,helpText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.runControls.forecastMaximumLengthHelpText",defaultMessage:"Length of forecast, up to a maximum of {maximumForecastDurationDays} days. Use s for seconds, m for minutes, h for hours, d for days, w for weeks.",values:{maximumForecastDurationDays:tp}})},void 0===p.isDisabledToolTipText?b:Object(I.jsx)(r.EuiToolTip,{position:"right",content:p.isDisabledToolTipText},b))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFormRow,{hasEmptyLabelSpace:!0},void 0===p.isDisabledToolTipText?f:Object(I.jsx)(r.EuiToolTip,{position:"left",content:p.isDisabledToolTipText},f))))),Object(I.jsx)(r.EuiSpacer,{size:"s"}),!0===l&&Object(I.jsx)(Ku,{forecastProgress:c,jobOpeningState:d,jobClosingState:u}))}function Zu(e){return Object(I.jsx)(r.EuiModal,{onClose:e.close,maxWidth:860,"data-test-subj":"mlModalForecast"},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiModalHeaderTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastingTitle",defaultMessage:"Forecasting"}))),Object(I.jsx)(r.EuiModalBody,null,e.messages.map(((e,t)=>Object(I.jsx)(s.a.Fragment,{key:t},Object(I.jsx)(Uu,e),Object(I.jsx)(r.EuiSpacer,{size:"m"})))),e.forecasts.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(qu,{forecasts:e.forecasts,viewForecast:e.viewForecast}),Object(I.jsx)(r.EuiSpacer,null)),Object(I.jsx)(Qu,e)),Object(I.jsx)(r.EuiModalFooter,null,Object(I.jsx)(r.EuiButtonEmpty,{onClick:e.close,size:"s","data-test-subj":"mlModalForecastButtonClose"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.closeButtonLabel",defaultMessage:"Close"}))))}Ku.propType={forecastProgress:gi.a.number,jobOpeningState:gi.a.number,jobClosingState:gi.a.number},Qu.propType={job:gi.a.object,newForecastDuration:gi.a.string,isNewForecastDurationValid:gi.a.bool,newForecastDurationErrors:gi.a.array,onNewForecastDurationChange:gi.a.func.isRequired,runForecast:gi.a.func.isRequired,isForecastRequested:gi.a.bool,forecastProgress:gi.a.number,jobOpeningState:gi.a.number,jobClosingState:gi.a.number},Zu.propType={job:gi.a.object,forecasts:gi.a.array,close:gi.a.func.isRequired,viewForecast:gi.a.func.isRequired,runForecast:gi.a.func.isRequired,newForecastDuration:gi.a.string,isNewForecastDurationValid:gi.a.bool,newForecastDurationErrors:gi.a.array,onNewForecastDurationChange:gi.a.func.isRequired,isForecastRequested:gi.a.bool,forecastProgress:gi.a.number,jobOpeningState:gi.a.number,jobClosingState:gi.a.number,messages:gi.a.array};var ep=a(169);const tp=3650,ap="6.1.0",np=864e5*tp,ip=12e4;function sp(){return{isModalVisible:!1,previousForecasts:[],isForecastRequested:!1,forecastProgress:Wu,jobOpeningState:Wu,jobClosingState:Wu,newForecastDuration:"1d",isNewForecastDurationValid:!0,newForecastDurationErrors:[],messages:[]}}class forecasting_modal_ForecastingModalUI extends i.Component{constructor(e){super(e),Se()(this,"addMessage",((e,t,a=!1)=>{const n={message:e,status:t};this.setState((e=>({messages:a?[n]:[...e.messages,n]})))})),Se()(this,"viewForecast",(e=>{this.props.setForecastId(e),this.closeModal()})),Se()(this,"onNewForecastDurationChange",(e=>{const t=[];let a=!0;const n=Object(au.a)(e.target.value);null===n?(a=!1,t.push(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.invalidDurationFormatErrorMessage",{defaultMessage:"Invalid duration format"}))):n.asMilliseconds()>np?(a=!1,t.push(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeGreaterThanMaximumErrorMessage",{defaultMessage:"Forecast duration must not be greater than {maximumForecastDurationDays} days",values:{maximumForecastDurationDays:tp}}))):0===n.asMilliseconds()&&(a=!1,t.push(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastDurationMustNotBeZeroErrorMessage",{defaultMessage:"Forecast duration must not be zero"}))),this.setState({newForecastDuration:e.target.value,isNewForecastDurationValid:a,newForecastDurationErrors:t})})),Se()(this,"checkJobStateAndRunForecast",(()=>{this.setState({isForecastRequested:!0,messages:[]}),this.props.job.state===qi.c.CLOSED?this.openJobAndRunForecast():this.runForecast(!1)})),Se()(this,"openJobAndRunForecast",(()=>{this.setState({jobOpeningState:Hu}),te.a.openJob(this.props.job.job_id).then((()=>{this.setState({jobOpeningState:Yu}),this.runForecast(!0)})).catch((e=>{console.log("Time series forecast modal - could not open job:",e),this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithOpeningJobBeforeRunningForecastErrorMessage",{defaultMessage:"Error opening job before running forecast"}),zu),this.setState({jobOpeningState:$u})}))})),Se()(this,"runForecastErrorHandler",((e,t)=>{this.setState({forecastProgress:$u}),console.log("Time series forecast modal - error running forecast:",e),e&&e.message?this.addMessage(e.message,zu,!0):this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.unexpectedResponseFromRunningForecastErrorMessage",{defaultMessage:"Unexpected response from running forecast. The request may have failed."}),zu,!0),!0===t&&(this.setState({jobClosingState:Hu}),te.a.closeJob(this.props.job.job_id).then((()=>{this.setState({jobClosingState:Yu})})).catch((e=>{console.log("Time series forecast modal - could not close job:",e),this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobErrorMessage",{defaultMessage:"Error closing job"}),zu),this.setState({jobClosingState:$u})})))})),Se()(this,"runForecast",(e=>{this.setState({forecastProgress:0});const t=Object(au.a)(this.state.newForecastDuration).asSeconds();ep.a.runForecast(this.props.job.job_id,`${t}s`).then((t=>{void 0!==t.forecast_id?this.waitForForecastResults(t.forecast_id,e):this.runForecastErrorHandler(t,e)})).catch((t=>this.runForecastErrorHandler(t,e)))})),Se()(this,"waitForForecastResults",((e,t)=>{let a=0,n=0;this.forecastChecker=setInterval((()=>{ep.a.getForecastRequestStats(this.props.job,e).then((i=>{const s=Object(x.get)(i,["stats","forecast_progress"],a),r=Object(x.get)(i,["stats","forecast_status"]);s>a&&this.setState({forecastProgress:Math.round(100*s)});let l=Object(x.get)(i,["stats","forecast_messages"],[]);l=l.map((e=>({message:e,status:Vu}))),this.setState({messages:l}),r===qi.b.FINISHED?(clearInterval(this.forecastChecker),!0===t?(this.setState({jobClosingState:Hu}),te.a.closeJob(this.props.job.job_id).then((()=>{this.setState({jobClosingState:Yu}),this.props.setForecastId(e),this.closeAfterRunningForecast()})).catch((t=>{console.log("Time series forecast modal - could not close job:",t),this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithClosingJobAfterRunningForecastErrorMessage",{defaultMessage:"Error closing job after running forecast"}),zu),this.setState({jobClosingState:$u}),this.props.setForecastId(e)}))):(this.props.setForecastId(e),this.closeAfterRunningForecast())):s===a?(n+=250,n>ip&&(console.log("Forecast request has not progressed for 120000ms. Cancelling check."),this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.noProgressReportedForNewForecastErrorMessage",{defaultMessage:"No progress reported for the new forecast for {WarnNoProgressMs}ms.An error may have occurred whilst running the forecast.",values:{WarnNoProgressMs:ip}}),zu),this.props.setForecastId(e),this.setState({forecastProgress:$u}),clearInterval(this.forecastChecker))):(s>a&&(a=s),n=0)})).catch((e=>{console.log("Time series forecast modal - error loading stats of forecast from elasticsearch:",e),this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithLoadingStatsOfRunningForecastErrorMessage",{defaultMessage:"Error loading stats of running forecast."}),zu),this.setState({forecastProgress:$u}),clearInterval(this.forecastChecker)}))}),250)})),Se()(this,"openModal",(()=>{const e=this.props.job;if("object"==typeof e){const{timefilter:t}=this.props.kibana.services.data.query.timefilter,a=t.getActiveBounds(),n={term:{forecast_status:qi.b.FINISHED}};ep.a.getForecastsSummary(e,n,a.min.valueOf(),5).then((e=>{this.setState({previousForecasts:e.forecasts})})).catch((e=>{console.log("Time series forecast modal - error obtaining forecasts summary:",e),this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.errorWithObtainingListOfPreviousForecastsErrorMessage",{defaultMessage:"Error obtaining list of previous forecasts"}),zu)}));const i=this.props.entities.map((e=>e.fieldName));i.length>0&&be.ml.getCardinalityOfFields({index:e.datafeed_config.indices,fieldNames:i,query:e.datafeed_config.query,timeFieldName:e.data_description.time_field,earliestMs:e.data_counts.earliest_record_timestamp,latestMs:e.data_counts.latest_record_timestamp}).then((e=>{let t=1;Object.values(e).forEach((e=>{t*=e})),t>100&&this.addMessage(o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.dataContainsMorePartitionsMessage",{defaultMessage:"Note that this data contains more than {warnNumPartitions} partitions so running a forecast may take a long time and consume a high amount of resource",values:{warnNumPartitions:100}}),Vu)})).catch((e=>{console.log("Time series forecast modal - error obtaining cardinality of fields:",e)})),this.setState({isModalVisible:!0})}})),Se()(this,"closeAfterRunningForecast",(()=>{0===this.state.messages.length&&setTimeout((()=>{this.closeModal()}),1e3)})),Se()(this,"closeModal",(()=>{null!==this.forecastChecker&&clearInterval(this.forecastChecker),this.setState(sp())})),this.state=sp(),this.forecastChecker=null}render(){let e=!1,t=null;const{job:a}=this.props;if(void 0!==a){void 0!==a.analysis_config.detectors[this.props.detectorIndex].over_field_name?(e=!0,t=o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingNotAvailableForPopulationDetectorsMessage",{defaultMessage:"Forecasting is not available for population detectors with an over field"})):!1===Object(_e.j)(a,ap)&&(e=!0,t=o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastingModal.forecastingOnlyAvailableForJobsCreatedInSpecifiedVersionMessage",{defaultMessage:"Forecasting is only available for jobs created in version {minVersion} or later",values:{minVersion:ap}}))}const n=Object(I.jsx)(r.EuiButton,{onClick:this.openModal,isDisabled:e,"data-test-subj":"mlSingleMetricViewerButtonForecast"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.forecastingModal.forecastButtonLabel",defaultMessage:"Forecast"}));return Object(I.jsx)("div",null,e?Object(I.jsx)(r.EuiToolTip,{position:"left",content:t},n):n,this.state.isModalVisible&&Object(I.jsx)(Zu,{job:this.props.job,forecasts:this.state.previousForecasts,close:this.closeModal,viewForecast:this.viewForecast,runForecast:this.checkJobStateAndRunForecast,newForecastDuration:this.state.newForecastDuration,onNewForecastDurationChange:this.onNewForecastDurationChange,isNewForecastDurationValid:this.state.isNewForecastDurationValid,newForecastDurationErrors:this.state.newForecastDurationErrors,isForecastRequested:this.state.isForecastRequested,forecastProgress:this.state.forecastProgress,jobOpeningState:this.state.jobOpeningState,jobClosingState:this.state.jobClosingState,messages:this.state.messages}))}}const rp=Object(Si.withKibana)(forecasting_modal_ForecastingModalUI);var op=a(249);const lp=[{value:"auto",text:o.i18n.translate("xpack.ml.controls.selectInterval.autoLabel",{defaultMessage:"Auto"})},{value:"hour",text:o.i18n.translate("xpack.ml.controls.selectInterval.hourLabel",{defaultMessage:"1 hour"})},{value:"day",text:o.i18n.translate("xpack.ml.controls.selectInterval.dayLabel",{defaultMessage:"1 day"})},{value:"second",text:o.i18n.translate("xpack.ml.controls.selectInterval.showAllLabel",{defaultMessage:"Show all"})}];function cp(e){const t=lp.find((t=>t.value===e));let a={display:lp[0].text,val:lp[0].value};return void 0!==t&&(a={display:t.text,val:t.value}),a}const dp=cp("auto"),up=()=>Object(c.b)("mlSelectInterval",dp),pp=()=>{const[e,t]=up();return Object(I.jsx)(mp,{interval:e,onChange:t})},mp=({interval:e,onChange:t})=>Object(I.jsx)(r.EuiSelect,{prepend:o.i18n.translate("xpack.ml.explorer.intervalLabel",{defaultMessage:"Interval"}),append:Object(I.jsx)(r.EuiToolTip,{content:o.i18n.translate("xpack.ml.explorer.intervalTooltip",{defaultMessage:"Show only the highest severity anomaly for each interval (such as hour or day) or show all anomalies in the selected time period."})},Object(I.jsx)(r.EuiIcon,{type:"questionInCircle",color:"subdued"})),compressed:!0,id:"selectInterval",options:lp,value:e.val,onChange:e=>{t(cp(e.target.value))}});var bp=a(139);const fp=({dataNotChartable:e,entities:t})=>Object(I.jsx)(r.EuiEmptyPrompt,{iconType:"iInCircle",title:Object(I.jsx)("h2",null,o.i18n.translate("xpack.ml.timeSeriesExplorer.noResultsFoundLabel",{defaultMessage:"No results found"})),body:e?Object(I.jsx)("p",null,o.i18n.translate("xpack.ml.timeSeriesExplorer.dataNotChartableDescription",{defaultMessage:"Model plot is not collected for the selected {entityCount, plural, one {entity} other {entities}}\nand the source data cannot be plotted for this detector.",values:{entityCount:t.length}})):Object(I.jsx)("p",null,o.i18n.translate("xpack.ml.timeSeriesExplorer.tryWideningTheTimeSelectionDescription",{defaultMessage:"Try widening the time selection or moving further back in time."}))}),hp=({viewId:e})=>{const t=Object(d.d)(),a=Object(d.e)(),n=Object(i.useMemo)((()=>[{id:"timeseriesexplorer",label:o.i18n.translate("xpack.ml.anomalyResultsViewSelector.singleMetricViewerLabel",{defaultMessage:"View results in the Single Metric Viewer"}),iconType:"visLine",value:p.b.SINGLE_METRIC_VIEWER,"data-test-subj":"mlAnomalyResultsViewSelectorSingleMetricViewer"},{id:"explorer",label:o.i18n.translate("xpack.ml.anomalyResultsViewSelector.anomalyExplorerLabel",{defaultMessage:"View results in the Anomaly Explorer"}),iconType:"visTable",value:p.b.ANOMALY_EXPLORER,"data-test-subj":"mlAnomalyResultsViewSelectorExplorer"}]),[]),[s]=Object(c.c)("_g");return Object(I.jsx)(r.EuiButtonGroup,{legend:o.i18n.translate("xpack.ml.anomalyResultsViewSelector.buttonGroupLegend",{defaultMessage:"Anomaly results view selector"}),name:"anomalyResultsViewSelector","data-test-subj":"mlAnomalyResultsViewSelector",options:n,idSelected:e,onChange:e=>(async e=>{const n=await t.getUrl({page:e,pageState:{globalState:s}});await a(n)})(e),isIconOnly:!0})};var gp=a(180);const jp=({children:e,dateFormatTz:t,resizeRef:a,noSingleMetricJobsFound:n})=>{const{services:{docLinks:i}}=Object(d.b)(),o=i.links.ml.anomalyDetection;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("div",{className:"ml-time-series-explorer",ref:a,"data-test-subj":"mlPageSingleMetricViewer"},Object(I.jsx)(Q.a,null,Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(hp,{viewId:"timeseriesexplorer"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.pageTitle",defaultMessage:"Single Metric Viewer"})))),n?null:Object(I.jsx)(gp.a,{dateFormatTz:t,singleSelection:!0,timeseriesOnly:!0}),e,Object(I.jsx)(ur.a,{docLink:o})))},xp="CLEAR",vp="SET_DETECTOR_INDEX",yp="SET_ENTITIES",Op="SET_FORECAST_ID",Ep="SET_ZOOM",wp="UNSET_ZOOM",Mp="SET_FUNCTION_DESCRIPTION",Sp=500;function _p(e,t){const a=e.analysis_config,n=a.detectors[t],i={jobId:e.job_id,detectorIndex:t,metricFunction:n.function===Pt.b.LAT_LONG?Pt.b.LAT_LONG:Object(_e.q)(n.function),timeField:e.data_description.time_field,interval:e.analysis_config.bucket_span,datafeedConfig:e.datafeed_config,summaryCountFieldName:e.analysis_config.summary_count_field_name};void 0!==n.field_name&&(i.metricFieldName=n.field_name);const s=a.summary_count_field_name;if(i.metricFunction===Pt.a.COUNT&&void 0!==s&&s!==It.a&&s!==It.d){let t;const a=Object(x.get)(e.datafeed_config,"aggregations")||Object(x.get)(e.datafeed_config,"aggs");void 0!==a&&Object.values(a).length>0&&(t=Object(x.get)(Object.values(a)[0],["aggregations",s,Pt.a.CARDINALITY,"field"])||Object(x.get)(Object.values(a)[0],["aggs",s,Pt.a.CARDINALITY,"field"])),n.function!==Pt.b.NON_ZERO_COUNT&&n.function!==Pt.b.LOW_NON_ZERO_COUNT&&n.function!==Pt.b.HIGH_NON_ZERO_COUNT&&n.function!==Pt.b.COUNT&&n.function!==Pt.b.HIGH_COUNT&&n.function!==Pt.b.LOW_COUNT||void 0===t?(i.metricFunction=Pt.a.SUM,i.metricFieldName=s):(i.metricFunction=Pt.a.CARDINALITY,i.metricFieldName=void 0)}return i}const Tp={getMetricData:function(e,t,a,n,i,s,r){if(Object(_e.l)(e,t)&&Object(_e.m)(e,t,a)){const r=[],o=e.analysis_config.detectors[t];if(void 0!==o.partition_field_name){const e=Object(x.find)(a,{fieldName:o.partition_field_name});void 0!==e&&r.push({fieldName:"partition_field_name",fieldValue:e.fieldName},{fieldName:"partition_field_value",fieldValue:e.fieldValue})}if(void 0!==o.over_field_name){const e=Object(x.find)(a,{fieldName:o.over_field_name});void 0!==e&&r.push({fieldName:"over_field_name",fieldValue:e.fieldName},{fieldName:"over_field_value",fieldValue:e.fieldValue})}if(void 0!==o.by_field_name){const e=Object(x.find)(a,{fieldName:o.by_field_name});void 0!==e&&r.push({fieldName:"by_field_name",fieldValue:e.fieldName},{fieldName:"by_field_value",fieldValue:e.fieldValue})}return Es.mlResultsService.getModelPlotOutput(e.job_id,t,r,n,i,s)}{const o={success:!0,results:{}},l=_p(e,t);return Es.mlResultsService.getMetricData(l.datafeedConfig.indices,a,l.datafeedConfig.query,null!=r?r:l.metricFunction,l.metricFieldName,l.summaryCountFieldName,l.timeField,n,i,s,null==l?void 0:l.datafeedConfig).pipe(Object(we.map)((e=>(Object(x.each)(e.results,((e,t)=>{o.results[t]={actual:e}})),o))))}},getChartDetails:function(e,t,a,n,i){return new Promise(((s,r)=>{const o={success:!0,results:{functionLabel:"",entityData:{entities:[]}}},l=_p(e,t);let c=l.metricFunction;void 0!==l.metricFieldName&&(c+=" ",c+=l.metricFieldName),o.results.functionLabel=c;const d=Object(x.filter)(a,(e=>null===e.fieldValue));if(0===d.length)o.results.entityData.count=1,o.results.entityData.entities=a,s(o);else{const e=d.map((e=>e.fieldName));be.ml.getCardinalityOfFields({index:l.datafeedConfig.indices,fieldNames:e,query:l.datafeedConfig.query,timeFieldName:l.timeField,earliestMs:n,latestMs:i}).then((e=>{Object(x.each)(d,(t=>{o.results.entityData.entities.push({fieldName:t.fieldName,cardinality:Object(x.get)(e,t.fieldName,0)})})),s(o)})).catch((e=>{r(e)}))}}))}};function Cp(e){return e.filter(_e.p).map((e=>{const t=Object(au.a)(e.analysis_config.bucket_span);return{id:e.job_id,selected:!1,bucketSpanSeconds:t.asSeconds()}}))}function kp(e,t){const a=[];return!0===t?Object(x.each)(e,((e,t)=>{a.push({date:new Date(+t),lower:e.modelLower,value:e.actual,upper:e.modelUpper})})):Object(x.each)(e,((e,t)=>{a.push({date:new Date(+t),value:e.actual})})),a}function Fp(e){const t=[];return Object(x.each)(e,((e,a)=>{t.push({date:new Date(+a),isForecast:!0,lower:e.forecastLower,value:e.prediction,upper:e.forecastUpper})})),t}function Ip(e,t){return void 0!==t&&Object(x.each)(t,((t,a)=>{const n=function(e,t){let a;if(void 0===e)return a;for(let n=0;n<e.length;n++)if(e[n].date.getTime()===t){a=e[n];break}if(void 0===a){let n;for(let a=0;a<e.length;a++){const i=e[a].date.getTime();if(i>t){const s=e[a],r=e[a-1],o=Math.abs(t-r.date.getTime()),l=Math.abs(t-i);n=void 0===r||o>l?s:r;break}}a=n}return a}(e,a);void 0!==n&&(n.scheduledEvents=t)})),e}function Dp(e,t,a){let n;if(void 0===e)return n;for(let a=0;a<e.length;a++)if(e[a].date.getTime()===t){n=e[a];break}if(void 0===n){let i;const s=a.asMilliseconds();for(let a=0;a<e.length;a++){if(t-e[a].date.getTime()<s){i=e[a];break}}n=i}return n}function Ap(e,t,a,n){const i=void 0!==t?t:100,s=Math.floor(1.1*i),r=Object(Ts.c)();r.setInterval("auto"),r.setBounds(e),r.setBarTarget(Math.floor(i)),r.setMaxBars(s);const o=Object(x.find)(a,{id:n.job_id}).bucketSpanSeconds;let l=r.getIntervalToNearestMultiple(o);return l.asSeconds()<o&&(r.setInterval(o+"s"),l=r.getInterval()),l}function Lp(e,t,a,n,i,s,r,o,l){const c=void 0!==l?Yd.c.toES(l):l;return Object(Ee.forkJoin)([Tp.getMetricData(o,t,s,r.min.valueOf(),r.max.valueOf(),a.asMilliseconds(),c),Es.mlResultsService.getRecordsForCriteria([o.job_id],e,0,r.min.valueOf(),r.max.valueOf(),O.b,l),Es.mlResultsService.getScheduledEventsByBucket([o.job_id],r.min.valueOf(),r.max.valueOf(),a.asMilliseconds(),1,10),be.ml.annotations.getAnnotations$({jobIds:[o.job_id],earliestMs:r.min.valueOf(),latestMs:r.max.valueOf(),maxAnnotations:O.a,detectorIndex:t,entities:s}).pipe(Object(we.catchError)((e=>Object(Ee.of)({annotations:{},totalCount:0,error:Object(Re.b)(e),success:!1})))),void 0!==n?(()=>{let e;const l=o.analysis_config.detectors[t],c=Object(_e.q)(l.function);return i||"sum"!==c&&"count"!==c||(e={avg:"sum",max:"sum",min:"sum"}),ep.a.getForecastData(o,t,n,s,r.min.valueOf(),r.max.valueOf(),a.asMilliseconds(),e)})():Object(Ee.of)(null)]).pipe(Object(we.map)((([e,t,n,s,r])=>{const c=t.records.sort(((e,t)=>e.timestamp-t.timestamp)).reverse(),d=n.events[o.job_id];let u=kp(e.results,i);u=function(e,t,a,n,i){const s=[],r=a.asMilliseconds();let o;return void 0!==e&&e.length>0&&(o=e[e.length-1].date.getTime()),t.forEach((t=>{const n=t.timestamp;if(void 0===Dp(e,n,a)){const e=Math.floor(n/r)*r;-1===s.indexOf(e)&&e!==o&&s.push(e)}})),s.sort(((e,t)=>e-t)),s.forEach((t=>{const a={date:new Date(t),value:null};!0===n&&(a.upper=null,a.lower=null),e.push(a)})),t.forEach((t=>{const n=t.timestamp;if(t.function===Pt.b.METRIC&&t.function_description!==i)return;const s=Dp(e,n,a);if(void 0!==s){const e=t.record_score,a=s.anomalyScore;if(void 0===a||a<e){if(s.anomalyScore=e,s.function=t.function,void 0!==t.actual)null===s.value&&(s.value=t.actual),t.function===Pt.b.METRIC&&(s.value=Array.isArray(t.actual)?t.actual[0]:t.actual),s.actual=t.actual,s.typical=t.typical;else{const e=Object(x.get)(t,"causes",[]);if(e.length>0&&(s.byFieldName=t.by_field_name,s.numberOfCauses=e.length,1===e.length)){const e=t.causes[0];s.actual=e.actual,s.typical=e.typical,null===s.value&&(s.value=e.actual)}}void 0!==t.multi_bucket_impact&&(s.multiBucketImpact=t.multi_bucket_impact)}}})),e}(u,c,a,i,l),u=Ip(u,d);const p={scheduledEvents:d,anomalyRecords:c,focusChartData:u};var m;s&&(void 0!==s.error?(p.focusAnnotationError=s.error,p.focusAnnotationData=[]):p.focusAnnotationData=(null!==(m=s.annotations[o.job_id])&&void 0!==m?m:[]).sort(((e,t)=>e.timestamp-t.timestamp)).map(((e,t)=>(e.key=(t+1).toString(),e))));return r&&(p.focusForecastData=Fp(r.results),p.showForecastCheckbox=p.focusForecastData.length>0),p})))}var Rp=a(227);function Np(e,t,a){const n=te.a.getJob(a),i=[];if(void 0===n)return i;const s=e,r=n.analysis_config.detectors[s],o=t,l=null==r?void 0:r.partition_field_name,c=null==r?void 0:r.over_field_name,d=null==r?void 0:r.by_field_name;if(void 0!==l){var u;const e=null!==(u=null==o?void 0:o[l])&&void 0!==u?u:null;i.push({fieldType:"partition_field",fieldName:l,fieldValue:e})}if(void 0!==c){var p;const e=null!==(p=null==o?void 0:o[c])&&void 0!==p?p:null;i.push({fieldType:"over_field",fieldName:c,fieldValue:e})}if(void 0!==d&&void 0===c){var m;const e=null!==(m=null==o?void 0:o[d])&&void 0!==m?m:null;i.push({fieldType:"by_field",fieldName:d,fieldValue:e})}return i}function Pp(e){const t=e.analysis_config.detectors,a=[];return t.forEach(((t,n)=>{Object(_e.o)(e,n)&&a.push({index:n,detector_description:t.detector_description,function:t.function})})),a}function zp(e,t){const a=Pp(e);if(Array.isArray(a)&&a.length>=t){const a=e.analysis_config.detectors[t];if((null==a?void 0:a.function)===Pt.b.METRIC)return!0}return!1}const Bp=[{value:"mean",text:o.i18n.translate("xpack.ml.timeSeriesExplorer.plotByAvgOptionLabel",{defaultMessage:"mean"})},{value:"min",text:o.i18n.translate("xpack.ml.timeSeriesExplorer.plotByMinOptionLabel",{defaultMessage:"min"})},{value:"max",text:o.i18n.translate("xpack.ml.timeSeriesExplorer.plotByMaxOptionLabel",{defaultMessage:"max"})}],Jp=({functionDescription:e,setFunctionDescription:t,selectedDetectorIndex:a,selectedJobId:n,selectedEntities:s,entityControlsCount:l})=>{const c=Object(St.c)(),d=Object(i.useCallback)((async(e,a,n,i)=>{const s=await(async({selectedDetectorIndex:e,selectedEntities:t,selectedJobId:a,selectedJob:n},i)=>{if(!zp(n,e))return;const s=Np(e,t,a),r=[{fieldName:"detector_index",fieldValue:e},...s.filter((e=>null!==e.fieldValue))];try{const e=await Es.mlResultsService.getRecordsForCriteria([n.job_id],r,0,null,null,1).toPromise();if(Array.isArray(null==e?void 0:e.records)&&1===e.records.length){const t=e.records[0];return null==t?void 0:t.function_description}return Pt.a.AVG}catch(e){i.displayErrorToast(e,o.i18n.translate("xpack.ml.timeSeriesExplorer.highestAnomalyScoreErrorToastTitle",{defaultMessage:"An error occurred getting record with the highest anomaly score"}))}})({selectedDetectorIndex:e,selectedEntities:a,selectedJobId:n,selectedJob:i},c);t(s)}),[t,c]);return Object(i.useEffect)((()=>{if(void 0!==e)return;const t=te.a.getJob(n);if((0===l||l>0&&void 0!==s)&&void 0===e&&zp(t,a)){const e=t.analysis_config.detectors[a];(null==e?void 0:e.function)===Pt.b.METRIC&&d(a,s,n,t)}}),[t,a,s,n,e,l]),void 0===e?null:Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFormRow,{label:o.i18n.translate("xpack.ml.timeSeriesExplorer.metricPlotByOption",{defaultMessage:"Function"})},Object(I.jsx)(r.EuiSelect,{options:Bp,value:e,onChange:e=>t(e.target.value),"aria-label":o.i18n.translate("xpack.ml.timeSeriesExplorer.metricPlotByOptionLabel",{defaultMessage:"Pick function to plot by (min, max, or average) if metric function"})})))};const Vp=({bounds:e,selectedDetectorIndex:t,selectedJobId:a,appStateHandler:n,children:s,selectedEntities:o,functionDescription:l,setFunctionDescription:c})=>{var u;const{services:{mlServices:{mlApiServices:{results:p}}}}=Object(d.b)(),m=Object(i.useMemo)((()=>te.a.getJob(a)),[a]),b=!(null===(u=m.model_plot_config)||void 0===u||!u.enabled),[f,h]=Object(i.useState)(!1),[g,j]=Object(i.useState)({}),v=Object(i.useMemo)((()=>Pp(m)),[m]),y=Object(i.useMemo)((()=>Np(t,o,a)),[t,o,a]),[O,E]=Object(Qe.a)(Ze.b),w=Object(i.useMemo)((()=>{return{...(e=y.map((e=>e.fieldType)),t=!O||Object.values(O).some((e=>!(null==e||!e.anomalousOnly))),a=!O||Object.values(O).some((e=>!(null==e||!e.applyTimeRange))),e.reduce(((e,n)=>(e[n]={applyTimeRange:a,anomalousOnly:t,sort:{by:"anomaly_score",order:"desc"}},e)),{})),...O||{}};var e,t,a}),[y,O]),M=async(a={})=>{h(!0);const n=t,i=w?Object.fromEntries(Object.entries(w).filter((([e])=>y.some((t=>t.fieldType===e))))):void 0,{partition_field:s,over_field:r,by_field:o}=await p.fetchPartitionFieldsValues(m.job_id,a,[{fieldName:"detector_index",fieldValue:n}],e.min.valueOf(),e.max.valueOf(),i).toPromise(),l={};y.forEach((e=>{let t;(null==s?void 0:s.name)===e.fieldName&&(t=s.values),(null==r?void 0:r.name)===e.fieldName&&(t=r.values),(null==o?void 0:o.name)===e.fieldName&&(t=o.values),l[e.fieldName]=t})),h(!1),j(l)};Object(i.useEffect)((()=>{M()}),[a,t,JSON.stringify(o),w]);const S=Object(x.debounce)((async(e,t)=>{await M({[e.fieldType]:t})}),500),_=(e,t)=>{const a={...y.reduce(((e,t)=>(e[t.fieldName]=t.fieldValue,e)),{}),[e.fieldName]:t};n(yp,a)},T=Object(i.useCallback)((e=>{const t=e.target.value;void 0!==t&&n(vp,+t)}),[n]),C=v.map((e=>({value:e.index,text:e.detector_description}))),k=Object(i.useCallback)(((e,t)=>{var a,n;const i={...w[e]?w[e]:{},...t},s={...w};if((null===(a=w[e])||void 0===a?void 0:a.anomalousOnly)!==i.anomalousOnly)for(const e in s)s.hasOwnProperty(e)&&(s[e].anomalousOnly=i.anomalousOnly);if((null===(n=w[e])||void 0===n?void 0:n.applyTimeRange)!==i.applyTimeRange)for(const e in s)s.hasOwnProperty(e)&&(s[e].applyTimeRange=i.applyTimeRange);E({...s,[e]:i})}),[w,E]);let F=!1;return Object(I.jsx)("div",{"data-test-subj":"mlSingleMetricViewerSeriesControls"},Object(I.jsx)(r.EuiFlexGroup,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.detectorLabel",defaultMessage:"Detector"})},Object(I.jsx)(r.EuiSelect,{onChange:T,value:t,options:C,"data-test-subj":"mlSingleMetricViewerDetectorSelect"}))),y.map((e=>{const t=`${e.fieldName}`,a=!F&&null===e.fieldValue;return F=!F&&a,Object(I.jsx)(Hd.b,{entity:e,entityFieldValueChanged:_,isLoading:f,onSearchChange:S,config:w[e.fieldType],onConfigChange:k,forceSelection:a,key:t,options:(n=g[e.fieldName],Array.isArray(n)?n.map((e=>({label:""===e.value?Hd.a:e.value,value:e}))):[]),isModelPlotEnabled:b});var n})),Object(I.jsx)(Jp,{selectedJobId:a,selectedDetectorIndex:t,selectedEntities:o,functionDescription:l,setFunctionDescription:c,entityControlsCount:y.length}),s))};var Up=a(250),Gp=a(114),qp=a.n(Gp),Wp=a(159);function Hp(e,t,a,n){this.contextGroup=e,this.data=t,this.drawBounds=a,this.swimlaneHeight=n,this.mask=this.contextGroup.append("g").attr("class","mask"),this.leftGroup=this.mask.append("g").attr("class","left-mask"),this.rightGroup=this.mask.append("g").attr("class","right-mask"),this.leftPolygon=this.leftGroup.append("polygon"),this.rightPolygon=this.rightGroup.append("polygon"),!0===this.drawBounds&&(this.leftGroup.append("path").attr("class","left area bounds"),this.rightGroup.append("path").attr("class","right area bounds")),this.leftGroup.append("path").attr("class","left values-line"),this.rightGroup.append("path").attr("class","right values-line"),this._x=null,this._y=null}Hp.prototype.style=function(e,t){return this.leftGroup.style(e,t),this.rightGroup.style(e,t),this},Hp.prototype.x=function(e){return null==e?this._x:(this._x=e,this)},Hp.prototype.y=function(e){return null==e?this._y:(this._y=e,this)},Hp.prototype.redraw=function(){const e=this._y.domain(),t=e[0],a=e[1],n=this._x.domain(),i=n[0],s=n[1],r=this,o=this.data.filter((function(e){return e.date<r.from})),l=this.data.filter((function(e){return e.date>r.to}));if(!0===this.drawBounds){const e=qp.a.svg.area().x((function(e){return r._x(e.date)||1})).y0((function(e){return r._y(Math.min(a,Math.max(e.lower,t)))})).y1((function(e){return r._y(Math.max(t,Math.min(e.upper,a)))})).defined((e=>null!==e.lower&&null!==e.upper));this.leftGroup.select(".left.area.bounds").attr("d",e(o)),this.rightGroup.select(".right.area.bounds").attr("d",e(l))}const c=qp.a.svg.line().x((function(e){return r._x(e.date)})).y((function(e){return r._y(e.value)})).defined((e=>null!==e.value));this.leftGroup.select(".left.values-line").attr("d",c(o)),Object(Wp.g)(o,this.leftGroup,c,1),this.rightGroup.select(".right.values-line").attr("d",c(l)),Object(Wp.g)(l,this.rightGroup,c,1);const d=this._x(i),u=this._y(t)+this.swimlaneHeight,p=this._x(this.from),m=0,b=this._x(this.to),f=this._y(t)+this.swimlaneHeight,h=this._x(s),g=0;return this.leftPolygon.attr("points",d+","+u+"  "+p+","+u+"  "+p+","+m+"  "+d+","+m),this.rightPolygon.attr("points",b+","+f+"  "+h+","+f+"  "+h+","+g+"  "+b+","+g),this},Hp.prototype.reveal=function(e){return this.from=e[0],this.to=e[1],this.redraw(),this};var Yp=a(191);const $p="mlAnnotationMask";function Xp(){const{annotationUpdatesService:e}=this.props,t=this.focusXScale,a=qp.a.svg.brush().x(t).on("brushend",function(){const{selectedJob:t}=this.props,n=a.extent(),i=n[0].getTime(),s=n[1].getTime();if(i===s)return void e.setValue(null);const r={timestamp:i,end_timestamp:s,annotation:"",job_id:t.job_id,type:Yp.d.ANNOTATION};e.setValue(r)}.bind(this));return a}function Kp(e){const t={};return e.forEach(((a,n)=>{if(void 0!==a.key){const i=e.filter(((e,t)=>t<n));t[a.key]=i.reduce(((e,n)=>void 0===a.end_timestamp||void 0===n.end_timestamp||void 0===n.key||n.timestamp<a.timestamp&&n.end_timestamp<a.timestamp||n.timestamp>a.end_timestamp&&n.end_timestamp>a.end_timestamp?e:t[n.key]+1),0)}})),t}function Qp(e){qp.a.selectAll(".mlAnnotation").each((function(t){const a=qp.a.select(this);t._id===e._id?a.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!0):(a.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!0),a.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!0),a.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isBlur",!0))}))}function Zp(){qp.a.selectAll(".mlAnnotation").each((function(){const e=qp.a.select(this);e.selectAll(".mlAnnotationTextRect").classed("mlAnnotationTextRect-isBlur",!1),e.selectAll(".mlAnnotationRect").classed("mlAnnotationRect-isHighlight",!1).classed("mlAnnotationRect-isBlur",!1),e.selectAll(".mlAnnotationText").classed("mlAnnotationText-isBlur",!1)}))}const em=25,tm=310,am=335,nm=25,im=Wp.a+4,sm={top:10,right:10,bottom:15,left:40},rm=[{duration:Ve.a.duration(1,"h"),label:"1h"},{duration:Ve.a.duration(12,"h"),label:"12h"},{duration:Ve.a.duration(1,"d"),label:"1d"},{duration:Ve.a.duration(1,"w"),label:"1w"},{duration:Ve.a.duration(2,"w"),label:"2w"},{duration:Ve.a.duration(1,"M"),label:"1M"}],om=qp.a.scale.threshold().domain([3,25,50,75,100]).range(["#d2e9f7","#8bc8fb","#ffdd00","#ff7e00","#fe5050"]),lm=qp.a.scale.threshold().domain([3,25,50,75,100]).range(["#dce7ed","#b0c5d6","#b1a34e","#b17f4e","#c88686"]);class timeseries_chart_TimeseriesChartIntl extends i.Component{constructor(...e){super(...e),Se()(this,"rowMouseenterSubscriber",null),Se()(this,"rowMouseleaveSubscriber",null),Se()(this,"contextChartInitialized",!1),Se()(this,"drawContextBrush",(e=>{const{contextChartSelected:t}=this.props,a=this.brush,n=this.contextXScale,i=this.mask;a.x(n).on("brush",c).on("brushend",(function(){const i=a.empty()?n.domain():a.extent(),s=i[0].getTime(),r=i[1].getTime();if(void 0!==d.selectedBounds&&d.selectedBounds.min.valueOf()===s&&d.selectedBounds.max.valueOf()===r)return;e.selectAll(".swimlane-cell").style("fill",(e=>{const t=e.date.getTime();return t<s||t>r?lm(e.score):om(e.score)})),d.selectedBounds={min:Ve()(s),max:Ve()(r)},t({from:i[0],to:i[1]})})),e.append("g").attr("class","x brush").call(a).selectAll("rect").attr("y",-1).attr("height",91).attr("width",this.vizWidth);const s=a.extent();e.selectAll(".w rect").attr("x",-10).attr("width",10),e.selectAll(".e rect").attr("transform",null).attr("width",10);const r=e.append("rect").attr("class","top-border").attr("y",-2).attr("height",3),o=e.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",n(s[0])-10).html('\n        <div class="brush-handle-inner brush-handle-inner-left" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="5,0 5,8 0,4" />\n          </svg>\n        </div>'),l=e.append("foreignObject").attr("width",10).attr("height",90).attr("class","brush-handle").attr("x",n(s[1])+0).html('\n        <div class="brush-handle-inner brush-handle-inner-right" style="padding-top: 27px">\n          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="6" height="9">\n            <polygon points="0,0 0,8 5,4" />\n          </svg>\n        </div>');function c(){const e=a.extent();i.reveal(e),o.attr("x",n(e[0])-10),l.attr("x",n(e[1])+0),r.attr("x",n(e[0])+1);const t=Math.max(0,n(e[1])-n(e[0])-2);r.attr("width",t);const s=a.empty();qp.a.selectAll(".brush-handle").style("visibility",s?"hidden":"visible")}c();const d=this})),Se()(this,"drawSwimlane",((e,t,a)=>{const{contextAggregationInterval:n,swimlaneData:i}=this.props,s=i;if(void 0===s)return;const r=this.calculateContextXAxisDomain(),o=qp.a.time.scale().range([0,t]).domain(r),l=qp.a.scale.linear().range([a,0]).domain([0,a]),c=qp.a.svg.axis().scale(o).orient("bottom").innerTickSize(-a).outerTickSize(0),d=qp.a.svg.axis().scale(l).orient("left").tickValues(l.domain()).innerTickSize(-t).outerTickSize(0),u=e.append("g");u.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")").call(c),u.append("g").attr("class","y axis").call(d);const p=r[0].getTime();let m=t/((r[1].getTime()-p)/n.asMilliseconds());m<1&&(m=1);e.append("g").attr("class","swimlane-cells").selectAll("rect").data(s).enter().append("rect").attr("x",(e=>o(e.date))).attr("y",0).attr("rx",0).attr("ry",0).attr("class",(e=>e.score>0?"swimlane-cell":"swimlane-cell-hidden")).attr("width",m).attr("height",a).style("fill",(e=>om(e.score)))})),Se()(this,"calculateContextXAxisDomain",(()=>{const{bounds:e,contextAggregationInterval:t,swimlaneData:a}=this.props;let n=e.min.valueOf();void 0!==a&&a.length>0&&(n=Math.min(a[0].date.getTime(),e.min.valueOf()));const i=t.asMilliseconds(),s=Math.floor(n/i)*i,r=Math.ceil(e.max.valueOf()/i)*i;return[new Date(s),new Date(r)]})),Se()(this,"setContextBrushExtent",((e,t)=>{const a=this.brush,n=a.extent(),i=[e,t];a.extent(i),a(qp.a.select(".brush")),i[0].getTime()===n[0].getTime()&&i[1].getTime()===n[1].getTime()||a.event(qp.a.select(".brush"))}))}componentWillUnmount(){qp.a.select(this.rootNode).html(""),null!==this.rowMouseenterSubscriber&&this.rowMouseenterSubscriber.unsubscribe(),null!==this.rowMouseleaveSubscriber&&this.rowMouseleaveSubscriber.unsubscribe()}componentDidMount(){const{svgWidth:e}=this.props;this.vizWidth=e-sm.left-sm.right;const t=this.vizWidth;this.focusXScale=qp.a.time.scale().range([0,t]),this.focusYScale=qp.a.scale.linear().range([am,em]);const a=this.focusXScale,n=this.focusYScale;this.focusXAxis=qp.a.svg.axis().scale(a).orient("bottom").innerTickSize(-310).outerTickSize(0).tickPadding(10),this.focusYAxis=qp.a.svg.axis().scale(n).orient("left").innerTickSize(-t).outerTickSize(0).tickPadding(10),this.focusValuesLine=qp.a.svg.line().x((function(e){return a(e.date)})).y((function(e){return n(e.value)})).defined((e=>null!==e.value)),this.focusBoundedArea=qp.a.svg.area().x((function(e){return a(e.date)||1})).y0((function(e){return n(e.upper)})).y1((function(e){return n(e.lower)})).defined((e=>null!==e.lower&&null!==e.upper)),this.contextXScale=qp.a.time.scale().range([0,t]),this.contextYScale=qp.a.scale.linear().range([60,3]),this.fieldFormat=void 0,this.annotateBrush=Xp.call(this),this.brush=qp.a.svg.brush(),this.mask=void 0;const i=this.highlightFocusChartAnomaly.bind(this),s=Qp.bind(this);const r=this.unhighlightFocusChartAnomaly.bind(this),o=Zp.bind(this);this.rowMouseenterSubscriber=hu.a.rowMouseenter$.subscribe((function({record:e,type:t="anomaly"}){"anomaly"===t?i(e):"annotation"===t&&s(e)})),this.rowMouseleaveSubscriber=hu.a.rowMouseleave$.subscribe((function({record:e,type:t="anomaly"}){"anomaly"===t?r(e):o(e)})),this.renderChart(),this.drawContextChartSelection(),this.renderFocusChart()}componentDidUpdate(e){if(!1!==this.props.renderFocusChartOnly&&e.svgWidth===this.props.svgWidth&&e.showAnnotations===this.props.showAnnotations&&e.annotationData===this.props.annotationData||(this.renderChart(),this.drawContextChartSelection()),this.renderFocusChart(),null===this.props.annotation){qp.a.select(this.rootNode).select("g.mlAnnotationBrush").call(this.annotateBrush.extent([0,0]))}}renderChart(){const{contextChartData:e,contextForecastData:t,detectorIndex:a,modelPlotEnabled:n,selectedJob:i,svgWidth:s,showAnnotations:r}=this.props,o=this.createFocusChart.bind(this),l=this.drawContextElements.bind(this),c=this.focusXScale,d=this.focusYAxis,u=this.focusYScale,p=function(e){return 425+(e?im:0)+nm+sm.top+sm.bottom}(r),m=qp.a.select(this.rootNode);if(m.selectAll("*").remove(),void 0===i)return;if(this.fieldFormat=ru.a.getFieldFormat(i.job_id,a),void 0===e)return;const b=this.fieldFormat,f=m.append("svg").attr("width",s).attr("height",p);let h,g;if(!0===n||void 0!==t&&t.length>0){const a=void 0===t?e:e.concat(t);h=qp.a.min(a,(e=>Math.min(e.value,e.lower))),g=qp.a.max(a,(e=>Math.max(e.value,e.upper)))}else h=qp.a.min(e,(e=>e.value)),g=qp.a.max(e,(e=>e.value));const j=g>0?Math.pow(10,Math.ceil(Math.log10(Math.abs(g)))):g,x=h>=0?h:-1*Math.pow(10,Math.ceil(Math.log10(Math.abs(h))));u.domain([x,j]);let v=0;f.append("g").attr("class","temp-axis-label tick").selectAll("text.temp.axis").data(u.ticks()).enter().append("text").text((e=>void 0!==b?b.convert(e,"text"):u.tickFormat()(e))).each((function(){v=Math.max(this.getBBox().width+d.tickPadding(),v)})).remove(),qp.a.select(".temp-axis-label").remove(),sm.left=Math.max(v,40),this.vizWidth=Math.max(s-sm.left-sm.right,0),c.range([0,this.vizWidth]),d.innerTickSize(-this.vizWidth);const y=f.append("g").attr("class","focus-chart").attr("transform","translate("+sm.left+","+sm.top+")"),O=f.append("g").attr("class","context-chart").attr("transform","translate("+sm.left+","+(am+sm.top+nm)+")");f.append("defs").append("mask").attr("id",$p).append("rect").attr("x",0).attr("y",0).attr("width",this.vizWidth).attr("height",am).style("fill","white"),o(y,this.vizWidth,am),l(O,this.vizWidth,60,30,im)}drawContextChartSelection(){const{contextChartData:e,contextForecastData:t,zoomFrom:a,zoomTo:n}=this.props;if(void 0===e)return;let i,s;const r=this.contextXScale.domain()[0].getTime(),o=this.contextXScale.domain()[1].getTime();let l=e;if(void 0!==t&&(l=l.concat(t)),i=a?a.getTime():Object(x.reduce)(l,((e,t)=>Math.min(e,t.date.getTime())),new Date(2099,12,31).getTime()),i=Math.max(i,r),s=n?n.getTime():Object(x.reduce)(l,((e,t)=>Math.max(e,t.date.getTime())),0),s=Math.min(s,o),i!==r||s!==o){this.setContextBrushExtent(new Date(i),new Date(s));const e={min:Ve()(new Date(i)),max:Ve()(i)};this.selectedBounds=e}else{const e=this.contextXScale.domain(),t={min:Ve()(new Date(e[0])),max:Ve()(e[1])};Object(x.isEqual)(t,this.selectedBounds)||(this.selectedBounds=t,this.setContextBrushExtent(new Date(e[0]),new Date(e[1])))}}createFocusChart(e,t,a){const{contextForecastData:n}=this.props,i=e.append("g").attr("class","focus-zoom");i.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",em).attr("class","chart-border"),this.createZoomInfoElements(i,t);const s=this.annotateBrush.bind(this);let r=0,o=0;null!==this.props.annotation&&(r=this.focusXScale(this.props.annotation.timestamp),o=function(e,t){const a=t(e.timestamp)+1,n=void 0!==e.end_timestamp?t(e.end_timestamp)-1:a+8;return Math.max(8,n-a)}(this.props.annotation,this.focusXScale)),e.append("g").attr("class","mlAnnotationBrush").call(s).selectAll("rect").attr("x",r).attr("y",em).attr("width",o).attr("height",tm),e.append("g").classed("mlAnnotations",!0),e.append("rect").attr("x",0).attr("y",em).attr("width",t).attr("height",tm).attr("class","chart-border");const l=e.append("g").attr("class","x-axis-background");l.append("rect").attr("x",0).attr("y",a).attr("width",t).attr("height",nm),l.append("line").attr("x1",0).attr("y1",a).attr("x2",0).attr("y2",a+nm),l.append("line").attr("x1",t).attr("y1",a).attr("x2",t).attr("y2",a+nm),l.append("line").attr("x1",0).attr("y1",a+nm).attr("x2",t).attr("y2",a+nm);const c=e.append("g");c.append("g").attr("class","x axis").attr("transform","translate(0,"+a+")"),c.append("g").attr("class","y axis"),e.append("path").attr("class","area bounds"),e.append("path").attr("class","values-line"),e.append("g").attr("class","focus-chart-markers"),n&&(e.append("path").attr("class","area forecast").attr("data-test-subj","mlForecastArea"),e.append("path").attr("class","values-line forecast").attr("data-test-subj","mlForecastValuesline"),e.append("g").attr("class","focus-chart-markers forecast").attr("data-test-subj","mlForecastMarkers")),e.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",a+24).attr("class","chart-border chart-border-highlight")}renderFocusChart(){const{focusAggregationInterval:e,focusAnnotationData:t,focusChartData:a,focusForecastData:n,modelPlotEnabled:i,selectedJob:s,showAnnotations:r,showForecast:l,showModelBounds:c,zoomFromFocusLoaded:d,zoomToFocusLoaded:u}=this.props,p=Array.isArray(t)?t:[];if(void 0===a)return;const m=a,b=this.contextYScale,f=this.showFocusChartTooltip.bind(this),h=this.props.tooltipService.hide.bind(this.props.tooltipService),g=qp.a.select(".focus-chart"),j=e.expression,x=s.analysis_config.bucket_span;if(qp.a.select(this.rootNode).select(".zoom-aggregation-interval").text(o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomAggregationIntervalLabel",{defaultMessage:"(aggregation interval: {focusAggInt}, bucket span: {bucketSpan})",values:{focusAggInt:j,bucketSpan:x}})),void 0===d||void 0===u)return;const v={min:Ve()(d.getTime()),max:Ve()(u.getTime())},y=e.asMilliseconds(),O=Ve()(Math.floor(v.min.valueOf()/y)*y),E=Ve()(Math.ceil(v.max.valueOf()/y)*y);if(this.focusXScale.domain([O.toDate(),E.toDate()]),a.length>0||void 0!==n&&n.length>0){void 0!==this.fieldFormat?this.focusYAxis.tickFormat((e=>this.fieldFormat.convert(e,"text"))):this.focusYAxis.tickFormat(null);let e=0,t=0,a=m;if(l&&void 0!==n&&n.length>0&&(a=m.concat(n)),e=qp.a.min(a,(e=>{let t=e.value;return null===t&&void 0!==e.anomalyScore&&void 0!==e.actual&&(t=Array.isArray(e.actual)?e.actual[0]:e.actual),void 0!==e.lower?null!=t?Math.min(t,e.lower):e.lower:t})),t=qp.a.max(a,(e=>{let t=e.value;return null===t&&void 0!==e.anomalyScore&&void 0!==e.actual&&(t=Array.isArray(e.actual)?e.actual[0]:e.actual),void 0!==e.upper?Math.max(t,e.upper):t})),t===e&&(this.contextYScale.domain()[0]!==b.domain()[1]&&e>=b.domain()[0]&&t<=b.domain()[1]?(e=b.domain()[0],t=b.domain()[1]):(e-=.05*e,t+=.05*t)),r&&p&&p.length>0){const a=Kp(p),n=qp.a.max(Object.keys(a).map((e=>a[e])));t+=Math.abs(t-e)*((n+1)/5)}this.focusYScale.domain([e,t])}else this.focusYScale.domain([0,10]),this.focusYAxis.tickFormat("");const w=Object(Ts.c)();w.setInterval("auto"),w.setBounds(v);const M=w.getScaledDateFormat();g.select(".x.axis").call(this.focusXAxis.ticks(Object(Wp.m)(this.vizWidth),M).tickFormat((e=>Ve()(e).format(M)))),g.select(".y.axis").call(this.focusYAxis),Object(Wp.h)(g.select(".x.axis"),this.vizWidth),!0===i&&g.select(".area.bounds").attr("d",this.focusBoundedArea(m)).classed("hidden",!c),function(e,t,a,n,i,s,r,o,l){const c={};t.forEach((e=>{if(void 0!==e.key){const t=(e.end_timestamp||0)-e.timestamp;c[e.key]=t}})),t.sort(((e,t)=>void 0===e.key||void 0===t.key?0:c[t.key]-c[e.key]));const d=Kp(t),u=function(e){r(e,this)},p=e=>{l.setValue(null),l.setValue(e)},m=e.select(".mlAnnotations").selectAll("g.mlAnnotation").data(t||[],(e=>e._id||""));m.enter().append("g").classed("mlAnnotation",!0);const b=m.selectAll(".mlAnnotationRect").data((e=>[e]));b.enter().append("rect").classed("mlAnnotationRect",!0).attr("mask","url(#mlAnnotationMask)").on("mouseover",u).on("mouseout",o).on("click",p),b.attr("x",(e=>{const t=Ve()(e.timestamp);return i(t)})).attr("y",(e=>{const t=void 0!==e.key?d[e.key]:1;return a+1+0+28*t})).attr("height",(e=>{const t=void 0!==e.key?d[e.key]:1;return n-2-0-28*t})).attr("width",(e=>{const t=i(Ve()(e.timestamp))+1,a=void 0!==e.end_timestamp?i(Ve()(e.end_timestamp))-1:t+8;return Math.max(8,a-t)})),b.exit().remove();const f=m.selectAll(".mlAnnotationTextRect").data((e=>[e])),h=m.selectAll(".mlAnnotationText").data((e=>[e]));function g(e){const t=i.domain()[0],a=i.domain()[1],n=Ve()(e),s=Math.max(i(t),i(n));return Math.min(i(a)-32,s)}f.enter().append("rect").classed("mlAnnotationTextRect",!0).attr("width",24).attr("height",20).on("mouseover",u).on("mouseout",o).on("click",p),h.enter().append("text").classed("mlAnnotationText",!0).on("mouseover",u).on("mouseout",o).on("click",p),h.attr("x",(e=>g(e.timestamp)+17)).attr("y",(e=>{const t=void 0!==e.key?d[e.key]:1;return a+-7+26+28*t})).text((e=>e.key)),f.attr("x",(e=>g(e.timestamp)+5)).attr("y",(e=>{const t=void 0!==e.key?d[e.key]:1;return a+-7+12+28*t})),f.exit().remove(),h.exit().remove(),m.classed("mlAnnotationHidden",!s),m.exit().remove()}(g,p,em,tm,this.focusXScale,r,f,h,this.props.annotationUpdatesService),g.select(".mlAnnotationBrush").style("display",r?null:"none"),g.select(".values-line").attr("d",this.focusValuesLine(m)),Object(Wp.g)(m,g,this.focusValuesLine);const S=qp.a.select(".focus-chart-markers").selectAll(".metric-value").data(m.filter((e=>(null!==e.value||"number"==typeof e.anomalyScore)&&!Object(Wp.o)(e))));S.exit().remove(),S.enter().append("circle").attr("r",Wp.b).on("mouseover",(function(e){f(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),S.attr("cx",(e=>this.focusXScale(e.date))).attr("cy",(e=>this.focusYScale(e.value))).attr("class",(e=>{let t="metric-value";return void 0!==e.anomalyScore&&(t+=` anomaly-marker ${Object(Yd.l)(e.anomalyScore).id}`),t}));const _=qp.a.select(".focus-chart-markers").selectAll(".multi-bucket").data(m.filter((e=>null!==e.anomalyScore&&!0===Object(Wp.o)(e))));_.exit().remove(),_.enter().append("path").attr("d",qp.a.svg.symbol().size(Wp.c).type("cross")).on("mouseover",(function(e){f(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),_.attr("transform",(e=>`translate(${this.focusXScale(e.date)}, ${this.focusYScale(e.value)})`)).attr("class",(e=>`anomaly-marker multi-bucket ${Object(Yd.l)(e.anomalyScore).id}`));const T=qp.a.select(".focus-chart-markers").selectAll(".scheduled-event-marker").data(m.filter((e=>void 0!==e.scheduledEvents)));if(T.exit().remove(),T.enter().append("rect").attr("width",2*Wp.b).attr("height",Wp.d).attr("class","scheduled-event-marker").attr("rx",1).attr("ry",1),T.attr("x",(e=>this.focusXScale(e.date)-Wp.b)).attr("y",(e=>this.focusYScale(e.value)-3)),void 0!==n){g.select(".area.forecast").attr("d",this.focusBoundedArea(n)).classed("hidden",!l),g.select(".values-line.forecast").attr("d",this.focusValuesLine(n)).classed("hidden",!l);const e=qp.a.select(".focus-chart-markers.forecast").selectAll(".metric-value").data(n);e.exit().remove(),e.enter().append("circle").attr("r",Wp.b).on("mouseover",(function(e){f(e,this)})).on("mouseout",(()=>this.props.tooltipService.hide())),e.attr("cx",(e=>this.focusXScale(e.date))).attr("cy",(e=>this.focusYScale(e.value))).attr("class","metric-value").classed("hidden",!l)}}createZoomInfoElements(e,t){const{autoZoomDuration:a,bounds:n,modelPlotEnabled:i}=this.props,s=this.setZoomInterval.bind(this),r=n.max.unix()-n.min.unix(),l=10/this.vizWidth*r;let c=10;const d=e.append("text").attr("x",c).attr("y",17).attr("class","zoom-info-text").text(o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomLabel",{defaultMessage:"Zoom:"})),u=[{durationMs:a,label:"auto"}];if(Object(x.each)(rm,(e=>{e.duration.asSeconds()>l&&e.duration.asSeconds()<r&&u.push({durationMs:e.duration.asMilliseconds(),label:e.label})})),c+=d.node().getBBox().width+4,Object(x.each)(u,(t=>{const a=e.append("a").attr("data-ms",t.durationMs).attr("href","").append("text").attr("x",c).attr("y",17).attr("class","zoom-info-text").text(t.label);c+=a.node().getBBox().width+4})),e.append("text").attr("x",c+6).attr("y",17).attr("class","zoom-info-text zoom-aggregation-interval").text(o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.zoomGroupAggregationIntervalLabel",{defaultMessage:"(aggregation interval: , bucket span: )"})),!1===i){const a=e.append("text").attr("x",300).attr("y",17).attr("class","zoom-info-text").text(o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelBoundsNotAvailableLabel",{defaultMessage:"Model bounds are not available"}));a.attr("x",t-(a.node().getBBox().width+10))}qp.a.select(this.rootNode).selectAll(".focus-zoom a").on("click",(function(){qp.a.event.preventDefault(),s(qp.a.select(this).attr("data-ms"))}))}drawContextElements(e,t,a,n){const{bounds:i,contextChartData:s,contextForecastData:r,modelPlotEnabled:o,annotationData:l}=this.props,c=s,d=this.showFocusChartTooltip.bind(this),u=this.props.tooltipService.hide.bind(this.props.tooltipService);this.contextXScale=qp.a.time.scale().range([0,t]).domain(this.calculateContextXAxisDomain());const p=void 0===r?c:c.concat(r),m={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(x.each)(p,(e=>{var t,a;const n=null!==(t=e.lower)&&void 0!==t?t:Number.MAX_VALUE,i=null!==(a=e.upper)&&void 0!==a?a:Number.MIN_VALUE;m.min=Math.min(e.value,n,m.min),m.max=Math.max(e.value,i,m.max)}));let b=m.min,f=m.max;const h={min:b,max:f};if(!0===o||void 0!==r&&r.length>0){const e={min:Number.MAX_VALUE,max:Number.MIN_VALUE};Object(x.each)(p,(t=>{e.min=Math.min(t.lower,e.min),e.max=Math.max(t.upper,e.max)})),b=Math.min(b,e.min),f=Math.max(f,e.max),m.max-m.min<.5*(f-b)&&(m.min>b&&(h.min=m.min-.5*(m.max-m.min)),m.max<f&&(h.max=m.max+.5*(m.max-m.min)))}this.contextYScale=qp.a.scale.linear().range([a,3]).domain([h.min,h.max]);const g=e.append("g").attr("class","axis"),j=a+n+im;g.append("line").attr("x1",0).attr("y1",0).attr("x2",0).attr("y2",j),g.append("line").attr("x1",t).attr("y1",0).attr("x2",t).attr("y2",j),g.append("line").attr("x1",0).attr("y1",j).attr("x2",t).attr("y2",j);const v=Object(Ts.c)();v.setInterval("auto"),v.setBounds(i);const y=v.getScaledDateFormat(),O=qp.a.svg.axis().scale(this.contextXScale).orient("top").innerTickSize(-a).outerTickSize(0).tickPadding(0).ticks(Object(Wp.m)(t,y)).tickFormat((e=>Ve()(e).format(y)));e.datum(c);const E=qp.a.svg.area().x((e=>this.contextXScale(e.date))).y0((e=>this.contextYScale(Math.min(h.max,Math.max(e.lower,h.min))))).y1((e=>this.contextYScale(Math.max(h.min,Math.min(e.upper,h.max))))).defined((e=>null!==e.lower&&null!==e.upper));!0===o&&e.append("path").datum(c).attr("class","area bounds").attr("d",E);const w=qp.a.svg.line().x((e=>this.contextXScale(e.date))).y((e=>this.contextYScale(e.value))).defined((e=>null!==e.value));e.append("path").datum(c).attr("class","values-line").attr("d",w),Object(Wp.g)(c,e,w,1),e.append("g").classed("mlContextAnnotations",!0);const[M,S]=this.contextXScale.range(),_=e.select(".mlContextAnnotations").selectAll("g.mlContextAnnotation").data(l,(e=>e._id||""));_.enter().append("g").classed("mlContextAnnotation",!0);const T=_.selectAll(".mlContextAnnotationRect").data((e=>[e]));T.enter().append("rect").on("mouseover",(function(e){d(e,this)})).on("mouseout",(()=>u())).classed("mlContextAnnotationRect",!0),T.attr("x",(e=>{const t=Ve()(e.timestamp);let a=this.contextXScale(t);return a-Wp.a<=M&&(a=0),a+Wp.a>=S&&(a=S-Wp.a),a})).attr("y",a+n+2).attr("height",Wp.a).attr("width",(e=>{const t=Math.max(this.contextXScale(Ve()(e.timestamp))+1,M),a=Math.min(S,void 0!==e.end_timestamp?this.contextXScale(Ve()(e.end_timestamp))-1:t+8);return Math.max(8,a-t)})),T.exit().remove(),void 0!==r&&(e.append("path").datum(r).attr("class","area forecast").attr("d",E),e.append("path").datum(r).attr("class","values-line forecast").attr("d",w));const C=e.append("g").attr("class","swimlane").attr("transform","translate(0,"+a+")");this.drawSwimlane(C,t,n),this.mask=new Hp(e,s,o,n).x(this.contextXScale).y(this.contextYScale),e.append("g").attr("class","x axis context-chart-axis").call(O),e.selectAll(".x.context-chart-axis text").attr("dy",a-5),Object(Wp.h)(e.selectAll(".x.context-chart-axis"),t),this.drawContextBrush(e)}setZoomInterval(e){const{bounds:t,zoomTo:a}=this.props,n=t.min.valueOf(),i=t.max.valueOf(),s=+e;let r=a.getTime(),o=r-s;o<n&&(o=n,r=Math.min(n+s,i)),this.setContextBrushExtent(new Date(o),new Date(r))}showFocusChartTooltip(e,t){const{modelPlotEnabled:a}=this.props,n=this.fieldFormat,i="single_metric_viewer",s=[{label:Object(Ud.c)(e.date)}];if(void 0!==e.anomalyScore){const t=parseInt(e.anomalyScore);if(s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.anomalyScoreLabel",{defaultMessage:"anomaly score"}),value:Object(Yd.g)(t),color:om(t),seriesIdentifier:{key:i},valueAccessor:"anomaly_score"}),!0===Object(Wp.p)(e)&&s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.multiBucketImpactLabel",{defaultMessage:"multi-bucket impact"}),value:Object(Yd.h)(e.multiBucketImpact),seriesIdentifier:{key:i},valueAccessor:"multi_bucket_impact"}),e.metricFunction&&s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.metricActualPlotFunctionLabel",{defaultMessage:"function"}),value:e.metricFunction,seriesIdentifier:{key:i},valueAccessor:"metric_function"}),!1===a){if(void 0!==e.actual&&"rare"!==e.function)s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.actualLabel",{defaultMessage:"actual"}),value:Object(ou.b)(e.actual,e.function,n),seriesIdentifier:{key:i},valueAccessor:"actual"}),s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.typicalLabel",{defaultMessage:"typical"}),value:Object(ou.b)(e.typical,e.function,n),seriesIdentifier:{key:i},valueAccessor:"typical"});else if(s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.valueLabel",{defaultMessage:"value"}),value:Object(ou.b)(e.value,e.function,n),seriesIdentifier:{key:i},valueAccessor:"value"}),void 0!==e.byFieldName&&void 0!==e.numberOfCauses){const t=e.numberOfCauses,a=Object(ma.d)(e.byFieldName);s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.moreThanOneUnusualByFieldValuesLabel",{defaultMessage:"{numberOfCauses}{plusSign} unusual {byFieldName} values",values:{numberOfCauses:t,byFieldName:a,plusSign:t<10?"":"+"}}),seriesIdentifier:{key:i},valueAccessor:"numberOfCauses"})}}else s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.actualLabel",{defaultMessage:"actual"}),value:Object(ou.b)(e.actual,e.function,n),seriesIdentifier:{key:i},valueAccessor:"actual"}),s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(ou.b)(e.upper,e.function,n),seriesIdentifier:{key:i},valueAccessor:"upper_bounds"}),s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.modelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(ou.b)(e.lower,e.function,n),seriesIdentifier:{key:i},valueAccessor:"lower_bounds"})}else!0===Object(x.get)(e,"isForecast",!1)?s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.predictionLabel",{defaultMessage:"prediction"}),value:Object(ou.b)(e.value,e.function,n),seriesIdentifier:{key:i},valueAccessor:"prediction"}):s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScore.valueLabel",{defaultMessage:"value"}),value:Object(ou.b)(e.value,e.function,n),seriesIdentifier:{key:i},valueAccessor:"value"}),!0===a&&(s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.upperBoundsLabel",{defaultMessage:"upper bounds"}),value:Object(ou.b)(e.upper,e.function,n),seriesIdentifier:{key:i},valueAccessor:"upper_bounds"}),s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.withoutAnomalyScoreAndModelPlotEnabled.lowerBoundsLabel",{defaultMessage:"lower bounds"}),value:Object(ou.b)(e.lower,e.function,n),seriesIdentifier:{key:i},valueAccessor:"lower_bounds"}));if(void 0!==e.scheduledEvents&&e.scheduledEvents.forEach(((t,a)=>{s.push({label:o.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.scheduledEventsLabel",{defaultMessage:"scheduled event{counter}",values:{counter:e.scheduledEvents.length>1?` #${a+1}`:""}}),value:t,seriesIdentifier:{key:i},valueAccessor:`scheduled_events_${a+1}`})})),void 0!==e.annotation){s.length=0,s.push({label:e.annotation});let t=Ve()(e.timestamp).format("MMMM Do YYYY, HH:mm");void 0!==e.end_timestamp&&(t+=` - ${Ve()(e.end_timestamp).format("MMMM Do YYYY, HH:mm")}`),s.push({label:t,seriesIdentifier:{key:i},valueAccessor:"timespan"})}let r=2*Wp.b;if("rect"===t.tagName.toLowerCase()){const e=Number(t.getAttribute("x"));e<0&&(r=Math.abs(e))}this.props.tooltipService.show(s,t,{x:r,y:0})}highlightFocusChartAnomaly(e){const{focusChartData:t,focusAggregationInterval:a}=this.props,n=this.focusXScale,i=this.focusYScale,s=this.showFocusChartTooltip.bind(this),r=Dp(t,e.source.timestamp,a);if(void 0!==r){const e=qp.a.select(".focus-chart-markers").selectAll(".focus-chart-highlighted-marker").data([r]);!0===Object(Wp.o)(r)?e.enter().append("path").attr("d",qp.a.svg.symbol().size(Wp.c).type("cross")).attr("transform",(e=>`translate(${n(e.date)}, ${i(e.value)})`)).attr("class",(e=>`anomaly-marker multi-bucket ${Object(Yd.l)(e.anomalyScore).id} highlighted`)):e.enter().append("circle").attr("r",Wp.b).attr("cx",(e=>n(e.date))).attr("cy",(e=>i(e.value))).attr("class",(e=>`anomaly-marker metric-value ${Object(Yd.l)(e.anomalyScore).id} highlighted`));const t=qp.a.select(this.rootNode).selectAll(".focus-chart-markers .anomaly-marker.highlighted");t.length&&s(r,t[0][0])}}unhighlightFocusChartAnomaly(){qp.a.select(".focus-chart-markers").selectAll(".anomaly-marker.highlighted").remove(),this.props.tooltipService.hide()}shouldComponentUpdate(){return!0}setRef(e){this.rootNode=e}render(){return Object(I.jsx)("div",{className:"ml-timeseries-chart-react",ref:this.setRef.bind(this)})}}const cm=e=>{const t=Object(i.useContext)(W.a),a=z()(t.isAnnotationInitialized$());return void 0===a?null:Object(I.jsx)(timeseries_chart_TimeseriesChartIntl,h()({annotation:a},e,{annotationUpdatesService:t}))},dm=({bounds:e,detectorIndex:t,renderFocusChartOnly:a,selectedJob:n,selectedEntities:s,showAnnotations:r,showForecast:l,showModelBounds:c,chartProps:u,lastRefresh:p,contextAggregationInterval:m})=>{const{toasts:b}=Object(d.f)(),{services:{mlServices:{mlApiServices:f}}}=Object(d.b)(),g=Object(i.useContext)(W.a),[j,x]=Object(i.useState)([]),v=Object(i.useCallback)((e=>{b.addDanger({title:o.i18n.translate("xpack.ml.timeSeriesExplorer.mlSingleMetricViewerChart.annotationsErrorTitle",{defaultMessage:"An error occurred fetching annotations"}),...e?{text:Object(Re.b)(e)}:{}})}),[]);return Object(i.useEffect)((()=>{let a=!1;const i=Np(t,s,n.job_id),r=Array.isArray(i)?i.filter((e=>null!==e.fieldValue)):void 0,o=Object(Ts.b)(e,m,!1);return(async e=>{try{const n=await f.annotations.getAnnotations({jobIds:[e],earliestMs:o.min.valueOf(),latestMs:o.max.valueOf(),maxAnnotations:O.a,detectorIndex:t,entities:r});a||Array.isArray(n.annotations[e])&&x(n.annotations[e])}catch(e){v(e)}})(n.job_id),()=>{a=!0}}),[n.job_id,t,p,s,e,m]),Object(I.jsx)("div",{className:"ml-timeseries-chart","data-test-subj":"mlSingleMetricViewerChart"},Object(I.jsx)(Up.a,null,(i=>Object(I.jsx)(cm,h()({},u,{annotationUpdatesService:g,annotationData:j,bounds:e,detectorIndex:t,renderFocusChartOnly:a,selectedJob:n,showAnnotations:r,showForecast:l,showModelBounds:c,tooltipService:i})))))},um=({errorMsg:e})=>Object(I.jsx)(r.EuiEmptyPrompt,{iconType:"alert",title:Object(I.jsx)("h2",null,e)}),pm=({viewBySwimlaneFieldName:e,showFilterMessage:t=!1})=>!1===t?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitle",defaultMessage:"No {viewBySwimlaneFieldName} influencers found",values:{viewBySwimlaneFieldName:e}}):Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.noInfluencersFoundTitleFilterMessage",defaultMessage:"No {viewBySwimlaneFieldName} influencers found for specified filter",values:{viewBySwimlaneFieldName:e}}),mm=()=>Object(I.jsx)(r.EuiEmptyPrompt,{iconType:"alert",title:Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.noJobSelectedLabel",defaultMessage:"No jobs selected"})),"data-test-subj":"mlNoJobsFound"}),bm=({hasResults:e,selectedJobsRunning:t})=>{const a=!0===e,n=!1===e;return Object(I.jsx)(r.EuiEmptyPrompt,{iconType:"iInCircle",title:Object(I.jsx)("h2",null,a&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.noAnomaliesFoundLabel",defaultMessage:"No anomalies found"}),n&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.noResultsFoundLabel",defaultMessage:"No results found"})),body:Object(I.jsx)(s.a.Fragment,null,t&&n&&Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.selectedJobsRunningLabel",defaultMessage:"One or more selected jobs are still running and results may not be available yet."})),!t&&Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.tryWideningTimeSelectionLabel",defaultMessage:"Try widening the time selection or moving further back in time"})))})},fm=o.i18n.translate("xpack.ml.timeSeriesExplorer.allPartitionValuesLabel",{defaultMessage:"all"});class timeseriesexplorer_TimeSeriesExplorer extends s.a.Component{constructor(...e){super(...e),Se()(this,"state",{chartDetails:void 0,contextAggregationInterval:void 0,contextChartData:void 0,contextForecastData:void 0,dataNotChartable:!1,entitiesLoading:!1,entityValues:{},focusAnnotationData:[],focusAggregationInterval:{},focusChartData:void 0,focusForecastData:void 0,fullRefresh:!0,hasResults:!1,loadCounter:0,loading:!1,modelPlotEnabled:!1,showAnnotations:!0,showAnnotationsCheckbox:!0,showForecast:!0,showForecastCheckbox:!1,showModelBounds:!0,showModelBoundsCheckbox:!1,svgWidth:0,tableData:void 0,zoomFrom:void 0,zoomTo:void 0,zoomFromFocusLoaded:void 0,zoomToFocusLoaded:void 0,chartDataError:void 0}),Se()(this,"subscriptions",new Ee.Subscription),Se()(this,"resizeRef",Object(i.createRef)()),Se()(this,"resizeChecker",void 0),Se()(this,"resizeHandler",(()=>{this.setState({svgWidth:null!==this.resizeRef.current?this.resizeRef.current.offsetWidth-34:0})})),Se()(this,"unmounted",!1),Se()(this,"contextChart$",new Ee.Subject),Se()(this,"getFieldNamesWithEmptyValues",(()=>this.getControlsForDetector().filter((({fieldValue:e})=>null===e)).map((({fieldName:e})=>e)))),Se()(this,"arePartitioningFieldsProvided",(()=>0===this.getFieldNamesWithEmptyValues().length)),Se()(this,"toggleShowAnnotationsHandler",(()=>{this.setState((e=>({showAnnotations:!e.showAnnotations})))})),Se()(this,"toggleShowForecastHandler",(()=>{this.setState((e=>({showForecast:!e.showForecast})))})),Se()(this,"toggleShowModelBoundsHandler",(()=>{this.setState({showModelBounds:!this.state.showModelBounds})})),Se()(this,"setFunctionDescription",(e=>{this.props.appStateHandler(Mp,e)})),Se()(this,"previousChartProps",{}),Se()(this,"previousShowAnnotations",void 0),Se()(this,"previousShowForecast",void 0),Se()(this,"previousShowModelBounds",void 0),Se()(this,"tableFilter",((e,t,a)=>{const n=this.getControlsForDetector(),i=n.find((({fieldName:t})=>t===e));if(void 0===i)return;const{appStateHandler:s}=this.props;let r="";if("+"===a&&i.fieldValue!==t)r=t;else{if("-"!==a||i.fieldValue!==t)return;r=null}const o={...n.reduce(((e,t)=>(e[t.fieldName]=t.fieldValue,e)),{}),[i.fieldName]:r};s(yp,o)})),Se()(this,"contextChartSelectedInitCallDone",!1),Se()(this,"contextChartSelected",(e=>{const t={from:e.from.toISOString(),to:e.to.toISOString()};Object(x.isEqual)(this.props.zoom,t)&&void 0!==this.state.focusChartData&&this.props.previousRefresh===this.props.lastRefresh||(this.contextChart$.next(e),this.props.appStateHandler(Ep,t))})),Se()(this,"loadAnomaliesTableData",((e,t)=>{const{dateFormatTz:a,selectedDetectorIndex:n,selectedJobId:i,tableInterval:s,tableSeverity:r,functionDescription:o}=this.props,l=te.a.getJob(i),c=this.getControlsForDetector();return be.ml.results.getAnomaliesTableData([l.job_id],this.getCriteriaFields(n,c),[],s,r,e,t,a,O.b,void 0,void 0,o).pipe(Object(we.map)((e=>{const t=e.anomalies,a=te.a.detectorsByJob;return t.forEach((e=>{const t=e.jobId,n=Object(x.get)(a,[t,e.detectorIndex]);e.detector=Object(x.get)(n,["detector_description"],e.source.function_description);const i=n.custom_rules;void 0!==i&&(e.rulesLength=i.length),Object(x.has)(te.a.customUrlsByJob,t)&&(e.customUrls=te.a.customUrlsByJob[t])})),{tableData:{anomalies:t,interval:e.interval,examplesByJobId:e.examplesByJobId,showViewSeriesLink:!1}}})))})),Se()(this,"setForecastId",(e=>{this.props.appStateHandler(Op,e)})),Se()(this,"displayErrorToastMessages",((e,t)=>{this.props.toastNotificationService&&this.props.toastNotificationService.displayErrorToast(e,t,2e3),this.setState({loading:!1,chartDataError:t})})),Se()(this,"loadSingleMetricData",((e=!0)=>{const{autoZoomDuration:t,bounds:a,selectedDetectorIndex:n,selectedForecastId:i,selectedJobId:s,zoom:r,functionDescription:l}=this.props,{loadCounter:c}=this.state,d=te.a.getJob(s);if(void 0===d)return;if(zp(d,n)&&void 0===l)return;const u=Yd.c.toES(l);this.contextChartSelectedInitCallDone=!1;const p=this.getControlsForDetector();this.setState({fullRefresh:e,loadCounter:c+1,loading:!0,chartDataError:void 0,...e?{chartDetails:void 0,contextChartData:void 0,contextForecastData:void 0,focusChartData:void 0,focusForecastData:void 0,modelPlotEnabled:Object(_e.l)(d,n)&&Object(_e.m)(d,n,p),hasResults:!1,dataNotChartable:!1}:{}},(()=>{const{loadCounter:e,modelPlotEnabled:l}=this.state,c=Cp(te.a.jobs),d=te.a.getJob(s),m=n;let b=3;const f={},h=n=>{if(b--,0===b&&n===e){if(f.hasResults=Array.isArray(f.contextChartData)&&f.contextChartData.length>0||Array.isArray(f.contextForecastData)&&f.contextForecastData.length>0,f.loading=!1,f.contextChartData.length&&!0===this.arePartitioningFieldsProvided()){let e=function(e,t,a){if(void 0!==e){const n=Pd()(e.from,"YYYY-MM-DDTHH:mm:ss.SSSZ",!0),i=Pd()(e.to,"YYYY-MM-DDTHH:mm:ss.SSSZ",!0),s=Object(Ts.b)(a,t,!0),r=s.min,o=s.max;if(n.isValid()&&i.isValid&&i.isAfter(n)&&n.isBetween(r,o,null,"[]")&&i.isBetween(r,o,null,"[]"))return[n.toDate(),i.toDate()]}}(r,f.contextAggregationInterval,a);void 0!==e&&this.previousSelectedForecastId===this.props.selectedForecastId||(e=function(e,t,a,n){const i=void 0!==n&&n.length>0,s=!1===i?a:a.concat(n),r=s[0].date,o=s[s.length-1].date;let l,c;if(!0===i){const t=n[0].date,a=n[n.length-1].date;c=Math.min(t.getTime()+e/2,a.getTime()),l=Math.max(c-e,r.getTime())}else c=o.getTime()+t.asMilliseconds(),l=Math.max(r.getTime(),c-e);return[new Date(l),new Date(c)]}(t,f.contextAggregationInterval,f.contextChartData,f.contextForecastData),this.previousSelectedForecastId=this.props.selectedForecastId),this.contextChartSelected({from:e[0],to:e[1]})}this.setState(f)}},g=p.filter((e=>null!==e.fieldValue));if(!1===l&&!1===Object(_e.n)(d,m)&&g.length>0)return f.hasResults=!1,f.loading=!1,f.dataNotChartable=!0,void this.setState(f);f.contextAggregationInterval=Ap(a,Sp,c,d);const j=Object(Ts.b)(a,f.contextAggregationInterval,!1),v=e;if(Tp.getMetricData(d,m,g,j.min.valueOf(),j.max.valueOf(),f.contextAggregationInterval.asMilliseconds(),u).toPromise().then((e=>{const t=kp(e.results,l);f.contextChartData=t,h(v)})).catch((e=>{const t=o.i18n.translate("xpack.ml.timeSeriesExplorer.metricDataErrorMessage",{defaultMessage:"Error getting metric data"});this.displayErrorToastMessages(e,t)})),Es.mlResultsService.getRecordMaxScoreByTime(d.job_id,this.getCriteriaFields(m,p),j.min.valueOf(),j.max.valueOf(),f.contextAggregationInterval.asMilliseconds(),u).then((e=>{const t=function(e){const t=[];return Object(x.each)(e,((e,a)=>{t.push({date:new Date(+a),score:e.score})})),t}(e.results);f.swimlaneData=t,h(v)})).catch((e=>{const t=o.i18n.translate("xpack.ml.timeSeriesExplorer.bucketAnomalyScoresErrorMessage",{defaultMessage:"Error getting bucket anomaly scores"});this.displayErrorToastMessages(e,t)})),Tp.getChartDetails(d,m,p,j.min.valueOf(),j.max.valueOf()).then((e=>{f.chartDetails=e.results,h(v)})).catch((e=>{this.displayErrorToastMessages(e,o.i18n.translate("xpack.ml.timeSeriesExplorer.entityCountsErrorMessage",{defaultMessage:"Error getting entity counts"}))})),void 0!==i){let e;b++;const t=d.analysis_config.detectors[m],a=Object(_e.q)(t.function);!1!==l||"sum"!==a&&"count"!==a||(e={avg:"sum",max:"sum",min:"sum"}),ep.a.getForecastData(d,m,i,g,j.min.valueOf(),j.max.valueOf(),f.contextAggregationInterval.asMilliseconds(),e).toPromise().then((e=>{f.contextForecastData=Fp(e.results),h(v)})).catch((e=>{this.displayErrorToastMessages(e,o.i18n.translate("xpack.ml.timeSeriesExplorer.forecastDataErrorMessage",{defaultMessage:"Error loading forecast data for forecast ID {forecastId}",values:{forecastId:i}}))}))}}))})),Se()(this,"getControlsForDetector",(()=>{const{selectedDetectorIndex:e,selectedEntities:t,selectedJobId:a}=this.props;return Np(e,t,a)}))}getFocusAggregationInterval(e){const{selectedJobId:t}=this.props,a=Cp(te.a.jobs),n=te.a.getJob(t);return Ap({min:Pd()(e.from),max:Pd()(e.to)},Sp,a,n)}getFocusData(e){const{selectedJobId:t,selectedForecastId:a,selectedDetectorIndex:n,functionDescription:i}=this.props,{modelPlotEnabled:s}=this.state,r=te.a.getJob(t);if(zp(r,n)&&void 0===i)return;const o=this.getControlsForDetector(),l={min:Pd()(e.from),max:Pd()(e.to)},c=this.getFocusAggregationInterval(e),d=Object(Ts.b)(l,c,!1);return Lp(this.getCriteriaFields(n,o),n,c,a,s,o.filter((e=>null!==e.fieldValue)),d,r,i)}getCriteriaFields(e,t){return[{fieldName:"detector_index",fieldValue:e},...t.filter((e=>null!==e.fieldValue))]}loadForJobId(e){const{appStateHandler:t,selectedDetectorIndex:a}=this.props,n=te.a.getJob(e);if(void 0===n)return;const i=Pp(n);let s=void 0!==a?a:i[0].index;if(void 0===Object(x.find)(i,{index:s})){const e=o.i18n.translate("xpack.ml.timeSeriesExplorer.requestedDetectorIndexNotValidWarningMessage",{defaultMessage:"Requested detector index {detectorIndex} is not valid for job {jobId}",values:{detectorIndex:s,jobId:n.job_id}});this.props.toastNotificationService&&this.props.toastNotificationService.displayWarningToast(e),s=i[0].index}s!==a&&t(vp,s),ru.a.populateFormats([e])}componentDidMount(){const{invalidTimeRangeError:e}=this.props;e&&this.props.toastNotificationService&&this.props.toastNotificationService.displayWarningToast(o.i18n.translate("xpack.ml.timeSeriesExplorer.invalidTimeRangeInUrlCallout",{defaultMessage:"The time filter was changed to the full range for this job due to an invalid default time filter. Check the advanced settings for {field}.",values:{field:Rp.a}})),this.resizeChecker=new zd.ResizeChecker(this.resizeRef.current),this.resizeChecker.on("resize",(()=>{this.resizeHandler()})),this.resizeHandler(),this.subscriptions.add(this.contextChart$.pipe(Object(we.tap)((e=>{this.setState({zoomFrom:e.from,zoomTo:e.to})})),Object(we.debounceTime)(500),Object(we.tap)((e=>{const{contextChartData:t,contextForecastData:a,focusChartData:n,zoomFromFocusLoaded:i,zoomToFocusLoaded:s}=this.state;(void 0!==t&&0!==t.length||void 0!==a&&0!==a.length)&&(!1===this.contextChartSelectedInitCallDone&&void 0===n||i.getTime()!==e.from.getTime()||s.getTime()!==e.to.getTime())&&(this.contextChartSelectedInitCallDone=!0,this.setState({loading:!0,fullRefresh:!1}))})),Object(we.switchMap)((e=>{const{selectedJobId:t}=this.props,a=Cp(te.a.jobs),n=te.a.getJob(t),i={min:Pd()(e.from),max:Pd()(e.to)},s=Ap(i,Sp,a,n),r=Object(Ts.b)(i,s,!1);return Object(Ee.forkJoin)([this.getFocusData(e),this.loadAnomaliesTableData(r.min.valueOf(),r.max.valueOf())])})),Object(we.withLatestFrom)(this.contextChart$)).subscribe((([[e,t],a])=>{const{modelPlotEnabled:n}=this.state;this.setState({focusAggregationInterval:this.getFocusAggregationInterval({from:a.from,to:a.to}),loading:!1,showModelBoundsCheckbox:n&&e.focusChartData.length>0,zoomFromFocusLoaded:a.from,zoomToFocusLoaded:a.to,...e,...t})}))),this.componentDidUpdate()}componentDidUpdate(e){if(void 0!==e&&e.selectedJobId===this.props.selectedJobId||(this.contextChartSelectedInitCallDone=!1,this.setState({fullRefresh:!1,loading:!0},(()=>{this.loadForJobId(this.props.selectedJobId)}))),void 0!==e&&e.selectedForecastId===this.props.selectedForecastId||void 0!==this.props.selectedForecastId&&(this.setState({showForecast:!0}),void 0!==e&&(this.previousSelectedForecastId=e.selectedForecastId)),void 0===e||!Object(x.isEqual)(e.bounds,this.props.bounds)||!Object(x.isEqual)(e.lastRefresh,this.props.lastRefresh)&&0!==e.lastRefresh||!Object(x.isEqual)(e.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(x.isEqual)(e.selectedEntities,this.props.selectedEntities)||e.selectedForecastId!==this.props.selectedForecastId||e.selectedJobId!==this.props.selectedJobId||e.functionDescription!==this.props.functionDescription){const t=void 0===e||!Object(x.isEqual)(e.bounds,this.props.bounds)||!Object(x.isEqual)(e.selectedDetectorIndex,this.props.selectedDetectorIndex)||!Object(x.isEqual)(e.selectedEntities,this.props.selectedEntities)||e.selectedForecastId!==this.props.selectedForecastId||e.selectedJobId!==this.props.selectedJobId||e.functionDescription!==this.props.functionDescription;this.loadSingleMetricData(t)}if(void 0===e)return;const t=()=>{const{zoomFrom:e,zoomTo:t}=this.state;void 0!==e&&void 0!==t&&this.loadAnomaliesTableData(e.getTime(),t.getTime()).subscribe((e=>this.setState(e)))};e.tableInterval===this.props.tableInterval&&e.tableSeverity===this.props.tableSeverity||t()}componentWillUnmount(){this.subscriptions.unsubscribe(),this.resizeChecker.destroy(),this.unmounted=!0}render(){const{autoZoomDuration:e,bounds:t,dateFormatTz:a,lastRefresh:n,selectedDetectorIndex:l,selectedJobId:c}=this.props,{chartDetails:d,contextAggregationInterval:u,contextChartData:p,contextForecastData:m,dataNotChartable:b,focusAggregationInterval:f,focusAnnotationError:h,focusAnnotationData:g,focusChartData:j,focusForecastData:v,fullRefresh:y,hasResults:O,loading:E,modelPlotEnabled:w,showAnnotations:M,showAnnotationsCheckbox:S,showForecast:_,showForecastCheckbox:T,showModelBounds:C,showModelBoundsCheckbox:k,svgWidth:F,swimlaneData:D,tableData:A,zoomFrom:L,zoomTo:R,zoomFromFocusLoaded:N,zoomToFocusLoaded:P,chartDataError:z}=this.state,B={modelPlotEnabled:w,contextChartData:p,contextChartSelected:this.contextChartSelected,contextForecastData:m,contextAggregationInterval:u,swimlaneData:D,focusAnnotationData:g,focusChartData:j,focusForecastData:v,focusAggregationInterval:f,svgWidth:F,zoomFrom:L,zoomTo:R,zoomFromFocusLoaded:N,zoomToFocusLoaded:P,autoZoomDuration:e},J=Cp(te.a.jobs);if(void 0===l||void 0===te.a.getJob(c))return Object(I.jsx)(jp,{dateFormatTz:a,resizeRef:this.resizeRef},Object(I.jsx)(mm,null));const V=te.a.getJob(c),U=this.getControlsForDetector(),G=this.getFieldNamesWithEmptyValues(),q=this.arePartitioningFieldsProvided(),W=Pp(V);let H=!0;return Object(x.isEqual)(this.previousChartProps.focusForecastData,B.focusForecastData)&&Object(x.isEqual)(this.previousChartProps.focusChartData,B.focusChartData)&&Object(x.isEqual)(this.previousChartProps.focusAnnotationData,B.focusAnnotationData)&&this.previousShowForecast===_&&this.previousShowModelBounds===C&&this.props.previousRefresh===n&&(H=!1),this.previousChartProps=B,this.previousShowForecast=_,this.previousShowModelBounds=C,Object(I.jsx)(jp,{dateFormatTz:a,resizeRef:this.resizeRef},G.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiCallOut,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.singleMetricRequiredMessage",defaultMessage:"To view a single metric, select {missingValuesCount, plural, one {a value for {fieldName1}} other {values for {fieldName1} and {fieldName2}}}.",values:{missingValuesCount:G.length,fieldName1:G[0],fieldName2:G[1]}}),iconType:"help",size:"s"}),Object(I.jsx)(r.EuiSpacer,{size:"m"})),Object(I.jsx)(Vp,{selectedJobId:c,appStateHandler:this.props.appStateHandler,selectedDetectorIndex:l,selectedEntities:this.props.selectedEntities,bounds:t,functionDescription:this.props.functionDescription,setFunctionDescription:this.setFunctionDescription},q&&Object(I.jsx)(r.EuiFlexItem,{style:{textAlign:"right"}},Object(I.jsx)(r.EuiFormRow,{hasEmptyLabelSpace:!0,style:{maxWidth:"100%"}},Object(I.jsx)(rp,{job:V,detectorIndex:l,entities:U,setForecastId:this.setForecastId,className:"forecast-controls"})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),y&&!0===E&&Object(I.jsx)(op.a,{label:o.i18n.translate("xpack.ml.timeSeriesExplorer.loadingLabel",{defaultMessage:"Loading"})}),!1===E&&void 0!==z&&Object(I.jsx)(um,{errorMsg:z}),q&&J.length>0&&(!1===y||!1===E)&&!1===O&&void 0===z&&Object(I.jsx)(fp,{dataNotChartable:b,entities:U}),q&&J.length>0&&(!1===y||!1===E)&&!0===O&&Object(I.jsx)("div",null,Object(I.jsx)("div",{className:"results-container"},Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(I.jsx)(r.EuiTitle,{className:"panel-title"},Object(I.jsx)("h2",{style:{display:"inline"}},Object(I.jsx)("span",null,o.i18n.translate("xpack.ml.timeSeriesExplorer.singleTimeSeriesAnalysisTitle",{defaultMessage:"Single time series analysis of {functionLabel}",values:{functionLabel:d.functionLabel}}))," ",1===d.entityData.count&&Object(I.jsx)("span",{className:"entity-count-text"},d.entityData.entities.length>0&&"(",d.entityData.entities.map((e=>`${e.fieldName}: ${e.fieldValue}`)).join(", "),d.entityData.entities.length>0&&")"),1!==d.entityData.count&&Object(I.jsx)("span",{className:"entity-count-text"},d.entityData.entities.map(((e,t)=>Object(I.jsx)(i.Fragment,{key:e.fieldName},o.i18n.translate("xpack.ml.timeSeriesExplorer.countDataInChartDetailsDescription",{defaultMessage:"{openBrace}{cardinalityValue} distinct {fieldName} {cardinality, plural, one {} other { values}}{closeBrace}",values:{openBrace:0===t?"(":"",closeBrace:t===d.entityData.entities.length-1?")":"",cardinalityValue:0===e.cardinality?fm:e.cardinality,cardinality:e.cardinality,fieldName:e.fieldName}}),t!==d.entityData.entities.length-1?", ":"")))))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Bd,null))),Object(I.jsx)(r.EuiFlexGroup,{style:{float:"right"}},k&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiCheckbox,{id:"toggleModelBoundsCheckbox",label:o.i18n.translate("xpack.ml.timeSeriesExplorer.showModelBoundsLabel",{defaultMessage:"show model bounds"}),checked:C,onChange:this.toggleShowModelBoundsHandler})),S&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiCheckbox,{id:"toggleAnnotationsCheckbox",label:o.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsLabel",{defaultMessage:"annotations"}),checked:M,onChange:this.toggleShowAnnotationsHandler})),T&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiCheckbox,{id:"toggleShowForecastCheckbox",label:Object(I.jsx)("span",{"data-test-subj":"mlForecastCheckbox"},o.i18n.translate("xpack.ml.timeSeriesExplorer.showForecastLabel",{defaultMessage:"show forecast"})),checked:_,onChange:this.toggleShowForecastHandler}))),Object(I.jsx)(dm,{chartProps:B,contextAggregationInterval:u,bounds:t,detectorIndex:l,renderFocusChartOnly:H,selectedJob:V,selectedEntities:this.props.selectedEntities,showAnnotations:M,showForecast:_,showModelBounds:C,lastRefresh:n}),void 0!==h&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotations error"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationsErrorTitle",defaultMessage:"Annotations"}))),Object(I.jsx)(r.EuiPanel,null,Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.timeSeriesExplorer.annotationsErrorCallOutTitle",{defaultMessage:"An error occurred loading annotations:"}),color:"danger",iconType:"alert"},Object(I.jsx)("p",null,h))),Object(I.jsx)(r.EuiSpacer,{size:"m"})),g&&g.length>0&&Object(I.jsx)(r.EuiAccordion,{id:"mlAnnotationsAccordion",buttonContent:Object(I.jsx)(r.EuiTitle,{className:"panel-title"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationsTitle",defaultMessage:"Annotations {badge}",values:{badge:Object(I.jsx)(r.EuiBadge,{color:"hollow"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitleTotalCount",defaultMessage:"Total: {count}",values:{count:g.length}}))}}))),"data-test-subj":"mlAnomalyExplorerAnnotations loaded"},Object(I.jsx)(Vd.a,{chartDetails:d,detectorIndex:l,detectors:W,jobIds:[this.props.selectedJobId],annotations:g,isSingleMetricViewerLinkVisible:!1,isNumberBadgeVisible:!0}),Object(I.jsx)(r.EuiSpacer,{size:"l"})),Object(I.jsx)(Jd.a,{chartDetails:d,detectorIndex:l,detectors:W}),Object(I.jsx)(r.EuiTitle,{className:"panel-title"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.anomaliesTitle",defaultMessage:"Anomalies"}))),Object(I.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:!0},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(bp.a,null)),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(pp,null))),Object(I.jsx)(r.EuiSpacer,{size:"m"}))),q&&J.length>0&&!0===O&&Object(I.jsx)(Pu,{bounds:t,tableData:A,filter:this.tableFilter}))}}const hm=()=>{const e=Object(d.c)({page:p.b.ANOMALY_DETECTION_CREATE_JOB}),t=!Object(m.e)("canCreateJob")||!Object(_.c)();return Object(I.jsx)(r.EuiEmptyPrompt,{"data-test-subj":"mlNoSingleMetricJobsFound",iconType:"alert",title:Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.noSingleMetricJobsFoundLabel",defaultMessage:"No single metric jobs found"})),actions:Object(I.jsx)(r.EuiButton,{color:"primary",fill:!0,href:e,disabled:t},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.createNewSingleMetricJobLinkText",defaultMessage:"Create new single metric job"}))})};var gm=a(256);function jm(){const{overlays:e,services:t}=Object(d.b)(),a=Object(i.useRef)();return Object(i.useEffect)((function(){return()=>{a.current&&a.current.close()}}),[]),Object(i.useCallback)(((n={singleSelection:!1,withTimeRangeSelector:!0,timeseriesOnly:!1})=>{const{uiSettings:i}=t,s=i.get("dateFormat:tz"),r="Browser"!==s?s:Ve.a.tz.guess(),o={groupsMap:Object(gp.b)([]),jobsMap:{}};return new Promise((async(i,s)=>{try{a.current=e.openFlyout(Object(I.jsx)(Si.KibanaContextProvider,{services:t},Object(I.jsx)(gm.a,{selectedIds:[],withTimeRangeSelector:n.withTimeRangeSelector,dateFormatTz:r,singleSelection:!!n.singleSelection,timeseriesOnly:!!n.timeseriesOnly,onFlyoutClose:()=>{s(),a.current.close()},onSelectionConfirmed:e=>{i(e),a.current.close()},maps:o})))}catch(e){s(e)}}))}),[e,t])}var xm=a(149);const vm=(e,t)=>({id:"timeseriesexplorer",path:"/timeseriesexplorer",title:o.i18n.translate("xpack.ml.anomalyDetection.singleMetricViewerLabel",{defaultMessage:"Single Metric Viewer"}),render:(e,t)=>Object(I.jsx)(ym,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.anomalyDetection.singleMetricViewerLabel",{defaultMessage:"Single Metric Viewer"})}],enableDatePicker:!0}),ym=({deps:e})=>{const{context:t,results:a}=S(void 0,void 0,e.config,e.dataViewsContract,{...U(e),jobs:te.a.loadJobsWrapper,jobsWithTimeRange:()=>be.ml.jobs.jobsWithTimerange(Object(el.e)())}),n=Object(i.useMemo)((()=>new q.a),[]);return Object(I.jsx)(g.b,{context:t},Object(I.jsx)(W.a.Provider,{value:n},Object(I.jsx)(Om,{config:e.config,jobsWithTimeRange:a.jobsWithTimeRange.jobs})))},Om=({config:e,jobsWithTimeRange:t})=>{var a,n,s,r,l,u,m,b,f,h,g,j,v,y,O;const{toasts:E}=Object(d.f)(),w=Object(St.c)(),[M,S]=Object(c.b)(p.b.SINGLE_METRIC_VIEWER),[_,T]=Object(c.c)("_g"),[C,k]=Object(i.useState)(),F=Object(d.g)({timeRangeSelector:!0,autoRefreshSelector:!0}),[D,A]=Object(i.useState)(!1),L=Object(xm.a)(),R=Rd()(null!==(a=null==L?void 0:L.lastRefresh)&&void 0!==a?a:0),[N,P]=Object(i.useState)(void 0);Object(i.useEffect)((()=>{if(void 0!==(null==_?void 0:_.time)){"invalid"===_.time.mode&&A(!0);const e=F.getBounds();void 0!==(null==e?void 0:e.min)&&void 0!==(null==e?void 0:e.max)&&P(F.getBounds())}}),[null==_||null===(n=_.time)||void 0===n?void 0:n.from,null==_||null===(s=_.time)||void 0===s?void 0:s.to,null==_||null===(r=_.time)||void 0===r?void 0:r.ts]);const z=null==_||null===(l=_.ml)||void 0===l?void 0:l.jobIds;Array.isArray(z)&&z.sort();const B=Rd()(z),J=!Object(x.isEqual)(B,z),V=J?0:null!==(u=null==M||null===(m=M.mlTimeSeriesExplorer)||void 0===m?void 0:m.detectorIndex)&&void 0!==u?u:0,U=J||null==M||null===(b=M.mlTimeSeriesExplorer)||void 0===b?void 0:b.entities,G=J||null==M||null===(f=M.mlTimeSeriesExplorer)||void 0===f?void 0:f.forecastId,q=J||null==M||null===(h=M.mlTimeSeriesExplorer)||void 0===h?void 0:h.functionDescription,W=J||null==M||null===(g=M.mlTimeSeriesExplorer)||void 0===g?void 0:g.zoom,H=void 0!==C?te.a.getJob(C):void 0,Y=Cp(te.a.jobs);let $;void 0!==C&&void 0!==H&&($=function(e,t){const a=Object(x.find)(e,{id:t.job_id}).bucketSpanSeconds;let n=1e3*a*499;const i=Math.floor(550),s=Object(Ts.c)();s.setInterval("auto"),s.setBarTarget(Math.floor(Sp)),s.setMaxBars(i);const r=(new Date).getTime(),o=Pd()(r),l=Pd()(r-n);s.setBounds({min:l,max:o});const c=s.getIntervalToNearestMultiple(a).asSeconds();return c!==a&&(n*=a/c),n}(Y,H));const X=Object(i.useCallback)(((e,t)=>{var a;const n=void 0===(null==M||null===(a=M.mlTimeSeriesExplorer)||void 0===a?void 0:a.zoom),i=void 0!==(null==M?void 0:M.mlTimeSeriesExplorer)?{...M.mlTimeSeriesExplorer}:{};switch(e){case xp:delete i.detectorIndex,delete i.entities,delete i.forecastId,delete i.zoom,delete i.functionDescription;break;case vp:i.detectorIndex=t,delete i.functionDescription;break;case yp:i.entities=t,delete i.functionDescription;break;case Op:i.forecastId=t,delete i.zoom;break;case Ep:i.zoom=t;break;case wp:delete i.zoom;break;case Mp:i.functionDescription=t}S({mlTimeSeriesExplorer:i},n)}),[JSON.stringify(null==M?void 0:M.mlTimeSeriesExplorer),S]),K=jm();Object(i.useEffect)((()=>{void 0!==z&&void 0!==B&&X(xp);const e=function(e,t,a,n,i){const s=Cp(te.a.jobs),r=s.map((e=>e.id)),l=Object(x.difference)(t,r),c=Object(x.without)(t,...l);if(1===l.length){const t=l[0],a=e.find((e=>e.id===t));if(void 0!==a&&void 0!==a.isNotSingleMetricViewerJobMessage){const e=o.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningWithReasonMessage",{defaultMessage:"You can't view {selectedJobId} in this dashboard because {reason}.",values:{selectedJobId:t,reason:a.isNotSingleMetricViewerJobMessage}});n.addWarning({title:e,"data-test-subj":"mlTimeSeriesExplorerDisabledJobReasonWarningToast"})}}if(l.length>1){let e=o.i18n.translate("xpack.ml.timeSeriesExplorer.canNotViewRequestedJobsWarningMessage",{defaultMessage:"You can't view requested {invalidIdsCount, plural, one {job} other {jobs}} {invalidIds} in this dashboard",values:{invalidIdsCount:l.length,invalidIds:l.join(", ")}});0===c.length&&r.length>0&&(e+=o.i18n.translate("xpack.ml.timeSeriesExplorer.autoSelectingFirstJobText",{defaultMessage:", auto selecting first job"})),n.addWarning(e)}return c.length>1?(n.addWarning(o.i18n.translate("xpack.ml.timeSeriesExplorer.youCanViewOneJobAtTimeWarningMessage",{defaultMessage:"You can only view one job at a time in this dashboard"})),a("ml",{jobIds:[c[0]]}),!0):l.length>0&&c.length>0?(a("ml",{jobIds:[c[0]]}),!0):1===c.length?c[0]:0===c.length&&s.length>0&&(i({singleSelection:!0,timeseriesOnly:!0}).then((({jobIds:e,time:t})=>{a({ml:{jobIds:e},...void 0!==t?{time:t}:{}})})).catch((e=>{})),!0)}(t,z,T,E,K);"string"==typeof e&&k(e)}),[JSON.stringify(z)]);const Q=null==N||null===(j=N.min)||void 0===j?void 0:j.valueOf(),Z=null==N||null===(v=N.max)||void 0===v?void 0:v.valueOf(),[ee,ae]=Object(i.useState)(null==M||null===(y=M.mlTimeSeriesExplorer)||void 0===y?void 0:y.forecastId);Object(i.useEffect)((()=>{void 0!==$&&void 0!==Q&&void 0!==Z&&void 0!==H&&void 0!==G&&(ee!==G&&ae(void 0),ep.a.getForecastDateRange(H,G).then((e=>{if(void 0===$)return;const t=Ve()(e.earliest||Q),a=Ve()(e.latest||Z);if(t.isBefore(Ve()(Q))||a.isAfter(Ve()(Z))){const e=Math.min(t.valueOf(),Q),n=Math.max(a.valueOf(),Z);T("time",{from:Ve()(e).toISOString(),to:Ve()(n).toISOString()})}ae(G)})).catch((e=>{console.error("Time series explorer - error loading time range of forecast from elasticsearch:",e)})))}),[G]);const[ne]=up(),[ie]=Object(bp.d)(),se=e.get("dateFormat:tz"),re="Browser"!==se?se:Ve.a.tz.guess();if(0===Y.length)return Object(I.jsx)(jp,{dateFormatTz:re,noSingleMetricJobsFound:!0},Object(I.jsx)(hm,null));const oe="string"==typeof G&&void 0===ee?void 0:W;return Object(I.jsx)(timeseriesexplorer_TimeSeriesExplorer,{toastNotificationService:w,appStateHandler:X,autoZoomDuration:$,bounds:N,dateFormatTz:re,lastRefresh:null!==(O=null==L?void 0:L.lastRefresh)&&void 0!==O?O:0,previousRefresh:R,selectedJobId:C,selectedDetectorIndex:V,selectedEntities:U,selectedForecastId:ee,tableInterval:ne.val,tableSeverity:ie.val,timefilter:F,zoom:oe,invalidTimeRangeError:D,functionDescription:q})};var Em=a(58),wm=a.n(Em);const Mm=({influencerFieldName:e,influencerFilter:t,valueData:a})=>{const n=Math.floor(a.maxAnomalyScore),i=Object(Yd.g)(a.maxAnomalyScore),o=Object(Yd.i)(n),l=Math.floor(a.sumAnomalyScore),c=Object(Yd.g)(a.sumAnomalyScore),d={width:`${0!==n?n:1}%`},u=function(e,t){return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.influencersList.maxAnomalyScoreTooltipDescription",defaultMessage:"Maximum anomaly score: {maxScoreLabel}",values:{maxScoreLabel:e}})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.influencersList.totalAnomalyScoreTooltipDescription",defaultMessage:"Total anomaly score: {totalScoreLabel}",values:{totalScoreLabel:t}})))}(i,c);return Object(I.jsx)("div",{"data-test-subj":`mlInfluencerEntry field-${e}`},Object(I.jsx)("div",{className:"field-label","data-test-subj":"mlInfluencerEntryFieldLabel"},Object(I.jsx)(Qd,{entityName:e,entityValue:a.influencerFieldValue,filter:t})),Object(I.jsx)("div",{className:`progress ${o.id}`},Object(I.jsx)("div",{className:"progress-bar-holder"},Object(I.jsx)("div",{className:"progress-bar",style:d})),Object(I.jsx)("div",{className:"score-label"},Object(I.jsx)(r.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${e}: ${a.influencerFieldValue}`,content:u},Object(I.jsx)("span",null,i)))),Object(I.jsx)("div",{className:"total-score-label"},Object(I.jsx)(r.EuiToolTip,{position:"right",className:"ml-influencers-list-tooltip",title:`${e}: ${a.influencerFieldValue}`,content:u},Object(I.jsx)("span",null,l>0?function(e,t=3){return Math.abs(e)<Math.pow(10,t)?e:wm()(e).format("0a")}(l,4):c))))},Sm=({influencerFieldName:e,influencerFilter:t,fieldValues:a})=>{const n=a.map((a=>Object(I.jsx)(Mm,{key:a.influencerFieldValue,influencerFieldName:e,influencerFilter:t,valueData:a})));return Object(I.jsx)(s.a.Fragment,{key:e},Object(I.jsx)(r.EuiTitle,{size:"xs","data-test-subj":`mlInfluencerFieldName ${e}`},Object(I.jsx)("h3",null,e)),Object(I.jsx)(r.EuiSpacer,{size:"xs"}),n)},_m=({influencers:e,influencerFilter:t})=>{if(void 0===e||0===Object.keys(e).length)return Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround",className:"ml-influencers-list"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiSpacer,{size:"xxl"}),Object(I.jsx)(r.EuiTitle,{size:"xs",className:"influencer-title"},Object(I.jsx)("h3",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.influencersList.noInfluencersFoundTitle",defaultMessage:"No influencers found"})))));const a=Object.keys(e).map((a=>Object(I.jsx)(Sm,{key:a,influencerFieldName:a,influencerFilter:t,fieldValues:e[a]})));return Object(I.jsx)("div",{className:"ml-influencers-list"},a)};var Tm=a(85);var Cm=a(207),km=a(151),Fm=a(208);const Im=(e,t)=>Object(x.isEqual)(e,t),Dm=(e,t)=>Os()(((e,t=null)=>function(a,...n){return e.apply(t,n)})(e,t),Im),Am=Dm(el.q),Lm=Dm(el.n),Rm=Dm(el.p),Nm=Dm(el.r),Pm=Dm(el.o),zm=()=>{const e=Object(d.g)(),{services:{mlServices:{mlApiServices:t},uiSettings:a}}=Object(d.b)(),n=Object(i.useMemo)((()=>{const n=Object(Es.mlResultsServiceProvider)(t);return((e,t,a,n)=>{const i=Dm(t.loadOverallData,t),s=Dm(t.loadViewBySwimlane,t),r=Dm(a.getAnomalyData,a);return o=>{if(void 0===(l=o)||void 0===l.selectedJobs||null===l.selectedJobs||void 0===l.viewBySwimlaneFieldName)return Object(Ee.of)({});var l;const{lastRefresh:c,influencersFilterQuery:d,noInfluencersConfigured:u,selectedCells:p,selectedJobs:m,swimlaneBucketInterval:b,swimlaneLimit:f,tableInterval:h,tableSeverity:g,viewBySwimlaneFieldName:j,swimlaneContainerWidth:x,viewByFromPage:v,viewByPerPage:y,swimLaneSeverity:O}=o,E=m.reduce(((e,t)=>({...e,[t.id]:te.a.getJob(t.id)})),{}),w=Object(el.i)(p,j),M=Object(el.j)(p,m),S=n.getBounds(),_=Object(el.k)(p,b.asSeconds(),S),T=Object(el.e)(),C=b.asSeconds();return Object(Ee.forkJoin)({overallAnnotations:Am(c,m,C,S),annotationsData:Lm(c,p,m,b.asSeconds(),S),anomalyChartRecords:a.loadDataForCharts$(M,_.earliestMs,_.latestMs,w,p,d),influencers:0===w.length?Nm(c,e,M,_.earliestMs,_.latestMs,[],u,d):Promise.resolve({}),overallState:i(c,m,x,void 0,O),tableData:Pm(c,p,m,T,b.asSeconds(),S,j,h,g,d),topFieldValues:void 0!==p&&!0===p.showTopFieldValues?t.loadViewByTopFieldValuesForSelectedTime(_.earliestMs,_.latestMs,m,j,f,y,v,x,w,d):Promise.resolve([])}).pipe(Object(we.tap)($m.setViewBySwimlaneLoading),Object(we.tap)((({anomalyChartRecords:e,topFieldValues:t})=>{r(c,$m,E,x,void 0!==p&&Array.isArray(e)?e:[],_.earliestMs,_.latestMs,n,g)})),Object(we.mergeMap)((({overallAnnotations:t,anomalyChartRecords:a,influencers:n,overallState:i,topFieldValues:r,annotationsData:o,tableData:l})=>Object(Ee.forkJoin)({filteredTopInfluencers:(w.length>0||void 0!==d)&&void 0!==a&&a.length>0?Rm(c,e,M,_.earliestMs,_.latestMs,a,w,u,d):Promise.resolve(n),viewBySwimlaneState:s(c,r,{earliest:i.earliest,latest:i.latest},m,j,Tm.a,y,v,x,d,void 0,O)}).pipe(Object(we.map)((({viewBySwimlaneState:e,filteredTopInfluencers:a})=>({overallAnnotations:t,annotations:o,influencers:a,loading:!1,viewBySwimlaneDataLoading:!1,anomalyChartsDataLoading:!1,overallSwimlaneData:i,viewBySwimlaneData:e,tableData:l,swimlaneLimit:Object(km.c)(e)?e.cardinality:void 0})))))))}})(n,new Cm.AnomalyTimelineService(e,a,n),new Fm.a(e,t,n),e)}),[]),s=Object(i.useMemo)((()=>new Ee.Subject),[]),r=Object(i.useMemo)((()=>s.pipe(Object(we.switchMap)(n))),[]);return[z()(r),Object(i.useCallback)((e=>{s.next(e)}),[])]};var Bm=a(209),Jm=a(257);const Vm=e=>{const{filterActive:t,loading:a,selectedCells:n,viewBySwimlaneData:i,viewBySwimlaneDataLoading:s}=e;if(a||s)return{};let r=!1;return null!=n&&n.type===Tm.h.VIEW_BY&&void 0!==i&&void 0!==i.points&&i.points.length>0&&(r=!1===t&&!n.lanes.some((e=>i.points.some((t=>t.laneLabel===e&&t.time>=n.times[0]&&t.time<=n.times[1]))))),!0===r?{...Object(el.d)()}:{}};var Um=a(371);function Gm(){return{overallAnnotations:{error:void 0,annotationsData:[]},annotations:{error:void 0,annotationsData:[]},anomalyChartsDataLoading:!0,chartsData:Object(Jm.a)(),fieldFormatsLoading:!1,filterActive:!1,filteredFields:[],filterPlaceHolder:void 0,indexPattern:{title:Um.a,fields:[]},influencersFilterQuery:void 0,influencers:{},isAndOperator:!1,loading:!0,maskAll:!1,noInfluencersConfigured:!0,overallSwimlaneData:Object(el.f)(),queryString:"",selectedCells:void 0,selectedJobs:null,swimlaneBucketInterval:void 0,swimlaneContainerWidth:0,tableData:{anomalies:[],examplesByJobId:[""],interval:0,jobIds:[],showViewSeriesLink:!1},tableQueryString:"",viewByLoadedForTimeFormatted:null,viewBySwimlaneData:Object(el.f)(),viewBySwimlaneDataLoading:!1,viewBySwimlaneFieldName:void 0,viewBySwimlaneOptions:[],viewByPerPage:Tm.i,viewByFromPage:1,swimlaneLimit:void 0,showCharts:!0}}const qm=e=>{const{influencers:t,noInfluencersConfigured:a}=e;if(void 0!==t&&!a)for(const e in t)if(t[e][0]&&t[e][0].influencerFieldValue)return{filterPlaceHolder:o.i18n.translate("xpack.ml.explorer.kueryBar.filterPlaceholder",{defaultMessage:"Filter by influencer fields… ({queryExample})",values:{queryExample:`${e} : ${t[e][0].influencerFieldValue}`}})};return{}};const Wm=new Ee.Subject,Hm=Wm.pipe(Object(we.flatMap)((e=>Object(Ee.isObservable)(e)?e:Object(Ee.from)([e]))),Object(we.distinctUntilChanged)(x.isEqual)).pipe(Object(we.scan)(((e,t)=>{const{type:a,payload:n}=t;let i;switch(a){case Tm.c.CLEAR_EXPLORER_DATA:i=Gm();break;case Tm.c.CLEAR_INFLUENCER_FILTER_SETTINGS:i=function(e){return{...e,filterActive:!1,filteredFields:[],influencersFilterQuery:void 0,isAndOperator:!1,maskAll:!1,queryString:"",tableQueryString:"",...Object(el.d)(),viewByFromPage:1}}(e);break;case Tm.c.CLEAR_JOBS:i={...e,...Object(el.d)(),loading:!1,viewByFromPage:1,selectedJobs:[]};break;case Tm.c.JOB_SELECTION_CHANGE:i=((e,t)=>{const{selectedJobs:a}=t,n={...e,noInfluencersConfigured:0===Object(el.g)(a).length,overallSwimlaneData:Object(el.f)(),selectedJobs:a,viewByFromPage:!e.selectedJobs||Object(x.isEqual)(e.selectedJobs,a)?e.viewByFromPage:1};if(!0===n.noInfluencersConfigured){const e={filterActive:!1,filteredFields:[],influencersFilterQuery:void 0,maskAll:!1,queryString:"",tableQueryString:""};Object.assign(n,e)}else n.indexPattern=Object(Bm.a)(a);return n.loading=!0,n})(e,n);break;case Tm.c.SET_CHARTS_DATA_LOADING:i={...e,anomalyChartsDataLoading:!0,chartsData:Object(Jm.a)()};break;case Tm.c.SET_CHARTS:i={...e,chartsData:{...Object(Jm.a)(),chartsPerRow:n.chartsPerRow,seriesToPlot:n.seriesToPlot,tooManyBuckets:!!n.tooManyBuckets,errorMessages:n.errorMessages}};break;case Tm.c.SET_INFLUENCER_FILTER_SETTINGS:i=function(e,t){const{filterQuery:a,isAndOperator:n,filteredFields:i,queryString:s,tableQueryString:r}=t,{selectedCells:o,viewBySwimlaneOptions:l}=e;let c=e.viewBySwimlaneFieldName;const d=l.filter((e=>i.includes(e)));if(n&&void 0===o)c=Tm.j;else for(let e=0;e<i.length;e++)if(d.includes(i[e])&&(void 0===o||o&&"overall"===o.type)){c=i[e];break}return{...e,filterActive:!0,filteredFields:i,influencersFilterQuery:a,isAndOperator:n,queryString:s,tableQueryString:r,maskAll:c===Tm.j||!1===i.includes(c),viewBySwimlaneFieldName:c,viewBySwimlaneOptions:d,viewByFromPage:1}}(e,n);break;case Tm.c.SET_SELECTED_CELLS:const t=n;i={...e,selectedCells:t};break;case Tm.c.SET_EXPLORER_DATA:case Tm.c.SET_FILTER_DATA:i={...e,...n};break;case Tm.c.SET_SWIMLANE_CONTAINER_WIDTH:i={...e,swimlaneContainerWidth:n};break;case Tm.c.SET_VIEW_BY_SWIMLANE_FIELD_NAME:const{filteredFields:a,influencersFilterQuery:s}=e,r=n;let o=!1;void 0!==s&&(o=r===Tm.j||!1===a.includes(r)),i={...e,...Object(el.d)(),maskAll:o,viewBySwimlaneFieldName:r,viewBySwimlaneData:Object(el.f)(),viewByFromPage:1,viewBySwimlaneDataLoading:!0};break;case Tm.c.SET_VIEW_BY_SWIMLANE_LOADING:const{annotationsData:l,overallState:c,tableData:d}=n;i={...e,annotations:l,overallSwimlaneData:c,tableData:d,viewBySwimlaneData:{...Object(el.f)()},viewBySwimlaneDataLoading:!0};break;case Tm.c.SET_VIEW_BY_FROM_PAGE:i={...e,viewByFromPage:n};break;case Tm.c.SET_VIEW_BY_PER_PAGE:i={...e,viewByFromPage:1,viewByPerPage:n};break;case Tm.c.SET_SWIM_LANE_SEVERITY:i={...e,viewByFromPage:1,swimLaneSeverity:n};break;case Tm.c.SET_SHOW_CHARTS:i={...e,showCharts:n};break;default:i=e}if(null===i.selectedJobs)return i;const s=Object(el.l)(i.selectedJobs,i.swimlaneContainerWidth),{viewBySwimlaneFieldName:r,viewBySwimlaneOptions:o}=Object(el.m)({currentViewBySwimlaneFieldName:i.viewBySwimlaneFieldName,filterActive:i.filterActive,filteredFields:i.filteredFields,isAndOperator:i.isAndOperator,selectedJobs:i.selectedJobs,selectedCells:i.selectedCells}),{selectedCells:l}=i,c=function(e){if(void 0!==(null==e?void 0:e.times))return{earliestMs:1e3*e.times[0],latestMs:1e3*e.times[1]-1}}(l);return{...i,swimlaneBucketInterval:s,viewByLoadedForTimeFormatted:c?`${Object(Ud.b)(c.earliestMs)} - ${Object(Ud.b)(c.latestMs)}`:null,viewBySwimlaneFieldName:r,viewBySwimlaneOptions:o,...Vm(i),...qm(i)}}),Gm()),Object(we.shareReplay)(1)),Ym=Hm.pipe(Object(we.map)((e=>{const t={mlExplorerFilter:{},mlExplorerSwimlane:{}};if(void 0!==e.selectedCells){const a=e.selectedCells;t.mlExplorerSwimlane.selectedType=a.type,t.mlExplorerSwimlane.selectedLanes=a.lanes,t.mlExplorerSwimlane.selectedTimes=a.times,t.mlExplorerSwimlane.showTopFieldValues=a.showTopFieldValues}return void 0!==e.viewBySwimlaneFieldName&&(t.mlExplorerSwimlane.viewByFieldName=e.viewBySwimlaneFieldName),void 0!==e.viewByFromPage&&(t.mlExplorerSwimlane.viewByFromPage=e.viewByFromPage),void 0!==e.viewByPerPage&&(t.mlExplorerSwimlane.viewByPerPage=e.viewByPerPage),void 0!==e.swimLaneSeverity&&(t.mlExplorerSwimlane.severity=e.swimLaneSeverity),void 0!==e.showCharts&&(t.mlShowCharts=e.showCharts),e.filterActive&&(t.mlExplorerFilter.influencersFilterQuery=e.influencersFilterQuery,t.mlExplorerFilter.filterActive=e.filterActive,t.mlExplorerFilter.filteredFields=e.filteredFields,t.mlExplorerFilter.queryString=e.queryString),t})),Object(we.distinctUntilChanged)(x.isEqual)),$m={appState$:Ym,state$:Hm,clearExplorerData:()=>{Wm.next({type:Tm.c.CLEAR_EXPLORER_DATA})},clearInfluencerFilterSettings:()=>{Wm.next({type:Tm.c.CLEAR_INFLUENCER_FILTER_SETTINGS})},clearJobs:()=>{Wm.next({type:Tm.c.CLEAR_JOBS})},updateJobSelection:e=>{Wm.next(function(e){return Object(Ee.from)(ru.a.populateFormats(e)).pipe(Object(we.map)((t=>{if(t.error)return null;const a=Object(el.a)(te.a.jobs).map((t=>(t.selected=e.some((e=>t.id===e)),t))).filter((e=>e.selected));return{type:Tm.c.JOB_SELECTION_CHANGE,payload:{loading:!1,selectedJobs:a}}})))}(e))},setCharts:e=>{Wm.next({type:Tm.c.SET_CHARTS,payload:e})},setInfluencerFilterSettings:e=>{Wm.next({type:Tm.c.SET_INFLUENCER_FILTER_SETTINGS,payload:e})},setSelectedCells:e=>{Wm.next({type:Tm.c.SET_SELECTED_CELLS,payload:e})},setExplorerData:e=>{Wm.next((e=>({type:Tm.c.SET_EXPLORER_DATA,payload:e}))(e))},setFilterData:e=>{Wm.next((e=>({type:Tm.c.SET_FILTER_DATA,payload:e}))(e))},setChartsDataLoading:()=>{Wm.next({type:Tm.c.SET_CHARTS_DATA_LOADING})},setSwimlaneContainerWidth:e=>{Wm.next({type:Tm.c.SET_SWIMLANE_CONTAINER_WIDTH,payload:e})},setViewBySwimlaneFieldName:e=>{Wm.next({type:Tm.c.SET_VIEW_BY_SWIMLANE_FIELD_NAME,payload:e})},setViewBySwimlaneLoading:e=>{Wm.next({type:Tm.c.SET_VIEW_BY_SWIMLANE_LOADING,payload:e})},setViewByFromPage:e=>{Wm.next({type:Tm.c.SET_VIEW_BY_FROM_PAGE,payload:e})},setViewByPerPage:e=>{Wm.next({type:Tm.c.SET_VIEW_BY_PER_PAGE,payload:e})},setSwimLaneSeverity:e=>{Wm.next({type:Tm.c.SET_SWIM_LANE_SEVERITY,payload:e})},setShowCharts:e=>{Wm.next({type:Tm.c.SET_SHOW_CHARTS,payload:e})}},Xm=({showCharts:e,setShowCharts:t})=>{const a=Object(i.useCallback)((e=>{t(e.target.checked)}),[t]),n=Object(i.useMemo)((()=>Object(r.htmlIdGenerator)()()),[]);return Object(I.jsx)(r.EuiCheckbox,{id:n,label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.controls.checkboxShowCharts.showChartsCheckboxLabel",defaultMessage:"Show charts"}),checked:e,onChange:a})},Km=O.c.KUERY;function Qm({inputString:e,queryLanguage:t,indexPattern:a}){var n;let i={};const s=[],r=Object(v.d)(e),o=r&&"and"===r.function;r&&Array.isArray(r.arguments)&&r.arguments.forEach((e=>{void 0!==e.arguments?e.arguments.forEach((e=>{"string"==typeof e.value&&s.push(e.value)})):"string"==typeof e.value&&s.push(e.value)})),t===O.c.KUERY?i=Object(v.f)(Object(v.d)(e),a):t===O.c.LUCENE&&(i=Object(v.e)(e));return{clearSettings:Boolean((null===(n=i)||void 0===n?void 0:n.match_all)&&0===Object.keys(i.match_all).length),settings:{filterQuery:i,queryString:e,tableQueryString:e,isAndOperator:o,filteredFields:s}}}function Zm({filterActive:e,queryString:t}){return void 0!==t&&!0===e?{language:O.c.KUERY,query:t}:{query:"",language:Km}}const eb=({filterActive:e,filterPlaceHolder:t,indexPattern:a,queryString:n,updateLanguage:s})=>{const[l,c]=Object(i.useState)(Zm({filterActive:e,queryString:n})),[d,u]=Object(i.useState)(void 0);Object(i.useEffect)((function(){c(Zm({filterActive:e,queryString:n}))}),[e,n]);return Object(I.jsx)(r.EuiInputPopover,{style:{maxWidth:"100%"},closePopover:()=>u(void 0),input:Object(I.jsx)(y.QueryStringInput,{bubbleSubmitEvent:!1,query:l,indexPatterns:[a],onChange:e=>{l.language!==e.language&&s(e.language),c(e)},onSubmit:e=>{try{const{clearSettings:t,settings:n}=Qm({inputString:e.query,queryLanguage:e.language,indexPattern:a});!0===t?$m.clearInfluencerFilterSettings():$m.setInfluencerFilterSettings(n)}catch(t){console.log("Invalid query syntax in search bar",t),u({query:e.query,message:t.message})}},placeholder:t,disableAutoFocus:!0,dataTestSubj:"explorerQueryInput",languageSwitcherPopoverAnchorPosition:"rightDown"}),isOpen:(null==d?void 0:d.query)===l.query&&""!==(null==d?void 0:d.message)},Object(I.jsx)(r.EuiCode,null,o.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageQueryBar",{defaultMessage:"Invalid query"}),": ",null==d?void 0:d.message.split("\n")[0]))};var tb=a(210),ab=a.n(tb),nb=a(277),ib=a(109),sb=a(50);function rb(){const{services:{savedObjects:{client:e},dashboard:{locator:t}}}=Object(d.b)();return Object(i.useMemo)((()=>function(e,t){return{fetchDashboards:async t=>await e.find({type:"dashboard",perPage:1e3,search:t?`${t}*`:"",searchFields:["title^3","description"]}),getDashboardEditUrl:async e=>await t.getUrl({dashboardId:e,viewMode:sb.ViewMode.EDIT,useHash:!1})}}(e,t)),[e,t])}const ob=()=>{const{notifications:{toasts:e}}=Object(d.b)(),t=rb(),[a,n]=Object(i.useState)(!1);Object(i.useEffect)((()=>(l(),()=>{l.cancel()})),[]);const s=Object(i.useMemo)((()=>({onChange:({queryText:e})=>{n(!0),l(e)},box:{incremental:!0,"data-test-subj":"mlDashboardsSearchBox"}})),[]),[r,o]=Object(i.useState)([]),l=Object(i.useCallback)(Object(x.debounce)((async a=>{try{const e=(await t.fetchDashboards(a)).savedObjects.map((e=>({id:e.id,title:e.attributes.title,description:e.attributes.description,attributes:e.attributes})));o(e)}catch(t){e.danger({body:t})}n(!1)}),500),[]);return{dashboardItems:r,search:s,isLoading:a}},lb=({onClose:e,dashboardItems:t,isLoading:a,search:n,addToDashboardAndEditCallback:i,title:s,disabled:l,children:c})=>{const d=[{field:"title",name:o.i18n.translate("xpack.ml.explorer.dashboardsTable.titleColumnHeader",{defaultMessage:"Title"}),sortable:!0,truncateText:!0},{field:"description",name:o.i18n.translate("xpack.ml.explorer.dashboardsTable.descriptionColumnHeader",{defaultMessage:"Description"}),truncateText:!0},{field:"description",name:o.i18n.translate("xpack.ml.explorer.dashboardsTable.actionsHeader",{defaultMessage:"Actions"}),width:"80px",actions:[{name:o.i18n.translate("xpack.ml.explorer.dashboardsTable.editActionName",{defaultMessage:"Add to dashboard"}),description:o.i18n.translate("xpack.ml.explorer.dashboardsTable.editActionName",{defaultMessage:"Add to dashboard"}),icon:"documentEdit",type:"icon",enabled:()=>!l,onClick:async e=>{await i(e)},"data-test-subj":"mlEmbeddableAddAndEditDashboard"}]}];return Object(I.jsx)(r.EuiModal,{onClose:e.bind(null,void 0),"data-test-subj":"mlAddToDashboardModal"},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiModalHeaderTitle,null,s)),Object(I.jsx)(r.EuiModalBody,null,c,Object(I.jsx)(r.EuiFormRow,{fullWidth:!0,label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.selectDashboardsLabel",defaultMessage:"Select dashboards:"}),"data-test-subj":"mlDashboardSelectionContainer"},Object(I.jsx)(r.EuiInMemoryTable,{itemId:"id",isSelectable:!1,hasActions:!0,items:t,loading:a,columns:d,search:n,pagination:!0,sorting:!0,"data-test-subj":"mlDashboardSelectionTable"+(a?" loading":" loaded"),rowProps:e=>({"data-test-subj":`mlDashboardSelectionTableRow row-${e.id}`})}))),Object(I.jsx)(r.EuiModalFooter,null,Object(I.jsx)(r.EuiButtonEmpty,{onClick:e.bind(null,void 0)},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.cancelButtonLabel",defaultMessage:"Cancel"}))))};var cb=a(62);function db(e,t){const{services:{embeddable:a}}=Object(d.b)(),n=rb();return{addToDashboardAndEditCallback:Object(i.useCallback)((async i=>{const s=a.getStateTransfer(),r=i.id,o=await n.getDashboardEditUrl(r);await s.navigateToWithEmbeddablePackage(cb.DashboardConstants.DASHBOARDS_ID,{path:o,state:{type:e,input:t()}})}),[t])}}const ub=({onClose:e,jobIds:t,viewBy:a})=>{const{dashboardItems:n,isLoading:l,search:c}=ob(),[d,u]=Object(i.useState)(Tm.h.OVERALL),p=Object(i.useCallback)((()=>({...function(e){return{title:Object(nb.getDefaultSwimlanePanelTitle)(e),id:Object(r.htmlIdGenerator)()()}}(t),jobIds:t,swimlaneType:d,...d===Tm.h.VIEW_BY?{viewBy:a}:{}})),[d]),{addToDashboardAndEditCallback:m}=db(ib.b,p),b=[{id:Tm.h.OVERALL,label:o.i18n.translate("xpack.ml.explorer.overallLabel",{defaultMessage:"Overall"})},{id:Tm.h.VIEW_BY,label:o.i18n.translate("xpack.ml.explorer.viewByFieldLabel",{defaultMessage:"View by {viewByField}",values:{viewByField:a}})}],f=Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.swimlanes.selectSwimlanesLabel",defaultMessage:"Select swim lane view:"})},Object(I.jsx)(r.EuiRadioGroup,{options:b,idSelected:d,onChange:e=>{u(e)},"data-test-subj":"mlAddToDashboardSwimlaneTypeSelector"})),Object(I.jsx)(r.EuiSpacer,{size:"m"})),h=Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.swimlanes.dashboardsTitle",defaultMessage:"Add swim lane to a dashboard"});return Object(I.jsx)(lb,{onClose:e,dashboardItems:n,isLoading:l,search:c,addToDashboardAndEditCallback:m,disabled:!1,title:h},f)};var pb=a(31);const mb=()=>Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.anomalySwimLane.noOverallDataMessage",defaultMessage:"No anomalies found in the overall bucket results for this time range"});var bb=a(278);const fb=()=>{const[e,t]=Object(i.useState)(!1);return Object(I.jsx)(Kl,{anchorPosition:"upCenter",button:Object(I.jsx)(Xl,{onClick:()=>{t(!e)}}),closePopover:()=>t(!1),isOpen:e,title:o.i18n.translate("xpack.ml.explorer.anomalyTimelinePopoverTitle",{defaultMessage:"Anomaly timelines"})},Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverBasicExplanation",defaultMessage:"Swim lanes provide an overview of the buckets of data that have been analyzed within the selected time period. You can view an overall swim lane or view them by job or influencer."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverScoreExplanation",defaultMessage:"Each block in a swim lane is colored according to its anomaly score, which is a value from 0 to 100. The blocks with high scores are shown in red and low scores are indicated in blue."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverAdvancedExplanation",defaultMessage:"The anomaly scores that you see in each section of the Anomaly Explorer might differ slightly. This disparity occurs because for each job there are bucket results, overall bucket results, influencer results, and record results. Anomaly scores are generated for each type of result. The overall swim lane shows the maximum overall bucket score for each block. When you view a swim lane by job, it shows the maximum bucket score in each block. When you view by influencer, it shows the maximum influencer score in each block."})),Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelinePopoverSelectionExplanation",defaultMessage:"When you select one or more blocks in the swim lanes, the list of anomalies and top influencers is likewise filtered to provide information relative to that selection."})))};var hb=a(129),gb=a(367);const jb=s.a.memo((({explorerState:e,setSelectedCells:t})=>{var a,n,l;const{services:{uiSettings:c,application:{capabilities:u}}}=Object(d.b)(),[p,m]=Object(i.useState)(!1),[b,f]=Object(i.useState)(!1),h=null!==(a=null===(n=u.dashboard)||void 0===n?void 0:n.createNew)&&void 0!==a&&a,g=Object(i.useMemo)((()=>new Ts.a({"histogram:maxBars":c.get(pb.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":c.get(pb.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:c.get("dateFormat"),"dateFormat:scaled":c.get("dateFormat:scaled")})),[c]),{filterActive:j,selectedCells:x,viewByLoadedForTimeFormatted:v,viewBySwimlaneDataLoading:y,viewBySwimlaneFieldName:O,viewBySwimlaneOptions:E,selectedJobs:w,viewByFromPage:M,viewByPerPage:S,swimlaneLimit:_,loading:T,overallAnnotations:C,swimLaneSeverity:k,overallSwimlaneData:F,viewBySwimlaneData:D,swimlaneContainerWidth:A}=e,[L,R]=Object(i.useState)(k);ab()((()=>{L!==k&&$m.setSwimLaneSeverity(L)}),500,[L,k]);const N=Object(i.useMemo)((()=>C.annotationsData),[C]),P=Object(i.useMemo)((()=>{const e=[];return h&&e.push(Object(I.jsx)(r.EuiContextMenuItem,{key:"addToDashboard",onClick:f.bind(null,!0),"data-test-subj":"mlAnomalyTimelinePanelAddToDashboardButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.addToDashboardLabel",defaultMessage:"Add to dashboard"}))),e}),[h]),z=Object(i.useMemo)((()=>{if(x)return x.type===Tm.h.OVERALL?x:{type:Tm.h.OVERALL,lanes:[Tm.g],times:x.times}}),[x]),B=Object(i.useMemo)((()=>Cm.AnomalyTimelineService.isOverallSwimlaneData(F)?{min:1e3*F.earliest,max:1e3*F.latest,minInterval:1e3*F.interval}:void 0),[F]);return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiPanel,{paddingSize:"m",hasShadow:!1,hasBorder:!0},Object(I.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"xs",responsive:!1,alignItems:"baseline"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiTitle,{className:"panel-title"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.anomalyTimelineTitle",defaultMessage:"Anomaly timeline"})))),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(fb,null)),P.length>0&&Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},Object(I.jsx)(r.EuiPopover,{button:Object(I.jsx)(r.EuiButtonIcon,{size:"s","aria-label":o.i18n.translate("xpack.ml.explorer.swimlaneActions",{defaultMessage:"Actions"}),color:"text",iconType:"boxesHorizontal",onClick:m.bind(null,!p),"data-test-subj":"mlAnomalyTimelinePanelMenu"}),isOpen:p,closePopover:m.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(I.jsx)(r.EuiContextMenuPanel,{items:P})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"baseline"},E.length>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiSelect,{prepend:o.i18n.translate("xpack.ml.explorer.viewByLabel",{defaultMessage:"View by"}),compressed:!0,id:"selectViewBy",options:(J=E,J.map((e=>({value:e,text:e})))),value:O,onChange:e=>$m.setViewBySwimlaneFieldName(e.target.value)}))),Object(I.jsx)(r.EuiFlexItem,{grow:!0},Object(I.jsx)(bb.a,{value:null!=L?L:0,onChange:Object(i.useCallback)((e=>{R(e)}),[])}))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)("div",{className:"panel-sub-title"},v&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreForTimeFormattedLabel",defaultMessage:"(Sorted by max anomaly score for {viewByLoadedForTimeFormatted})",values:{viewByLoadedForTimeFormatted:v}}),Object(hb.a)(v)?null:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.sortedByMaxAnomalyScoreLabel",defaultMessage:"(Sorted by max anomaly score)"}),!0===j&&O===Tm.j&&Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.jobScoreAcrossAllInfluencersLabel",defaultMessage:"(Job score across all influencers)"}))),x?Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButtonEmpty,{size:"xs",onClick:t.bind(null,void 0),"data-test-subj":"mlAnomalyTimelineClearSelection"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.clearSelectionLabel",defaultMessage:"Clear selection"}))):null),Object(I.jsx)(r.EuiSpacer,{size:"m"}),B&&Array.isArray(N)&&N.length>0?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Up.a,null,(e=>Object(I.jsx)(gb.a,{chartWidth:A,domain:B,annotationsData:N,tooltipService:e}))),Object(I.jsx)(r.EuiSpacer,{size:"m"})):null,Object(I.jsx)(km.b,{id:"overall","data-test-subj":"mlAnomalyExplorerSwimlaneOverall",filterActive:j,timeBuckets:g,swimlaneData:F,swimlaneType:Tm.h.OVERALL,selection:z,onCellsSelection:t,onResize:$m.setSwimlaneContainerWidth,isLoading:T,noDataWarning:Object(I.jsx)(r.EuiEmptyPrompt,{titleSize:"xxs",style:{padding:0},title:Object(I.jsx)("h2",null,Object(I.jsx)(mb,null))}),showTimeline:!1,showLegend:!1}),Object(I.jsx)(r.EuiSpacer,{size:"m"}),E.length>0&&Object(I.jsx)(km.b,{id:"view_by","data-test-subj":"mlAnomalyExplorerSwimlaneViewBy",filterActive:j,timeBuckets:g,showLegend:!1,swimlaneData:D,swimlaneType:Tm.h.VIEW_BY,selection:x,onCellsSelection:t,onResize:$m.setSwimlaneContainerWidth,fromPage:M,perPage:S,swimlaneLimit:_,onPaginationChange:({perPage:e,fromPage:t})=>{e&&$m.setViewByPerPage(e),t&&$m.setViewByFromPage(t)},isLoading:T||y,noDataWarning:Object(I.jsx)(r.EuiEmptyPrompt,{titleSize:"xxs",style:{padding:0},title:Object(I.jsx)("h2",null,"string"==typeof O?O===Tm.j?Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.noResultForSelectedJobsMessage",defaultMessage:"No results found for selected {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:null!==(l=null==w?void 0:w.length)&&void 0!==l?l:1}}):Object(I.jsx)(pm,{viewBySwimlaneFieldName:O,showFilterMessage:!0===j}):null)})})),b&&w&&Object(I.jsx)(ub,{onClose:async e=>{f(!1),e&&await e()},jobIds:w.map((({id:e})=>e)),viewBy:O}));var J}),((e,t)=>Object(x.isEqual)(e.explorerState,t.explorerState)));var xb=a(387),vb=a(56),yb=a(406);function Ob(e,t){const a={};for(let n=0;n<e.length;n++){const i=e[n],s=i.entityValue;i.jobId===t&&(void 0===a[s]?a[s]={count:1,entityValue:s,max_severity:Math.floor(i.severity)}:(a[s].count+=1,i.severity>a[s].max_severity&&(a[s].max_severity=Math.floor(i.severity))))}return Object.values(a)}const Eb=({anomalies:e,jobIds:t})=>{const[a,n]=Object(i.useState)(),{services:{maps:l}}=Object(d.b)(),c=Object(i.useCallback)((async()=>{if(!l)return;const a=await Promise.all(t.map((async t=>{const a=new Set;let n;for(let i=0;i<e.length&&(t===e[i].jobId&&""!==e[i].entityValue&&void 0!==e[i].entityValue&&""!==e[i].entityName&&void 0!==e[i].entityName&&(a.add(e[i].entityValue),n||(n=e[i].entityName)),3!==a.size);i++);const i=await l.suggestEMSTermJoinConfig({sampleValues:Array.from(a),sampleValuesColumnName:n||""});return i?{jobId:t,...i}:i})));n(a.filter(hb.a))}),[...t]);Object(i.useEffect)((function(){e&&e.length>0&&c()}),[...t]);const u=Object(i.useMemo)((()=>null!=a&&a.length?a.map((t=>((e,{layerId:t,field:a,jobId:n})=>({id:Object(r.htmlIdGenerator)()(),label:o.i18n.translate("xpack.ml.explorer.anomaliesMap.anomaliesCount",{defaultMessage:"Anomalies count: {jobId}",values:{jobId:n}}),joins:[{leftField:a,right:{id:"anomaly_count",type:vb.SOURCE_TYPES.TABLE_SOURCE,__rows:Ob(e,n),__columns:[{name:"entityValue",type:"string"},{name:"count",type:"number"},{name:"max_severity",type:"number"}],term:"entityValue"}}],sourceDescriptor:{type:"EMS_FILE",id:t},style:{type:"VECTOR",properties:{icon:{type:vb.STYLE_TYPE.STATIC,options:{value:"marker"}},fillColor:{type:vb.STYLE_TYPE.DYNAMIC,options:{color:"Blue to Red",colorCategory:"palette_0",fieldMetaOptions:{isEnabled:!0,sigma:3},type:vb.COLOR_MAP_TYPE.ORDINAL,field:{name:"count",origin:vb.FIELD_ORIGIN.JOIN},useCustomColorRamp:!1}},lineColor:{type:vb.STYLE_TYPE.DYNAMIC,options:{fieldMetaOptions:{isEnabled:!0}}},lineWidth:{type:vb.STYLE_TYPE.STATIC,options:{size:1}}},isTimeAware:!0},visible:!1,type:vb.LAYER_TYPE.GEOJSON_VECTOR}))(e,t)),[]):[]),[a,e]),p=u.filter((e=>{var t,a;return(Array.isArray(e.joins)?null===(t=e.joins[0])||void 0===t||null===(a=t.right)||void 0===a?void 0:a.__rows:[]).length}));return p.length>0&&(p[0].visible=!0),0===(null==a?void 0:a.length)||0===p.length?null:Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiPanel,{"data-test-subj":"mlAnomaliesMapContainer",hasShadow:!1,hasBorder:!0},Object(I.jsx)(r.EuiAccordion,{id:"mlAnomalyExplorerAnomaliesMapAccordionId",initialIsOpen:!0,buttonContent:Object(I.jsx)(r.EuiTitle,{className:"panel-title"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.mapTitle",defaultMessage:"Anomaly count by location {infoTooltip}",values:{infoTooltip:Object(I.jsx)(r.EuiIconTip,{content:"Map colors indicate the number of anomalies in each area.",position:"top",type:"iInCircle"})}})))},Object(I.jsx)("div",{"data-test-subj":"mlAnomalyExplorerAnomaliesMap",style:{width:"100%",height:300}},Object(I.jsx)(yb.a,{layerList:u})))),Object(I.jsx)(r.EuiSpacer,{size:"m"}))};var wb=a(279),Mb=a(372);const Sb=({onClose:e,jobIds:t,selectedCells:a,bounds:n,interval:s})=>{const[o]=Object(bp.d)(),[l,c]=Object(i.useState)(Fm.b),d=Object(i.useCallback)((()=>{var e;let i;if(void 0!==a&&void 0!==s&&void 0!==n){const{earliestMs:e,latestMs:t}=Object(el.k)(a,s,n);i={from:Object(r.formatDate)(e,"MMM D, YYYY @ HH:mm:ss.SSS"),to:Object(r.formatDate)(t,"MMM D, YYYY @ HH:mm:ss.SSS"),mode:"absolute"}}return{...function(e){return{id:Object(r.htmlIdGenerator)()(),title:Object(wb.getDefaultExplorerChartsPanelTitle)(e)}}(t),jobIds:t,maxSeriesToPlot:null!=l?l:Fm.b,severityThreshold:o.val,...null!==(e=i)&&void 0!==e?e:{}}}),[a,s,n,t,l,o]),{dashboardItems:u,isLoading:p,search:m}=ob(),{addToDashboardAndEditCallback:b}=db(ib.a,d),f=Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.anomalyCharts.dashboardsTitle",defaultMessage:"Add anomaly charts to dashboards"}),h=Object(I.jsx)(r.EuiFormRow,{label:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.addToDashboard.anomalyCharts.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},Object(I.jsx)(r.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:l,onChange:e=>c(parseInt(e.target.value,10)),min:0,max:Mb.b}));return Object(I.jsx)(lb,{onClose:e,dashboardItems:u,isLoading:p,search:m,addToDashboardAndEditCallback:b,disabled:!1,title:f},h)},_b=({selectedJobs:e,selectedCells:t,bounds:a,interval:n,chartsCount:l})=>{var c,u;const{services:{application:{capabilities:p}}}=Object(d.b)(),[m,b]=Object(i.useState)(!1),[f,h]=Object(i.useState)(!1),g=null!==(c=null===(u=p.dashboard)||void 0===u?void 0:u.createNew)&&void 0!==c&&c,j=Object(i.useMemo)((()=>{const e=[];return g&&e.push(Object(I.jsx)(r.EuiContextMenuItem,{key:"addToDashboard",onClick:h.bind(null,!0),"data-test-subj":"mlAnomalyAddChartsToDashboardButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.anomalies.addToDashboardLabel",defaultMessage:"Add anomaly charts to dashboard"}))),e}),[g]),x=e.map((({id:e})=>e));return Object(I.jsx)(s.a.Fragment,null,j.length>0&&l>0&&Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},Object(I.jsx)(r.EuiPopover,{button:Object(I.jsx)(r.EuiButtonIcon,{size:"s","aria-label":o.i18n.translate("xpack.ml.explorer.anomalies.actionsAriaLabel",{defaultMessage:"Actions"}),color:"text",iconType:"boxesHorizontal",onClick:b.bind(null,!m),"data-test-subj":"mlExplorerAnomalyPanelMenu",disabled:l<1}),isOpen:m,closePopover:b.bind(null,!1),panelPaddingSize:"none",anchorPosition:"downLeft"},Object(I.jsx)(r.EuiContextMenuPanel,{items:j}))),f&&e?Object(I.jsx)(Sb,{onClose:async()=>{h(!1)},selectedCells:t,bounds:a,interval:n,jobIds:x}):null)},Tb=({children:e,jobSelectorProps:t,noInfluencersConfigured:a,influencers:n,filterActive:i,filterPlaceHolder:o,indexPattern:l,queryString:c,updateLanguage:d})=>Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Q.a,null,Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(hp,{viewId:"explorer"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.pageTitle",defaultMessage:"Anomaly Explorer"})))),Object(I.jsx)(r.EuiPageHeader,null,Object(I.jsx)(r.EuiPageHeaderSection,{style:{width:"100%"}},Object(I.jsx)(gp.a,t),!1===a&&void 0!==n?Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(eb,{filterActive:i,filterPlaceHolder:o,indexPattern:l,queryString:c,updateLanguage:d}),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiHorizontalRule,{margin:"none"})):null)),e);class explorer_ExplorerUI extends s.a.Component{constructor(...e){super(...e),Se()(this,"state",{language:Km}),Se()(this,"htmlIdGen",Object(r.htmlIdGenerator)()),Se()(this,"applyFilter",((e,t,a)=>{const{filterActive:n,indexPattern:i,queryString:s}=this.props.explorerState;let r="";const l=Object(el.c)(e),c=Object(el.b)(t);if(a===Tm.d.ADD){const a=Object(el.h)(e,t);if(null!==s.match(a))return;r=`${s?`${s} and `:""}${l}:"${c}"`}else if(a===Tm.d.REMOVE){if(!1===n)return;r=Object(el.s)(s,l,c)}try{const{clearSettings:e,settings:t}=Qm({inputString:`${r}`,queryLanguage:this.state.language,indexPattern:i});!0===e?$m.clearInfluencerFilterSettings():$m.setInfluencerFilterSettings(t)}catch(e){console.log("Invalid query syntax from table",e);Object(Ye.l)().addDanger(o.i18n.translate("xpack.ml.explorer.invalidKuerySyntaxErrorMessageFromTable",{defaultMessage:"Invalid syntax in query bar. The input must be valid Kibana Query Language (KQL)"}))}})),Se()(this,"updateLanguage",(e=>this.setState({language:e})))}componentDidMount(){const{invalidTimeRangeError:e}=this.props;if(e){Object(Ye.l)().addWarning(o.i18n.translate("xpack.ml.explorer.invalidTimeRangeInUrlCallout",{defaultMessage:"The time filter was changed to the full range due to an invalid default time filter. Check the advanced settings for {field}.",values:{field:Rp.a}}))}}render(){var e,t;const{share:a,charts:n}=this.props.kibana.services,i=a.url.locators.get(p.a),{showCharts:l,severity:c,stoppedPartitions:d,selectedJobsRunning:u,timefilter:m,timeBuckets:b}=this.props,{annotations:f,chartsData:g,filterActive:j,filterPlaceHolder:x,indexPattern:v,influencers:y,loading:O,noInfluencersConfigured:E,overallSwimlaneData:w,queryString:M,selectedCells:S,selectedJobs:_,tableData:T,swimLaneSeverity:C}=this.props.explorerState,{annotationsData:k,totalCount:F,error:D}=f,A=Array.isArray(k)?k.length:0,L=F>A?Object(I.jsx)(r.EuiBadge,{color:"hollow"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.annotationsOutOfTotalCountTitle",defaultMessage:"First {visibleCount} out of a total of {totalCount}",values:{visibleCount:A,totalCount:F}})):Object(I.jsx)(r.EuiBadge,{color:"hollow"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitleTotalCount",defaultMessage:"Total: {count}",values:{count:A}})),R={dateFormatTz:Object(el.e)()},N=null===_||0===_.length,P=w.points&&w.points.length>0,z=P&&w.points.some((e=>e.value>0))||(null===(e=T.anomalies)||void 0===e?void 0:e.length)>0,B=Object(hb.a)(C);if(N&&!O)return Object(I.jsx)(Tb,{jobSelectorProps:R},Object(I.jsx)(mm,null));if(!z&&!O&&!B)return Object(I.jsx)(Tb,{jobSelectorProps:R},Object(I.jsx)(bm,{hasResults:P,selectedJobsRunning:u}));const J=`column ${!0===E?"col-xs-12":"col-xs-10"}`,V=m.getActiveBounds(),U=Array.isArray(_)?_.map((e=>e.id)):[];return Object(I.jsx)(Tb,{jobSelectorProps:R,noInfluencersConfigured:E,influencers:y,filterActive:j,filterPlaceHolder:x,indexPattern:v,queryString:M,updateLanguage:this.updateLanguage},Object(I.jsx)("div",{className:"results-container"},E&&Object(I.jsx)("div",{className:"no-influencers-warning"},Object(I.jsx)(r.EuiIconTip,{content:o.i18n.translate("xpack.ml.explorer.noConfiguredInfluencersTooltip",{defaultMessage:"The Top Influencers list is hidden because no influencers have been configured for the selected jobs."}),position:"right",type:"iInCircle"})),!1===E&&Object(I.jsx)("div",{className:"column col-xs-2","data-test-subj":"mlAnomalyExplorerInfluencerList"},Object(I.jsx)(r.EuiSpacer,{size:"s"}),Object(I.jsx)(r.EuiTitle,{className:"panel-title"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.topInfuencersTitle",defaultMessage:"Top influencers"}),Object(I.jsx)(r.EuiIconTip,{content:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.topInfluencersTooltip",defaultMessage:"View the relative impact of the top influencers in the selected time period and add them as filters on the results. Each influencer has a maximum anomaly score between 0-100 and a total anomaly score for that period."}),position:"right"}))),O?Object(I.jsx)(r.EuiLoadingContent,{lines:10}):Object(I.jsx)(_m,{influencers:y,influencerFilter:this.applyFilter})),Object(I.jsx)("div",{className:J},Object(I.jsx)(r.EuiSpacer,{size:"m"}),d&&Object(I.jsx)(r.EuiCallOut,{size:"s",title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.stoppedPartitionsExistCallout",defaultMessage:"There may be fewer results than there could have been because stop_on_warn is turned on. Both categorization and subsequent anomaly detection have stopped for some partitions in {jobsWithStoppedPartitions, plural, one {job} other {jobs}} [{stoppedPartitions}] where the categorization status has changed to warn.",values:{jobsWithStoppedPartitions:d.length,stoppedPartitions:d.join(", ")}})}),Object(I.jsx)(jb,{explorerState:this.props.explorerState,setSelectedCells:this.props.setSelectedCells}),Object(I.jsx)(r.EuiSpacer,{size:"m"}),void 0!==D&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotationsPanel error"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.annotationsErrorTitle",defaultMessage:"Annotations"}))),Object(I.jsx)(r.EuiPanel,null,Object(I.jsx)(r.EuiCallOut,{title:o.i18n.translate("xpack.ml.explorer.annotationsErrorCallOutTitle",{defaultMessage:"An error occurred loading annotations:"}),color:"danger",iconType:"alert"},Object(I.jsx)("p",null,D))),Object(I.jsx)(r.EuiSpacer,{size:"m"})),!1===O&&null!==(t=T.anomalies)&&void 0!==t&&t.length?Object(I.jsx)(Eb,{anomalies:T.anomalies,jobIds:U}):null,A>0&&Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiPanel,{"data-test-subj":"mlAnomalyExplorerAnnotationsPanel loaded",hasBorder:!0,hasShadow:!1},Object(I.jsx)(r.EuiAccordion,{id:this.htmlIdGen(),buttonContent:Object(I.jsx)(r.EuiTitle,{className:"panel-title","data-test-subj":"mlAnomalyExplorerAnnotationsPanelButton"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.annotationsTitle",defaultMessage:"Annotations {badge}",values:{badge:L}})))},Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(Vd.a,{jobIds:U,annotations:k,drillDown:!0,numberBadge:!1})))),Object(I.jsx)(Jd.a,null),Object(I.jsx)(r.EuiSpacer,{size:"m"})),!1===O&&Object(I.jsx)(r.EuiPanel,{hasBorder:!0,hasShadow:!1},Object(I.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"m",responsive:!1,alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiTitle,{className:"panel-title"},Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.anomaliesTitle",defaultMessage:"Anomalies"})))),Object(I.jsx)(r.EuiFlexItem,{grow:!1,style:{marginLeft:"auto",alignSelf:"baseline"}},Object(I.jsx)(_b,{selectedJobs:_,selectedCells:S,bounds:V,interval:this.props.explorerState.swimlaneBucketInterval?this.props.explorerState.swimlaneBucketInterval.asSeconds():void 0,chartsCount:g.seriesToPlot.length}))),Object(I.jsx)(r.EuiFlexGroup,{direction:"row",gutterSize:"l",responsive:!0,alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(bp.a,null)),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(pp,null)),g.seriesToPlot.length>0&&void 0!==S&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Xm,{showCharts:l,setShowCharts:$m.setShowCharts}))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)("div",{className:"euiText explorer-charts"},l?Object(I.jsx)(xb.a,h()({},g,{severity:c,timefilter:m,mlLocator:i,timeBuckets:b,onSelectEntity:this.applyFilter,chartsService:n})):null),Object(I.jsx)(Pu,{bounds:V,tableData:T,influencerFilter:this.applyFilter})))))}}const Cb=Object(Si.withKibana)(explorer_ExplorerUI);var kb=a(1);var Fb=a(373),Ib=a(283);const Db=(e,t)=>({id:"explorer",path:"/explorer",title:o.i18n.translate("xpack.ml.anomalyDetection.anomalyExplorer.docTitle",{defaultMessage:"Anomaly Explorer"}),render:(e,t)=>Object(I.jsx)(Ab,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("ANOMALY_DETECTION_BREADCRUMB",e,t),{text:o.i18n.translate("xpack.ml.anomalyDetection.anomalyExplorerLabel",{defaultMessage:"Anomaly Explorer"})}],enableDatePicker:!0,"data-test-subj":"mlPageAnomalyExplorer"}),Ab=({deps:e})=>{const{context:t,results:a}=S(void 0,void 0,e.config,e.dataViewsContract,{...U(e),jobs:te.a.loadJobsWrapper,jobsWithTimeRange:()=>be.ml.jobs.jobsWithTimerange(Object(el.e)())}),n=Object(i.useMemo)((()=>new q.a),[]);return Object(I.jsx)(g.b,{context:t},Object(I.jsx)(W.a.Provider,{value:n},Object(I.jsx)(Lb,{jobsWithTimeRange:a.jobsWithTimeRange.jobs})))},Lb=({jobsWithTimeRange:e})=>{var t,a,n,s,l;const[u,m]=function(){const[e]=Object(c.b)("mlExplorerSwimlane");return Object(c.b)(p.b.ANOMALY_EXPLORER,{mlExplorerSwimlane:e,mlExplorerFilter:{}})}(),[b]=Object(c.c)("_g"),[f,h]=Object(i.useState)(),[g,j]=Object(i.useState)(!1),v=Object(Fb.a)(),y=Object(d.g)({timeRangeSelector:!0,autoRefreshSelector:!0}),{jobIds:O}=(e=>{var t,a;const[n,s]=Object(c.c)("_g"),{toasts:r}=Object(d.f)(),l=jm(),u=Object(i.useMemo)((()=>{var e;const t=(null==n||null===(e=n.ml)||void 0===e?void 0:e.jobIds)||[];return("string"==typeof t?[t]:t).map((e=>String(e)))}),[null==n||null===(t=n.ml)||void 0===t?void 0:t.jobIds]),p=Object(i.useMemo)((()=>function(e,t){return t.filter((t=>!1===e.some((e=>e.job_id===t))&&"*"!==t))}(e,u)),[u]),m=Object(i.useMemo)((()=>{const e=Object(x.difference)(u,p);return e.sort(),e}),[u,p]),b=Object(i.useMemo)((()=>{var e,t;const a=null!==(e=null==n||null===(t=n.ml)||void 0===t?void 0:t.groups)&&void 0!==e?e:[];return{jobIds:m,selectedGroups:a}}),[m,null==n||null===(a=n.ml)||void 0===a?void 0:a.groups]);return Object(i.useEffect)((()=>{p.length>0&&r.addWarning(o.i18n.translate("xpack.ml.jobSelect.requestedJobsDoesNotExistWarningMessage",{defaultMessage:"Requested\n{invalidIdsLength, plural, one {job {invalidIds} does not exist} other {jobs {invalidIds} do not exist}}",values:{invalidIdsLength:p.length,invalidIds:p.join()}}))}),[p]),Object(i.useEffect)((()=>{0===m.length&&e.length>0&&l({singleSelection:!1}).then((({jobIds:e,time:t})=>{const a=(null==n?void 0:n.ml)||{};a.jobIds=e,s({ml:a,...void 0!==t?{time:t}:{}})})).catch((()=>{}))}),[e,m,s,null==n?void 0:n.ml]),b})(e),E=e.some((e=>O.includes(e.id)&&!0===e.isRunning)),w=z()($m.appState$),M=z()($m.state$),S=Object(xm.a)(),_=null!==(t=null==S?void 0:S.lastRefresh)&&void 0!==t?t:0;Object(i.useEffect)((()=>{void 0!==(null==b?void 0:b.time)&&"invalid"===b.time.mode&&j(!0)}),[null==b||null===(a=b.time)||void 0===a?void 0:a.from,null==b||null===(n=b.time)||void 0===n?void 0:n.to,null==b||null===(s=b.time)||void 0===s?void 0:s.ts]);const T=Object(i.useCallback)((async e=>{try{const t=await be.ml.results.getCategoryStoppedPartitions(e,kb.d);t&&Array.isArray(t.jobs)&&t.jobs.length>0?h(t.jobs):h(void 0)}catch(e){console.error(e)}}),[]);Object(i.useEffect)((()=>{O.length>0?($m.updateJobSelection(O),T(O)):$m.clearJobs()}),[JSON.stringify(O)]),Object(i.useEffect)((()=>()=>{$m.clearExplorerData()}),[]),Object(i.useEffect)((()=>{var e;const t=null==u?void 0:u.mlExplorerFilter;void 0!==t&&$m.setFilterData(t);const{viewByFieldName:a,viewByFromPage:n,viewByPerPage:i,severity:s}=null!==(e=null==u?void 0:u.mlExplorerSwimlane)&&void 0!==e?e:{};void 0!==a&&$m.setViewBySwimlaneFieldName(a),void 0!==i&&$m.setViewByPerPage(i),void 0!==n&&$m.setViewByFromPage(n),void 0!==s&&$m.setSwimLaneSeverity(s),void 0!==u.mlShowCharts&&$m.setShowCharts(u.mlShowCharts)}),[]),Object(i.useEffect)((()=>{var e,t;const a=void 0===(null==u||null===(e=u.mlExplorerSwimlane)||void 0===e?void 0:e.viewByFieldName);void 0!==(null==w||null===(t=w.mlExplorerSwimlane)||void 0===t?void 0:t.viewByFieldName)&&m(w,a)}),[w]);const[C,k]=zm();Object(i.useEffect)((()=>{void 0!==C&&Object.keys(C).length>0&&$m.setExplorerData(C)}),[C]);const[F]=up(),[D]=Object(bp.d)(),[A,L]=((e,t,a)=>{var n,s;const r=Object(d.g)().getBounds(),o=Object(i.useMemo)((()=>{var t,n,i;if(null==e||null===(t=e.mlExplorerSwimlane)||void 0===t||!t.selectedType)return;let s=null!==(n=e.mlExplorerSwimlane.selectedTimes)&&void 0!==n?n:e.mlExplorerSwimlane.selectedTime;"number"==typeof s&&(s=[s,s+a]);let r=null!==(i=e.mlExplorerSwimlane.selectedLanes)&&void 0!==i?i:e.mlExplorerSwimlane.selectedLane;return"string"==typeof r&&(r=[r]),{type:e.mlExplorerSwimlane.selectedType,lanes:r,times:s,showTopFieldValues:e.mlExplorerSwimlane.showTopFieldValues,viewByFieldName:e.mlExplorerSwimlane.viewByFieldName}}),[JSON.stringify(null==e?void 0:e.mlExplorerSwimlane),a]),l=Object(i.useCallback)((a=>{const n={...e.mlExplorerSwimlane};if(void 0!==a){a.showTopFieldValues=!1;const e=null==o?void 0:o.type,i=null==o?void 0:o.showTopFieldValues,s=null==a?void 0:a.type;(e===Tm.h.OVERALL&&s===Tm.h.VIEW_BY||s===Tm.h.OVERALL||!0===i)&&(a.showTopFieldValues=!0),n.selectedType=a.type,n.selectedLanes=a.lanes,n.selectedTimes=a.times,n.showTopFieldValues=a.showTopFieldValues,t({mlExplorerSwimlane:n})}else delete n.selectedType,delete n.selectedLanes,delete n.selectedTimes,delete n.showTopFieldValues,t({mlExplorerSwimlane:n})}),[null==e?void 0:e.mlExplorerSwimlane,o,t]);return Object(i.useEffect)((function(){if(void 0===(null==o?void 0:o.times)||void 0===a)return;const[e,t]=o.times,n=r.min.unix()-a,i=r.max.unix()+a,s=Math.max(e,n),c=Math.min(t,i);n>c||i<s?l():e===s&&t===c||s===n&&c===i||l({...o,times:[s,c]})}),[null===(n=r.min)||void 0===n?void 0:n.unix(),null===(s=r.max)||void 0===s?void 0:s.unix(),o,a]),[o,l]})(u,m,null==M||null===(l=M.swimlaneBucketInterval)||void 0===l?void 0:l.asSeconds());Object(i.useEffect)((()=>{$m.setSelectedCells(A)}),[JSON.stringify(A)]);const R=void 0!==M?{lastRefresh:_,influencersFilterQuery:M.influencersFilterQuery,noInfluencersConfigured:M.noInfluencersConfigured,selectedCells:A,selectedJobs:M.selectedJobs,swimlaneBucketInterval:M.swimlaneBucketInterval,tableInterval:F.val,tableSeverity:D.val,viewBySwimlaneFieldName:M.viewBySwimlaneFieldName,swimlaneContainerWidth:M.swimlaneContainerWidth,viewByPerPage:M.viewByPerPage,viewByFromPage:M.viewByFromPage,swimLaneSeverity:M.swimLaneSeverity}:void 0;return Object(i.useEffect)((()=>{const e=!Object(km.c)(null==M?void 0:M.viewBySwimlaneData)||null!=A&&A.showTopFieldValues||null==M?void 0:M.viewBySwimlaneData.cardinality;M&&M.swimlaneContainerWidth>0&&k({...R,swimlaneLimit:e})}),[JSON.stringify(R),null==A?void 0:A.showTopFieldValues]),void 0===M||void 0===S||void 0===(null==w?void 0:w.mlShowCharts)?null:Object(I.jsx)("div",{className:"ml-explorer"},Object(I.jsx)(Q.a,null,Object(I.jsx)(r.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(hp,{viewId:"explorer"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.explorer.pageTitle",defaultMessage:"Anomaly Explorer"})))),0===e.length?Object(I.jsx)(Ib.a,null):Object(I.jsx)(Cb,{explorerState:M,setSelectedCells:L,showCharts:M.showCharts,severity:D.val,stoppedPartitions:f,invalidTimeRangeError:g,selectedJobsRunning:E,timeBuckets:v,timefilter:y}))},Rb=()=>{const{services:{docLinks:e}}=Object(d.b)(),t=e.links.ml.guide;return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"xxl"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceAround"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiPageContent,{verticalPosition:"center",horizontalPosition:"center",color:"danger"},Object(I.jsx)(r.EuiEmptyPrompt,{iconType:"alert",title:Object(I.jsx)("h2",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.management.jobsList.accessDeniedTitle",defaultMessage:"Access denied"})),body:Object(I.jsx)("p",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.accessDenied.description",defaultMessage:"You don’t have permission to view the Machine Learning plugin. Access to the plugin requires the Machine Learning feature to be visible in this space."}))})))),Object(I.jsx)(ur.a,{docLink:t}))},Nb=[{text:o.i18n.translate("xpack.ml.accessDeniedLabel",{defaultMessage:"Access denied"})}],Pb=()=>({path:"/access-denied",title:o.i18n.translate("xpack.ml.accessDeniedLabel",{defaultMessage:"Access denied"}),render:(e,t)=>Object(I.jsx)(zb,h()({},e,{deps:t})),breadcrumbs:Nb}),zb=({deps:e})=>{const{context:t}=S(void 0,void 0,e.config,e.dataViewsContract,{});return Object(I.jsx)(g.b,{context:t},Object(I.jsx)(Rb,null))};var Bb=a(164);const Jb=({models:e,onClose:t})=>{const a=e.filter((e=>!!e.pipelines)).map((e=>e.model_id));return Object(I.jsx)(r.EuiModal,{onClose:t.bind(null,!1),initialFocus:"[name=cancelModelDeletion]","data-test-subj":"mlModelsDeleteModal"},Object(I.jsx)(r.EuiModalHeader,null,Object(I.jsx)(r.EuiModalHeaderTitle,null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.header",defaultMessage:"Delete {modelsCount, plural, one {{modelId}} other {# models}}?",values:{modelId:e[0].model_id,modelsCount:e.length}}))),Object(I.jsx)(r.EuiModalBody,null,a.length>0&&Object(I.jsx)(r.EuiCallOut,{"data-test-subj":"modelsWithPipelinesWarning",color:"danger",iconType:"alert",size:"s"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.modelsWithPipelinesWarningMessage",defaultMessage:"{modelsWithPipelinesCount, plural, one{Model} other {Models}} {modelsWithPipelines} {modelsWithPipelinesCount, plural, one{has} other {have}} associated pipelines!",values:{modelsWithPipelinesCount:a.length,modelsWithPipelines:a.join(", ")}}))),Object(I.jsx)(r.EuiModalFooter,null,Object(I.jsx)(r.EuiButtonEmpty,{onClick:t.bind(null,!1),name:"cancelModelDeletion"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(I.jsx)(r.EuiButton,{onClick:t.bind(null,!0),fill:!0,color:"danger","data-test-subj":"mlModelsDeleteModalConfirmButton"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModal.deleteButtonLabel",defaultMessage:"Delete"}))))};var Vb=a(390),Ub=a(233),Gb=a(161),qb=a(53);const Wb="started",Hb="starting",Yb="stopping",$b=({model:e,onConfirm:t,onCancel:a})=>Object(I.jsx)(r.EuiConfirmModal,{title:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.forceStopDialog.title",defaultMessage:"Stop model {modelId}?",values:{modelId:e.model_id}}),onCancel:a,onConfirm:t,cancelButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.forceStopDialog.cancelText",defaultMessage:"Cancel"}),confirmButtonText:Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.forceStopDialog.confirmText",defaultMessage:"Stop"}),buttonColor:"danger"},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.forceStopDialog.pipelinesWarning",defaultMessage:"You can't use these ingest pipelines until you restart the model:"}),Object(I.jsx)("ul",null,Object.keys(e.pipelines).sort().map((e=>Object(I.jsx)("li",{key:e},e))))),Xb=o.i18n.translate("xpack.ml.trainedModels.modelsList.builtInModelLabel",{defaultMessage:"built-in"}),Kb=()=>{var e;const{services:{application:{navigateToUrl:t,capabilities:a},overlays:n,theme:l}}=Object(d.b)(),u=Object(d.d)();Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!0});const m=Object(Gb.a)(qb.FIELD_FORMAT_IDS.DATE),[b,f]=Object(c.b)(p.b.TRAINED_MODELS_MANAGE,{pageIndex:0,pageSize:10,sortField:Qb.id,sortDirection:"asc"}),h=Object(xm.a)(),g=null!==(e=b.queryText)&&void 0!==e?e:"",j=a.ml.canDeleteDataFrameAnalytics,x=Object(ml.a)(),{displayErrorToast:v,displayDangerToast:y,displaySuccessToast:O}=Object(St.c)(),[E,w]=Object(i.useState)(!1),[M,S]=Object(i.useState)([]),[_,T]=Object(i.useState)([]),[C,k]=Object(i.useState)([]),[F,D]=Object(i.useState)({}),A=Object(i.useMemo)((()=>((e,t)=>async a=>new Promise((async(n,i)=>{try{const i=e.openModal(Object(Si.toMountPoint)(Object(Si.wrapWithTheme)(Object(I.jsx)($b,{model:a,onCancel:()=>{i.close(),n(!1)},onConfirm:()=>{i.close(),n(!0)}}),t.theme$)))}catch(e){n(!1)}})))(n,l)),[]),L=Object(d.e)(),R=Object(i.useCallback)((e=>e.tags.includes(sl.b)),[]),N=Object(i.useCallback)((async()=>{try{const e=await x.getTrainedModels(void 0,{with_pipelines:!0,size:1e3}),t=[],a=[];for(const n of e){const e={...n,..."object"==typeof n.inference_config?{type:[n.model_type,...Object.keys(n.inference_config),...R(n)?[Xb]:[]]}:{}};t.push(e),F[n.model_id]&&a.push(e)}await z(t.filter((e=>e.model_type.includes("pytorch")))),S(t),a.length>0&&(await z(a),D(a.reduce(((e,t)=>(e[t.model_id]=Object(I.jsx)(Vb.a,{item:t}),e)),{})))}catch(e){v(e,o.i18n.translate("xpack.ml.trainedModels.modelsList.fetchFailedErrorMessage",{defaultMessage:"Models fetch failed"}))}w(!1)}),[F]);Object(i.useEffect)((function(){h&&N()}),[h]);const P=Object(i.useMemo)((()=>({total:{show:!0,value:M.length,label:o.i18n.translate("xpack.ml.trainedModels.modelsList.totalAmountLabel",{defaultMessage:"Total trained models"})}})),[M]),z=Object(i.useCallback)((async e=>{try{if(e){const{trained_model_stats:a}=await x.getTrainedModelStats(e.map((e=>e.model_id)));for(const{model_id:n,...i}of a){const a=e.find((e=>e.model_id===n));var t;if(a)a.stats={...null!==(t=a.stats)&&void 0!==t?t:{},...i}}}return!0}catch(e){v(e,o.i18n.translate("xpack.ml.trainedModels.modelsList.fetchModelStatsErrorMessage",{defaultMessage:"Fetch model stats failed"}))}}),[]),B=Object(i.useMemo)((()=>[...M.reduce(((e,t)=>{const a=t.inference_config&&Object.keys(t.inference_config)[0];return a&&e.add(a),e.add(t.model_type),e}),new Set)].map((e=>({value:e,name:e})))),[M]);async function J(e){await z(e)?k(e):y(o.i18n.translate("xpack.ml.trainedModels.modelsList.unableToDeleteModelsErrorMessage",{defaultMessage:"Unable to delete models"}))}const V=[{name:o.i18n.translate("xpack.ml.trainedModels.modelsList.viewTrainingDataActionLabel",{defaultMessage:"View training data"}),description:o.i18n.translate("xpack.ml.trainedModels.modelsList.viewTrainingDataActionLabel",{defaultMessage:"View training data"}),icon:"visTable",type:"icon",available:e=>{var t,a;return!(null===(t=e.metadata)||void 0===t||null===(a=t.analytics_config)||void 0===a||!a.id)},onClick:async e=>{var a,n,i,s;if(void 0===(null===(a=e.metadata)||void 0===a?void 0:a.analytics_config))return;const r=Object(No.h)(null===(n=e.metadata)||void 0===n?void 0:n.analytics_config.analysis),o=await u.getUrl({page:p.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:null===(i=e.metadata)||void 0===i?void 0:i.analytics_config.id,analysisType:r,..."classification"===r||"regression"===r?{queryText:`${null===(s=e.metadata)||void 0===s?void 0:s.analytics_config.dest.results_field}.is_training : true`}:{}}});await t(o)},isPrimary:!0},{name:o.i18n.translate("xpack.ml.inference.modelsList.analyticsMapActionLabel",{defaultMessage:"Analytics map"}),description:o.i18n.translate("xpack.ml.inference.modelsList.analyticsMapActionLabel",{defaultMessage:"Analytics map"}),icon:"graphApp",type:"icon",isPrimary:!0,available:e=>{var t,a;return!(null===(t=e.metadata)||void 0===t||null===(a=t.analytics_config)||void 0===a||!a.id)},onClick:async e=>{const t=await u.getUrl({page:p.b.DATA_FRAME_ANALYTICS_MAP,pageState:{modelId:e.model_id}});await L(t,!1)}},{name:o.i18n.translate("xpack.ml.inference.modelsList.startModelDeploymentActionLabel",{defaultMessage:"Start deployment"}),description:o.i18n.translate("xpack.ml.inference.modelsList.startModelDeploymentActionLabel",{defaultMessage:"Start deployment"}),icon:"play",type:"icon",isPrimary:!0,enabled:e=>{var t,a;const{state:n}=null!==(t=null===(a=e.stats)||void 0===a?void 0:a.deployment_stats)&&void 0!==t?t:{};return!E&&n!==Wb&&n!==Hb},available:e=>"pytorch"===e.model_type,onClick:async e=>{try{w(!0),await x.startModelAllocation(e.model_id),O(o.i18n.translate("xpack.ml.trainedModels.modelsList.startSuccess",{defaultMessage:'Deployment for "{modelId}" has been started successfully.',values:{modelId:e.model_id}})),await N()}catch(t){v(t,o.i18n.translate("xpack.ml.trainedModels.modelsList.startFailed",{defaultMessage:'Failed to start "{modelId}"',values:{modelId:e.model_id}})),w(!1)}}},{name:o.i18n.translate("xpack.ml.inference.modelsList.stopModelDeploymentActionLabel",{defaultMessage:"Stop deployment"}),description:o.i18n.translate("xpack.ml.inference.modelsList.stopModelDeploymentActionLabel",{defaultMessage:"Stop deployment"}),icon:"stop",type:"icon",isPrimary:!0,available:e=>"pytorch"===e.model_type,enabled:e=>{var t,a,n;return!E&&Object(xo.isPopulatedObject)(null===(t=e.stats)||void 0===t?void 0:t.deployment_stats)&&(null===(a=e.stats)||void 0===a||null===(n=a.deployment_stats)||void 0===n?void 0:n.state)!==Yb},onClick:async e=>{const t=Object(xo.isPopulatedObject)(e.pipelines);if(t){if(!await A(e))return}try{w(!0),await x.stopModelAllocation(e.model_id,{force:t}),O(o.i18n.translate("xpack.ml.trainedModels.modelsList.stopSuccess",{defaultMessage:'Deployment for "{modelId}" has been stopped successfully.',values:{modelId:e.model_id}})),await N()}catch(t){v(t,o.i18n.translate("xpack.ml.trainedModels.modelsList.stopFailed",{defaultMessage:'Failed to stop "{modelId}"',values:{modelId:e.model_id}})),w(!1)}}},{name:o.i18n.translate("xpack.ml.trainedModels.modelsList.deleteModelActionLabel",{defaultMessage:"Delete model"}),description:o.i18n.translate("xpack.ml.trainedModels.modelsList.deleteModelActionLabel",{defaultMessage:"Delete model"}),"data-test-subj":"mlModelsTableRowDeleteAction",icon:"trash",type:"icon",color:"danger",isPrimary:!1,onClick:async e=>{await J([e])},available:e=>j&&!R(e),enabled:e=>!Object(xo.isPopulatedObject)(e.pipelines)}],U=async e=>{const t={...F};t[e.model_id]?delete t[e.model_id]:(await z([e]),t[e.model_id]=Object(I.jsx)(Vb.a,{item:e})),D(t)},G=[{align:"left",width:"40px",isExpander:!0,render:e=>Object(I.jsx)(r.EuiButtonIcon,{onClick:U.bind(null,e),"aria-label":F[e.model_id]?o.i18n.translate("xpack.ml.trainedModels.modelsList.collapseRow",{defaultMessage:"Collapse"}):o.i18n.translate("xpack.ml.trainedModels.modelsList.expandRow",{defaultMessage:"Expand"}),iconType:F[e.model_id]?"arrowUp":"arrowDown"}),"data-test-subj":"mlModelsTableRowDetailsToggle"},{field:Qb.id,name:o.i18n.translate("xpack.ml.trainedModels.modelsList.modelIdHeader",{defaultMessage:"ID"}),sortable:!0,truncateText:!1,"data-test-subj":"mlModelsTableColumnId"},{field:Qb.description,width:"350px",name:o.i18n.translate("xpack.ml.trainedModels.modelsList.modelDescriptionHeader",{defaultMessage:"Description"}),sortable:!1,truncateText:!1,"data-test-subj":"mlModelsTableColumnDescription"},{field:Qb.type,name:o.i18n.translate("xpack.ml.trainedModels.modelsList.typeHeader",{defaultMessage:"Type"}),sortable:!0,truncateText:!0,align:"left",render:e=>Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"xs",wrap:!0},e.map((e=>Object(I.jsx)(r.EuiFlexItem,{key:e,grow:!1},Object(I.jsx)(r.EuiBadge,{color:"hollow","data-test-subj":"mlModelType"},e))))),"data-test-subj":"mlModelsTableColumnType"},{name:o.i18n.translate("xpack.ml.trainedModels.modelsList.stateHeader",{defaultMessage:"State"}),sortable:e=>{var t,a;return null===(t=e.stats)||void 0===t||null===(a=t.deployment_stats)||void 0===a?void 0:a.state},align:"left",truncateText:!0,render:e=>{var t,a;const n=null===(t=e.stats)||void 0===t||null===(a=t.deployment_stats)||void 0===a?void 0:a.state;return n?Object(I.jsx)(r.EuiBadge,{color:"hollow"},n):null},"data-test-subj":"mlModelsTableColumnDeploymentState"},{field:Qb.createdAt,name:o.i18n.translate("xpack.ml.trainedModels.modelsList.createdAtHeader",{defaultMessage:"Created at"}),dataType:"date",render:e=>m(e),sortable:!0,"data-test-subj":"mlModelsTableColumnCreatedAt"},{name:o.i18n.translate("xpack.ml.trainedModels.modelsList.actionsHeader",{defaultMessage:"Actions"}),actions:V,"data-test-subj":"mlModelsTableColumnActions"}],q=B&&B.length>0?[{type:"field_value_selection",field:"type",name:o.i18n.translate("xpack.ml.dataframe.analyticsList.typeFilter",{defaultMessage:"Type"}),multiSelect:"or",options:B}]:[],W=Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiTitle,{size:"s"},Object(I.jsx)("h5",null,Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.selectedModelsMessage",defaultMessage:"{modelsCount, plural, one{# model} other {# models}} selected",values:{modelsCount:_.length}})))),Object(I.jsx)(r.EuiFlexItem,null,Object(I.jsx)(r.EuiButton,{color:"danger",onClick:J.bind(null,_)},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.deleteModelsButtonLabel",defaultMessage:"Delete"}))))),H=j?{selectableMessage:(e,t)=>e?o.i18n.translate("xpack.ml.trainedModels.modelsList.selectableMessage",{defaultMessage:"Select a model"}):Object(xo.isPopulatedObject)(t.pipelines)?o.i18n.translate("xpack.ml.trainedModels.modelsList.disableSelectableMessage",{defaultMessage:"Model has associated pipelines"}):R(t)?o.i18n.translate("xpack.ml.trainedModels.modelsList.builtInModelMessage",{defaultMessage:"Built-in model"}):"",selectable:e=>!Object(xo.isPopulatedObject)(e.pipelines)&&!R(e),onSelectionChange:e=>{T(e)}}:void 0,{onTableChange:Y,pagination:$,sorting:K}=Object(Ub.a)(M,b,f),Q={query:g,onChange:e=>null===e.error&&(f({queryText:e.queryText,pageIndex:0}),!0),box:{incremental:!0},...B&&B.length>0?{filters:q}:{},..._.length>0?{toolsLeft:W}:{}};return Object(I.jsx)(s.a.Fragment,null,Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)(r.EuiFlexGroup,{justifyContent:"spaceBetween"},P&&Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(Bb.a,{stats:P,dataTestSub:"mlInferenceModelsStatsBar"}))),Object(I.jsx)(r.EuiSpacer,{size:"m"}),Object(I.jsx)("div",{"data-test-subj":"mlModelsTableContainer"},Object(I.jsx)(r.EuiInMemoryTable,{allowNeutralSort:!1,columns:G,hasActions:!0,isExpandable:!0,itemIdToExpandedRowMap:F,isSelectable:!1,items:M,itemId:Qb.id,loading:E,search:Q,selection:H,rowProps:e=>({"data-test-subj":`mlModelsTableRow row-${e.model_id}`}),pagination:$,onTableChange:Y,sorting:K,"data-test-subj":E?"mlModelsTable loading":"mlModelsTable loaded"})),C.length>0&&Object(I.jsx)(Jb,{onClose:async e=>{e&&await async function(){const e=C.map((e=>e.model_id));try{await Promise.all(e.map((e=>x.deleteTrainedModel(e)))),S(M.filter((e=>!C.some((t=>t.model_id===e.model_id))))),O(o.i18n.translate("xpack.ml.trainedModels.modelsList.successfullyDeletedMessage",{defaultMessage:"{modelsCount, plural, one {Model {modelsToDeleteIds}} other {# models}} {modelsCount, plural, one {has} other {have}} been successfully deleted",values:{modelsCount:e.length,modelsToDeleteIds:e.join(", ")}}))}catch(t){v(t,o.i18n.translate("xpack.ml.trainedModels.modelsList.fetchDeletionErrorMessage",{defaultMessage:"{modelsCount, plural, one {Model} other {Models}} deletion failed",values:{modelsCount:e.length}}))}}(),k([])},models:C}))},Qb={id:"model_id",description:"description",createdAt:"create_time",type:"type",modelType:"model_type"},Zb=(e,t)=>({id:"trained_models",path:"/trained_models",title:o.i18n.translate("xpack.ml.modelManagement.trainedModels.docTitle",{defaultMessage:"Trained Models"}),render:(e,t)=>Object(I.jsx)(ef,h()({},e,{deps:t})),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("TRAINED_MODELS",e,t),{text:o.i18n.translate("xpack.ml.trainedModelsBreadcrumbs.trainedModelsLabel",{defaultMessage:"Trained Models"})}],enableDatePicker:!0,"data-test-subj":"mlPageModelManagement"}),ef=({location:e,deps:t})=>{const{context:a}=S(void 0,void 0,t.config,t.dataViewsContract,U(t));return Object(I.jsx)(g.b,{context:a},Object(I.jsx)(Kb,null),Object(I.jsx)(Q.a,null,Object(I.jsx)(r.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"m"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.modelManagement.trainedModelsHeader",defaultMessage:"Trained Models"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiBetaBadge,{label:o.i18n.translate("xpack.ml.navMenu.trainedModelsTabBetaLabel",{defaultMessage:"Technical preview"}),size:"m",color:"hollow",tooltipContent:o.i18n.translate("xpack.ml.navMenu.trainedModelsTabBetaTooltipContent",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),tooltipPosition:"right"})))))};var tf=a(392);const af=(e,t)=>({path:"/trained_models/nodes",render:(e,t)=>Object(I.jsx)(nf,h()({},e,{deps:t})),title:o.i18n.translate("xpack.ml.modelManagement.nodesOverview.docTitle",{defaultMessage:"Nodes"}),breadcrumbs:[F("ML_BREADCRUMB",e,t),F("TRAINED_MODELS",e,t),{text:o.i18n.translate("xpack.ml.trainedModelsBreadcrumbs.nodeOverviewLabel",{defaultMessage:"Nodes"})}],enableDatePicker:!0}),nf=({location:e,deps:t})=>{const{context:a}=S(void 0,void 0,t.config,t.dataViewsContract,U(t));return Object(d.g)({timeRangeSelector:!1,autoRefreshSelector:!0}),Object(I.jsx)(g.b,{context:a},Object(I.jsx)(Q.a,null,Object(I.jsx)(r.EuiFlexGroup,{responsive:!1,wrap:!1,alignItems:"center",gutterSize:"m"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.modelManagement.nodesOverviewHeader",defaultMessage:"Nodes"})),Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiBetaBadge,{label:o.i18n.translate("xpack.ml.navMenu.trainedModelsTabBetaLabel",{defaultMessage:"Technical preview"}),size:"m",color:"hollow",tooltipContent:o.i18n.translate("xpack.ml.navMenu.trainedModelsTabBetaTooltipContent",{defaultMessage:"This functionality is in technical preview and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but features in technical preview are not subject to the support SLA of official GA features."}),tooltipPosition:"right"})))),Object(I.jsx)(tf.a,null))};var sf=a(69);const rf=({path:e,children:t})=>Object(I.jsx)(sf.TrackApplicationView,{viewId:e},t);function of(e){J.a.next({lastRefresh:Date.now(),...e?{timeRange:e}:{}})}const lf=5e3,cf=()=>{var e,t,a;const{services:n}=Object(d.b)(),s=n.uiSettings,l=n.theme.theme$,{httpService:u}=n.mlServices,{timefilter:p,history:m}=n.data.query.timefilter,{displayWarningToast:b}=Object(St.c)(),[f,h]=Object(c.c)("_g"),g=(j=m,function(){var e,t;return null!==(e=null===(t=j.get())||void 0===t?void 0:t.map((({from:e,to:t})=>({start:e,end:t}))))&&void 0!==e?e:[]});var j;const v=Object(H.a)(),y=Object(H.b)();Object(i.useEffect)((function(){void 0!==(null==f?void 0:f.time)&&p.setTime({from:f.time.from,to:f.time.to})}),[null==f||null===(e=f.time)||void 0===e?void 0:e.from,null==f||null===(t=f.time)||void 0===t?void 0:t.to,null==f||null===(a=f.time)||void 0===a?void 0:a.ts]),Object(i.useEffect)((function(){var e,t;void 0!==(null==f?void 0:f.refreshInterval)&&p.setRefreshInterval({pause:!(null==f||null===(e=f.refreshInterval)||void 0===e||!e.pause),value:null==f||null===(t=f.refreshInterval)||void 0===t?void 0:t.value})}),[null==f?void 0:f.refreshInterval]);const O=Object(i.useCallback)(Object(x.debounce)((e=>{h("refreshInterval",e,!0)}),200),[h]),[E,w]=Object(i.useState)(!1),[M,S]=Object(i.useState)(g()),[_,T]=Object(i.useState)(p.isAutoRefreshSelectorEnabled()),[C,k]=Object(i.useState)(p.isTimeRangeSelectorEnabled()),F=Object(i.useMemo)((()=>{var e;const t=null!==(e=null==f?void 0:f.refreshInterval)&&void 0!==e?e:v,a=t.pause||!t.pause&&t.value<=0;return{value:t.value,pause:a}}),[JSON.stringify(null==f?void 0:f.refreshInterval),v]);Object(i.useEffect)((function(){const e=!(null==f||!f.refreshInterval);F.value<lf&&!F.pause&&b({title:e?o.i18n.translate("xpack.ml.datePicker.shortRefreshIntervalURLWarningMessage",{defaultMessage:"The refresh interval in the URL is shorter than the minimum supported by Machine Learning."}):o.i18n.translate("xpack.ml.datePicker.shortRefreshIntervalTimeFilterWarningMessage",{defaultMessage:"The refresh interval in Advanced Settings is shorter than the minimum supported by Machine Learning."}),text:Object(Si.toMountPoint)(Object(Si.wrapWithTheme)(Object(I.jsx)(r.EuiButton,{onClick:O.bind(null,{pause:F.pause,value:lf})},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.pageRefreshResetButton",defaultMessage:"Set to {defaultInterval}",values:{defaultInterval:"5s"}})),l))},{toastLifeTimeMs:3e4})}),[JSON.stringify(F),JSON.stringify(null==f?void 0:f.refreshInterval),O]);const D=s.get("dateFormat"),A=s.get(pb.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),L=Object(i.useMemo)((()=>A.map((({from:e,to:t,display:a})=>({start:e,end:t,label:a})))),[A]);Object(i.useEffect)((()=>{const e=new Ee.Subscription;e.add(u.getLoadingCount$.subscribe((e=>{w(0!==e)})));const t=p.getEnabledUpdated$();return void 0!==t&&e.add(t.subscribe((e=>{T(p.isAutoRefreshSelectorEnabled()),k(p.isTimeRangeSelectorEnabled())}))),function(){e.unsubscribe()}}),[]);const R=Object(i.useCallback)((({start:e,end:t})=>{S(g()),h("time",{from:e,to:t,..."now"===e||"now"===t?{ts:Date.now()}:{}})}),[h]);return _||C?Object(I.jsx)(r.EuiFlexGroup,{gutterSize:"s",alignItems:"center",className:"mlNavigationMenu__datePickerWrapper"},Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiSuperDatePicker,{isLoading:E,start:y.from,end:y.to,isPaused:F.pause,isAutoRefreshOnly:!C,refreshInterval:F.value||lf,onTimeChange:R,onRefresh:of,onRefreshChange:function({isPaused:e,refreshInterval:t}){O({pause:e,value:t})},recentlyUsedRanges:M,dateFormat:D,commonlyUsedRanges:L})),C?null:Object(I.jsx)(r.EuiFlexItem,{grow:!1},Object(I.jsx)(r.EuiButton,{fill:!0,color:"primary",iconType:"refresh",onClick:()=>of(),"data-test-subj":"mlRefreshPageButton"+(E?" loading":" loaded"),isLoading:E},Object(I.jsx)(X.FormattedMessage,{id:"xpack.ml.pageRefreshButton",defaultMessage:"Refresh"})))):null},df=Object(i.createContext)({setPageTitle:()=>{},setHeaderActionMenu:()=>{}}),uf="setPageHeader";function pf(e,t){switch(t.type){case uf:return{...e,pageHeader:t.payload}}return e}const mf=s.a.memo((({pageDeps:e})=>{var t;const a=Object(d.e)(),{services:{http:{basePath:s}}}=Object(d.b)(),[c,u]=Object(i.useReducer)(pf,{}),p=Object(i.useCallback)((e=>{u({type:uf,payload:e})}),[u]),m=Object(i.useMemo)((()=>Object.values(n).map((e=>e(a,s.get())))),[]),f=(e=>{const{pathname:t}=Object(l.useLocation)(),a=Object(l.useRouteMatch)("/settings/calendars_list/edit_calendar/:calendarId"),n=Object(l.useRouteMatch)("/settings/filter_lists/edit_filter_list/:filterId"),s=Object(i.useMemo)((()=>Object(x.keyBy)(e,"path")),[]),r=Object(i.useMemo)((()=>{if(a)return s[a.path];if(n)return s[n.path];const e=t.replace(/\/$/,"");return s[e]}),[t]);return null!=r?r:s["/overview"]})(m),h=Object(i.useMemo)((()=>[...f.enableDatePicker?[Object(I.jsx)(cf,null)]:[]]),[f.enableDatePicker]);return(e=>{const t=null==e?void 0:e.title,{services:{chrome:{docTitle:a}}}=Object(d.b)(),n=Object(i.useCallback)((e=>{a.change([e,oi.a])}),[a]);Object(i.useEffect)((()=>{t&&n(t)}),[n,t])})(f),Object(I.jsx)(Si.KibanaPageTemplate,{className:"ml-app","data-test-subj":"mlApp",restrictWidth:!1,pageContentProps:{className:"kbnAppWrapper"},pageContentBodyProps:{className:"kbnAppWrapper"},solutionNav:{name:o.i18n.translate("xpack.ml.plugin.title",{defaultMessage:"Machine Learning"}),icon:"machineLearningApp",items:b(f)},pageHeader:{pageTitle:null!==(t=c.pageHeader)&&void 0!==t?t:Object(I.jsx)(r.EuiLoadingContent,{lines:1}),rightSideItems:h,restrictWidth:!1},pageBodyProps:{"data-test-subj":null==f?void 0:f["data-test-subj"]}},Object(I.jsx)(bf,{setPageTitle:p,pageDeps:e,routeList:m}))})),bf=s.a.memo((({setPageTitle:e,pageDeps:t,routeList:a})=>{const{services:{application:n}}=Object(d.b)();return Object(I.jsx)(Si.RedirectAppLinks,{application:n},Object(I.jsx)(df.Provider,{value:{setPageTitle:e,setHeaderActionMenu:t.setHeaderActionMenu}},Object(I.jsx)(r.EuiPageContentBody,{restrictWidth:!1},a.map((e=>Object(I.jsx)(l.Route,{key:e.id,path:e.path,exact:!0,render:a=>(window.setTimeout((()=>{t.setBreadcrumbs(e.breadcrumbs)})),Object(I.jsx)(rf,{path:e.path},e.render(a,t)))}))))))}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(75),i=a.n(n),s=(a(16),a(44)),r=a(2),o=a(154),l=a(12);const c=({icon:e,id:t,isGroup:a=!1,numJobs:n,removeId:c})=>{let d,u={color:a?Object(o.a)(t):"hollow"};return!0===e&&c&&(u={...u,iconType:"cross",iconSide:"right",onClick:()=>c(t),onClickAriaLabel:"Remove id"}),void 0!==n&&(d=r.i18n.translate("xpack.ml.jobSelector.selectedGroupJobs",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:n}})),Object(l.jsx)(s.EuiBadge,i()({key:`${t}-id`,"data-test-subj":`mlJobSelectionBadge ${t}`},u),`${t}${d||""}`)}},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(16),i=a.n(n),s=a(48),r=a(302),o=a(126),l=a(286),c=a(305),d=a(44),u=a(82),p=a(119),m=a(12);const b=({overlayKey:e,start:t,end:a,color:n,showMarker:r=!0})=>{const{euiTheme:o}=Object(p.e)();return Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(s.RectAnnotation,{id:`rect_annotation_${e}`,zIndex:1,hideTooltips:!0,dataValues:[{coordinates:{x0:t,x1:a}}],style:{fill:n,strokeWidth:0}}),Object(m.jsx)(s.LineAnnotation,{id:"annotation_1",domainType:s.AnnotationDomainType.XDomain,dataValues:[{dataValue:t}],style:{line:{strokeWidth:1,stroke:"#343741",opacity:0}},markerPosition:s.Position.Bottom,hideTooltips:!0,marker:r?Object(m.jsx)(d.EuiIcon,{type:"arrowUp"}):void 0,markerBody:r?Object(m.jsx)("div",{style:{fontWeight:"normal",color:o.euiTextColor}},Object(u.d)(t)):void 0}))},f=({eventRateChartData:e,anomalyData:t,height:a,width:n,showAxis:i,loading:d=!1,fadeChart:u,overlayRanges:p,onBrushEnd:f})=>{const{EVENT_RATE_COLOR_WITH_ANOMALIES:h,EVENT_RATE_COLOR:g}=Object(o.d)(),j=u?h:g;return Object(m.jsx)("div",{style:{width:n,height:a},"data-test-subj":"mlEventRateChart "+(e.length?"withData":"empty")},Object(m.jsx)(l.a,{height:a,hasData:e.length>0,loading:d},Object(m.jsx)(s.Chart,null,!0===i&&Object(m.jsx)(r.a,null),Object(m.jsx)(s.Settings,{tooltip:s.TooltipType.None,onBrushEnd:f,theme:{scales:{histogramPadding:.2}}}),p&&p.map(((e,t)=>Object(m.jsx)(b,{key:t,overlayKey:t,start:e.start,end:e.end,color:e.color,showMarker:e.showMarker}))),Object(m.jsx)(c.a,{anomalyData:t}),Object(m.jsx)(s.HistogramBarSeries,{id:"event_rate",xScaleType:s.ScaleType.Time,yScaleType:s.ScaleType.Linear,xAccessor:"time",yAccessors:["value"],data:e,color:j}))))}},,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}));const n="ml:anomalyDetection:results:enableTimeDefaults",i="ml:anomalyDetection:results:timeDefaults"},function(e,t,a){"use strict";a.d(t,"c",(function(){return d})),a.d(t,"b",(function(){return u})),a.d(t,"a",(function(){return p}));var n=a(16),i=a.n(n),s=a(44),r=a(72),o=a(11),l=a(4),c=a(12);const d=({initialAlert:e,jobIds:t,onCloseFlyout:a,onSave:s})=>{const{services:{triggersActionsUi:d}}=Object(r.b)(),u=Object(n.useMemo)((()=>{if(!d)return;const n={onClose:()=>{a()},onSave:async()=>{s&&s()}};return e?d.getEditAlertFlyout({...n,initialAlert:e}):d.getAddAlertFlyout({...n,consumer:l.e,canChangeTrigger:!1,alertTypeId:o.d.ANOMALY_DETECTION,metadata:{},initialValues:{params:{jobSelection:{jobIds:t}}}})}),[d,null==e?void 0:e.id,t]);return Object(c.jsx)(i.a.Fragment,null,u)},u=({setShowFunction:e,unsetShowFunction:t,onSave:a})=>{const[i,s]=Object(n.useState)(!1),[r,o]=Object(n.useState)(),l=Object(n.useCallback)((e=>{o(e),s(!0)}),[]);return Object(n.useEffect)((()=>(e(l),()=>{t()})),[]),i&&r?Object(c.jsx)(d,{jobIds:r,onCloseFlyout:()=>s(!1),onSave:()=>{s(!1),a()}}):null},p=({initialAlert:e,onSave:t})=>{const[a,r]=Object(n.useState)(!1);return Object(c.jsx)(i.a.Fragment,null,Object(c.jsx)(s.EuiButtonEmpty,{size:"xs",onClick:r.bind(null,!a)},e.name),a?Object(c.jsx)(d,{initialAlert:e,onCloseFlyout:r.bind(null,!1),onSave:()=>{r(!1),t()}}):null)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return n.ElasticsearchSqlHighlightRules}}),Object.defineProperty(t,"ScriptHighlightRules",{enumerable:!0,get:function(){return n.ScriptHighlightRules}}),Object.defineProperty(t,"XJsonHighlightRules",{enumerable:!0,get:function(){return n.XJsonHighlightRules}}),Object.defineProperty(t,"XJsonMode",{enumerable:!0,get:function(){return n.XJsonMode}}),Object.defineProperty(t,"addXJsonToRules",{enumerable:!0,get:function(){return n.addXJsonToRules}}),Object.defineProperty(t,"installXJsonMode",{enumerable:!0,get:function(){return n.installXJsonMode}});var n=a(298)},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));var n=a(25);const i={rowMouseenter$:new n.Subject,rowMouseleave$:new n.Subject}},function(e,t,a){"use strict";var n=Number.isNaN||function(e){return"number"==typeof e&&e!=e};function i(e,t){if(e.length!==t.length)return!1;for(var a=0;a<e.length;a++)if(i=e[a],s=t[a],!(i===s||n(i)&&n(s)))return!1;var i,s;return!0}e.exports=function(e,t){void 0===t&&(t=i);var a=null;function n(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];if(a&&a.lastThis===this&&t(n,a.lastArgs))return a.lastResult;var s=e.apply(this,n);return a={lastResult:s,lastArgs:n,lastThis:this},s}return n.clear=function(){a=null},n}},function(e,t,a){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
function n(e,t){if(e===t)return 0;for(var a=e.length,n=t.length,i=0,s=Math.min(a,n);i<s;++i)if(e[i]!==t[i]){a=e[i],n=t[i];break}return a<n?-1:n<a?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}var s=a(171),r=Object.prototype.hasOwnProperty,o=Array.prototype.slice,l="foo"===function(){}.name;function c(e){return Object.prototype.toString.call(e)}function d(e){return!i(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}var u=e.exports=g,p=/\s*function\s+([^\(\s]*)\s*/;function m(e){if(s.isFunction(e)){if(l)return e.name;var t=e.toString().match(p);return t&&t[1]}}function b(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function f(e){if(l||!s.isFunction(e))return s.inspect(e);var t=m(e);return"[Function"+(t?": "+t:"")+"]"}function h(e,t,a,n,i){throw new u.AssertionError({message:a,actual:e,expected:t,operator:n,stackStartFunction:i})}function g(e,t){e||h(e,!0,t,"==",u.ok)}function j(e,t,a,r){if(e===t)return!0;if(i(e)&&i(t))return 0===n(e,t);if(s.isDate(e)&&s.isDate(t))return e.getTime()===t.getTime();if(s.isRegExp(e)&&s.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(d(e)&&d(t)&&c(e)===c(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===n(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;var l=(r=r||{actual:[],expected:[]}).actual.indexOf(e);return-1!==l&&l===r.expected.indexOf(t)||(r.actual.push(e),r.expected.push(t),function(e,t,a,n){if(null==e||null==t)return!1;if(s.isPrimitive(e)||s.isPrimitive(t))return e===t;if(a&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=x(e),r=x(t);if(i&&!r||!i&&r)return!1;if(i)return j(e=o.call(e),t=o.call(t),a);var l,c,d=O(e),u=O(t);if(d.length!==u.length)return!1;for(d.sort(),u.sort(),c=d.length-1;c>=0;c--)if(d[c]!==u[c])return!1;for(c=d.length-1;c>=0;c--)if(!j(e[l=d[c]],t[l],a,n))return!1;return!0}(e,t,a,r))}return a?e===t:e==t}function x(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function v(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function y(e,t,a,n){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof a&&(n=a,a=null),i=function(e){var t;try{e()}catch(e){t=e}return t}(t),n=(a&&a.name?" ("+a.name+").":".")+(n?" "+n:"."),e&&!i&&h(i,a,"Missing expected exception"+n);var r="string"==typeof n,o=!e&&i&&!a;if((!e&&s.isError(i)&&r&&v(i,a)||o)&&h(i,a,"Got unwanted exception"+n),e&&i&&a&&!v(i,a)||!e&&i)throw i}u.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return b(f(e.actual),128)+" "+e.operator+" "+b(f(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||h;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var a=new Error;if(a.stack){var n=a.stack,i=m(t),s=n.indexOf("\n"+i);if(s>=0){var r=n.indexOf("\n",s+1);n=n.substring(r+1)}this.stack=n}}},s.inherits(u.AssertionError,Error),u.fail=h,u.ok=g,u.equal=function(e,t,a){e!=t&&h(e,t,a,"==",u.equal)},u.notEqual=function(e,t,a){e==t&&h(e,t,a,"!=",u.notEqual)},u.deepEqual=function(e,t,a){j(e,t,!1)||h(e,t,a,"deepEqual",u.deepEqual)},u.deepStrictEqual=function(e,t,a){j(e,t,!0)||h(e,t,a,"deepStrictEqual",u.deepStrictEqual)},u.notDeepEqual=function(e,t,a){j(e,t,!1)&&h(e,t,a,"notDeepEqual",u.notDeepEqual)},u.notDeepStrictEqual=function e(t,a,n){j(t,a,!0)&&h(t,a,n,"notDeepStrictEqual",e)},u.strictEqual=function(e,t,a){e!==t&&h(e,t,a,"===",u.strictEqual)},u.notStrictEqual=function(e,t,a){e===t&&h(e,t,a,"!==",u.notStrictEqual)},u.throws=function(e,t,a){y(!0,e,t,a)},u.doesNotThrow=function(e,t,a){y(!1,e,t,a)},u.ifError=function(e){if(e)throw e};var O=Object.keys||function(e){var t=[];for(var a in e)r.call(e,a)&&t.push(a);return t}}).call(this,a(133))},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(16);const i=[10,25,50];function s(e,t,a){const{pageIndex:s,pageSize:r,sortField:o,sortDirection:l}=t;return{onTableChange:Object(n.useCallback)((({page:e,sort:n})=>{var i,s,r,o;const l={pageIndex:null!==(i=null==e?void 0:e.index)&&void 0!==i?i:t.pageIndex,pageSize:null!==(s=null==e?void 0:e.size)&&void 0!==s?s:t.pageSize,sortField:null!==(r=null==n?void 0:n.field)&&void 0!==r?r:t.sortField,sortDirection:null!==(o=null==n?void 0:n.direction)&&void 0!==o?o:t.sortDirection};a(l)}),[t,a]),pagination:Object(n.useMemo)((()=>({pageIndex:s,pageSize:r,totalItemCount:e.length,pageSizeOptions:i})),[e,s,r]),sorting:Object(n.useMemo)((()=>({sort:{field:o,direction:l}})),[o,l])}}},function(e,t,a){"use strict";var n=a(118);e.exports=s;var i="\0";function s(e){this._isDirected=!n.has(e,"directed")||e.directed,this._isMultigraph=!!n.has(e,"multigraph")&&e.multigraph,this._isCompound=!!n.has(e,"compound")&&e.compound,this._label=void 0,this._defaultNodeLabelFn=n.constant(void 0),this._defaultEdgeLabelFn=n.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}function r(e,t){e[t]?e[t]++:e[t]=1}function o(e,t){--e[t]||delete e[t]}function l(e,t,a,i){var s=""+t,r=""+a;if(!e&&s>r){var o=s;s=r,r=o}return s+""+r+""+(n.isUndefined(i)?"\0":i)}function c(e,t,a,n){var i=""+t,s=""+a;if(!e&&i>s){var r=i;i=s,s=r}var o={v:i,w:s};return n&&(o.name=n),o}function d(e,t){return l(e,t.v,t.w,t.name)}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(e){return this._label=e,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(e){return n.isFunction(e)||(e=n.constant(e)),this._defaultNodeLabelFn=e,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return n.keys(this._nodes)},s.prototype.sources=function(){var e=this;return n.filter(this.nodes(),(function(t){return n.isEmpty(e._in[t])}))},s.prototype.sinks=function(){var e=this;return n.filter(this.nodes(),(function(t){return n.isEmpty(e._out[t])}))},s.prototype.setNodes=function(e,t){var a=arguments,i=this;return n.each(e,(function(e){a.length>1?i.setNode(e,t):i.setNode(e)})),this},s.prototype.setNode=function(e,t){return n.has(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=i,this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)},s.prototype.node=function(e){return this._nodes[e]},s.prototype.hasNode=function(e){return n.has(this._nodes,e)},s.prototype.removeNode=function(e){var t=this;if(n.has(this._nodes,e)){var a=function(e){t.removeEdge(t._edgeObjs[e])};delete this._nodes[e],this._isCompound&&(this._removeFromParentsChildList(e),delete this._parent[e],n.each(this.children(e),(function(e){t.setParent(e)})),delete this._children[e]),n.each(n.keys(this._in[e]),a),delete this._in[e],delete this._preds[e],n.each(n.keys(this._out[e]),a),delete this._out[e],delete this._sucs[e],--this._nodeCount}return this},s.prototype.setParent=function(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n.isUndefined(t))t=i;else{for(var a=t+="";!n.isUndefined(a);a=this.parent(a))if(a===e)throw new Error("Setting "+t+" as parent of "+e+" would create a cycle");this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this},s.prototype._removeFromParentsChildList=function(e){delete this._children[this._parent[e]][e]},s.prototype.parent=function(e){if(this._isCompound){var t=this._parent[e];if(t!==i)return t}},s.prototype.children=function(e){if(n.isUndefined(e)&&(e=i),this._isCompound){var t=this._children[e];if(t)return n.keys(t)}else{if(e===i)return this.nodes();if(this.hasNode(e))return[]}},s.prototype.predecessors=function(e){var t=this._preds[e];if(t)return n.keys(t)},s.prototype.successors=function(e){var t=this._sucs[e];if(t)return n.keys(t)},s.prototype.neighbors=function(e){var t=this.predecessors(e);if(t)return n.union(t,this.successors(e))},s.prototype.isLeaf=function(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length},s.prototype.filterNodes=function(e){var t=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var a=this;n.each(this._nodes,(function(a,n){e(n)&&t.setNode(n,a)})),n.each(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,a.edge(e))}));var i={};function s(e){var n=a.parent(e);return void 0===n||t.hasNode(n)?(i[e]=n,n):n in i?i[n]:s(n)}return this._isCompound&&n.each(t.nodes(),(function(e){t.setParent(e,s(e))})),t},s.prototype.setDefaultEdgeLabel=function(e){return n.isFunction(e)||(e=n.constant(e)),this._defaultEdgeLabelFn=e,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return n.values(this._edgeObjs)},s.prototype.setPath=function(e,t){var a=this,i=arguments;return n.reduce(e,(function(e,n){return i.length>1?a.setEdge(e,n,t):a.setEdge(e,n),n})),this},s.prototype.setEdge=function(){var e,t,a,i,s=!1,o=arguments[0];"object"==typeof o&&null!==o&&"v"in o?(e=o.v,t=o.w,a=o.name,2===arguments.length&&(i=arguments[1],s=!0)):(e=o,t=arguments[1],a=arguments[3],arguments.length>2&&(i=arguments[2],s=!0)),e=""+e,t=""+t,n.isUndefined(a)||(a=""+a);var d=l(this._isDirected,e,t,a);if(n.has(this._edgeLabels,d))return s&&(this._edgeLabels[d]=i),this;if(!n.isUndefined(a)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[d]=s?i:this._defaultEdgeLabelFn(e,t,a);var u=c(this._isDirected,e,t,a);return e=u.v,t=u.w,Object.freeze(u),this._edgeObjs[d]=u,r(this._preds[t],e),r(this._sucs[e],t),this._in[t][d]=u,this._out[e][d]=u,this._edgeCount++,this},s.prototype.edge=function(e,t,a){var n=1===arguments.length?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,a);return this._edgeLabels[n]},s.prototype.hasEdge=function(e,t,a){var i=1===arguments.length?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,a);return n.has(this._edgeLabels,i)},s.prototype.removeEdge=function(e,t,a){var n=1===arguments.length?d(this._isDirected,arguments[0]):l(this._isDirected,e,t,a),i=this._edgeObjs[n];return i&&(e=i.v,t=i.w,delete this._edgeLabels[n],delete this._edgeObjs[n],o(this._preds[t],e),o(this._sucs[e],t),delete this._in[t][n],delete this._out[e][n],this._edgeCount--),this},s.prototype.inEdges=function(e,t){var a=this._in[e];if(a){var i=n.values(a);return t?n.filter(i,(function(e){return e.v===t})):i}},s.prototype.outEdges=function(e,t){var a=this._out[e];if(a){var i=n.values(a);return t?n.filter(i,(function(e){return e.w===t})):i}},s.prototype.nodeEdges=function(e,t){var a=this.inEdges(e,t);if(a)return a.concat(this.outEdges(e,t))}},function(e,t,a){var n=a(236),i=a(172);e.exports=function(e,t){return e&&n(e,t,i)}},function(e,t,a){var n=a(486)();e.exports=n},function(e,t,a){e.exports=a(23)(932)},function(e,t,a){e.exports=a(23)(1290)},function(e,t,a){e.exports=a(23)(1282)},function(e,t,a){e.exports=a(23)(934)},function(e,t,a){e.exports=a(23)(1292)},function(e,t,a){e.exports=a(23)(553)},function(e,t,a){e.exports=a(23)(1283)},function(e,t,a){e.exports=a(23)(3101)},function(e,t,a){e.exports=a(23)(673)},function(e,t,a){var n=a(347);e.exports=function(e,t,a){for(var i=-1,s=e.length;++i<s;){var r=e[i],o=t(r);if(null!=o&&(void 0===l?o==o&&!n(o):a(o,l)))var l=o,c=r}return c}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(16);t.default=function(e){n.useEffect(e,[])}},,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(16),i=a(388),s=a(12);const r=({selectedIds:e,withTimeRangeSelector:t,dateFormatTz:a,singleSelection:r,timeseriesOnly:o,onFlyoutClose:l,onSelectionConfirmed:c,maps:d})=>{const[u,p]=Object(n.useState)(!0);return Object(s.jsx)(i.b,{selectedIds:e,withTimeRangeSelector:t,dateFormatTz:a,singleSelection:r,timeseriesOnly:o,onFlyoutClose:l,onSelectionConfirmed:c,onTimeRangeConfigChange:p,applyTimeRangeConfig:u,maps:d})}},,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(16);t.default=function(e,t){void 0===t&&(t=0);var a=n.useRef(!1),i=n.useRef(),s=n.useRef(e),r=n.useCallback((function(){return a.current}),[]),o=n.useCallback((function(){a.current=!1,i.current&&clearTimeout(i.current),i.current=setTimeout((function(){a.current=!0,s.current()}),t)}),[t]),l=n.useCallback((function(){a.current=null,i.current&&clearTimeout(i.current)}),[]);return n.useEffect((function(){s.current=e}),[e]),n.useEffect((function(){return o(),l}),[t]),[r,l,o]}},,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return U})),a.d(t,"a",(function(){return G})),a.d(t,"c",(function(){return q})),a.d(t,"d",(function(){return H}));var n=a(16),i=a.n(n),s=a(2),r=a(45),o=a(44),l=a(81),c=a(103),d=a(76),u=a(285),p=a(403),m=a(394),b=a(72),f=a(73),h=a(77),g=a(19),j=a(74),x=a(12);let v;const y=({closeFlyout:e,item:t})=>{const{id:a,config:i}=t,{state:r}=t.stats,l=void 0!==i.allow_lazy_start?String(i.allow_lazy_start):"",[d,u]=Object(n.useState)(l),[p,m]=Object(n.useState)(i.description||""),[y,O]=Object(n.useState)(i.model_memory_limit),[E,w]=Object(n.useState)(),[M,S]=Object(n.useState)(i.max_num_threads),{services:{notifications:_}}=Object(b.b)(),{refresh:T}=Object(j.E)(),C=Object(h.c)(),k=void 0!==E||0===M;Object(n.useEffect)((()=>{if(void 0===v&&(v=Object(g.c)()),""!==y){const e=v(y);null!==e&&e.invalidUnits?w(s.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:e.invalidUnits.allowedUnits}})):w(void 0)}else w(s.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryEmptyError",{defaultMessage:"Model memory limit must not be empty"}))}),[y]);return Object(x.jsx)(o.EuiFlyout,{onClose:e,hideCloseButton:!0,"aria-labelledby":"analyticsEditFlyoutTitle","data-test-subj":"mlAnalyticsEditFlyout"},Object(x.jsx)(o.EuiFlyoutHeader,{hasBorder:!0},Object(x.jsx)(o.EuiTitle,{size:"m"},Object(x.jsx)("h2",{id:"analyticsEditFlyoutTitle"},s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutTitle",{defaultMessage:"Edit {jobId}",values:{jobId:a}})))),Object(x.jsx)(o.EuiFlyoutBody,null,Object(x.jsx)(o.EuiForm,null,Object(x.jsx)(o.EuiFormRow,{label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartLabel",{defaultMessage:"Allow lazy start"})},Object(x.jsx)(o.EuiSelect,{"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartAriaLabel",{defaultMessage:"Update allow lazy start."}),"data-test-subj":"mlAnalyticsEditFlyoutAllowLazyStartInput",options:[{value:"true",text:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartTrueValue",{defaultMessage:"True"})},{value:"false",text:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.allowLazyStartFalseValue",{defaultMessage:"False"})}],value:d,onChange:e=>u(e.target.value)})),Object(x.jsx)(o.EuiFormRow,{label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.descriptionLabel",{defaultMessage:"Description"})},Object(x.jsx)(o.EuiFieldText,{"data-test-subj":"mlAnalyticsEditFlyoutDescriptionInput",value:p,onChange:e=>m(e.target.value),"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.descriptionAriaLabel",{defaultMessage:"Update the job description."})})),Object(x.jsx)(o.EuiFormRow,{helpText:r!==c.b.STOPPED&&s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryHelpText",{defaultMessage:"Model memory limit cannot be edited until the job has stopped."}),label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryLimitLabel",{defaultMessage:"Model memory limit"}),isInvalid:void 0!==E,error:E},Object(x.jsx)(o.EuiFieldText,{"data-test-subj":"mlAnalyticsEditFlyoutmodelMemoryLimitInput",isInvalid:void 0!==E,readOnly:r!==c.b.STOPPED,value:y,onChange:e=>O(e.target.value),"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.modelMemoryLimitAriaLabel",{defaultMessage:"Update the model memory limit."})})),Object(x.jsx)(o.EuiFormRow,{helpText:r!==c.b.STOPPED&&s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsHelpText",{defaultMessage:"Maximum number of threads cannot be edited until the job has stopped."}),label:s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsLabel",{defaultMessage:"Maximum number of threads"}),isInvalid:0===M,error:0===M&&s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsError",{defaultMessage:"The minimum value is 1."})},Object(x.jsx)(o.EuiFieldNumber,{"aria-label":s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyout.maxNumThreadsAriaLabel",{defaultMessage:"Update the maximum number of threads to be used by the analysis."}),"data-test-subj":"mlAnalyticsEditFlyoutMaxNumThreadsLimitInput",onChange:e=>S(""===e.target.value?void 0:+e.target.value),step:1,min:1,readOnly:r!==c.b.STOPPED,value:M})))),Object(x.jsx)(o.EuiFlyoutFooter,null,Object(x.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(x.jsx)(o.EuiFlexItem,{grow:!1},Object(x.jsx)(o.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left"},s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutCancelButtonText",{defaultMessage:"Cancel"}))),Object(x.jsx)(o.EuiFlexItem,{grow:!1},Object(x.jsx)(o.EuiButton,{"data-test-subj":"mlAnalyticsEditFlyoutUpdateButton",onClick:async()=>{const t=Object.assign({allow_lazy_start:d,description:p},y&&{model_memory_limit:y},M&&{max_num_threads:M});try{await f.ml.dataFrameAnalytics.updateDataFrameAnalytics(a,t),_.toasts.addSuccess(s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutSuccessMessage",{defaultMessage:"Analytics job {jobId} has been updated.",values:{jobId:a}})),T(),e()}catch(e){console.error(e),C.displayErrorToast(e,s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutErrorMessage",{defaultMessage:"Could not save changes to analytics job {jobId}",values:{jobId:a}}))}},fill:!0,isDisabled:k},s.i18n.translate("xpack.ml.dataframe.analyticsList.editFlyoutUpdateButtonText",{defaultMessage:"Update"}))))))},O=s.i18n.translate("xpack.ml.dataframe.analyticsList.editActionNameText",{defaultMessage:"Edit"}),E=({isDisabled:e})=>e?Object(x.jsx)(o.EuiToolTip,{position:"top",content:s.i18n.translate("xpack.ml.dataframe.analyticsList.editActionPermissionTooltip",{defaultMessage:"You do not have permission to edit analytics jobs."})},Object(x.jsx)(i.a.Fragment,null,O)):Object(x.jsx)(i.a.Fragment,null,O);var w=a(179);const M=s.i18n.translate("xpack.ml.dataframe.analyticsList.startActionNameText",{defaultMessage:"Start"}),S=({canStartStopDataFrameAnalytics:e,isDisabled:t,item:a})=>t?Object(x.jsx)(o.EuiToolTip,{position:"top",content:e?s.i18n.translate("xpack.ml.dataframe.analyticsList.completeBatchAnalyticsToolTip",{defaultMessage:"{analyticsId} is a completed analytics job and cannot be restarted.",values:{analyticsId:a.config.id}}):Object(d.f)("canStartStopDataFrameAnalytics")},Object(x.jsx)(i.a.Fragment,null,M)):Object(x.jsx)(i.a.Fragment,null,M),_=({closeModal:e,item:t,startAndCloseModal:a})=>Object(x.jsx)(i.a.Fragment,null,void 0!==t&&Object(x.jsx)(o.EuiConfirmModal,{title:s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalTitle",{defaultMessage:"Start {analyticsId}?",values:{analyticsId:t.config.id}}),onCancel:e,onConfirm:a,cancelButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalStartButton",{defaultMessage:"Start"}),defaultFocusedButton:o.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},Object(x.jsx)("p",null,s.i18n.translate("xpack.ml.dataframe.analyticsList.startModalBody",{defaultMessage:"A data frame analytics job increases search and indexing load in your cluster. If excessive load occurs, stop the job."})))),T=s.i18n.translate("xpack.ml.dataframe.analyticsList.stopActionNameText",{defaultMessage:"Stop"}),C=({isDisabled:e})=>e?Object(x.jsx)(o.EuiToolTip,{position:"top",content:Object(d.f)("canStartStopDataFrameAnalytics")},Object(x.jsx)(i.a.Fragment,null,T)):Object(x.jsx)(i.a.Fragment,null,T),k=({closeModal:e,item:t,forceStopAndCloseModal:a})=>Object(x.jsx)(i.a.Fragment,null,void 0!==t&&Object(x.jsx)(o.EuiConfirmModal,{title:s.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalTitle",{defaultMessage:"Force this job to stop?"}),onCancel:e,onConfirm:a,cancelButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.forceStopModalStartButton",{defaultMessage:"Stop"}),defaultFocusedButton:o.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"primary"},Object(x.jsx)("p",null,Object(x.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.forceStopModalBody",defaultMessage:"{analyticsId} is in a failed state. You must stop the job and fix the failure.",values:{analyticsId:t.config.id}}))));var F=a(199);const I=s.i18n.translate("xpack.ml.dataframe.analyticsList.viewActionName",{defaultMessage:"View"}),D=({item:e})=>{const{disabled:t,tooltipContent:a}=Object(F.a)(e);return t?Object(x.jsx)(o.EuiToolTip,{position:"top",content:a},Object(x.jsx)(i.a.Fragment,null,I)):Object(x.jsx)(i.a.Fragment,null,I)};var A=a(0);const L=()=>{const e=Object(b.d)(),t=Object(b.e)(),a=Object(n.useCallback)((a=>{const n=Object(j.m)(a.config.analysis);(async(a,n)=>{const i=await e.getUrl({page:A.b.DATA_FRAME_ANALYTICS_EXPLORATION,pageState:{jobId:a,analysisType:n}});await t(i,!1)})(a.id,n)}),[]);return{action:Object(n.useMemo)((()=>({isPrimary:!0,name:e=>Object(x.jsx)(D,{item:e}),enabled:e=>!Object(F.a)(e).disabled,description:I,icon:"visTable",type:"icon",onClick:a,"data-test-subj":"mlAnalyticsJobViewButton"})),[a])}},R=s.i18n.translate("xpack.ml.dataframe.analyticsList.mapActionName",{defaultMessage:"Map"}),N=({item:e})=>{if(!Object(j.y)(e.config.analysis)&&!Object(j.x)(e.config.analysis)&&!Object(j.v)(e.config.analysis)){const e=s.i18n.translate("xpack.ml.dataframe.analyticsList.mapActionDisabledTooltipContent",{defaultMessage:"Unknown analysis type."});return Object(x.jsx)(o.EuiToolTip,{position:"top",content:e},Object(x.jsx)(i.a.Fragment,null,R))}return Object(x.jsx)(i.a.Fragment,null,R)};var P=a(8),z=a(89);const B=e=>{const t=Object(d.e)("canCreateDataFrameAnalytics"),a=Object(d.e)("canDeleteDataFrameAnalytics"),s=Object(d.e)("canStartStopDataFrameAnalytics"),r=L(),o=(()=>{const e=Object(b.d)(),t=Object(b.e)(),[a]=Object(z.c)("_g"),i=Object(n.useCallback)((async n=>{const i=Object(P.cloneDeep)(a||{});delete i.ml;const s=await e.getUrl({page:A.b.DATA_FRAME_ANALYTICS_MAP,pageState:{jobId:n.id,globalState:i}});await t(s,!1)}),[a]);return{action:Object(n.useMemo)((()=>({isPrimary:!0,name:e=>Object(x.jsx)(N,{item:e}),enabled:e=>!Object(F.a)(e).disabled,description:R,icon:"graphApp",type:"icon",onClick:i,"data-test-subj":"mlAnalyticsJobMapButton"})),[i])}})(),l=Object(p.c)(t),f=Object(m.b)(a),g=(e=>{const[t,a]=Object(n.useState)(),[i,s]=Object(n.useState)(!1),r=e=>{a(e),s(!0)};return{action:Object(n.useMemo)((()=>({name:()=>Object(x.jsx)(E,{isDisabled:!e}),enabled:()=>e,description:O,icon:"pencil",type:"icon",onClick:e=>r(e),"data-test-subj":"mlAnalyticsJobEditButton"})),[e]),isFlyoutVisible:i,item:t,closeFlyout:()=>s(!1),openFlyout:r}})(s),v=(e=>{const[t,a]=Object(n.useState)(!1),[i,s]=Object(n.useState)(),r=Object(h.c)(),o=e=>{s(e),a(!0)},l=t=>{if(!Object(c.g)(t.stats.state)){const a=Object(c.e)(t.stats);return e&&!a}return e};return{action:Object(n.useMemo)((()=>({name:t=>Object(x.jsx)(S,{isDisabled:!l(t),item:t,canStartStopDataFrameAnalytics:e}),available:e=>!Object(c.g)(e.stats.state)&&!Object(c.f)(e.stats.state),enabled:l,description:M,icon:"play",type:"icon",onClick:o,"data-test-subj":"mlAnalyticsJobStartButton"})),[]),closeModal:()=>a(!1),isModalVisible:t,item:i,openModal:o,startAndCloseModal:()=>{void 0!==i&&(a(!1),Object(w.e)(i,r))}}})(s),I=(e=>{const[t,a]=Object(n.useState)(!1),[i,s]=Object(n.useState)(),r=e=>{s(e),a(!0)},o=Object(n.useCallback)((t=>{e&&(Object(c.f)(t.stats.state)?r(t):Object(w.f)(t))}),[w.f]);return{action:Object(n.useMemo)((()=>({name:()=>Object(x.jsx)(C,{isDisabled:!e}),available:e=>Object(c.g)(e.stats.state)||Object(c.f)(e.stats.state),enabled:()=>e,description:T,icon:"stop",type:"icon",onClick:o,"data-test-subj":"mlAnalyticsJobStopButton"})),[o]),closeModal:()=>a(!1),isModalVisible:t,item:i,openModal:r,forceStopAndCloseModal:()=>{void 0!==i&&(a(!1),Object(w.f)(i))}}})(s),{refresh:D}=Object(j.E)();let B=null;const J=[r.action,o.action];var V;!1===e&&(B=Object(x.jsx)(i.a.Fragment,null,v.isModalVisible&&Object(x.jsx)(_,v),I.isModalVisible&&Object(x.jsx)(k,I),f.isDeleteJobCheckModalVisible&&(null==f||null===(V=f.item)||void 0===V?void 0:V.config)&&Object(x.jsx)(u.a,{onCloseCallback:f.closeDeleteJobCheckModal,canDeleteCallback:()=>{f.openModal(f.item),f.closeDeleteJobCheckModal()},refreshJobsCallback:D,jobType:f.jobType,jobIds:[f.item.config.id]}),f.isModalVisible&&Object(x.jsx)(m.a,f),(e=>!0===e.isFlyoutVisible&&void 0!==e.item)(g)&&Object(x.jsx)(y,g)),J.push(v.action,I.action,g.action,l.action,f.action));return{actions:J,modals:B}};var J,V=a(400);!function(e){e.analyzing="primary",e.failed="danger",e.reindexing="primary",e.started="primary",e.starting="primary",e.stopped="hollow"}(J||(J={}));const U=(e,t)=>{const a=J[e];return Object(c.f)(e)&&void 0!==t?Object(x.jsx)(o.EuiToolTip,{content:t},Object(x.jsx)(o.EuiBadge,{className:"mlTaskStateBadge",color:a},e)):Object(x.jsx)(o.EuiBadge,{className:"mlTaskStateBadge",color:a},e)},G=e=>Object(x.jsx)(o.EuiBadge,{className:"mlTaskStateBadge",color:"hollow"},e),q={name:s.i18n.translate("xpack.ml.dataframe.analyticsList.progress",{defaultMessage:"Progress"}),truncateText:!0,render(e){const{currentPhase:t,progress:a,totalPhases:i}=Object(c.d)(e.stats);return Object(x.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(x.jsx)(n.Fragment,null,Object(x.jsx)(o.EuiFlexItem,{style:{width:"60px"},grow:!1},Object(x.jsx)(o.EuiText,{size:"xs"},"Phase ",t,"/",i)),Object(x.jsx)(o.EuiFlexItem,{style:{width:"40px"},grow:!1},Object(x.jsx)(o.EuiToolTip,{content:s.i18n.translate("xpack.ml.dataframe.analyticsList.progressOfPhase",{defaultMessage:"Progress of phase {currentPhase}: {progress}%",values:{currentPhase:t,progress:a}})},Object(x.jsx)(o.EuiProgress,{value:a,max:100,color:"primary",size:"m","data-test-subj":"mlAnalyticsTableProgress"})))),!1)},width:"130px","data-test-subj":"mlAnalyticsTableColumnProgress"},W=({jobId:e})=>{const t=Object(b.c)({page:A.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,pageState:{jobId:e}});return Object(x.jsx)(o.EuiLink,{href:t},e)},H=(e,t,a=!1,n=!0,i,d=(()=>{}))=>{const{actions:u,modals:p}=B(a);const m=[{name:Object(x.jsx)(o.EuiScreenReaderOnly,null,Object(x.jsx)("p",null,Object(x.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each job"}))),align:o.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:a=>Object(x.jsx)(o.EuiButtonIcon,{onClick:()=>function(a){const n=e.indexOf(a.config.id);-1!==n?(e.splice(n,1),t([...e])):e.push(a.config.id),t([...e])}(a),"aria-label":e.includes(a.config.id)?s.i18n.translate("xpack.ml.dataframe.analyticsList.rowCollapse",{defaultMessage:"Hide details for {analyticsId}",values:{analyticsId:a.config.id}}):s.i18n.translate("xpack.ml.dataframe.analyticsList.rowExpand",{defaultMessage:"Show details for {analyticsId}",values:{analyticsId:a.config.id}}),iconType:e.includes(a.config.id)?"arrowUp":"arrowDown"}),"data-test-subj":"mlAnalyticsTableRowDetailsToggle"},{field:c.c.id,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.id",{defaultMessage:"ID"}),sortable:e=>e.id,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnId",scope:"row",render:e=>a?Object(x.jsx)(W,{jobId:e}):e},{field:c.c.description,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.description",{defaultMessage:"Description"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnJobDescription"},{field:c.c.memoryStatus,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.memoryStatus",{defaultMessage:"Memory status"}),truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnJobMemoryStatus"},{field:c.c.configSourceIndex,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.sourceIndex",{defaultMessage:"Source index"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnSourceIndex"},{field:c.c.configDestIndex,name:s.i18n.translate("xpack.ml.dataframe.analyticsList.destinationIndex",{defaultMessage:"Destination index"}),sortable:!0,truncateText:!0,"data-test-subj":"mlAnalyticsTableColumnDestIndex"},{name:s.i18n.translate("xpack.ml.dataframe.analyticsList.type",{defaultMessage:"Type"}),sortable:e=>Object(l.h)(e.config.analysis),truncateText:!0,render:e=>G(Object(l.h)(e.config.analysis)),width:"150px","data-test-subj":"mlAnalyticsTableColumnType"},{name:s.i18n.translate("xpack.ml.dataframe.analyticsList.status",{defaultMessage:"Status"}),sortable:e=>e.stats.state,truncateText:!0,render:e=>U(e.stats.state,e.stats.failure_reason),width:"100px","data-test-subj":"mlAnalyticsTableColumnStatus"},q,{name:s.i18n.translate("xpack.ml.dataframe.analyticsList.tableActionLabel",{defaultMessage:"Actions"}),actions:u,width:!0===a?"100px":"150px","data-test-subj":"mlAnalyticsTableColumnActions"}];return!0===a&&(i&&m.splice(m.length-1,0,{name:s.i18n.translate("xpack.ml.jobsList.analyticsSpacesLabel",{defaultMessage:"Spaces"}),render:e=>{var t;return Array.isArray(e.spaceIds)?Object(x.jsx)(V.a,{spacesApi:i,spaceIds:null!==(t=e.spaceIds)&&void 0!==t?t:[],jobId:e.id,jobType:"data-frame-analytics",refresh:d}):null},width:"90px","data-test-subj":"mlAnalyticsTableColumnSpaces"}),!1===n&&m.pop()),{columns:m,modals:p}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return le})),a.d(t,"a",(function(){return ce}));var n=a(16),i=a.n(n),s=a(49),r=a(45),o=a(89),l=a(389),c=a(72),d=a(168),u=a(81);const p=e=>{const{services:t}=Object(c.b)(),[a]=Object(o.c)("_g"),{timefilter:i}=t.data.query.timefilter,{refresh:s}=Object(u.w)();Object(n.useEffect)((()=>{let t=null;const n=i.getRefreshIntervalUpdate$().subscribe(r);function r(){const{value:a,pause:n}=i.getRefreshInterval();n?o():function(a){if(o(),a>=d.c){e(!1);const n=window.setInterval((()=>{s()}),a);t=n}}(a),s()}function o(){e(!0),null!==t&&window.clearInterval(t)}return i.disableTimeRangeSelector(),i.enableAutoRefreshSelector(),function(){var e;const t=null!==(e=null==a?void 0:a.refreshInterval)&&void 0!==e?e:i.getRefreshInterval(),{value:n}=t;0===n&&i.setRefreshInterval({pause:!1,value:d.a});r()}(),()=>{n.unsubscribe(),o()}}),[])};var m=a(280),b=a(281),f=a(282),h=a(2),g=a(44),j=a(12);const x=({jobId:e,modelId:t,selectedTabId:a})=>{const i=Object(c.e)(),s=Object(n.useMemo)((()=>{const a=[{id:"data_frame_analytics",name:h.i18n.translate("xpack.ml.dataframe.jobsTabLabel",{defaultMessage:"Jobs"}),path:"/data_frame_analytics",testSubj:"mlAnalyticsJobsTab"}];return void 0===e&&void 0===t||a.push({id:"map",name:h.i18n.translate("xpack.ml.dataframe.mapTabLabel",{defaultMessage:"Map"}),path:"/data_frame_analytics/map",testSubj:""}),a}),[void 0!==e]),r=Object(n.useCallback)((async e=>{await i(e.path,!0)}),[i]);return Object(j.jsx)(g.EuiTabs,null,s.map((e=>Object(j.jsx)(g.EuiTab,{key:`tab-${e.id}`,isSelected:e.id===a,onClick:r.bind(null,e),"data-test-subj":e.testSubj},e.name))))};var v=a(475),y=a.n(v),O=a(481),E=a.n(O),w=a(90),M=a(606),S=a.n(M),_=a(607),T=a.n(_),C=a(608),k=a.n(C);const F="#C5CCD7",I="ellipse",D="rectangle",A="diamond",L="triangle";const R=e=>({autoungrabify:!0,boxSelectionEnabled:!1,maxZoom:3,minZoom:.2,style:[{selector:"node",style:{"background-color":t=>t.data("isRoot")?e.euiColorWarning:e.euiColorGhost,"background-height":"60%","background-width":"60%","border-color":t=>function(e,t){if(e.selected())return t.euiColorPrimary;switch(e.data("type")){case w.e.ANALYTICS:return t.euiColorSuccess;case w.e.TRANSFORM:return t.euiColorVis1;case w.e.INDEX:return t.euiColorVis2;case w.e.TRAINED_MODEL:return t.euiColorVis3;default:return t.euiColorMediumShade}}(t,e),"border-style":"solid","background-image":e=>function(e){switch(e.data("analysisType")){case w.a.OUTLIER_DETECTION:return T.a;case w.a.CLASSIFICATION:return S.a;case w.a.REGRESSION:return k.a;default:return}}(e),"border-width":e=>e.selected()?4:3,color:e.euiTextColors.default,"font-family":"Inter UI, Segoe UI, Helvetica, Arial, sans-serif","font-size":e.euiFontSizeXS,"min-zoomed-font-size":parseInt(e.euiSizeL,10),label:"data(label)",shape:e=>function(e,t){switch(e.data("type")){case w.e.ANALYTICS:return I;case w.e.TRANSFORM:return D;case w.e.INDEX:return A;case w.e.TRAINED_MODEL:return L;default:return I}}(e),"text-background-color":e.euiColorLightestShade,"text-background-opacity":0,"text-background-padding":e.paddingSizes.xs,"text-background-shape":"roundrectangle","text-margin-y":parseInt(e.paddingSizes.s,10),"text-max-width":"200px","text-valign":"bottom","text-wrap":"wrap"}},{selector:"edge",style:{"curve-style":"taxi","taxi-direction":"rightward","line-color":F,"overlay-opacity":0,"target-arrow-color":F,"target-arrow-shape":"triangle","target-distance-from-node":e.paddingSizes.xs,width:1,"source-arrow-shape":"none"}}]});y.a.use(E.a);const N=Object(n.createContext)(void 0);function P({children:e,elements:t,theme:a,height:i,itemsDeleted:s,resetCy:r,style:o,width:l}){const[c,d]=function(e){const[t,a]=Object(n.useState)(),i=Object(n.useRef)(null);return Object(n.useEffect)((()=>{t||a(y()({...e,container:i.current}))}),[e,t]),Object(n.useEffect)((()=>()=>{t&&t.destroy()}),[t]),[i,t]}({...R(a),elements:t}),u={...o,height:i},p=Object(n.useCallback)((e=>{d&&i>0&&setTimeout((()=>d.layout(function(e,t){return{name:"dagre",rankDir:"LR",fit:!0,padding:20,spacingFactor:.95,boundingBox:{x1:0,y1:0,w:e,h:t}}}(l,i)).run()),150)}),[d,i,l]);return Object(n.useEffect)((()=>(d&&d.on("data",p),()=>{d&&d.removeListener("data",void 0,p)})),[d,t,i,l]),Object(n.useEffect)((()=>{d&&(!1===s||d.elements().remove(),d.add(t),d.trigger("data"))}),[d,t]),Object(n.useEffect)((()=>{d&&d.reset()}),[d,r]),Object(j.jsx)(N.Provider,{value:d},Object(j.jsx)("div",{ref:c,style:u,"data-test-subj":"mlPageDataFrameAnalyticsMapCytoscape"},e))}var z=a(54),B=a.n(z),J=a(82),V=a(0),U=a(76),G=a(96),q=a(157),W=a(394),H=a(285);function Y(e){return Object.entries(e).map((([e,t])=>{let a;return a="create_time"===e?Object(J.c)(1e3*B()(t).unix()):"object"==typeof t?Object(j.jsx)(g.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s"},JSON.stringify(t,null,2)):t,{title:e,description:a}}))}const $=i.a.memo((({details:e,getNodeData:t,modelId:a,refreshJobsCallback:i,updateElements:s})=>{const[o,l]=Object(n.useState)(!1),[d,u]=Object(n.useState)(),[p,m]=Object(n.useState)(!1),[b,f]=Object(n.useState)(!1),x=Object(U.e)("canCreateDataFrameAnalytics"),v=Object(U.e)("canDeleteDataFrameAnalytics"),y=Object(W.b)(v),{closeDeleteJobCheckModal:O,deleteItem:E,deleteTargetIndex:M,isModalVisible:S,isDeleteJobCheckModalVisible:_,item:T,jobType:C,openModal:k,openDeleteJobCheckModal:F}=y,{toasts:I}=Object(c.f)(),D=Object(c.d)(),A=Object(c.e)(),L=Object(q.e)(),R=Object(n.useContext)(N),P=Object(n.useCallback)((()=>{R&&R.elements().unselect(),l(!1),u(void 0)}),[R,u]),z=null==d?void 0:d.data("id"),B=null==d?void 0:d.data("label"),J=null==d?void 0:d.data("type"),$=Object(n.useCallback)((async()=>{const e=await Object(G.d)(B);if(null!==e){const t=await D.getUrl({page:V.b.DATA_FRAME_ANALYTICS_CREATE_JOB,pageState:{index:e}});await A(t)}else I.addDanger(h.i18n.translate("xpack.ml.dataframe.analyticsMap.flyout.dataViewMissingMessage",{defaultMessage:"To create a job from this index please create a data view for {indexTitle}.",values:{indexTitle:B}}))}),[B]),X=Object(n.useCallback)((async()=>{var t;L({config:e[z],stats:null===(t=e[z])||void 0===t?void 0:t.stats})}),[z]);if(Object(n.useEffect)((()=>{const e=e=>{u(e.target),l(!0)};return R&&(R.on("select","node",e),R.on("unselect","node",P)),()=>{R&&(R.removeListener("select","node",e),R.removeListener("unselect","node",P))}}),[R,P]),Object(n.useEffect)((function(){if(!1===S&&!0===E||!0===b){let t;if(!0===M||!0===b){t=`${e[z].dest.index}-${w.e.INDEX}`}s(z,B,t),l(!1)}}),[S,E,b]),!1===o)return null;const K=Object(j.jsx)(g.EuiButton,{size:"s",iconType:"arrowDown",iconSide:"right",onClick:()=>{m(!p)}},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.nodeActionsButton",defaultMessage:"Node actions"})),Q=[...J===w.e.ANALYTICS?[Object(j.jsx)(g.EuiContextMenuItem,{key:`${z}-delete`,icon:"trash",disabled:!v,onClick:()=>{var t;F({config:e[z],stats:null===(t=e[z])||void 0===t?void 0:t.stats})}},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.deleteJobButton",defaultMessage:"Delete job"})),Object(j.jsx)(g.EuiContextMenuItem,{key:`${z}-clone`,icon:"copy",disabled:!x,onClick:X},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.cloneJobButton",defaultMessage:"Clone job"}))]:[],...J===w.e.INDEX?[Object(j.jsx)(g.EuiContextMenuItem,{disabled:!x,key:`${z}-create`,icon:"plusInCircle",onClick:$},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.createJobButton",defaultMessage:"Create job from this index"}))]:[],...a===B||J!==w.e.ANALYTICS&&J!==w.e.INDEX?[]:[Object(j.jsx)(g.EuiContextMenuItem,{key:`${z}-fetch-related`,icon:"branch",onClick:()=>{t({id:B,type:J}),R&&R.elements().unselect(),l(!1),m(!1)}},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyout.fetchRelatedNodesButton",defaultMessage:"Fetch related nodes"}))]];return Object(j.jsx)(g.EuiPortal,null,Object(j.jsx)(g.EuiFlyout,{ownFocus:!0,size:"m",onClose:P,"data-test-subj":"mlAnalyticsJobMapFlyout"},Object(j.jsx)(g.EuiFlyoutHeader,null,Object(j.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"xs"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiTitle,{size:"s"},Object(j.jsx)("h3",{"data-test-subj":"mlDataFrameAnalyticsNodeDetailsTitle"},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.flyoutHeaderTitle",defaultMessage:"Details for {type} {id}",values:{id:B,type:J}})))))),Object(j.jsx)(g.EuiFlyoutBody,null,Object(j.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"s"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiDescriptionList,{compressed:!0,type:"column",listItems:Y("index-pattern"===J?e[z][B]:e[z])})))),Object(j.jsx)(g.EuiFlyoutFooter,null,J!==w.e.TRAINED_MODEL&&Object(j.jsx)(g.EuiPopover,{button:K,isOpen:p,closePopover:()=>{m(!1)},panelPaddingSize:"s",anchorPosition:"downLeft"},Object(j.jsx)(g.EuiContextMenuPanel,{items:Q})))),_&&T&&Object(j.jsx)(H.a,{jobType:C,jobIds:[T.config.id],onCloseCallback:O,canDeleteCallback:()=>{k(y.item),O()},refreshJobsCallback:i,setDidUntag:f}),S&&Object(j.jsx)(W.a,y))})),X=({theme:e})=>{const[t,a]=Object(n.useState)(!1);return Object(j.jsx)(g.EuiFlexGroup,{className:"mlJobMapLegend__container",alignItems:"center","data-test-subj":"mlPageDataFrameAnalyticsMapLegend"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)("span",{className:"mlJobMapLegend__sourceNode"})),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiText,{size:"xs",color:"subdued"},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.rootNodeLabel",defaultMessage:"source node"}))))),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)("span",{className:"mlJobMapLegend__indexPattern"})),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiText,{size:"xs",color:"subdued"},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.indexLabel",defaultMessage:"index"}))))),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)("span",{className:"mlJobMapLegend__transform"})),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiText,{size:"xs",color:"subdued"},w.e.TRANSFORM)))),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)("span",{style:{display:"inline-block",width:"0px",height:"0px",borderLeft:`${e.euiSizeS} solid ${e.euiPageBackgroundColor}`,borderRight:`${e.euiSizeS} solid ${e.euiPageBackgroundColor}`,borderBottom:`${e.euiSizeM} solid ${e.euiColorVis3}`}})),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiText,{size:"xs",color:"subdued"},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.trainedModelLabel",defaultMessage:"trained model"}))))),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)("span",{className:"mlJobMapLegend__analytics"})),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiText,{size:"xs",color:"subdued"},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.legend.analyticsJobLabel",defaultMessage:"analytics jobs"}))),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiPopover,{ownFocus:!0,button:Object(j.jsx)(g.EuiButtonIcon,{iconSize:"s",onClick:()=>a(!t),iconType:t?"arrowUp":"arrowDown","aria-label":h.i18n.translate("xpack.ml.dataframe.analyticsMap.legend.showJobTypesAriaLabel",{defaultMessage:"Show job types"})}),isOpen:t,closePopover:()=>a(!1)},Object(j.jsx)(i.a.Fragment,null,Object(j.jsx)(g.EuiListGroup,{flush:!0},Object(j.jsx)(g.EuiListGroupItem,{iconType:"outlierDetectionJob",label:"Outlier detection",size:"xs"}),Object(j.jsx)(g.EuiListGroupItem,{iconType:"regressionJob",label:"Regression",size:"xs"}),Object(j.jsx)(g.EuiListGroupItem,{iconType:"classificationJob",label:"Classification",size:"xs"}))))))))))};var K=a(119),Q=a(609),Z=a.n(Q);var ee=a(8),te=a(73);const ae=()=>{const[e,t]=Object(n.useState)(!1),[a,i]=Object(n.useState)([]),[s,r]=Object(n.useState)({}),[o,l]=Object(n.useState)(),[c,d]=Object(n.useState)();return{elements:a,error:o,fetchAndSetElementsWrapper:async e=>{const{analyticsId:n,id:o,modelId:c,type:u}=null!=e?e:{},p=void 0!==o;let m;m=void 0!==o?o:void 0!==c?c:n,await(async(e,n,o)=>{t(!0);const c=await te.ml.dataFrameAnalytics.getDataFrameAnalyticsMap(e,n,o),{elements:u,details:p,error:m}=c;if(null!==m&&(t(!1),l(m)),0===(null==u?void 0:u.length)&&d(h.i18n.translate("xpack.ml.dataframe.analyticsMap.emptyResponseMessage",{defaultMessage:"No related analytics jobs found for {id}.",values:{id:e}})),(null==u?void 0:u.length)>0)if(!1===n)i(u),r(p);else{const e=Object(ee.uniqWith)([...u,...a],ee.isEqual);i(e),r({...p,...s})}t(!1)})(m,p,void 0!==c&&!1===p?w.e.TRAINED_MODEL:u)},isLoading:e,message:c,nodeDetails:s,setElements:i,setError:l}},ne=({analyticsId:e,modelId:t})=>Object(j.jsx)(g.EuiTitle,{size:"xs"},Object(j.jsx)("span",{"data-test-subj":"mlPageDataFrameAnalyticsMapTitle"},e?Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.analyticsIdTitle",defaultMessage:"Map for analytics ID {analyticsId}",values:{analyticsId:e}}):Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsMap.modelIdTitle",defaultMessage:"Map for trained model ID {modelId}",values:{modelId:t}}))),ie=({analyticsId:e,modelId:t})=>{const[a,i]=Object(n.useState)(!1),[s,o]=Object(n.useState)(!1),{elements:l,error:d,fetchAndSetElementsWrapper:u,isLoading:p,message:m,nodeDetails:b,setElements:f,setError:x}=ae(),{services:{notifications:v,application:{navigateToUrl:y}}}=Object(c.b)(),O=Object(c.d)(),{euiTheme:E}=Object(K.e)();Object(n.useEffect)((()=>{u({analyticsId:e,modelId:t})}),[e,t]),Object(n.useEffect)((()=>{void 0!==m&&v.toasts.add(m)}),[m]),void 0!==d&&(v.toasts.addDanger(h.i18n.translate("xpack.ml.dataframe.analyticsMap.fetchDataErrorMessage",{defaultMessage:"Unable to fetch some data. An error occurred: {error}",values:{error:JSON.stringify(d)}})),x(void 0));const{ref:M,width:S,height:_}=function(){const e=Object(n.useRef)(null),t=Z()().height;if(!e.current)return{ref:e,width:0,height:0};const{top:a,width:i}=e.current.getBoundingClientRect();return{ref:e,width:i,height:t-a}}(),T=()=>u({analyticsId:e,modelId:t});return Object(j.jsx)("div",{"data-test-subj":"mlPageDataFrameAnalyticsMap"},Object(j.jsx)(g.EuiSpacer,{size:"m"}),Object(j.jsx)(g.EuiFlexGroup,{direction:"column",gutterSize:"none",justifyContent:"spaceBetween"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(ne,{analyticsId:e,modelId:t})),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(X,{theme:E})))),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiFlexGroup,{gutterSize:"xs",component:"span"},Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiButtonEmpty,{size:"xs","data-test-subj":"mlAnalyticsRefreshMapButton"+(p?" loading":" loaded"),onClick:T,isLoading:p},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.refreshMapButtonLabel",defaultMessage:"Refresh"}))),Object(j.jsx)(g.EuiFlexItem,{grow:!1},Object(j.jsx)(g.EuiButtonEmpty,{size:"xs","data-test-subj":"mlAnalyticsResetGraphButton",onClick:()=>o(!s)},Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.resetMapButtonLabel",defaultMessage:"Reset"})))))),Object(j.jsx)("div",{style:{height:_-parseInt(E.gutterTypes.gutterLarge,10)-20},ref:M},Object(j.jsx)(P,{theme:E,height:_-20,elements:l,width:S,style:(C=E,{background:`linear-gradient(\n  90deg,\n  ${C.euiPageBackgroundColor}\n    calc(${C.euiSizeL} - calc(${C.euiSizeXS} / 2)),\n  transparent 1%\n)\ncenter,\nlinear-gradient(\n  ${C.euiPageBackgroundColor}\n    calc(${C.euiSizeL} - calc(${C.euiSizeXS} / 2)),\n  transparent 1%\n)\ncenter,\n${C.euiColorLightShade}`,backgroundSize:`${C.euiSizeL} ${C.euiSizeL}`,margin:`-${C.gutterTypes.gutterLarge}`,marginTop:0}),itemsDeleted:a,resetCy:s},Object(j.jsx)($,{details:b,getNodeData:u,modelId:t,updateElements:(t,a,n)=>{if(a===e)(async()=>{const e=await O.getUrl({page:V.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE});await y(e)})();else{const e=l.filter((e=>{let i=e.data.id!==t&&e.data.target!==t&&e.data.source!==t;var s,r,o;void 0!==e.data.id&&e.data.type===w.e.TRAINED_MODEL&&(i=i&&(null===(s=b[e.data.id])||void 0===s||null===(r=s.metadata)||void 0===r||null===(o=r.analytics_config)||void 0===o?void 0:o.id)!==a);return void 0!==n?i&&e.data.id!==n&&e.data.target!==n&&e.data.source!==n:i}));i(!0),f(e)}},refreshJobsCallback:T}))));var C};var se=a(103),re=a(111),oe=a(91);const le=()=>({pageIndex:0,pageSize:10,sortField:se.c.id,sortDirection:"asc"}),ce=()=>{var e,t;const[a,d]=Object(n.useState)(!1),[h]=Object(o.c)("_g"),[g,v]=Object(o.b)(V.b.DATA_FRAME_ANALYTICS_JOBS_MANAGE,le());p(d);const[y,O]=Object(n.useState)(!1),{refresh:E}=Object(u.w)({isLoading:O}),w=Object(s.useLocation)(),M=Object(n.useMemo)((()=>w.pathname.split("/").pop()),[w]),S=null==h||null===(e=h.ml)||void 0===e?void 0:e.jobId,_=null==h||null===(t=h.ml)||void 0===t?void 0:t.modelId,{services:{docLinks:T}}=Object(c.b)(),C=T.links.ml.dataFrameAnalytics;return Object(j.jsx)(i.a.Fragment,null,Object(j.jsx)(oe.a,null,Object(j.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.title",defaultMessage:"Data Frame Analytics"})),Object(j.jsx)(m.a,null),Object(j.jsx)(b.a,{jobType:"data-frame-analytics",onCloseFlyout:E,forceRefresh:y}),Object(j.jsx)(f.a,null),Object(j.jsx)(x,{selectedTabId:M,jobId:S,modelId:_}),"map"===M&&(S||_)&&Object(j.jsx)(ie,{analyticsId:S,modelId:_}),"data_frame_analytics"===M&&Object(j.jsx)(l.a,{blockRefresh:a,pageState:g,updatePageState:v}),Object(j.jsx)(re.a,{docLink:C}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return N}));var n=a(5),i=a.n(n),s=a(16),r=a.n(s),o=a(44),l=a(45),c=a(2),d=a(72),u=a(156);const p="KIBANA_DASHBOARD",m="KIBANA_DISCOVER",b="OTHER",f={AUTO:"auto",INTERVAL:"interval"};var h=a(59),g=a.n(h),j=a(445),x=a.n(j),v=a(62),y=a(80),O=a(29),E=a(73),w=a(98),M=a(26);function S(e,t,a){const n={queryFieldNames:[]};let i=b;void 0!==t&&t.length>0?(i=p,n.dashboardId=t[0].id):void 0!==a&&a.length>0&&(i=m);const s=e.datafeed_config;if(void 0!==a&&a.length>0&&void 0!==s&&void 0!==s.indices&&s.indices.length>0){var r;const e=s.indices.join(),t=null===(r=a.find((t=>t.title===e)))||void 0===r?void 0:r.id;n.discoverIndexPatternId=t}return{label:"",type:i,timeRange:{type:f.AUTO,interval:""},kibanaSettings:n,otherUrlSettings:{urlValue:""}}}function _(e){const t=e.analysis_config.influencers,a=e.analysis_config.detectors,n=[];return void 0!==t&&n.push(...t),a.forEach(((t,a)=>{Object(y.h)(e,a).forEach((e=>{-1===n.indexOf(e)&&n.push(e)}))})),n}function T(e){if(e.type===f.INTERVAL){return null!==Object(O.a)(e.interval)}return!0}function C(e){if(e.type===p)return function(e){return new Promise(((t,a)=>{const{dashboardId:n,queryFieldNames:i}=e.kibanaSettings;Object(M.i)().get("dashboard",n).then((a=>{let s,r=[];const o=a.get("kibanaSavedObjectMeta.searchSourceJSON");if(void 0!==o){const e=JSON.parse(o);void 0!==e.filter&&(r=e.filter),s=e.query}const l=k(i);void 0!==l&&(s=l);return Object(M.e)()(v.DASHBOARD_APP_URL_GENERATOR).createUrl({dashboardId:n,timeRange:{from:"$earliest$",to:"$latest$",mode:"absolute"},filters:r,query:s,useHash:!1}).then((a=>{const n={url_name:e.label,url_value:decodeURIComponent(`dashboards${x.a.parse(a).hash}`),time_range:f.AUTO};e.timeRange.type===f.INTERVAL&&(n.time_range=e.timeRange.interval),t(n)}))})).catch((e=>{a(e)}))}))}(e);if(e.type===m)return Promise.resolve(function(e){const{discoverIndexPatternId:t,queryFieldNames:a}=e.kibanaSettings,n=g.a.encode({time:{from:"$earliest$",to:"$latest$",mode:"absolute"}}),i={index:t},s=k(a);void 0!==s&&(i.query=s);const r=g.a.encode(i),o=`discover#/?_g=${n}&_a=${r}`,l={url_name:e.label,url_value:o,time_range:f.AUTO};e.timeRange.type===f.INTERVAL&&(l.time_range=e.timeRange.interval);return l}(e));{const t={url_name:e.label,url_value:e.otherUrlSettings.urlValue};return Promise.resolve(t)}}function k(e){let t;if(void 0!==e&&e.length>0){let a="";e.forEach(((e,t)=>{t>0&&(a+=" and "),a+=`${Object(w.c)(e)}:"$${e}$"`})),t={language:"kuery",query:a}}return t}async function F(e,t){const a=Object(O.a)(e.analysis_config.bucket_span).asSeconds();let n=t.url_value;const i={query:{bool:{must:[{term:{job_id:e.job_id}},{term:{result_type:"record"}}]}},size:1,_source:{excludes:[]},sort:[{record_score:{order:"desc"}}]};let s;try{s=await E.ml.results.anomalySearch({body:i},[e.job_id])}catch(e){}if(s&&s.hits.total.value>0){const e=s.hits.hits[0]._source;return n=Object(u.e)(t,a,e,"timestamp"),n}{let{datafeed_config:i,...s}=e;try{const[{jobs:t},{datafeeds:a}]=await Promise.all([E.ml.getJobs({jobId:e.job_id}),E.ml.getDatafeeds({datafeedId:e.datafeed_config.datafeed_id})]);i=a[0],s=t[0]}catch(e){}if(void 0===s||void 0===i)return n;const r=await E.ml.jobs.datafeedPreview(void 0,s,i),o=e.data_description.time_field,l=r[0];return void 0!==l&&(n=Object(u.e)(t,a,l,o)),n}}var I=a(12);const D=({job:e,customUrls:t,setCustomUrls:a})=>{const{services:{http:n,notifications:i}}=Object(d.b)(),[r,p]=Object(s.useState)(null),m=t.map(((s,d)=>{const m=s.url_name,b=[...t];b.splice(d,1);const h=!Object(u.b)(m,b),g=h?[c.i18n.translate("xpack.ml.customUrlEditorList.labelIsNotUniqueErrorMessage",{defaultMessage:"A unique label must be supplied"})]:[],j=!function(e){return void 0===e||0===e.length||e===f.AUTO||null!==Object(O.a)(e)}(s.time_range),x=j?[c.i18n.translate("xpack.ml.customUrlEditorList.invalidTimeRangeFormatErrorMessage",{defaultMessage:"Invalid format"})]:[];return Object(I.jsx)(o.EuiFlexGroup,{key:`url_${d}`,"data-test-subj":`mlJobEditCustomUrlItem_${d}`},Object(I.jsx)(o.EuiFlexItem,{grow:!1},Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.labelLabel",defaultMessage:"Label"}),isInvalid:h,error:g,"data-test-subj":"mlJobEditCustomUrlItemLabel"},Object(I.jsx)(o.EuiFieldText,{value:m,isInvalid:h,onChange:e=>((e,n)=>{n<t.length&&(t[n]={...t[n],url_name:e.target.value},a(t))})(e,d),"data-test-subj":`mlJobEditCustomUrlLabelInput_${d}`}))),Object(I.jsx)(o.EuiFlexItem,null,Object(I.jsx)(o.EuiFormRow,{fullWidth:!0,label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.urlLabel",defaultMessage:"URL"})},d===r?Object(I.jsx)(o.EuiTextArea,{inputRef:e=>{e&&e.focus()},fullWidth:!0,value:s.url_value,onChange:e=>((e,n)=>{n<t.length&&(t[n]={...t[n],url_value:e.target.value},a(t))})(e,d),onBlur:()=>{p(null)},"data-test-subj":`mlJobEditCustomUrlTextarea_${d}`}):Object(I.jsx)(o.EuiFieldText,{fullWidth:!0,value:s.url_value,readOnly:!0,onFocus:()=>p(d),"data-test-subj":`mlJobEditCustomUrlInput_${d}`}))),Object(I.jsx)(o.EuiFlexItem,{grow:!1},Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.timeRangeLabel",defaultMessage:"Time range"}),error:x,isInvalid:j},Object(I.jsx)(o.EuiFieldText,{value:s.time_range||"",isInvalid:j,placeholder:f.AUTO,onChange:e=>((e,n)=>{if(n<t.length){t[n]={...t[n]};const i=e.target.value;void 0!==i&&i.length>0?t[n].time_range=i:delete t[n].time_range,a(t)}})(e,d)}))),Object(I.jsx)(o.EuiFlexItem,{grow:!1},Object(I.jsx)(o.EuiFormRow,{hasEmptyLabelSpace:!0},Object(I.jsx)(o.EuiToolTip,{content:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.testCustomUrlTooltip",defaultMessage:"Test custom URL"})},Object(I.jsx)(o.EuiButtonIcon,{size:"s",color:"primary",onClick:()=>(a=>{a<t.length&&F(e,t[a]).then((e=>{Object(u.d)(e,t[a],n.basePath.get())})).catch((e=>{console.error("Error obtaining URL for test:",e);const{toasts:t}=i;t.addDanger(c.i18n.translate("xpack.ml.customUrlEditorList.obtainingUrlToTestConfigurationErrorMessage",{defaultMessage:"An error occurred obtaining the URL to test the configuration"}))}))})(d),iconType:"popout","aria-label":c.i18n.translate("xpack.ml.customUrlEditorList.testCustomUrlAriaLabel",{defaultMessage:"Test custom URL"}),"data-test-subj":"mlJobEditTestCustomUrlButton"})))),Object(I.jsx)(o.EuiFlexItem,{grow:!1},Object(I.jsx)(o.EuiFormRow,{hasEmptyLabelSpace:!0},Object(I.jsx)(o.EuiToolTip,{content:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlEditorList.deleteCustomUrlTooltip",defaultMessage:"Delete custom URL"})},Object(I.jsx)(o.EuiButtonIcon,{size:"s",color:"danger",onClick:()=>(e=>{e<t.length&&(t.splice(e,1),a(t))})(d),iconType:"trash","aria-label":c.i18n.translate("xpack.ml.customUrlEditorList.deleteCustomUrlAriaLabel",{defaultMessage:"Delete custom URL"}),"data-test-subj":`mlJobEditDeleteCustomUrlButton_${d}`})))))}));return Object(I.jsx)("div",{"data-test-subj":"mlJobEditCustomUrlsList"},m)};const A=({customUrl:e,setEditCustomUrl:t,savedCustomUrls:a,dashboards:n,dataViewListItems:i,queryEntityFieldNames:s})=>{if(void 0===e)return null;const{label:d,type:h,timeRange:g,kibanaSettings:j,otherUrlSettings:x}=e,v=n.map((e=>({value:e.id,text:e.title}))),y=i.map((({id:e,title:t})=>({value:e,text:t}))),O=s.map((e=>({label:e})));let E=[];if(void 0!==j&&void 0!==j.queryFieldNames){E=j.queryFieldNames.map((e=>({label:e})))}const w=Object.values(f).map((e=>({value:e,text:e}))),M=!Object(u.b)(d,a),S=M?[c.i18n.translate("xpack.ml.customUrlsEditor.invalidLabelErrorMessage",{defaultMessage:"A unique label must be supplied"})]:[],_=!T(g),C=_?[c.i18n.translate("xpack.ml.customUrlsList.invalidIntervalFormatErrorMessage",{defaultMessage:"Invalid interval format"})]:[];return Object(I.jsx)(r.a.Fragment,null,Object(I.jsx)(o.EuiTitle,{size:"xs"},Object(I.jsx)("h4",null,Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.createNewCustomUrlTitle",defaultMessage:"Create new custom URL"}))),Object(I.jsx)(o.EuiSpacer,{size:"m"}),Object(I.jsx)(o.EuiForm,{className:"ml-edit-url-form","data-test-subj":"mlJobCustomUrlForm"},Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.labelLabel",defaultMessage:"Label"}),className:"url-label",error:S,isInvalid:M,display:"rowCompressed"},Object(I.jsx)(o.EuiFieldText,{name:"label",value:d,onChange:a=>{t({...e,label:a.target.value})},isInvalid:M,compressed:!0,"data-test-subj":"mlJobCustomUrlLabelInput"})),Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.linkToLabel",defaultMessage:"Link to"}),display:"rowCompressed"},Object(I.jsx)(o.EuiRadioGroup,{options:[{id:p,label:c.i18n.translate("xpack.ml.customUrlEditor.kibanaDashboardLabel",{defaultMessage:"Kibana dashboard"})},{id:m,label:c.i18n.translate("xpack.ml.customUrlEditor.discoverLabel",{defaultMessage:"Discover"})},{id:b,label:c.i18n.translate("xpack.ml.customUrlEditor.otherLabel",{defaultMessage:"Other"})}],idSelected:h,onChange:a=>{t({...e,type:a})},className:"url-link-to-radio","data-test-subj":"mlJobCustomUrlLinkToTypeInput"})),h===p&&Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.dashboardNameLabel",defaultMessage:"Dashboard name"}),display:"rowCompressed"},Object(I.jsx)(o.EuiSelect,{options:v,value:j.dashboardId,onChange:a=>{const n=e.kibanaSettings;t({...e,kibanaSettings:{...n,dashboardId:a.target.value}})},"data-test-subj":"mlJobCustomUrlDashboardNameInput",compressed:!0})),h===m&&Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.dataViewLabel",defaultMessage:"Data view"}),display:"rowCompressed"},Object(I.jsx)(o.EuiSelect,{options:y,value:j.discoverIndexPatternId,onChange:a=>{const n=e.kibanaSettings;t({...e,kibanaSettings:{...n,discoverIndexPatternId:a.target.value}})},"data-test-subj":"mlJobCustomUrlDiscoverIndexPatternInput",compressed:!0})),(h===p||h===m)&&O.length>0&&Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.queryEntitiesLabel",defaultMessage:"Query entities"})},Object(I.jsx)(o.EuiComboBox,{placeholder:c.i18n.translate("xpack.ml.customUrlsEditor.selectEntitiesPlaceholder",{defaultMessage:"Select entities"}),options:O,selectedOptions:E,onChange:a=>{const n=a.map((e=>e.label)),i=e.kibanaSettings;t({...e,kibanaSettings:{...i,queryFieldNames:n}})},isClearable:!0,"data-test-subj":"mlJobCustomUrlQueryEntitiesInput"})),(h===p||h===m)&&Object(I.jsx)(r.a.Fragment,null,Object(I.jsx)(o.EuiSpacer,{size:"m"}),Object(I.jsx)(o.EuiFlexGroup,null,Object(I.jsx)(o.EuiFlexItem,{grow:!1},Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.timeRangeLabel",defaultMessage:"Time range"}),className:"url-time-range",display:"rowCompressed"},Object(I.jsx)(o.EuiSelect,{options:w,value:g.type,onChange:a=>{const n=e.timeRange;t({...e,timeRange:{...n,type:a.target.value}})},"data-test-subj":"mlJobCustomUrlTimeRangeInput",compressed:!0}))),g.type===f.INTERVAL&&Object(I.jsx)(o.EuiFlexItem,null,Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.intervalLabel",defaultMessage:"Interval"}),className:"url-time-range",error:C,isInvalid:_,display:"rowCompressed"},Object(I.jsx)(o.EuiFieldText,{value:g.interval,onChange:a=>{const n=e.timeRange;t({...e,timeRange:{...n,interval:a.target.value}})},isInvalid:_,"data-test-subj":"mlJobCustomUrlTimeRangeIntervalInput",compressed:!0}))))),h===b&&Object(I.jsx)(o.EuiFormRow,{label:Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.customUrlsEditor.urlLabel",defaultMessage:"URL"}),display:"rowCompressed",fullWidth:!0},Object(I.jsx)(o.EuiTextArea,{fullWidth:!0,rows:2,value:x.urlValue,onChange:a=>{t({...e,otherUrlSettings:{urlValue:a.target.value}})},"data-test-subj":"mlJobCustomUrlOtherTypeUrlInput",compressed:!0}))))};var L=a(46),R=a(306);class custom_urls_CustomUrlsUI extends s.Component{constructor(e){super(e),i()(this,"editNewCustomUrl",(()=>{this.setState((e=>{const{dashboards:t,dataViewListItems:a}=e;return{editorOpen:!0,editorSettings:S(this.props.job,t,a)}}))})),i()(this,"setEditCustomUrl",(e=>{this.setState({editorSettings:e})})),i()(this,"addNewCustomUrl",(()=>{C(this.state.editorSettings).then((e=>{const t=[...this.state.customUrls,e];this.props.setCustomUrls(t),this.setState({editorOpen:!1})})).catch((e=>{console.error("Error building custom URL from settings:",e);const{toasts:t}=this.props.kibana.services.notifications;t.addDanger(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.addNewUrlErrorNotificationMessage",{defaultMessage:"An error occurred building the new custom URL from the supplied settings"}))}))})),i()(this,"onTestButtonClick",(()=>{const{http:{basePath:e},notifications:{toasts:t}}=this.props.kibana.services,a=this.props.job;C(this.state.editorSettings).then((n=>{F(a,n).then((t=>{Object(u.d)(t,n,e.get())})).catch((e=>{console.error("Error obtaining URL for test:",e),t.addWarning(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.getTestUrlErrorNotificationMessage",{defaultMessage:"An error occurred obtaining the URL to test the configuration"}))}))})).catch((e=>{console.error("Error building custom URL from settings:",e),t.addWarning(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.buildUrlErrorNotificationMessage",{defaultMessage:"An error occurred building the custom URL for testing from the supplied settings"}))}))})),i()(this,"closeEditor",(()=>{this.setState({editorOpen:!1})})),this.state={customUrls:[],dashboards:[],dataViewListItems:[],queryEntityFieldNames:[],editorOpen:!1}}static getDerivedStateFromProps(e){return{job:e.job,customUrls:e.jobCustomUrls,queryEntityFieldNames:_(e.job)}}componentDidMount(){const{toasts:e}=this.props.kibana.services.notifications;Object(R.b)(1e3).then((e=>{this.setState({dashboards:e})})).catch((t=>{console.error("Error loading list of dashboards:",t),e.addDanger(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.loadSavedDashboardsErrorNotificationMessage",{defaultMessage:"An error occurred loading the list of saved Kibana dashboards"}))})),Object(R.a)().then((e=>{this.setState({dataViewListItems:e})})).catch((t=>{console.error("Error loading list of dashboards:",t),e.addDanger(c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.loadDataViewsErrorNotificationMessage",{defaultMessage:"An error occurred loading the list of saved data views"}))}))}renderEditor(){var e;const{customUrls:t,editorOpen:a,editorSettings:n,dashboards:i,dataViewListItems:s,queryEntityFieldNames:r}=this.state,d=null!==(e=this.props.editMode)&&void 0!==e?e:"inline",p=Object(I.jsx)(A,{customUrl:n,setEditCustomUrl:this.setEditCustomUrl,savedCustomUrls:t,dashboards:i,dataViewListItems:s,queryEntityFieldNames:r}),m=!a||void 0===n||function(e,t){let a=Object(u.b)(e.label,t);return!0===a&&(a=T(e.timeRange)),a}(n,t),b=Object(I.jsx)(o.EuiButton,{onClick:this.addNewCustomUrl,isDisabled:!m,"data-test-subj":"mlJobAddCustomUrl"},Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addButtonLabel",defaultMessage:"Add"})),f=Object(I.jsx)(o.EuiButtonEmpty,{iconType:"popout",iconSide:"right",onClick:this.onTestButtonClick,isDisabled:!m},Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.testButtonLabel",defaultMessage:"Test"}));return"inline"===d?Object(I.jsx)(o.EuiPanel,{className:"edit-custom-url-panel"},Object(I.jsx)(o.EuiButtonIcon,{color:"text",onClick:this.closeEditor,iconType:"cross","aria-label":c.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrls.closeEditorAriaLabel",{defaultMessage:"Close custom URL editor"}),className:"close-editor-button"}),p,Object(I.jsx)(o.EuiSpacer,{size:"m"}),Object(I.jsx)(o.EuiFlexGroup,null,Object(I.jsx)(o.EuiFlexItem,{grow:!1},b),Object(I.jsx)(o.EuiFlexItem,{grow:!1},f))):Object(I.jsx)(o.EuiModal,{onClose:this.closeEditor,initialFocus:"[name=label]",style:{width:500},"data-test-subj":"mlJobNewCustomUrlFormModal"},Object(I.jsx)(o.EuiModalHeader,null,Object(I.jsx)(o.EuiModalHeaderTitle,null,Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addCustomUrlButtonLabel",defaultMessage:"Add custom URL"}))),Object(I.jsx)(o.EuiModalBody,null,p),Object(I.jsx)(o.EuiModalFooter,null,f,b))}render(){const{customUrls:e,editorOpen:t}=this.state,{editMode:a="inline"}=this.props;return Object(I.jsx)(r.a.Fragment,null,Object(I.jsx)(o.EuiSpacer,{size:"m"}),(!t||"modal"===a)&&Object(I.jsx)(o.EuiButton,{size:"s",onClick:this.editNewCustomUrl,"data-test-subj":"mlJobOpenCustomUrlFormButton"},Object(I.jsx)(l.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.customUrls.addCustomUrlButtonLabel",defaultMessage:"Add custom URL"})),t&&this.renderEditor(),Object(I.jsx)(o.EuiSpacer,{size:"l"}),Object(I.jsx)(D,{job:this.props.job,customUrls:e,setCustomUrls:this.props.setCustomUrls}))}}const N=Object(L.withKibana)(custom_urls_CustomUrlsUI)},function(e,t,a){"use strict";a.d(t,"b",(function(){return y})),a.d(t,"a",(function(){return O}));var n=a(75),i=a.n(n),s=a(16),r=a.n(s),o=a(45),l=a(386),c=a(89),d=a(0),u=a(111),p=a(72),m=a(91),b=a(307),f=a(46),h=a(290),g=a(12);const j=({children:e})=>{const{services:t}=Object(p.b)(),{setHeaderActionMenu:a}=Object(s.useContext)(h.b),n=Object(s.useMemo)((()=>Object(b.c)()),[]);return Object(s.useEffect)((()=>{if(a)return a((e=>Object(f.toMountPoint)(Object(g.jsx)(f.KibanaContextProvider,{services:t},Object(g.jsx)(b.b,{node:n})),{theme$:t.theme.theme$})(e))),()=>{n.unmount(),a(void 0)}}),[n,a,t.theme.theme$]),Object(g.jsx)(b.a,{node:n},e)};var x=a(44);const v=()=>{const e=Object(p.e)(),t=Object(p.d)();return Object(g.jsx)(x.EuiButtonEmpty,{onClick:async()=>{if(!t)return;const a=await t.getUrl({page:d.b.SETTINGS});e(a)},iconType:"gear"},Object(g.jsx)(o.FormattedMessage,{id:"xpack.ml.navMenu.settingsTabLinkText",defaultMessage:"Settings"}))},y=()=>({pageIndex:0,pageSize:10,sortField:"id",sortDirection:"asc"}),O=e=>{const[t,a]=Object(c.b)(d.b.ANOMALY_DETECTION_JOBS_MANAGE,y()),{services:{docLinks:n}}=Object(p.b)(),s=n.links.ml.anomalyDetection;return Object(g.jsx)(r.a.Fragment,null,Object(g.jsx)(m.a,null,Object(g.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.title",defaultMessage:"Anomaly Detection Jobs"})),Object(g.jsx)(j,null,Object(g.jsx)(v,null)),Object(g.jsx)(l.a,i()({},e,{jobsViewState:t,onJobsViewStateUpdate:a})),Object(g.jsx)(u.a,{docLink:s}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(75),i=a.n(n),s=a(5),r=a.n(s),o=a(16),l=a.n(o),c=a(131),d=a.n(c),u=a(8),p=a(44),m=a(2),b=a(45),f=a(191),h=a(144),g=a(82),j=a(12);const x=({annotation:e,detectorDescription:t})=>{const a=[{title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.jobIdTitle",{defaultMessage:"Job ID"}),description:e.job_id},{title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.startTitle",{defaultMessage:"Start"}),description:Object(g.c)(e.timestamp)}];var n,i,s,r,o;(void 0!==e.end_timestamp&&a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.endTitle",{defaultMessage:"End"}),description:Object(g.c)(e.end_timestamp)}),void 0!==e.create_time&&void 0!==e.modified_time)&&(a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdTitle",{defaultMessage:"Created"}),description:Object(g.c)(e.create_time)}),a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.createdByTitle",{defaultMessage:"Created by"}),description:null!==(n=e.create_username)&&void 0!==n?n:""}),a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.lastModifiedTitle",{defaultMessage:"Last modified"}),description:Object(g.c)(e.modified_time)}),a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.modifiedByTitle",{defaultMessage:"Modified by"}),description:null!==(i=e.modified_username)&&void 0!==i?i:""}));(void 0!==t&&a.push({title:m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationDescriptionList.detectorTitle",{defaultMessage:"Detector"}),description:t}),void 0!==e.partition_field_name)&&a.push({title:e.partition_field_name,description:null!==(s=e.partition_field_value)&&void 0!==s?s:""});void 0!==e.over_field_name&&a.push({title:e.over_field_name,description:null!==(r=e.over_field_value)&&void 0!==r?r:""});void 0!==e.by_field_name&&a.push({title:e.by_field_name,description:null!==(o=e.by_field_value)&&void 0!==o?o:""});return Object(j.jsx)(p.EuiDescriptionList,{"data-test-subj":"mlAnnotationDescriptionList",className:"ml-annotation-description-list",type:"column",listItems:a})},v=({cancelAction:e,deleteAction:t,isVisible:a})=>Object(j.jsx)(o.Fragment,null,!0===a&&Object(j.jsx)(p.EuiConfirmModal,{title:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteAnnotationTitle",defaultMessage:"Delete this annotation?"}),onCancel:e,onConfirm:t,cancelButtonText:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.cancelButtonLabel",defaultMessage:"Cancel"}),confirmButtonText:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.deleteAnnotationModal.deleteButtonLabel",defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:p.EUI_MODAL_CONFIRM_BUTTON,className:"eui-textBreakWord","data-test-subj":"mlAnnotationFlyoutConfirmDeleteModal"}));var y=a(73),O=a(26);function E(e){return`${e}_name`}function w(e){return`${e}_value`}var M=a(1),S=a(145);class annotation_flyout_AnnotationFlyoutUI extends o.Component{constructor(...e){super(...e),r()(this,"state",{isDeleteModalVisible:!1,applyAnnotationToSeries:!0,annotationState:null}),r()(this,"annotationSub",null),r()(this,"annotationTextChangeHandler",(e=>{if(null===this.state.annotationState)return;const{annotationUpdatesService:t}=this.props;t.setValue({...this.state.annotationState,annotation:e.target.value})})),r()(this,"cancelEditingHandler",(()=>{const{annotationUpdatesService:e}=this.props;e.setValue(null)})),r()(this,"deleteConfirmHandler",(()=>{this.setState({isDeleteModalVisible:!0})})),r()(this,"deleteHandler",(async()=>{const{annotationState:e}=this.state,t=Object(O.l)();if(null===e||void 0===e._id)return;try{await y.ml.annotations.deleteAnnotation(e._id),t.addSuccess(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.deletedAnnotationNotificationMessage",{defaultMessage:"Deleted annotation for job with ID {jobId}.",values:{jobId:e.job_id}}))}catch(a){t.addDanger(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithDeletingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred deleting the annotation for job with ID {jobId}: {error}",values:{jobId:e.job_id,error:JSON.stringify(a)}}))}this.closeDeleteModal();const{annotationUpdatesService:a}=this.props;a.setValue(null),Object(h.c)()})),r()(this,"closeDeleteModal",(()=>{this.setState({isDeleteModalVisible:!1})})),r()(this,"validateAnnotationText",(()=>{const{annotationState:e}=this.state,t=[];if(null===e)return t;0===e.annotation.trim().length&&t.push(m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.noAnnotationTextError",{defaultMessage:"Enter annotation text"}));const a=e.annotation.length;if(a>f.c){const e=a-f.c;t.push(m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.maxLengthError",{defaultMessage:"{charsOver, number} {charsOver, plural, one {character} other {characters}} above maximum length of {maxChars}",values:{maxChars:f.c,charsOver:e}}))}return t})),r()(this,"saveOrUpdateAnnotation",(()=>{var e,t;const{annotationState:a}=this.state,{chartDetails:n,detectorIndex:i,annotationUpdatesService:s}=this.props;if(null===a)return;const r=Object(u.cloneDeep)(a);this.state.applyAnnotationToSeries&&null!=n&&null!==(e=n.entityData)&&void 0!==e&&e.entities&&(n.entityData.entities.forEach((e=>{const{fieldName:t,fieldValue:a}=e,n=e.fieldType;r[E(n)]=t,r[w(n)]=a})),r.detector_index=i),this.state.applyAnnotationToSeries||(delete r.detector_index,M.e.forEach((e=>{delete r[E(e)],delete r[w(e)]}))),r.event=null!==(t=r.event)&&void 0!==t?t:f.b,s.setValue(null),y.ml.annotations.indexAnnotation(r).then((()=>{Object(h.c)();const e=Object(O.l)();void 0===r._id?e.addSuccess(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.addedAnnotationNotificationMessage",{defaultMessage:"Added an annotation for job with ID {jobId}.",values:{jobId:r.job_id}})):e.addSuccess(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.updatedAnnotationNotificationMessage",{defaultMessage:"Updated annotation for job with ID {jobId}.",values:{jobId:r.job_id}}))})).catch((e=>{const t=Object(O.l)();void 0===r._id?t.addDanger(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithCreatingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred creating the annotation for job with ID {jobId}: {error}",values:{jobId:r.job_id,error:JSON.stringify(e)}})):t.addDanger(m.i18n.translate("xpack.ml.timeSeriesExplorer.timeSeriesChart.errorWithUpdatingAnnotationNotificationErrorMessage",{defaultMessage:"An error occurred updating the annotation for job with ID {jobId}: {error}",values:{jobId:r.job_id,error:JSON.stringify(e)}}))}))}))}componentDidMount(){const{annotationUpdatesService:e}=this.props;this.annotationSub=e.update$().subscribe((e=>{this.setState({annotationState:e})}))}componentWillUnmount(){this.annotationSub.unsubscribe()}render(){const{detectors:e,detectorIndex:t}=this.props,{annotationState:a,isDeleteModalVisible:n}=this.state;if(!a)return null;const i=void 0!==a._id,s=this.validateAnnotationText(),r=s.length>0;let o=null;!1===r&&a.annotation.length>.95*f.c&&(o=m.i18n.translate("xpack.ml.timeSeriesExplorer.annotationFlyout.approachingMaxLengthWarning",{defaultMessage:"{charsRemaining, number} {charsRemaining, plural, one {character} other {characters}} remaining",values:{charsRemaining:f.c-a.annotation.length}}));const c=e?e.find((e=>e.index===t)):void 0,d=c&&"detector_description"in c?c.detector_description:"";return Object(j.jsx)(l.a.Fragment,null,Object(j.jsx)(p.EuiFlyoutBody,null,Object(j.jsx)(x,{annotation:a,detectorDescription:d}),Object(j.jsx)(p.EuiSpacer,{size:"m"}),Object(j.jsx)(p.EuiFormRow,{label:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.annotationTextLabel",defaultMessage:"Annotation text"}),fullWidth:!0,helpText:o,isInvalid:r,error:s},Object(j.jsx)(p.EuiTextArea,{fullWidth:!0,isInvalid:r,onChange:this.annotationTextChangeHandler,placeholder:"...",value:a.annotation,"data-test-subj":"mlAnnotationsFlyoutTextInput"})),Object(j.jsx)(p.EuiFormRow,null,Object(j.jsx)(p.EuiCheckbox,{id:"xpack.ml.annotationFlyout.applyToPartition",label:Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.annotationFlyout.applyToPartitionTextLabel",defaultMessage:"Apply annotation to this series"}),checked:this.state.applyAnnotationToSeries,onChange:()=>this.setState({applyAnnotationToSeries:!this.state.applyAnnotationToSeries}),"data-test-subj":"mlAnnotationsFlyoutApplyToSeriesButton"}))),Object(j.jsx)(p.EuiFlyoutFooter,null,Object(j.jsx)(p.EuiFlexGroup,null,Object(j.jsx)(p.EuiFlexItem,{grow:!1},Object(j.jsx)(p.EuiButtonEmpty,{onClick:this.cancelEditingHandler,flush:"left","data-test-subj":"mlAnnotationsFlyoutCancelButton"},Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.cancelButtonLabel",defaultMessage:"Cancel"}))),Object(j.jsx)(p.EuiFlexItem,{grow:!1,style:{marginLeft:"auto"}},i&&Object(j.jsx)(p.EuiButtonEmpty,{color:"danger",onClick:this.deleteConfirmHandler,"data-test-subj":"mlAnnotationsFlyoutDeleteButton"},Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.deleteButtonLabel",defaultMessage:"Delete"}))),Object(j.jsx)(p.EuiFlexItem,{grow:!1},Object(j.jsx)(p.EuiButton,{fill:!0,isDisabled:!0===r,onClick:this.saveOrUpdateAnnotation,"data-test-subj":"annotationFlyoutUpdateOrCreateButton"},i?Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.updateButtonLabel",defaultMessage:"Update"}):Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.createButtonLabel",defaultMessage:"Create"}))))),Object(j.jsx)(v,{cancelAction:this.closeDeleteModal,deleteAction:this.deleteHandler,isVisible:n}))}}const _=e=>{const t=Object(o.useContext)(S.a),a=d()(t.isAnnotationInitialized$()),n=Object(o.useCallback)((()=>{t.setValue(null)}),[]);if(null==a)return null;const s=void 0!==a._id;return Object(j.jsx)(p.EuiFlyout,{onClose:n,size:"m","aria-labelledby":"Add annotation","data-test-subj":"mlAnnotationFlyout",className:"mlAnnotationFlyout"},Object(j.jsx)(p.EuiFlyoutHeader,{hasBorder:!0},Object(j.jsx)(p.EuiTitle,{size:"s","data-test-subj":"mlAnnotationFlyoutTitle"},Object(j.jsx)("h2",{id:"mlAnnotationFlyoutTitle"},s?Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.editAnnotationTitle",defaultMessage:"Edit annotation"}):Object(j.jsx)(b.FormattedMessage,{id:"xpack.ml.timeSeriesExplorer.annotationFlyout.addAnnotationTitle",defaultMessage:"Add annotation"})))),Object(j.jsx)(annotation_flyout_AnnotationFlyoutUI,i()({},e,{annotationUpdatesService:t})))}},function(e,t,a){"use strict";a.r(t),a.d(t,"getMlGlobalServices",(function(){return v})),a.d(t,"renderApp",(function(){return O}));var n=a(16),i=a.n(n),s=(a(426),a(52)),r=a.n(s),o=a(3),l=a(46),c=a(26),d=a(101),u=a(66),p=a(4);function m(e){if(void 0===e){const e=(e,t)=>{};return{click:e,count:e}}return{click:(t,a)=>e.reportUiCounter(p.e,u.METRIC_TYPE.CLICK,t,a),count:(t,a)=>e.reportUiCounter(p.e,u.METRIC_TYPE.COUNT,t,a)}}var b=a(86),f=a(73),h=a(105),g=a(0),j=a(12);const x=new o.Storage(window.localStorage);function v(e,t){const a=new h.a(e);return{httpService:a,mlApiServices:Object(f.mlApiServicesProvider)(a),mlUsageCollection:m(t)}}const y=({coreStart:e,deps:t,appMountParams:a})=>{var n,s;const r={history:a.history,setHeaderActionMenu:a.setHeaderActionMenu,dataViewsContract:t.data.dataViews,config:e.uiSettings,setBreadcrumbs:e.chrome.setBreadcrumbs,redirectToMlAccessDeniedPage:async()=>{const a=await t.share.url.locators.get(g.a).getUrl({page:g.b.ACCESS_DENIED});await e.application.navigateToUrl(a)}},o={kibanaVersion:t.kibanaVersion,share:t.share,data:t.data,security:t.security,licenseManagement:t.licenseManagement,storage:x,embeddable:t.embeddable,maps:t.maps,triggersActionsUi:t.triggersActionsUi,dataVisualizer:t.dataVisualizer,usageCollection:t.usageCollection,fieldFormats:t.fieldFormats,dashboard:t.dashboard,charts:t.charts,...e},c=e.i18n.Context,d=null!==(n=null===(s=t.usageCollection)||void 0===s?void 0:s.components.ApplicationUsageTrackingProvider)&&void 0!==n?n:i.a.Fragment;return Object(j.jsx)(d,null,Object(j.jsx)(c,null,Object(j.jsx)(l.KibanaThemeProvider,{theme$:a.theme$},Object(j.jsx)(l.KibanaContextProvider,{services:{...o,mlServices:v(e.http,t.usageCollection)}},Object(j.jsx)(b.a,{pageDeps:r})))))},O=(e,t,a)=>{Object(c.n)({timefilter:t.data.query.timefilter,fieldFormats:t.fieldFormats,autocomplete:t.data.autocomplete,config:e.uiSettings,chrome:e.chrome,docLinks:e.docLinks,toastNotifications:e.notifications.toasts,overlays:e.overlays,theme:e.theme,recentlyAccessed:e.chrome.recentlyAccessed,basePath:e.http.basePath,savedObjectsClient:e.savedObjects.client,application:e.application,http:e.http,security:t.security,urlGenerators:t.share.urlGenerators,maps:t.maps,dataVisualizer:t.dataVisualizer,dataViews:t.data.dataViews}),a.onAppLeave((e=>e.default()));const n=Object(d.e)(t.licensing,[()=>r.a.render(Object(j.jsx)(y,{coreStart:e,deps:t,appMountParams:a}),a.element)]);return()=>{n.unsubscribe(),Object(c.a)(),r.a.unmountComponentAtNode(a.element),t.data.search.session.clear()}}},function(e,t,a){"use strict";a.r(t),a.d(t,"getDefaultSwimlanePanelTitle",(function(){return j})),a.d(t,"AnomalySwimlaneEmbeddable",(function(){return anomaly_swimlane_embeddable_AnomalySwimlaneEmbeddable}));var n=a(5),i=a.n(n),s=a(16),r=a.n(s),o=a(52),l=a.n(o),c=a(2),d=a(25),u=a(46),p=a(50);const m=r.a.lazy((()=>a.e(17).then(a.bind(null,770))));var b=a(178),f=a(109),h=a(160),g=a(12);const j=e=>c.i18n.translate("xpack.ml.swimlaneEmbeddable.title",{defaultMessage:"ML anomaly swim lane for {jobIds}",values:{jobIds:e.join(", ")}});class anomaly_swimlane_embeddable_AnomalySwimlaneEmbeddable extends p.Embeddable{constructor(e,t,a){super(e,{defaultTitle:e.title},a),i()(this,"node",void 0),i()(this,"reload$",new d.Subject),i()(this,"type",f.b),this.services=t}render(e){super.render(e),this.node=e;const t=this.services[0].i18n.Context,a=this.services[0].theme.theme$;l.a.render(Object(g.jsx)(t,null,Object(g.jsx)(u.KibanaThemeProvider,{theme$:a},Object(g.jsx)(u.KibanaContextProvider,{services:{...this.services[0]}},Object(g.jsx)(s.Suspense,{fallback:Object(g.jsx)(h.a,null)},Object(g.jsx)(m,{id:this.input.id,embeddableContext:this,embeddableInput:this.getInput$(),services:this.services,refresh:this.reload$.asObservable(),onInputChange:this.updateInput.bind(this),onOutputChange:this.updateOutput.bind(this)}))))),e)}destroy(){super.destroy(),this.node&&l.a.unmountComponentAtNode(this.node)}reload(){this.reload$.next()}supportedTriggers(){return[b.a]}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(16),i=a.n(n),s=a(2),r=a(44),o=a(17),l=a(12);const c=i.a.memo((({value:e,onChange:t})=>{const a=[{min:o.ANOMALY_THRESHOLD.LOW,max:o.ANOMALY_THRESHOLD.MINOR,color:"#8BC8FB"},{min:o.ANOMALY_THRESHOLD.MINOR,max:o.ANOMALY_THRESHOLD.MAJOR,color:"#FDEC25"},{min:o.ANOMALY_THRESHOLD.MAJOR,max:o.ANOMALY_THRESHOLD.CRITICAL,color:"#FBA740"},{min:o.ANOMALY_THRESHOLD.CRITICAL,max:100,color:"#FE5050"}],n=s.i18n.translate("xpack.ml.severitySelector.formControlLabel",{defaultMessage:"Severity"}),i=null!=e?e:o.ANOMALY_THRESHOLD.LOW,c=e=>{t(Number(e.target.value))},d=new Array(5).fill(null).map(((e,t)=>{const a=25*t;return{value:a,label:a}}));return Object(l.jsx)(r.EuiFormRow,{fullWidth:!0},Object(l.jsx)(r.EuiFlexGroup,null,Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiFieldNumber,{id:"severityControl",style:{width:"70px"},compressed:!0,prepend:n,value:i,onChange:c,min:o.ANOMALY_THRESHOLD.LOW,max:100})),Object(l.jsx)(r.EuiFlexItem,{grow:!0},Object(l.jsx)(r.EuiRange,{className:"mlSeverityControl",fullWidth:!0,min:o.ANOMALY_THRESHOLD.LOW,max:100,value:i,onChange:c,"aria-label":s.i18n.translate("xpack.ml.severitySelector.formControlAriaLabel",{defaultMessage:"Select severity threshold"}),showTicks:!0,ticks:d,showRange:!1,levels:a,"data-test-subj":"mlAnomalyAlertScoreSelection"}))))}))},function(e,t,a){"use strict";a.r(t),a.d(t,"getDefaultExplorerChartsPanelTitle",(function(){return g})),a.d(t,"AnomalyChartsEmbeddable",(function(){return anomaly_charts_embeddable_AnomalyChartsEmbeddable}));var n=a(5),i=a.n(n),s=a(16),r=a.n(s),o=a(52),l=a.n(o),c=a(2),d=a(25),u=a(46),p=a(50);const m=r.a.lazy((()=>Promise.all([a.e(2),a.e(16)]).then(a.bind(null,767))));var b=a(109),f=a(160),h=a(12);const g=e=>c.i18n.translate("xpack.ml.anomalyChartsEmbeddable.title",{defaultMessage:"ML anomaly charts for {jobIds}",values:{jobIds:e.join(", ")}});class anomaly_charts_embeddable_AnomalyChartsEmbeddable extends p.Embeddable{constructor(e,t,a){super(e,{defaultTitle:e.title},a),i()(this,"node",void 0),i()(this,"reload$",new d.Subject),i()(this,"type",b.a),this.services=t,this.initializeOutput(e)}async initializeOutput(e){const{anomalyExplorerService:t}=this.services[2],{jobIds:a}=e;try{const e=await t.getCombinedJobs(a),n=this.services[1].data.dataViews,i=new Set(e.map((e=>e.datafeed_config.indices)).flat()),s={};for(const e of i){const t=(await n.find(`"${e}"`)).find((t=>t.title.toLowerCase()===e.toLowerCase()));void 0!==t&&(s[t.id]=t)}this.updateOutput({...this.getOutput(),indexPatterns:Object.values(s)})}catch(e){console.error(`Unable to load data views for ${a}`,e)}}render(e){super.render(e),this.node=e;const t=this.services[0].i18n.Context,a=this.services[0].theme.theme$;l.a.render(Object(h.jsx)(t,null,Object(h.jsx)(u.KibanaThemeProvider,{theme$:a},Object(h.jsx)(u.KibanaContextProvider,{services:{...this.services[0]}},Object(h.jsx)(s.Suspense,{fallback:Object(h.jsx)(f.a,null)},Object(h.jsx)(m,{id:this.input.id,embeddableContext:this,embeddableInput:this.getInput$(),services:this.services,refresh:this.reload$.asObservable(),onInputChange:this.updateInput.bind(this),onOutputChange:this.updateOutput.bind(this)}))))),e)}destroy(){super.destroy(),this.node&&l.a.unmountComponentAtNode(this.node)}reload(){this.reload$.next()}supportedTriggers(){return[]}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(16),i=a(44),s=a(45),r=a(137),o=a(92),l=a(12);const c=()=>{if(!0===Object(r.c)()||!1===Object(r.d)())return null;const e=Object(o.b)();return Object(l.jsx)(n.Fragment,null,Object(l.jsx)(i.EuiCallOut,{title:Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableTitle",defaultMessage:"No ML nodes available"}),color:"warning",iconType:"alert"},Object(l.jsx)("div",null,Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.noMLNodesAvailableDescription",defaultMessage:"There are no ML nodes available."})),Object(l.jsx)("div",null,Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.unavailableCreateOrRunJobsDescription",defaultMessage:"You will not be able to create or run jobs."})),Object(o.e)()&&null!==e&&Object(l.jsx)("div",null,Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloudDescription",defaultMessage:"Please edit your {link}. You may enable a free 1GB machine learning node or expand your existing ML configuration.",values:{link:Object(l.jsx)(i.EuiLink,{href:`https://cloud.elastic.co/deployments?q=${e}`},Object(l.jsx)(s.FormattedMessage,{id:"xpack.ml.jobsList.nodeAvailableWarning.linkToCloud.hereLinkText",defaultMessage:"Elastic Cloud deployment"}))}}))),Object(l.jsx)(i.EuiSpacer,{size:"m"}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));var n=a(16),i=a.n(n),s=a(44),r=a(45),o=a(72),l=a(396),c=a(76),d=a(12);const u=({jobType:e,onCloseFlyout:t,forceRefresh:a})=>{const{savedObjects:{syncCheck:u}}=Object(o.a)(),p=Object(n.useRef)(!1),[m,b]=Object(n.useState)(!1),[f,h]=Object(n.useState)(!1),g=Object(n.useMemo)((()=>Object(c.e)("canCreateJob")),[]),j=Object(n.useCallback)((async()=>{try{if(!1===p.current)return;const{result:t}=await u(e);!0===p.current&&b(f||t)}catch(e){console.log("Saved object synchronization check could not be performed.")}}),[f,b]);Object(n.useEffect)((function(){return p.current=!0,void 0!==a&&!0!==a||j(),()=>{p.current=!1}}),[a,p]);const x=Object(n.useCallback)((()=>{void 0===a&&j(),h(!1),"function"==typeof t&&t()}),[j,t,h]);return Object(n.useEffect)((function(){!1===m&&!0===p.current&&h(!1)}),[m,h]),!1===m?null:Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(s.EuiCallOut,{title:Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.title",defaultMessage:"ML job synchronization required"}),color:"warning",iconType:"alert","data-test-subj":"mlJobSyncRequiredWarning"},Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.description",defaultMessage:"Some jobs are missing or have incomplete saved objects. "}),g?Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.link",defaultMessage:" {link}",values:{link:Object(d.jsx)(s.EuiLink,{onClick:h.bind(null,!0)},Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.linkToManagement.link",defaultMessage:"Synchronize your jobs."}))}}):Object(d.jsx)(r.FormattedMessage,{id:"xpack.ml.jobsList.missingSavedObjectWarning.noPermission",defaultMessage:"An Administrator can synchronize the jobs in Stack Management."}),f&&Object(d.jsx)(l.a,{onClose:x}))),Object(d.jsx)(s.EuiSpacer,{size:"m"}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(16),i=a.n(n),s=a(44),r=a(45),o=a(291),l=a(12);const c=()=>!0===Object(o.a)()?Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(s.EuiCallOut,{title:Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningTitle",defaultMessage:"Index migration in progress"}),color:"warning",iconType:"alert"},Object(l.jsx)("p",null,Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescription",defaultMessage:"Indices related to Machine Learning are currently being upgraded."}),Object(l.jsx)("br",null),Object(l.jsx)(r.FormattedMessage,{id:"xpack.ml.upgrade.upgradeWarning.upgradeInProgressWarningDescriptionExtra",defaultMessage:"Some actions will not be available during this time."}))),Object(l.jsx)(s.EuiSpacer,{size:"m"})):null},function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(16),i=a.n(n),s=a(45),r=a(44),o=a(456),l=a.n(o),c=a(0),d=a(72),u=a(76),p=a(137),m=a(12);const b=()=>{const e=!Object(u.e)("canCreateJob")||!Object(p.c)(),{services:{docLinks:t}}=Object(d.b)(),a=Object(d.d)(),n=Object(d.e)();return Object(m.jsx)(r.EuiEmptyPrompt,{layout:"horizontal",hasBorder:!1,hasShadow:!1,icon:Object(m.jsx)(r.EuiImage,{size:"fullWidth",src:l.a,alt:"anomaly_detection"}),color:"subdued",title:Object(m.jsx)("h2",null,Object(m.jsx)(s.FormattedMessage,{id:"xpack.ml.overview.anomalyDetection.createFirstJobMessage",defaultMessage:"Create your first anomaly detection job"})),body:Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)("p",null,Object(m.jsx)(s.FormattedMessage,{id:"xpack.ml.overview.anomalyDetection.emptyPromptText",defaultMessage:"Anomaly detection enables you to find unusual behavior in time series data. Start automatically spotting the anomalies hiding in your data and resolve issues faster."}))),actions:Object(m.jsx)(r.EuiButton,{color:"primary",onClick:async()=>{if(!a)return;const e=await a.getUrl({page:c.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX});await n(e,!0)},fill:!0,iconType:"plusInCircle",isDisabled:e,"data-test-subj":"mlCreateNewJobButton"},Object(m.jsx)(s.FormattedMessage,{id:"xpack.ml.overview.anomalyDetection.createJobButtonText",defaultMessage:"Create job"})),footer:Object(m.jsx)(r.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiTitle,{size:"xxs"},Object(m.jsx)("h3",null,Object(m.jsx)(s.FormattedMessage,{id:"xpack.ml.common.learnMoreQuestion",defaultMessage:"Want to learn more?"})))),Object(m.jsx)(r.EuiFlexItem,{grow:!1},Object(m.jsx)(r.EuiLink,{href:t.links.ml.anomalyDetection,target:"_blank",external:!0},Object(m.jsx)(s.FormattedMessage,{id:"xpack.ml.common.readDocumentationLink",defaultMessage:"Read documentation"})))),"data-test-subj":"mlAnomalyDetectionEmptyState"})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return I}));var n=a(75),i=a.n(n),s=a(5),r=a.n(s),o=a(8),l=a(16),c=a(231),d=a.n(c),u=a(44),p=a(2),m=a(45),b=a(61),f=a(190),h=a(73),g=a(83),j=a(230),x=a(115),v=a(80),y=a(144),O=a(191),E=a(46),w=a(0),M=a(82),S=a(145),_=a(393),T=a(12);const C=Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.editAnnotationsTooltip",defaultMessage:"Edit annotation"}),k=Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.datafeedChartTooltip",defaultMessage:"Datafeed chart"}),F="current_series";class annotations_table_AnnotationsTableUI extends l.Component{constructor(e){super(e),r()(this,"getAnnotationsWithExtraInfo",d()((e=>{var t,a;return Array.isArray(null===(t=this.props.chartDetails)||void 0===t||null===(a=t.entityData)||void 0===a?void 0:a.entities)?e.map((e=>{var t,a;const n=null===(t=this.props.chartDetails)||void 0===t||null===(a=t.entityData)||void 0===a?void 0:a.entities.every((({fieldType:t,fieldValue:a})=>{const n=`${t}_value`;return!(!e[n]||e[n]!==a)}));return{...e,[F]:n}})):e}))),r()(this,"annotationsRefreshSubscription",null),r()(this,"previousJobId",void 0),r()(this,"openSingleMetricView",(async(e={})=>{const{services:{application:{navigateToUrl:t},share:a}}=this.props.kibana,n=this.getJob(e.job_id),i=n.data_counts,s=Object(v.g)(i.latest_record_timestamp,i.latest_bucket_timestamp),r={from:new Date(i.earliest_record_timestamp).toISOString(),to:new Date(s).toISOString(),mode:"absolute"};let o={};const l={};void 0!==e.timestamp&&void 0!==e.end_timestamp&&(o={zoom:{from:new Date(e.timestamp).toISOString(),to:new Date(e.end_timestamp).toISOString()}},e.timestamp<i.earliest_record_timestamp&&(r.from=new Date(e.timestamp).toISOString()),e.end_timestamp>i.latest_record_timestamp&&(r.to=new Date(e.end_timestamp).toISOString())),void 0!==e.detector_index&&(o.detectorIndex=e.detector_index),void 0!==e.partition_field_value&&(l[e.partition_field_name]=e.partition_field_value),void 0!==e.over_field_value&&(l[e.over_field_name]=e.over_field_value),void 0!==e.by_field_value&&(l[e.by_field_name]=e.by_field_value),o.entities=l;const c=a.url.locators.get(w.a),d=await c.getUrl({page:w.b.SINGLE_METRIC_VIEWER,pageState:{timeRange:r,refreshInterval:{display:"Off",pause:!0,value:0},jobIds:[n.job_id],query:{query_string:{analyze_wildcard:!0,query:"*"}},...o}},{absolute:!0});Object(f.a)("timeseriesexplorer",n.job_id,d),await t(d)})),r()(this,"onMouseOverRow",(e=>{void 0!==this.mouseOverRecord?this.mouseOverRecord.rowId!==e.rowId&&(j.a.rowMouseleave$.next({record:this.mouseOverRecord,type:"annotation"}),j.a.rowMouseenter$.next({record:e,type:"annotation"})):j.a.rowMouseenter$.next({record:e,type:"annotation"}),this.mouseOverRecord=e})),r()(this,"onMouseLeaveRow",(()=>{void 0!==this.mouseOverRecord&&(j.a.rowMouseleave$.next({record:this.mouseOverRecord,type:"annotation"}),this.mouseOverRecord=void 0)})),this.state={annotations:[],isLoading:!1,queryText:`event:(${O.b} or ${O.a})`,searchError:void 0,jobId:Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&void 0!==this.props.jobs[0]?this.props.jobs[0].job_id:void 0,datafeedFlyoutVisible:!1,datafeedEnd:null},this.sorting={sort:{field:"timestamp",direction:"asc"}}}getAnnotations(){const e=this.props.jobs[0],t=e.data_counts;this.setState({isLoading:!0}),t.processed_record_count>0?h.ml.annotations.getAnnotations$({jobIds:[e.job_id],earliestMs:null,latestMs:null,maxAnnotations:x.a}).toPromise().then((e=>{this.setState(((t,a)=>({annotations:e.annotations[a.jobs[0].job_id]||[],errorMessage:void 0,isLoading:!1,jobId:a.jobs[0].job_id})))})).catch((e=>{console.log("Error loading list of annotations for jobs list:",e),this.setState({annotations:[],errorMessage:"Error loading the list of annotations for this job",isLoading:!1,jobId:void 0})})):this.setState({annotations:[],isLoading:!1,jobId:void 0})}getJob(e){if(Array.isArray(this.props.jobs)&&this.props.jobs.length>0){const t=this.props.jobs[0];if(void 0===e||t.job_id===e)return t}return g.a.getJob(e)}componentDidMount(){void 0===this.props.annotations&&Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&(this.annotationsRefreshSubscription=y.b.subscribe((()=>{this.getAnnotations()})),Object(y.c)())}componentDidUpdate(){Array.isArray(this.props.jobs)&&this.props.jobs.length>0&&this.previousJobId!==this.props.jobs[0].job_id&&void 0===this.props.annotations&&!1===this.state.isLoading&&this.state.jobId!==this.props.jobs[0].job_id&&(Object(y.c)(),this.previousJobId=this.props.jobs[0].job_id)}componentWillUnmount(){null!==this.annotationsRefreshSubscription&&this.annotationsRefreshSubscription.unsubscribe()}render(){var e,t;const{isSingleMetricViewerLinkVisible:a=!0,isNumberBadgeVisible:n=!1,annotationUpdatesService:i}=this.props,{queryText:s,searchError:r}=this.state;if(void 0===this.props.annotations){if(!0===this.state.isLoading)return Object(T.jsx)(u.EuiFlexGroup,{justifyContent:"spaceAround"},Object(T.jsx)(u.EuiFlexItem,{grow:!1},Object(T.jsx)(u.EuiLoadingSpinner,{size:"l"})));if(void 0!==this.state.errorMessage)return Object(T.jsx)(u.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"})}const c=this.props.annotations||this.state.annotations;if(0===c.length)return Object(T.jsx)(u.EuiCallOut,{title:Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.annotationsNotCreatedTitle",defaultMessage:"No annotations created for this job"}),iconType:"iInCircle",role:"alert"},this.state.jobId&&Object(v.p)(this.getJob(this.state.jobId))&&Object(T.jsx)("p",null,Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription",defaultMessage:"To create an annotation, open the {linkToSingleMetricView}",values:{linkToSingleMetricView:Object(T.jsx)(u.EuiLink,{onClick:()=>this.openSingleMetricView()},Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.howToCreateAnnotationDescription.singleMetricViewerLinkText",defaultMessage:"Single Metric Viewer"}))}})));const d=[{field:"annotation",name:p.i18n.translate("xpack.ml.annotationsTable.annotationColumnName",{defaultMessage:"Annotation"}),sortable:!0,width:"40%",scope:"row","data-test-subj":"mlAnnotationsColumnAnnotation"},{field:"timestamp",name:p.i18n.translate("xpack.ml.annotationsTable.fromColumnName",{defaultMessage:"From"}),dataType:"date",render:M.d,sortable:!0,"data-test-subj":"mlAnnotationsColumnFrom"},{field:"end_timestamp",name:p.i18n.translate("xpack.ml.annotationsTable.toColumnName",{defaultMessage:"To"}),dataType:"date",render:M.d,sortable:!0,"data-test-subj":"mlAnnotationsColumnTo"},{field:"modified_time",name:p.i18n.translate("xpack.ml.annotationsTable.lastModifiedDateColumnName",{defaultMessage:"Last modified date"}),dataType:"date",render:M.d,sortable:!0,"data-test-subj":"mlAnnotationsColumnModifiedDate"},{field:"modified_username",name:p.i18n.translate("xpack.ml.annotationsTable.lastModifiedByColumnName",{defaultMessage:"Last modified by"}),sortable:!0,"data-test-subj":"mlAnnotationsColumnModifiedBy"},{field:"event",name:p.i18n.translate("xpack.ml.annotationsTable.eventColumnName",{defaultMessage:"Event"}),sortable:!0,width:"10%","data-test-subj":"mlAnnotationsColumnEvent"}];Object(o.uniq)(c.map((e=>e.job_id))).length>1&&d.unshift({field:"job_id",name:p.i18n.translate("xpack.ml.annotationsTable.jobIdColumnName",{defaultMessage:"job ID"}),sortable:!0,"data-test-subj":"mlAnnotationsColumnJobId"}),n&&d.unshift({field:"key",name:p.i18n.translate("xpack.ml.annotationsTable.labelColumnName",{defaultMessage:"Label"}),sortable:e=>+e,width:"60px",render:e=>Object(T.jsx)(u.EuiBadge,{color:"default"},e),"data-test-subj":"mlAnnotationsColumnLabel"});const f=[];f.push({name:C,description:C,icon:"pencil",type:"icon",onClick:e=>{const t=e._id,a=c.find((e=>e._id===t));i.setValue(null!=a?a:e)},"data-test-subj":"mlAnnotationsActionEdit"}),this.state.jobId&&this.props.jobs[0].analysis_config.bucket_span&&f.push({name:k,description:k,icon:"visAreaStacked",type:"icon",onClick:e=>{this.setState({datafeedFlyoutVisible:!0,datafeedEnd:e.end_timestamp})},"data-test-subj":"mlAnnotationsActionViewDatafeed"}),a&&f.push({name:e=>Object(v.p)(this.getJob(e.job_id))?Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.openInSingleMetricViewerTooltip",defaultMessage:"Open in Single Metric Viewer"}):Object(T.jsx)(u.EuiToolTip,{content:Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerTooltip",defaultMessage:"Job configuration not supported in Single Metric Viewer"})},Object(T.jsx)(m.FormattedMessage,{id:"xpack.ml.annotationsTable.openInSingleMetricViewerTooltip",defaultMessage:"Open in Single Metric Viewer"})),description:e=>Object(v.p)(this.getJob(e.job_id))?p.i18n.translate("xpack.ml.annotationsTable.openInSingleMetricViewerAriaLabel",{defaultMessage:"Open in Single Metric Viewer"}):p.i18n.translate("xpack.ml.annotationsTable.jobConfigurationNotSupportedInSingleMetricViewerAriaLabel",{defaultMessage:"Job configuration not supported in Single Metric Viewer"}),enabled:e=>Object(v.p)(this.getJob(e.job_id)),icon:"visLine",type:"icon",onClick:e=>this.openSingleMetricView(e),"data-test-subj":"mlAnnotationsActionOpenInSingleMetricViewer"});const h={[O.b]:0,[O.a]:0};c.forEach((e=>{var t;const a=null!==(t=e.event)&&void 0!==t?t:O.b;void 0===h[a]&&(h[a]=0),h[a]++}));const g=[{type:"field_value_selection",field:"event",name:"Event",multiSelect:"or",options:Object.entries(h).map((([e,t])=>({value:e,name:e,view:`${e} (${t})`}))),"data-test-subj":"mlAnnotationTableEventFilter"}];var j,x;(this.props.detectors&&d.push({name:p.i18n.translate("xpack.ml.annotationsTable.detectorColumnName",{defaultMessage:"Detector"}),width:"10%",render:e=>"detector_index"in e?this.props.detectors[e.detector_index].detector_description:""}),Array.isArray(null===(e=this.props.chartDetails)||void 0===e||null===(t=e.entityData)||void 0===t?void 0:t.entities))?(null===(j=this.props.chartDetails)||void 0===j||null===(x=j.entityData)||void 0===x||x.entities.forEach((e=>{"partition_field"===e.fieldType&&d.push({field:"partition_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.partitionSMVColumnName",{defaultMessage:"Partition"}),sortable:!0}),"over_field"===e.fieldType&&d.push({field:"over_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.overColumnSMVName",{defaultMessage:"Over"}),sortable:!0}),"by_field"===e.fieldType&&d.push({field:"by_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.byColumnSMVName",{defaultMessage:"By"}),sortable:!0})})),g.push({type:"is",field:F,name:p.i18n.translate("xpack.ml.annotationsTable.seriesOnlyFilterName",{defaultMessage:"Filter to series"})})):(d.push({field:"partition_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.partitionAEColumnName",{defaultMessage:"Partition"}),sortable:!0}),d.push({field:"over_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.overAEColumnName",{defaultMessage:"Over"}),sortable:!0}),d.push({field:"by_field_value",name:p.i18n.translate("xpack.ml.annotationsTable.byAEColumnName",{defaultMessage:"By"}),sortable:!0}));const y={defaultQuery:s,box:{incremental:!0,schema:!0},filters:g};d.push({align:b.RIGHT_ALIGNMENT,width:"60px",name:p.i18n.translate("xpack.ml.annotationsTable.actionsColumnName",{defaultMessage:"Actions"}),actions:f,"data-test-subj":"mlAnnotationsColumnActions"},{field:F,name:F,dataType:"boolean",width:"0px",render:()=>""});const E=this.getAnnotationsWithExtraInfo(c);return Object(T.jsx)(l.Fragment,null,Object(T.jsx)(u.EuiInMemoryTable,{"data-test-subj":"mlAnnotationsTable",error:r,className:"eui-textOverflowWrap",compressed:!0,items:E,columns:d,pagination:{pageSizeOptions:[5,10,25]},sorting:this.sorting,search:y,rowProps:e=>({"data-test-subj":`mlAnnotationsTableRow row-${e._id}`,onMouseOver:()=>this.onMouseOverRow(e),onMouseLeave:()=>this.onMouseLeaveRow()})}),this.state.jobId&&this.state.datafeedFlyoutVisible&&this.state.datafeedEnd?Object(T.jsx)(_.a,{onClose:()=>{this.setState({datafeedFlyoutVisible:!1})},end:this.state.datafeedEnd,jobId:this.state.jobId}):null)}}const I=Object(E.withKibana)((e=>{const t=Object(l.useContext)(S.a);return Object(T.jsx)(annotations_table_AnnotationsTableUI,i()({annotationUpdatesService:t},e))}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var n=a(16),i=a.n(n),s=a(45),r=a(2),o=a(44),l=a(72),c=a(77),d=a(148),u=a(12);const p=r.i18n.translate("xpack.ml.deleteJobCheckModal.shouldUnTagLabel",{defaultMessage:"Remove job from current space"});const m=({canDeleteCallback:e,onCloseCallback:t,refreshJobsCallback:a,jobType:m,jobIds:b,setDidUntag:f,hasManagedJob:h})=>{const[g,j]=Object(n.useState)(),[x,v]=Object(n.useState)(),[y,O]=Object(n.useState)(!1),[E,w]=Object(n.useState)(!1),[M,S]=Object(n.useState)(!1),[_,T]=Object(n.useState)(),{savedObjects:{canDeleteJob:C,removeJobFromCurrentSpace:k}}=Object(l.a)(),{displayErrorToast:F,displaySuccessToast:I}=Object(c.c)();Object(n.useEffect)((()=>{S(!0),C(m,b).then((t=>{const a=function(e){const t=Object.keys(e),{canDelete:a,canRemoveFromSpace:n}=e[t[0]];let i=!0;return t.length>1&&(i=t.every((t=>e[t].canDelete===a&&e[t].canRemoveFromSpace===n))),{canDelete:a,canRemoveFromSpace:n,canTakeAnyAction:i}}(t),{canDelete:n,canRemoveFromSpace:l,canTakeAnyAction:c}=a;if(c&&n&&!l)return void e();T(a);const{buttonText:p,modalText:m}=function(e,t,a){const{canDelete:n,canRemoveFromSpace:l,canTakeAnyAction:c}=t;if(!1===c)return{buttonText:Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextNoAction",defaultMessage:"Close"}),modalText:Object(u.jsx)(o.EuiText,null,Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextNoAction",defaultMessage:"{ids} have different space permissions. When you delete multiple jobs, they must have the same permissions. Deselect the jobs and try deleting each job individually.",values:{ids:e.join(", ")}}))};const p={buttonText:Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextClose",defaultMessage:"Close"}),modalText:Object(u.jsx)(o.EuiText,null,Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextClose",defaultMessage:"{ids} cannot be deleted and cannot be removed from the current space. This job is assigned to the * space and you do not have access to all spaces.",values:{ids:e.join(", ")}}))};return n?{buttonText:Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextCanDelete",defaultMessage:"Continue to delete {length, plural, one {# job} other {# jobs}}",values:{length:e.length}}),modalText:Object(u.jsx)(i.a.Fragment,null,a?Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(d.a,{jobsCount:e.length,action:r.i18n.translate("xpack.ml.jobsList.deleteJobCheckModal.removeOrDeleteAction",{defaultMessage:"removing or deleting"})}),Object(u.jsx)(o.EuiSpacer,{size:"s"})):null,Object(u.jsx)(o.EuiText,null,Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextCanDelete",defaultMessage:"{ids} can be deleted.",values:{ids:e.join(", ")}})))}:l?{buttonText:Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.buttonTextCanUnTagConfirm",defaultMessage:"Remove from current space"}),modalText:Object(u.jsx)(i.a.Fragment,null,a?Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(d.a,{jobsCount:e.length,action:r.i18n.translate("xpack.ml.jobsList.deleteJobCheckModal.removeAction",{defaultMessage:"removing"})}),Object(u.jsx)(o.EuiSpacer,{size:"s"})):null,Object(u.jsx)(o.EuiText,null,Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTextCanUnTag",defaultMessage:"{ids} cannot be deleted but can be removed from the current space.",values:{ids:e.join(", ")}})))}:p}(b,a,h);j(p),v(m)})),"function"==typeof f&&f(!1),S(!1)}),[h]);const D=async()=>{w(!0);const e=await k(m,b);w(!1),"function"==typeof f&&f(!0),Object.entries(e).forEach((([e,{success:t,error:a}])=>{if(!1===t){const t=r.i18n.translate("xpack.ml.deleteJobCheckModal.unTagErrorTitle",{defaultMessage:"Error updating {id}",values:{id:e}});F(a,t)}else{O(!0);const t=r.i18n.translate("xpack.ml.deleteJobCheckModal.unTagSuccessTitle",{defaultMessage:"Successfully updated {id}",values:{id:e}});I(t)}})),t(),"function"==typeof a&&a()};return Object(u.jsx)(o.EuiModal,{onClose:t,"data-test-subj":"mlAnalyticsJobDeleteCheckOverlay"},!0===M&&Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(o.EuiModalBody,null,Object(u.jsx)(o.EuiFlexGroup,{justifyContent:"spaceAround"},Object(u.jsx)(o.EuiFlexItem,{grow:!1},Object(u.jsx)(o.EuiLoadingSpinner,{size:"xl"}))))),!1===M&&Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(o.EuiModalHeader,null,Object(u.jsx)(o.EuiModalHeaderTitle,null,Object(u.jsx)(s.FormattedMessage,{id:"xpack.ml.deleteJobCheckModal.modalTitle",defaultMessage:"Checking space permissions"}))),Object(u.jsx)(o.EuiModalBody,null,x),Object(u.jsx)(o.EuiModalFooter,null,Object(u.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(u.jsx)(o.EuiFlexItem,{grow:!1},!y&&(null==_?void 0:_.canTakeAnyAction)&&(null==_?void 0:_.canRemoveFromSpace)&&(null==_?void 0:_.canDelete)&&Object(u.jsx)(o.EuiButtonEmpty,{isLoading:E,color:"primary",size:"s",onClick:D},p)),Object(u.jsx)(o.EuiFlexItem,{grow:!1},Object(u.jsx)(o.EuiButton,{size:"s",onClick:null==_||!_.canTakeAnyAction||null==_||!_.canRemoveFromSpace||null!=_&&_.canDelete?async()=>{null!=_&&_.canTakeAnyAction&&null!=_&&_.canDelete?e():t()}:D,fill:!0},g))))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return r}));var n=a(16),i=a(44),s=a(12);const r=({hasData:e,loading:t=!1,height:a,children:r})=>{const o=!0===t?!0===e?.3:0:1;return Object(s.jsx)(n.Fragment,null,Object(s.jsx)("div",{style:{height:"100%",opacity:o,transition:"opacity 0.2s"}},t&&!e?null:r),!0===t&&Object(s.jsx)(i.EuiFlexGroup,{justifyContent:"spaceAround",alignItems:"center",style:void 0!==a?{height:a,marginTop:`-${a}`}:{}},Object(s.jsx)(i.EuiFlexItem,{grow:!1},Object(s.jsx)(i.EuiLoadingSpinner,{size:"xl"}))))}},,,,function(e,t,a){"use strict";var n=a(214);a.d(t,"b",(function(){return n.b})),a.d(t,"a",(function(){return n.a}))},function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"a",(function(){return s}));let n=!1;function i(e){n=e}function s(){return n}},,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a(2);const n={DELETE:"delete",RESET:"reset",REVERT:"revert"};const i={"cluster:admin/xpack/ml/job/delete":n.DELETE,"cluster:admin/xpack/ml/job/reset":n.RESET,"cluster:admin/xpack/ml/job/model_snapshots/revert":n.REVERT};Object.keys(i)},function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var n=a(2),i=a(73);const s=new class CalendarService{async assignNewJobId(e,t){const{calendar_id:a}=e;try{await i.ml.updateCalendar({...e,calendarId:a,job_ids:[...e.job_ids,t]})}catch(e){throw new Error(n.i18n.translate("xpack.ml.calendarService.assignNewJobIdErrorMessage",{defaultMessage:"Unable to assign {jobId} to {calendarId}",values:{calendarId:a,jobId:t}}))}}async fetchCalendarsByIds(e){try{const t=await i.ml.calendars({calendarIds:e});return Array.isArray(t)?t:[t]}catch(t){throw new Error(n.i18n.translate("xpack.ml.calendarService.fetchCalendarsByIdsErrorMessage",{defaultMessage:"Unable to fetch calendars: {calendarIds}",values:{calendarIds:e.join(", ")}}))}}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(16),i=a(72),s=a(227),r=a(83);const o=()=>{const{services:{http:{basePath:e}}}=Object(i.b)(),t=Object(i.h)().get(s.b),a=Object(i.h)().get(s.a);return{createLinkWithUserDefaults:Object(n.useCallback)(((n,i)=>{const s=r.a.createResultsUrlForJobs(i,n,!0===t&&void 0!==a?a:void 0);return`${e.get()}/app/ml/${s}`}),[e])}}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return n.ElasticsearchSqlHighlightRules}}),Object.defineProperty(t,"ScriptHighlightRules",{enumerable:!0,get:function(){return n.ScriptHighlightRules}}),Object.defineProperty(t,"XJsonHighlightRules",{enumerable:!0,get:function(){return n.XJsonHighlightRules}}),Object.defineProperty(t,"XJsonMode",{enumerable:!0,get:function(){return i.XJsonMode}}),Object.defineProperty(t,"addXJsonToRules",{enumerable:!0,get:function(){return n.addXJsonToRules}}),Object.defineProperty(t,"installXJsonMode",{enumerable:!0,get:function(){return i.installXJsonMode}});var n=a(437),i=a(441)},function(e,t,a){"use strict";var n=a(125);Object.defineProperty(t,"__esModule",{value:!0}),t.ElasticsearchSqlHighlightRules=void 0;var i=n(a(189));const{TextHighlightRules:s}=i.default.acequire("ace/mode/text_highlight_rules"),r=i.default.acequire("ace/lib/oop"),o=function(){const e=this.createKeywordMapper({keyword:["describe|between|in|like|not|and|or|desc|select|from|where|having|group|by|orderasc|desc|pivot|for|in|as|show|columns|include|frozen|tables|escape|limit|rlike|all|distinct|is","avg|count|first|first_value|last|last_value|max|min|sum|kurtosis|mad|percentile|percentile_rank|skewness|stddev_pop|sum_of_squares|var_pop|histogram|case|coalesce|greatest|ifnull|iif|isnull|least|nullif|nvl|curdate|current_date|current_time|current_timestamp|curtime|dateadd|datediff|datepart|datetrunc|date_add|date_diff|date_part|date_trunc|day|dayname|dayofmonth|dayofweek|dayofyear|day_name|day_of_month|day_of_week|day_of_year|dom|dow|doy|hour|hour_of_day|idow|isodayofweek|isodow|isoweek|isoweekofyear|iso_day_of_week|iso_week_of_year|iw|iwoy|minute|minute_of_day|minute_of_hour|month|monthname|month_name|month_of_year|now|quarter|second|second_of_minute|timestampadd|timestampdiff|timestamp_add|timestamp_diff|today|week|week_of_year|year|abs|acos|asin|atan|atan2|cbrt|ceil|ceiling|cos|cosh|cot|degrees|e|exp|expm1|floor|log|log10|mod|pi|power|radians|rand|random|round|sign|signum|sin|sinh|sqrt|tan|truncate|ascii|bit_length|char|character_length|char_length|concat|insert|lcase|left|length|locate|ltrim|octet_length|position|repeat|replace|right|rtrim|space|substring|ucase|cast|convert|database|user|st_astext|st_aswkt|st_distance|st_geometrytype|st_geomfromtext|st_wkttosql|st_x|st_y|st_z|score","true|false","null|boolean|byte|short|integer|long|double|float|half_float|scaled_float|keyword|text|binary|date|ip|object|nested|time|interval_year|interval_month|interval_day|interval_hour|interval_minute|interval_second|interval_year_to_monthinteval_day_to_hour|interval_day_to_minute|interval_day_to_second|interval_hour_to_minute|interval_hour_to_secondinterval_minute_to_second|geo_point|geo_shape|shape"].join("|")},"identifier",!0);this.$rules={start:[{token:"comment",regex:"--.*$"},{token:"comment",start:"/\\*",end:"\\*/"},{token:"string",regex:'".*?"'},{token:"constant",regex:"'.*?'"},{token:"string",regex:"`.*?`"},{token:"entity.name.function",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:e,regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"keyword.operator",regex:"⇐|<⇒|\\*|\\.|\\:\\:|\\+|\\-|\\/|\\/\\/|%|&|\\^|~|<|>|<=|=>|==|!=|<>|="},{token:"paren.lparen",regex:"[\\(]"},{token:"paren.rparen",regex:"[\\)]"},{token:"text",regex:"\\s+"}]},this.normalizeRules()};t.ElasticsearchSqlHighlightRules=o,r.inherits(o,s)},function(e,t,a){"use strict";var n=a(125);Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptHighlightRules=o;var i=n(a(189));const s=i.default.acequire("ace/lib/oop"),{TextHighlightRules:r}=i.default.acequire("ace/mode/text_highlight_rules");function o(){this.name="ScriptHighlightRules",this.$rules={start:[{token:"script.comment",regex:"\\/\\/.*$"},{token:"script.string.regexp",regex:"[/](?:(?:\\[(?:\\\\]|[^\\]])+\\])|(?:\\\\/|[^\\]/]))*[/]\\w*\\s*(?=[).,;]|$)"},{token:"script.string",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"script.constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"script.constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"script.constant.language.boolean",regex:"(?:true|false)\\b"},{token:"script.keyword",regex:"def|int|long|byte|String|float|double|char|null|if|else|while|do|for|continue|break|new|try|catch|throw|this|instanceof|return|ctx"},{token:"script.text",regex:"[a-zA-Z_$][a-zA-Z0-9_$]*\\b"},{token:"script.keyword.operator",regex:"\\?\\.|\\*\\.|=~|==~|!|%|&|\\*|\\-\\-|\\-|\\+\\+|\\+|~|===|==|=|!=|!==|<=|>=|<<=|>>=|>>>=|<>|<|>|->|!|&&|\\|\\||\\?\\:|\\*=|%=|\\+=|\\-=|&=|\\^=|\\b(?:in|instanceof|new|typeof|void)"},{token:"script.lparen",regex:"[[({]"},{token:"script.rparen",regex:"[\\])}]"},{token:"script.text",regex:"\\s+"}]}}s.inherits(o,r)},function(e,t,a){"use strict";a.d(t,"a",(function(){return f}));var n=a(16),i=a.n(n),s=a(44),r=a(2),o=a(45),l=a(73),c=a(402),d=a(27),u=a(77),p=a(72),m=a(76),b=a(12);const f=i.a.memo((({jobId:e,start:t,end:a,actionHandler:f,refreshJobList:h,showClearButton:g})=>{const j=Object(m.e)("canCreateJob"),[x,v]=Object(n.useState)([]),[y,O]=Object(n.useState)([]),[E,w]=Object(n.useState)(!1),[M,S]=Object(n.useState)(""),[_,T]=Object(n.useState)(!1),C=Object(u.c)(),{jobs:{clearJobAuditMessages:k}}=Object(p.a)(),F=async()=>{w(!0);try{const n=await l.ml.jobs.jobAuditMessages({jobId:e,start:t,end:a});v(n.messages),O(n.notificationIndices),w(!1)}catch(e){w(!1),C.displayErrorToast(e,r.i18n.translate("xpack.ml.jobService.jobAuditMessagesErrorTitle",{defaultMessage:"Error loading job messages"})),S(Object(d.b)(e))}},I=Object(n.useCallback)(F,[e]),D=Object(n.useCallback)((async()=>{T(!0);try{await k(e,y),T(!1),"function"==typeof h&&h()}catch(e){T(!1),C.displayErrorToast(e,r.i18n.translate("xpack.ml.jobMessages.clearJobAuditMessagesErrorTitle",{defaultMessage:"Error clearing job message warnings and errors"}))}}),[e,JSON.stringify(y)]);Object(n.useEffect)((()=>{F()}),[]);const A=0===y.length,L=Object(b.jsx)(s.EuiButton,{size:"s",isLoading:_,isDisabled:A,onClick:D,"data-test-subj":"mlJobMessagesClearButton"},Object(b.jsx)(o.FormattedMessage,{id:"xpack.ml.jobMessages.clearMessagesLabel",defaultMessage:"Clear notifications"}));return Object(b.jsx)(i.a.Fragment,null,j&&g?Object(b.jsx)(s.EuiSpacer,null):null,Object(b.jsx)(s.EuiFlexGroup,{direction:"column"},j&&g?Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)("div",null,!0===A?Object(b.jsx)(s.EuiToolTip,{content:r.i18n.translate("xpack.ml.jobMessages.clearJobAuditMessagesDisabledTooltip",{defaultMessage:"Notification clearing not supported."})},L):Object(b.jsx)(s.EuiToolTip,{content:r.i18n.translate("xpack.ml.jobMessages.clearJobAuditMessagesTooltip",{defaultMessage:"Clears warning icon from jobs list for messages produced in the last 24 hours."})},L))):null,Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(c.a,{refreshMessage:I,messages:x,loading:E,error:M,actionHandler:f}))))}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(16),i=a(48),s=a(303),r=a(12);const o=Object(i.timeFormatter)(Object(i.niceTimeFormatByDay)(3));function l(e){return(Math.round(100*e)/100).toString()}const c=({chartData:e})=>{const t=Object(s.b)(e);return Object(r.jsx)(n.Fragment,null,Object(r.jsx)(i.Axis,{id:"bottom",position:i.Position.Bottom,showOverlappingTicks:!0,tickFormat:o}),Object(r.jsx)(i.Axis,{id:"left",position:i.Position.Left,tickFormat:l,domain:t}))}},function(e,t,a){"use strict";function n(e){const t=!1;if(void 0===e)return{fit:t,min:NaN,max:NaN};if(0===e.length)return{min:0,max:0,fit:t};let a=Number.MIN_VALUE,n=Number.MAX_VALUE;e.forEach((e=>{a=Math.max(e.value,a),n=Math.min(e.value,n)}));const i=.1*(a-n);return a+=i,n-=i,{min:n,max:a,fit:t}}function i(e){return 0===e.length?{min:0,max:0}:{min:e[0].time,max:e[e.length-1].time}}a.d(t,"b",(function(){return n})),a.d(t,"a",(function(){return i}))},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e[e.NO_EXAMPLES=0]="NO_EXAMPLES",e[e.FAILED_TO_TOKENIZE=1]="FAILED_TO_TOKENIZE",e[e.TOO_MANY_TOKENS=2]="TOO_MANY_TOKENS",e[e.TOKEN_COUNT=3]="TOKEN_COUNT",e[e.MEDIAN_LINE_LENGTH=4]="MEDIAN_LINE_LENGTH",e[e.NULL_VALUES=5]="NULL_VALUES",e[e.INSUFFICIENT_PRIVILEGES=6]="INSUFFICIENT_PRIVILEGES"}(n||(n={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(16),i=a(48),s=a(7),r=a(1),o=a(12);function l(e){return{line:{stroke:Object(s.j)(e),strokeWidth:3,opacity:1}}}const c=({anomalyData:e})=>{const t=function(e){const t={critical:[],major:[],minor:[],warning:[],unknown:[],low:[]};return e.forEach((e=>{0!==e.value&&t[e.severity].push({dataValue:e.time})})),t}(void 0===e?[]:e);return Object(o.jsx)(n.Fragment,null,Object(o.jsx)(i.LineAnnotation,{id:"low",domainType:i.AnnotationDomainType.XDomain,dataValues:t.low,style:l(r.c.LOW),hideTooltips:!0}),Object(o.jsx)(i.LineAnnotation,{id:"warning",domainType:i.AnnotationDomainType.XDomain,dataValues:t.warning,style:l(r.c.WARNING),hideTooltips:!0}),Object(o.jsx)(i.LineAnnotation,{id:"minor",domainType:i.AnnotationDomainType.XDomain,dataValues:t.minor,style:l(r.c.MINOR),hideTooltips:!0}),Object(o.jsx)(i.LineAnnotation,{id:"major",domainType:i.AnnotationDomainType.XDomain,dataValues:t.major,style:l(r.c.MAJOR),hideTooltips:!0}),Object(o.jsx)(i.LineAnnotation,{id:"critical",domainType:i.AnnotationDomainType.XDomain,dataValues:t.critical,style:l(r.c.CRITICAL),hideTooltips:!0}))}},function(e,t,a){"use strict";a.d(t,"c",(function(){return l})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return d}));var n=a(8),i=a(92),s=a(80),r=a(26),o=a(73);function l(e,t,a){return new Promise(((a,n)=>{const i={...u(e,t),...p(e,t),...m(e,t),...b(e,t),...f(e,t),...h(e,t),...g(e,t)},r={...j(e,t)};void 0!==i.custom_settings&&(i.custom_settings=function(e,t){let a={};void 0!==e.custom_settings&&(a={...e.custom_settings},void 0===e.custom_settings.created_by||void 0===e.detectors&&!Object.keys(t).length||Object(s.r)(a));return a}(i,r));const l=()=>{(function(e,t){return new Promise(((a,n)=>{if(Object.keys(e).length){const i=t.datafeed_config.datafeed_id;o.ml.updateDatafeed({datafeedId:i,datafeedConfig:e}).then((()=>{a()})).catch((e=>{n(e)}))}else a()}))})(r,e).then((()=>{a()})).catch((e=>{n(e)}))};Object.keys(i).length?o.ml.updateJob({jobId:e.job_id,job:i}).then((()=>{l()})).catch((e=>{n(e)})):l()}))}function c(e){return new Promise(((t,a)=>{Object(r.i)().find({type:"dashboard",fields:["title"],perPage:e}).then((e=>{const a=e.savedObjects;if(void 0!==a){const e=a.map((e=>({id:e.id,title:e.attributes.title})));e.sort(((e,t)=>e.title.localeCompare(t.title))),t(e)}})).catch((e=>{a(e)}))}))}async function d(){const e=Object(r.b)();return(await e.getIdsWithTitle()).sort(((e,t)=>e.title.localeCompare(t.title)))}function u(e,t){const a=t.description;return t.description!==e.description?{description:a}:{}}function p(e,t){const a=t.groups;if(void 0!==t.groups){return 0===Object(n.difference)(e.groups,a).length+Object(n.difference)(a,e.groups).length?{}:{groups:a}}return{}}function m(e,t){const a=Object(i.d)(),n={};if(void 0!==e.analysis_limits.model_memory_limit){let{mml:i}=t;""===i&&(i=a.max_model_memory_limit),i!==e.analysis_limits.model_memory_limit&&(n.analysis_limits={model_memory_limit:i})}return n}function b(e,t){const a=t.modelSnapshotRetentionDays;return a!==e.model_snapshot_retention_days?{model_snapshot_retention_days:a}:{}}function f(e,t){const a=t.dailyModelSnapshotRetentionAfterDays;return a!==e.daily_model_snapshot_retention_after_days?{daily_model_snapshot_retention_after_days:a}:{}}function h(e,t){const a=[],n=t.detectorDescriptions.map(((e,t)=>({detector_index:t,description:e})));return e.analysis_config.detectors.forEach((e=>{n[e.detector_index].description!==e.detector_description&&a.push(n[e.detector_index])})),a.length?{detectors:a}:{}}function g(e,t){const a={};return t&&t.customUrls&&(a.custom_settings=e.custom_settings||{},a.custom_settings.custom_urls=t.customUrls),a}function j(e,t){const a={};if(void 0!==e.datafeed_config){const n=JSON.stringify(e.datafeed_config.query),i=JSON.parse(t.datafeedQuery);n!==JSON.stringify(i)&&(a.query=i),e.datafeed_config.query_delay!==t.datafeedQueryDelay&&(a.query_delay=t.datafeedQueryDelay),e.datafeed_config.frequency!==t.datafeedFrequency&&""!==t.datafeedFrequency&&(a.frequency=t.datafeedFrequency),e.datafeed_config.scroll_size!==t.datafeedScrollSize&&(a.scroll_size=t.datafeedScrollSize)}return a}},function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return c}));var n,i=a(16),s=a(52),r=(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),o=function(){var e,t,a={},n=Object.assign(document.createElement("div"),{setPortalProps:function(e){a=e},getInitialPortalProps:function(){return a},mount:function(a,i){i!==t&&(n.unmount(),a.replaceChild(n,i),e=a,t=i)},unmount:function(a){a&&a!==t||e&&t&&(e.replaceChild(t,n),e=void 0,t=void 0)}});return n},l=function(e){function t(t){var a=e.call(this,t)||this;return a.addPropsChannel=function(){Object.assign(a.props.node,{setPortalProps:function(e){a.setState({nodeProps:e})}})},a.state={nodeProps:a.props.node.getInitialPortalProps()},a}return r(t,e),t.prototype.componentDidMount=function(){this.addPropsChannel()},t.prototype.componentDidUpdate=function(){this.addPropsChannel()},t.prototype.render=function(){var e=this,t=this.props,a=t.children,n=t.node;return s.createPortal(i.Children.map(a,(function(t){return i.isValidElement(t)?i.cloneElement(t,e.state.nodeProps):t})),n)},t}(i.PureComponent),c=function(e){function t(t){var a=e.call(this,t)||this;return a.placeholderNode=i.createRef(),a.passPropsThroughPortal(),a}return r(t,e),t.prototype.passPropsThroughPortal=function(){var e=Object.assign({},this.props,{node:void 0});this.props.node.setPortalProps(e)},t.prototype.componentDidMount=function(){var e=this.props.node,t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentDidUpdate=function(){var e=this.props.node,t=this.placeholderNode.current,a=t.parentNode;e.mount(a,t),this.passPropsThroughPortal()},t.prototype.componentWillUnmount=function(){this.props.node.unmount(this.placeholderNode.current)},t.prototype.render=function(){return i.createElement("div",{ref:this.placeholderNode})},t}(i.PureComponent)},function(e,t,a){t.format_value=a(170).format_value,t.parse_value=a(170).parse_value,t.RRule=a(197).RRule,t.parse_calendar=a(309).parse_calendar,t.ParseError=a(309).ParseError,t.CalendarObject=a(117).CalendarObject,t.CalendarProperty=a(117).CalendarProperty,t.iCalendar=a(198).iCalendar,t.VEvent=a(462).VEvent,t.VTimezone=a(463).VTimezone,t.PRODID="-//Tri Tech Computers//node-icalendar//EN"},function(e,t,a){a(232);var n=a(171),i=a(170),s=a(117).CalendarObject,r=a(117).schema,o=a(117).properties,l=a(198).iCalendar,c=i.parse_value,d=(i.format_value,t.ParseError=function(){Error.apply(this,arguments)});function u(e,t){var a=e.calendar;return function n(i,l,d){if("BEGIN"==i){var p=(r[l]||{}).factory,m=void 0!==p?new p(a):new s(a,l);return u(m,(function(){return e.addComponent(m),n.apply(this,arguments)}))}if("END"==i)return t;var b=o[i]||{};return l=c(b.type,l,d,a,b.list),e.addProperty(i,l,d),n}}function p(e){var t,a,n={},i=PROP_NAME,s=0;function r(e){i=e,s=l+1}function o(){return e.substr(s,l-s)}for(var l=0,c=e.length;l<c;++l){var d=e[l];switch(i){case PROP_NAME:":"!=d&&";"!=d||(t=o(),i=PARAM_OR_VALUE,--l);break;case PARAM_OR_VALUE:if(":"==d)r(PROP_VALUE);else{if(";"!=d)throw new Error("Parse error");r(PARAM_NAME)}break;case PARAM_NAME:"="==d&&(a=o(),r(MAYBE_QUOTED_PARAM));break;case MAYBE_QUOTED_PARAM:'"'==d?r(QUOTED_PARAM_VALUE):i=PARAM_VALUE;break;case PARAM_VALUE:":"!=d&&";"!=d||(n[a]=o(),i=PARAM_OR_VALUE,--l);break;case QUOTED_PARAM_VALUE:'"'==d&&(n[a]=o(),i=PARAM_OR_VALUE);break;case PROP_VALUE:l=c;break;default:throw new Error("Invalid parser state")}}return[t,o(),n]}n.inherits(d,Error),PROP_NAME=0,PARAM_NAME=1,PARAM_VALUE=2,MAYBE_QUOTED_PARAM=3,QUOTED_PARAM_VALUE=4,PARAM_OR_VALUE=5,PROP_VALUE=6,t.parse_calendar=function(e,a){e=e.split(/\r?\n/);var n=new l(!0);if(a)if("string"==typeof a&&(a=t.parse_calendar(a)),a instanceof l)for(var i=a.getComponents("VTIMEZONE"),s=0;s<i.length;++s)n.addComponent(i[s]);else n.addComponent(i[s]);var r,o,c,m=(r="BEGIN",o="VCALENDAR",c=u(n),function(e,t,a){if(e!=r)throw new d("Expected "+r+" got "+e);if(o&&o!=t)throw new d("Expected "+o+" got "+t);return c});for(s=0;s<e.length-1;++s)if(e[s].length){if(void 0===m)throw new d("Mismatched BEGIN/END tags");for(var b=s;b+1<e.length&&(" "===e[b+1][0]||"\t"===e[b+1][0]);)++b;var f=e[s];if(b!=s){for(var h=e.slice(s,b+1),g=1;g<h.length;++g)h[g]=h[g].substr(1);f=h.join(""),s=b}m=m.apply(null,p(f))}if(void 0!==m)throw new d("Unable to parse calendar data; END:VCALENDAR not found!");return n}},function(e,t,a){"use strict";let n;a.d(t,"a",(function(){return n})),function(e){e[e.ADD_REQUEST_MESSAGE=0]="ADD_REQUEST_MESSAGE",e[e.RESET_REQUEST_MESSAGES=1]="RESET_REQUEST_MESSAGES",e[e.CLOSE_MODAL=2]="CLOSE_MODAL",e[e.OPEN_MODAL=3]="OPEN_MODAL",e[e.RESET_ADVANCED_EDITOR_MESSAGES=4]="RESET_ADVANCED_EDITOR_MESSAGES",e[e.RESET_FORM=5]="RESET_FORM",e[e.SET_ADVANCED_EDITOR_RAW_STRING=6]="SET_ADVANCED_EDITOR_RAW_STRING",e[e.SET_FORM_STATE=7]="SET_FORM_STATE",e[e.SET_INDEX_PATTERN_TITLES=8]="SET_INDEX_PATTERN_TITLES",e[e.SET_IS_JOB_CREATED=9]="SET_IS_JOB_CREATED",e[e.SET_IS_JOB_STARTED=10]="SET_IS_JOB_STARTED",e[e.SET_IS_MODAL_BUTTON_DISABLED=11]="SET_IS_MODAL_BUTTON_DISABLED",e[e.SET_IS_MODAL_VISIBLE=12]="SET_IS_MODAL_VISIBLE",e[e.SET_JOB_CONFIG=13]="SET_JOB_CONFIG",e[e.SET_JOB_IDS=14]="SET_JOB_IDS",e[e.SWITCH_TO_ADVANCED_EDITOR=15]="SWITCH_TO_ADVANCED_EDITOR",e[e.SWITCH_TO_FORM=16]="SWITCH_TO_FORM",e[e.SET_ESTIMATED_MODEL_MEMORY_LIMIT=17]="SET_ESTIMATED_MODEL_MEMORY_LIMIT",e[e.SET_JOB_CLONE=18]="SET_JOB_CLONE"}(n||(n={}))},function(e,t,a){"use strict";a.d(t,"a",(function(){return v})),a.d(t,"b",(function(){return T}));var n=a(2),i=a(8),s=a(58),r=a.n(s),o=a(312),l=a(188),c=a(310),d=a(127),u=a(80),p=a(19),m=a(30),b=a(90),f=a(74),h=a(47),g=a(157);const j=`${m.a.slice(0,m.a.length-1).join(", ")} or ${[...m.a].pop()}`,x=n.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:j}});function v(e){return null===e?null:Object.keys(e).reduce(((t,a)=>("min"===a&&t.push(n.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsMinError",{defaultMessage:"Model memory limit is lower than estimated value {mml}",values:{mml:e.min.minValue}})),"invalidUnits"===a&&t.push(n.i18n.translate("xpack.ml.dataframe.analytics.create.modelMemoryUnitsInvalidError",{defaultMessage:"Model memory limit data unit unrecognized. It must be {str}",values:{str:j}})),t)),[])}const y=e=>{var t;const{jobConfig:a}=e,n=null==a||null===(t=a.source)||void 0===t?void 0:t.index;return"string"==typeof n?n:Array.isArray(n)?n.join(","):""},O=(e,t)=>{let a=0===Object.keys(h.indexPatterns.validate(e)).length;return a&&("string"==typeof t&&(a=!t.includes(",")),Array.isArray(t)&&(a=!t.some((e=>null==e?void 0:e.includes(","))))),a},E=e=>"number"==typeof e&&e>=f.e&&Number.isInteger(e),w=e=>{var t,a,i,s,r,l;const{jobIdEmpty:c,jobIdValid:d,jobIdExists:p,jobType:m,createIndexPattern:h}=e.form,{jobConfig:g}=e;e.advancedEditorMessages=[];const j=y(e),v=""===j,w=null==g||null===(t=g.source)||void 0===t?void 0:t.index,M=O(j,w),S=null!==(a=null==g||null===(i=g.dest)||void 0===i?void 0:i.index)&&void 0!==a?a:"",_=""===S,T=Object(o.a)(S),C=void 0!==e.indexPatternsMap[S],k=(null==g||null===(s=g.analyzed_fields)||void 0===s?void 0:s.includes)||[],F="string"==typeof(null==g||null===(r=g.dest)||void 0===r?void 0:r.results_field)&&""===(null==g||null===(l=g.dest)||void 0===l?void 0:l.results_field.trim()),I=g.model_memory_limit,D=""===I||void 0===I;if(!D&&void 0!==I){const{valid:t}=Object(u.w)(I);e.form.modelMemoryLimitUnitValid=t}let A=!1,L=!0,R=!0,N=!0;if(void 0!==g.analysis||m!==b.a.CLASSIFICATION&&m!==b.a.REGRESSION||(A=!0),void 0!==g.analysis&&(Object(f.y)(g.analysis)||Object(f.v)(g.analysis))){const t=Object(f.o)(g.analysis)||"";A=""===t,!A&&k.length>0&&!k.includes(t)&&(L=!1,e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.includesInvalid",{defaultMessage:"The dependent variable must be included."}),message:""}));const a=Object(f.t)(g.analysis);void 0!==a&&(isNaN(a)||"number"!=typeof a||a<f.k||a>f.j)&&(R=!1,e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.trainingPercentInvalid",{defaultMessage:"The training percent must be a number between {min} and {max}.",values:{min:f.k,max:f.j}}),message:""}));const i=Object(f.q)(g.analysis);void 0!==i&&(N=E(i),!1===N&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.numTopFeatureImportanceValuesInvalid",{defaultMessage:"The value for num_top_feature_importance_values must be an integer of {min} or higher.",values:{min:0}}),message:""}))}return v?e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameEmpty",{defaultMessage:"The source index name must not be empty."}),message:""}):M||e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.sourceIndexNameValid",{defaultMessage:"Invalid source index name."}),message:""}),_?e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameEmpty",{defaultMessage:"The destination index name must not be empty."}),message:""}):C&&!h?e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameExistsWarn",{defaultMessage:"An index with this destination index name already exists. Be aware that running this analytics job will modify this destination index."}),message:""}):T||e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.destinationIndexNameValid",{defaultMessage:"Invalid destination index name."}),message:""}),F&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.resultsFieldEmptyString",{defaultMessage:"The results field must not be an empty string."}),message:""}),A&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.dependentVariableEmpty",{defaultMessage:"The dependent variable field must not be empty."}),message:""}),D&&e.advancedEditorMessages.push({error:n.i18n.translate("xpack.ml.dataframe.analytics.create.advancedEditorMessage.modelMemoryLimitEmpty",{defaultMessage:"The model memory limit field must not be empty."}),message:""}),e.form.modelMemoryLimitUnitValid||e.advancedEditorMessages.push({error:x,message:""}),e.form.destinationIndexPatternTitleExists=C,e.isValid=L&&R&&e.form.modelMemoryLimitUnitValid&&!c&&d&&!p&&!v&&M&&!_&&T&&!F&&!A&&!D&&N&&(!C||!h),e};const M=Object(i.memoize)((e=>Object(p.a)(Object(p.f)(),function(e){return t=>{if(!t||!e)return null;const a=r()(t.toUpperCase()).value();return r()(e.toUpperCase()).value()>a?{min:{minValue:e,actualValue:t}}:null}}(e),Object(p.c)()))),S=Object(i.memoize)(((e,t)=>M(e)(t)),((...e)=>e.join("_"))),_=e=>{const{jobIdEmpty:t,jobIdValid:a,jobIdExists:n,jobType:i,sourceIndexNameEmpty:s,sourceIndexNameValid:r,destinationIndexNameEmpty:o,destinationIndexNameValid:l,destinationIndexPatternTitleExists:c,createIndexPattern:d,dependentVariable:u,modelMemoryLimit:p,numTopFeatureImportanceValuesValid:m}=e.form,{estimatedModelMemoryLimit:f}=e,h=void 0===i,g=(i===b.a.REGRESSION||i===b.a.CLASSIFICATION)&&""===u,j=S(f,p),x=null!==j&&(void 0!==j.invalidUnits||!0===j.required);return e.form.modelMemoryLimitValidationResult=j,e.isValid=!h&&!x&&!t&&a&&!n&&!s&&r&&!o&&l&&!g&&m&&(!c||!d),e};function T(e,t){var a;switch(t.type){case c.a.ADD_REQUEST_MESSAGE:const n=e.requestMessages;return n.push(t.requestMessage),{...e,requestMessages:n};case c.a.RESET_REQUEST_MESSAGES:return{...e,requestMessages:[]};case c.a.RESET_ADVANCED_EDITOR_MESSAGES:return{...e,advancedEditorMessages:[]};case c.a.RESET_FORM:return Object(d.e)();case c.a.SET_ADVANCED_EDITOR_RAW_STRING:let s,r=!1;try{s=JSON.parse(Object(l.c)(t.advancedEditorRawString));const a=e.form.runtimeMappings&&s.source.runtime_mappings&&!Object(i.isEqual)(e.form.runtimeMappings,s.source.runtime_mappings);r=Object(g.d)(s)||a}catch(a){return{...e,advancedEditorRawString:t.advancedEditorRawString,isAdvancedEditorValidJson:!1,disableSwitchToForm:!0,advancedEditorMessages:[]}}return{...w({...e,jobConfig:s}),advancedEditorRawString:t.advancedEditorRawString,isAdvancedEditorValidJson:!0,disableSwitchToForm:r};case c.a.SET_FORM_STATE:const b={...e.form,...t.payload};if(void 0!==t.payload.destinationIndex&&(b.destinationIndexNameEmpty=""===b.destinationIndex,b.destinationIndexNameValid=Object(o.a)(b.destinationIndex),b.destinationIndexPatternTitleExists=void 0!==e.indexPatternsMap[b.destinationIndex]),void 0!==t.payload.jobId&&(b.jobIdEmpty=""===b.jobId,b.jobIdValid=Object(u.i)(b.jobId),b.jobIdInvalidMaxLength=!!Object(p.b)(m.b)(b.jobId)),void 0!==t.payload.sourceIndex){b.sourceIndexNameEmpty=""===b.sourceIndex;const e=h.indexPatterns.validate(b.sourceIndex);b.sourceIndexNameValid=0===Object.keys(e).length}return void 0!==t.payload.numTopFeatureImportanceValues&&(b.numTopFeatureImportanceValuesValid=E(null==b?void 0:b.numTopFeatureImportanceValues)),e.isAdvancedEditorEnabled?w({...e,form:b}):_({...e,form:b});case c.a.SET_INDEX_PATTERN_TITLES:{const a={...e,...t.payload};return a.form.destinationIndexPatternTitleExists=void 0!==a.indexPatternsMap[a.form.destinationIndex],a}case c.a.SET_IS_JOB_CREATED:return{...e,isJobCreated:t.isJobCreated};case c.a.SET_IS_JOB_STARTED:return{...e,isJobStarted:t.isJobStarted};case c.a.SET_JOB_CONFIG:return w({...e,jobConfig:t.payload});case c.a.SWITCH_TO_ADVANCED_EDITOR:const f=Object(d.f)(e.form),j=Object(g.d)(f);return w({...e,advancedEditorRawString:JSON.stringify(f,null,2),isAdvancedEditorEnabled:!0,disableSwitchToForm:j,hasSwitchedToEditor:!0,jobConfig:f});case c.a.SWITCH_TO_FORM:const{jobConfig:x}=e,{jobId:v}=e.form,M=Object(d.d)(x,!1);"string"==typeof v&&""!==v.trim()&&(M.jobId=v),M.jobIdEmpty=""===v,M.jobIdValid=Object(u.i)(v),M.jobIdInvalidMaxLength=!!Object(p.b)(m.b)(v),M.destinationIndexNameEmpty=""===M.destinationIndex,M.destinationIndexNameValid=Object(o.a)(M.destinationIndex||""),M.destinationIndexPatternTitleExists=void 0!==e.indexPatternsMap[M.destinationIndex||""],void 0!==M.numTopFeatureImportanceValues&&(M.numTopFeatureImportanceValuesValid=E(M.numTopFeatureImportanceValues));const S=y(e),T=null==x||null===(a=x.source)||void 0===a?void 0:a.index,C=O(S,T);return M.sourceIndexNameValid=C,_({...e,form:M,isAdvancedEditorEnabled:!1,advancedEditorRawString:JSON.stringify(x,null,2),jobConfig:x});case c.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT:return{...e,estimatedModelMemoryLimit:t.value};case c.a.SET_JOB_CLONE:return{...e,cloneJob:t.cloneJob}}return e}},function(e,t,a){"use strict";a.d(t,"a",(function(){return i}));const n=window;function i(e){return"string"==typeof e&&e===e.toLowerCase()&&/^[^\*\\/\?"<>|\s,#:]+$/.test(e)&&/^[^-_\+]+$/.test(e.charAt(0))&&"."!==e&&".."!==e&&function(e){return!(n.TextEncoder&&new n.TextEncoder("utf-8").encode(e).length>255)&&e.length<=255}(e)}},function(e,t,a){e.exports=a(23)(3034)},function(e,t,a){e.exports=a(23)(3083)},function(e,t,a){e.exports=a(316)},function(e,t,a){var n=a(317),i=a(200),s=a(318),r=a(122);e.exports=function(e,t){return(r(e)?n:i)(e,s(t))}},function(e,t,a){e.exports=a(23)(3040)},function(e,t,a){e.exports=a(23)(3e3)},function(e,t,a){var n=a(488),i=a(489),s=a(134),r=a(122);e.exports=function(e,t){return(r(e)?n:i)(e,s(t,3))}},function(e,t,a){e.exports=a(23)(1285)},function(e,t,a){e.exports=a(23)(3086)},function(e,t,a){var n=a(173);e.exports=function(e){return e==e&&!n(e)}},function(e,t){e.exports=function(e,t){return function(a){return null!=a&&(a[e]===t&&(void 0!==t||e in Object(a)))}}},function(e,t,a){var n=a(495),i=a(325);e.exports=function(e,t){return null!=e&&i(e,t,n)}},function(e,t,a){var n=a(237),i=a(238),s=a(122),r=a(326),o=a(496),l=a(201);e.exports=function(e,t,a){for(var c=-1,d=(t=n(t,e)).length,u=!1;++c<d;){var p=l(t[c]);if(!(u=null!=e&&a(e,p)))break;e=e[p]}return u||++c!=d?u:!!(d=null==e?0:e.length)&&o(d)&&r(p,d)&&(s(e)||i(e))}},function(e,t,a){e.exports=a(23)(1291)},function(e,t,a){e.exports=a(23)(3029)},function(e,t){e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},function(e,t,a){var n=a(499),i=a(325);e.exports=function(e,t){return null!=e&&i(e,t,n)}},function(e,t,a){e.exports=a(23)(3045)},function(e,t,a){e.exports=a(23)(674)},function(e,t){e.exports=function(e){return void 0===e}},function(e,t,a){var n=a(243),i=a(134),s=a(334),r=a(122);e.exports=function(e,t){return(r(e)?n:s)(e,i(t,3))}},function(e,t,a){var n=a(200),i=a(158);e.exports=function(e,t){var a=-1,s=i(e)?Array(e.length):[];return n(e,(function(e,n,i){s[++a]=t(e,n,i)})),s}},function(e,t,a){var n=a(502),i=a(200),s=a(134),r=a(503),o=a(122);e.exports=function(e,t,a){var l=o(e)?n:r,c=arguments.length<3;return l(e,s(t,4),a,c,i)}},function(e,t,a){e.exports=a(23)(3079)},function(e,t){e.exports=function(e,t,a,n){for(var i=e.length,s=a+(n?1:-1);n?s--:++s<i;)if(t(e[s],s,e))return s;return-1}},function(e,t,a){e.exports=a(23)(3095)},function(e,t,a){var n=a(158),i=a(525);e.exports=function(e){return i(e)&&n(e)}},function(e,t,a){var n=a(526),i=a(172);e.exports=function(e){return null==e?[]:n(e,i(e))}},function(e,t,a){var n=a(118),i=a(342);e.exports=function(e,t,a,n){return function(e,t,a,n){var s,r,o={},l=new i,c=function(e){var t=e.v!==s?e.v:e.w,n=o[t],i=a(e),c=r.distance+i;if(i<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+i);c<n.distance&&(n.distance=c,n.predecessor=s,l.decrease(t,c))};e.nodes().forEach((function(e){var a=e===t?0:Number.POSITIVE_INFINITY;o[e]={distance:a},l.add(e,a)}));for(;l.size()>0&&(s=l.removeMin(),(r=o[s]).distance!==Number.POSITIVE_INFINITY);)n(s).forEach(c);return o}(e,String(t),a||s,n||function(t){return e.outEdges(t)})};var s=n.constant(1)},function(e,t,a){var n=a(118);function i(){this._arr=[],this._keyIndices={}}e.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map((function(e){return e.key}))},i.prototype.has=function(e){return n.has(this._keyIndices,e)},i.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(e,t){var a=this._keyIndices;if(e=String(e),!n.has(a,e)){var i=this._arr,s=i.length;return a[e]=s,i.push({key:e,priority:t}),this._decrease(s),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},i.prototype.decrease=function(e,t){var a=this._keyIndices[e];if(t>this._arr[a].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[a].priority+" New: "+t);this._arr[a].priority=t,this._decrease(a)},i.prototype._heapify=function(e){var t=this._arr,a=2*e,n=a+1,i=e;a<t.length&&(i=t[a].priority<t[i].priority?a:i,n<t.length&&(i=t[n].priority<t[i].priority?n:i),i!==e&&(this._swap(e,i),this._heapify(i)))},i.prototype._decrease=function(e){for(var t,a=this._arr,n=a[e].priority;0!==e&&!(a[t=e>>1].priority<n);)this._swap(e,t),e=t},i.prototype._swap=function(e,t){var a=this._arr,n=this._keyIndices,i=a[e],s=a[t];a[e]=s,a[t]=i,n[s.key]=e,n[i.key]=t}},function(e,t,a){var n=a(118);e.exports=function(e){var t=0,a=[],i={},s=[];function r(o){var l=i[o]={onStack:!0,lowlink:t,index:t++};if(a.push(o),e.successors(o).forEach((function(e){n.has(i,e)?i[e].onStack&&(l.lowlink=Math.min(l.lowlink,i[e].index)):(r(e),l.lowlink=Math.min(l.lowlink,i[e].lowlink))})),l.lowlink===l.index){var c,d=[];do{c=a.pop(),i[c].onStack=!1,d.push(c)}while(o!==c);s.push(d)}}return e.nodes().forEach((function(e){n.has(i,e)||r(e)})),s}},function(e,t,a){var n=a(118);function i(e){var t={},a={},i=[];if(n.each(e.sinks(),(function r(o){if(n.has(a,o))throw new s;n.has(t,o)||(a[o]=!0,t[o]=!0,n.each(e.predecessors(o),r),delete a[o],i.push(o))})),n.size(t)!==e.nodeCount())throw new s;return i}function s(){}e.exports=i,i.CycleException=s,s.prototype=new Error},function(e,t,a){var n=a(118);function i(e,t,a,s,r,o){n.has(s,t)||(s[t]=!0,a||o.push(t),n.each(r(t),(function(t){i(e,t,a,s,r,o)})),a&&o.push(t))}e.exports=function(e,t,a){n.isArray(t)||(t=[t]);var s=(e.isDirected()?e.successors:e.neighbors).bind(e),r=[],o={};return n.each(t,(function(t){if(!e.hasNode(t))throw new Error("Graph does not have node: "+t);i(e,t,"post"===a,o,s,r)})),r}},function(e,t,a){e.exports=a(23)(1287)},function(e,t,a){e.exports=a(23)(668)},function(e,t,a){var n=a(346),i=a(553);e.exports=function(e,t,a){(void 0!==a&&!i(e[t],a)||void 0===a&&!(t in e))&&n(e,t,a)}},function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},function(e,t,a){e.exports=a(23)(1308)},function(e,t){e.exports=function(e,t){return e<t}},function(e,t,a){e.exports=a(23)(1286)},function(e,t,a){"use strict";var n=a(88),i=a(121).Graph,s=a(203).slack;function r(e,t){return n.forEach(e.nodes(),(function a(i){n.forEach(t.nodeEdges(i),(function(n){var r=n.v,o=i===r?n.w:r;e.hasNode(o)||s(t,n)||(e.setNode(o,{}),e.setEdge(i,o,{}),a(o))}))})),e.nodeCount()}function o(e,t){return n.minBy(t.edges(),(function(a){if(e.hasNode(a.v)!==e.hasNode(a.w))return s(t,a)}))}function l(e,t,a){n.forEach(e.nodes(),(function(e){t.node(e).rank+=a}))}e.exports=function(e){var t,a,n=new i({directed:!1}),c=e.nodes()[0],d=e.nodeCount();n.setNode(c,{});for(;r(n,e)<d;)t=o(n,e),a=n.hasNode(t.v)?s(e,t):-s(e,t),l(n,e,a);return n}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(619);case"v8light":return a(621)}},function(e,t,a){"use strict";var n=a(125);Object.defineProperty(t,"__esModule",{value:!0}),t.KbnFieldType=void 0;var i=n(a(5)),s=a(204);t.KbnFieldType=class KbnFieldType{constructor(e={}){(0,i.default)(this,"name",void 0),(0,i.default)(this,"sortable",void 0),(0,i.default)(this,"filterable",void 0),(0,i.default)(this,"esTypes",void 0),this.name=e.name||s.KBN_FIELD_TYPES.UNKNOWN,this.sortable=e.sortable||!1,this.filterable=e.filterable||!1,this.esTypes=Object.freeze((e.esTypes||[]).slice())}}},,,,,,,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"b",(function(){return l})),a.d(t,"a",(function(){return c}));var n=a(16),i=a(44),s=a(45),r=a(208),o=a(12);const l=48,c=({defaultTitle:e,initialInput:t,onCreate:a,onCancel:c})=>{var d;const[u,p]=Object(n.useState)(e),[m,b]=Object(n.useState)(null!==(d=null==t?void 0:t.maxSeriesToPlot)&&void 0!==d?d:r.b),f=u.length>0,h=f&&m>0;return Object(o.jsx)(i.EuiModal,{initialFocus:"[name=panelTitle]",onClose:c,"data-test-subj":"mlAnomalyChartsEmbeddableInitializer"},Object(o.jsx)(i.EuiModalHeader,null,Object(o.jsx)(i.EuiModalHeaderTitle,null,Object(o.jsx)("h2",null,Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.title",defaultMessage:"Anomaly explorer charts configuration"})))),Object(o.jsx)(i.EuiModalBody,null,Object(o.jsx)(i.EuiForm,null,Object(o.jsx)(i.EuiFormRow,{label:Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.panelTitleLabel",defaultMessage:"Panel title"}),isInvalid:!f},Object(o.jsx)(i.EuiFieldText,{"data-test-subj":"panelTitleInput",id:"panelTitle",name:"panelTitle",value:u,onChange:e=>p(e.target.value),isInvalid:!f})),Object(o.jsx)(i.EuiFormRow,{label:Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.maxSeriesToPlotLabel",defaultMessage:"Maximum number of series to plot"})},Object(o.jsx)(i.EuiFieldNumber,{"data-test-subj":"mlAnomalyChartsInitializerMaxSeries",id:"selectMaxSeriesToPlot",name:"selectMaxSeriesToPlot",value:m,onChange:e=>b(parseInt(e.target.value,10)),min:0,max:l})))),Object(o.jsx)(i.EuiModalFooter,null,Object(o.jsx)(i.EuiButtonEmpty,{onClick:c,"data-test-subj":"mlAnomalyChartsInitializerCancelButton"},Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(o.jsx)(i.EuiButton,{"data-test-subj":"mlAnomalyChartsInitializerConfirmButton",isDisabled:!h,onClick:a.bind(null,{panelTitle:u,maxSeriesToPlot:m}),fill:!0},Object(o.jsx)(s.FormattedMessage,{id:"xpack.ml.anomalyChartsEmbeddable.setupModal.confirmButtonLabel",defaultMessage:"Confirm configurations"}))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(16),i=a(72),s=a(110),r=a(31);const o=()=>{const e=Object(i.h)();return Object(n.useMemo)((()=>new s.a({"histogram:maxBars":e.get(r.UI_SETTINGS.HISTOGRAM_MAX_BARS),"histogram:barTarget":e.get(r.UI_SETTINGS.HISTOGRAM_BAR_TARGET),dateFormat:e.get("dateFormat"),"dateFormat:scaled":e.get("dateFormat:scaled")})),[e])}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a(16);var n=a(44),i=a(2),s=a(161),r=a(53),o=a(12);const l=({models:e,hideColumns:t=["node_name"]})=>{const a=Object(s.a)(r.FIELD_FORMAT_IDS.BYTES),l=Object(s.a)(r.FIELD_FORMAT_IDS.DATE),c=Object(s.a)(r.FIELD_FORMAT_IDS.DURATION),d=[{id:"node_name",field:"node.name",name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.nodeNameHeader",{defaultMessage:"Node name"}),width:"200px",sortable:!0,truncateText:!1,"data-test-subj":"mlAllocatedModelsTableNodeName"},{id:"model_id",field:"model_id",name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelNameHeader",{defaultMessage:"Name"}),width:"300px",sortable:!0,truncateText:!1,"data-test-subj":"mlAllocatedModelsTableName"},{name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelSizeHeader",{defaultMessage:"Size"}),width:"100px",truncateText:!0,"data-test-subj":"mlAllocatedModelsTableSize",render:e=>a(e.required_native_memory_bytes)},{field:"state",name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelStateHeader",{defaultMessage:"State"}),width:"100px",truncateText:!1,"data-test-subj":"mlAllocatedModelsTableState"},{name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelAvgInferenceTimeHeader",{defaultMessage:"Avg inference time"}),width:"100px",truncateText:!1,"data-test-subj":"mlAllocatedModelsTableAvgInferenceTime",render:e=>e.node.average_inference_time_ms?c(e.node.average_inference_time_ms):"-"},{name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelInferenceCountHeader",{defaultMessage:"Inference count"}),width:"100px","data-test-subj":"mlAllocatedModelsTableInferenceCount",render:e=>e.node.inference_count},{name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelStartTimeHeader",{defaultMessage:"Start time"}),width:"200px","data-test-subj":"mlAllocatedModelsTableStartedTime",render:e=>l(e.node.start_time)},{name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelLastAccessHeader",{defaultMessage:"Last access"}),width:"200px","data-test-subj":"mlAllocatedModelsTableInferenceCount",render:e=>l(e.node.last_access)},{name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelNumberOfPendingRequestsHeader",{defaultMessage:"Pending requests"}),width:"100px","data-test-subj":"mlAllocatedModelsTableNumberOfPendingRequests",render:e=>e.node.number_of_pending_requests},{name:i.i18n.translate("xpack.ml.trainedModels.nodesList.modelsList.modelRoutingStateHeader",{defaultMessage:"Routing state"}),width:"100px","data-test-subj":"mlAllocatedModelsTableRoutingState",render:e=>{const{routing_state:t,reason:a}=e.node.routing_state;return Object(o.jsx)(n.EuiToolTip,{content:a||""},Object(o.jsx)(n.EuiBadge,{color:a?"danger":"hollow"},t))}}].filter((e=>!t.includes(e.id)));return Object(o.jsx)(n.EuiInMemoryTable,{allowNeutralSort:!1,columns:d,hasActions:!1,isExpandable:!1,isSelectable:!1,items:e,itemId:"model_id",rowProps:e=>({"data-test-subj":`mlAllocatedModelTableRow row-${e.model_id}`}),onTableChange:()=>{},"data-test-subj":"mlNodesTable"})}},,,,,,,,,,,,function(e,t,a){"use strict";a.d(t,"a",(function(){return jobs_list_view_JobsListView}));var n=a(5),i=a.n(n),s=a(16),r=a.n(s),o=a(44),l=a(73),c=a(124),d=a(8),u=a(24),p=a.n(u),m=a(98),b=a(76),f=a(95),h=a(295),g=a(2),j=a(17);const x=e=>Object(j.isPopulatedObject)(e,["customSettings"])&&!0===e.customSettings.managed||Object(j.isPopulatedObject)(e,["custom_settings"])&&!0===e.custom_settings.managed;function v(e,t,a,n,i,s,r,o){const l=Object(b.e)("canCreateJob")&&Object(f.e)(),d=Object(b.e)("canUpdateJob"),u=Object(b.e)("canDeleteJob"),p=Object(b.e)("canUpdateDatafeed"),m=Object(b.e)("canStartStopDatafeed")&&Object(f.e)(),j=Object(b.e)("canCloseJob")&&Object(f.e)(),v=Object(b.e)("canResetJob")&&Object(f.e)(),E=Object(b.e)("canCreateMlAlerts");return[{name:g.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedLabel",{defaultMessage:"Start datafeed"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.startDatafeedDescription",{defaultMessage:"Start datafeed"}),icon:"play",enabled:e=>!1===y(e)&&m,available:e=>Object(c.i)([e]),onClick:e=>{n([e]),O()},"data-test-subj":"mlActionButtonStartDatafeed"},{name:g.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedLabel",{defaultMessage:"Stop datafeed"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.stopDatafeedDescription",{defaultMessage:"Stop datafeed"}),icon:"stop",enabled:e=>!1===y(e)&&m,available:e=>Object(c.j)([e]),onClick:e=>{x(e)?s([e]):Object(c.m)([e],r),O(!0)},"data-test-subj":"mlActionButtonStopDatafeed"},{name:g.i18n.translate("xpack.ml.jobsList.managementActions.createAlertLabel",{defaultMessage:"Create alert rule"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.createAlertLabel",{defaultMessage:"Create alert rule"}),icon:"bell",enabled:e=>!1===y(e),available:()=>E,onClick:e=>{o([e.id]),O(!0)},"data-test-subj":"mlActionButtonCreateAlert"},{name:g.i18n.translate("xpack.ml.jobsList.managementActions.closeJobLabel",{defaultMessage:"Close job"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.closeJobDescription",{defaultMessage:"Close job"}),icon:"cross",enabled:e=>!1===y(e)&&j,available:e=>Object(c.g)([e]),onClick:e=>{x(e)?i([e]):Object(c.c)([e],r),O(!0)},"data-test-subj":"mlActionButtonCloseJob"},{name:g.i18n.translate("xpack.ml.jobsList.managementActions.resetJobLabel",{defaultMessage:"Reset job"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.resetJobDescription",{defaultMessage:"Reset job"}),icon:"refresh",enabled:e=>function(e){if(void 0===e.blocked||e.blocked.reason===h.a.RESET)return!0;return!1}(e)&&v,available:e=>Object(c.h)([e]),onClick:e=>{a([e]),O(!0)},"data-test-subj":"mlActionButtonResetJob"},{name:g.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobLabel",{defaultMessage:"Clone job"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.cloneJobDescription",{defaultMessage:"Clone job"}),icon:"copy",enabled:e=>!1===y(e)&&l,onClick:e=>{Object(c.b)(e.id),O(!0)},"data-test-subj":"mlActionButtonCloneJob"},{name:g.i18n.translate("xpack.ml.jobsList.managementActions.editJobLabel",{defaultMessage:"Edit job"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.editJobDescription",{defaultMessage:"Edit job"}),icon:"pencil",enabled:e=>!1===y(e)&&d&&p,onClick:t=>{e(t),O()},"data-test-subj":"mlActionButtonEditJob"},{name:g.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobLabel",{defaultMessage:"Delete job"}),description:g.i18n.translate("xpack.ml.jobsList.managementActions.deleteJobDescription",{defaultMessage:"Delete job"}),icon:"trash",color:"danger",enabled:()=>u,onClick:e=>{t([e]),O()},"data-test-subj":"mlActionButtonDeleteJob"}]}function y(e){return void 0!==e.blocked}function O(e=!1){e?document.querySelector(".euiTable").click():window.setTimeout((()=>{const e=document.querySelector(".euiModalBody");e?e.click():document.querySelector(".euiTable").click()}),500)}var E=a(297),w=a(12);function M({jobs:e}){const t=g.i18n.translate("xpack.ml.jobsList.resultActions.openJobsInSingleMetricViewerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Single Metric Viewer",values:{jobsCount:e.length,jobId:e[0].id}}),a=g.i18n.translate("xpack.ml.jobsList.resultActions.openJobsInAnomalyExplorerText",{defaultMessage:"Open {jobsCount, plural, one {{jobId}} other {# jobs}} in Anomaly Explorer",values:{jobsCount:e.length,jobId:e[0].id}}),n=e.length<2,i=1===e.length&&e[0].isSingleMetricViewerJob,r=1===e.length&&e[0].isNotSingleMetricViewerJobMessage,l=void 0!==r?g.i18n.translate("xpack.ml.jobsList.resultActions.singleMetricDisabledMessageText",{defaultMessage:"Disabled because {reason}.",values:{reason:r}}):void 0,c=1===e.length&&void 0!==e[0].blocked,{createLinkWithUserDefaults:d}=Object(E.a)(),u=Object(s.useMemo)((()=>d("timeseriesexplorer",e)),[e]),p=Object(s.useMemo)((()=>d("explorer",e)),[e]);return Object(w.jsx)(o.EuiFlexGroup,{gutterSize:"xs",justifyContent:"flexEnd",alignItems:"center",wrap:!1,direction:"row",responsive:!1},n&&Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiToolTip,{position:"bottom",content:null!=l?l:t},Object(w.jsx)(o.EuiButtonIcon,{href:u,iconType:"visLine","aria-label":t,className:"results-button",isDisabled:!1===i||!0===c,"data-test-subj":"mlOpenJobsInSingleMetricViewerButton"}))),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiToolTip,{position:"bottom",content:a},Object(w.jsx)(o.EuiButtonIcon,{href:p,iconType:"visTable","aria-label":a,className:"results-button",isDisabled:!0===c,"data-test-subj":"mlOpenJobsInAnomalyExplorerButton"}))))}var S=a(154);const _=({name:e})=>Object(w.jsx)(o.EuiBadge,{key:`${e}-id`,"data-test-subj":"mlJobGroup",color:Object(S.a)(e)},e);var T=a(72),C=a(0);function k(e){return void 0!==e.groupId}const F=e=>{const t=Object(T.d)(),[a,n]=Object(s.useState)("");return Object(s.useEffect)((()=>{let a=!1;return(async()=>{const i={};if(k(e)?i.groupIds=[e.groupId]:i.jobId=e.id,t){const e=await t.getUrl({page:C.b.ANOMALY_DETECTION_JOBS_MANAGE,pageState:i});a||n(e)}})(),()=>{a=!0}}),[e,t]),k(e)?Object(w.jsx)(o.EuiLink,{style:{marginLeft:"4px"},key:e.groupId,href:a},Object(w.jsx)(_,{name:e.groupId})):Object(w.jsx)(o.EuiLink,{key:e.id,href:a},e.id)};function I({job:e,isManagementTable:t}){return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)("div",{className:"job-description"},e.description,"  ",e.groups.map((e=>!0===t?Object(w.jsx)(F,{key:e,groupId:e}):Object(w.jsx)(_,{key:e,name:e})))))}var D=a(401),A=a(400),L=a(141),R=a(45);const N=[10,25,50];class jobs_list_JobsList extends s.Component{constructor(e){super(e),i()(this,"onTableChange",(({page:e={},sort:t={}})=>{const{index:a,size:n}=e,{field:i,direction:s}=t;this.props.onJobsViewStateUpdate({pageIndex:a,pageSize:n,sortField:i,sortDirection:s})})),i()(this,"toggleRow",(e=>{this.props.toggleRow(e.id)})),this.state={jobsSummaryList:e.jobsSummaryList,itemIdToExpandedRowMap:{}}}static getDerivedStateFromProps(e){return{itemIdToExpandedRowMap:e.itemIdToExpandedRowMap,jobsSummaryList:e.jobsSummaryList}}getJobIdLink(e){return!1===this.props.isMlEnabledInSpace?e:Object(w.jsx)(F,{key:e,id:e})}getPageOfJobs(e,t,a,n){let i=this.state.jobsSummaryList;i=Object(d.sortBy)(this.state.jobsSummaryList,(e=>e[a])),i="asc"===n?i:i.reverse();const s=i.length;let r=e*t;return r>=s&&0!==s&&(r=Math.floor((s-1)/t)*t,setTimeout((()=>{this.props.onJobsViewStateUpdate({pageIndex:r/t})}),0)),{pageOfItems:i.slice(r,r+t),totalItemCount:s}}render(){const{loading:e,isManagementTable:t,spacesApi:a}=this.props,n={selectable:e=>void 0===e.blocked,selectableMessage:(e,t)=>!1===e?g.i18n.translate("xpack.ml.jobsList.cannotSelectRowForJobMessage",{defaultMessage:"Cannot select job ID {jobId}",values:{jobId:t.id}}):g.i18n.translate("xpack.ml.jobsList.selectRowForJobMessage",{defaultMessage:"Select the row for job ID {jobId}",values:{jobId:t.id}}),onSelectionChange:this.props.selectJobChange},i=[{name:Object(w.jsx)(o.EuiScreenReaderOnly,null,Object(w.jsx)("p",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.showDetailsColumn.screenReaderDescription",defaultMessage:"This column contains clickable controls for showing more details on each job"}))),render:e=>Object(w.jsx)(o.EuiButtonIcon,{onClick:()=>this.toggleRow(e),isDisabled:void 0!==e.blocked,iconType:this.state.itemIdToExpandedRowMap[e.id]?"arrowDown":"arrowRight","aria-label":this.state.itemIdToExpandedRowMap[e.id]?g.i18n.translate("xpack.ml.jobsList.collapseJobDetailsAriaLabel",{defaultMessage:"Hide details for {itemId}",values:{itemId:e.id}}):g.i18n.translate("xpack.ml.jobsList.expandJobDetailsAriaLabel",{defaultMessage:"Show details for {itemId}",values:{itemId:e.id}}),"data-row-id":e.id,"data-test-subj":"mlJobListRowDetailsToggle"}),width:"3%"},{field:"id","data-test-subj":"mlJobListColumnId",name:g.i18n.translate("xpack.ml.jobsList.idLabel",{defaultMessage:"ID"}),sortable:!0,truncateText:!1,width:"15%",scope:"row",render:t?e=>this.getJobIdLink(e):(e,t)=>x(t)?Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)("span",null,e,"  ",Object(w.jsx)(o.EuiToolTip,{content:g.i18n.translate("xpack.ml.jobsList.managedBadgeTooltip",{defaultMessage:"This job is preconfigured and managed by Elastic; other parts of the product might have might have dependencies on its behavior."})},Object(w.jsx)(o.EuiBadge,{color:"hollow","data-test-subj":"mlJobListRowManagedLabel",size:"xs"},g.i18n.translate("xpack.ml.jobsList.managedBadgeLabel",{defaultMessage:"Managed"}))))):e},{field:"auditMessage",name:Object(w.jsx)(o.EuiScreenReaderOnly,null,Object(w.jsx)("p",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.auditMessageColumn.screenReaderDescription",defaultMessage:"This column displays icons when there are errors or warnings for the job in the past 24 hours"}))),render:e=>Object(w.jsx)(D.a,{message:e,showTooltip:!0})},{field:"alertingRules",name:Object(w.jsx)(o.EuiScreenReaderOnly,null,Object(w.jsx)("p",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.alertingRules.screenReaderDescription",defaultMessage:"This column displays icons when there are alert rules associated with a job"}))),width:"30px",render:e=>Array.isArray(e)?Object(w.jsx)(o.EuiToolTip,{position:"bottom",content:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.alertingRules.tooltipContent",defaultMessage:"Job has {rulesCount} associated alert {rulesCount, plural, one { rule} other { rules}}",values:{rulesCount:e.length}})},Object(w.jsx)(o.EuiIcon,{type:"bell"})):Object(w.jsx)("span",null)},{name:g.i18n.translate("xpack.ml.jobsList.descriptionLabel",{defaultMessage:"Description"}),sortable:!0,field:"description","data-test-subj":"mlJobListColumnDescription",render:(e,a)=>Object(w.jsx)(I,{job:a,isManagementTable:t}),textOnly:!0,width:"20%"},{field:"processed_record_count","data-test-subj":"mlJobListColumnRecordCount",name:g.i18n.translate("xpack.ml.jobsList.processedRecordsLabel",{defaultMessage:"Processed records"}),sortable:!0,truncateText:!1,dataType:"number",render:e=>Object(m.g)(e),width:"10%"},{field:"memory_status","data-test-subj":"mlJobListColumnMemoryStatus",name:g.i18n.translate("xpack.ml.jobsList.memoryStatusLabel",{defaultMessage:"Memory status"}),sortable:!0,truncateText:!1,width:"5%"},{field:"jobState","data-test-subj":"mlJobListColumnJobState",name:g.i18n.translate("xpack.ml.jobsList.jobStateLabel",{defaultMessage:"Job state"}),sortable:!0,truncateText:!1,width:"8%"},{field:"datafeedState","data-test-subj":"mlJobListColumnDatafeedState",name:g.i18n.translate("xpack.ml.jobsList.datafeedStateLabel",{defaultMessage:"Datafeed state"}),sortable:!0,truncateText:!1,width:"8%"},{name:g.i18n.translate("xpack.ml.jobsList.actionsLabel",{defaultMessage:"Actions"}),render:e=>Object(w.jsx)(M,{jobs:[e]}),width:"8%"}];!0===t?(a&&i.splice(i.length-1,0,{name:g.i18n.translate("xpack.ml.jobsList.spacesLabel",{defaultMessage:"Spaces"}),render:e=>Object(w.jsx)(A.a,{spacesApi:a,spaceIds:e.spaceIds,jobId:e.id,jobType:"anomaly-detector",refresh:this.props.refreshJobs}),"data-test-subj":"mlJobListColumnSpaces"}),!1===this.props.isMlEnabledInSpace&&i.pop()):(i.splice(i.length-1,0,{name:g.i18n.translate("xpack.ml.jobsList.latestTimestampLabel",{defaultMessage:"Latest timestamp"}),truncateText:!1,field:"latestTimestampSortValue","data-test-subj":"mlJobListColumnLatestTimestamp",sortable:!0,render:(e,t)=>Object(w.jsx)("span",{className:"euiTableCellContent__text"},void 0===t.latestTimestampMs?"":p()(t.latestTimestampMs).format(L.a)),textOnly:!0,width:"15%"}),i.push({name:Object(w.jsx)(o.EuiScreenReaderOnly,null,Object(w.jsx)("p",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.jobActionsColumn.screenReaderDescription",defaultMessage:"This column contains extra actions in a menu that can be performed on each job"}))),actions:v(this.props.showEditJobFlyout,this.props.showDeleteJobModal,this.props.showResetJobModal,this.props.showStartDatafeedModal,this.props.showCloseJobsConfirmModal,this.props.showStopDatafeedsConfirmModal,this.props.refreshJobs,this.props.showCreateAlertFlyout),width:"40px"}));const{pageIndex:s,pageSize:l,sortField:c,sortDirection:d}=this.props.jobsViewState,{pageOfItems:u,totalItemCount:b}=this.getPageOfJobs(s,l,c,d),f={pageIndex:s,pageSize:l,totalItemCount:b,pageSizeOptions:N},h={sort:{field:c,direction:d}},j=this.props.selectedJobsCount?"jobs-selected":"";return Object(w.jsx)(o.EuiBasicTable,{"data-test-subj":e?"mlJobListTable loading":"mlJobListTable loaded",loading:!0===e,noItemsMessage:e?g.i18n.translate("xpack.ml.jobsList.loadingJobsLabel",{defaultMessage:"Loading jobs…"}):g.i18n.translate("xpack.ml.jobsList.noJobsFoundLabel",{defaultMessage:"No jobs found"}),itemId:"id",className:`jobs-list-table ${j}`,items:u,columns:i,pagination:f,onChange:this.onTableChange,selection:t?void 0:n,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,isExpandable:!0,sorting:h,hasActions:!0,rowProps:e=>({"data-test-subj":`mlJobListRow row-${e.id}`})})}}jobs_list_JobsList.defaultProps={isManagementTable:!1,isMlEnabledInSpace:!0,loading:!1};var P=a(58),z=a.n(P);function B(e,t=2){if(void 0===e)return"";if(e%1==0)return e;if(Math.abs(e)<Math.pow(10,-t))return Number.parseFloat(String(e)).toExponential(2);const a=Math.pow(10,t);return Math.round(e*a)/a}var J=a(82);function V(e){if(!e)return["",""];const[t,a]=e;switch(t){case"finished_time":case"create_time":case"log_time":case"timestamp":case"earliest_record_timestamp":case"latest_record_timestamp":case"last_data_time":case"latest_empty_bucket_timestamp":case"latest_sparse_bucket_timestamp":case"latest_bucket_timestamp":return[t,Object(J.d)(a)];case"established_model_memory":case"input_bytes":case"model_bytes":case"model_bytes_exceeded":case"model_bytes_memory_limit":case"peak_model_bytes":return[t,(n=a,z()(n).format("0.0 b"))];case"processed_record_count":case"processed_field_count":case"input_field_count":case"invalid_date_count":case"missing_field_count":case"out_of_order_timestamp_count":case"empty_bucket_count":case"sparse_bucket_count":case"bucket_count":case"input_record_count":case"total_by_field_count":case"total_over_field_count":case"total_partition_field_count":case"bucket_allocation_failures_count":case"search_count":return[t,Object(m.g)(a)];case"average_search_time_per_bucket_ms":case"exponential_average_search_time_per_hour_ms":case"total_bucket_processing_time_ms":case"minimum_bucket_processing_time_ms":case"maximum_bucket_processing_time_ms":case"average_bucket_processing_time_ms":case"exponential_average_bucket_processing_time_ms":case"exponential_average_bucket_processing_time_per_hour_ms":return[t,"number"==typeof a?B(a,3).toLocaleString():a];case"managed":return[t,a.toString()];default:return[t,a]}var n}function U(e,t,a){return Object.keys(e).filter((n=>a||"object"!=typeof e[n]||t&&Array.isArray(e[n]))).map((t=>{let a=e[t];return Array.isArray(a)?a=a.join(", "):"object"==typeof e[t]&&(a=JSON.stringify(a)),[t,a]}))}var G=a(228);var q=a(140);function W({job:e}){const t=JSON.stringify(e,null,2);return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"s"}),Object(w.jsx)(q.a,{value:t,readOnly:!0,mode:q.b.XJSON}))}var H=a(80);class datafeed_preview_tab_DatafeedPreviewPane extends s.Component{constructor(e){super(e),this.state={previewJson:"",loading:!0,canPreviewDatafeed:!0}}renderContent(){const{previewJson:e,loading:t,canPreviewDatafeed:a}=this.state;return!1===a?Object(w.jsx)(o.EuiCallOut,{title:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.noPermissionToViewDatafeedPreviewTitle",defaultMessage:"You do not have permission to view the datafeed preview"}),color:"warning",iconType:"alert"},Object(w.jsx)("p",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.pleaseContactYourAdministratorLabel",defaultMessage:"Please contact your administrator"}))):!0===t?Object(w.jsx)(o.EuiLoadingSpinner,{size:"xl"}):Object(w.jsx)(q.a,{value:e,readOnly:!0})}componentDidMount(){const e=Object(b.e)("canPreviewDatafeed")&&void 0!==this.props.job.datafeed_config;this.setState({canPreviewDatafeed:e}),function(e,t){return new Promise(((a,n)=>{t&&l.ml.jobs.datafeedPreview(e.datafeed_config.datafeed_id).then((e=>{Array.isArray(e)?a(JSON.stringify(e.slice(0,H.a),null,2)):(a(""),console.log("Datafeed preview could not be loaded",e))})).catch((e=>{n(e)}))}))}(this.props.job,e).then((e=>{this.setState({previewJson:e,loading:!1})})).catch((e=>{console.log("Datafeed preview could not be loaded",e),this.setState({loading:!1})}))}render(){return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"s"}),this.renderContent())}}var Y=a(284),$=a(393),X=a(275);const K=({snapshot:e,job:t,closeFlyout:a})=>{const{toasts:n}=Object(T.f)(),[i,c]=Object(s.useState)(e.description),[d,u]=Object(s.useState)(e.retain),[p,m]=Object(s.useState)(!1),[b,f]=Object(s.useState)(e.snapshot_id===t.model_snapshot_id);Object(s.useEffect)((()=>{f(e.snapshot_id===t.model_snapshot_id)}),[e]);const h=Object(s.useCallback)((async()=>{try{await l.ml.updateModelSnapshot(e.job_id,e.snapshot_id,{description:i,retain:d}),x()}catch(e){n.addError(new Error(e.body.message),{title:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.saveErrorTitle",{defaultMessage:"Model snapshot update failed"})})}}),[d,i,e]),j=Object(s.useCallback)((async()=>{try{await l.ml.deleteModelSnapshot(e.job_id,e.snapshot_id),y(),x()}catch(e){n.addError(new Error(e.body.message),{title:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteErrorTitle",{defaultMessage:"Model snapshot deletion failed"})})}}),[e]);function x(){a(!0)}function v(){a(!1)}function y(){m(!1)}return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiFlyout,{onClose:v,hideCloseButton:!0,size:"m"},Object(w.jsx)(o.EuiFlyoutBody,null,Object(w.jsx)(o.EuiFlexItem,null,Object(w.jsx)(o.EuiTitle,{size:"s"},Object(w.jsx)("h5",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.title",defaultMessage:"Edit snapshot {ssId}",values:{ssId:e.snapshot_id}}))),b&&Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"m"}),Object(w.jsx)(o.EuiCallOut,{size:"s",title:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.calloutTitle",{defaultMessage:"Current snapshot"})},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.calloutText",defaultMessage:"This is the current snapshot being used by job {jobId} and so cannot be deleted.",values:{jobId:t.job_id}}))),Object(w.jsx)(o.EuiSpacer,{size:"l"}),Object(w.jsx)(o.EuiFormRow,{label:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.descriptionTitle",{defaultMessage:"Description"}),fullWidth:!0},Object(w.jsx)(o.EuiTextArea,{fullWidth:!0,value:i,onChange:e=>c(e.target.value)})),Object(w.jsx)(o.EuiSpacer,{size:"m"}),Object(w.jsx)(o.EuiFormRow,{fullWidth:!0},Object(w.jsx)(o.EuiSwitch,{label:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.retainSwitchLabel",{defaultMessage:"Retain snapshot during automatic snapshot cleanup process"}),checked:d,onChange:e=>u(e.target.checked)})))),Object(w.jsx)(o.EuiFlyoutFooter,null,Object(w.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButtonEmpty,{iconType:"cross",onClick:v,flush:"left"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.closeButton",defaultMessage:"Close"}))),Object(w.jsx)(o.EuiFlexItem,{grow:!0}),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButtonEmpty,{onClick:function(){m(!0)},color:"danger",disabled:!0===b},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.useDefaultButton",defaultMessage:"Delete"}))),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButton,{onClick:h,fill:!0},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.editModelSnapshotFlyout.saveButton",defaultMessage:"Save"})))))),p&&Object(w.jsx)(o.EuiConfirmModal,{title:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteTitle",{defaultMessage:"Delete snapshot?"}),onCancel:y,onConfirm:j,cancelButtonText:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:g.i18n.translate("xpack.ml.editModelSnapshotFlyout.deleteButton",{defaultMessage:"Delete"}),buttonColor:"danger",defaultFocusedButton:"confirm"}))};var Q=a(7);var Z=a(135),ee=a(216),te=a(29),ae=a(119);const ne=({calendarEvents:e,setCalendarEvents:t,minSelectableTimeStamp:a,maxSelectableTimeStamp:n,eventRateData:i,anomalies:l,chartReady:c})=>{const d=p()(n),u=p()(a),{euiTheme:m}=Object(ae.e)(),b=Object(s.useCallback)((({x:n})=>{if(n&&2===n.length){const i=n[1]<a?null:n[1];if(null!==i){const s=n[0]<a?a:n[0];t([...e,{start:p()(s),end:p()(i),description:re(e.length+1)}])}}}),[e]),f=Object(s.useCallback)(((a,n)=>{const i=e[n];void 0===i?t([...e,{start:a,end:null,description:re(n)}]):(i.start=a,t([...e]))}),[e]),h=Object(s.useCallback)(((a,n)=>{const i=e[n];void 0===i?t([...e,{start:null,end:a,description:re(n)}]):(i.end=a,t([...e]))}),[e]),j=Object(s.useCallback)(((a,n)=>{const i=e[n];void 0!==i&&(i.description=a,t([...e]))}),[e]),x=Object(s.useCallback)((a=>{if(void 0!==e[a]){const n=[...e];n.splice(a,1),t(n)}}),[e]);return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"l"}),Object(w.jsx)("div",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.revertModelSnapshotFlyout.createCalendar.title",defaultMessage:"Select time range for calendar event."})),Object(w.jsx)(o.EuiSpacer,{size:"m"}),Object(w.jsx)(ie,{eventRateData:i,anomalies:l,loading:!1===c,overlayRanges:e.filter(se).map((e=>({start:e.start.valueOf(),end:e.end.valueOf()}))),onBrushEnd:b,overlayColor:m.euiColorPrimary}),Object(w.jsx)(o.EuiSpacer,{size:"s"}),e.map(((e,t)=>{var a,n;return Object(w.jsx)(s.Fragment,{key:t},Object(w.jsx)(o.EuiPanel,{paddingSize:"s"},Object(w.jsx)(o.EuiFlexGroup,null,Object(w.jsx)(o.EuiFlexItem,null,Object(w.jsx)(o.EuiFlexGroup,null,Object(w.jsx)(o.EuiFlexItem,null,Object(w.jsx)(o.EuiFormRow,{label:g.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.fromLabel",{defaultMessage:"From"})},Object(w.jsx)(o.EuiDatePicker,{showTimeSelect:!0,selected:e.start,minDate:u,maxDate:null!==(a=e.end)&&void 0!==a?a:d,onChange:e=>f(e,t)}))),Object(w.jsx)(o.EuiFlexItem,null,Object(w.jsx)(o.EuiFormRow,{label:g.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.toLabel",{defaultMessage:"To"})},Object(w.jsx)(o.EuiDatePicker,{showTimeSelect:!0,selected:e.end,minDate:null!==(n=e.start)&&void 0!==n?n:u,maxDate:d,onChange:e=>h(e,t)})))),Object(w.jsx)(o.EuiSpacer,{size:"s"}),Object(w.jsx)(o.EuiFlexGroup,null,Object(w.jsx)(o.EuiFlexItem,null,Object(w.jsx)(o.EuiFormRow,{fullWidth:!0,label:g.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.descriptionLabel",{defaultMessage:"Description"})},Object(w.jsx)(o.EuiFieldText,{fullWidth:!0,value:e.description,onChange:e=>j(e.target.value,t)}))))),Object(w.jsx)(o.EuiFlexItem,{grow:!1,style:{borderLeft:`1px solid ${m.euiColorLightShade}`,marginRight:"0px"}}),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButtonIcon,{style:{margin:"auto"},color:"danger",onClick:()=>x(t),iconType:"trash","aria-label":g.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.deleteLabel",{defaultMessage:"Delete event"})})))),Object(w.jsx)(o.EuiSpacer,{size:"m"}))})))},ie=Object(s.memo)((({eventRateData:e,anomalies:t,loading:a,onBrushEnd:n,overlayRanges:i,overlayColor:s})=>Object(w.jsx)(ee.a,{eventRateChartData:e,anomalyData:t,loading:a,height:"100px",width:"100%",fadeChart:!0,overlayRanges:i.map((e=>({start:e.start,end:e.end,color:s,showMarker:!1}))),onBrushEnd:n})),((e,t)=>e.overlayRanges.length===t.overlayRanges.length&&JSON.stringify(e.overlayRanges)===JSON.stringify(t.overlayRanges)));function se(e){return null!==e.start&&null!==e.end}function re(e){return g.i18n.translate("xpack.ml.revertModelSnapshotFlyout.createCalendar.defaultEventDescription",{defaultMessage:"Auto created event {index}",values:{index:e}})}var oe=a(77);const le=({snapshot:e,snapshots:t,job:a,closeFlyout:n,refresh:i})=>{const{toasts:c}=Object(T.f)(),{loadAnomalyDataForJob:d,loadEventRateForJob:u}=Object(s.useMemo)((()=>{return e=Z.mlResultsService,{loadEventRateForJob:async function(t,a,n){const i=Math.max(Math.floor((t.data_counts.latest_record_timestamp-t.data_counts.earliest_record_timestamp)/n),a),s=await e.getEventRateData(t.datafeed_config.indices.join(),t.datafeed_config.query,t.data_description.time_field,t.data_counts.earliest_record_timestamp,t.data_counts.latest_record_timestamp,i,t.datafeed_config.runtime_mappings,t.datafeed_config.indices_options);if(void 0!==s.error)throw s.error;const r=Object.entries(s.results).map((([e,t])=>({time:+e,value:t})));return r.length&&r.push({time:r[r.length-1].time+i,value:0}),r},loadAnomalyDataForJob:async function(t,a,n){const i=Math.max(Math.floor((t.data_counts.latest_record_timestamp-t.data_counts.earliest_record_timestamp)/n),a),s=(await e.getScoresByBucket([t.job_id],t.data_counts.earliest_record_timestamp,t.data_counts.latest_record_timestamp,i,1)).results[t.job_id];if(void 0===s)return[];const r={};return r[0]=Object.entries(s).map((([e,t])=>({time:+e,value:t,severity:Object(Q.k)(t)}))),r}};var e}),[]),[p,m]=Object(s.useState)(e),[b,f]=Object(s.useState)(!1),[h,j]=Object(s.useState)(!1),[x,v]=Object(s.useState)(!1),[y,O]=Object(s.useState)(!1),[E,M]=Object(s.useState)([]),[S,_]=Object(s.useState)(!0),[C,k]=Object(s.useState)([]),[F,I]=Object(s.useState)([]),[D,A]=Object(s.useState)(!1);Object(s.useEffect)((()=>{L()}),[p]),Object(s.useEffect)((()=>{const e=E.some((e=>""===e.description||null===e.end||null===e.start));_(!1===e);const t=[...new Map(E.map((e=>{var t,a;return[`${null===(t=e.start)||void 0===t?void 0:t.valueOf()}${null===(a=e.end)||void 0===a?void 0:a.valueOf()}`,e]}))).values()];t.length<E.length&&M(t)}),[E]);const L=Object(s.useCallback)((async()=>{const e=Object(te.a)(a.analysis_config.bucket_span).asMilliseconds(),t=await u(a,e,100),n=await d(a,e,100);k(t),void 0!==n[0]&&I(n[0]),A(!0)}),[a]);function N(){f(!1)}return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiFlyout,{onClose:n,hideCloseButton:!0,size:"m"},Object(w.jsx)(o.EuiFlyoutHeader,{hasBorder:!0},Object(w.jsx)(o.EuiTitle,{size:"s"},Object(w.jsx)("h5",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.title",defaultMessage:"Revert to model snapshot {ssId}",values:{ssId:p.snapshot_id}}))),Object(w.jsx)(o.EuiText,{size:"s"},Object(w.jsx)("p",null,p.description))),Object(w.jsx)(o.EuiFlyoutBody,null,!1,Object(w.jsx)(ee.a,{eventRateChartData:C,anomalyData:F,loading:!1===D,height:"100px",width:"100%",fadeChart:!0,overlayRanges:[{start:p.latest_record_time_stamp,end:a.data_counts.latest_record_timestamp,color:"#ff0000"}]}),Object(w.jsx)(o.EuiSpacer,{size:"l"}),Object(w.jsx)(o.EuiSpacer,{size:"l"}),Object(w.jsx)(o.EuiCallOut,{title:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.warningCallout.title",{defaultMessage:"Anomaly data will be deleted"}),color:"warning",iconType:"alert"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.warningCallout.contents",defaultMessage:"All anomaly detection results after {date} will be deleted.",values:{date:Object(J.d)(p.latest_record_time_stamp)}})),Object(w.jsx)(o.EuiHorizontalRule,{margin:"xl"}),Object(w.jsx)(o.EuiFormRow,{fullWidth:!0,helpText:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.replaySwitchHelp",{defaultMessage:"Reopen job and replay analysis after the revert has been applied."})},Object(w.jsx)(o.EuiSwitch,{id:"replaySwitch",label:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.replaySwitchLabel",{defaultMessage:"Replay analysis"}),checked:h,onChange:e=>j(e.target.checked)})),h&&Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiFormRow,{fullWidth:!0,helpText:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.realTimeSwitchHelp",{defaultMessage:"Job will continue to run until manually stopped. All new data added to the index will be analyzed."})},Object(w.jsx)(o.EuiSwitch,{id:"realTimeSwitch",label:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.realTimeSwitchLabel",{defaultMessage:"Run job in real time"}),checked:x,onChange:e=>v(e.target.checked)})),Object(w.jsx)(o.EuiFormRow,{fullWidth:!0,helpText:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.createCalendarSwitchHelp",{defaultMessage:"Create a new calendar and event to skip over a period of time when analyzing the data."})},Object(w.jsx)(o.EuiSwitch,{id:"createCalendarSwitch",label:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.createCalendarSwitchLabel",{defaultMessage:"Create calendar to skip a range of time"}),checked:y,onChange:e=>O(e.target.checked)})),y&&Object(w.jsx)(ne,{calendarEvents:E,setCalendarEvents:M,minSelectableTimeStamp:e.latest_record_time_stamp,maxSelectableTimeStamp:a.data_counts.latest_record_timestamp,eventRateData:C,anomalies:F,chartReady:D}))),Object(w.jsx)(o.EuiFlyoutFooter,null,Object(w.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButtonEmpty,{iconType:"cross",onClick:n,flush:"left"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.closeButton",defaultMessage:"Close"}))),Object(w.jsx)(o.EuiFlexItem,{grow:!0}),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButton,{onClick:function(){f(!0)},disabled:!0===y&&!1===S,fill:!0},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.saveButton",defaultMessage:"Apply"})))))),b&&Object(w.jsx)(o.EuiConfirmModal,{title:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.deleteTitle",{defaultMessage:"Apply snapshot revert"}),onCancel:N,onConfirm:async function(){const e=h&&!1===x?a.data_counts.latest_record_timestamp:void 0;try{const t=h&&y?E.filter(ce).map((e=>({start:e.start.valueOf(),end:e.end.valueOf(),description:e.description}))):void 0;l.ml.jobs.revertModelSnapshot(a.job_id,p.snapshot_id,h,e,t).then((()=>{c.addSuccess(g.i18n.translate("xpack.ml.revertModelSnapshotFlyout.revertSuccessTitle",{defaultMessage:"Model snapshot revert successful"})),i()})).catch((e=>{const{displayErrorToast:t}=Object(oe.b)(c);t(e)})),N(),n()}catch(e){c.addError(new Error(e.body.message),{title:g.i18n.translate("xpack.ml.revertModelSnapshotFlyout.revertErrorTitle",{defaultMessage:"Model snapshot revert failed"})})}},cancelButtonText:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:g.i18n.translate("xpack.ml.newJob.wizard.revertModelSnapshotFlyout.deleteButton",{defaultMessage:"Apply"}),buttonColor:"danger",defaultFocusedButton:"confirm"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.newJob.wizard.revertModelSnapshotFlyout.modalBody",defaultMessage:"The snapshot revert will be carried out in the background and may take some time."})))};function ce(e){return null!==e.start&&null!==e.end}var de=a(18);const ue=({combinedJobState:e,hideCloseJobModalVisible:t,forceCloseJob:a})=>Object(w.jsx)(o.EuiConfirmModal,{title:e===pe.OPEN_AND_RUNNING?g.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.stopAndClose.title",{defaultMessage:"Stop datafeed and close job?"}):g.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.close.title",{defaultMessage:"Close job?"}),onCancel:t,onConfirm:a,cancelButtonText:g.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.cancelButton",{defaultMessage:"Cancel"}),confirmButtonText:e===pe.OPEN_AND_RUNNING?g.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.stopAndClose.button",{defaultMessage:"Stop and close"}):g.i18n.translate("xpack.ml.modelSnapshotTable.closeJobConfirm.close.button",{defaultMessage:"Close"}),defaultFocusedButton:"confirm"},Object(w.jsx)("p",null,e===pe.OPEN_AND_RUNNING&&Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.contentOpenAndRunning",defaultMessage:"Job is currently open and running."}),e===pe.OPEN_AND_STOPPED&&Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.contentOpen",defaultMessage:"Job is currently open."}),Object(w.jsx)("br",null),Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.modelSnapshotTable.closeJobConfirm.content",defaultMessage:"Snapshot revert can only happen on jobs which are closed."})));let pe;!function(e){e[e.OPEN_AND_RUNNING=0]="OPEN_AND_RUNNING",e[e.OPEN_AND_STOPPED=1]="OPEN_AND_STOPPED",e[e.CLOSED=2]="CLOSED",e[e.UNKNOWN=3]="UNKNOWN"}(pe||(pe={}));const me=({job:e,refreshJobList:t})=>{const a=Object(b.e)("canCreateJob"),n=Object(b.e)("canStartStopDatafeed"),[i,c]=Object(s.useState)([]),[d,u]=Object(s.useState)(!1),[p,m]=Object(s.useState)(null),[f,h]=Object(s.useState)(null),[j,x]=Object(s.useState)(null),[v,y]=Object(s.useState)(null),O=Object(s.useRef)(!0);async function E(){if(!1===O.current)return;const{model_snapshots:t}=await l.ml.getModelSnapshots(e.job_id);c(t),u(!0)}Object(s.useEffect)((()=>(E(),()=>{O.current=!1})),[]);const M=Object(s.useCallback)((async t=>{const a=await be(e.job_id);a!==pe.UNKNOWN?(y(a),a===pe.CLOSED?h(t):x(t)):console.error(`Error retrieving state for job ${e.job_id}`)}),[e]);function S(){y(null),x(null)}const _=Object(s.useCallback)((async()=>{if(await l.ml.jobs.forceStopAndCloseJob(e.job_id),null!==j){await be(e.job_id)===pe.CLOSED&&h(j)}S()}),[e,j]),T=Object(s.useCallback)((e=>{m(null),e&&E()}),[]),C=Object(s.useCallback)((()=>{h(null)}),[]),k=Object(s.useCallback)((()=>{E(),setTimeout(t,500)}),[]),F=[{field:"snapshot_id",name:g.i18n.translate("xpack.ml.modelSnapshotTable.id",{defaultMessage:"ID"}),sortable:!0},{field:"description",name:g.i18n.translate("xpack.ml.modelSnapshotTable.description",{defaultMessage:"Description"}),sortable:!0},{field:"timestamp",name:g.i18n.translate("xpack.ml.modelSnapshotTable.time",{defaultMessage:"Date created"}),dataType:"date",render:J.d,sortable:!0},{field:"latest_record_time_stamp",name:g.i18n.translate("xpack.ml.modelSnapshotTable.latestTimestamp",{defaultMessage:"Latest timestamp"}),dataType:"date",render:J.d,sortable:!0},{field:"retain",name:g.i18n.translate("xpack.ml.modelSnapshotTable.retain",{defaultMessage:"Retain"}),width:"100px",sortable:!0},{field:"",width:"100px",name:g.i18n.translate("xpack.ml.modelSnapshotTable.actions",{defaultMessage:"Actions"}),actions:[{name:g.i18n.translate("xpack.ml.modelSnapshotTable.actions.revert.name",{defaultMessage:"Revert"}),description:g.i18n.translate("xpack.ml.modelSnapshotTable.actions.revert.description",{defaultMessage:"Revert to this snapshot"}),enabled:()=>a&&n,type:"icon",icon:"crosshairs",onClick:M},{name:g.i18n.translate("xpack.ml.modelSnapshotTable.actions.edit.name",{defaultMessage:"Edit"}),description:g.i18n.translate("xpack.ml.modelSnapshotTable.actions.edit.description",{defaultMessage:"Edit this snapshot"}),enabled:()=>a,type:"icon",icon:"pencil",onClick:m}]}];return!1===d?Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiFlexGroup,{justifyContent:"spaceAround"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiLoadingSpinner,{size:"l"})))):Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiInMemoryTable,{className:"eui-textOverflowWrap",compressed:!0,items:i,columns:F,pagination:{pageSizeOptions:[5,10,25]},sorting:{sort:{field:"timestamp",direction:"asc"}}}),null!==p&&Object(w.jsx)(K,{snapshot:p,job:e,closeFlyout:T}),null!==f&&Object(w.jsx)(le,{snapshot:f,snapshots:i,job:e,closeFlyout:C,refresh:k}),null!==j&&null!==v&&Object(w.jsx)(ue,{combinedJobState:v,hideCloseJobModalVisible:S,forceCloseJob:_}))};async function be(e){const t=await l.ml.jobs.jobs([e]);return 1!==t.length?pe.UNKNOWN:t[0].state!==de.c.CLOSED?t[0].datafeed_config.state!==de.a.STOPPED?pe.OPEN_AND_RUNNING:pe.OPEN_AND_STOPPED:pe.CLOSED}var fe=a(67),he=a(190),ge=a(169),je=a(46);class forecasts_table_ForecastsTableUI extends s.Component{constructor(e){super(e),this.state={isLoading:0!==e.job.data_counts.processed_record_count,forecasts:[]}}componentDidMount(){const e=this.props.job.data_counts;e.processed_record_count>0&&ge.a.getForecastsSummary(this.props.job,null,e.earliest_record_timestamp,500).then((e=>{this.setState({isLoading:!1,forecasts:e.forecasts})})).catch((e=>{console.log("Error loading list of forecasts for jobs list:",e),this.setState({isLoading:!1,errorMessage:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.loadingErrorMessage",{defaultMessage:"Error loading the list of forecasts run on this job"}),forecasts:[]})}))}async openSingleMetricView(e){const{services:{application:{navigateToUrl:t},share:a}}=this.props.kibana,n=this.props.job.data_counts,i=n.earliest_record_timestamp,s=Object(H.g)(n.latest_record_timestamp,n.latest_bucket_timestamp),r=new Date(n.earliest_record_timestamp).toISOString(),o=void 0!==e?new Date(e.forecast_end_timestamp).toISOString():new Date(s).toISOString();let l={};if(void 0!==e){const t=e.forecast_end_timestamp-e.forecast_start_timestamp,a=Math.max(e.forecast_start_timestamp-t,i);l={forecastId:e.forecast_id,zoom:{from:new Date(a).toISOString(),to:new Date(e.forecast_end_timestamp).toISOString()}}}const c=a.url.locators.get(C.a),d=await c.getUrl({page:C.b.SINGLE_METRIC_VIEWER,pageState:{timeRange:{from:r,to:o,mode:"absolute"},refreshInterval:{display:"Off",pause:!0,value:0},jobIds:[this.props.job.job_id],query:{query_string:{analyze_wildcard:!0,query:"*"}},...l}},{absolute:!0});Object(he.a)("timeseriesexplorer",this.props.job.job_id,d),await t(d)}render(){if(!0===this.state.isLoading)return Object(w.jsx)(o.EuiFlexGroup,{justifyContent:"spaceAround"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiLoadingSpinner,{size:"l"})));if(void 0!==this.state.errorMessage)return Object(w.jsx)(o.EuiCallOut,{title:this.state.errorMessage,color:"danger",iconType:"cross"});const e=this.state.forecasts;if(0===e.length)return Object(w.jsx)(o.EuiCallOut,{title:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsTitle",defaultMessage:"No forecasts have been run for this job"}),iconType:"iInCircle",role:"alert"},Object(H.p)(this.props.job)&&Object(w.jsx)("p",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription",defaultMessage:"To run a forecast, open the {singleMetricViewerLink}",values:{singleMetricViewerLink:Object(w.jsx)(o.EuiLink,{onClick:()=>this.openSingleMetricView()},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.jobDetails.forecastsTable.noForecastsDescription.linkText",defaultMessage:"Single Metric Viewer"}))}})));const t=[{field:"forecast_create_timestamp",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.createdLabel",{defaultMessage:"Created"}),dataType:"date",render:J.d,textOnly:!0,sortable:!0,scope:"row"},{field:"forecast_start_timestamp",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.fromLabel",{defaultMessage:"From"}),dataType:"date",render:J.d,textOnly:!0,sortable:!0},{field:"forecast_end_timestamp",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.toLabel",{defaultMessage:"To"}),dataType:"date",render:J.d,textOnly:!0,sortable:!0},{field:"forecast_status",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.statusLabel",{defaultMessage:"Status"}),sortable:!0},{field:"forecast_memory_bytes",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.memorySizeLabel",{defaultMessage:"Memory size"}),render:e=>Object(fe.formatNumber)(e,"0b"),sortable:!0},{field:"processing_time_ms",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.processingTimeLabel",{defaultMessage:"Processing time"}),render:e=>g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.msTimeUnitLabel",{defaultMessage:"{ms} ms",values:{ms:e}}),sortable:!0},{field:"forecast_expiry_timestamp",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.expiresLabel",{defaultMessage:"Expires"}),render:J.d,textOnly:!0,sortable:!0},{field:"forecast_messages",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.messagesLabel",{defaultMessage:"Messages"}),sortable:!1,render:e=>Object(w.jsx)("div",null,e.map(((e,t)=>Object(w.jsx)("p",{key:t},e)))),textOnly:!0},{name:g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.viewLabel",{defaultMessage:"View"}),width:"60px",render:e=>{const t=g.i18n.translate("xpack.ml.jobsList.jobDetails.forecastsTable.viewAriaLabel",{defaultMessage:"View forecast created at {createdDate}",values:{createdDate:Object(J.d)(e.forecast_create_timestamp)}});return Object(w.jsx)(o.EuiButtonIcon,{onClick:()=>this.openSingleMetricView(e),isDisabled:e.forecast_status!==de.b.FINISHED,iconType:"visLine","aria-label":t})}}];return Object(w.jsx)(o.EuiInMemoryTable,{compressed:!0,items:e,columns:t,pagination:{pageSizeOptions:[5,10,25]},sorting:!0})}}const xe=Object(je.withKibana)(forecasts_table_ForecastsTableUI);function ve({item:e}){return Object(w.jsx)(o.EuiTableRow,null,""!==e[0]&&Object(w.jsx)(o.EuiTableRowCell,null,Object(w.jsx)("span",{className:"job-item header"},e[0])),Object(w.jsx)(o.EuiTableRowCell,null,Object(w.jsx)("span",{className:"job-item"},e[1])))}function ye({section:e}){return 0===e.items.length?Object(w.jsx)("div",null):Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiFlexGroup,{gutterSize:"xs"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiTitle,{size:"xs"},Object(w.jsx)("h4",null,e.title))),Object(w.jsx)(o.EuiFlexItem,{grow:!1},e.titleAction)),Object(w.jsx)("div",{className:"job-section","data-test-subj":`mlJobRowDetailsSection-${e.id}`},Object(w.jsx)(o.EuiTable,{compressed:!0},Object(w.jsx)(o.EuiTableBody,null,e.items.map(((e,t)=>Object(w.jsx)(ve,{item:e,key:t})))))))}class job_details_pane_JobDetailsPane extends s.Component{constructor(e){super(e),this.state={}}static getDerivedStateFromProps(e){const{sections:t,time:a}=e;return{sections:t,time:a}}render(){const{sections:e,time:t}=this.state;return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"s"}),Object(w.jsx)("div",{className:"row",time:t,"data-test-subj":this.props["data-test-subj"]},Object(w.jsx)("div",{className:"col-md-6"},e.filter((e=>"left"===e.position)).map(((e,t)=>Object(w.jsx)(ye,{section:e,key:t})))),Object(w.jsx)("div",{className:"col-md-6"},e.filter((e=>"right"===e.position)).map(((e,t)=>Object(w.jsx)(ye,{section:e,key:t}))))))}}var Oe=a(301);class job_details_JobDetailsUI extends s.Component{constructor(e){super(e),this.state={datafeedChartFlyoutVisible:!1},this.props.addYourself&&this.props.addYourself(e.jobId,(e=>this.updateJob(e)))}componentWillUnmount(){this.props.removeYourself(this.props.jobId)}updateJob(e){this.setState({job:e})}render(){var e;const t=null!==(e=this.state.job)&&void 0!==e?e:this.props.job,{services:{http:{basePath:a}}}=this.props.kibana;if(void 0===t)return Object(w.jsx)("div",{className:"job-loading-spinner","data-test-subj":"mlJobDetails loading"},Object(w.jsx)(o.EuiLoadingSpinner,{size:"l"}));{const{showFullDetails:e,refreshJobList:n,showClearButton:i}=this.props,{general:l,customUrl:c,node:d,calendars:u,detectors:p,influencers:b,analysisConfig:f,analysisLimits:h,dataDescription:j,customSettings:x,jobTags:v,datafeed:y,counts:O,modelSizeStats:E,jobTimingStats:M,datafeedTimingStats:S,alertRules:_}=function(e,t,a){var n,i;if(0===Object.keys(e).length)return{};const s={id:"general",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.generalTitle",{defaultMessage:"General"}),position:"left",items:U(e,!0).map(V)},{job_tags:r,custom_urls:l,...c}=null!==(n=e.custom_settings)&&void 0!==n?n:{},d={id:"customUrl",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.customUrlsTitle",{defaultMessage:"Custom URLs"}),position:"right",items:l?l.map((e=>[e.url_name,e.url_value,e.time_range])):[]},u={id:"analysisConfig",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.customSettingsTitle",{defaultMessage:"Custom settings"}),position:"right",items:c?U(c,!0,!0).map(V):[]},p={id:"analysisConfig",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.jobTagsTitle",{defaultMessage:"Job tags"}),position:"right",items:r?U(r):[]},b={id:"node",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.nodeTitle",{defaultMessage:"Node"}),position:"right",items:[]};e.node&&b.items.push(["name",e.node.name]);const f={id:"calendars",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.calendarsTitle",{defaultMessage:"Calendars"}),position:"right",items:[]};if(e.calendars){f.items=e.calendars.map((e=>["",Object(w.jsx)(o.EuiLink,{href:t.prepend(`/app/ml/settings/calendars_list/edit_calendar/${e}?_g=()`)},e)]));const a=s.items.findIndex((e=>"calendars"===e[0]));a>=0&&s.items.splice(a,1)}const h={id:"alertRules",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.alertRulesTitle",{defaultMessage:"Alert rules"}),position:"right",items:(null!==(i=e.alerting_rules)&&void 0!==i?i:[]).map((e=>["",Object(w.jsx)(G.a,{initialAlert:e,onSave:a})]))},j={id:"detectors",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.detectorsTitle",{defaultMessage:"Detectors"}),position:"left",items:[]};e.analysis_config&&e.analysis_config.detectors&&j.items.push(...e.analysis_config.detectors.map((e=>{const t=Object(m.b)(e);return[t,t!==e.detector_description?e.detector_description:""]})));const x={id:"influencers",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.influencersTitle",{defaultMessage:"Influencers"}),position:"left",items:e.analysis_config.influencers.map((e=>["",e]))},v={id:"analysisConfig",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.analysisConfigTitle",{defaultMessage:"Analysis config"}),position:"left",items:U(e.analysis_config)},y={id:"analysisLimits",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.analysisLimitsTitle",{defaultMessage:"Analysis limits"}),position:"left",items:U(e.analysis_limits)},O={id:"dataDescription",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.dataDescriptionTitle",{defaultMessage:"Data description"}),position:"right",items:U(e.data_description)},E={id:"datafeed",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.datafeedTitle",{defaultMessage:"Datafeed"}),position:"left",items:U(e.datafeed_config||{},!0,!0)};if(e.node&&E.items.push(["node",JSON.stringify(e.node)]),e.datafeed_config&&e.datafeed_config.timing_stats){const e=E.items.findIndex((e=>"timing_stats"===e[0]));e>=0&&E.items.splice(e,1)}return{general:s,customUrl:d,node:b,calendars:f,detectors:j,influencers:x,analysisConfig:v,analysisLimits:y,dataDescription:O,customSettings:u,jobTags:p,datafeed:E,counts:{id:"counts",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.countsTitle",{defaultMessage:"Counts"}),position:"left",items:U(e.data_counts).map(V)},modelSizeStats:{id:"modelSizeStats",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.modelSizeStatsTitle",{defaultMessage:"Model size stats"}),position:"right",items:U(e.model_size_stats).map(V)},jobTimingStats:{id:"jobTimingStats",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.jobTimingStatsTitle",{defaultMessage:"Job timing stats"}),position:"left",items:U(e.timing_stats).map(V)},datafeedTimingStats:{id:"datafeedTimingStats",title:g.i18n.translate("xpack.ml.jobsList.jobDetails.datafeedTimingStatsTitle",{defaultMessage:"Timing stats"}),position:"right",items:e.datafeed_config&&e.datafeed_config.timing_stats?U(e.datafeed_config.timing_stats).filter((e=>"total_search_time_ms"!==e[0])).map(V):[]},alertRules:h}}(t,a,n);y.titleAction=Object(w.jsx)(o.EuiToolTip,{content:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobDetails.datafeedChartTooltipText",defaultMessage:"Datafeed chart"})},Object(w.jsx)(o.EuiButtonIcon,{size:"xs","aria-label":g.i18n.translate("xpack.ml.jobDetails.datafeedChartAriaLabel",{defaultMessage:"Datafeed chart"}),iconType:"visAreaStacked",onClick:()=>this.setState({datafeedChartFlyoutVisible:!0})}));const T=[{id:"job-settings","data-test-subj":"mlJobListTab-job-settings",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobSettingsLabel",{defaultMessage:"Job settings"}),content:Object(w.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-job-settings",sections:[l,x,c,v,d,u,_]}),time:t.open_time},{id:"job-config","data-test-subj":"mlJobListTab-job-config",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobConfigLabel",{defaultMessage:"Job config"}),content:Object(w.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-job-config",sections:[p,b,f,h,j]})},{id:"datafeed","data-test-subj":"mlJobListTab-datafeed",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.datafeedLabel",{defaultMessage:"Datafeed"}),content:Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-datafeed",sections:[y,S]}),this.props.jobId&&this.state.datafeedChartFlyoutVisible?Object(w.jsx)($.a,{onClose:()=>{this.setState({datafeedChartFlyoutVisible:!1})},end:t.data_counts.latest_bucket_timestamp,jobId:this.props.jobId}):null)},{id:"counts","data-test-subj":"mlJobListTab-counts",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.countsLabel",{defaultMessage:"Counts"}),content:Object(w.jsx)(job_details_pane_JobDetailsPane,{"data-test-subj":"mlJobDetails-counts",sections:[O,E,M]})},{id:"json","data-test-subj":"mlJobListTab-json",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jsonLabel",{defaultMessage:"JSON"}),content:Object(w.jsx)(W,{job:t})},{id:"job-messages","data-test-subj":"mlJobListTab-job-messages",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.jobMessagesLabel",{defaultMessage:"Job messages"}),content:Object(w.jsx)(Oe.a,{jobId:t.job_id,refreshJobList:n,showClearButton:i})}];return e&&y.items.length&&T.push({id:"datafeed-preview","data-test-subj":"mlJobListTab-datafeed-preview",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.datafeedPreviewLabel",{defaultMessage:"Datafeed preview"}),content:Object(w.jsx)(datafeed_preview_tab_DatafeedPreviewPane,{job:t})},{id:"forecasts","data-test-subj":"mlJobListTab-forecasts",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.forecastsLabel",{defaultMessage:"Forecasts"}),content:Object(w.jsx)(xe,{job:t})}),e&&(T.push({id:"annotations","data-test-subj":"mlJobListTab-annotations",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.annotationsLabel",{defaultMessage:"Annotations"}),content:Object(w.jsx)(s.Fragment,null,Object(w.jsx)(Y.a,{jobs:[t],drillDown:!0}),Object(w.jsx)(X.a,null))}),T.push({id:"modelSnapshots","data-test-subj":"mlJobListTab-modelSnapshots",name:g.i18n.translate("xpack.ml.jobsList.jobDetails.tabs.modelSnapshotsLabel",{defaultMessage:"Model snapshots"}),content:Object(w.jsx)(s.Fragment,null,Object(w.jsx)(me,{job:t,refreshJobList:n}))})),Object(w.jsx)("div",{className:"tab-contents","data-test-subj":`mlJobListRowDetails details-${t.job_id}`},Object(w.jsx)(o.EuiTabbedContent,{tabs:T,initialSelectedTab:T[0],onTabClick:()=>{}}))}}}const Ee=Object(je.withKibana)(job_details_JobDetailsUI),we=({queryText:e,setFilters:t})=>{const[a,n]=Object(s.useState)(null),{services:{mlServices:{mlApiServices:i}}}=Object(T.b)(),r=Object(s.useCallback)((async()=>{try{return(await i.jobs.groups()).map((e=>({value:e.id,view:Object(w.jsx)("div",{className:"group-item"},Object(w.jsx)(_,{name:e.id})," ",Object(w.jsx)("span",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.jobFilterBar.jobGroupTitle",defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:e.jobIds.length}})))})))}catch(e){return[]}}),[]),l=Object(s.useMemo)((()=>o.EuiSearchBar.Query.parse(null!=e?e:"")),[e]);Object(s.useEffect)((()=>{void 0!==e&&t(l)}),[e]);const c=Object(s.useMemo)((()=>[{type:"field_value_toggle_group",field:"job_state",items:[{value:"opened",name:g.i18n.translate("xpack.ml.jobsList.jobFilterBar.openedLabel",{defaultMessage:"Opened"})},{value:"closed",name:g.i18n.translate("xpack.ml.jobsList.jobFilterBar.closedLabel",{defaultMessage:"Closed"})},{value:"failed",name:g.i18n.translate("xpack.ml.jobsList.jobFilterBar.failedLabel",{defaultMessage:"Failed"})}]},{type:"field_value_toggle_group",field:"datafeed_state",items:[{value:"started",name:g.i18n.translate("xpack.ml.jobsList.jobFilterBar.startedLabel",{defaultMessage:"Started"})},{value:"stopped",name:g.i18n.translate("xpack.ml.jobsList.jobFilterBar.stoppedLabel",{defaultMessage:"Stopped"})}]},{type:"field_value_selection",field:"groups",name:g.i18n.translate("xpack.ml.jobsList.jobFilterBar.groupLabel",{defaultMessage:"Group"}),multiSelect:"or",cache:1e4,options:()=>r()}]),[]),d=Object(s.useMemo)((()=>null===a?"":g.i18n.translate("xpack.ml.jobsList.jobFilterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:a.message}})),[a]);return Object(w.jsx)(o.EuiFlexGroup,{direction:"column"},Object(w.jsx)(o.EuiFlexItem,{"data-test-subj":"mlJobListSearchBar",grow:!1},Object(w.jsx)(o.EuiSearchBar,{box:{incremental:!0},query:l,filters:c,onChange:({query:e,error:a})=>{a?n(a):(t(e),n(null))},className:"mlJobFilterBar"}),Object(w.jsx)(o.EuiFormRow,{fullWidth:!0,isInvalid:null!==a,error:d,style:{maxHeight:0}},Object(w.jsx)(s.Fragment,null))))};class tabs_job_details_JobDetails extends s.Component{constructor(e){super(e),i()(this,"onDescriptionChange",(e=>{this.setJobDetails({jobDescription:e.target.value})})),i()(this,"onMmlChange",(e=>{this.setJobDetails({jobModelMemoryLimit:e.target.value})})),i()(this,"onModelSnapshotRetentionDaysChange",(e=>{const t=Math.floor(+e.target.value);this.setJobDetails({jobModelSnapshotRetentionDays:t,...this.state.dailyModelSnapshotRetentionAfterDays>t?{jobDailyModelSnapshotRetentionAfterDays:t}:{}})})),i()(this,"onDailyModelSnapshotRetentionAfterDaysChange",(e=>{const t=Math.floor(+e.target.value);t<=this.state.modelSnapshotRetentionDays&&this.setJobDetails({jobDailyModelSnapshotRetentionAfterDays:t})})),i()(this,"onGroupsChange",(e=>{this.setJobDetails({jobGroups:e.map((e=>e.label))})})),i()(this,"onCreateGroup",((e,t)=>{const a=e.trim().toLowerCase();if(!a)return;const n={label:e},i=this.state.groups;-1===t.findIndex((e=>e.label.trim().toLowerCase()===a))&&i.push(n);const s=this.state.selectedGroups.concat(n);this.setState({groups:i},(()=>this.onGroupsChange(s)))})),this.state={description:"",groups:[],selectedGroups:[],mml:"",mmlValidationError:"",groupsValidationError:"",modelSnapshotRetentionDays:1,dailyModelSnapshotRetentionAfterDays:1},this.setJobDetails=e.setJobDetails}componentDidMount(){l.ml.jobs.groups().then((e=>{const t=e.map((e=>({label:e.id,color:Object(S.a)(e.id)})));this.setState({groups:t})})).catch((e=>{console.error("Could not load groups",e)}))}static getDerivedStateFromProps(e){const t=void 0!==e.jobGroups?e.jobGroups.map((e=>({label:e,color:Object(S.a)(e)}))):[],{datafeedRunning:a,jobClosed:n}=e;let i=null;return n||(i=Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitJobOpenLabelHelp",defaultMessage:"Model memory limit cannot be edited while the job is open."})),a&&(i=Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitLabelHelp",defaultMessage:"Model memory limit cannot be edited while the datafeed is running."})),{description:e.jobDescription,selectedGroups:t,mml:e.jobModelMemoryLimit,mmlHelpText:i,mmlValidationError:e.jobModelMemoryLimitValidationError,groupsValidationError:e.jobGroupsValidationError,modelSnapshotRetentionDays:e.jobModelSnapshotRetentionDays,dailyModelSnapshotRetentionAfterDays:e.jobDailyModelSnapshotRetentionAfterDays}}render(){const{description:e,selectedGroups:t,mml:a,groups:n,mmlValidationError:i,groupsValidationError:s,modelSnapshotRetentionDays:l,dailyModelSnapshotRetentionAfterDays:c,mmlHelpText:d}=this.state,{datafeedRunning:u,jobClosed:p}=this.props;return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"m"}),Object(w.jsx)(o.EuiForm,null,Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobDescriptionLabel",defaultMessage:"Job description"})},Object(w.jsx)(o.EuiFieldText,{value:e,onChange:this.onDescriptionChange})),Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsLabel",defaultMessage:"Job groups"}),isInvalid:""!==s,error:s},Object(w.jsx)(o.EuiComboBox,{placeholder:g.i18n.translate("xpack.ml.jobsList.editJobFlyout.jobDetails.jobGroupsPlaceholder",{defaultMessage:"Select or create groups"}),options:n,selectedOptions:t,onChange:this.onGroupsChange,onCreateOption:this.onCreateGroup,isClearable:!0,isInvalid:""!==s,error:s})),Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelMemoryLimitLabel",defaultMessage:"Model memory limit"}),helpText:d,isInvalid:""!==i,error:i},Object(w.jsx)(o.EuiFieldText,{value:a,onChange:this.onMmlChange,isInvalid:""!==i,error:i,disabled:u||!p})),Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.modelSnapshotRetentionDaysLabel",defaultMessage:"Model snapshot retention days"})},Object(w.jsx)(o.EuiFieldNumber,{min:0,value:l,onChange:this.onModelSnapshotRetentionDaysChange})),Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.jobDetails.dailyModelSnapshotRetentionAfterDaysLabel",defaultMessage:"Daily model snapshot retention after days"})},Object(w.jsx)(o.EuiFieldNumber,{min:0,max:l,value:c,onChange:this.onDailyModelSnapshotRetentionAfterDaysChange}))))}}var Me=a(83);class detectors_Detectors extends s.Component{constructor(e){super(e),i()(this,"onDescriptionChange",((e,t)=>{const a=this.state.detectorDescriptions;a[t]=e.target.value,this.setDetectorDescriptions({jobDetectorDescriptions:a})})),this.detectors=Me.a.getJobGroups().map((e=>({label:e.id}))),this.state={detectors:[],detectorDescriptions:[]},this.setDetectorDescriptions=e.setDetectorDescriptions}static getDerivedStateFromProps(e){return{detectors:e.jobDetectors,detectorDescriptions:e.jobDetectorDescriptions}}render(){const{detectors:e,detectorDescriptions:t}=this.state;return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"m"}),Object(w.jsx)(o.EuiTitle,{size:"xs"},Object(w.jsx)("h4",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.detectors.title",defaultMessage:"Edit detector descriptions"}))),Object(w.jsx)(o.EuiSpacer,{size:"m"}),Object(w.jsx)(o.EuiForm,null,t.map(((t,a)=>Object(w.jsx)(o.EuiFormRow,{label:Object(m.b)(e[a]),key:a},Object(w.jsx)(o.EuiFieldText,{value:t,onChange:e=>this.onDescriptionChange(e,a)}))))))}}var Se=a(92);function _e(e,t){const a=void 0!==e?Object(te.a)(e).asSeconds():"";return{queryDelay:"60s",frequency:Object(H.f)(a)+"s",scrollSize:t.datafeeds.scroll_size}}class datafeed_Datafeed extends s.Component{constructor(e){super(e),i()(this,"onQueryChange",(e=>{this.setDatafeed({datafeedQuery:e})})),i()(this,"onQueryDelayChange",(e=>{this.setDatafeed({datafeedQueryDelay:e.target.value})})),i()(this,"onFrequencyChange",(e=>{this.setDatafeed({datafeedFrequency:e.target.value})})),i()(this,"onScrollSizeChange",(e=>{this.setDatafeed({datafeedScrollSize:+e.target.value})})),this.state={query:"",queryDelay:"",frequency:"",scrollSize:"",defaults:{queryDelay:"",frequency:"",scrollSize:0},jobDefaults:Object(Se.c)()},this.setDatafeed=e.setDatafeed}static getDerivedStateFromProps(e,t){return{query:e.datafeedQuery,queryDelay:e.datafeedQueryDelay,frequency:e.datafeedFrequency,scrollSize:e.datafeedScrollSize,defaults:_e(e.jobBucketSpan,t.jobDefaults)}}render(){const{query:e,queryDelay:t,frequency:a,scrollSize:n,defaults:i}=this.state,{datafeedRunning:s}=this.props;return Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"m"}),s&&Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiCallOut,{color:"warning"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.readOnlyCalloutText",defaultMessage:"Datafeed settings cannot be edited while the datafeed is running. Please stop the job if you wish to edit these settings."})),Object(w.jsx)(o.EuiSpacer,{size:"l"})),Object(w.jsx)(o.EuiForm,null,Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryLabel",defaultMessage:"Query"}),style:{maxWidth:"inherit"}},Object(w.jsx)(q.a,{mode:q.b.XJSON,value:e,onChange:this.onQueryChange,height:"200px",readOnly:s})),Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.queryDelayLabel",defaultMessage:"Query delay"})},Object(w.jsx)(o.EuiFieldText,{value:t,placeholder:i.queryDelay,onChange:this.onQueryDelayChange,disabled:s})),Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.frequencyLabel",defaultMessage:"Frequency"})},Object(w.jsx)(o.EuiFieldText,{value:a,placeholder:i.frequency,onChange:this.onFrequencyChange,disabled:s})),Object(w.jsx)(o.EuiFormRow,{label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.datafeed.scrollSizeLabel",defaultMessage:"Scroll size"})},Object(w.jsx)(o.EuiFieldNumber,{value:n,placeholder:i.scrollSize,onChange:this.onScrollSizeChange,disabled:s}))))}}var Te=a(273),Ce=a(306),ke=a(147),Fe=a(156);function Ie(e){const t={groups:e},a=Object(H.u)(t),{valid:n}=a,i={valid:n,message:""};return Object(ke.b)(a,{groupIds:i}),i}var De=a(188),Ae=a(148);class edit_job_flyout_EditJobFlyoutUI extends s.Component{constructor(e){super(e),i()(this,"_initialJobFormState",null),i()(this,"closeFlyout",((e=!1)=>{!this.containsUnsavedChanges()||e?(this.setState({isConfirmationModalVisible:!1}),this.setState({isFlyoutVisible:!1})):this.setState({isConfirmationModalVisible:!0})})),i()(this,"showFlyout",(e=>{const t=e.hasDatafeed;Object(c.k)(e.id).then((e=>{this.extractJob(e,t),this.setState({job:e,isFlyoutVisible:!0})})).catch((e=>{console.error(e)}))})),i()(this,"setJobDetails",(e=>{let{jobModelMemoryLimitValidationError:t,jobGroupsValidationError:a}=this.state;void 0!==e.jobModelMemoryLimit&&(t=function(e){const t=Object(Se.d)(),a={analysis_limits:{model_memory_limit:e}};let n=Object(H.w)(e),{valid:i}=n;i&&(n=Object(H.v)(a,t),i=n.valid);const s={valid:i,message:""};return Object(ke.b)(n,{modelMemoryLimit:s}),s}(e.jobModelMemoryLimit).message),void 0!==e.jobGroups&&(a=Ie(e.jobGroups).message,""===a&&l.ml.jobs.jobsExist(e.jobGroups,!0).then((e=>{!1===(!1===Object.values(e).some((e=>!0===e.exists&&!1===e.isGroup)))&&this.setState({jobGroupsValidationError:g.i18n.translate("xpack.ml.jobsList.editJobFlyout.groupsAndJobsHasSameIdErrorMessage",{defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."}),isValidJobDetails:!1})})));const n=""===t&&""===a;this.setState({...e,jobModelMemoryLimitValidationError:t,jobGroupsValidationError:a,isValidJobDetails:n})})),i()(this,"setDetectorDescriptions",(e=>{this.setState({...e})})),i()(this,"setDatafeed",(e=>{this.setState({...e})})),i()(this,"setCustomUrls",(e=>{const t=void 0===(a=e)||0===a.length||!a.some(((e,t)=>{const n=e.url_name,i=[...a];i.splice(t,1);let s=Object(Fe.b)(n,i);if(!0===s){const t=e.time_range;s=Object(Fe.c)(t)}return!s}));var a;this.setState({jobCustomUrls:e,isValidJobCustomUrls:t})})),i()(this,"save",(()=>{const e={description:this.state.jobDescription,groups:this.state.jobGroups,mml:this.state.jobModelMemoryLimit,modelSnapshotRetentionDays:this.state.jobModelSnapshotRetentionDays,dailyModelSnapshotRetentionAfterDays:this.state.jobDailyModelSnapshotRetentionAfterDays,detectorDescriptions:this.state.jobDetectorDescriptions,datafeedQuery:Object(De.c)(this.state.datafeedQuery),datafeedQueryDelay:this.state.datafeedQueryDelay,datafeedFrequency:this.state.datafeedFrequency,datafeedScrollSize:this.state.datafeedScrollSize,customUrls:this.state.jobCustomUrls},{toasts:t}=this.props.kibana.services.notifications,a=Object(oe.b)(t);Object(Ce.c)(this.state.job,e).then((()=>{t.addSuccess(g.i18n.translate("xpack.ml.jobsList.editJobFlyout.changesSavedNotificationMessage",{defaultMessage:"Changes to {jobId} saved",values:{jobId:this.state.job.job_id}})),this.refreshJobs(),this.closeFlyout(!0)})).catch((e=>{console.error(e),a.displayErrorToast(e,g.i18n.translate("xpack.ml.jobsList.editJobFlyout.changesNotSavedNotificationMessage",{defaultMessage:"Could not save changes to {jobId}",values:{jobId:this.state.job.job_id}}))}))})),this.state={job:{},hasDatafeed:!1,datafeedRunning:!1,isFlyoutVisible:!1,isConfirmationModalVisible:!1,jobDescription:"",jobGroups:[],jobModelMemoryLimit:"",jobModelSnapshotRetentionDays:10,jobDailyModelSnapshotRetentionAfterDays:10,jobDetectors:[],jobDetectorDescriptions:[],jobCustomUrls:[],datafeedQuery:"",datafeedQueryDelay:"",datafeedFrequency:"",datafeedScrollSize:"",jobModelMemoryLimitValidationError:"",jobGroupsValidationError:"",isValidJobDetails:!0,isValidJobCustomUrls:!0},this.refreshJobs=this.props.refreshJobs}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showFlyout)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}containsUnsavedChanges(){return!Object(d.isEqual)(this._initialJobFormState,Object(d.pick)(this.state,["jobDescription","jobGroups","jobModelMemoryLimit","jobModelSnapshotRetentionDays","jobDailyModelSnapshotRetentionAfterDays","jobCustomUrls","jobDetectors","jobDetectorDescriptions","jobBucketSpan","datafeedQuery","datafeedQueryDelay","datafeedFrequency","datafeedScrollSize"]))}extractInitialJobFormState(e,t){const a=e.analysis_limits&&e.analysis_limits.model_memory_limit?e.analysis_limits.model_memory_limit:"",n=void 0!==e.model_snapshot_retention_days?e.model_snapshot_retention_days:10,i=void 0!==e.daily_model_snapshot_retention_after_days?e.daily_model_snapshot_retention_after_days:n,s=e.analysis_config&&e.analysis_config.detectors?[...e.analysis_config.detectors]:[],r=e.analysis_config?e.analysis_config.bucket_span:"",o={...e.datafeed_config},l=void 0!==o.frequency?o.frequency:"",c=e.custom_settings&&e.custom_settings.custom_urls?[...e.custom_settings.custom_urls]:[];this._initialJobFormState=Object.freeze({jobDescription:e.description,jobGroups:void 0!==e.groups?e.groups:[],jobModelMemoryLimit:a,jobModelSnapshotRetentionDays:n,jobDailyModelSnapshotRetentionAfterDays:i,jobDetectors:s,jobDetectorDescriptions:s.map((e=>e.detector_description)),jobBucketSpan:r,jobCustomUrls:c,datafeedQuery:t?JSON.stringify(o.query,null,2):"",datafeedQueryDelay:t?o.query_delay:"",datafeedFrequency:t?l:"",datafeedScrollSize:t?+o.scroll_size:null})}extractJob(e,t){this.extractInitialJobFormState(e,t);const a=t&&e.datafeed_config.state!==de.a.STOPPED,n=e.state===de.c.CLOSED;this.setState({job:e,hasDatafeed:t,datafeedRunning:a,jobClosed:n,jobModelMemoryLimitValidationError:"",jobGroupsValidationError:"",...Object(d.cloneDeep)(this._initialJobFormState)})}render(){let e,t;if(this.state.isFlyoutVisible){const{job:t,jobDescription:a,jobGroups:n,jobModelMemoryLimit:i,jobModelSnapshotRetentionDays:s,jobDailyModelSnapshotRetentionAfterDays:l,jobDetectors:c,jobDetectorDescriptions:d,jobBucketSpan:u,jobCustomUrls:p,datafeedQuery:m,datafeedQueryDelay:b,datafeedFrequency:f,datafeedScrollSize:h,jobGroupsValidationError:j,jobModelMemoryLimitValidationError:v,isValidJobDetails:y,isValidJobCustomUrls:O,datafeedRunning:E,jobClosed:M}=this.state,S=[{id:"job-details","data-test-subj":"mlEditJobFlyout-jobDetails",name:g.i18n.translate("xpack.ml.jobsList.editJobFlyout.jobDetailsTitle",{defaultMessage:"Job details"}),content:Object(w.jsx)(tabs_job_details_JobDetails,{jobClosed:M,datafeedRunning:E,jobDescription:a,jobGroups:n,jobModelMemoryLimit:i,jobModelSnapshotRetentionDays:s,jobDailyModelSnapshotRetentionAfterDays:l,setJobDetails:this.setJobDetails,jobGroupsValidationError:j,jobModelMemoryLimitValidationError:v})},{id:"detectors","data-test-subj":"mlEditJobFlyout-detectors",name:g.i18n.translate("xpack.ml.jobsList.editJobFlyout.detectorsTitle",{defaultMessage:"Detectors"}),content:Object(w.jsx)(detectors_Detectors,{jobDetectors:c,jobDetectorDescriptions:d,setDetectorDescriptions:this.setDetectorDescriptions})},{id:"datafeed","data-test-subj":"mlEditJobFlyout-datafeed",name:g.i18n.translate("xpack.ml.jobsList.editJobFlyout.datafeedTitle",{defaultMessage:"Datafeed"}),content:Object(w.jsx)(datafeed_Datafeed,{datafeedQuery:m,datafeedQueryDelay:b,datafeedFrequency:f,datafeedScrollSize:h,jobBucketSpan:u,setDatafeed:this.setDatafeed,datafeedRunning:E})},{id:"custom-urls","data-test-subj":"mlEditJobFlyout-customUrls",name:g.i18n.translate("xpack.ml.jobsList.editJobFlyout.customUrlsTitle",{defaultMessage:"Custom URLs"}),content:Object(w.jsx)(Te.a,{job:t,jobCustomUrls:p,setCustomUrls:this.setCustomUrls})}];e=Object(w.jsx)(o.EuiFlyout,{onClose:()=>{this.closeFlyout()},size:"m","data-test-subj":"mlJobEditFlyout"},Object(w.jsx)(o.EuiFlyoutHeader,null,Object(w.jsx)(o.EuiTitle,null,Object(w.jsx)("h2",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.pageTitle",defaultMessage:"Edit {jobId}",values:{jobId:t.job_id}}))),x(t)?Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,{size:"s"}),Object(w.jsx)(Ae.a,{jobsCount:1,action:g.i18n.translate("xpack.ml.jobsList.editJobModal.editManagedJobDescription",{defaultMessage:"editing"})})):null),Object(w.jsx)(o.EuiFlyoutBody,null,Object(w.jsx)(o.EuiTabbedContent,{tabs:S,initialSelectedTab:S[0],onTabClick:()=>{}})),Object(w.jsx)(o.EuiFlyoutFooter,null,Object(w.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButtonEmpty,{iconType:"cross",onClick:()=>{this.closeFlyout()},flush:"left","data-test-subj":"mlEditJobFlyoutCloseButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.closeButtonLabel",defaultMessage:"Close"}))),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButton,{onClick:this.save,fill:!0,isDisabled:!1===y||!1===O,"data-test-subj":"mlEditJobFlyoutSaveButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.saveButtonLabel",defaultMessage:"Save"}))))))}return this.state.isConfirmationModalVisible&&(t=Object(w.jsx)(o.EuiConfirmModal,{title:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.unsavedChangesDialogTitle",defaultMessage:"Save changes before leaving?"}),onCancel:()=>this.closeFlyout(!0),onConfirm:()=>this.save(),cancelButtonText:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.leaveAnywayButtonLabel",defaultMessage:"Leave anyway"}),confirmButtonText:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.saveChangesButtonLabel",defaultMessage:"Save changes"}),defaultFocusedButton:"confirm"},Object(w.jsx)("p",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.editJobFlyout.unsavedChangesDialogMessage",defaultMessage:"If you don't save, your changes will be lost."})))),Object(w.jsx)("div",null,e,t)}}const Le=Object(je.withKibana)(edit_job_flyout_EditJobFlyoutUI);var Re=a(168),Ne=a(285);const Pe=({setShowFunction:e,unsetShowFunction:t,refreshJobs:a})=>{const[n,i]=Object(s.useState)(!1),[l,d]=Object(s.useState)(!1),[u,p]=Object(s.useState)([]),[m,b]=Object(s.useState)(!1),[f,h]=Object(s.useState)(!1);Object(s.useEffect)((()=>("function"==typeof e&&e(j),()=>{"function"==typeof t&&t()})),[]);const j=Object(s.useCallback)((e=>{p(e.map((({id:e})=>e))),h(e.some((e=>x(e)))),d(!0),i(!1)}),[]),v=Object(s.useCallback)((()=>{d(!1),b(!1)}),[]),y=Object(s.useCallback)((()=>{i(!0),Object(c.d)(u.map((e=>({id:e})))),setTimeout((()=>{v(),a()}),Re.b)}),[u,a]);return!1===l||0===u.length?null:m?Object(w.jsx)(o.EuiModal,{"data-test-subj":"mlDeleteJobConfirmModal",onClose:v},Object(w.jsx)(o.EuiModalHeader,null,Object(w.jsx)(o.EuiModalHeaderTitle,null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteJobsTitle",defaultMessage:"Delete {jobsCount, plural, one {{jobId}} other {# jobs}}?",values:{jobsCount:u.length,jobId:u[0]}}))),Object(w.jsx)(o.EuiModalBody,null,Object(w.jsx)("p",null,!0===n?Object(w.jsx)("div",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deletingJobsStatusLabel",defaultMessage:"Deleting jobs"}),Object(w.jsx)(o.EuiSpacer,null),Object(w.jsx)("div",{style:{textAlign:"center"}},Object(w.jsx)(o.EuiLoadingSpinner,{size:"l"}))):Object(w.jsx)(r.a.Fragment,null,f?Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(Ae.a,{jobsCount:u.length,action:g.i18n.translate("xpack.ml.jobsList.deleteJobModal.deleteAction",{defaultMessage:"deleting"})}),Object(w.jsx)(o.EuiSpacer,null)):null,Object(w.jsx)(o.EuiText,null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteMultipleJobsDescription",defaultMessage:"Deleting {jobsCount, plural, one {a job} other {multiple jobs}} can be time consuming. {jobsCount, plural, one {It} other {They}} will be deleted in the background and may not disappear from the jobs list instantly.",values:{jobsCount:u.length}}))))),Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,null),Object(w.jsx)(o.EuiModalFooter,null,Object(w.jsx)(o.EuiButtonEmpty,{onClick:v,disabled:n},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(w.jsx)(o.EuiButton,{onClick:y,fill:!0,disabled:n,color:"danger","data-test-subj":"mlDeleteJobConfirmModalButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.deleteJobModal.deleteButtonLabel",defaultMessage:"Delete"}))))):Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(Ne.a,{jobIds:u,jobType:"anomaly-detector",canDeleteCallback:()=>{b(!0)},onCloseCallback:v,refreshJobsCallback:a,hasManagedJob:f}))},ze=({jobs:e})=>{const t=Object(s.useMemo)((()=>e.filter((e=>e.jobState!==de.c.CLOSED)).length),[e]);return 0===t?null:Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiCallOut,{title:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.openJobsWarningCallout.title",defaultMessage:"{openJobsCount, plural, one {# job is} other {# jobs are}} not closed",values:{openJobsCount:t}}),color:"warning"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.openJobsWarningCallout.description1",defaultMessage:"{openJobsCount, plural, one {This job} other {These jobs}} must be closed before {openJobsCount, plural, one {it} other {they}} can be reset. ",values:{openJobsCount:t}}),Object(w.jsx)("br",null),Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.openJobsWarningCallout.description2",defaultMessage:"{openJobsCount, plural, one {This job} other {These jobs}} will not be reset when clicking the Reset button below.",values:{openJobsCount:t}})),Object(w.jsx)(o.EuiSpacer,{size:"m"}))},Be=({setShowFunction:e,unsetShowFunction:t,refreshJobs:a})=>{const[n,i]=Object(s.useState)(!1),[l,d]=Object(s.useState)(!1),[u,p]=Object(s.useState)([]),[m,b]=Object(s.useState)([]),[f,h]=Object(s.useState)(!1);Object(s.useEffect)((()=>("function"==typeof e&&e(j),()=>{"function"==typeof t&&t()})),[]);const j=Object(s.useCallback)((e=>{p(e.map((({id:e})=>e))),b(e),h(e.some((e=>x(e)))),d(!0),i(!1)}),[]),v=Object(s.useCallback)((()=>{d(!1)}),[]),y=Object(s.useCallback)((async()=>{i(!0),await Object(c.l)(u),v(),setTimeout((()=>{a()}),Re.d)}),[u,a]);return!1===l||0===u.length?null:Object(w.jsx)(o.EuiModal,{"data-test-subj":"mlResetJobConfirmModal",onClose:v},Object(w.jsx)(o.EuiModalHeader,null,Object(w.jsx)(o.EuiModalHeaderTitle,null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.resetJobsTitle",defaultMessage:"Reset {jobsCount, plural, one {{jobId}} other {# jobs}}?",values:{jobsCount:u.length,jobId:u[0]}}))),Object(w.jsx)(o.EuiModalBody,null,Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(ze,{jobs:m}),!0===f?Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(Ae.a,{jobsCount:u.length,action:g.i18n.translate("xpack.ml.jobsList.startDatafeedsModal.resetManagedDatafeedsDescription",{defaultMessage:"resetting"})}),Object(w.jsx)(o.EuiSpacer,null)):null,Object(w.jsx)(o.EuiText,null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.resetMultipleJobsDescription",defaultMessage:"Resetting {jobsCount, plural, one {a job} other {multiple jobs}} can be time consuming. {jobsCount, plural, one {It} other {They}} will be reset in the background and may not be updated in the jobs list instantly.",values:{jobsCount:u.length}})))),Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,null),Object(w.jsx)(o.EuiModalFooter,null,Object(w.jsx)(o.EuiButtonEmpty,{onClick:v,disabled:n},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(w.jsx)(o.EuiButton,{onClick:y,fill:!0,disabled:n,color:"danger","data-test-subj":"mlResetJobConfirmModalButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.resetJobModal.resetButtonLabel",defaultMessage:"Reset"})))))};a(451);class time_range_selector_TimeRangeSelector extends s.Component{constructor(e){super(e),i()(this,"setStartTab",(e=>{switch(this.setState({startTab:e}),e){case 0:this.setStartTime(void 0);break;case 1:this.setStartTime(this.now)}})),i()(this,"setEndTab",(e=>{switch(this.setState({endTab:e}),e){case 0:this.setEndTime(void 0);break;case 1:this.setEndTime(this.now)}})),i()(this,"setStartTime",(e=>{this.props.setStartTime(e)})),i()(this,"setEndTime",(e=>{this.props.setEndTime(e)})),this.state={startTab:0,endTab:1},this.latestTimestamp=this.props.startTime,this.now=this.props.now}getTabItems(){const e={start:p.a.isMoment(this.props.startTime)?this.props.startTime:this.latestTimestamp,end:p.a.isMoment(this.props.endTime)?this.props.endTime:this.now},t=this.latestTimestamp.format(L.a),a=!0===this.latestTimestamp.valueOf()>0?[Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromStartTimeLabel",defaultMessage:"Continue from {formattedLatestStartTime}",values:{formattedLatestStartTime:t}}),Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromNowLabel",defaultMessage:"Continue from now"}),Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.continueFromSpecifiedTimeLabel",defaultMessage:"Continue from specified time"})]:[Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startAtBeginningOfDataLabel",defaultMessage:"Start at beginning of data"}),Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startFromNowLabel",defaultMessage:"Start from now"}),Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyStartTimeLabel",defaultMessage:"Specify start time"})];return{startItems:[{index:0,label:a[0]},{index:1,label:a[1]},{index:2,label:a[2],body:Object(w.jsx)(Ve,{date:e.start,onChange:this.setStartTime,maxDate:e.end,setIsValid:this.props.setTimeRangeValid,tab:this.state.startTab})}],endItems:[{index:0,label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.noEndTimeLabel",defaultMessage:"No end time (Real-time search)"})},{index:1,label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.specifyEndTimeLabel",defaultMessage:"Specify end time"}),body:Object(w.jsx)(Ve,{date:e.end,onChange:this.setEndTime,minDate:e.start,setIsValid:this.props.setTimeRangeValid,tab:this.state.endTab})}]}}render(){const{startItems:e,endItems:t}=this.getTabItems();return Object(w.jsx)("div",{className:"time-range-selector"},!0===this.props.hasManagedJob&&0!==this.state.endTab?Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(Ae.a,{jobsCount:this.props.jobsCount,message:g.i18n.translate("xpack.ml.jobsList.startDatafeedsModal.startManagedDatafeedsDescription",{defaultMessage:"{jobsCount, plural, one {This job} other {At least one of these jobs}} is preconfigured by Elastic; starting {jobsCount, plural, one {it} other {them}} with a specific end time might impact other parts of the product.",values:{jobsCount:this.props.jobsCount}})}),Object(w.jsx)(o.EuiSpacer,null)):null,Object(w.jsx)("div",{className:"time-range-section-container"},Object(w.jsx)(Je,{title:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchStartTimeTitle",defaultMessage:"Search start time"}),items:e,switchState:this.state.startTab,switchFunc:this.setStartTab}),Object(w.jsx)(Je,{title:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.searchEndTimeTitle",defaultMessage:"Search end time"}),items:t,switchState:this.state.endTab,switchFunc:this.setEndTab})))}}function Je({title:e,items:t,switchState:a,switchFunc:n}){return Object(w.jsx)("div",{className:"time-range-section"},Object(w.jsx)("div",{className:"time-range-section-title"},e),Object(w.jsx)("ul",{className:"tab-stack"},t.map(((e,t)=>{let i="";return a===e.index&&(i+="active "),void 0!==e.body&&(i+="has-body "),Object(w.jsx)("li",{key:t,className:i},Object(w.jsx)("a",{onClick:()=>n(e.index),onKeyUp:()=>{}},e.label),void 0!==e.body&&Object(w.jsx)("div",{className:"body"},e.body))}))))}const Ve=({date:e,onChange:t,minDate:a,setIsValid:n,tab:i})=>{const[l,c]=Object(s.useState)(e.format(L.a)),[d,u]=Object(s.useState)(i);return Object(s.useEffect)((()=>{d!==i&&(c(e.format(L.a)),u(i))}),[i]),Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiFieldText,{value:l,onChange:function(e){const a=e.target.value;c(a);const i=p()(a);i.isValid()?(n(!0),t(i)):n(!1)},placeholder:L.a,"aria-label":g.i18n.translate('xpack.ml.jobsList.startDatafeedModal.enterDateText"',{defaultMessage:"Enter date"})}),Object(w.jsx)(o.EuiDatePicker,{selected:e,onChange:function(e){c(e.format(L.a)),n(!0),t(e)},minDate:a,inline:!0,showTimeSelect:!0}))};class start_datafeed_modal_StartDatafeedModal extends s.Component{constructor(e){super(e),i()(this,"setStartTime",(e=>{this.setState({startTime:e})})),i()(this,"setEndTime",(e=>{this.setState({endTime:e})})),i()(this,"setCreateAlert",(e=>{this.setState({createAlert:e.target.checked})})),i()(this,"closeModal",(()=>{this.setState({isModalVisible:!1})})),i()(this,"setTimeRangeValid",(e=>{this.setState({timeRangeValid:e})})),i()(this,"showModal",((e,t)=>{const a=p()(),n=a,i=function(e){const t=e.map((e=>e.earliestStartTimestampMs||0));return p()(Math.min(...t))}(e),s=e.length>0;this.setState({jobs:e,isModalVisible:!0,startTime:undefined,endTime:n,initialSpecifiedStartTime:i,showCreateAlertFlyout:t,allowCreateAlert:s,createAlert:!1,now:a,hasManagedJob:e.some((e=>x(e)))})})),i()(this,"save",(()=>{const{jobs:e}=this.state,t=p.a.isMoment(this.state.startTime)?this.state.startTime.valueOf():this.state.startTime,a=p.a.isMoment(this.state.endTime)?this.state.endTime.valueOf():this.state.endTime;Object(c.f)(e,t,a,(()=>{this.state.createAlert&&e.length>0&&this.getShowCreateAlertFlyoutFunction()(e.map((e=>e.id))),this.refreshJobs()})),this.closeModal()}));const t=p()();this.state={jobs:this.props.jobs,isModalVisible:!1,startTime:t,endTime:t,createAlert:!1,allowCreateAlert:!1,initialSpecifiedStartTime:t,now:t,timeRangeValid:!0,hasManagedJob:!1},this.initialSpecifiedStartTime=t,this.refreshJobs=this.props.refreshJobs,this.getShowCreateAlertFlyoutFunction=this.props.getShowCreateAlertFlyoutFunction}componentDidMount(){"function"==typeof this.props.setShowFunction&&this.props.setShowFunction(this.showModal)}componentWillUnmount(){"function"==typeof this.props.unsetShowFunction&&this.props.unsetShowFunction()}render(){const{jobs:e,initialSpecifiedStartTime:t,startTime:a,endTime:n,createAlert:i,now:s,timeRangeValid:r}=this.state,l=void 0!==e?e.filter((e=>e.hasDatafeed)):[],c=!1===r||void 0!==a&&a===n;let d;return this.state.isModalVisible&&(d=Object(w.jsx)(o.EuiModal,{onClose:this.closeModal,style:{width:"850px"},maxWidth:!1,"data-test-subj":"mlStartDatafeedModal"},Object(w.jsx)(o.EuiModalHeader,null,Object(w.jsx)(o.EuiModalHeaderTitle,null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startJobsTitle",defaultMessage:"Start {jobsCount, plural, one {{jobId}} other {# jobs}}",values:{jobsCount:l.length,jobId:l[0].id}}))),Object(w.jsx)(o.EuiModalBody,null,Object(w.jsx)(time_range_selector_TimeRangeSelector,{startTime:void 0===a?t:a,endTime:n,setStartTime:this.setStartTime,setEndTime:this.setEndTime,now:s,setTimeRangeValid:this.setTimeRangeValid,hasManagedJob:this.state.hasManagedJob,jobsCount:l.length}),void 0===this.state.endTime&&Object(w.jsx)("div",{className:"create-watch"},Object(w.jsx)(o.EuiHorizontalRule,null),Object(w.jsx)(o.EuiCheckbox,{id:"createAlert",label:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.createAlertDescription",defaultMessage:"Create alert rule after datafeed has started"}),checked:i,onChange:this.setCreateAlert}))),Object(w.jsx)(o.EuiModalFooter,null,Object(w.jsx)(o.EuiButtonEmpty,{onClick:this.closeModal,"data-test-subj":"mlStartDatafeedModalCancelButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(w.jsx)(o.EuiButton,{onClick:this.save,isDisabled:c,fill:!0,"data-test-subj":"mlStartDatafeedModalStartButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedModal.startButtonLabel",defaultMessage:"Start"}))))),Object(w.jsx)("div",null,d)}}class actions_menu_MultiJobActionsMenuUI extends s.Component{constructor(e){super(e),i()(this,"onButtonClick",(()=>{this.setState((e=>({isOpen:!e.isOpen})))})),i()(this,"closePopover",(()=>{this.setState({isOpen:!1})})),this.state={isOpen:!1},this.canDeleteJob=Object(b.e)("canDeleteJob"),this.canStartStopDatafeed=Object(b.e)("canStartStopDatafeed")&&Object(f.e)(),this.canCloseJob=Object(b.e)("canCloseJob")&&Object(f.e)(),this.canResetJob=Object(b.e)("canResetJob")&&Object(f.e)(),this.canCreateMlAlerts=Object(b.e)("canCreateMlAlerts")}render(){const e=this.props.jobs.some((e=>void 0!==e.blocked)),t=Object(w.jsx)(o.EuiButtonIcon,{size:"s",onClick:this.onButtonClick,iconType:"gear","aria-label":g.i18n.translate("xpack.ml.jobsList.multiJobActionsMenu.managementActionsAriaLabel",{defaultMessage:"Management actions"}),color:"text",disabled:e||!1===this.canDeleteJob&&!1===this.canStartStopDatafeed,"data-test-subj":"mlADJobListMultiSelectManagementActionsButton"}),a=[Object(w.jsx)(o.EuiContextMenuItem,{key:"delete",icon:"trash",disabled:!1===this.canDeleteJob,onClick:()=>{this.props.showDeleteJobModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectDeleteJobActionButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.deleteJobsLabel",defaultMessage:"Delete {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))];return Object(c.g)(this.props.jobs)&&a.push(Object(w.jsx)(o.EuiContextMenuItem,{key:"close job",icon:"cross",disabled:!1===this.canCloseJob,onClick:()=>{this.props.jobs.some((e=>x(e)))?this.props.showCloseJobsConfirmModal(this.props.jobs):Object(c.c)(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectCloseJobActionButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.closeJobsLabel",defaultMessage:"Close {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))),Object(c.h)(this.props.jobs)&&a.push(Object(w.jsx)(o.EuiContextMenuItem,{key:"reset job",icon:"refresh",disabled:!1===this.canCloseJob,onClick:()=>{this.props.showResetJobModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectResetJobActionButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.resetJobsLabel",defaultMessage:"Reset {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}}))),Object(c.j)(this.props.jobs)&&a.push(Object(w.jsx)(o.EuiContextMenuItem,{key:"stop datafeed",icon:"stop",disabled:!1===this.canStartStopDatafeed,onClick:()=>{this.props.jobs.some((e=>x(e)))?this.props.showStopDatafeedsConfirmModal(this.props.jobs):Object(c.m)(this.props.jobs,this.props.refreshJobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectStopDatafeedActionButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.stopDatafeedsLabel",defaultMessage:"Stop {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}}))),Object(c.i)(this.props.jobs)&&a.push(Object(w.jsx)(o.EuiContextMenuItem,{key:"start datafeed",icon:"play",disabled:!1===this.canStartStopDatafeed,onClick:()=>{this.props.showStartDatafeedModal(this.props.jobs),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectStartDatafeedActionButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.startDatafeedsLabel",defaultMessage:"Start {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:this.props.jobs.length}}))),this.canCreateMlAlerts&&1===this.props.jobs.length&&a.push(Object(w.jsx)(o.EuiContextMenuItem,{key:"create alert",icon:"bell",disabled:!1,onClick:()=>{this.props.showCreateAlertFlyout(this.props.jobs.map((({id:e})=>e))),this.closePopover()},"data-test-subj":"mlADJobListMultiSelectCreateAlertActionButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.createAlertsLabel",defaultMessage:"Create alert rule"}))),Object(w.jsx)(o.EuiPopover,{button:t,isOpen:this.state.isOpen,closePopover:this.closePopover,panelPaddingSize:"none",anchorPosition:"downCenter"},Object(w.jsx)(o.EuiContextMenuPanel,{items:a.reverse()}))}}const Ue=actions_menu_MultiJobActionsMenuUI;function Ge({group:e,selectedGroups:t}){return void 0!==t[e.id]?t[e.id].partial?Object(w.jsx)("div",{className:"check selected"},Object(w.jsx)("span",null,"—")):Object(w.jsx)("div",{className:"check selected"},Object(w.jsx)(o.EuiIcon,{type:"check"})):Object(w.jsx)("div",{className:"check"})}class group_list_GroupList extends s.Component{constructor(e){super(e),i()(this,"selectGroup",(e=>{this.props.selectGroup(e)})),i()(this,"moveUp",((e,t)=>{e.preventDefault(),t<0||t>0&&this.selectItems[t-1].focus()})),i()(this,"moveDown",((e,t)=>{e.preventDefault(),t<this.selectItems.length-1&&this.selectItems[t+1].focus()})),i()(this,"handleKeyDown",((e,t,a)=>{switch(e.key){case o.keys.ENTER:case o.keys.SPACE:this.selectGroup(t);break;case o.keys.ARROW_DOWN:this.moveDown(e,a);break;case o.keys.ARROW_UP:this.moveUp(e,a)}})),i()(this,"setRef",((e,t)=>{this.selectItems[t]=e})),this.state={groups:[]},this.selectItems=[]}render(){const{selectedGroups:e,groups:t}=this.props;return Object(w.jsx)("div",{className:"group-list"},t.map(((t,a)=>Object(w.jsx)("div",{tabIndex:"0",onKeyDown:e=>this.handleKeyDown(e,t,a),key:t.id,className:"group-item",onClick:()=>this.selectGroup(t),ref:e=>this.setRef(e,a)},Object(w.jsx)(o.EuiFlexGroup,null,Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(_,{name:t.id})),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(Ge,{group:t,selectedGroups:e})))))))}}class new_group_input_NewGroupInput extends s.Component{constructor(e){super(e),i()(this,"changeTempNewGroup",(e=>{const t=e.target.value;let a="";a=""===t?"":this.props.allJobIds.includes(t)?g.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.groupsAndJobsCanNotUseSameIdErrorMessage",{defaultMessage:"A job with this ID already exists. Groups and jobs cannot use the same ID."}):Ie([t]).message,this.setState({tempNewGroupName:t,groupsValidationError:a})})),i()(this,"newGroupKeyPress",(e=>{e.key===o.keys.ENTER&&""===this.state.groupsValidationError&&""!==this.state.tempNewGroupName&&this.addNewGroup()})),i()(this,"addNewGroup",(()=>{this.props.addNewGroup(this.state.tempNewGroupName),this.setState({tempNewGroupName:""})})),this.state={tempNewGroupName:"",groupsValidationError:""}}render(){const{tempNewGroupName:e,groupsValidationError:t}=this.state;return Object(w.jsx)("div",null,Object(w.jsx)(o.EuiFlexGroup,{gutterSize:"s",alignItems:"center"},Object(w.jsx)(o.EuiFlexItem,null,Object(w.jsx)(o.EuiFormRow,{display:"rowCompressed",isInvalid:""!==t,error:t,className:"new-group-input"},Object(w.jsx)(o.EuiFieldText,{compressed:!0,placeholder:g.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.addNewGroupPlaceholder",{defaultMessage:"Add new group"}),value:e,onChange:this.changeTempNewGroup,onKeyDown:this.newGroupKeyPress,isInvalid:""!==t,error:t}))),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiFormRow,{className:"new-group-input"},Object(w.jsx)(o.EuiButtonIcon,{onClick:this.addNewGroup,iconType:"plusInCircle","aria-label":g.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.addButtonAriaLabel",{defaultMessage:"Add"}),disabled:""===e||""!==t})))))}}function qe(e,t){const a=e.map((e=>e.id)),n={};e.forEach((e=>{e.groups.forEach((e=>{void 0===n[e]&&(n[e]=0),n[e]++}))}));return t.reduce(((e,t)=>(t.jobIds.some((e=>a.includes(e)))&&(e[t.id]={partial:n[t.id]!==a.length}),e)),{})}class group_selector_GroupSelector extends s.Component{constructor(e){super(e),i()(this,"togglePopover",(()=>{this.state.isPopoverOpen?this.closePopover():l.ml.jobs.groups().then((e=>{const t=qe(this.props.jobs,e);this.setState({isPopoverOpen:!0,edited:!1,selectedGroups:t,groups:e})})).catch((e=>{console.error(e)}))})),i()(this,"closePopover",(()=>{this.setState({edited:!1,isPopoverOpen:!1})})),i()(this,"selectGroup",(e=>{const t=Object(d.cloneDeep)(this.state.selectedGroups);void 0===t[e.id]?t[e.id]={partial:!1}:!0===t[e.id].partial?t[e.id].partial=!1:delete t[e.id],this.setState({selectedGroups:t,edited:!0})})),i()(this,"applyChanges",(()=>{const{selectedGroups:e}=this.state,{jobs:t}=this.props,a=t.map((e=>({id:e.id,oldGroups:e.groups,newGroups:[]})));for(const t in e)if(e.hasOwnProperty(t)){const n=e[t];a.forEach((e=>{(!1===n.partial||!0===n.partial&&e.oldGroups.includes(t))&&e.newGroups.push(t)}))}const n=a.map((e=>({jobId:e.id,groups:e.newGroups})));l.ml.jobs.updateGroups(n).then((e=>{let t=!0;for(const a in e)e.hasOwnProperty(a)&&!1===e[a].success&&(Object(oe.a)().displayErrorToast(e[a].error),t=!1);t?(this.refreshJobs(),this.closePopover()):console.error(e)})).catch((e=>{Object(oe.a)().displayErrorToast(e),console.error(e)}))})),i()(this,"addNewGroup",(e=>{const t={id:e,calendarIds:[],jobIds:[]},a=this.state.groups;!1===a.some((e=>e.id===t.id))&&a.push(t),this.setState({groups:a})})),this.state={isPopoverOpen:!1,groups:[],selectedGroups:{},edited:!1},this.refreshJobs=this.props.refreshJobs,this.canUpdateJob=Object(b.e)("canUpdateJob")}static getDerivedStateFromProps(e,t){if(!1===t.edited){return{selectedGroups:qe(e.jobs,t.groups)}}return{}}render(){const{groups:e,selectedGroups:t,edited:a}=this.state,n=Object(w.jsx)(o.EuiToolTip,{position:"bottom",content:Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonTooltip",defaultMessage:"Edit job groups"})},Object(w.jsx)(o.EuiButtonIcon,{iconType:"indexEdit","aria-label":g.i18n.translate("xpack.ml.jobsList.multiJobActions.groupSelector.editJobGroupsButtonAriaLabel",{defaultMessage:"Edit job groups"}),onClick:()=>this.togglePopover(),disabled:!1===this.canUpdateJob,"data-test-subj":"mlADJobListMultiSelectEditJobGroupsButton"}));return Object(w.jsx)(o.EuiPopover,{id:"trapFocus",ownFocus:!0,button:n,isOpen:this.state.isPopoverOpen,closePopover:()=>this.closePopover()},Object(w.jsx)("div",{className:"group-selector"},Object(w.jsx)(o.EuiPopoverTitle,null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyGroupsToJobTitle",defaultMessage:"Apply groups to {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:this.props.jobs.length}})),Object(w.jsx)(group_list_GroupList,{groups:e,selectedGroups:t,selectGroup:this.selectGroup}),Object(w.jsx)(o.EuiHorizontalRule,{margin:"xs"}),Object(w.jsx)(o.EuiSpacer,{size:"s"}),Object(w.jsx)(new_group_input_NewGroupInput,{addNewGroup:this.addNewGroup,allJobIds:this.props.allJobIds}),Object(w.jsx)(o.EuiHorizontalRule,{margin:"m"}),Object(w.jsx)("div",null,Object(w.jsx)(o.EuiFlexGroup,null,Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiButton,{size:"s",onClick:this.applyChanges,isDisabled:!1===a},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobActions.groupSelector.applyButtonLabel",defaultMessage:"Apply"})))))))}}class multi_job_actions_MultiJobActions extends s.Component{constructor(e){super(e),this.state={}}render(){const e=this.props.selectedJobs.length>0;return Object(w.jsx)("div",{className:"multi-select-actions"+(e?"":"-no-display"),"data-test-subj":"mlADJobListMultiSelectActionsArea "+(e?"active":"inactive")},e&&Object(w.jsx)(o.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",wrap:!1,direction:"row",responsive:!1},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiTitle,{size:"s"},Object(w.jsx)("h3",null,Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.multiJobsActions.jobsSelectedLabel",defaultMessage:"{selectedJobsCount, plural, one {# job} other {# jobs}}   selected",values:{selectedJobsCount:this.props.selectedJobs.length}})))),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)("div",{className:"actions-border-large"})),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(M,{jobs:this.props.selectedJobs})),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(group_selector_GroupSelector,{jobs:this.props.selectedJobs,allJobIds:this.props.allJobIds,refreshJobs:this.props.refreshJobs})),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(Ue,{jobs:this.props.selectedJobs,showCloseJobsConfirmModal:this.props.showCloseJobsConfirmModal,showStartDatafeedModal:this.props.showStartDatafeedModal,showDeleteJobModal:this.props.showDeleteJobModal,showResetJobModal:this.props.showResetJobModal,showStopDatafeedsConfirmModal:this.props.showStopDatafeedsConfirmModal,refreshJobs:this.props.refreshJobs,showCreateAlertFlyout:this.props.showCreateAlertFlyout}))))}}var We=a(113);function He(){const e=Object(b.e)("canCreateJob")&&Object(f.e)(),t=Object(We.a)(C.b.ANOMALY_DETECTION_CREATE_JOB_SELECT_INDEX);return Object(w.jsx)(o.EuiButton,{"data-test-subj":"mlCreateNewJobButton",onClick:t,size:"s",disabled:!1===e,fill:!0,iconType:"plusInCircle"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.createNewJobButtonLabel",defaultMessage:"Create job"}))}var Ye=a(164);const $e=({jobsSummaryList:e})=>{const t=function(e){const t={activeNodes:{label:g.i18n.translate("xpack.ml.jobsList.statsBar.activeMLNodesLabel",{defaultMessage:"Active ML nodes"}),value:0,show:!0},total:{label:g.i18n.translate("xpack.ml.jobsList.statsBar.totalJobsLabel",{defaultMessage:"Total jobs"}),value:0,show:!0},open:{label:g.i18n.translate("xpack.ml.jobsList.statsBar.openJobsLabel",{defaultMessage:"Open jobs"}),value:0,show:!0},closed:{label:g.i18n.translate("xpack.ml.jobsList.statsBar.closedJobsLabel",{defaultMessage:"Closed jobs"}),value:0,show:!0},failed:{label:g.i18n.translate("xpack.ml.jobsList.statsBar.failedJobsLabel",{defaultMessage:"Failed jobs"}),value:0,show:!1},activeDatafeeds:{label:g.i18n.translate("xpack.ml.jobsList.statsBar.activeDatafeedsLabel",{defaultMessage:"Active datafeeds"}),value:0,show:!0}};if(void 0===e)return t;const a={};let n=0;return e.forEach((e=>{e.jobState===de.c.OPENED?t.open.value++:e.jobState===de.c.CLOSED?t.closed.value++:e.jobState===de.c.FAILED&&n++,e.hasDatafeed&&e.datafeedState===de.a.STARTED&&t.activeDatafeeds.value++,void 0!==e.nodeName&&(a[e.nodeName]={})})),t.total.value=e.length,n?(t.failed.value=n,t.failed.show=!0):t.failed.show=!1,t.activeNodes.value=Object.keys(a).length,t}(e);return Object(w.jsx)(Ye.a,{stats:t,dataTestSub:"mlJobStatsBar"})};var Xe=a(280),Ke=a(165),Qe=a(281),Ze=a(282);const et=({onRefreshClick:e,isRefreshing:t})=>Object(w.jsx)(o.EuiButtonEmpty,{"data-test-subj":"mlRefreshJobListButton"+(t?" loading":" loaded"),onClick:e,isLoading:t},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.refreshButtonLabel",defaultMessage:"Refresh"})),tt=({setShowFunction:e,unsetShowFunction:t,refreshJobs:a})=>{const[n,i]=Object(s.useState)(!1),[l,d]=Object(s.useState)(!0),[u,p]=Object(s.useState)([]),m=Object(s.useMemo)((()=>u.map((({id:e})=>e))),[u]);Object(s.useEffect)((()=>("function"==typeof e&&e(b),()=>{"function"==typeof t&&t()})),[]);const b=Object(s.useCallback)((e=>{p(e),e.some((e=>x(e)))&&(i(!0),d(!0))}),[]),f=Object(s.useCallback)((()=>{i(!1),d(!1)}),[]);if(!1===n)return null;if(l){const e=Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.stopDatafeedsModal.stopDatafeedsTitle",defaultMessage:"Stop datafeed for {jobsCount, plural, one {{jobId}} other {# jobs}}?",values:{jobsCount:m.length,jobId:m[0]}});return Object(w.jsx)(o.EuiModal,{"data-test-subj":"mlStopDatafeedsConfirmModal",onClose:f},Object(w.jsx)(o.EuiModalHeader,null,Object(w.jsx)(o.EuiModalHeaderTitle,null,e)),Object(w.jsx)(o.EuiModalBody,null,Object(w.jsx)(Ae.a,{jobsCount:m.length,action:g.i18n.translate("xpack.ml.jobsList.stopDatafeedsModal.stopManagedDatafeedsDescription",{defaultMessage:"stopping"})})),Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,null),Object(w.jsx)(o.EuiModalFooter,null,Object(w.jsx)(o.EuiButtonEmpty,{onClick:f},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.stopDatafeedsConfirmModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(w.jsx)(o.EuiButton,{onClick:()=>{Object(c.m)(u,a),f()},fill:!0,color:"danger","data-test-subj":"mlStopDatafeedsConfirmModalButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.stopDatafeedsConfirmModal.stopButtonLabel",defaultMessage:"Stop {jobsCount, plural, one {datafeed} other {datafeeds}}",values:{jobsCount:m.length}})))))}return Object(w.jsx)(r.a.Fragment,null)},at=({setShowFunction:e,unsetShowFunction:t,refreshJobs:a})=>{const[n,i]=Object(s.useState)(!1),[l,d]=Object(s.useState)(!0),[u,p]=Object(s.useState)([]),m=Object(s.useMemo)((()=>u.map((({id:e})=>e))),[u]);Object(s.useEffect)((()=>("function"==typeof e&&e(b),()=>{"function"==typeof t&&t()})),[]);const b=Object(s.useCallback)((e=>{p(e),e.some((e=>x(e)))&&(i(!0),d(!0))}),[]),f=Object(s.useCallback)((()=>{i(!1),d(!1)}),[]);if(!1===n)return null;if(l){const e=Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedsModal.closeDatafeedsTitle",defaultMessage:"Close {jobsCount, plural, one {{jobId}} other {# jobs}}?",values:{jobsCount:m.length,jobId:m[0]}});return Object(w.jsx)(o.EuiModal,{"data-test-subj":"mlCloseJobsConfirmModal",onClose:f},Object(w.jsx)(o.EuiModalHeader,null,Object(w.jsx)(o.EuiModalHeaderTitle,null,e)),Object(w.jsx)(o.EuiModalBody,null,Object(w.jsx)(Ae.a,{jobsCount:m.length,action:g.i18n.translate("xpack.ml.jobsList.closeJobsModal.closeManagedDatafeedsDescription",{defaultMessage:"closing"})})),Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiSpacer,null),Object(w.jsx)(o.EuiModalFooter,null,Object(w.jsx)(o.EuiButtonEmpty,{onClick:f},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedsConfirmModal.cancelButtonLabel",defaultMessage:"Cancel"})),Object(w.jsx)(o.EuiButton,{onClick:()=>{Object(c.c)(u,a),f()},fill:!0,color:"danger","data-test-subj":"mlCloseJobsConfirmModalButton"},Object(w.jsx)(R.FormattedMessage,{id:"xpack.ml.jobsList.startDatafeedsConfirmModal.closeButtonLabel",defaultMessage:"Close {jobsCount, plural, one {job} other {jobs}}",values:{jobsCount:m.length}})))))}return Object(w.jsx)(r.a.Fragment,null)};var nt=a(283);let it=null;class jobs_list_view_JobsListView extends s.Component{constructor(e){super(e),i()(this,"toggleRow",(e=>{if(this.state.itemIdToExpandedRowMap[e]){const t={...this.state.itemIdToExpandedRowMap};delete t[e],this.setState({itemIdToExpandedRowMap:t})}else{const t=this.state.jobsSummaryList.filter((t=>t.id===e)),a=t.length>0&&void 0!==t[0].auditMessage;let n={...this.state.itemIdToExpandedRowMap};void 0!==this.state.fullJobsList[e]?n[e]=Object(w.jsx)(Ee,{jobId:e,job:this.state.fullJobsList[e],addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick,showClearButton:a}):n[e]=Object(w.jsx)(Ee,{jobId:e,addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick,showClearButton:a}),this.setState({itemIdToExpandedRowMap:n},(()=>{Object(c.k)(e).then((t=>{const i={...this.state.fullJobsList};i[e]=t,this.setState({fullJobsList:i},(()=>{n={...this.state.itemIdToExpandedRowMap},void 0!==n[e]&&(n[e]=Object(w.jsx)(Ee,{jobId:e,job:t,addYourself:this.addUpdateFunction,removeYourself:this.removeUpdateFunction,showFullDetails:!0!==this.props.isManagementTable,refreshJobList:this.onRefreshClick,showClearButton:a})),this.setState({itemIdToExpandedRowMap:n},(()=>{this.updateFunctions[e](t)}))}))})).catch((e=>{console.error(e)}))}))}})),i()(this,"addUpdateFunction",((e,t)=>{this.updateFunctions[e]=t})),i()(this,"removeUpdateFunction",(e=>{delete this.updateFunctions[e]})),i()(this,"setShowEditJobFlyoutFunction",(e=>{this.showEditJobFlyout=e})),i()(this,"unsetShowEditJobFlyoutFunction",(()=>{this.showEditJobFlyout=()=>{}})),i()(this,"setShowStopDatafeedsConfirmModalFunction",(e=>{this.showStopDatafeedsConfirmModal=e})),i()(this,"unsetShowStopDatafeedsConfirmModalFunction",(()=>{this.showStopDatafeedsConfirmModal=()=>{}})),i()(this,"setShowCloseJobsConfirmModalFunction",(e=>{this.showCloseJobsConfirmModal=e})),i()(this,"unsetShowCloseJobsConfirmModalFunction",(()=>{this.showCloseJobsConfirmModal=()=>{}})),i()(this,"setShowDeleteJobModalFunction",(e=>{this.showDeleteJobModal=e})),i()(this,"unsetShowDeleteJobModalFunction",(()=>{this.showDeleteJobModal=()=>{}})),i()(this,"setShowResetJobModalFunction",(e=>{this.showResetJobModal=e})),i()(this,"unsetShowResetJobModalFunction",(()=>{this.showResetJobModal=()=>{}})),i()(this,"setShowStartDatafeedModalFunction",(e=>{this.showStartDatafeedModal=e})),i()(this,"unsetShowStartDatafeedModalFunction",(()=>{this.showStartDatafeedModal=()=>{}})),i()(this,"setShowCreateAlertFlyoutFunction",(e=>{this.showCreateAlertFlyout=e})),i()(this,"unsetShowCreateAlertFlyoutFunction",(()=>{this.showCreateAlertFlyout=()=>{}})),i()(this,"getShowCreateAlertFlyoutFunction",(()=>this.showCreateAlertFlyout)),i()(this,"selectJobChange",(e=>{this.setState({selectedJobs:e})})),i()(this,"setFilters",(async e=>{if(null===e)return void this.setState({filteredJobsSummaryList:this.state.jobsSummaryList,filterClauses:[]},(()=>{this.refreshSelectedJobs()}));this.props.onJobsViewStateUpdate({queryText:null==e?void 0:e.text},!1===this._isFiltersSet);const t=e&&e.ast&&e.ast.clauses||[];if(0===t.length)return void this.setState({filteredJobsSummaryList:this.state.jobsSummaryList,filterClauses:t},(()=>{this.refreshSelectedJobs()}));const a=Object(c.e)(this.state.jobsSummaryList,t);this.setState({filteredJobsSummaryList:a,filterClauses:t},(()=>{this.refreshSelectedJobs()})),this._isFiltersSet=!0})),i()(this,"onRefreshClick",(()=>{this.setState({isRefreshing:!0}),this.refreshJobSummaryList(!0)})),i()(this,"isDoneRefreshing",(()=>{this.setState({isRefreshing:!1})})),this.state={isRefreshing:!1,loading:null,jobsSummaryList:[],filteredJobsSummaryList:[],fullJobsList:{},selectedJobs:[],itemIdToExpandedRowMap:{},filterClauses:[],blockingJobIds:[],jobsAwaitingNodeCount:0},this.updateFunctions={},this.showEditJobFlyout=()=>{},this.showStopDatafeedsConfirmModal=()=>{},this.showCloseJobsConfirmModal=()=>{},this.showDeleteJobModal=()=>{},this.showResetJobModal=()=>{},this.showStartDatafeedModal=()=>{},this.showCreateAlertFlyout=()=>{},this._isMounted=!1,this._isFiltersSet=!1}componentDidMount(){this._isMounted=!0,this.refreshJobSummaryList(!0),!0!==this.props.isManagementTable&&this.openAutoStartDatafeedModal()}componentDidUpdate(e){e.lastRefresh!==this.props.lastRefresh&&(this.setState({isRefreshing:!0}),this.refreshJobSummaryList())}componentWillUnmount(){void 0===this.props.isManagementTable&&(it=null),this._isMounted=!1}openAutoStartDatafeedModal(){const e=Object(c.a)();void 0!==e&&this.showStartDatafeedModal([e])}refreshSelectedJobs(){var e;const t=this.state.selectedJobs.map((e=>e.id)),a=(null!==(e=this.state.filteredJobsSummaryList)&&void 0!==e?e:[]).map((e=>e.id)),n=this.state.jobsSummaryList.filter((e=>t.find((t=>t===e.id)))).filter((e=>a.find((t=>t===e.id))));this.setState({selectedJobs:n})}async refreshJobSummaryList(e=!1){if(this._isMounted&&(!0===e||!0!==this.props.blockRefresh)){null===this.state.loading&&this.setState({loading:!0});const t=Object.keys(this.state.itemIdToExpandedRowMap);try{let a={};if(this.props.spacesApi&&this.props.isManagementTable){const e=await l.ml.savedObjects.jobsSpaces();a=e["anomaly-detector"]}let n=0;const i=await l.ml.jobs.jobsSummary(t),s={},r=i.map((e=>(void 0!==e.fullJob&&(s[e.id]=e.fullJob,delete e.fullJob),e.latestTimestampSortValue=e.latestTimestampMs||0,e.spaceIds=this.props.spacesApi&&this.props.isManagementTable&&a&&void 0!==a[e.id]?a[e.id]:[],!0===e.awaitingNodeAssignment&&n++,e))),o=Object(c.e)(r,this.state.filterClauses);this.setState({jobsSummaryList:r,filteredJobsSummaryList:o,fullJobsList:s,loading:!1,jobsAwaitingNodeCount:n},(()=>{this.refreshSelectedJobs()})),Object.keys(this.updateFunctions).forEach((e=>{this.updateFunctions[e](s[e])})),i.forEach((e=>{void 0!==e.blocked&&this.state.itemIdToExpandedRowMap[e.id]&&this.toggleRow(e.id)})),this.isDoneRefreshing(),r.some((e=>void 0!==e.blocked))&&this.checkBlockingJobTasks(e)}catch(e){console.error(e),this.setState({loading:!1})}}}async checkBlockingJobTasks(e=!1){if(!1===this._isMounted)return;const{jobs:t}=await l.ml.jobs.blockingJobTasks(),a=t.map((e=>Object.keys(e)[0])).sort(),n=a.join()!==this.state.blockingJobIds.join();this.setState({blockingJobIds:a}),(n||e)&&this.refreshJobSummaryList(),a.length>0&&null===it&&(it=setTimeout((()=>{it=null,this.checkBlockingJobTasks()}),Re.b))}renderManagementJobsListComponents(){const{isRefreshing:e,loading:t,itemIdToExpandedRowMap:a,jobsSummaryList:n,filteredJobsSummaryList:i,fullJobsList:s,selectedJobs:r}=this.state;return Object(w.jsx)("div",{className:"job-management","data-test-subj":"ml-jobs-list"},Object(w.jsx)(Xe.a,null),Object(w.jsx)(Ze.a,null),Object(w.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)($e,{jobsSummaryList:n})),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(et,{onRefreshClick:this.onRefreshClick,isRefreshing:e}))))),Object(w.jsx)(o.EuiSpacer,{size:"s"}),Object(w.jsx)("div",{className:"managementJobsList"},Object(w.jsx)("div",null,Object(w.jsx)(we,{setFilters:this.setFilters,queryText:this.props.jobsViewState.queryText})),Object(w.jsx)(jobs_list_JobsList,{jobsSummaryList:i,fullJobsList:s,itemIdToExpandedRowMap:a,toggleRow:this.toggleRow,selectJobChange:this.selectJobChange,selectedJobsCount:r.length,loading:t,isManagementTable:!0,isMlEnabledInSpace:this.props.isMlEnabledInSpace,spacesApi:this.props.spacesApi,jobsViewState:this.props.jobsViewState,onJobsViewStateUpdate:this.props.onJobsViewStateUpdate,refreshJobs:()=>this.refreshJobSummaryList(!0)})))}renderJobsListComponents(){const{isRefreshing:e,loading:t,jobsSummaryList:a,jobsAwaitingNodeCount:n}=this.state,i=a.map((e=>e.id)),s=!t&&0===i.length;return Object(w.jsx)("div",{"data-test-subj":"ml-jobs-list"},Object(w.jsx)(Xe.a,null),Object(w.jsx)(Ke.a,{jobCount:n}),Object(w.jsx)(Qe.a,{jobType:"anomaly-detector",onCloseFlyout:this.onRefreshClick,forceRefresh:t||e}),Object(w.jsx)(Ze.a,null),Object(w.jsx)(r.a.Fragment,null,s?Object(w.jsx)(nt.a,null):null,i.length>0?Object(w.jsx)(r.a.Fragment,null,Object(w.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)($e,{jobsSummaryList:a})),Object(w.jsx)(o.EuiFlexItem,{grow:!1},Object(w.jsx)(He,null))),Object(w.jsx)(o.EuiSpacer,{size:"s"}),Object(w.jsx)("div",null,Object(w.jsx)("div",{className:"actions-bar"},Object(w.jsx)(multi_job_actions_MultiJobActions,{selectedJobs:this.state.selectedJobs,allJobIds:i,showCloseJobsConfirmModal:this.showCloseJobsConfirmModal,showStartDatafeedModal:this.showStartDatafeedModal,showDeleteJobModal:this.showDeleteJobModal,showResetJobModal:this.showResetJobModal,showCreateAlertFlyout:this.showCreateAlertFlyout,showStopDatafeedsConfirmModal:this.showStopDatafeedsConfirmModal,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(w.jsx)(we,{setFilters:this.setFilters,queryText:this.props.jobsViewState.queryText})),Object(w.jsx)(jobs_list_JobsList,{jobsSummaryList:this.state.filteredJobsSummaryList,fullJobsList:this.state.fullJobsList,itemIdToExpandedRowMap:this.state.itemIdToExpandedRowMap,toggleRow:this.toggleRow,selectJobChange:this.selectJobChange,showEditJobFlyout:this.showEditJobFlyout,showDeleteJobModal:this.showDeleteJobModal,showResetJobModal:this.showResetJobModal,showCloseJobsConfirmModal:this.showCloseJobsConfirmModal,showStartDatafeedModal:this.showStartDatafeedModal,showStopDatafeedsConfirmModal:this.showStopDatafeedsConfirmModal,refreshJobs:()=>this.refreshJobSummaryList(!0),jobsViewState:this.props.jobsViewState,onJobsViewStateUpdate:this.props.onJobsViewStateUpdate,selectedJobsCount:this.state.selectedJobs.length,showCreateAlertFlyout:this.showCreateAlertFlyout,loading:t}))):null,Object(w.jsx)(Le,{setShowFunction:this.setShowEditJobFlyoutFunction,unsetShowFunction:this.unsetShowEditJobFlyoutFunction,refreshJobs:()=>this.refreshJobSummaryList(!0),allJobIds:i}),Object(w.jsx)(tt,{setShowFunction:this.setShowStopDatafeedsConfirmModalFunction,unsetShowFunction:this.unsetShowStopDatafeedsConfirmModalFunction,refreshJobs:()=>this.refreshJobSummaryList(!0),allJobIds:i}),Object(w.jsx)(at,{setShowFunction:this.setShowCloseJobsConfirmModalFunction,unsetShowFunction:this.unsetShowCloseJobsConfirmModalFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(w.jsx)(Pe,{setShowFunction:this.setShowDeleteJobModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(w.jsx)(Be,{setShowFunction:this.setShowResetJobModalFunction,unsetShowFunction:this.unsetShowResetJobModalFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(w.jsx)(start_datafeed_modal_StartDatafeedModal,{setShowFunction:this.setShowStartDatafeedModalFunction,unsetShowFunction:this.unsetShowDeleteJobModalFunction,getShowCreateAlertFlyoutFunction:this.getShowCreateAlertFlyoutFunction,refreshJobs:()=>this.refreshJobSummaryList(!0)}),Object(w.jsx)(G.b,{setShowFunction:this.setShowCreateAlertFlyoutFunction,unsetShowFunction:this.unsetShowCreateAlertFlyoutFunction,onSave:this.onRefreshClick})))}render(){const{isManagementTable:e}=this.props;return Object(w.jsx)("div",null,e?this.renderManagementJobsListComponents():this.renderJobsListComponents())}}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return S})),a.d(t,"b",(function(){return _}));var n=a(16),i=a.n(n),s=a(2),r=a(44),o=a(215),l=a(12);const c=({limit:e,maps:t,newSelection:a,onDeleteClick:n,onLinkClick:c,showAllBadges:d})=>{const u=[];for(let i=0;i<a.length&&!(i>=e&&!1===d);i++)u.push(Object(l.jsx)(r.EuiFlexItem,{grow:!1,key:a[i]},Object(l.jsx)(o.a,{id:a[i],icon:!0,isGroup:void 0!==t.groupsMap[a[i]],removeId:n})));return!1===d&&a.length>e?u.push(Object(l.jsx)(r.EuiLink,{key:"more-badges-link",onClick:c},Object(l.jsx)(r.EuiText,{grow:!1,size:"xs"},s.i18n.translate("xpack.ml.jobSelector.showFlyoutBadges",{defaultMessage:"And {overFlow} more",values:{overFlow:a.length-e}})))):!0===d&&a.length>e&&u.push(Object(l.jsx)(r.EuiLink,{key:"hide-badges-link",onClick:c},Object(l.jsx)(r.EuiText,{grow:!1,size:"xs"},s.i18n.translate("xpack.ml.jobSelector.hideFlyoutBadges",{defaultMessage:"Hide"})))),Object(l.jsx)(i.a.Fragment,null,u)};var d=a(404);function u({isRunning:e,timerange:t,ganttBarWidth:a}){const i={width:t.widthPx,marginLeft:t.fromPx},s="mlJobSelector__ganttBar"+(e?" mlJobSelector__ganttBarRunning":"");return Object(l.jsx)(r.EuiToolTip,{position:"top",content:t.label},Object(l.jsx)(n.Fragment,null,Object(l.jsx)("div",{className:"mlJobSelector__ganttBarBackEdge"},Object(l.jsx)("div",{className:"mlJobSelector__ganttBarDashed",style:{width:`${a}px`}})),Object(l.jsx)("div",{style:i,className:s})))}var p=a(45),m=a(61),b=a(72),f=a(0),h=a(4);const g=["job_id","groups"],j=["id"];function x({ganttBarWidth:e,groupsList:t,jobs:a,onSelection:i,selectedIds:c,singleSelection:x,timeseriesOnly:v,withTimeRangeSelector:y}){const[O,E]=Object(n.useState)(),[w,M]=Object(n.useState)("Jobs"),{services:{application:{navigateToApp:S}}}=Object(b.b)();Object(n.useEffect)((()=>{let e=[],t="job_id";"Jobs"===w||x?e=[{name:"job_id",getValue:e=>e.job_id.toLowerCase(),isAscending:!0},{name:"groups",getValue:e=>e.groups&&e.groups[0]?e.groups[0].toLowerCase():"",isAscending:!0}]:"Groups"===w&&(t="id",e=[{name:"id",getValue:e=>e.id.toLowerCase(),isAscending:!0}]);const a=new m.SortableProperties(e,t);E(a)}),[a,w]);const _=[{id:"Jobs",name:s.i18n.translate("xpack.ml.jobSelector.jobsTab",{defaultMessage:"Jobs"}),content:T()},{id:"Groups",name:s.i18n.translate("xpack.ml.jobSelector.groupsTab",{defaultMessage:"Groups"}),content:function(){const a=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:"group ID",id:"id",isSortable:!0,alignment:m.LEFT_ALIGNMENT,render:({id:e})=>Object(l.jsx)(o.a,{id:e,isGroup:!0})},{id:"jobs in group",label:"jobs in group",isSortable:!1,alignment:m.CENTER_ALIGNMENT,render:({jobIds:e=[]})=>e.length}];y&&a.push({label:"time range",id:"timerange",alignment:m.LEFT_ALIGNMENT,render:({timeRange:t={}})=>Object(l.jsx)(u,{timerange:t,ganttBarWidth:e})});return Object(l.jsx)(d.a,{columns:a,filterDefaultFields:x?void 0:j,items:t,onTableChange:e=>i({selectionFromTable:e}),selectedIds:c,sortableProperties:O})}()}];function T(){const p=[{id:"checkbox",isCheckbox:!0,textOnly:!1,width:"32px"},{label:"job ID",id:"job_id",isSortable:!0,alignment:m.LEFT_ALIGNMENT},{id:"groups",label:"groups",isSortable:!0,alignment:m.LEFT_ALIGNMENT,render:({groups:e=[]})=>e.map((e=>Object(l.jsx)(o.a,{key:`${e}-key`,id:e,isGroup:!0})))}];y&&p.push({label:"time range",id:"timerange",alignment:m.LEFT_ALIGNMENT,render:({timeRange:t={},isRunning:a})=>Object(l.jsx)(u,{timerange:t,isRunning:a,ganttBarWidth:e})});const b=[{type:"field_value_selection",field:"groups",name:s.i18n.translate("xpack.ml.jobSelector.filterBar.groupLabel",{defaultMessage:"Group"}),loadingMessage:"Loading...",noOptionsMessage:"No groups found.",multiSelect:"or",cache:1e4,options:t.map((e=>({value:e.id,view:Object(l.jsx)(n.Fragment,null,Object(l.jsx)(r.EuiFlexGroup,{gutterSize:"s"},Object(l.jsx)(r.EuiFlexItem,{key:e.id,grow:!1},Object(l.jsx)(o.a,{id:e.id,isGroup:!0})),Object(l.jsx)(r.EuiFlexItem,{grow:!1},s.i18n.translate("xpack.ml.jobSelector.filterBar.jobGroupTitle",{defaultMessage:"({jobsCount, plural, one {# job} other {# jobs}})",values:{jobsCount:e.jobIds.length}}))))})))}];return Object(l.jsx)(d.a,{columns:p,filters:b,filterDefaultFields:x?void 0:g,items:a,onTableChange:e=>i({selectionFromTable:e}),radioDisabledCheck:e=>v&&!1===e.isSingleMetricViewerJob,selectedIds:c,singleSelection:x,sortableProperties:O,timeseriesOnly:v})}return Object(l.jsx)(n.Fragment,null,0===a.length&&Object(l.jsx)(r.EuiCallOut,{title:Object(l.jsx)(p.FormattedMessage,{id:"xpack.ml.jobSelector.noJobsFoundTitle",defaultMessage:"No anomaly detection jobs found"}),iconType:"iInCircle"},Object(l.jsx)(r.EuiText,{textAlign:"center"},Object(l.jsx)(r.EuiButton,{color:"primary",onClick:async()=>{await S(h.e,{path:f.b.ANOMALY_DETECTION_CREATE_JOB})}},Object(l.jsx)(p.FormattedMessage,{id:"xpack.ml.jobSelector.createJobButtonLabel",defaultMessage:"Create job"})))),0!==a.length&&!0===x&&T(),0!==a.length&&!x&&Object(l.jsx)(r.EuiTabbedContent,{size:"s",tabs:_,initialSelectedTab:_[0],onTabClick:e=>{M(e.id)}}))}var v=a(24),y=a.n(v),O=a(114),E=a.n(O);function w(e){const t={},a={};return e.forEach((e=>{void 0!==e.groups&&e.groups.forEach((n=>{void 0===t[n]?(t[n]={id:n,jobIds:[e.job_id],timeRange:{to:e.timeRange.to,toMoment:null,from:e.timeRange.from,fromMoment:null,fromPx:e.timeRange.fromPx,toPx:e.timeRange.toPx,widthPx:null}},a[n]=[e.job_id]):(t[n].jobIds.push(e.job_id),a[n].push(e.job_id),(null===t[n].timeRange.to||e.timeRange.to>t[n].timeRange.to)&&(t[n].timeRange.to=e.timeRange.to,t[n].timeRange.toMoment=e.timeRange.toMoment),(null===t[n].timeRange.from||e.timeRange.from<t[n].timeRange.from)&&(t[n].timeRange.from=e.timeRange.from,t[n].timeRange.fromMoment=e.timeRange.fromMoment),(null===t[n].timeRange.toPx||e.timeRange.toPx>t[n].timeRange.toPx)&&(t[n].timeRange.toPx=e.timeRange.toPx),(null===t[n].timeRange.fromPx||e.timeRange.fromPx<t[n].timeRange.fromPx)&&(t[n].timeRange.fromPx=e.timeRange.fromPx))}))})),Object.keys(t).forEach((e=>{const a=t[e];a.timeRange.widthPx=a.timeRange.toPx-a.timeRange.fromPx,a.timeRange.toMoment=y()(a.timeRange.to),a.timeRange.fromMoment=y()(a.timeRange.from);const n=a.timeRange.fromMoment.format("MMM Do YYYY, HH:mm"),i=a.timeRange.toMoment.format("MMM Do YYYY, HH:mm");a.timeRange.label=s.i18n.translate("xpack.ml.jobSelectList.groupTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:n,toString:i}})})),{groups:Object.keys(t).map((e=>t[e])),groupsMap:a}}function M(e,t,a){const n=e.filter((e=>void 0!==e.timeRange.to&&void 0!==e.timeRange.from)),i=Math.min(...n.map((e=>+e.timeRange.from))),r=Math.max(...n.map((e=>+e.timeRange.to))),o=E.a.scale.linear().domain([i,r]).range([1,a]);return e.forEach((e=>{if(void 0!==e.timeRange.to&&void 0!==e.timeRange.from){e.timeRange.fromPx=o(e.timeRange.from),e.timeRange.toPx=o(e.timeRange.to),e.timeRange.widthPx=e.timeRange.toPx-e.timeRange.fromPx,e.timeRange.widthPx<1&&(e.timeRange.widthPx=1),e.timeRange.toMoment=y()(e.timeRange.to).tz(t),e.timeRange.fromMoment=y()(e.timeRange.from).tz(t);const a=e.timeRange.fromMoment.format("MMM Do YYYY, HH:mm"),n=e.timeRange.toMoment.format("MMM Do YYYY, HH:mm");e.timeRange.label=s.i18n.translate("xpack.ml.jobSelector.jobTimeRangeLabel",{defaultMessage:"{fromString} to {toString}",values:{fromString:a,toString:n}})}else e.timeRange.widthPx=0,e.timeRange.fromPx=0,e.timeRange.toPx=0,e.timeRange.label=s.i18n.translate("xpack.ml.jobSelector.noResultsForJobLabel",{defaultMessage:"No results"})})),e}const S=10,_=({dateFormatTz:e,selectedIds:t=[],singleSelection:a,timeseriesOnly:o,onJobsFetched:d,onSelectionConfirmed:u,onFlyoutClose:p,maps:m,applyTimeRangeConfig:f,onTimeRangeConfigChange:h,withTimeRangeSelector:g=!0})=>{const{services:{notifications:j,mlServices:{mlApiServices:v}}}=Object(b.b)(),[O,_]=Object(n.useState)(t),[T,C]=Object(n.useState)(!0),[k,F]=Object(n.useState)(!1),[I,D]=Object(n.useState)([]),[A,L]=Object(n.useState)([]),[R,N]=Object(n.useState)(299),[P,z]=Object(n.useState)(m),B=Object(n.useRef)(null),J=Object(n.useCallback)((()=>{const e=[],t=[];O.forEach((a=>{void 0!==P.groupsMap[a]?(e.push(...P.groupsMap[a]),t.push({groupId:a,jobIds:P.groupsMap[a]})):e.push(a)}));const a=Array.from(new Set(e)),n=f?function(e,t){if(e.length>0){const a=[];if(e.forEach((e=>{t.includes(e.job_id)&&(void 0!==e.timeRange.from&&a.push(e.timeRange.from),void 0!==e.timeRange.to&&a.push(e.timeRange.to))})),a.length){const e=E.a.extent(a);return{from:y()(e[0]).toISOString(),to:y()(e[1]).toISOString()}}}}(I,a):void 0;u({newSelection:a,jobIds:a,groups:t,time:n})}),[u,O,P,f]);function V(e){_(O.filter((t=>t!==e)))}function U(){h&&h(!f)}function G(){_([])}function q({selectionFromTable:e}){_(e)}const W=Object(n.useCallback)((()=>{if(0===I.length||!B.current)return;const t=B.current.querySelectorAll("table thead th"),a=t[t.length-1].offsetWidth-16,n=M(I,e,a);D(n);const{groups:i}=w(n);L(i),N(a)}),[e,I]);return Object(n.useEffect)((()=>{!async function(){try{const t=await v.jobs.jobsWithTimerange(e),a=M(t.jobs,e,299),{groups:n,groupsMap:i}=w(a);D(a),L(n),z({groupsMap:i,jobsMap:t.jobsMap}),d&&d({groupsMap:i,jobsMap:t.jobsMap})}catch(e){console.error("Error fetching jobs with time range",e);const{toasts:t}=j;t.addDanger({title:s.i18n.translate("xpack.ml.jobSelector.jobFetchErrorMessage",{defaultMessage:"An error occurred fetching jobs. Refresh and try again."})})}C(!1)}()}),[]),Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiFlyoutHeader,{hasBorder:!0},Object(l.jsx)(r.EuiTitle,{size:"m"},Object(l.jsx)("h2",{id:"flyoutTitle"},s.i18n.translate("xpack.ml.jobSelector.flyoutTitle",{defaultMessage:"Job selection"})))),Object(l.jsx)(r.EuiFlyoutBody,{className:"mlJobSelectorFlyoutBody","data-test-subj":"mlJobSelectorFlyoutBody"},Object(l.jsx)(r.EuiResizeObserver,{onResize:W},(e=>Object(l.jsx)("div",{ref:t=>{B.current=t,e(t)}},T?Object(l.jsx)(r.EuiProgress,{size:"xs",color:"accent"}):Object(l.jsx)(i.a.Fragment,null,Object(l.jsx)(r.EuiFlexGroup,{direction:"column",responsive:!1},Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiFlexGroup,{wrap:!0,responsive:!1,gutterSize:"xs",alignItems:"center"},Object(l.jsx)(c,{limit:S,maps:P,newSelection:O,onDeleteClick:V,onLinkClick:()=>F(!k),showAllBadges:k}))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiFlexGroup,{direction:"row",justifyContent:"spaceBetween",responsive:!1},Object(l.jsx)(r.EuiFlexItem,{grow:!1},!a&&O.length>0&&Object(l.jsx)(r.EuiButtonEmpty,{onClick:G,size:"xs","data-test-subj":"mlFlyoutJobSelectorButtonClearSelection"},s.i18n.translate("xpack.ml.jobSelector.clearAllFlyoutButton",{defaultMessage:"Clear all"}))),g&&void 0!==f&&Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiSwitch,{label:s.i18n.translate("xpack.ml.jobSelector.applyTimerangeSwitchLabel",{defaultMessage:"Apply time range"}),checked:f,onChange:U,"data-test-subj":"mlFlyoutJobSelectorSwitchApplyTimeRange"}))))),Object(l.jsx)(x,{jobs:I,ganttBarWidth:R,groupsList:A,onSelection:q,selectedIds:O,singleSelection:a,timeseriesOnly:o,withTimeRangeSelector:g})))))),Object(l.jsx)(r.EuiFlyoutFooter,null,Object(l.jsx)(r.EuiFlexGroup,null,Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiButton,{onClick:J,fill:!0,isDisabled:0===O.length,"data-test-subj":"mlFlyoutJobSelectorButtonApply"},s.i18n.translate("xpack.ml.jobSelector.applyFlyoutButton",{defaultMessage:"Apply"}))),Object(l.jsx)(r.EuiFlexItem,{grow:!1},Object(l.jsx)(r.EuiButtonEmpty,{iconType:"cross",onClick:p,"data-test-subj":"mlFlyoutJobSelectorButtonClose"},s.i18n.translate("xpack.ml.jobSelector.closeFlyoutButton",{defaultMessage:"Close"}))))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return M}));var n=a(16),i=a(2),s=a(44),r=a(90),o=a(81),l=a(76),c=a(103),d=a(179),u=a(271),p=a(391),m=a(164),b=a(12);const f=({isDisabled:e,setIsSourceIndexModalVisible:t})=>{const a=Object(b.jsx)(s.EuiButton,{disabled:e,fill:!0,onClick:()=>{t(!0)},iconType:"plusInCircle",size:"s","data-test-subj":"mlAnalyticsButtonCreate"},i.i18n.translate("xpack.ml.dataframe.analyticsList.createDataFrameAnalyticsButton",{defaultMessage:"Create job"}));return e?Object(b.jsx)(s.EuiToolTip,{position:"top",content:Object(l.f)("canCreateDataFrameAnalytics")},a):a};var h=a(398),g=a(98);var j=a(399),x=a(233),v=a(45);const y=()=>{const[e,t]=Object(n.useState)(!1),{refresh:a}=Object(o.w)({isLoading:t});return Object(b.jsx)(s.EuiButtonEmpty,{"data-test-subj":"mlAnalyticsRefreshListButton"+(e?" loading":" loaded"),onClick:a,isLoading:e},Object(b.jsx)(v.FormattedMessage,{id:"xpack.ml.dataframe.analyticsList.refreshButtonLabel",defaultMessage:"Refresh"}))};var O=a(165),E=a(149);const w=[{type:"field_value_selection",field:"job_type",name:i.i18n.translate("xpack.ml.dataframe.analyticsList.typeFilter",{defaultMessage:"Type"}),multiSelect:"or",options:Object.values(r.a).map((e=>({value:e,name:e,view:Object(u.a)(e)})))},{type:"field_value_selection",field:"state",name:i.i18n.translate("xpack.ml.dataframe.analyticsList.statusFilter",{defaultMessage:"Status"}),multiSelect:"or",options:Object.values(c.b).map((e=>({value:e,name:e,view:Object(u.b)(e)})))}];const M=({isManagementTable:e=!1,isMlEnabledInSpace:t=!0,spacesApi:a,blockRefresh:r=!1,pageState:v,updatePageState:M})=>{var S;const _=null!==(S=v.queryText)&&void 0!==S?S:"",T=Object(n.useCallback)((e=>{M({queryText:e})}),[M]),[C,k]=Object(n.useState)(!1),[F,I]=Object(n.useState)(!1),[D,A]=Object(n.useState)(!1),[L,R]=Object(n.useState)([]),[N,P]=Object(n.useState)(),[z,B]=Object(n.useState)([]),[J,V]=Object(n.useState)(void 0),[U,G]=Object(n.useState)([]),[q,W]=Object(n.useState)(void 0),[H,Y]=Object(n.useState)(0),$=Object(E.a)(),X=!Object(l.e)("canCreateDataFrameAnalytics")||!Object(l.e)("canStartStopDataFrameAnalytics"),K=Object(d.d)(B,V,W,k,Y,r,e),Q=Object(n.useCallback)((e=>{if(e.length){const t=function(e,t){if(0===t.length)return e;const a=e.reduce(((e,t)=>(e[t.id]={job:t,count:0},e)),{});return t.forEach((t=>{const n="must"===t.match;let i=[];i="term"===t.type?!0===n?e.filter((e=>{var a,i;return Object(g.f)(e.id,t.value)===n||Object(g.f)(e.config.description,t.value)===n||Object(g.f)(null===(a=e.stats)||void 0===a||null===(i=a.memory_usage)||void 0===i?void 0:i.status,t.value)===n})):e.filter((e=>{var a,i;return Object(g.f)(e.id,t.value)===n&&Object(g.f)(e.config.description,t.value)===n&&Object(g.f)(null===(a=e.stats)||void 0===a||null===(i=a.memory_usage)||void 0===i?void 0:i.status,t.value)===n})):Array.isArray(t.value)?e.filter((e=>t.value.includes(e[t.field]))):e.filter((e=>e[t.field]===t.value)),i.forEach((e=>a[e.id].count++))})),Object.values(a).filter((e=>(e&&e.count)>=t.length)).map((e=>e.job))}(z,e);R(t)}else R(z)}),[z]);Object(n.useEffect)((()=>{(()=>{if(""!==_){const e=s.EuiSearchBar.Query.parse(_);let t=[];e&&void 0!==e.ast&&void 0!==e.ast.clauses&&(t=e.ast.clauses),Q(t)}else Q([])})()}),[_]);const Z=Object(n.useCallback)((()=>K(!0)),[]),{refresh:ee}=Object(o.w)({isLoading:A,onRefresh:Z},e);Object(n.useEffect)((function(){Z()}),[$]);const{columns:te,modals:ae}=Object(u.d)(U,G,e,t,a,ee),{onTableChange:ne,pagination:ie,sorting:se}=Object(x.a)(L,v,M);if(!C)return null;if(void 0!==q)return Object(b.jsx)(s.EuiCallOut,{title:i.i18n.translate("xpack.ml.dataFrame.analyticsList.errorPromptTitle",{defaultMessage:"An error occurred getting the data frame analytics list."}),color:"danger",iconType:"alert"},Object(b.jsx)("pre",null,JSON.stringify(q)));if(0===z.length&&!e)return Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsJobList"},Object(b.jsx)(s.EuiSpacer,{size:"m"}),Object(b.jsx)(j.a,{disabled:X,onCreateFirstJobClick:I.bind(null,!0)}),F?Object(b.jsx)(h.a,{onClose:I.bind(null,!1)}):null);const re=(oe=z,U.reduce(((e,t)=>{const a=oe.find((e=>e.config.id===t));return void 0!==a&&(e[t]=Object(b.jsx)(p.a,{item:a})),e}),{}));var oe;const le=J&&Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(m.a,{stats:J,dataTestSub:"mlAnalyticsStatsBar"})),ce=Object(b.jsx)(s.EuiFlexItem,null,Object(b.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween"},le,Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(y,null)))),de={query:_,onChange:e=>{null===e.error?(P(void 0),T(e.queryText)):P(e.error.message)},box:{incremental:!0},filters:w};return Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsJobList"},ae,!e&&Object(b.jsx)(s.EuiSpacer,{size:"m"}),Object(b.jsx)(O.a,{jobCount:H}),Object(b.jsx)(s.EuiFlexGroup,{justifyContent:"spaceBetween"},!e&&le,e&&ce,Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(s.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},!e&&Object(b.jsx)(s.EuiFlexItem,{grow:!1},Object(b.jsx)(f,{isDisabled:X,setIsSourceIndexModalVisible:I}))))),Object(b.jsx)(s.EuiSpacer,{size:"m"}),Object(b.jsx)("div",{"data-test-subj":"mlAnalyticsTableContainer"},Object(b.jsx)(s.EuiInMemoryTable,{allowNeutralSort:!1,columns:te,hasActions:!1,isExpandable:!0,itemIdToExpandedRowMap:re,isSelectable:!1,items:z,itemId:c.c.id,loading:D,onTableChange:ne,pagination:ie,sorting:se,search:de,"data-test-subj":D?"mlAnalyticsTable loading":"mlAnalyticsTable loaded",rowProps:e=>({"data-test-subj":`mlAnalyticsTableRow row-${e.id}`}),error:N})),!0===F&&Object(b.jsx)(h.a,{onClose:()=>I(!1)}))}},function(e,t,a){"use strict";a.d(t,"b",(function(){return O})),a.d(t,"a",(function(){return E}));var n=a(16),i=a.n(n),s=a(8),r=a(44),o=a(45),l=a(82),c=a(129),d=a(17),u=a(72),p=a(2),m=a(161),b=a(53),f=a(12);const h=({content:e})=>Object(f.jsx)(r.EuiToolTip,{position:"top",content:e},Object(f.jsx)(r.EuiIcon,{tabIndex:0,type:"questionInCircle",color:"subdued",className:"eui-alignTop",size:"s"})),g=({stats:e})=>{Object(m.a)(b.FIELD_FORMAT_IDS.DURATION);const t=e.map(((e,t)=>{const a=Object.keys(e)[0];return{...e[a],id:`${a}_${t}`}})),a=[{field:"type",name:p.i18n.translate("xpack.ml.trainedModels.modelsList.pipelines.processorStats.typeHeader",{defaultMessage:"Processor type"}),width:"100px",sortable:!0,truncateText:!1,render:e=>Object(f.jsx)(r.EuiBadge,{color:"hollow"},e),"data-test-subj":"mlProcessorStatsType"},{field:"stats.count",name:Object(f.jsx)(r.EuiFlexGroup,{gutterSize:"xs"},Object(f.jsx)(r.EuiFlexItem,{grow:!1},Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.pipelines.processorStats.countHeader",defaultMessage:"Count"})),Object(f.jsx)(r.EuiFlexItem,{grow:!1},Object(f.jsx)(h,{content:Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.pipelines.processorStats.countDescription",defaultMessage:"Total number of documents ingested during the lifetime of this node"})}))),width:"100px",truncateText:!0,"data-test-subj":"mlProcessorStatsCount"},{field:"stats.current",name:Object(f.jsx)(r.EuiFlexGroup,{gutterSize:"xs"},Object(f.jsx)(r.EuiFlexItem,{grow:!1},Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.pipelines.processorStats.currentHeader",defaultMessage:"Current"})),Object(f.jsx)(r.EuiFlexItem,{grow:!1},Object(f.jsx)(h,{content:Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.pipelines.processorStats.currentDescription",defaultMessage:"Total number of documents currently being ingested"})}))),width:"100px",truncateText:!1,"data-test-subj":"mlProcessorStatsCurrent"},{field:"stats.failed",name:Object(f.jsx)(r.EuiFlexGroup,{gutterSize:"xs"},Object(f.jsx)(r.EuiFlexItem,{grow:!1},Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.pipelines.processorStats.failedHeader",defaultMessage:"Failed"})),Object(f.jsx)(r.EuiFlexItem,{grow:!1},Object(f.jsx)(h,{content:Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.pipelines.processorStats.failedDescription",defaultMessage:"Total number of failed ingest operations during the lifetime of this node"})}))),width:"100px","data-test-subj":"mlProcessorStatsFailed"}];return Object(f.jsx)(r.EuiInMemoryTable,{allowNeutralSort:!1,columns:a,hasActions:!1,isExpandable:!1,isSelectable:!1,items:t,itemId:"id",rowProps:e=>({"data-test-subj":`mlProcessorStatsTableRow row-${e.id}`}),onTableChange:()=>{},"data-test-subj":"mlProcessorStatsTable"})},j=({pipelines:e,ingestStats:t})=>{var a;const{services:{share:n}}=Object(u.b)(),s=Object.keys(null!==(a=null!=e?e:null==t?void 0:t.pipelines)&&void 0!==a?a:{});return s.length?Object(f.jsx)(i.a.Fragment,null,s.map(((a,s)=>{const l=s<=2,c=null==e?void 0:e[a];return Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(r.EuiAccordion,{key:a,id:a,buttonContent:Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,a)),extraAction:c?Object(f.jsx)(r.EuiButtonEmpty,{"data-test-subj":`mlTrainedModelPipelineEditButton_${a}`,onClick:()=>{const e=n.url.locators.get("INGEST_PIPELINES_APP_LOCATOR");e&&e.navigate({page:"pipeline_edit",pipelineId:a,absolute:!0})},iconType:"documentEdit",iconSide:"left"},Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.editPipelineLabel",defaultMessage:"Edit"})):void 0,paddingSize:"l",initialIsOpen:l},Object(f.jsx)(r.EuiFlexGrid,{columns:2},null!=t&&t.pipelines?Object(f.jsx)(r.EuiFlexItem,{"data-test-subj":`mlTrainedModelPipelineIngestStats_${a}`},Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xxs"},Object(f.jsx)("h6",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.ingestStatsTitle",defaultMessage:"Ingest stats"}))),Object(f.jsx)(g,{stats:t.pipelines[a].processors}))):null,c?Object(f.jsx)(r.EuiFlexItem,{"data-test-subj":`mlTrainedModelPipelineDefinition_${a}`},Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xxs"},Object(f.jsx)("h6",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.processorsTitle",defaultMessage:"Definition"}))),Object(f.jsx)(r.EuiCodeBlock,{language:"json",fontSize:"m",paddingSize:"m",overflowHeight:300,isCopyable:!0},JSON.stringify(c,null,2)))):null)))}))):null};var x=a(374);const v=e=>{if(0!==e.length)return Object(f.jsx)("div",null,e.map((e=>Object(f.jsx)(r.EuiBadge,{key:e,color:"hollow"},e))))},y={tags:v,roles:v,create_time:l.d,timestamp:l.d};function O(e){return Object.entries(e).filter((([,e])=>Object(c.a)(e))).map((([e,t])=>e in y?{title:e,description:y[e](t)}:{title:e,description:"object"==typeof t?Object(f.jsx)(r.EuiCodeBlock,{language:"json",fontSize:"s",paddingSize:"s",overflowHeight:300,isCopyable:!1},JSON.stringify(t,null,2)):t.toString()}))}const E=({item:e})=>{const[t,a]=Object(n.useState)([]),{inference_config:l,stats:c,metadata:u,tags:p,version:m,estimated_operations:b,estimated_heap_memory_usage_bytes:h,default_field_map:g,license_level:v,pipelines:y,description:E}=e,{analytics_config:w,...M}=null!=u?u:{},S={description:E,tags:p,version:m,estimated_operations:b,estimated_heap_memory_usage_bytes:h,default_field_map:g,license_level:v};Object(n.useEffect)((function(){!async function(){const e=c.deployment_stats,t=c.model_size_stats;if(!e||!t)return;const n=e.nodes.map((a=>{const n=Object.values(a.node)[0].name;return{...e,...t,node:{...Object(s.pick)(a,["average_inference_time_ms","inference_count","routing_state","last_access","number_of_pending_requests","start_time"]),name:n}}}));a(n)}()}),[c.deployment_stats]);const _=[{id:"details","data-test-subj":"mlTrainedModelDetails",name:Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.detailsTabLabel",defaultMessage:"Details"}),content:Object(f.jsx)("div",{"data-test-subj":"mlTrainedModelDetailsContent"},Object(f.jsx)(r.EuiSpacer,{size:"s"}),Object(f.jsx)(r.EuiFlexGrid,{columns:2,gutterSize:"m"},Object(f.jsx)(r.EuiFlexItem,null,Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.detailsTitle",defaultMessage:"Details"}))),Object(f.jsx)(r.EuiSpacer,{size:"m"}),Object(f.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:O(S)}))),Object(d.isPopulatedObject)(M)?Object(f.jsx)(r.EuiFlexItem,null,Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.metadataTitle",defaultMessage:"Metadata"}))),Object(f.jsx)(r.EuiSpacer,{size:"m"}),Object(f.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:O(M)}))):null))},...l?[{id:"config","data-test-subj":"mlTrainedModelInferenceConfig",name:Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.configTabLabel",defaultMessage:"Config"}),content:Object(f.jsx)("div",{"data-test-subj":"mlTrainedModelInferenceConfigContent"},Object(f.jsx)(r.EuiSpacer,{size:"s"}),Object(f.jsx)(r.EuiFlexGrid,{columns:2,gutterSize:"m"},Object(f.jsx)(r.EuiFlexItem,null,Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.inferenceConfigTitle",defaultMessage:"Inference configuration"}))),Object(f.jsx)(r.EuiSpacer,{size:"m"}),Object(f.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:O(l[Object.keys(l)[0]])}))),w&&Object(f.jsx)(r.EuiFlexItem,null,Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.analyticsConfigTitle",defaultMessage:"Analytics configuration"}))),Object(f.jsx)(r.EuiSpacer,{size:"m"}),Object(f.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:O(w)})))))}]:[],...Object(d.isPopulatedObject)(Object(s.omit)(c,["pipeline_count","ingest"]))?[{id:"stats","data-test-subj":"mlTrainedModelStats",name:Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.statsTabLabel",defaultMessage:"Stats"}),content:Object(f.jsx)("div",{"data-test-subj":"mlTrainedModelStatsContent"},Object(f.jsx)(r.EuiSpacer,{size:"s"}),Object(f.jsx)(r.EuiFlexGrid,{columns:2,gutterSize:"m"},null!=t&&t.length?Object(f.jsx)(r.EuiFlexItem,{grow:2},Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.deploymentStatsTitle",defaultMessage:"Deployment stats"}))),Object(f.jsx)(r.EuiSpacer,{size:"m"}),Object(f.jsx)(x.a,{models:t,hideColumns:["model_id"]}))):null,c.inference_stats?Object(f.jsx)(r.EuiFlexItem,null,Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.inferenceStatsTitle",defaultMessage:"Inference stats"}))),Object(f.jsx)(r.EuiSpacer,{size:"m"}),Object(f.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:O(c.inference_stats)}))):null,Object(d.isPopulatedObject)(c.model_size_stats)&&!Object(d.isPopulatedObject)(c.inference_stats)?Object(f.jsx)(r.EuiFlexItem,null,Object(f.jsx)(r.EuiPanel,null,Object(f.jsx)(r.EuiTitle,{size:"xs"},Object(f.jsx)("h5",null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.modelSizeStatsTitle",defaultMessage:"Model size stats"}))),Object(f.jsx)(r.EuiSpacer,{size:"m"}),Object(f.jsx)(r.EuiDescriptionList,{compressed:!0,type:"column",listItems:O(c.model_size_stats)}))):null))}]:[],...y&&Object.keys(y).length>0||c.ingest?[{id:"pipelines","data-test-subj":"mlTrainedModelPipelines",name:Object(f.jsx)(i.a.Fragment,null,Object(f.jsx)(o.FormattedMessage,{id:"xpack.ml.trainedModels.modelsList.expandedRow.pipelinesTabLabel",defaultMessage:"Pipelines"})," ",Object(f.jsx)(r.EuiNotificationBadge,null,c.pipeline_count)),content:Object(f.jsx)("div",{"data-test-subj":"mlTrainedModelPipelinesContent"},Object(f.jsx)(r.EuiSpacer,{size:"s"}),Object(f.jsx)(j,{pipelines:y,ingestStats:c.ingest}))}]:[]];return Object(f.jsx)(r.EuiTabbedContent,{size:"s",style:{width:"100%"},tabs:_,initialSelectedTab:_[0],autoFocus:"selected",onTabClick:e=>{},"data-test-subj":"mlTrainedModelRowDetails"})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return S}));var n=a(16),i=a.n(n),s=a(54),r=a.n(s),o=a(44),l=a(2),c=a(82),d=(a(464),a(12));const u=({section:e})=>{if(0===e.items.length)return null;const t=[{field:"title",name:"",render:e=>Object(d.jsx)("strong",null,e)},{field:"description",name:"",render:e=>Object(d.jsx)(i.a.Fragment,null,e)}];return Object(d.jsx)("div",{"data-test-subj":e.dataTestSubj},Object(d.jsx)(o.EuiTitle,{size:"xs"},Object(d.jsx)("span",null,e.title)),Object(d.jsx)(o.EuiBasicTable,{compressed:!0,items:e.items,columns:t,tableCaption:e.title,tableLayout:"auto",className:"mlExpandedRowDetailsSection","data-test-subj":`${e.dataTestSubj}-table`}))},p=({sections:e,dataTestSubj:t})=>Object(d.jsx)(o.EuiFlexGroup,{className:"mlExpandedRowDetails","data-test-subj":t},Object(d.jsx)(o.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"left"===e.position)).map((e=>Object(d.jsx)(n.Fragment,{key:e.title},Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(u,{section:e}))))),Object(d.jsx)(o.EuiFlexItem,{style:{width:"50%"}},e.filter((e=>"right"===e.position)).map((e=>Object(d.jsx)(n.Fragment,{key:e.title},Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(u,{section:e})))))),m=({json:e,dataTestSubj:t})=>Object(d.jsx)(o.EuiFlexGroup,{"data-test-subj":t},Object(d.jsx)(o.EuiFlexItem,null,Object(d.jsx)(o.EuiSpacer,{size:"s"}),Object(d.jsx)(o.EuiCodeBlock,{"aria-label":l.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.expandedRowJsonPane",{defaultMessage:"JSON of data frame analytics configuration"}),style:{width:"100%"},language:"json",fontSize:"s",paddingSize:"s",overflowHeight:300,isCopyable:!0,"data-test-subj":"mlAnalyticsDetailsJsonPreview"},JSON.stringify(e,null,2))),Object(d.jsx)(o.EuiFlexItem,{grow:!1}," ")),b=({progress:e})=>Object(d.jsx)(o.EuiFlexGroup,{alignItems:"center",gutterSize:"xs"},Object(d.jsx)(o.EuiFlexItem,{style:{width:"100px"},grow:!1},Object(d.jsx)(o.EuiProgress,{value:e,max:100,color:"primary",size:"m"},e,"%")),Object(d.jsx)(o.EuiFlexItem,{style:{width:"35px"},grow:!1},Object(d.jsx)(o.EuiText,{size:"xs"},`${e}%`)));var f=a(81),h=a(271),g=a(103),j=a(74),x=(a(469),a(73)),v=a(402),y=a(77);const O=({analyticsId:e,dataTestSubj:t})=>{const[a,i]=Object(n.useState)([]),[s,r]=Object(n.useState)(!1),[o,c]=Object(n.useState)(""),u=Object(y.c)(),p=Object(n.useCallback)((async()=>{try{r(!0);const t=await x.ml.dataFrameAnalytics.getAnalyticsAuditMessages(e);r(!1),i(t)}catch(e){r(!1),u.displayErrorToast(e,l.i18n.translate("xpack.ml.dfAnalyticsList.analyticsDetails.messagesPane.errorToastMessageTitle",{defaultMessage:"Error loading job messages"})),c(l.i18n.translate("xpack.ml.dfAnalyticsList.analyticsDetails.messagesPane.errorMessage",{defaultMessage:"Messages could not be loaded"}))}}),[]);return Object(n.useEffect)((()=>{p()}),[]),Object(f.w)({onRefresh:p}),Object(d.jsx)("div",{className:"mlExpandedRowJobMessages","data-test-subj":t},Object(d.jsx)(v.a,{messages:a,loading:s,error:o,refreshMessage:p}))};function E(e){return"object"==typeof e?JSON.stringify(e):e.toString()}const w=({isLoading:e,evalData:t,resultProperty:a})=>Object(d.jsx)(n.Fragment,null,!1===e&&null!==t.error&&Object(d.jsx)(o.EuiIcon,{type:"alert",size:"s"}),!0===e&&Object(d.jsx)(o.EuiLoadingSpinner,{size:"s"}),!1===e&&null===t.error&&t[a]),M={mse:"",msle:"",huber:"",rSquared:"",error:null},S=({item:e})=>{var t,a,i;const[s,u]=Object(n.useState)(M),[x,v]=Object(n.useState)(M),[y,S]=Object(n.useState)(!1),[_,T]=Object(n.useState)(!1),C=null==e||null===(t=e.config)||void 0===t||null===(a=t.dest)||void 0===a?void 0:a.index,k=Object(f.k)(e.config.analysis),F=Object(f.o)(e.config.analysis),I=e.config.dest.results_field,D=Object(g.e)(e.stats),A=Object(j.y)(e.config.analysis),L=Object(j.m)(e.config.analysis);Object(n.useEffect)((()=>{D&&A&&(async()=>{T(!0),S(!0);const e=await Object(f.t)({isTraining:!1,index:C,dependentVariable:k,resultsField:I,predictionFieldName:F,jobType:j.b.REGRESSION});if(!0===e.success&&e.eval&&Object(j.z)(e.eval)){const{mse:t,msle:a,huber:n,r_squared:i}=Object(f.q)(e.eval);v({mse:t,msle:a,huber:n,rSquared:i,error:null}),T(!1)}else T(!1),v({mse:"",msle:"",huber:"",rSquared:"",error:e.error});const t=await Object(f.t)({isTraining:!0,index:C,dependentVariable:k,resultsField:I,predictionFieldName:F,jobType:j.b.REGRESSION});if(!0===t.success&&t.eval&&Object(j.z)(t.eval)){const{mse:e,msle:a,huber:n,r_squared:i}=Object(f.q)(t.eval);u({mse:e,msle:a,huber:n,rSquared:i,error:null}),S(!1)}else S(!1),u({mse:"",msle:"",huber:"",rSquared:"",error:e.error})})()}),[D]);const R={...e.stats},N=R.analysis_stats?R.analysis_stats[`${L}_stats`]:void 0;null!==(i=e.config)&&void 0!==i&&i.description&&(R.description=e.config.description),delete R.progress;const P=Object.entries(R).map((([e,t])=>{const a=e.toString();return"state"===a?{title:a,description:Object(h.b)(E(t))}:"analysis_stats"!==a?{title:a,description:E(t)}:void 0})).filter((e=>void 0!==e)),z={title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.state",{defaultMessage:"State"}),items:P,position:"left",dataTestSubj:"mlAnalyticsTableRowDetailsSection state"},{currentPhase:B,totalPhases:J}=Object(g.d)(e.stats),V={title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.progress",{defaultMessage:"Progress"}),items:[{title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.phase",{defaultMessage:"Phase"}),description:`${B}/${J}`},...e.stats.progress.map((e=>({title:e.phase,description:Object(d.jsx)(b,{progress:e.progress_percent})})))],position:"right",dataTestSubj:"mlAnalyticsTableRowDetailsSection progress"},U={title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.stats",{defaultMessage:"Stats"}),items:[{title:"create_time",description:Object(c.c)(1e3*r()(e.config.create_time).unix())},{title:"model_memory_limit",description:e.config.model_memory_limit},{title:"version",description:e.config.version}],position:"left",dataTestSubj:"mlAnalyticsTableRowDetailsSection stats"},G=N?{title:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettings.analysisStats",{defaultMessage:"Analysis stats"}),items:[{title:"timestamp",description:Object(c.c)(1e3*r()(N.timestamp).unix())},{title:"timing_stats",description:E(N.timing_stats)},...Object.entries(N.parameters||N.hyperparameters||{}).map((([e,t])=>({title:e.toString(),description:E(t)})))],position:"right",dataTestSubj:"mlAnalyticsTableRowDetailsSection analysisStats"}:void 0;D&&A&&U.items.push({title:"generalization mean squared error",description:Object(d.jsx)(w,{isLoading:_,evalData:x,resultProperty:j.h.MSE})},{title:"generalization mean squared logarithmic error",description:Object(d.jsx)(w,{isLoading:_,evalData:x,resultProperty:j.h.MSLE})},{title:"generalization r squared",description:Object(d.jsx)(w,{isLoading:_,evalData:x,resultProperty:j.h.R_SQUARED})},{title:"generalization pseudo huber loss function",description:Object(d.jsx)(w,{isLoading:y,evalData:x,resultProperty:j.h.HUBER})},{title:"training mean squared error",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.MSE})},{title:"training mean squared logarithmic error",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.MSLE})},{title:"training r squared",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.R_SQUARED})},{title:"training pseudo huber loss function",description:Object(d.jsx)(w,{isLoading:y,evalData:s,resultProperty:j.h.HUBER})});const q=[z,V],W=[U];void 0!==G&&W.push(G);const H=[{id:"ml-analytics-job-details",name:l.i18n.translate("xpack.ml.dataframe.analyticsList.expandedRow.tabs.jobSettingsLabel",{defaultMessage:"Job details"}),content:Object(d.jsx)(p,{sections:q,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent job-details ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab job-details ${e.config.id}`},{id:"ml-analytics-job-stats",name:l.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.tabs.analyticsStatsLabel",{defaultMessage:"Job stats"}),content:Object(d.jsx)(p,{sections:W,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent job-stats ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab job-stats ${e.config.id}`},{id:"ml-analytics-job-json",name:"JSON",content:Object(d.jsx)(m,{json:e.config,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent json ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab json ${e.config.id}`},{id:"ml-analytics-job-messages",name:l.i18n.translate("xpack.ml.dataframe.analyticsList.analyticsDetails.tabs.analyticsMessagesLabel",{defaultMessage:"Job messages"}),content:Object(d.jsx)(O,{analyticsId:e.id,dataTestSubj:`mlAnalyticsTableRowDetailsTabContent job-messages ${e.config.id}`}),"data-test-subj":`mlAnalyticsTableRowDetailsTab job-messages ${e.config.id}`}];return Object(d.jsx)(o.EuiTabbedContent,{size:"s",tabs:H,initialSelectedTab:H[0],onTabClick:()=>{},expand:!1,style:{width:"100%"},"data-test-subj":`mlAnalyticsTableRowDetails-${e.config.id}`})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return _}));var n=a(75),i=a.n(n),s=a(16),r=a.n(s),o=a(44),l=a(2),c=a(8),d=a(164),u=a(89),p=a(0),m=a(184),b=a(233),f=a(45),h=a(390),g=a(374),j=a(161),x=a(53),v=a(12);const y=({item:e})=>{const t=Object(j.a)(x.FIELD_FORMAT_IDS.BYTES),{allocated_models:a,attributes:n,memory_overview:i,id:s,...l}=Object(c.cloneDeep)(e);return n["ml.machine_memory"]=t(n["ml.machine_memory"]),n["ml.max_jvm_size"]=t(n["ml.max_jvm_size"]),Object(v.jsx)(r.a.Fragment,null,Object(v.jsx)(o.EuiSpacer,{size:"m"}),Object(v.jsx)(o.EuiFlexGrid,{columns:2,gutterSize:"m"},Object(v.jsx)(o.EuiFlexItem,null,Object(v.jsx)(o.EuiPanel,null,Object(v.jsx)(o.EuiTitle,{size:"xs"},Object(v.jsx)("h5",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.ml.trainedModels.nodesList.expandedRow.detailsTitle",defaultMessage:"Details"}))),Object(v.jsx)(o.EuiSpacer,{size:"m"}),Object(v.jsx)(o.EuiDescriptionList,{compressed:!0,type:"column",listItems:Object(h.b)(l)}))),Object(v.jsx)(o.EuiFlexItem,null,Object(v.jsx)(o.EuiPanel,null,Object(v.jsx)(o.EuiTitle,{size:"xs"},Object(v.jsx)("h5",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.ml.trainedModels.nodesList.expandedRow.attributesTitle",defaultMessage:"Attributes"}))),Object(v.jsx)(o.EuiSpacer,{size:"m"}),Object(v.jsx)(o.EuiDescriptionList,{compressed:!0,type:"column",listItems:Object(h.b)(n)}))),a.length>0?Object(v.jsx)(o.EuiFlexItem,{grow:2},Object(v.jsx)(o.EuiPanel,null,Object(v.jsx)(o.EuiTitle,{size:"xs"},Object(v.jsx)("h5",null,Object(v.jsx)(f.FormattedMessage,{id:"xpack.ml.trainedModels.nodesList.expandedRow.allocatedModelsTitle",defaultMessage:"Allocated models"}))),Object(v.jsx)(o.EuiSpacer,{size:"m"}),Object(v.jsx)(g.a,{models:a}))):null))};var O=a(48),E=a(119);const w=({memoryOverview:e})=>{const t=Object(j.a)(x.FIELD_FORMAT_IDS.BYTES),{euiTheme:a}=Object(E.e)(),n=Object(s.useMemo)((()=>({jvm:{name:l.i18n.translate("xpack.ml.trainedModels.nodesList.jvmHeapSIze",{defaultMessage:"JVM heap size"}),colour:a.euiColorVis1},trained_models:{name:l.i18n.translate("xpack.ml.trainedModels.nodesList.modelsMemoryUsage",{defaultMessage:"Trained models"}),colour:a.euiColorVis2},anomaly_detection:{name:l.i18n.translate("xpack.ml.trainedModels.nodesList.adMemoryUsage",{defaultMessage:"Anomaly detection jobs"}),colour:a.euiColorVis6},dfa_training:{name:l.i18n.translate("xpack.ml.trainedModels.nodesList.dfaMemoryUsage",{defaultMessage:"Data frame analytics jobs"}),colour:a.euiColorVis4},available:{name:l.i18n.translate("xpack.ml.trainedModels.nodesList.availableMemory",{defaultMessage:"Estimated available memory"}),colour:Object(o.euiPaletteGray)(5)[0]}})),[]),i=[{x:0,y:e.machine_memory.jvm,g:n.jvm.name},{x:0,y:e.trained_models.total,g:n.trained_models.name},{x:0,y:e.anomaly_detection.total,g:n.anomaly_detection.name},{x:0,y:e.dfa_training.total,g:n.dfa_training.name},{x:0,y:e.machine_memory.total-e.machine_memory.jvm-e.trained_models.total-e.dfa_training.total-e.anomaly_detection.total,g:n.available.name}];return Object(v.jsx)(O.Chart,{size:["100%",50]},Object(v.jsx)(O.Settings,{rotation:90,tooltip:{headerFormatter:({value:e})=>l.i18n.translate("xpack.ml.trainedModels.nodesList.memoryBreakdown",{defaultMessage:"Approximate memory breakdown"})}}),Object(v.jsx)(O.Axis,{id:"ml_memory",position:O.Position.Bottom,hide:!0,tickFormat:e=>t(e)}),Object(v.jsx)(O.BarSeries,{id:"bars",xScaleType:O.ScaleType.Linear,yScaleType:O.ScaleType.Linear,xAccessor:"x",yAccessors:["y"],splitSeriesAccessors:["g"],stackAccessors:["x"],data:i,color:({specId:e,yAccessor:t,splitAccessors:a})=>{const i=a.get("g");return Object.values(n).find((e=>e.name===i)).colour}}))};var M=a(77),S=a(149);const _=({compactView:e=!1})=>{var t;const a=Object(m.a)(),n=Object(S.a)(),{displayErrorToast:r}=Object(M.c)(),f=Object(j.a)(x.FIELD_FORMAT_IDS.BYTES),[h,g]=Object(s.useState)([]),[O,E]=Object(s.useState)(!1),[_,T]=Object(s.useState)({}),[C,k]=Object(u.b)(p.b.TRAINED_MODELS_NODES,{pageIndex:0,pageSize:10,sortField:"name",sortDirection:"asc"}),F=null!==(t=C.queryText)&&void 0!==t?t:"",I=Object(s.useCallback)((async()=>{try{const e=await a.getTrainedModelsNodesOverview();g(e.nodes),e.nodes.forEach((e=>{_[e.id]&&(_[e.id]=Object(v.jsx)(y,{item:e}))})),E(!1)}catch(e){r(e,l.i18n.translate("xpack.ml.trainedModels.nodesList.nodesFetchError",{defaultMessage:"Nodes fetch failed"}))}}),[_]),D=e=>{const t=Object(c.cloneDeep)(_);t[e.id]?delete t[e.id]:t[e.id]=Object(v.jsx)(y,{item:e}),T(t)},A=[{align:"left",width:"40px",isExpander:!0,render:e=>Object(v.jsx)(o.EuiButtonIcon,{onClick:D.bind(null,e),"aria-label":_[e.id]?l.i18n.translate("xpack.ml.trainedModels.nodesList.collapseRow",{defaultMessage:"Collapse"}):l.i18n.translate("xpack.ml.trainedModels.nodesList.expandRow",{defaultMessage:"Expand"}),iconType:_[e.id]?"arrowUp":"arrowDown"}),"data-test-subj":"mlNodesTableRowDetailsToggle"},{field:"name",name:l.i18n.translate("xpack.ml.trainedModels.nodesList.nodeNameHeader",{defaultMessage:"Name"}),sortable:!0,truncateText:!0,"data-test-subj":"mlNodesTableColumnName"},{name:l.i18n.translate("xpack.ml.trainedModels.nodesList.nodeTotalMemoryHeader",{defaultMessage:"Total memory"}),width:"200px",truncateText:!0,"data-test-subj":"mlNodesTableColumnTotalMemory",render:e=>f(e.attributes["ml.machine_memory"])},{name:l.i18n.translate("xpack.ml.trainedModels.nodesList.nodeMemoryUsageHeader",{defaultMessage:"Memory usage"}),truncateText:!0,"data-test-subj":"mlNodesTableColumnMemoryUsage",render:e=>Object(v.jsx)(w,{memoryOverview:e.memory_overview})}],L=Object(s.useMemo)((()=>({total:{show:!0,value:h.length,label:l.i18n.translate("xpack.ml.trainedModels.nodesList.totalAmountLabel",{defaultMessage:"Total machine learning nodes"}),"data-test-subj":"mlTotalNodesCount"}})),[h]);let R=Object(b.a)(h,C,k);const N={query:F,onChange:e=>null===e.error&&(k({queryText:e.queryText,pageIndex:0}),!0),box:{incremental:!0}};return Object(s.useEffect)((function(){I()}),[n]),e&&(R={}),Object(v.jsx)("div",{"data-test-subj":"mlNodesOverviewPanel"},Object(v.jsx)(o.EuiSpacer,{size:"m"}),Object(v.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},L&&Object(v.jsx)(o.EuiFlexItem,{grow:!1},Object(v.jsx)(d.a,{stats:L,dataTestSub:"mlTrainedModelsNodesStatsBar"}))),Object(v.jsx)(o.EuiSpacer,{size:"m"}),Object(v.jsx)("div",{"data-test-subj":"mlNodesTableContainer"},Object(v.jsx)(o.EuiInMemoryTable,i()({allowNeutralSort:!1,columns:A,hasActions:!1,isExpandable:!0,itemIdToExpandedRowMap:_,isSelectable:!1,items:h,itemId:"id",loading:O,search:e?void 0:N},R,{rowProps:e=>({"data-test-subj":`mlNodesTableRow row-${e.id}`}),"data-test-subj":O?"mlNodesTable loading":"mlNodesTable loaded"}))))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return k}));var n=a(75),i=a.n(n),s=a(16),r=a.n(s),o=a(45),l=a(2),c=a(24),d=a.n(c),u=a(44),p=a(48),m=a(18),b=a(77),f=a(72),h=a(119),g=a(301),j=a(12);const x=l.i18n.translate("xpack.ml.jobsList.datafeedChart.editQueryDelay.tooltipContent",{defaultMessage:"To edit the query delay, you must have permission to edit the datafeed and the datafeed cannot be running."}),v=({datafeedId:e,queryDelay:t,isEnabled:a})=>{const[n,i]=Object(s.useState)(),[c,d]=Object(s.useState)(!1),{updateDatafeed:p}=Object(f.a)(),{displaySuccessToast:m,displayErrorToast:h}=Object(b.c)(),g=Object(s.useCallback)((async()=>{try{await p({datafeedId:e,datafeedConfig:{query_delay:n}}),m(l.i18n.translate("xpack.ml.jobsList.datafeedChart.editQueryDelay.changesSavedNotificationMessage",{defaultMessage:"Changes to query delay for {datafeedId} saved",values:{datafeedId:e}}))}catch(t){h(t,l.i18n.translate("xpack.ml.jobsList.datafeedChart.editQueryDelay.changesNotSavedNotificationMessage",{defaultMessage:"Could not save changes to query delay for {datafeedId}",values:{datafeedId:e}}))}d(!1)}),[e,n]),v=Object(j.jsx)(u.EuiButtonEmpty,{color:"primary",size:"xs",isDisabled:!1===a,onClick:()=>{d(!0)},iconType:"pencil"},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.queryDelayLinkLabel",defaultMessage:"Query delay: {queryDelay}",values:{queryDelay:n||t}})),y=Object(j.jsx)(u.EuiToolTip,{content:x},v);return Object(j.jsx)(r.a.Fragment,null,!1===c?!1===a?y:v:null,!0===c?Object(j.jsx)(u.EuiFormRow,{label:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.queryDelayLabel",defaultMessage:"Query delay"})},Object(j.jsx)(u.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFieldText,{value:n||t,placeholder:t,onChange:e=>{i(e.target.value)}})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{gutterSize:"none",direction:"column"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiButtonEmpty,{color:"primary",size:"xs",onClick:g},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.applyQueryDelayLabel",defaultMessage:"Apply"}))),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiButtonEmpty,{color:"text",size:"xs",onClick:()=>d(!1)},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.cancelQueryDelayUpdateLabel",defaultMessage:"Cancel"}))))))):null)},y="forward",O="back",E=["100%",380],w="messages";l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartTabName",{defaultMessage:"Chart"}),l.i18n.translate("xpack.ml.jobsList.datafeedChart.messagesTabName",{defaultMessage:"Messages"});var M=a(124),S=a(76);const _=Object(p.timeFormatter)("MM-DD HH:mm:ss");function T(e){return e.header=_(e.dataValue),e}const C=({details:e,datum:t})=>Object(j.jsx)("div",{className:"echAnnotation__tooltip"},Object(j.jsx)("p",{className:"echAnnotation__header"},_(t.header)),Object(j.jsx)("div",{className:"echAnnotation__details"},e)),k=({jobId:e,end:t,onClose:a})=>{const[n,c]=Object(s.useState)({datafeedConfig:void 0,bucketSpan:void 0,isInitialized:!1}),[x,w]=Object(s.useState)(d()(t)),[k,F]=Object(s.useState)(!1),[I,D]=Object(s.useState)([]),[A,L]=Object(s.useState)({rect:[],line:[]}),[R,N]=Object(s.useState)([]),[P,z]=Object(s.useState)([]),[B,J]=Object(s.useState)([]),[V,U]=Object(s.useState)(!0),[G,q]=Object(s.useState)(!0),[W,H]=Object(s.useState)(),Y=Object(s.useMemo)((()=>Object(S.e)("canUpdateDatafeed")),[]),{results:{getDatafeedResultChartData:$}}=Object(f.a)(),{displayErrorToast:X}=Object(b.c)(),{euiTheme:K}=Object(h.e)(),Q=e=>{if(void 0===n.bucketSpan)return;const t=x.clone(),a=n.bucketSpan.match(/[d | h| m | s]/g)[0],i=Number(n.bucketSpan.replace(/[^0-9]/g,""));e===y?t.add(480*i,a):t.subtract(480*i,a),w(t)},Z=Object(s.useCallback)((async()=>{if(void 0===n.bucketSpan)return;const t=d()(x).valueOf(),a=n.bucketSpan.match(/[d | h| m | s]/g)[0],i=Number(n.bucketSpan.replace(/[^0-9]/g,"")),s=x.clone().subtract(480*i,a),r=d()(s).valueOf();H({start:String(r),end:String(t)});try{const a=await $(e,r,t);J(a.datafeedResults),D(a.bucketResults),L({rect:a.annotationResultsRect,line:a.annotationResultsLine.map(T)}),N(a.modelSnapshotResultsLine.map(T))}catch(e){const t=l.i18n.translate("xpack.ml.jobsList.datafeedChart.errorToastTitle",{defaultMessage:"Error fetching data"});X(e,t)}F(!1)}),[x,n.bucketSpan]),ee=Object(s.useCallback)((async()=>{try{const t=await Object(M.k)(e);c({datafeedConfig:t.datafeed_config,bucketSpan:t.analysis_config.bucket_span,isInitialized:!0})}catch(e){X(e)}}),[e]);Object(s.useEffect)((function(){ee()}),[]),Object(s.useEffect)((function(){void 0!==n.bucketSpan&&(F(!0),Z())}),[x,n.bucketSpan]);const{datafeedConfig:te,bucketSpan:ae,isInitialized:ne}=n,ie=Object(s.useMemo)((()=>Object(u.htmlIdGenerator)()()),[]),se=Object(s.useMemo)((()=>Object(u.htmlIdGenerator)()()),[]);return Object(j.jsx)(u.EuiPortal,null,Object(j.jsx)(u.EuiFlyout,{size:"m",ownFocus:!0,onClose:a.bind(null,!1),"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.datafeedChartFlyoutAriaLabel",{defaultMessage:"Datafeed chart flyout"}),"data-test-subj":"mlAnnotationsViewDatafeedFlyout"},Object(j.jsx)(u.EuiFlyoutHeader,{hasBorder:!0,"data-test-subj":"mlAnnotationsViewDatafeedFlyoutTitle"},Object(j.jsx)(u.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"xl"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiIconTip,{color:"primary",type:"help",content:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.headerTooltipContent",defaultMessage:"Charts the event counts of the job and the source data to identify where missing data has occurred."})})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiTitle,{size:"xs"},Object(j.jsx)("h4",null,Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.header",defaultMessage:"Datafeed chart for {jobId}",values:{jobId:e}})))))),Object(j.jsx)(u.EuiFlexItem,{grow:!1,style:{padding:"10px"}},Object(j.jsx)(u.EuiDatePicker,{"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartIntervalEndTime",{defaultMessage:"Chart interval end time"}),showTimeSelect:!0,selected:x,onChange:e=>w(e),popoverPlacement:"left-start"})))),Object(j.jsx)(u.EuiFlyoutBody,null,k||!1===ne?Object(j.jsx)(u.EuiLoadingChart,{size:"l"}):null,!k&&ne&&void 0!==te&&ae?Object(j.jsx)(u.EuiFlexGroup,{direction:"column"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(v,{datafeedId:te.datafeed_id,queryDelay:te.query_delay,isEnabled:te.state===m.a.STOPPED&&Y})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,null,Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiCheckbox,{id:ie,label:Object(j.jsx)(u.EuiText,{size:"xs"},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.showAnnotationsCheckboxLabel",defaultMessage:"Show annotations"})),checked:V,onChange:()=>U(!V)})),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiCheckbox,{id:se,label:Object(j.jsx)(u.EuiText,{size:"xs"},Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.showModelSnapshotsCheckboxLabel",defaultMessage:"Show model snapshots"})),checked:G,onChange:()=>q(!G)})))))),Object(j.jsx)(u.EuiFlexItem,null,Object(j.jsx)(u.EuiFlexGroup,{gutterSize:"none",alignItems:"center"},Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiToolTip,{content:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.chartLeftArrowTooltip",defaultMessage:"Previous time window"})},Object(j.jsx)(u.EuiButtonEmpty,{"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartIntervalLeftArrow",{defaultMessage:"Previous time window"}),color:"primary",onClick:()=>{Q(O)},iconType:"arrowLeft"}))),Object(j.jsx)(u.EuiFlexItem,null,Object(j.jsx)("div",{"data-test-subj":"mlAnnotationsViewDatafeedFlyoutChart"},Object(j.jsx)(p.Chart,{size:E},Object(j.jsx)(p.Settings,{showLegend:!0,legendPosition:p.Position.Bottom,theme:{lineSeriesStyle:{point:{visible:!1}}}}),Object(j.jsx)(p.Axis,{id:"bottom",position:p.Position.Bottom,showOverlappingTicks:!0,tickFormat:_,title:l.i18n.translate("xpack.ml.jobsList.datafeedChart.xAxisTitle",{defaultMessage:"Bucket span ({bucketSpan})",values:{bucketSpan:ae}})}),Object(j.jsx)(p.Axis,{id:"left",title:l.i18n.translate("xpack.ml.jobsList.datafeedChart.yAxisTitle",{defaultMessage:"Count"}),position:p.Position.Left}),G?Object(j.jsx)(p.LineAnnotation,{id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.modelSnapshotsLineSeriesId",{defaultMessage:"Model snapshots"}),key:"model-snapshots-results-line",domainType:p.AnnotationDomainType.XDomain,dataValues:R,marker:Object(j.jsx)(u.EuiIcon,{type:"asterisk"}),markerPosition:p.Position.Top,style:{line:{strokeWidth:3,stroke:K.euiColorVis1,opacity:.5}}}):null,V?Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(p.LineAnnotation,{id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.annotationLineSeriesId",{defaultMessage:"Annotations line result"}),key:"annotation-results-line",domainType:p.AnnotationDomainType.XDomain,dataValues:A.line,marker:Object(j.jsx)(u.EuiIcon,{type:"annotation"}),markerPosition:p.Position.Top,style:{line:{strokeWidth:3,stroke:K.euiColorDangerText,opacity:.5}}}),Object(j.jsx)(p.RectAnnotation,{key:"annotation-results-rect",customTooltip:C,dataValues:A.rect,id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.annotationRectSeriesId",{defaultMessage:"Annotations rectangle result"}),style:{fill:K.euiColorDangerText}})):null,P.length>0?Object(j.jsx)(r.a.Fragment,null,Object(j.jsx)(p.LineAnnotation,{id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.messageLineAnnotationId",{defaultMessage:"Job messages line result"}),key:"messages-results-line",domainType:p.AnnotationDomainType.XDomain,dataValues:P,marker:Object(j.jsx)(u.EuiIcon,{type:"tableDensityNormal"}),markerPosition:p.Position.Top,style:{line:{strokeWidth:3,stroke:K.euiColorAccent,opacity:.5}}})):null,Object(j.jsx)(p.LineSeries,{key:"source-results",color:K.euiColorPrimary,id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.sourceSeriesId",{defaultMessage:"Source indices"}),xScaleType:p.ScaleType.Time,yScaleType:p.ScaleType.Linear,xAccessor:0,yAccessors:[1],data:B,curve:p.CurveType.LINEAR}),Object(j.jsx)(p.LineSeries,{key:"job-results",color:K.euiColorAccentText,id:l.i18n.translate("xpack.ml.jobsList.datafeedChart.bucketSeriesId",{defaultMessage:"Job results"}),xScaleType:p.ScaleType.Time,yScaleType:p.ScaleType.Linear,xAccessor:0,yAccessors:[1],data:I,curve:p.CurveType.LINEAR})))),Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiToolTip,{content:Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.chartRightArrowTooltip",defaultMessage:"Next time window"})},Object(j.jsx)(u.EuiButtonEmpty,{"aria-label":l.i18n.translate("xpack.ml.jobsList.datafeedChart.chartIntervalRightArrow",{defaultMessage:"Next time window"}),color:"primary",onClick:()=>{Q(y)},iconType:"arrowRight"}))))),void 0!==W?Object(j.jsx)(u.EuiFlexItem,{grow:!1},Object(j.jsx)(u.EuiFlexGroup,{direction:"column"},Object(j.jsx)(u.EuiTitle,{size:"xs"},Object(j.jsx)("h4",null,Object(j.jsx)(o.FormattedMessage,{id:"xpack.ml.jobsList.datafeedChart.messagesTableTitle",defaultMessage:"Job messages"}))),Object(j.jsx)(g.a,i()({jobId:e},W,{actionHandler:function(e){if(P.length>0&&P[0].dataValue===e.timestamp)z([]);else{const t=T({dataValue:e.timestamp,details:e.message});z([t])}}})))):null):null)))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p})),a.d(t,"b",(function(){return g}));var n=a(16),i=a.n(n),s=a(2),r=a(44),o=a(76),l=a(103),c=a(12);const d=s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionNameText",{defaultMessage:"Delete"}),u=({isDisabled:e,item:t})=>e?Object(c.jsx)(r.EuiToolTip,{position:"top",content:Object(l.g)(t.stats.state)?s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteActionDisabledToolTipContent",{defaultMessage:"Stop the data frame analytics job in order to delete it."}):Object(o.f)("canStartStopDataFrameAnalytics")},Object(c.jsx)(i.a.Fragment,null,d)):Object(c.jsx)(i.a.Fragment,null,d),p=({closeModal:e,deleteAndCloseModal:t,deleteTargetIndex:a,deleteIndexPattern:n,indexPatternExists:i,isLoading:o,item:l,toggleDeleteIndex:d,toggleDeleteIndexPattern:u,userCanDeleteIndex:p,userCanDeleteDataView:m})=>{if(void 0===l)return null;const b=l.config.dest.index;return Object(c.jsx)(r.EuiConfirmModal,{"data-test-subj":"mlAnalyticsJobDeleteModal",title:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalTitle",{defaultMessage:"Delete {analyticsId}?",values:{analyticsId:l.config.id}}),onCancel:e,onConfirm:t,cancelButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalCancelButton",{defaultMessage:"Cancel"}),confirmButtonText:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteModalDeleteButton",{defaultMessage:"Delete"}),defaultFocusedButton:r.EUI_MODAL_CONFIRM_BUTTON,buttonColor:"danger",confirmButtonDisabled:o},Object(c.jsx)(r.EuiFlexGroup,{direction:"column",gutterSize:"none"},Object(c.jsx)(r.EuiFlexItem,null,p&&Object(c.jsx)(r.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteIndexSwitch",style:{paddingBottom:10},label:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteDestinationIndexTitle",{defaultMessage:"Delete destination index {indexName}",values:{indexName:b}}),checked:a,onChange:d})),Object(c.jsx)(r.EuiFlexItem,null,p&&i&&Object(c.jsx)(r.EuiSwitch,{"data-test-subj":"mlAnalyticsJobDeleteIndexPatternSwitch",label:s.i18n.translate("xpack.ml.dataframe.analyticsList.deleteTargetDataViewTitle",{defaultMessage:"Delete data view {dataView}",values:{dataView:b}}),checked:n,onChange:u,disabled:!1===m}))))};var m=a(27),b=a(72),f=a(77),h=a(179);const g=e=>{var t;const[a,i]=Object(n.useState)(),[r,o]=Object(n.useState)(!1),[p,g]=Object(n.useState)(!1),[j,x]=Object(n.useState)(!1),[v,y]=Object(n.useState)(!0),[O,E]=Object(n.useState)(!0),[w,M]=Object(n.useState)(!1),[S,_]=Object(n.useState)(!1),[T,C]=Object(n.useState)(!1),[k,F]=Object(n.useState)(!1),{data:{dataViews:I},application:{capabilities:D}}=Object(b.b)().services,A=null!==(t=null==a?void 0:a.config.dest.index)&&void 0!==t?t:"",L=Object(f.c)();Object(n.useEffect)((()=>{F(!0),(async()=>{try{const e=(await I.getIdsWithTitle()).find((({title:e})=>e===A));C(void 0!==e),F(!1)}catch(e){const t=Object(m.b)(e);F(!1),L.displayDangerToast(s.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfDataViewExistsNotificationErrorMessage",{defaultMessage:"An error occurred checking if data view {dataView} exists: {error}",values:{dataView:A,error:t}}))}})(),(async()=>{try{await Object(h.a)(A,L)&&M(!0);const e=!0===D.savedObjectsManagement.delete||!0===D.indexPatterns.save;_(e),!1===e&&E(!1)}catch(e){const t=Object(m.b)(e);F(!1),L.displayDangerToast(s.i18n.translate("xpack.ml.dataframe.analyticsList.errorWithCheckingIfUserCanDeleteIndexNotificationErrorMessage",{defaultMessage:"An error occurred checking if user can delete {destinationIndex}: {error}",values:{destinationIndex:A,error:t}}))}})()}),[r]);const R=e=>{i(e),g(!0)};return{action:Object(n.useMemo)((()=>({name:t=>Object(c.jsx)(u,{isDisabled:Object(l.g)(t.stats.state)||!e,item:t}),enabled:t=>!Object(l.g)(t.stats.state)&&e,description:d,icon:"trash",type:"icon",onClick:e=>R(e),"data-test-subj":"mlAnalyticsJobDeleteButton"})),[]),closeDeleteJobCheckModal:()=>g(!1),closeModal:()=>o(!1),deleteAndCloseModal:()=>{x(!0),o(!1),void 0!==a&&(w&&v||w&&O?Object(h.c)(a.config,a.stats,v,T&&O,L):Object(h.b)(a.config,a.stats,L))},deleteTargetIndex:v,deleteIndexPattern:O,deleteItem:j,indexPatternExists:T,isDeleteJobCheckModalVisible:p,isModalVisible:r,isLoading:k,item:a,jobType:"data-frame-analytics",openModal:e=>{i(e),o(!0)},openDeleteJobCheckModal:R,toggleDeleteIndex:()=>y(!v),toggleDeleteIndexPattern:()=>E(!O),userCanDeleteIndex:w,userCanDeleteDataView:S}}},function(e,t,a){"use strict";a.d(t,"b",(function(){return results_loader_ResultsLoader})),a.d(t,"a",(function(){return categorization_examples_loader_CategorizationExamplesLoader}));var n=a(5),i=a.n(n),s=a(25),r=a(100),o=a(135),l=a(7),c=a(29),d=a(8),u=a(98),p=a(73);var m=a(84),b=a(94);const f={time:0,actual:0,modelUpper:0,modelLower:0};class results_loader_ResultsLoader{constructor(e,t,a){i()(this,"_results$",void 0),i()(this,"_resultsSearchRunning",!1),i()(this,"_jobCreator",void 0),i()(this,"_chartInterval",void 0),i()(this,"_lastModelTimeStamp",0),i()(this,"_lastResultsTimeout",null),i()(this,"_chartLoader",void 0),i()(this,"_results",{progress:0,model:[],anomalies:[]}),i()(this,"_detectorSplitFieldFilters",null),i()(this,"_splitFieldFiltersLoaded",!1),i()(this,"progressSubscriber",(async e=>{!1===this._resultsSearchRunning&&(e-this._results.progress>5||100===e)&&(!1===this._splitFieldFiltersLoaded&&(this._splitFieldFiltersLoaded=!0,await this._populateDetectorSplitFieldFilters()),this._updateData(e,!1),100===e&&(clearTimeout(this._lastResultsTimeout),this._lastResultsTimeout=setTimeout((()=>{this._updateData(e,!0)}),500)))})),this._jobCreator=e,this._chartInterval=t,this._results$=new s.BehaviorSubject(this._results),this._chartLoader=a,e.subscribeToProgress(this.progressSubscriber)}async _updateData(e,t){this._resultsSearchRunning=!0,!0===t&&this._clearResults(),this._results.progress=e;const a=this._jobCreator.type===m.f.SINGLE_METRIC?()=>this._loadJobAnomalyData(0):()=>this._loadDetectorsAnomalyData(),[n,i]=await Promise.all([this._loadModelData(0),a()]);this._results.model=n,this._results.anomalies=i,this._resultsSearchRunning=!1,this._results$.next(this._results)}get results$(){return this._results$}subscribeToResults(e){return this._results$.subscribe(e)}get progress(){return this._results.progress}_clearResults(){this._results.model={},this._results.anomalies={},this._results.progress=0,this._lastModelTimeStamp=0}async _loadModelData(e){if(!1===this._jobCreator.modelPlot)return[];const t=this._jobCreator.getAggregation(e);if(null===t)return{[e]:[f]};const a=await o.mlResultsService.getModelPlotOutput(this._jobCreator.jobId,e,[],this._lastModelTimeStamp,this._jobCreator.end,this._chartInterval.getInterval().asMilliseconds(),t.mlModelPlotAgg).toPromise();return this._createModel(a,e)}_createModel({results:e},t){void 0===this._results.model[t]&&(this._results.model[t]=[]);const a=this._jobCreator.aggregations[t].dslName,n=a===b.a.COUNT||a===b.a.CARDINALITY?this._calculateModelScale():1,i=Object.entries(e).map((([e,{actual:t,modelLower:a,modelUpper:i}])=>({time:+e,actual:t,modelUpper:(null===i?0:i)*n,modelLower:(null===a?0:a)*n})));if(i.length>10){this._lastModelTimeStamp=i[i.length-5].time;for(let e=0;e<5;e++)this._results.model[t].pop()}return{[t]:this._results.model[t].concat(i)}}async _loadJobAnomalyData(e){const t=(await o.mlResultsService.getScoresByBucket([this._jobCreator.jobId],this._jobCreator.start,this._jobCreator.end,this._chartInterval.getInterval().asMilliseconds(),1)).results[this._jobCreator.jobId];if(void 0===t)return[];const a={};return a[0]=Object.entries(t).map((([e,t])=>({time:+e,value:t,severity:Object(l.k)(t)}))),a}async _loadDetectorsAnomalyData(){const e=await(t=this._jobCreator.jobId,a=this._jobCreator.start,n=this._jobCreator.end,i=this._chartInterval.getInterval().asMilliseconds(),s=this._detectorSplitFieldFilters,new Promise(((e,r)=>{const o={success:!0,results:{},totalResults:0};let l="job_id: "+t;s&&void 0!==s.value&&(l+=` AND ${Object(u.c)(s.name)}:`,l+=`"${String(s.value).replace(/\\/g,"\\\\")}"`),p.ml.results.anomalySearch({size:0,body:{query:{bool:{filter:[{query_string:{query:"result_type:record"}},{bool:{must:[{range:{timestamp:{gte:a,lte:n,format:"epoch_millis"}}},{query_string:{query:l}}]}}]}},aggs:{detector_index:{terms:{field:"detector_index",order:{recordScore:"desc"}},aggs:{recordScore:{max:{field:"record_score"}},byTime:{date_histogram:{field:"timestamp",fixed_interval:`${i}ms`,min_doc_count:1,extended_bounds:{min:a,max:n}},aggs:{recordScore:{max:{field:"record_score"}}}}}}}}},[t]).then((t=>{Object(d.get)(t,["aggregations","detector_index","buckets"],[]).forEach((e=>{const t=[],a=+e.key,n=Object(d.get)(e,["byTime","buckets"],[]);for(let e=0;e<n.length;e++){const a=n[e],i=a.key;t.push({time:i,value:Object(d.get)(a,["recordScore","value"])})}o.results[a]=t})),e(o)})).catch((e=>{r(e)}))})));var t,a,n,i,s;const r={};return Object.entries(e.results).forEach((([e,t])=>{r[+e]=t.map((e=>({...e,severity:Object(l.k)(e.value)})))})),r}async _populateDetectorSplitFieldFilters(){if(Object(r.c)(this._jobCreator)&&null!==this._jobCreator.splitField){const e=await this._chartLoader.loadFieldExampleValues(this._jobCreator.splitField,this._jobCreator.runtimeMappings,this._jobCreator.datafeedConfig.indices_options);e.length>0&&(this._detectorSplitFieldFilters={name:this._jobCreator.splitField.name,value:e[0]})}else this._detectorSplitFieldFilters=null}_calculateModelScale(){const e=Object(c.a)(this._jobCreator.bucketSpan),t=null!==e?e.asMilliseconds():0;return this._chartInterval.getInterval().asMilliseconds()/t}}var h=a(155);class categorization_examples_loader_CategorizationExamplesLoader{constructor(e,t,a){i()(this,"_jobCreator",void 0),i()(this,"_indexPatternTitle",""),i()(this,"_timeFieldName",""),i()(this,"_query",{}),this._jobCreator=e,this._indexPatternTitle=t.title,this._query=a,"string"==typeof t.timeFieldName&&(this._timeFieldName=t.timeFieldName)}async loadExamples(){var e;const t=this._jobCreator.categorizationAnalyzer,a=this._jobCreator.categorizationFieldName;if(null===a)return{examples:[],sampleSize:0,overallValidStatus:h.a.INVALID,validationChecks:[]};return await p.ml.jobs.categorizationFieldExamples(this._indexPatternTitle,this._query,h.b,a,this._timeFieldName,this._jobCreator.start,this._jobCreator.end,t,null!==(e=this._jobCreator.runtimeMappings)&&void 0!==e?e:void 0,this._jobCreator.datafeedConfig.indices_options)}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return g}));var n=a(16),i=a.n(n),s=a(2),r=a(45),o=a(44),l=a(73),c=a(12);const d=({syncItems:e})=>null===e?null:Object(c.jsx)(i.a.Fragment,null,Object(c.jsx)(u,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"}),Object(c.jsx)(p,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"}),Object(c.jsx)(m,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"}),Object(c.jsx)(b,{syncItems:e}),Object(c.jsx)(o.EuiHorizontalRule,{margin:"l"})),u=({syncItems:e})=>{const t=Object.keys(e.savedObjectsCreated),a=Object(c.jsx)(i.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutMissingObjectsTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsCreated.title",defaultMessage:"Missing saved objects ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsCreated.description",defaultMessage:"If there are jobs that do not have accompanying saved objects, they will be created in the current space."})))));return Object(c.jsx)(f,{id:"savedObjectsCreated",title:a,items:t})},p=({syncItems:e})=>{const t=Object.keys(e.savedObjectsDeleted),a=Object(c.jsx)(i.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutUnmatchedObjectsTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsDeleted.title",defaultMessage:"Unmatched saved objects ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.savedObjectsDeleted.description",defaultMessage:"If there are saved objects that do not have an accompanying job, they will be deleted."})))));return Object(c.jsx)(f,{id:"savedObjectsDeleted",title:a,items:t})},m=({syncItems:e})=>{const t=Object.keys(e.datafeedsAdded),a=Object(c.jsx)(i.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutObjectsMissingDatafeedTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsAdded.title",defaultMessage:"Saved objects with missing datafeeds ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsAdded.description",defaultMessage:"If there are saved objects that are missing the datafeed ID for anomaly detection jobs, the ID will be added."})))));return Object(c.jsx)(f,{id:"datafeedsAdded",title:a,items:t})},b=({syncItems:e})=>{const t=Object.keys(e.datafeedsRemoved),a=Object(c.jsx)(i.a.Fragment,null,Object(c.jsx)(o.EuiTitle,{size:"xs","data-test-subj":"mlJobMgmtSyncFlyoutObjectsUnmatchedDatafeedTitle"},Object(c.jsx)("h3",null,Object(c.jsx)(o.EuiTextColor,{color:t.length?"default":"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsRemoved.title",defaultMessage:"Saved objects with unmatched datafeed IDs ({count})",values:{count:t.length}})))),Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("p",null,Object(c.jsx)(o.EuiTextColor,{color:"subdued"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.datafeedsRemoved.description",defaultMessage:"If there are saved objects that use a datafeed that does not exist, they will be deleted."})))));return Object(c.jsx)(f,{id:"datafeedsRemoved",title:a,items:t})},f=({id:e,title:t,items:a})=>Object(c.jsx)(o.EuiAccordion,{id:e,buttonContent:t,paddingSize:"l"},Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)("ul",null,a.map((e=>Object(c.jsx)("li",{key:e},e))))));var h=a(77);const g=({onClose:e})=>{const{displayErrorToast:t,displaySuccessToast:a}=Object(h.c)(),[u,p]=Object(n.useState)(!1),[m,b]=Object(n.useState)(!1),[f,g]=Object(n.useState)(null);async function j(e=!0){p(!0);try{const t=await l.ml.savedObjects.syncSavedObjects(e);g(t);const a=Object.values(t).reduce(((e,t)=>e+Object.keys(t).length),0);return b(a>0),p(!1),t}catch(e){t(e),p(!1)}return null}return Object(n.useEffect)((()=>{j()}),[]),Object(c.jsx)(i.a.Fragment,null,Object(c.jsx)(o.EuiFlyout,{maxWidth:600,onClose:e,"data-test-subj":"mlJobMgmtSyncFlyout"},Object(c.jsx)(o.EuiFlyoutHeader,{hasBorder:!0},Object(c.jsx)(o.EuiTitle,{size:"m"},Object(c.jsx)("h2",null,Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.headerLabel",defaultMessage:"Synchronize saved objects"})))),Object(c.jsx)(o.EuiFlyoutBody,null,Object(c.jsx)(o.EuiCallOut,{color:"primary"},Object(c.jsx)(o.EuiText,{size:"s"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.description",defaultMessage:"Synchronize the saved objects if they are out of sync with the machine learning jobs in Elasticsearch."}))),Object(c.jsx)(o.EuiSpacer,null),Object(c.jsx)(d,{syncItems:f})),Object(c.jsx)(o.EuiFlyoutFooter,null,Object(c.jsx)(o.EuiFlexGroup,{justifyContent:"spaceBetween"},Object(c.jsx)(o.EuiFlexItem,{grow:!1},Object(c.jsx)(o.EuiButtonEmpty,{iconType:"cross",onClick:e,flush:"left","data-test-subj":"mlJobMgmtSyncFlyoutCloseButton"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.closeButton",defaultMessage:"Close"}))),Object(c.jsx)(o.EuiFlexItem,{grow:!1},Object(c.jsx)(o.EuiButton,{onClick:async function(){if(m){const e=await j(!1);if(await j(!0),null===e)return;const{successCount:n,errorCount:i}=function(e){let t=0,a=0;return Object.values(e).forEach((e=>{Object.values(e).forEach((({success:e,error:n})=>{!0===e?t++:void 0!==n&&a++}))})),{successCount:t,errorCount:a}}(e);if(i>0){const a=s.i18n.translate("xpack.ml.management.syncSavedObjectsFlyout.sync.error",{defaultMessage:"Some jobs cannot be synchronized."});return void t(e,a)}a(s.i18n.translate("xpack.ml.management.syncSavedObjectsFlyout.sync.success",{defaultMessage:"{successCount} {successCount, plural, one {job} other {jobs}} synchronized",values:{successCount:n}}))}},fill:!0,isDisabled:!1===m||!0===u,"data-test-subj":"mlJobMgmtSyncFlyoutSyncButton"},Object(c.jsx)(r.FormattedMessage,{id:"xpack.ml.management.syncSavedObjectsFlyout.syncButton",defaultMessage:"Synchronize"})))))))}},,function(e,t,a){"use strict";a.d(t,"a",(function(){return b}));var n=a(16),i=a.n(n),s=a(2),r=a(45),o=a(44),l=a(63),c=a(72),d=a(77),u=a(220),p=a(96),m=a(12);const b=({onClose:e})=>{const{services:{savedObjects:t,uiSettings:a}}=Object(c.b)(),b=Object(c.e)(),[f,h]=Object(n.useState)(!1),[g,j]=Object(n.useState)(),x=Object(d.c)();return Object(m.jsx)(o.EuiModal,{className:"dataFrameAnalyticsCreateSearchDialog",onClose:e,"data-test-subj":"analyticsCreateSourceIndexModal"},Object(m.jsx)(o.EuiModalHeader,null,Object(m.jsx)(o.EuiModalHeaderTitle,null,Object(m.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.newAnalyticsTitle",defaultMessage:"New analytics job"})," ","/"," ",Object(m.jsx)(r.FormattedMessage,{id:"xpack.ml.dataframe.analytics.create.chooseSourceTitle",defaultMessage:"Choose a source data view"}))),Object(m.jsx)(o.EuiModalBody,null,f&&Object(m.jsx)(i.a.Fragment,null,Object(m.jsx)(o.EuiCallOut,{"data-test-subj":"analyticsCreateSourceIndexModalCcsErrorCallOut",title:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.CcsErrorCallOutTitle",{defaultMessage:"Data views using cross-cluster search are not supported."}),color:"danger"},"string"==typeof g&&Object(m.jsx)("p",null,g)),Object(m.jsx)(o.EuiSpacer,{size:"m"})),Object(m.jsx)(l.SavedObjectFinderUi,{key:"searchSavedObjectFinder",onChoose:async(e,t,a,n)=>{let i="";if("index-pattern"===t)i=Object(u.a)(n,"attributes.title");else if("search"===t)try{var r,o;i=null!==(r=null===(o=(await Object(p.b)(e)).dataView)||void 0===o?void 0:o.title)&&void 0!==r?r:""}catch(e){return void x.displayErrorToast(e,s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.errorGettingDataViewTitle",{defaultMessage:"Error loading data view used by the saved search"}))}if(Object(p.g)(i))return h(!0),void j("search"===t?s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.CcsErrorCallOutBody",{defaultMessage:"The saved search '{savedSearchTitle}' uses the data view '{dataViewName}'.",values:{savedSearchTitle:Object(u.a)(n,"attributes.title"),dataViewName:i}}):void 0);await b(`/data_frame_analytics/new_job?${"index-pattern"===t?"index":"savedSearchId"}=${encodeURIComponent(e)}`)},showFilter:!0,noItemsMessage:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.notFoundLabel",{defaultMessage:"No matching indices or saved searches found."}),savedObjectMetaData:[{type:"search",getIconForSavedObject:()=>"search",name:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.savedObjectType.search",{defaultMessage:"Saved search"})},{type:"index-pattern",getIconForSavedObject:()=>"indexPatternApp",name:s.i18n.translate("xpack.ml.dataFrame.analytics.create.searchSelection.savedObjectType.indexPattern",{defaultMessage:"Data view"})}],fixedPageSize:8,uiSettings:a,savedObjects:t})))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(16),i=a.n(n),s=a(44),r=a(2),o=a(45),l=a(474),c=a.n(l),d=a(72),u=a(12);const p=({disabled:e,onCreateFirstJobClick:t})=>{const{services:{docLinks:a,http:{basePath:n}}}=Object(d.b)(),l=`${n.get()}/app/management/data/transform`;return Object(u.jsx)(s.EuiEmptyPrompt,{layout:"horizontal",hasBorder:!1,hasShadow:!1,icon:Object(u.jsx)(s.EuiImage,{size:"fullWidth",src:c.a,alt:r.i18n.translate("xpack.ml.dataFrame.analyticsList.emptyPromptTitle",{defaultMessage:"Create your first data frame analytics job"})}),color:"subdued",title:Object(u.jsx)("h2",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.dataFrame.analyticsList.emptyPromptTitle",defaultMessage:"Create your first data frame analytics job"})),body:Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)("p",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.overview.analyticsList.emptyPromptText",defaultMessage:"Train outlier detection, regression, or classification machine learning models using data frame analytics."})),Object(u.jsx)(s.EuiCallOut,{size:"s",title:Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.overview.analyticsList.emptyPromptHelperText",defaultMessage:"Before building a data frame analytics job, use {transforms} to construct an {sourcedata}.",values:{transforms:Object(u.jsx)(s.EuiLink,{href:l,target:"blank",color:"accent"},Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionTransforms",defaultMessage:"transforms"})),sourcedata:Object(u.jsx)(s.EuiLink,{href:a.links.ml.dFAPrepareData,target:"blank",color:"accent",external:!0},Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.overview.gettingStartedSectionSourceData",defaultMessage:"entity-centric source data set"}))}}),iconType:"iInCircle"})),actions:[Object(u.jsx)(s.EuiButton,{onClick:t,isDisabled:e,color:"primary",iconType:"plusInCircle",fill:!0,"data-test-subj":"mlAnalyticsCreateFirstButton"},r.i18n.translate("xpack.ml.dataFrame.analyticsList.emptyPromptButtonText",{defaultMessage:"Create job"}))],footer:Object(u.jsx)(s.EuiFlexGroup,{gutterSize:"xs",alignItems:"center"},Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiTitle,{size:"xxs"},Object(u.jsx)("h3",null,Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.common.learnMoreQuestion",defaultMessage:"Want to learn more?"})))),Object(u.jsx)(s.EuiFlexItem,{grow:!1},Object(u.jsx)(s.EuiLink,{href:a.links.ml.dataFrameAnalytics,target:"_blank",external:!0},Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.common.readDocumentationLink",defaultMessage:"Read documentation"})))),"data-test-subj":"mlNoDataFrameAnalyticsFound"})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(16),i=a.n(n),s=a(44),r=a(2),o=a(21),l=a(73),c=a(77),d=a(12);const u=r.i18n.translate("xpack.ml.management.jobsSpacesList.objectNoun",{defaultMessage:"job"}),p=({spacesApi:e,spaceIds:t,jobId:a,jobType:p,refresh:m})=>{const{displayErrorToast:b}=Object(c.c)(),[f,h]=Object(n.useState)(!1);function g(){h(!1),m()}const j=Object(n.useCallback)(e.ui.components.getSpaceList,[e]),x=Object(n.useCallback)(e.ui.components.getShareToSpaceFlyout,[e]),v={savedObjectTarget:{type:o.a,id:a,namespaces:t,title:a,noun:u},behaviorContext:"outside-space",changeSpacesHandler:async function(e,t,n){const i=t.includes("*")?[]:n;if(t.length||i.length){!function(e){Object.entries(e).forEach((([e,{success:t,error:a}])=>{if(!1===t){const t=r.i18n.translate("xpack.ml.management.jobsSpacesList.updateSpaces.error",{defaultMessage:"Error updating {id}",values:{id:e}});b(a,t)}}))}(await l.ml.savedObjects.updateJobsSpaces(p,[a],t,i))}g()},onClose:g};return Object(d.jsx)(i.a.Fragment,null,Object(d.jsx)(s.EuiButtonEmpty,{onClick:()=>h(!0),style:{height:"auto"},"data-test-subj":"mlJobListRowManageSpacesButton"},Object(d.jsx)(j,{namespaces:t,displayLimit:0,behaviorContext:"outside-space"})),f&&Object(d.jsx)(x,v))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a(16);var n=a(44),i=a(12);const[s,r,o]=["info","warning","error"],l=({message:e,showTooltip:t=!1})=>{if(void 0===e)return Object(i.jsx)("span",null);let a="primary",l="alert";return e.level===s?l="iInCircle":e.level===r?a="warning":e.level===o&&(a="danger"),t?Object(i.jsx)(n.EuiToolTip,{position:"bottom",content:e.text},Object(i.jsx)(n.EuiIcon,{type:l,color:a})):Object(i.jsx)(n.EuiIcon,{type:l,color:a})}},function(e,t,a){"use strict";a.d(t,"a",(function(){return p}));var n=a(16),i=a.n(n),s=a(44),r=a(2),o=a(45),l=a(57),c=a(401),d=a(82),u=a(12);const p=({messages:e,loading:t,error:a,refreshMessage:n,actionHandler:p})=>{const m=[{name:n?Object(u.jsx)(s.EuiToolTip,{content:r.i18n.translate("xpack.ml.jobMessages.refreshLabel",{defaultMessage:"Refresh"})},Object(u.jsx)(s.EuiButtonIcon,{onClick:n,iconType:"refresh","aria-label":r.i18n.translate("xpack.ml.jobMessages.refreshAriaLabel",{defaultMessage:"Refresh"})})):"",render:e=>Object(u.jsx)(c.a,{message:e}),width:`${l.euiLightVars.euiSizeL}`},{field:"timestamp",name:r.i18n.translate("xpack.ml.jobMessages.timeLabel",{defaultMessage:"Time"}),render:d.d,width:"120px",sortable:!0},{field:"node_name",name:r.i18n.translate("xpack.ml.jobMessages.nodeLabel",{defaultMessage:"Node"}),width:"150px"},{field:"message",name:r.i18n.translate("xpack.ml.jobMessages.messageLabel",{defaultMessage:"Message"}),width:"50%"}];"function"==typeof p&&m.push({name:r.i18n.translate("xpack.ml.jobMessages.actionsLabel",{defaultMessage:"Actions"}),width:"10%",actions:[{render:e=>Object(u.jsx)(s.EuiToolTip,{content:Object(u.jsx)(o.FormattedMessage,{id:"xpack.ml.jobMessages.toggleInChartTooltipText",defaultMessage:"Toggle in chart"})},Object(u.jsx)(s.EuiButtonIcon,{size:"xs","aria-label":r.i18n.translate("xpack.ml.jobMessages.toggleInChartAriaLabel",{defaultMessage:"Toggle in chart"}),iconType:"visAreaStacked",onClick:()=>p(e)}))}]});return Object(u.jsx)(i.a.Fragment,null,Object(u.jsx)(s.EuiSpacer,{size:"s"}),Object(u.jsx)(s.EuiInMemoryTable,{className:"job-messages-table",items:e,columns:m,sorting:{sort:{field:"timestamp",direction:"desc"}},compressed:!0,loading:t,error:a,pagination:!0,"data-test-subj":"mlAnalyticsDetailsJobMessagesTable"}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n.c})),a.d(t,"b",(function(){return n.d})),a.d(t,"c",(function(){return r}));var n=a(157),i=a(16),s=a(12);const r=e=>{const t=Object(n.e)(),a=Object(i.useCallback)((e=>{t(e)}),[]);return{action:Object(i.useMemo)((()=>({name:()=>Object(s.jsx)(n.a,{isDisabled:!e}),enabled:()=>e,description:n.b,icon:"copy",type:"icon",onClick:a,"data-test-subj":"mlAnalyticsJobCloneButton"})),[])}}},function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(16),i=a(44),s=a(61),r=a(2),o=a(12);function l(e){return null!==e?r.i18n.translate("xpack.ml.jobSelector.filterBar.invalidSearchErrorMessage",{defaultMessage:"Invalid search: {errorMessage}",values:{errorMessage:e.message}}):""}function c({checkboxDisabledCheck:e,columns:t,currentPage:a=0,filterDefaultFields:c,filters:d,items:u,itemsPerPage:p=20,onTableChange:m,radioDisabledCheck:b,selectedIds:f,setCurrentPaginationData:h,singleSelection:g,sortableProperties:j,tableItemId:x="id"}){const[v,y]=Object(n.useState)(R()),[O,E]=Object(n.useState)(u),[w,M]=Object(n.useState)(f),[S,_]=Object(n.useState)(""),[T,C]=Object(n.useState)(),[k,F]=Object(n.useState)({itemsPerPage:p,firstItemIndex:0,lastItemIndex:1}),[I,D]=Object(n.useState)(i.EuiSearchBar.Query.MATCH_ALL),[A,L]=Object(n.useState)(null);function R(){const e={all:!1};return f.forEach((t=>{e[t]=!0})),e}function N({isSelected:e,itemId:t}){const a=Object.getOwnPropertyNames(v),n=O.map((e=>e[x]));let i=a.filter((e=>!0===v[e]&&e!==t));"all"!==t?!0===e&&i.push(t):!1===e?i=i.filter((e=>!1===n.includes(e))):(i=[...i,...n],i=[...new Set(i)]),h&&h({pageIndex:T.getCurrentPageIndex(),itemsPerPage:k.itemsPerPage}),m(i)}function P({query:e,error:t}){if(t)L(t);else{const t=i.EuiSearchBar.Query.execute(e,u,{defaultFields:c});L(null),E(t),D(e)}}function z(e){return!0===v[e]}function B(){return-1===O.findIndex((e=>!z(e[x])))}Object(n.useEffect)((()=>{E(u),P({query:I})}),[u]),Object(n.useEffect)((()=>{y(R())}),[f]),Object(n.useEffect)((()=>{const e=new s.Pager(O.length,p,a);F({itemsPerPage:p,firstItemIndex:e.getFirstItemIndex(),lastItemIndex:e.getLastItemIndex()}),C(e)}),[O]);const J=Object(n.useMemo)((()=>Object(i.htmlIdGenerator)()()),[]);function V(e){const t=r.i18n.translate("xpack.ml.jobSelector.customTable.selectAllCheckboxLabel",{defaultMessage:"Select all"});return Object(o.jsx)(i.EuiCheckbox,{id:`${e?"mobile-":""}${J}`,label:e?t:null,checked:B(),onChange:G,type:e?null:"inList"})}function U(e){if(g){const t=w[0];y({...v,[t]:!1,[e]:!0}),function(e){m([e])}(e),M([e])}else{const t=!z(e);y({...v,[e]:t}),N({isSelected:t,itemId:e})}}function G(){const e=B()||!0===v.all,t={};O.forEach((a=>t[a[x]]=!e)),y(t),N({isSelected:!e,itemId:"all"})}return Object(o.jsx)(n.Fragment,null,Object(o.jsx)(i.EuiSpacer,{size:"s"}),Object(o.jsx)(i.EuiFlexGroup,{direction:"column"},Object(o.jsx)(i.EuiFlexItem,{grow:!1,"data-test-subj":"mlCustomSelectionTableSearchBar"},Object(o.jsx)(i.EuiSearchBar,{defaultQuery:I,box:{incremental:!0,placeholder:r.i18n.translate("xpack.ml.jobSelector.customTable.searchBarPlaceholder",{defaultMessage:"Search..."})},filters:d,onChange:P}),Object(o.jsx)(i.EuiFormRow,{fullWidth:!0,isInvalid:null!==A,error:l(A),style:{maxHeight:"0px"}},Object(o.jsx)(n.Fragment,null)))),Object(o.jsx)(i.EuiSpacer,{size:"m"}),Object(o.jsx)(i.EuiTableHeaderMobile,null,Object(o.jsx)(i.EuiFlexGroup,{responsive:!1,justifyContent:"spaceBetween",alignItems:"baseline"},Object(o.jsx)(i.EuiFlexItem,{grow:!1},V(!0)))),Object(o.jsx)(i.EuiTable,{"data-test-subj":"mlCustomSelectionTable"},Object(o.jsx)(i.EuiTableHeader,null,function(){const e=[];return t.forEach(((a,n)=>{a.isCheckbox&&!g?e.push(Object(o.jsx)(i.EuiTableHeaderCellCheckbox,{key:a.id,width:a.width},V())):e.push(Object(o.jsx)(i.EuiTableHeaderCell,{key:a.id,align:t[n].alignment,width:a.width,onSort:a.isSortable?()=>function(e){j.sortOn(e);const t=j.sortItems(O);E(t),_(e)}(a.id):void 0,isSorted:S===a.id,isSortAscending:!j||j.isAscendingByName(a.id),mobileOptions:a.mobileOptions},a.label))})),e.length?e:null}()),Object(o.jsx)(i.EuiTableBody,null,function(){const a=a=>{const n=t.map((t=>{const n=a[t.id];let s;return t.isCheckbox?Object(o.jsx)(i.EuiTableRowCellCheckbox,{key:t.id},!g&&Object(o.jsx)(i.EuiCheckbox,{disabled:void 0!==e?e(a):void 0,id:`${a[x]}-checkbox`,"data-test-subj":`${a[x]}-checkbox`,checked:z(a[x]),onChange:()=>U(a[x]),type:"inList"}),g&&Object(o.jsx)(i.EuiRadio,{id:a[x],"data-test-subj":`${a[x]}-radio-button`,checked:z(a[x]),onChange:()=>U(a[x]),disabled:void 0!==b?b(a):void 0})):(s=t.render?t.render(a):n,Object(o.jsx)(i.EuiTableRowCell,{key:t.id,align:t.alignment,truncateText:n&&n.truncateText,textOnly:!n||n.textOnly,mobileOptions:{header:t.label,...t.mobileOptions}},s))}));return Object(o.jsx)(i.EuiTableRow,{key:a[x],isSelected:z(a[x]),isSelectable:!0,hasActions:!0,"data-test-subj":`mlCustomSelectionTableRow row-${a[x]}`},n)},n=[];for(let e=k.firstItemIndex;e<=k.lastItemIndex;e++){const t=O[e];if(void 0===t)break;n.push(a(t))}return n}())),Object(o.jsx)(i.EuiSpacer,{size:"m"}),void 0!==T&&Object(o.jsx)(i.EuiTablePagination,{activePage:T.getCurrentPageIndex(),itemsPerPage:k.itemsPerPage,itemsPerPageOptions:[5,10,20,50],pageCount:T.getTotalPages(),onChangeItemsPerPage:function(e){T.setItemsPerPage(e),F({...k,itemsPerPage:e,firstItemIndex:T.getFirstItemIndex(),lastItemIndex:T.getLastItemIndex()})},onChangePage:e=>function(e){T.goToPageIndex(e),F({...k,firstItemIndex:T.getFirstItemIndex(),lastItemIndex:T.getLastItemIndex()})}(e)}))}},function(e,t,a){"use strict";a.d(t,"a",(function(){return n.b})),a.d(t,"b",(function(){return h}));var n=a(127),i=a(16),s=a(2),r=a(27),o=a(73),l=a(102),c=a(47),d=a(81),u=a(403),p=a(310),m=a(311);async function b(e){let t,a;try{t=await o.ml.checkIndicesExists({indices:[e]})}catch(e){a=Object(r.b)(e)}return{resp:t,errorMessage:a}}function f(e=1e3){return new Promise((t=>{setTimeout(t,e)}))}const h=()=>{const e=Object(l.b)(),[t,a]=Object(i.useReducer)(m.b,Object(n.e)()),{refresh:h}=Object(d.w)(),{form:g,jobConfig:j,isAdvancedEditorEnabled:x}=t,{createIndexPattern:v,jobId:y}=g;let{destinationIndex:O}=g;const E=e=>a({type:p.a.ADD_REQUEST_MESSAGE,requestMessage:e}),w=async()=>{const t=O,a=await async function(e){let t=15,a=await b(e),n=a.resp&&a.resp[e]&&a.resp[e].exists;for(;t>1&&!n;)t--,await f(1e3),a=await b(e),n=a.resp&&a.resp[e]&&a.resp[e].exists;return n?{success:!0,indexExists:!0}:{success:!1,indexExists:!1,...void 0!==a.errorMessage?{errorMessage:a.errorMessage}:{}}}(O);if(!0===(null==a?void 0:a.success)){if(!0===(null==a?void 0:a.indexExists))try{await e.dataViewsContract.createAndSave({title:t},!1,!0),E({message:s.i18n.translate("xpack.ml.dataframe.analytics.create.createDataViewSuccessMessage",{defaultMessage:"Kibana data view {dataViewName} created.",values:{dataViewName:t}})})}catch(e){e instanceof c.DuplicateDataViewError?E({error:s.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateDataViewErrorMessageError",{defaultMessage:"The data view {dataViewName} already exists.",values:{dataViewName:t}}),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.duplicateDataViewErrorMessage",{defaultMessage:"An error occurred creating the Kibana data view:"})}):E({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.createDataViewErrorMessage",{defaultMessage:"An error occurred creating the Kibana data view:"})})}}else null!=a&&a.errorMessage?E({error:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorCheckingDestinationIndexDataFrameAnalyticsJob",{defaultMessage:"{errorMessage}",values:{errorMessage:a.errorMessage}}),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorOccurredCheckingDestinationIndexDataFrameAnalyticsJob",{defaultMessage:"An error occurred checking destination index exists."})}):E({error:s.i18n.translate("xpack.ml.dataframe.analytics.create.destinationIndexNotCreatedForDataFrameAnalyticsJob",{defaultMessage:"Destination index has not yet been created."}),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.unableToCreateDataViewForDataFrameAnalyticsJob",{defaultMessage:"Unable to create data view."})})},M=async()=>{try{const n={};(await e.dataViewsContract.getCache()||[]).forEach((e=>{var t;const a=null==e||null===(t=e.attributes)||void 0===t?void 0:t.title;if(void 0!==a){const t=(null==e?void 0:e.id)||"";n[a]={label:a,value:t}}})),t={indexPatternsMap:n},a({type:p.a.SET_INDEX_PATTERN_TITLES,payload:t})}catch(e){E({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorGettingDataViewNames",{defaultMessage:"An error occurred getting the existing data view names:"})})}var t},S=e=>{a({type:p.a.SET_FORM_STATE,payload:e})},_=()=>{a({type:p.a.SWITCH_TO_ADVANCED_EDITOR})},T=e=>{a({type:p.a.SET_ESTIMATED_MODEL_MEMORY_LIMIT,value:e})};return{state:t,actions:{closeModal:()=>a({type:p.a.CLOSE_MODAL}),createAnalyticsJob:async()=>{a({type:p.a.RESET_REQUEST_MESSAGES});const e=x?j:Object(n.f)(g);x&&(O=e.dest.index);try{return await o.ml.dataFrameAnalytics.createDataFrameAnalytics(y,e),E({message:s.i18n.translate("xpack.ml.dataframe.stepCreateForm.createDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to create data frame analytics {jobId} acknowledged.",values:{jobId:y}})}),t=!0,a({type:p.a.SET_IS_JOB_CREATED,isJobCreated:t}),v&&w(),h(),!0}catch(e){return E({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorCreatingDataFrameAnalyticsJob",{defaultMessage:"An error occurred creating the data frame analytics job:"})}),!1}var t},initiateWizard:async()=>{await e.dataViewsContract.clearCache(),await M()},resetAdvancedEditorMessages:()=>a({type:p.a.RESET_ADVANCED_EDITOR_MESSAGES}),setAdvancedEditorRawString:e=>a({type:p.a.SET_ADVANCED_EDITOR_RAW_STRING,advancedEditorRawString:e}),setFormState:S,setJobConfig:e=>{a({type:p.a.SET_JOB_CONFIG,payload:e})},startAnalyticsJob:async()=>{try{const t=await o.ml.dataFrameAnalytics.startDataFrameAnalytics(y);if(!0!==t.acknowledged)throw new Error(t);E({message:s.i18n.translate("xpack.ml.dataframe.analytics.create.startDataFrameAnalyticsSuccessMessage",{defaultMessage:"Request to start data frame analytics {jobId} acknowledged.",values:{jobId:y}})}),e=!0,a({type:p.a.SET_IS_JOB_STARTED,isJobStarted:e}),h()}catch(e){E({error:Object(r.b)(e),message:s.i18n.translate("xpack.ml.dataframe.analytics.create.errorStartingDataFrameAnalyticsJob",{defaultMessage:"An error occurred starting the data frame analytics job:"})})}var e},switchToAdvancedEditor:_,switchToForm:()=>{a({type:p.a.SWITCH_TO_FORM})},setEstimatedModelMemoryLimit:T,setJobClone:async e=>{a({type:p.a.RESET_FORM});const t=Object(u.a)(e);Object(u.b)(t)?(S(Object(n.d)(t)),_()):(S(Object(n.d)(t)),T(t.model_memory_limit)),a({type:p.a.SET_JOB_CLONE,cloneJob:e})}}}}},,,,,,,,,,,,,,,,,,,,,function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(427);case"v8light":return a(429)}},function(e,t,a){var n=a(78),i=a(428);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #343741}.ml-app .ml-icon-severity-critical{color:#FE5050}.ml-app .ml-icon-severity-major{color:#FBA740}.ml-app .ml-icon-severity-minor{color:#FDEC25}.ml-app .ml-icon-severity-warning{color:#8BC8FB}.ml-app .ml-icon-severity-unknown{color:#98A2B3}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#F3D371;border:1px solid #343741;border-radius:6px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#98A2B3}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#98A2B3;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#98A2B3;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#98A2B3;font-size:12px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#1D1E24;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#98A2B3;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#98A2B3}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#343741;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#36A2EF;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#36A2EF;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#535966}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#36A2EF;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#36A2EF}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#1D1E24}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#25262E;border:1px solid #343741;border-radius:6px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #343741}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#1D1E24}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #1D1E24;border-radius:6px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .inline-group{font-size:12px;background-color:#343741;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#1D1E24;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F86B63}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#343741;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #343741;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#F86B63}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #343741;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #1D1E24;border-radius:6px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #98A2B3;box-shadow:0 1px 2px #535966}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .ml-time-series-explorer{color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#98A2B3}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#7DDED8;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#343741;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#343741;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#98A2B3;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(54,162,239,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#36A2EF;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#36A2EF;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#36A2EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#25262E}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#36A2EF;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#DFE5EF}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#535966}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#98A2B3;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#1D1E24}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #98A2B3;background-color:#343741;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#98A2B3;fill:#343741;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#1D1E24}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#1D1E24}.ml-app .mlAnnotationBrush .extent{stroke:#343741;stroke-width:2px;stroke-dasharray:2 2;fill:#25262E;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#fff;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#535966;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#343741;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#25262E;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#fff;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#fff;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#FE5050}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#FBA740}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#FDEC25}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#8BC8FB}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#98A2B3}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.71429rem;fill:#98A2B3}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#535966;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#98A2B3;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#98A2B3;font-size:11px;line-height:14px;border-radius:6px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #343741}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#DFE5EF;font-weight:700;border-bottom:1px solid #343741;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#343741}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#25262E}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#1D1E24}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),e.exports=t},function(e,t,a){var n=a(78),i=a(430);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,'.ml-app .ml-icon-severity-critical,.ml-app .ml-icon-severity-major,.ml-app .ml-icon-severity-minor,.ml-app .ml-icon-severity-warning,.ml-app .ml-icon-severity-unknown{text-shadow:1px 1px 1px #D3DAE6}.ml-app .ml-icon-severity-critical{color:#cf4141}.ml-app .ml-icon-severity-major{color:#9e6929}.ml-app .ml-icon-severity-minor{color:#7c7313}.ml-app .ml-icon-severity-warning{color:#537896}.ml-app .ml-icon-severity-unknown{color:#69707D}.ml-app .mlDataFrameAnalyticsRegression__evaluateStat{padding-top:24px}.ml-app .mlJobMapLegend__container{background-color:\'#FFFFFF\'}.ml-app .mlJobMapLegend__indexPattern{height:12px;width:12px;background-color:#fff;border:2px solid #D36086;transform:rotate(45deg);display:\'inline-block\'}.ml-app .mlJobMapLegend__transform{height:12px;width:12px;background-color:#fff;border:2px solid #6092C0;display:\'inline-block\'}.ml-app .mlJobMapLegend__analytics{height:12px;width:12px;background-color:#fff;border:2px solid #54B399;border-radius:50%;display:\'inline-block\'}.ml-app .mlJobMapLegend__sourceNode{height:12px;width:12px;background-color:#FEC514;border:1px solid #D3DAE6;border-radius:6px;display:\'inline-block\'}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent{animation:none !important}.ml-app .mlAnalyticsTable .euiTableRow-isExpandedRow .euiTableCellContent .euiTableCellContent__text{width:100%}.ml-app .mlAnalyticsTable .euiIcon-isLoaded{animation:none !important}.ml-app .mlTaskStateBadge,.ml-app .mlTaskModeBadge{max-width:100px}.ml-app .dataFrameAnalyticsCreateSearchDialog{width:720px;min-height:600px}.ml-app .dfAnalyticsCreationWizard__card{width:300px}.ml-app .ml-explorer{width:100%;display:inline-block;color:#69707D}.ml-app .ml-explorer .results-container{padding:0 0 16px 0}.ml-app .ml-explorer .results-container .col-xs-12{width:calc(100% - 32px);padding-left:16px}.ml-app .ml-explorer .results-container .no-influencers-warning{float:left;padding-top:4px;padding-left:16px;color:#69707D;font-size:14px}.ml-app .ml-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#69707D;display:inline-block;padding-bottom:4px}.ml-app .ml-explorer .results-container .panel-sub-title{color:#69707D;font-size:12px}.ml-app .mlSwimLaneContainer .echLegendListContainer{height:34px !important}.ml-app .mlSwimLaneContainer .echLegendList{display:flex !important;justify-content:space-between !important;flex-wrap:nowrap;position:absolute;right:0}.ml-app .ml-explorer-chart-eui-icon-tip{max-width:none}.ml-app .ml-explorer-chart-label-badges{margin-top:4px;display:flex;align-items:center}.ml-app .ml-reset-font-weight{font-weight:normal}.ml-app .ml-explorer-chart-container{overflow:hidden}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect{fill:#fff;opacity:1}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.selected-interval{fill:rgba(200,200,200,0.1);stroke:#69707D;stroke-width:2px;stroke-opacity:.8}.ml-app .ml-explorer-chart-container .ml-explorer-chart-svg .line-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-explorer-chart-container .axis path,.ml-app .ml-explorer-chart-container .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges}.ml-app .ml-explorer-chart-container .axis .tick line.ml-tick-emphasis{stroke:rgba(0,0,0,0.2)}.ml-app .ml-explorer-chart-container .axis text{fill:#69707D}.ml-app .ml-explorer-chart-container .axis .tick line{stroke:#D3DAE6;stroke-width:1px}.ml-app .ml-explorer-chart-container .values-line{fill:none;stroke:#07C;stroke-width:2}.ml-app .ml-explorer-chart-container .values-dots circle,.ml-app .ml-explorer-chart-container .values-dots-circle{fill:#07C;stroke-width:0}.ml-app .ml-explorer-chart-container .values-dots circle.values-dots-circle-blur{fill:#98A2B3}.ml-app .ml-explorer-chart-container .metric-value{opacity:1;fill:transparent;stroke:#07C;stroke-width:0}.ml-app .ml-explorer-chart-container .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke:#07C}.ml-app .ml-explorer-chart-container .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-explorer-chart-container .anomaly-marker.major{fill:#FBA740}.ml-app .ml-explorer-chart-container .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-explorer-chart-container .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-explorer-chart-container .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-explorer-chart-container .metric-value:hover,.ml-app .ml-explorer-chart-container .anomaly-marker:hover{stroke-width:6px;stroke-opacity:.65}.ml-app .ml-explorer-chart{overflow:hidden}.ml-app .ml-explorer-chart-content-wrapper{height:215px}.ml-app .ml-explorer-chart-axis-emphasis{font-weight:bold}.ml-app .explorer-charts ml-explorer-charts-container .row{padding:10px}.ml-app .explorer-charts ml-explorer-charts-container label{font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container select{font-size:14px;font-style:400}.ml-app .explorer-charts ml-explorer-charts-container .chart-controls label{padding:0 0 10px 0}.ml-app .explorer-charts ml-explorer-charts-container .no-results-item{text-align:center;padding-top:10px}.ml-app .explorer-charts ml-explorer-charts-container .ml-anomaly-interim-result{font-style:italic;padding-bottom:3px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded{width:100%;padding:5px 20px;overflow:hidden;font-size:12px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td{padding:0 0 2px 0}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded table tr>td:first-child{padding-left:2px;vertical-align:top}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:first-child{width:140px}.ml-app .explorer-charts ml-explorer-charts-container .ml-tablerow-expanded td:nth-child(2){padding-left:5px}.ml-app .ml-explorer-chart-icons{float:right;padding-left:5px;margin:2px -8px 0 0}.ml-app .ml-edit-url-form .url-label{width:250px}.ml-app .ml-edit-url-form .url-link-to-radio .euiRadio{display:inline-block;padding-right:24px}.ml-app .ml-edit-url-form .url-time-range{width:150px}.ml-app .new-job-button-container{float:right}.ml-app .edit-custom-url-panel .close-editor-button{position:relative;float:right;top:-4px;right:0}.ml-app .tab-contents{margin:-8px;padding:8px;background-color:#fff}.ml-app .tab-contents .col-md-6:nth-child(1){padding-right:7px}.ml-app .tab-contents .col-md-6:nth-child(2){padding-left:7px}.ml-app .tab-contents .job-section{overflow:auto;padding:5px 15px;background-color:#F5F7FA;border:1px solid #D3DAE6;border-radius:6px;margin:4px 0}.ml-app .tab-contents .job-section .euiTable{background-color:transparent}.ml-app .tab-contents .job-section .euiTable .euiTableRow:first-child .euiTableRowCell{border-top:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow:last-child .euiTableRowCell{border-bottom:0}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell{vertical-align:top;border-bottom:1px solid #D3DAE6}.ml-app .tab-contents .job-section .euiTable .euiTableRow .euiTableRowCell .euiTableCellContent__text{word-wrap:break-word}.ml-app .tab-contents .job-section .euiTable .euiTableRow:hover{background-color:inherit}.ml-app .tab-contents .job-section .job-item{font-size:12px}.ml-app .tab-contents .job-section .job-item.header{font-weight:bold}.ml-app .tab-contents .json-textarea{height:500px}.ml-app .job-messages-table{max-height:500px;overflow:auto;text-align:left}.ml-app .job-messages-table tr:last-child td{border-bottom:none}.ml-app .job-messages-table .euiTableRowCell{background-color:#fff}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .group-item{padding:8px 16px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .inline-group{border:1px solid #fff;border-radius:6px}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus{text-decoration:none}.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:hover .inline-group,.ml-app .mlJobFilterBar .euiFilterGroup .euiPopover .euiPanel .euiFilterSelectItem:focus .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .inline-group{font-size:12px;background-color:#D3DAE6;padding:2px 5px;border-radius:2px;display:inline-block;margin:0 3px;color:#fff;vertical-align:text-top}.ml-app .jobs-list-table>div>.euiTable>thead th{text-align:left;white-space:normal}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(2){width:34px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(3){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(4){width:20px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(5){width:auto}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(6){width:100px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(7){width:85px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(8){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(9){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(10){width:150px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(11){width:80px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12){width:30px}.ml-app .jobs-list-table>div>.euiTable>thead th:nth-child(12) .euiTableCellContent__text{display:none}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(4) .euiTableCellContent{padding:0}.ml-app .jobs-list-table>div>.euiTable>tbody td:nth-child(10){white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableCellContent{animation:unset}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text{width:100%}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow.euiTableRow-isExpandedRow>td>div>.euiTableCellContent__text .euiTableRowCell{background-color:inherit}.ml-app .jobs-list-table>div>.euiTable>tbody .euiTableRow>.euiTableRowCell>.euiTableCellContent>.euiTableCellContent__hoverItem{opacity:1}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem{white-space:nowrap}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .jobs-list-table>div>.euiTable>tbody .results-button{margin-right:4px;width:18px}.ml-app .jobs-list-table>div>.euiTable>tbody .euiContextMenuItem .euiIcon{margin-right:4px}.ml-app .jobs-list-table>div>.euiTable .job-description{display:inline-block}.ml-app .jobs-list-table>div>.euiTable .job-loading-spinner{text-align:center}.ml-app .jobs-list-table.jobs-selected .results-button{color:#D3DAE6;pointer-events:none}.ml-app .actions-bar{min-height:60px;display:flex;align-items:center}.ml-app .job-management{padding:20px}.ml-app .multi-select-actions .actions-border,.ml-app .multi-select-actions .actions-border-large{height:20px;border-right:1px solid #D3DAE6;width:1px;display:inline-block;vertical-align:middle;margin:0 5px}.ml-app .multi-select-actions .actions-border-large{height:35px;margin:0 15px}.ml-app .multi-select-actions .results-button{margin-right:5px}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem__text{white-space:nowrap}.ml-app .multi-select-actions .euiContextMenuPanel .euiContextMenuItem:last-child:not(.euiContextMenuItem-isDisabled){color:#BD271E}.ml-app .multi-select-actions-no-display{display:none}.ml-app .group-selector{max-width:300px}.ml-app .group-selector .euiPopoverTitle{margin-bottom:8px !important}.ml-app .group-list{max-height:350px;overflow:auto}.ml-app .group-list .group-item{line-height:18px;padding:6px 0;border-bottom:1px solid #D3DAE6;cursor:pointer}.ml-app .group-list .group-item:focus{background-color:#EEF6F9;box-shadow:none}.ml-app .group-list .group-item .check{width:20px;display:inline-block}.ml-app .group-list .group-item .inline-group{border:1px solid #fff;border-radius:6px}.ml-app .group-list .group-item:hover .inline-group{border:1px solid #69707D;box-shadow:0 1px 2px #98A2B3}.ml-app .group-list .group-item:last-child{margin-bottom:0;border-bottom:none}.ml-app .new-group-input{padding-bottom:0}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:first-child{max-width:388px}.ml-app .ml-custom-urls-selection>.euiFlexGroup>.euiFlexItem:last-child{flex-basis:50%}.ml-app .mlOverviewPanel__isLoading{text-align:center;padding:10%}.ml-app .mlOverviewPanel__spinner{display:inline-block}.ml-app .ml-time-series-explorer{color:#69707D}.ml-app .ml-time-series-explorer .results-container .panel-title{font-size:16px;font-weight:400;color:#69707D}.ml-app .ml-time-series-explorer .results-container .entity-count-text{color:#00BFB3;font-size:14px}.ml-app .ml-time-series-explorer .forecast-controls{float:right}.ml-app .ml-time-series-explorer .ml-timeseries-chart svg{font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol"}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis path,.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis line{fill:none;stroke:#D3DAE6;shape-rendering:crispEdges;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis text{fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .axis .tick line{stroke:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border{stroke:#D3DAE6;fill:none;stroke-width:1;shape-rendering:crispEdges}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight{stroke:#69707D;stroke-width:2}.ml-app .ml-time-series-explorer .ml-timeseries-chart .chart-border-highlight:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.bounds{fill:rgba(0,119,204,0.2);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line{fill:none;stroke:#07C;stroke-width:2;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .values-line.forecast{stroke:#D6BF57;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .hidden{visibility:hidden}.ml-app .ml-time-series-explorer .ml-timeseries-chart .area.forecast{fill:rgba(214,191,87,0.3);pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value{opacity:1;fill:transparent;stroke:#07C;stroke-width:0}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker{stroke-width:1px;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.critical{fill:#FE5050}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.major{fill:#FBA740}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.minor{fill:#FDEC25}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.warning{fill:#8BC8FB}.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.low{fill:#D2E9F7}.ml-app .ml-time-series-explorer .ml-timeseries-chart .metric-value:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .anomaly-marker.highlighted{stroke-width:6px;stroke-opacity:.65;stroke:#07C}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.scheduled-event-marker{stroke-width:1px;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value,.ml-app .ml-time-series-explorer .ml-timeseries-chart .forecast .metric-value:hover{stroke:#D6BF57}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background line{fill:none;shape-rendering:crispEdges;stroke:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .x-axis-background rect{fill:#F5F7FA}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom{fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a text{fill:#07C;cursor:pointer}.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:hover,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:active,.ml-app .ml-time-series-explorer .ml-timeseries-chart .focus-chart .focus-zoom a:focus{text-decoration:underline}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .x.axis path{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .axis text{font-size:10px;fill:#343741}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .values-line{stroke-width:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask polygon{fill-opacity:.1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .area.bounds{fill:#D3DAE6}.ml-app .ml-time-series-explorer .ml-timeseries-chart .context-chart .mask .values-line{stroke-width:1;stroke:#98A2B3}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane .axis text{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .swimlane rect.swimlane-cell-hidden{display:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent{fill-opacity:0;shape-rendering:crispEdges;stroke:#69707D;stroke-width:2;cursor:move}.ml-app .ml-time-series-explorer .ml-timeseries-chart .brush .extent:hover{opacity:1}.ml-app .ml-time-series-explorer .ml-timeseries-chart .top-border{fill:#fff}.ml-app .ml-time-series-explorer .ml-timeseries-chart foreignObject.brush-handle{pointer-events:none;padding-top:1px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner{border:1px solid #69707D;background-color:#D3DAE6;height:70px;width:10px;text-align:center;cursor:ew-resize;margin-top:9px;font-size:14px;fill:#69707D}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-left{border-radius:6px 0 0 6px}.ml-app .ml-time-series-explorer .ml-timeseries-chart div.brush-handle-inner-right{border-radius:0 6px 6px 0}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle{stroke-width:1;stroke:#69707D;fill:#D3DAE6;pointer-events:none}.ml-app .ml-time-series-explorer .ml-timeseries-chart rect.brush-handle:hover{opacity:1}.ml-app .mlTimeSeriesExplorerProgress{background-color:#fff}.ml-app .mlTimeSeriesExplorerProgress::-moz-progress-bar,.ml-app .mlTimeSeriesExplorerProgress::-webkit-progress-bar{background-color:#fff}.ml-app .mlAnnotationBrush .extent{stroke:#D3DAE6;stroke-width:2px;stroke-dasharray:2 2;fill:#F5F7FA;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlAnnotationRect-isHighlight{stroke-opacity:.4;transition:stroke-opacity 150ms;fill-opacity:.1;transition:fill-opacity 150ms}.ml-app .mlAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .mlAnnotationText{text-anchor:middle;font-size:12px;font-family:"Inter",-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-weight:500;fill:#000;transition:fill 150ms;-webkit-user-select:none;user-select:none}.ml-app .mlAnnotationText-isBlur{fill:#98A2B3;transition:fill 150ms}.ml-app .mlAnnotationTextRect{fill:#D3DAE6;transition:fill 150ms}.ml-app .mlAnnotationTextRect-isBlur{fill:#F5F7FA;transition:fill 150ms}.ml-app .mlAnnotationHidden{display:none}.ml-app .mlContextAnnotationRect{stroke:#000;stroke-width:2px;stroke-opacity:.2;transition:stroke-opacity 150ms;fill:#000;fill-opacity:.05;transition:fill-opacity 150ms;shape-rendering:geometricPrecision}.ml-app .mlContextAnnotationRect-isBlur{stroke-opacity:.1;transition:stroke-opacity 150ms;fill-opacity:.025;transition:fill-opacity 150ms}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__title{flex-basis:30%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list .euiDescriptionList__description{flex-basis:70%}.ml-app .euiDescriptionList.euiDescriptionList--column.ml-annotation-description-list>*{margin-top:4px}.ml-app .ml-anomalies-table .ml-icon-severity-critical,.ml-app .ml-anomalies-table .ml-icon-severity-major,.ml-app .ml-anomalies-table .ml-icon-severity-minor,.ml-app .ml-anomalies-table .ml-icon-severity-warning,.ml-app .ml-anomalies-table .ml-icon-severity-unknown{color:inherit;text-shadow:none}.ml-app .ml-anomalies-table .ml-icon-severity-critical .euiIcon{fill:#cf4141}.ml-app .ml-anomalies-table .ml-icon-severity-major .euiIcon{fill:#9e6929}.ml-app .ml-anomalies-table .ml-icon-severity-minor .euiIcon{fill:#7c7313}.ml-app .ml-anomalies-table .ml-icon-severity-warning .euiIcon{fill:#537896}.ml-app .ml-anomalies-table .ml-icon-severity-unknown .euiIcon{fill:#69707D}.ml-app .ml-anomalies-table tr th:first-child,.ml-app .ml-anomalies-table tr td:first-child{width:32px}.ml-app .ml-anomalies-table .euiTableCellContent .euiHealth{font-size:inherit}.ml-app .ml-anomalies-table .euiTableCellContent .detector-rules-icon{margin-left:4px;opacity:.5}.ml-app .ml-anomalies-table .euiContextMenuItem{min-width:150px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__header{display:inline}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__link{width:100%}.ml-app .ml-anomalies-table .category-example{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples{padding:24px}.ml-app .ml-anomalies-table .mlAnomalyCategoryExamples__item{display:block;white-space:wrap;font-family:"Roboto Mono",Consolas,Menlo,Courier,monospace}.ml-app .ml-anomalies-table .interim-result{font-style:italic}.ml-app .ml-anomalies-table .ml-anomalies-table-details{padding:4px 32px;max-height:1000px;overflow-y:auto}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__title{margin-top:0;flex-basis:15%;font-size:inherit;line-height:1.5rem;max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important}.ml-app .ml-anomalies-table .ml-anomalies-table-details .anomaly-description-list .euiDescriptionList__description{margin-top:0;flex-basis:85%;font-size:inherit;line-height:1.5rem}.ml-app .mlColorRangeLegend text{font-size:10px;font-size:.71429rem;fill:#69707D}.ml-app .mlColorRangeLegend .axis path{fill:none;stroke:none}.ml-app .mlColorRangeLegend .axis line{fill:none;stroke:#98A2B3;shape-rendering:crispEdges}.ml-app .ml-table-controls label{font-size:12px;padding:0 0 4px 4px}.ml-app .ml-table-controls .ml-table-controls-element{display:inline-block;padding-left:16px}.ml-app .ml-table-controls select{font-size:12px;font-style:normal}.ml-app .ml-select-severity .euiFormControlLayoutClearButton{display:none}.ml-app .field-value-short{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .field-value-long{overflow-wrap:break-word}.ml-app .filter-button{opacity:.5;width:16px;height:16px;transform:translateY(-1px)}.ml-app .filter-button .euiIcon{width:12px;height:12px}.ml-app .filter-button:hover{opacity:1}.ml-app .ml-influencers-list{line-height:1.45}.ml-app .ml-influencers-list .field-label{font-size:12px;text-align:left;max-height:14px;max-width:calc(100% - 102px)}.ml-app .ml-influencers-list .field-label .field-value{max-width:100%;overflow:hidden !important;text-overflow:ellipsis !important;white-space:nowrap !important;word-wrap:normal !important;display:inline-block;vertical-align:bottom}.ml-app .ml-influencers-list .progress{display:inline-block;width:calc(100% - 34px);height:22px;min-width:70px;margin-bottom:0;color:#69707D;background-color:transparent}.ml-app .ml-influencers-list .progress .progress-bar-holder{width:calc(100% - 28px)}.ml-app .ml-influencers-list .progress .progress-bar{height:2px;margin-top:12px;text-align:right;line-height:18px;display:inline-block;transition:none}.ml-app .ml-influencers-list .progress.critical .progress-bar{background-color:#FE5050}.ml-app .ml-influencers-list .progress.critical .score-label{border-color:#FE5050}.ml-app .ml-influencers-list .progress.major .progress-bar{background-color:#FBA740}.ml-app .ml-influencers-list .progress.major .score-label{border-color:#FBA740}.ml-app .ml-influencers-list .progress.minor .progress-bar{background-color:#FDEC25}.ml-app .ml-influencers-list .progress.minor .score-label{border-color:#FDEC25}.ml-app .ml-influencers-list .progress.warning .progress-bar{background-color:#8BC8FB}.ml-app .ml-influencers-list .progress.warning .score-label{border-color:#8BC8FB}.ml-app .ml-influencers-list .score-label{text-align:center;line-height:14px;white-space:nowrap;font-size:12px;display:inline;margin-left:4px}.ml-app .ml-influencers-list .total-score-label{width:32px;vertical-align:top;text-align:center;color:#69707D;font-size:11px;line-height:14px;border-radius:6px;padding:2px;margin-top:4px;display:inline-block;border:1px solid #D3DAE6}.ml-app .ml-influencers-list-tooltip{word-break:break-all}.ml-app .ml-items-grid-page-size-menu{width:140px}.ml-app .mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.ml-app .mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.ml-app .mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.ml-app .mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.ml-app .mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}.ml-app .ml-loading-indicator{text-align:center;font-size:17px;display:flex;flex-direction:column;align-items:center;justify-content:center}.ml-app .ml-rule-editor-flyout{font-size:14px}.ml-app .ml-rule-editor-flyout .select-rule-action .rule-detector-description-list{padding-left:16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel{padding:8px 0}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title{flex-basis:15%;padding:0 16px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description{flex-basis:85%}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(1),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(2){color:#1a1c21;font-weight:700;border-bottom:1px solid #D3DAE6;padding-bottom:12px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__title:nth-child(3),.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList .euiDescriptionList__description:nth-child(4){padding-top:8px}.ml-app .ml-rule-editor-flyout .select-rule-action-panel .euiDescriptionList.euiDescriptionList--column>*{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-enable-checkbox .euiCheckbox__input[disabled] ~ .euiCheckbox__label{color:inherit}.ml-app .ml-rule-editor-flyout .scope-field-checkbox{margin-right:2px}.ml-app .ml-rule-editor-flyout .scope-field-checkbox .euiCheckbox{margin-top:4px}.ml-app .ml-rule-editor-flyout .scope-field-button{pointer-events:none;border-bottom:none}.ml-app .ml-rule-editor-flyout .scope-edit-filter-link{line-height:32px;font-size:12px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field{width:170px;height:28px;margin:0 2px}.ml-app .ml-rule-editor-flyout .condition-edit-value-field input{height:28px}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled{pointer-events:none}.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__value,.ml-app .ml-rule-editor-flyout .euiExpressionButton.disabled .euiExpressionButton__description{color:#D3DAE6}.ml-app .ml-rule-editor-flyout .text-highlight{font-weight:700}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__title{flex-basis:15%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list .euiDescriptionList__description{flex-basis:85%}.ml-app .euiDescriptionList.euiDescriptionList--column.rule-detector-description-list>*{margin-top:4px}.ml-app .stat{margin-right:8px}.ml-app .mlStatsBar{height:42px;padding:14px;background-color:#F5F7FA}.ml-app .mlEmbeddedMapContent{width:100%;height:100%;display:flex;flex:1 1 100%;z-index:1;min-height:0}.ml-app .tab-datavisualizer_index_select,.ml-app .tab-timeseriesexplorer,.ml-app .tab-explorer{background-color:#fff}.ml-app .button-wrapper{display:inline}.ml-app .button-wrapper.disabled .kuiButton[disabled]{pointer-events:none}.ml-app .button-wrapper.disabled{cursor:not-allowed}.ml-app .clear,.ml-app .clearfix{clear:both}.ml-app .mlDisableAntiAliasing{-webkit-font-smoothing:none}.ml-app .mlDisableAntiAliasing * canvas{image-rendering:pixelated}\n',""]),e.exports=t},,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ElasticsearchSqlHighlightRules",{enumerable:!0,get:function(){return n.ElasticsearchSqlHighlightRules}}),Object.defineProperty(t,"ScriptHighlightRules",{enumerable:!0,get:function(){return i.ScriptHighlightRules}}),Object.defineProperty(t,"XJsonHighlightRules",{enumerable:!0,get:function(){return s.XJsonHighlightRules}}),Object.defineProperty(t,"addXJsonToRules",{enumerable:!0,get:function(){return s.addToRules}});var n=a(299),i=a(300),s=a(438)},function(e,t,a){"use strict";var n=a(125);Object.defineProperty(t,"__esModule",{value:!0}),t.XJsonHighlightRules=u,t.addToRules=function(e,t){e.$rules=(0,i.defaultsDeep)(e.$rules,d(t)),e.embedRules(o.ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]),e.embedRules(r.ElasticsearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])};var i=a(8),s=n(a(189));a(439);var r=a(299),o=a(300);const{JsonHighlightRules:l}=s.default.acequire("ace/mode/json_highlight_rules"),c=s.default.acequire("ace/lib/oop"),d=function(e){const t={},a=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("(?:[^"]*_)?script"|"inline"|"source")(\\s*?)(:)(\\s*?)(""")',next:"script-start",merge:!1,push:!0},{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"punctuation.start_triple_quote",regex:'"""',next:"string_literal",merge:!1,push:!0},{token:"string",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]'},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"invalid.illegal",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"invalid.illegal",regex:"\\/\\/.*$"},{token:"paren.lparen",merge:!1,regex:"{",next:e=e||"json",push:!0},{token:"paren.lparen",merge:!1,regex:"[[(]"},{token:"paren.rparen",merge:!1,regex:"[\\])]"},{token:"paren.rparen",regex:"}",merge:!1,next:"pop"},{token:"punctuation.comma",regex:","},{token:"punctuation.colon",regex:":"},{token:"whitespace",regex:"\\s+"},{token:"text",regex:".+?"}];return t[e]=a,t[e+"-sql"]=[{token:["variable","whitespace","ace.punctuation.colon","whitespace","punctuation.start_triple_quote"],regex:'("query")(\\s*?)(:)(\\s*?)(""")',next:"sql-start",merge:!1,push:!0}].concat(a),t.string_literal=[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"},{token:"multi_string",regex:"."}],t};function u(){this.$rules={...d("start")},this.embedRules(o.ScriptHighlightRules,"script-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}]),this.embedRules(r.ElasticsearchSqlHighlightRules,"sql-",[{token:"punctuation.end_triple_quote",regex:'"""',next:"pop"}])}c.inherits(u,l)},function(e,t,a){ace.define("ace/mode/json_highlight_rules",["require","exports","module","ace/lib/oop","ace/mode/text_highlight_rules"],(function(e,t,a){"use strict";var n=e("../lib/oop"),i=e("./text_highlight_rules").TextHighlightRules,s=function(){this.$rules={start:[{token:"variable",regex:'["](?:(?:\\\\.)|(?:[^"\\\\]))*?["]\\s*(?=:)'},{token:"string",regex:'"',next:"string"},{token:"constant.numeric",regex:"0[xX][0-9a-fA-F]+\\b"},{token:"constant.numeric",regex:"[+-]?\\d+(?:(?:\\.\\d*)?(?:[eE][+-]?\\d+)?)?\\b"},{token:"constant.language.boolean",regex:"(?:true|false)\\b"},{token:"text",regex:"['](?:(?:\\\\.)|(?:[^'\\\\]))*?[']"},{token:"comment",regex:"\\/\\/.*$"},{token:"comment.start",regex:"\\/\\*",next:"comment"},{token:"paren.lparen",regex:"[[({]"},{token:"paren.rparen",regex:"[\\])}]"},{token:"text",regex:"\\s+"}],string:[{token:"constant.language.escape",regex:/\\(?:x[0-9a-fA-F]{2}|u[0-9a-fA-F]{4}|["\\\/bfnrt])/},{token:"string",regex:'"|$',next:"start"},{defaultToken:"string"}],comment:[{token:"comment.end",regex:"\\*\\/",next:"start"},{defaultToken:"comment"}]}};n.inherits(s,i),t.JsonHighlightRules=s})),ace.define("ace/mode/matching_brace_outdent",["require","exports","module","ace/range"],(function(e,t,a){"use strict";var n=e("../range").Range,i=function(){};(function(){this.checkOutdent=function(e,t){return!!/^\s+$/.test(e)&&/^\s*\}/.test(t)},this.autoOutdent=function(e,t){var a=e.getLine(t).match(/^(\s*\})/);if(!a)return 0;var i=a[1].length,s=e.findMatchingBracket({row:t,column:i});if(!s||s.row==t)return 0;var r=this.$getIndent(e.getLine(s.row));e.replace(new n(t,0,t,i-1),r)},this.$getIndent=function(e){return e.match(/^\s*/)[0]}}).call(i.prototype),t.MatchingBraceOutdent=i})),ace.define("ace/mode/folding/cstyle",["require","exports","module","ace/lib/oop","ace/range","ace/mode/folding/fold_mode"],(function(e,t,a){"use strict";var n=e("../../lib/oop"),i=e("../../range").Range,s=e("./fold_mode").FoldMode,r=t.FoldMode=function(e){e&&(this.foldingStartMarker=new RegExp(this.foldingStartMarker.source.replace(/\|[^|]*?$/,"|"+e.start)),this.foldingStopMarker=new RegExp(this.foldingStopMarker.source.replace(/\|[^|]*?$/,"|"+e.end)))};n.inherits(r,s),function(){this.foldingStartMarker=/([\{\[\(])[^\}\]\)]*$|^\s*(\/\*)/,this.foldingStopMarker=/^[^\[\{\(]*([\}\]\)])|^[\s\*]*(\*\/)/,this.singleLineBlockCommentRe=/^\s*(\/\*).*\*\/\s*$/,this.tripleStarBlockCommentRe=/^\s*(\/\*\*\*).*\*\/\s*$/,this.startRegionRe=/^\s*(\/\*|\/\/)#?region\b/,this._getFoldWidgetBase=this.getFoldWidget,this.getFoldWidget=function(e,t,a){var n=e.getLine(a);if(this.singleLineBlockCommentRe.test(n)&&!this.startRegionRe.test(n)&&!this.tripleStarBlockCommentRe.test(n))return"";var i=this._getFoldWidgetBase(e,t,a);return!i&&this.startRegionRe.test(n)?"start":i},this.getFoldWidgetRange=function(e,t,a,n){var i,s=e.getLine(a);if(this.startRegionRe.test(s))return this.getCommentRegionBlock(e,s,a);if(i=s.match(this.foldingStartMarker)){var r=i.index;if(i[1])return this.openingBracketBlock(e,i[1],a,r);var o=e.getCommentFoldRange(a,r+i[0].length,1);return o&&!o.isMultiLine()&&(n?o=this.getSectionRange(e,a):"all"!=t&&(o=null)),o}if("markbegin"!==t&&(i=s.match(this.foldingStopMarker))){r=i.index+i[0].length;return i[1]?this.closingBracketBlock(e,i[1],a,r):e.getCommentFoldRange(a,r,-1)}},this.getSectionRange=function(e,t){for(var a=e.getLine(t),n=a.search(/\S/),s=t,r=a.length,o=t+=1,l=e.getLength();++t<l;){var c=(a=e.getLine(t)).search(/\S/);if(-1!==c){if(n>c)break;var d=this.getFoldWidgetRange(e,"all",t);if(d){if(d.start.row<=s)break;if(d.isMultiLine())t=d.end.row;else if(n==c)break}o=t}}return new i(s,r,o,e.getLine(o).length)},this.getCommentRegionBlock=function(e,t,a){for(var n=t.search(/\s*$/),s=e.getLength(),r=a,o=/^\s*(?:\/\*|\/\/|--)#?(end)?region\b/,l=1;++a<s;){t=e.getLine(a);var c=o.exec(t);if(c&&(c[1]?l--:l++,!l))break}if(a>r)return new i(r,n,a,t.length)}}.call(r.prototype)})),ace.define("ace/mode/json",["require","exports","module","ace/lib/oop","ace/mode/text","ace/mode/json_highlight_rules","ace/mode/matching_brace_outdent","ace/mode/behaviour/cstyle","ace/mode/folding/cstyle","ace/worker/worker_client"],(function(e,t,n){"use strict";var i=e("../lib/oop"),s=e("./text").Mode,r=e("./json_highlight_rules").JsonHighlightRules,o=e("./matching_brace_outdent").MatchingBraceOutdent,l=e("./behaviour/cstyle").CstyleBehaviour,c=e("./folding/cstyle").FoldMode,d=e("../worker/worker_client").WorkerClient,u=function(){this.HighlightRules=r,this.$outdent=new o,this.$behaviour=new l,this.foldingRules=new c};i.inherits(u,s),function(){this.getNextLineIndent=function(e,t,a){var n=this.$getIndent(t);"start"==e&&(t.match(/^.*[\{\(\[]\s*$/)&&(n+=a));return n},this.checkOutdent=function(e,t,a){return this.$outdent.checkOutdent(t,a)},this.autoOutdent=function(e,t,a){this.$outdent.autoOutdent(t,a)},this.createWorker=function(e){var t=new d(["ace"],a(440),"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t},this.$id="ace/mode/json"}.call(u.prototype),t.Mode=u}))},function(e,t){e.exports.id="ace/mode/json_worker",e.exports.src='"no use strict";!function(window){function resolveModuleId(id,paths){for(var testPath=id,tail="";testPath;){var alias=paths[testPath];if("string"==typeof alias)return alias+tail;if(alias)return alias.location.replace(/\\/*$/,"/")+(tail||alias.main||alias.name);if(alias===!1)return"";var i=testPath.lastIndexOf("/");if(-1===i)break;tail=testPath.substr(i)+tail,testPath=testPath.slice(0,i)}return id}if(!(void 0!==window.window&&window.document||window.acequire&&window.define)){window.console||(window.console=function(){var msgs=Array.prototype.slice.call(arguments,0);postMessage({type:"log",data:msgs})},window.console.error=window.console.warn=window.console.log=window.console.trace=window.console),window.window=window,window.ace=window,window.onerror=function(message,file,line,col,err){postMessage({type:"error",data:{message:message,data:err.data,file:file,line:line,col:col,stack:err.stack}})},window.normalizeModule=function(parentId,moduleName){if(-1!==moduleName.indexOf("!")){var chunks=moduleName.split("!");return window.normalizeModule(parentId,chunks[0])+"!"+window.normalizeModule(parentId,chunks[1])}if("."==moduleName.charAt(0)){var base=parentId.split("/").slice(0,-1).join("/");for(moduleName=(base?base+"/":"")+moduleName;-1!==moduleName.indexOf(".")&&previous!=moduleName;){var previous=moduleName;moduleName=moduleName.replace(/^\\.\\//,"").replace(/\\/\\.\\//,"/").replace(/[^\\/]+\\/\\.\\.\\//,"")}}return moduleName},window.acequire=function acequire(parentId,id){if(id||(id=parentId,parentId=null),!id.charAt)throw Error("worker.js acequire() accepts only (parentId, id) as arguments");id=window.normalizeModule(parentId,id);var module=window.acequire.modules[id];if(module)return module.initialized||(module.initialized=!0,module.exports=module.factory().exports),module.exports;if(!window.acequire.tlns)return console.log("unable to load "+id);var path=resolveModuleId(id,window.acequire.tlns);return".js"!=path.slice(-3)&&(path+=".js"),window.acequire.id=id,window.acequire.modules[id]={},importScripts(path),window.acequire(parentId,id)},window.acequire.modules={},window.acequire.tlns={},window.define=function(id,deps,factory){if(2==arguments.length?(factory=deps,"string"!=typeof id&&(deps=id,id=window.acequire.id)):1==arguments.length&&(factory=id,deps=[],id=window.acequire.id),"function"!=typeof factory)return window.acequire.modules[id]={exports:factory,initialized:!0},void 0;deps.length||(deps=["require","exports","module"]);var req=function(childId){return window.acequire(id,childId)};window.acequire.modules[id]={exports:{},factory:function(){var module=this,returnExports=factory.apply(this,deps.map(function(dep){switch(dep){case"require":return req;case"exports":return module.exports;case"module":return module;default:return req(dep)}}));return returnExports&&(module.exports=returnExports),module}}},window.define.amd={},acequire.tlns={},window.initBaseUrls=function(topLevelNamespaces){for(var i in topLevelNamespaces)acequire.tlns[i]=topLevelNamespaces[i]},window.initSender=function(){var EventEmitter=window.acequire("ace/lib/event_emitter").EventEmitter,oop=window.acequire("ace/lib/oop"),Sender=function(){};return function(){oop.implement(this,EventEmitter),this.callback=function(data,callbackId){postMessage({type:"call",id:callbackId,data:data})},this.emit=function(name,data){postMessage({type:"event",name:name,data:data})}}.call(Sender.prototype),new Sender};var main=window.main=null,sender=window.sender=null;window.onmessage=function(e){var msg=e.data;if(msg.event&&sender)sender._signal(msg.event,msg.data);else if(msg.command)if(main[msg.command])main[msg.command].apply(main,msg.args);else{if(!window[msg.command])throw Error("Unknown command:"+msg.command);window[msg.command].apply(window,msg.args)}else if(msg.init){window.initBaseUrls(msg.tlns),acequire("ace/lib/es5-shim"),sender=window.sender=window.initSender();var clazz=acequire(msg.module)[msg.classname];main=window.main=new clazz(sender)}}}}(this),ace.define("ace/lib/oop",["require","exports","module"],function(acequire,exports){"use strict";exports.inherits=function(ctor,superCtor){ctor.super_=superCtor,ctor.prototype=Object.create(superCtor.prototype,{constructor:{value:ctor,enumerable:!1,writable:!0,configurable:!0}})},exports.mixin=function(obj,mixin){for(var key in mixin)obj[key]=mixin[key];return obj},exports.implement=function(proto,mixin){exports.mixin(proto,mixin)}}),ace.define("ace/range",["require","exports","module"],function(acequire,exports){"use strict";var comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},Range=function(startRow,startColumn,endRow,endColumn){this.start={row:startRow,column:startColumn},this.end={row:endRow,column:endColumn}};(function(){this.isEqual=function(range){return this.start.row===range.start.row&&this.end.row===range.end.row&&this.start.column===range.start.column&&this.end.column===range.end.column},this.toString=function(){return"Range: ["+this.start.row+"/"+this.start.column+"] -> ["+this.end.row+"/"+this.end.column+"]"},this.contains=function(row,column){return 0==this.compare(row,column)},this.compareRange=function(range){var cmp,end=range.end,start=range.start;return cmp=this.compare(end.row,end.column),1==cmp?(cmp=this.compare(start.row,start.column),1==cmp?2:0==cmp?1:0):-1==cmp?-2:(cmp=this.compare(start.row,start.column),-1==cmp?-1:1==cmp?42:0)},this.comparePoint=function(p){return this.compare(p.row,p.column)},this.containsRange=function(range){return 0==this.comparePoint(range.start)&&0==this.comparePoint(range.end)},this.intersects=function(range){var cmp=this.compareRange(range);return-1==cmp||0==cmp||1==cmp},this.isEnd=function(row,column){return this.end.row==row&&this.end.column==column},this.isStart=function(row,column){return this.start.row==row&&this.start.column==column},this.setStart=function(row,column){"object"==typeof row?(this.start.column=row.column,this.start.row=row.row):(this.start.row=row,this.start.column=column)},this.setEnd=function(row,column){"object"==typeof row?(this.end.column=row.column,this.end.row=row.row):(this.end.row=row,this.end.column=column)},this.inside=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)||this.isStart(row,column)?!1:!0:!1},this.insideStart=function(row,column){return 0==this.compare(row,column)?this.isEnd(row,column)?!1:!0:!1},this.insideEnd=function(row,column){return 0==this.compare(row,column)?this.isStart(row,column)?!1:!0:!1},this.compare=function(row,column){return this.isMultiLine()||row!==this.start.row?this.start.row>row?-1:row>this.end.row?1:this.start.row===row?column>=this.start.column?0:-1:this.end.row===row?this.end.column>=column?0:1:0:this.start.column>column?-1:column>this.end.column?1:0},this.compareStart=function(row,column){return this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.compareEnd=function(row,column){return this.end.row==row&&this.end.column==column?1:this.compare(row,column)},this.compareInside=function(row,column){return this.end.row==row&&this.end.column==column?1:this.start.row==row&&this.start.column==column?-1:this.compare(row,column)},this.clipRows=function(firstRow,lastRow){if(this.end.row>lastRow)var end={row:lastRow+1,column:0};else if(firstRow>this.end.row)var end={row:firstRow,column:0};if(this.start.row>lastRow)var start={row:lastRow+1,column:0};else if(firstRow>this.start.row)var start={row:firstRow,column:0};return Range.fromPoints(start||this.start,end||this.end)},this.extend=function(row,column){var cmp=this.compare(row,column);if(0==cmp)return this;if(-1==cmp)var start={row:row,column:column};else var end={row:row,column:column};return Range.fromPoints(start||this.start,end||this.end)},this.isEmpty=function(){return this.start.row===this.end.row&&this.start.column===this.end.column},this.isMultiLine=function(){return this.start.row!==this.end.row},this.clone=function(){return Range.fromPoints(this.start,this.end)},this.collapseRows=function(){return 0==this.end.column?new Range(this.start.row,0,Math.max(this.start.row,this.end.row-1),0):new Range(this.start.row,0,this.end.row,0)},this.toScreenRange=function(session){var screenPosStart=session.documentToScreenPosition(this.start),screenPosEnd=session.documentToScreenPosition(this.end);return new Range(screenPosStart.row,screenPosStart.column,screenPosEnd.row,screenPosEnd.column)},this.moveBy=function(row,column){this.start.row+=row,this.start.column+=column,this.end.row+=row,this.end.column+=column}}).call(Range.prototype),Range.fromPoints=function(start,end){return new Range(start.row,start.column,end.row,end.column)},Range.comparePoints=comparePoints,Range.comparePoints=function(p1,p2){return p1.row-p2.row||p1.column-p2.column},exports.Range=Range}),ace.define("ace/apply_delta",["require","exports","module"],function(acequire,exports){"use strict";exports.applyDelta=function(docLines,delta){var row=delta.start.row,startColumn=delta.start.column,line=docLines[row]||"";switch(delta.action){case"insert":var lines=delta.lines;if(1===lines.length)docLines[row]=line.substring(0,startColumn)+delta.lines[0]+line.substring(startColumn);else{var args=[row,1].concat(delta.lines);docLines.splice.apply(docLines,args),docLines[row]=line.substring(0,startColumn)+docLines[row],docLines[row+delta.lines.length-1]+=line.substring(startColumn)}break;case"remove":var endColumn=delta.end.column,endRow=delta.end.row;row===endRow?docLines[row]=line.substring(0,startColumn)+line.substring(endColumn):docLines.splice(row,endRow-row+1,line.substring(0,startColumn)+docLines[endRow].substring(endColumn))}}}),ace.define("ace/lib/event_emitter",["require","exports","module"],function(acequire,exports){"use strict";var EventEmitter={},stopPropagation=function(){this.propagationStopped=!0},preventDefault=function(){this.defaultPrevented=!0};EventEmitter._emit=EventEmitter._dispatchEvent=function(eventName,e){this._eventRegistry||(this._eventRegistry={}),this._defaultHandlers||(this._defaultHandlers={});var listeners=this._eventRegistry[eventName]||[],defaultHandler=this._defaultHandlers[eventName];if(listeners.length||defaultHandler){"object"==typeof e&&e||(e={}),e.type||(e.type=eventName),e.stopPropagation||(e.stopPropagation=stopPropagation),e.preventDefault||(e.preventDefault=preventDefault),listeners=listeners.slice();for(var i=0;listeners.length>i&&(listeners[i](e,this),!e.propagationStopped);i++);return defaultHandler&&!e.defaultPrevented?defaultHandler(e,this):void 0}},EventEmitter._signal=function(eventName,e){var listeners=(this._eventRegistry||{})[eventName];if(listeners){listeners=listeners.slice();for(var i=0;listeners.length>i;i++)listeners[i](e,this)}},EventEmitter.once=function(eventName,callback){var _self=this;callback&&this.addEventListener(eventName,function newCallback(){_self.removeEventListener(eventName,newCallback),callback.apply(null,arguments)})},EventEmitter.setDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers||(handlers=this._defaultHandlers={_disabled_:{}}),handlers[eventName]){var old=handlers[eventName],disabled=handlers._disabled_[eventName];disabled||(handlers._disabled_[eventName]=disabled=[]),disabled.push(old);var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}handlers[eventName]=callback},EventEmitter.removeDefaultHandler=function(eventName,callback){var handlers=this._defaultHandlers;if(handlers){var disabled=handlers._disabled_[eventName];if(handlers[eventName]==callback)handlers[eventName],disabled&&this.setDefaultHandler(eventName,disabled.pop());else if(disabled){var i=disabled.indexOf(callback);-1!=i&&disabled.splice(i,1)}}},EventEmitter.on=EventEmitter.addEventListener=function(eventName,callback,capturing){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];return listeners||(listeners=this._eventRegistry[eventName]=[]),-1==listeners.indexOf(callback)&&listeners[capturing?"unshift":"push"](callback),callback},EventEmitter.off=EventEmitter.removeListener=EventEmitter.removeEventListener=function(eventName,callback){this._eventRegistry=this._eventRegistry||{};var listeners=this._eventRegistry[eventName];if(listeners){var index=listeners.indexOf(callback);-1!==index&&listeners.splice(index,1)}},EventEmitter.removeAllListeners=function(eventName){this._eventRegistry&&(this._eventRegistry[eventName]=[])},exports.EventEmitter=EventEmitter}),ace.define("ace/anchor",["require","exports","module","ace/lib/oop","ace/lib/event_emitter"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),EventEmitter=acequire("./lib/event_emitter").EventEmitter,Anchor=exports.Anchor=function(doc,row,column){this.$onChange=this.onChange.bind(this),this.attach(doc),column===void 0?this.setPosition(row.row,row.column):this.setPosition(row,column)};(function(){function $pointsInOrder(point1,point2,equalPointsInOrder){var bColIsAfter=equalPointsInOrder?point1.column<=point2.column:point1.column<point2.column;return point1.row<point2.row||point1.row==point2.row&&bColIsAfter}function $getTransformedPoint(delta,point,moveIfEqual){var deltaIsInsert="insert"==delta.action,deltaRowShift=(deltaIsInsert?1:-1)*(delta.end.row-delta.start.row),deltaColShift=(deltaIsInsert?1:-1)*(delta.end.column-delta.start.column),deltaStart=delta.start,deltaEnd=deltaIsInsert?deltaStart:delta.end;return $pointsInOrder(point,deltaStart,moveIfEqual)?{row:point.row,column:point.column}:$pointsInOrder(deltaEnd,point,!moveIfEqual)?{row:point.row+deltaRowShift,column:point.column+(point.row==deltaEnd.row?deltaColShift:0)}:{row:deltaStart.row,column:deltaStart.column}}oop.implement(this,EventEmitter),this.getPosition=function(){return this.$clipPositionToDocument(this.row,this.column)},this.getDocument=function(){return this.document},this.$insertRight=!1,this.onChange=function(delta){if(!(delta.start.row==delta.end.row&&delta.start.row!=this.row||delta.start.row>this.row)){var point=$getTransformedPoint(delta,{row:this.row,column:this.column},this.$insertRight);this.setPosition(point.row,point.column,!0)}},this.setPosition=function(row,column,noClip){var pos;if(pos=noClip?{row:row,column:column}:this.$clipPositionToDocument(row,column),this.row!=pos.row||this.column!=pos.column){var old={row:this.row,column:this.column};this.row=pos.row,this.column=pos.column,this._signal("change",{old:old,value:pos})}},this.detach=function(){this.document.removeEventListener("change",this.$onChange)},this.attach=function(doc){this.document=doc||this.document,this.document.on("change",this.$onChange)},this.$clipPositionToDocument=function(row,column){var pos={};return row>=this.document.getLength()?(pos.row=Math.max(0,this.document.getLength()-1),pos.column=this.document.getLine(pos.row).length):0>row?(pos.row=0,pos.column=0):(pos.row=row,pos.column=Math.min(this.document.getLine(pos.row).length,Math.max(0,column))),0>column&&(pos.column=0),pos}}).call(Anchor.prototype)}),ace.define("ace/document",["require","exports","module","ace/lib/oop","ace/apply_delta","ace/lib/event_emitter","ace/range","ace/anchor"],function(acequire,exports){"use strict";var oop=acequire("./lib/oop"),applyDelta=acequire("./apply_delta").applyDelta,EventEmitter=acequire("./lib/event_emitter").EventEmitter,Range=acequire("./range").Range,Anchor=acequire("./anchor").Anchor,Document=function(textOrLines){this.$lines=[""],0===textOrLines.length?this.$lines=[""]:Array.isArray(textOrLines)?this.insertMergedLines({row:0,column:0},textOrLines):this.insert({row:0,column:0},textOrLines)};(function(){oop.implement(this,EventEmitter),this.setValue=function(text){var len=this.getLength()-1;this.remove(new Range(0,0,len,this.getLine(len).length)),this.insert({row:0,column:0},text)},this.getValue=function(){return this.getAllLines().join(this.getNewLineCharacter())},this.createAnchor=function(row,column){return new Anchor(this,row,column)},this.$split=0==="aaa".split(/a/).length?function(text){return text.replace(/\\r\\n|\\r/g,"\\n").split("\\n")}:function(text){return text.split(/\\r\\n|\\r|\\n/)},this.$detectNewLine=function(text){var match=text.match(/^.*?(\\r\\n|\\r|\\n)/m);this.$autoNewLine=match?match[1]:"\\n",this._signal("changeNewLineMode")},this.getNewLineCharacter=function(){switch(this.$newLineMode){case"windows":return"\\r\\n";case"unix":return"\\n";default:return this.$autoNewLine||"\\n"}},this.$autoNewLine="",this.$newLineMode="auto",this.setNewLineMode=function(newLineMode){this.$newLineMode!==newLineMode&&(this.$newLineMode=newLineMode,this._signal("changeNewLineMode"))},this.getNewLineMode=function(){return this.$newLineMode},this.isNewLine=function(text){return"\\r\\n"==text||"\\r"==text||"\\n"==text},this.getLine=function(row){return this.$lines[row]||""},this.getLines=function(firstRow,lastRow){return this.$lines.slice(firstRow,lastRow+1)},this.getAllLines=function(){return this.getLines(0,this.getLength())},this.getLength=function(){return this.$lines.length},this.getTextRange=function(range){return this.getLinesForRange(range).join(this.getNewLineCharacter())},this.getLinesForRange=function(range){var lines;if(range.start.row===range.end.row)lines=[this.getLine(range.start.row).substring(range.start.column,range.end.column)];else{lines=this.getLines(range.start.row,range.end.row),lines[0]=(lines[0]||"").substring(range.start.column);var l=lines.length-1;range.end.row-range.start.row==l&&(lines[l]=lines[l].substring(0,range.end.column))}return lines},this.insertLines=function(row,lines){return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."),this.insertFullLines(row,lines)},this.removeLines=function(firstRow,lastRow){return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."),this.removeFullLines(firstRow,lastRow)},this.insertNewLine=function(position){return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."),this.insertMergedLines(position,["",""])},this.insert=function(position,text){return 1>=this.getLength()&&this.$detectNewLine(text),this.insertMergedLines(position,this.$split(text))},this.insertInLine=function(position,text){var start=this.clippedPos(position.row,position.column),end=this.pos(position.row,position.column+text.length);return this.applyDelta({start:start,end:end,action:"insert",lines:[text]},!0),this.clonePos(end)},this.clippedPos=function(row,column){var length=this.getLength();void 0===row?row=length:0>row?row=0:row>=length&&(row=length-1,column=void 0);var line=this.getLine(row);return void 0==column&&(column=line.length),column=Math.min(Math.max(column,0),line.length),{row:row,column:column}},this.clonePos=function(pos){return{row:pos.row,column:pos.column}},this.pos=function(row,column){return{row:row,column:column}},this.$clipPosition=function(position){var length=this.getLength();return position.row>=length?(position.row=Math.max(0,length-1),position.column=this.getLine(length-1).length):(position.row=Math.max(0,position.row),position.column=Math.min(Math.max(position.column,0),this.getLine(position.row).length)),position},this.insertFullLines=function(row,lines){row=Math.min(Math.max(row,0),this.getLength());var column=0;this.getLength()>row?(lines=lines.concat([""]),column=0):(lines=[""].concat(lines),row--,column=this.$lines[row].length),this.insertMergedLines({row:row,column:column},lines)},this.insertMergedLines=function(position,lines){var start=this.clippedPos(position.row,position.column),end={row:start.row+lines.length-1,column:(1==lines.length?start.column:0)+lines[lines.length-1].length};return this.applyDelta({start:start,end:end,action:"insert",lines:lines}),this.clonePos(end)},this.remove=function(range){var start=this.clippedPos(range.start.row,range.start.column),end=this.clippedPos(range.end.row,range.end.column);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})}),this.clonePos(start)},this.removeInLine=function(row,startColumn,endColumn){var start=this.clippedPos(row,startColumn),end=this.clippedPos(row,endColumn);return this.applyDelta({start:start,end:end,action:"remove",lines:this.getLinesForRange({start:start,end:end})},!0),this.clonePos(start)},this.removeFullLines=function(firstRow,lastRow){firstRow=Math.min(Math.max(0,firstRow),this.getLength()-1),lastRow=Math.min(Math.max(0,lastRow),this.getLength()-1);var deleteFirstNewLine=lastRow==this.getLength()-1&&firstRow>0,deleteLastNewLine=this.getLength()-1>lastRow,startRow=deleteFirstNewLine?firstRow-1:firstRow,startCol=deleteFirstNewLine?this.getLine(startRow).length:0,endRow=deleteLastNewLine?lastRow+1:lastRow,endCol=deleteLastNewLine?0:this.getLine(endRow).length,range=new Range(startRow,startCol,endRow,endCol),deletedLines=this.$lines.slice(firstRow,lastRow+1);return this.applyDelta({start:range.start,end:range.end,action:"remove",lines:this.getLinesForRange(range)}),deletedLines},this.removeNewLine=function(row){this.getLength()-1>row&&row>=0&&this.applyDelta({start:this.pos(row,this.getLine(row).length),end:this.pos(row+1,0),action:"remove",lines:["",""]})},this.replace=function(range,text){if(range instanceof Range||(range=Range.fromPoints(range.start,range.end)),0===text.length&&range.isEmpty())return range.start;if(text==this.getTextRange(range))return range.end;this.remove(range);var end;return end=text?this.insert(range.start,text):range.start},this.applyDeltas=function(deltas){for(var i=0;deltas.length>i;i++)this.applyDelta(deltas[i])},this.revertDeltas=function(deltas){for(var i=deltas.length-1;i>=0;i--)this.revertDelta(deltas[i])},this.applyDelta=function(delta,doNotValidate){var isInsert="insert"==delta.action;(isInsert?1>=delta.lines.length&&!delta.lines[0]:!Range.comparePoints(delta.start,delta.end))||(isInsert&&delta.lines.length>2e4&&this.$splitAndapplyLargeDelta(delta,2e4),applyDelta(this.$lines,delta,doNotValidate),this._signal("change",delta))},this.$splitAndapplyLargeDelta=function(delta,MAX){for(var lines=delta.lines,l=lines.length,row=delta.start.row,column=delta.start.column,from=0,to=0;;){from=to,to+=MAX-1;var chunk=lines.slice(from,to);if(to>l){delta.lines=chunk,delta.start.row=row+from,delta.start.column=column;break}chunk.push(""),this.applyDelta({start:this.pos(row+from,column),end:this.pos(row+to,column=0),action:delta.action,lines:chunk},!0)}},this.revertDelta=function(delta){this.applyDelta({start:this.clonePos(delta.start),end:this.clonePos(delta.end),action:"insert"==delta.action?"remove":"insert",lines:delta.lines.slice()})},this.indexToPosition=function(index,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,i=startRow||0,l=lines.length;l>i;i++)if(index-=lines[i].length+newlineLength,0>index)return{row:i,column:index+lines[i].length+newlineLength};return{row:l-1,column:lines[l-1].length}},this.positionToIndex=function(pos,startRow){for(var lines=this.$lines||this.getAllLines(),newlineLength=this.getNewLineCharacter().length,index=0,row=Math.min(pos.row,lines.length),i=startRow||0;row>i;++i)index+=lines[i].length+newlineLength;return index+pos.column}}).call(Document.prototype),exports.Document=Document}),ace.define("ace/lib/lang",["require","exports","module"],function(acequire,exports){"use strict";exports.last=function(a){return a[a.length-1]},exports.stringReverse=function(string){return string.split("").reverse().join("")},exports.stringRepeat=function(string,count){for(var result="";count>0;)1&count&&(result+=string),(count>>=1)&&(string+=string);return result};var trimBeginRegexp=/^\\s\\s*/,trimEndRegexp=/\\s\\s*$/;exports.stringTrimLeft=function(string){return string.replace(trimBeginRegexp,"")},exports.stringTrimRight=function(string){return string.replace(trimEndRegexp,"")},exports.copyObject=function(obj){var copy={};for(var key in obj)copy[key]=obj[key];return copy},exports.copyArray=function(array){for(var copy=[],i=0,l=array.length;l>i;i++)copy[i]=array[i]&&"object"==typeof array[i]?this.copyObject(array[i]):array[i];return copy},exports.deepCopy=function deepCopy(obj){if("object"!=typeof obj||!obj)return obj;var copy;if(Array.isArray(obj)){copy=[];for(var key=0;obj.length>key;key++)copy[key]=deepCopy(obj[key]);return copy}if("[object Object]"!==Object.prototype.toString.call(obj))return obj;copy={};for(var key in obj)copy[key]=deepCopy(obj[key]);return copy},exports.arrayToMap=function(arr){for(var map={},i=0;arr.length>i;i++)map[arr[i]]=1;return map},exports.createMap=function(props){var map=Object.create(null);for(var i in props)map[i]=props[i];return map},exports.arrayRemove=function(array,value){for(var i=0;array.length>=i;i++)value===array[i]&&array.splice(i,1)},exports.escapeRegExp=function(str){return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g,"\\\\$1")},exports.escapeHTML=function(str){return str.replace(/&/g,"&#38;").replace(/"/g,"&#34;").replace(/\'/g,"&#39;").replace(/</g,"&#60;")},exports.getMatchOffsets=function(string,regExp){var matches=[];return string.replace(regExp,function(str){matches.push({offset:arguments[arguments.length-2],length:str.length})}),matches},exports.deferredCall=function(fcn){var timer=null,callback=function(){timer=null,fcn()},deferred=function(timeout){return deferred.cancel(),timer=setTimeout(callback,timeout||0),deferred};return deferred.schedule=deferred,deferred.call=function(){return this.cancel(),fcn(),deferred},deferred.cancel=function(){return clearTimeout(timer),timer=null,deferred},deferred.isPending=function(){return timer},deferred},exports.delayedCall=function(fcn,defaultTimeout){var timer=null,callback=function(){timer=null,fcn()},_self=function(timeout){null==timer&&(timer=setTimeout(callback,timeout||defaultTimeout))};return _self.delay=function(timeout){timer&&clearTimeout(timer),timer=setTimeout(callback,timeout||defaultTimeout)},_self.schedule=_self,_self.call=function(){this.cancel(),fcn()},_self.cancel=function(){timer&&clearTimeout(timer),timer=null},_self.isPending=function(){return timer},_self}}),ace.define("ace/worker/mirror",["require","exports","module","ace/range","ace/document","ace/lib/lang"],function(acequire,exports){"use strict";acequire("../range").Range;var Document=acequire("../document").Document,lang=acequire("../lib/lang"),Mirror=exports.Mirror=function(sender){this.sender=sender;var doc=this.doc=new Document(""),deferredUpdate=this.deferredUpdate=lang.delayedCall(this.onUpdate.bind(this)),_self=this;sender.on("change",function(e){var data=e.data;if(data[0].start)doc.applyDeltas(data);else for(var i=0;data.length>i;i+=2){if(Array.isArray(data[i+1]))var d={action:"insert",start:data[i],lines:data[i+1]};else var d={action:"remove",start:data[i],end:data[i+1]};doc.applyDelta(d,!0)}return _self.$timeout?deferredUpdate.schedule(_self.$timeout):(_self.onUpdate(),void 0)})};(function(){this.$timeout=500,this.setTimeout=function(timeout){this.$timeout=timeout},this.setValue=function(value){this.doc.setValue(value),this.deferredUpdate.schedule(this.$timeout)},this.getValue=function(callbackId){this.sender.callback(this.doc.getValue(),callbackId)},this.onUpdate=function(){},this.isPending=function(){return this.deferredUpdate.isPending()}}).call(Mirror.prototype)}),ace.define("ace/mode/json/json_parse",["require","exports","module"],function(){"use strict";var at,ch,text,value,escapee={\'"\':\'"\',"\\\\":"\\\\","/":"/",b:"\\b",f:"\\f",n:"\\n",r:"\\r",t:"\t"},error=function(m){throw{name:"SyntaxError",message:m,at:at,text:text}},next=function(c){return c&&c!==ch&&error("Expected \'"+c+"\' instead of \'"+ch+"\'"),ch=text.charAt(at),at+=1,ch},number=function(){var number,string="";for("-"===ch&&(string="-",next("-"));ch>="0"&&"9">=ch;)string+=ch,next();if("."===ch)for(string+=".";next()&&ch>="0"&&"9">=ch;)string+=ch;if("e"===ch||"E"===ch)for(string+=ch,next(),("-"===ch||"+"===ch)&&(string+=ch,next());ch>="0"&&"9">=ch;)string+=ch,next();return number=+string,isNaN(number)?(error("Bad number"),void 0):number},string=function(){var hex,i,uffff,string="";if(\'"\'===ch)for(;next();){if(\'"\'===ch)return next(),string;if("\\\\"===ch)if(next(),"u"===ch){for(uffff=0,i=0;4>i&&(hex=parseInt(next(),16),isFinite(hex));i+=1)uffff=16*uffff+hex;string+=String.fromCharCode(uffff)}else{if("string"!=typeof escapee[ch])break;string+=escapee[ch]}else string+=ch}error("Bad string")},white=function(){for(;ch&&" ">=ch;)next()},word=function(){switch(ch){case"t":return next("t"),next("r"),next("u"),next("e"),!0;case"f":return next("f"),next("a"),next("l"),next("s"),next("e"),!1;case"n":return next("n"),next("u"),next("l"),next("l"),null}error("Unexpected \'"+ch+"\'")},array=function(){var array=[];if("["===ch){if(next("["),white(),"]"===ch)return next("]"),array;for(;ch;){if(array.push(value()),white(),"]"===ch)return next("]"),array;next(","),white()}}error("Bad array")},object=function(){var key,object={};if("{"===ch){if(next("{"),white(),"}"===ch)return next("}"),object;for(;ch;){if(key=string(),white(),next(":"),Object.hasOwnProperty.call(object,key)&&error(\'Duplicate key "\'+key+\'"\'),object[key]=value(),white(),"}"===ch)return next("}"),object;next(","),white()}}error("Bad object")};return value=function(){switch(white(),ch){case"{":return object();case"[":return array();case\'"\':return string();case"-":return number();default:return ch>="0"&&"9">=ch?number():word()}},function(source,reviver){var result;return text=source,at=0,ch=" ",result=value(),white(),ch&&error("Syntax error"),"function"==typeof reviver?function walk(holder,key){var k,v,value=holder[key];if(value&&"object"==typeof value)for(k in value)Object.hasOwnProperty.call(value,k)&&(v=walk(value,k),void 0!==v?value[k]=v:delete value[k]);return reviver.call(holder,key,value)}({"":result},""):result}}),ace.define("ace/mode/json_worker",["require","exports","module","ace/lib/oop","ace/worker/mirror","ace/mode/json/json_parse"],function(acequire,exports){"use strict";var oop=acequire("../lib/oop"),Mirror=acequire("../worker/mirror").Mirror,parse=acequire("./json/json_parse"),JsonWorker=exports.JsonWorker=function(sender){Mirror.call(this,sender),this.setTimeout(200)};oop.inherits(JsonWorker,Mirror),function(){this.onUpdate=function(){var value=this.doc.getValue(),errors=[];try{value&&parse(value)}catch(e){var pos=this.doc.indexToPosition(e.at-1);errors.push({row:pos.row,column:pos.column,text:e.message,type:"error"})}this.sender.emit("annotate",errors)}}.call(JsonWorker.prototype)}),ace.define("ace/lib/es5-shim",["require","exports","module"],function(){function Empty(){}function doesDefinePropertyWork(object){try{return Object.defineProperty(object,"sentinel",{}),"sentinel"in object}catch(exception){}}function toInteger(n){return n=+n,n!==n?n=0:0!==n&&n!==1/0&&n!==-(1/0)&&(n=(n>0||-1)*Math.floor(Math.abs(n))),n}Function.prototype.bind||(Function.prototype.bind=function(that){var target=this;if("function"!=typeof target)throw new TypeError("Function.prototype.bind called on incompatible "+target);var args=slice.call(arguments,1),bound=function(){if(this instanceof bound){var result=target.apply(this,args.concat(slice.call(arguments)));return Object(result)===result?result:this}return target.apply(that,args.concat(slice.call(arguments)))};return target.prototype&&(Empty.prototype=target.prototype,bound.prototype=new Empty,Empty.prototype=null),bound});var defineGetter,defineSetter,lookupGetter,lookupSetter,supportsAccessors,call=Function.prototype.call,prototypeOfArray=Array.prototype,prototypeOfObject=Object.prototype,slice=prototypeOfArray.slice,_toString=call.bind(prototypeOfObject.toString),owns=call.bind(prototypeOfObject.hasOwnProperty);if((supportsAccessors=owns(prototypeOfObject,"__defineGetter__"))&&(defineGetter=call.bind(prototypeOfObject.__defineGetter__),defineSetter=call.bind(prototypeOfObject.__defineSetter__),lookupGetter=call.bind(prototypeOfObject.__lookupGetter__),lookupSetter=call.bind(prototypeOfObject.__lookupSetter__)),2!=[1,2].splice(0).length)if(function(){function makeArray(l){var a=Array(l+2);return a[0]=a[1]=0,a}var lengthBefore,array=[];return array.splice.apply(array,makeArray(20)),array.splice.apply(array,makeArray(26)),lengthBefore=array.length,array.splice(5,0,"XXX"),lengthBefore+1==array.length,lengthBefore+1==array.length?!0:void 0\n}()){var array_splice=Array.prototype.splice;Array.prototype.splice=function(start,deleteCount){return arguments.length?array_splice.apply(this,[void 0===start?0:start,void 0===deleteCount?this.length-start:deleteCount].concat(slice.call(arguments,2))):[]}}else Array.prototype.splice=function(pos,removeCount){var length=this.length;pos>0?pos>length&&(pos=length):void 0==pos?pos=0:0>pos&&(pos=Math.max(length+pos,0)),length>pos+removeCount||(removeCount=length-pos);var removed=this.slice(pos,pos+removeCount),insert=slice.call(arguments,2),add=insert.length;if(pos===length)add&&this.push.apply(this,insert);else{var remove=Math.min(removeCount,length-pos),tailOldPos=pos+remove,tailNewPos=tailOldPos+add-remove,tailCount=length-tailOldPos,lengthAfterRemove=length-remove;if(tailOldPos>tailNewPos)for(var i=0;tailCount>i;++i)this[tailNewPos+i]=this[tailOldPos+i];else if(tailNewPos>tailOldPos)for(i=tailCount;i--;)this[tailNewPos+i]=this[tailOldPos+i];if(add&&pos===lengthAfterRemove)this.length=lengthAfterRemove,this.push.apply(this,insert);else for(this.length=lengthAfterRemove+add,i=0;add>i;++i)this[pos+i]=insert[i]}return removed};Array.isArray||(Array.isArray=function(obj){return"[object Array]"==_toString(obj)});var boxedString=Object("a"),splitString="a"!=boxedString[0]||!(0 in boxedString);if(Array.prototype.forEach||(Array.prototype.forEach=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,thisp=arguments[1],i=-1,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError;for(;length>++i;)i in self&&fun.call(thisp,self[i],i,object)}),Array.prototype.map||(Array.prototype.map=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=Array(length),thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(result[i]=fun.call(thisp,self[i],i,object));return result}),Array.prototype.filter||(Array.prototype.filter=function(fun){var value,object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,result=[],thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)i in self&&(value=self[i],fun.call(thisp,value,i,object)&&result.push(value));return result}),Array.prototype.every||(Array.prototype.every=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&!fun.call(thisp,self[i],i,object))return!1;return!0}),Array.prototype.some||(Array.prototype.some=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0,thisp=arguments[1];if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");for(var i=0;length>i;i++)if(i in self&&fun.call(thisp,self[i],i,object))return!0;return!1}),Array.prototype.reduce||(Array.prototype.reduce=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduce of empty array with no initial value");var result,i=0;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i++];break}if(++i>=length)throw new TypeError("reduce of empty array with no initial value")}for(;length>i;i++)i in self&&(result=fun.call(void 0,result,self[i],i,object));return result}),Array.prototype.reduceRight||(Array.prototype.reduceRight=function(fun){var object=toObject(this),self=splitString&&"[object String]"==_toString(this)?this.split(""):object,length=self.length>>>0;if("[object Function]"!=_toString(fun))throw new TypeError(fun+" is not a function");if(!length&&1==arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var result,i=length-1;if(arguments.length>=2)result=arguments[1];else for(;;){if(i in self){result=self[i--];break}if(0>--i)throw new TypeError("reduceRight of empty array with no initial value")}do i in this&&(result=fun.call(void 0,result,self[i],i,object));while(i--);return result}),Array.prototype.indexOf&&-1==[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=0;for(arguments.length>1&&(i=toInteger(arguments[1])),i=i>=0?i:Math.max(0,length+i);length>i;i++)if(i in self&&self[i]===sought)return i;return-1}),Array.prototype.lastIndexOf&&-1==[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(sought){var self=splitString&&"[object String]"==_toString(this)?this.split(""):toObject(this),length=self.length>>>0;if(!length)return-1;var i=length-1;for(arguments.length>1&&(i=Math.min(i,toInteger(arguments[1]))),i=i>=0?i:length-Math.abs(i);i>=0;i--)if(i in self&&sought===self[i])return i;return-1}),Object.getPrototypeOf||(Object.getPrototypeOf=function(object){return object.__proto__||(object.constructor?object.constructor.prototype:prototypeOfObject)}),!Object.getOwnPropertyDescriptor){var ERR_NON_OBJECT="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(object,property){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT+object);if(owns(object,property)){var descriptor,getter,setter;if(descriptor={enumerable:!0,configurable:!0},supportsAccessors){var prototype=object.__proto__;object.__proto__=prototypeOfObject;var getter=lookupGetter(object,property),setter=lookupSetter(object,property);if(object.__proto__=prototype,getter||setter)return getter&&(descriptor.get=getter),setter&&(descriptor.set=setter),descriptor}return descriptor.value=object[property],descriptor}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(object){return Object.keys(object)}),!Object.create){var createEmpty;createEmpty=null===Object.prototype.__proto__?function(){return{__proto__:null}}:function(){var empty={};for(var i in empty)empty[i]=null;return empty.constructor=empty.hasOwnProperty=empty.propertyIsEnumerable=empty.isPrototypeOf=empty.toLocaleString=empty.toString=empty.valueOf=empty.__proto__=null,empty},Object.create=function(prototype,properties){var object;if(null===prototype)object=createEmpty();else{if("object"!=typeof prototype)throw new TypeError("typeof prototype["+typeof prototype+"] != \'object\'");var Type=function(){};Type.prototype=prototype,object=new Type,object.__proto__=prototype}return void 0!==properties&&Object.defineProperties(object,properties),object}}if(Object.defineProperty){var definePropertyWorksOnObject=doesDefinePropertyWork({}),definePropertyWorksOnDom="undefined"==typeof document||doesDefinePropertyWork(document.createElement("div"));if(!definePropertyWorksOnObject||!definePropertyWorksOnDom)var definePropertyFallback=Object.defineProperty}if(!Object.defineProperty||definePropertyFallback){var ERR_NON_OBJECT_DESCRIPTOR="Property description must be an object: ",ERR_NON_OBJECT_TARGET="Object.defineProperty called on non-object: ",ERR_ACCESSORS_NOT_SUPPORTED="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(object,property,descriptor){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError(ERR_NON_OBJECT_TARGET+object);if("object"!=typeof descriptor&&"function"!=typeof descriptor||null===descriptor)throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR+descriptor);if(definePropertyFallback)try{return definePropertyFallback.call(Object,object,property,descriptor)}catch(exception){}if(owns(descriptor,"value"))if(supportsAccessors&&(lookupGetter(object,property)||lookupSetter(object,property))){var prototype=object.__proto__;object.__proto__=prototypeOfObject,delete object[property],object[property]=descriptor.value,object.__proto__=prototype}else object[property]=descriptor.value;else{if(!supportsAccessors)throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);owns(descriptor,"get")&&defineGetter(object,property,descriptor.get),owns(descriptor,"set")&&defineSetter(object,property,descriptor.set)}return object}}Object.defineProperties||(Object.defineProperties=function(object,properties){for(var property in properties)owns(properties,property)&&Object.defineProperty(object,property,properties[property]);return object}),Object.seal||(Object.seal=function(object){return object}),Object.freeze||(Object.freeze=function(object){return object});try{Object.freeze(function(){})}catch(exception){Object.freeze=function(freezeObject){return function(object){return"function"==typeof object?object:freezeObject(object)}}(Object.freeze)}if(Object.preventExtensions||(Object.preventExtensions=function(object){return object}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(object){if(Object(object)===object)throw new TypeError;for(var name="";owns(object,name);)name+="?";object[name]=!0;var returnValue=owns(object,name);return delete object[name],returnValue}),!Object.keys){var hasDontEnumBug=!0,dontEnums=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],dontEnumsLength=dontEnums.length;for(var key in{toString:null})hasDontEnumBug=!1;Object.keys=function(object){if("object"!=typeof object&&"function"!=typeof object||null===object)throw new TypeError("Object.keys called on a non-object");var keys=[];for(var name in object)owns(object,name)&&keys.push(name);if(hasDontEnumBug)for(var i=0,ii=dontEnumsLength;ii>i;i++){var dontEnum=dontEnums[i];owns(object,dontEnum)&&keys.push(dontEnum)}return keys}}Date.now||(Date.now=function(){return(new Date).getTime()});var ws="\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";if(!String.prototype.trim||ws.trim()){ws="["+ws+"]";var trimBeginRegexp=RegExp("^"+ws+ws+"*"),trimEndRegexp=RegExp(ws+ws+"*$");String.prototype.trim=function(){return(this+"").replace(trimBeginRegexp,"").replace(trimEndRegexp,"")}}var toObject=function(o){if(null==o)throw new TypeError("can\'t convert "+o+" to object");return Object(o)}});'},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"XJsonMode",{enumerable:!0,get:function(){return n.XJsonMode}}),Object.defineProperty(t,"installXJsonMode",{enumerable:!0,get:function(){return n.installXJsonMode}});var n=a(442)},function(e,t,a){"use strict";var n=a(125);Object.defineProperty(t,"__esModule",{value:!0}),t.XJsonMode=void 0,t.installXJsonMode=function(e){e.getSession().setMode(new b)};var i=n(a(189)),s=a(298),r=a(443);const{WorkerClient:o}=i.default.acequire("ace/worker/worker_client"),l=i.default.acequire("ace/lib/oop"),{Mode:c}=i.default.acequire("ace/mode/json"),{Tokenizer:d}=i.default.acequire("ace/tokenizer"),{MatchingBraceOutdent:u}=i.default.acequire("ace/mode/matching_brace_outdent"),{CstyleBehaviour:p}=i.default.acequire("ace/mode/behaviour/cstyle"),{FoldMode:m}=i.default.acequire("ace/mode/folding/cstyle"),b=function(){const e=new s.XJsonHighlightRules;e.normalizeRules(),this.$tokenizer=new d(e.getRules()),this.$outdent=new u,this.$behaviour=new p,this.foldingRules=new m};t.XJsonMode=b,l.inherits(b,c),b.prototype.createWorker=function(e){const t=new o(["ace"],r.workerModule,"JsonWorker");return t.attachToDocument(e.getDocument()),t.on("annotate",(function(t){e.setAnnotations(t.data)})),t.on("terminate",(function(){e.clearAnnotations()})),t}},function(e,t,a){"use strict";var n=a(125);Object.defineProperty(t,"__esModule",{value:!0}),t.workerModule=void 0;const i={id:"ace/mode/json_worker",src:n(a(444)).default};t.workerModule=i},function(e,t,a){"use strict";a.r(t),t.default='/*\n * Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one\n * or more contributor license agreements. Licensed under the Elastic License\n * 2.0 and the Server Side Public License, v 1; you may not use this file except\n * in compliance with, at your election, the Elastic License 2.0 or the Server\n * Side Public License, v 1.\n */\n\n/* @notice\n *\n * This product includes code that is based on Ace editor, which was available\n * under a "BSD" license.\n *\n * Distributed under the BSD license:\n *\n * Copyright (c) 2010, Ajax.org B.V.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without\n * modification, are permitted provided that the following conditions are met:\n *     * Redistributions of source code must retain the above copyright\n *       notice, this list of conditions and the following disclaimer.\n *     * Redistributions in binary form must reproduce the above copyright\n *       notice, this list of conditions and the following disclaimer in the\n *       documentation and/or other materials provided with the distribution.\n *     * Neither the name of Ajax.org B.V. nor the\n *       names of its contributors may be used to endorse or promote products\n *       derived from this software without specific prior written permission.\n *\n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL AJAX.ORG B.V. BE LIABLE FOR ANY\n * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND\n * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n */\n\n/* eslint-disable */\n/*\n  This file is loaded up as a blob by Brace to hand to Ace to load as Jsonp\n  (hence the redefining of everything).  It is based on the json\n  mode from the brace distro.\n\n  It is very likely that this file will be removed in future but for now it enables\n  extended JSON parsing, like e.g. """{}""" (triple quotes)\n*/\n// @internal\n// @ts-nocheck\n"no use strict";\n! function(window) {\n  function resolveModuleId(id, paths) {\n    for (var testPath = id, tail = ""; testPath;) {\n      var alias = paths[testPath];\n      if ("string" == typeof alias) return alias + tail;\n      if (alias) return alias.location.replace(/\\/*$/, "/") + (tail || alias.main || alias.name);\n      if (alias === !1) return "";\n      var i = testPath.lastIndexOf("/");\n      if (-1 === i) break;\n      tail = testPath.substr(i) + tail, testPath = testPath.slice(0, i)\n    }\n    return id\n  }\n  if (!(void 0 !== window.window && window.document || window.acequire && window.define)) {\n    window.console || (window.console = function() {\n      var msgs = Array.prototype.slice.call(arguments, 0);\n      postMessage({\n        type: "log",\n        data: msgs\n      })\n    }, window.console.error = window.console.warn = window.console.log = window.console.trace = window.console), window.window = window, window.ace = window, window.onerror = function(message, file, line, col, err) {\n      postMessage({\n        type: "error",\n        data: {\n          message: message,\n          data: err.data,\n          file: file,\n          line: line,\n          col: col,\n          stack: err.stack\n        }\n      })\n    }, window.normalizeModule = function(parentId, moduleName) {\n      if (-1 !== moduleName.indexOf("!")) {\n        var chunks = moduleName.split("!");\n        return window.normalizeModule(parentId, chunks[0]) + "!" + window.normalizeModule(parentId, chunks[1])\n      }\n      if ("." == moduleName.charAt(0)) {\n        var base = parentId.split("/").slice(0, -1).join("/");\n        for (moduleName = (base ? base + "/" : "") + moduleName; - 1 !== moduleName.indexOf(".") && previous != moduleName;) {\n          var previous = moduleName;\n          moduleName = moduleName.replace(/^\\.\\//, "").replace(/\\/\\.\\//, "/").replace(/[^\\/]+\\/\\.\\.\\//, "")\n        }\n      }\n      return moduleName\n    }, window.acequire = function acequire(parentId, id) {\n      if (id || (id = parentId, parentId = null), !id.charAt) throw Error("worker.js acequire() accepts only (parentId, id) as arguments");\n      id = window.normalizeModule(parentId, id);\n      var module = window.acequire.modules[id];\n      if (module) return module.initialized || (module.initialized = !0, module.exports = module.factory().exports), module.exports;\n      if (!window.acequire.tlns) return console.log("unable to load " + id);\n      var path = resolveModuleId(id, window.acequire.tlns);\n      return ".js" != path.slice(-3) && (path += ".js"), window.acequire.id = id, window.acequire.modules[id] = {}, importScripts(path), window.acequire(parentId, id)\n    }, window.acequire.modules = {}, window.acequire.tlns = {}, window.define = function(id, deps, factory) {\n      if (2 == arguments.length ? (factory = deps, "string" != typeof id && (deps = id, id = window.acequire.id)) : 1 == arguments.length && (factory = id, deps = [], id = window.acequire.id), "function" != typeof factory) return window.acequire.modules[id] = {\n        exports: factory,\n        initialized: !0\n      }, void 0;\n      deps.length || (deps = ["require", "exports", "module"]);\n      var req = function(childId) {\n        return window.acequire(id, childId)\n      };\n      window.acequire.modules[id] = {\n        exports: {},\n        factory: function() {\n          var module = this,\n            returnExports = factory.apply(this, deps.map(function(dep) {\n              switch (dep) {\n                case "require":\n                  return req;\n                case "exports":\n                  return module.exports;\n                case "module":\n                  return module;\n                default:\n                  return req(dep)\n              }\n            }));\n          return returnExports && (module.exports = returnExports), module\n        }\n      }\n    }, window.define.amd = {}, acequire.tlns = {}, window.initBaseUrls = function(topLevelNamespaces) {\n      for (var i in topLevelNamespaces) acequire.tlns[i] = topLevelNamespaces[i]\n    }, window.initSender = function() {\n      var EventEmitter = window.acequire("ace/lib/event_emitter").EventEmitter,\n        oop = window.acequire("ace/lib/oop"),\n        Sender = function() {};\n      return function() {\n        oop.implement(this, EventEmitter), this.callback = function(data, callbackId) {\n          postMessage({\n            type: "call",\n            id: callbackId,\n            data: data\n          })\n        }, this.emit = function(name, data) {\n          postMessage({\n            type: "event",\n            name: name,\n            data: data\n          })\n        }\n      }.call(Sender.prototype), new Sender\n    };\n    var main = window.main = null,\n      sender = window.sender = null;\n    window.onmessage = function(e) {\n      var msg = e.data;\n      if (msg.event && sender) sender._signal(msg.event, msg.data);\n      else if (msg.command)\n        if (main[msg.command]) main[msg.command].apply(main, msg.args);\n        else {\n          if (!window[msg.command]) throw Error("Unknown command:" + msg.command);\n          window[msg.command].apply(window, msg.args)\n        }\n      else if (msg.init) {\n        window.initBaseUrls(msg.tlns), acequire("ace/lib/es5-shim"), sender = window.sender = window.initSender();\n        var clazz = acequire(msg.module)[msg.classname];\n        main = window.main = new clazz(sender)\n      }\n    }\n  }\n}(this), ace.define("ace/lib/oop", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.inherits = function(ctor, superCtor) {\n    ctor.super_ = superCtor, ctor.prototype = Object.create(superCtor.prototype, {\n      constructor: {\n        value: ctor,\n        enumerable: !1,\n        writable: !0,\n        configurable: !0\n      }\n    })\n  }, exports.mixin = function(obj, mixin) {\n    for (var key in mixin) obj[key] = mixin[key];\n    return obj\n  }, exports.implement = function(proto, mixin) {\n    exports.mixin(proto, mixin)\n  }\n}), ace.define("ace/range", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var comparePoints = function(p1, p2) {\n      return p1.row - p2.row || p1.column - p2.column\n    },\n    Range = function(startRow, startColumn, endRow, endColumn) {\n      this.start = {\n        row: startRow,\n        column: startColumn\n      }, this.end = {\n        row: endRow,\n        column: endColumn\n      }\n    };\n  (function() {\n    this.isEqual = function(range) {\n      return this.start.row === range.start.row && this.end.row === range.end.row && this.start.column === range.start.column && this.end.column === range.end.column\n    }, this.toString = function() {\n      return "Range: [" + this.start.row + "/" + this.start.column + "] -> [" + this.end.row + "/" + this.end.column + "]"\n    }, this.contains = function(row, column) {\n      return 0 == this.compare(row, column)\n    }, this.compareRange = function(range) {\n      var cmp, end = range.end,\n        start = range.start;\n      return cmp = this.compare(end.row, end.column), 1 == cmp ? (cmp = this.compare(start.row, start.column), 1 == cmp ? 2 : 0 == cmp ? 1 : 0) : -1 == cmp ? -2 : (cmp = this.compare(start.row, start.column), -1 == cmp ? -1 : 1 == cmp ? 42 : 0)\n    }, this.comparePoint = function(p) {\n      return this.compare(p.row, p.column)\n    }, this.containsRange = function(range) {\n      return 0 == this.comparePoint(range.start) && 0 == this.comparePoint(range.end)\n    }, this.intersects = function(range) {\n      var cmp = this.compareRange(range);\n      return -1 == cmp || 0 == cmp || 1 == cmp\n    }, this.isEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column\n    }, this.isStart = function(row, column) {\n      return this.start.row == row && this.start.column == column\n    }, this.setStart = function(row, column) {\n      "object" == typeof row ? (this.start.column = row.column, this.start.row = row.row) : (this.start.row = row, this.start.column = column)\n    }, this.setEnd = function(row, column) {\n      "object" == typeof row ? (this.end.column = row.column, this.end.row = row.row) : (this.end.row = row, this.end.column = column)\n    }, this.inside = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) || this.isStart(row, column) ? !1 : !0 : !1\n    }, this.insideStart = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isEnd(row, column) ? !1 : !0 : !1\n    }, this.insideEnd = function(row, column) {\n      return 0 == this.compare(row, column) ? this.isStart(row, column) ? !1 : !0 : !1\n    }, this.compare = function(row, column) {\n      return this.isMultiLine() || row !== this.start.row ? this.start.row > row ? -1 : row > this.end.row ? 1 : this.start.row === row ? column >= this.start.column ? 0 : -1 : this.end.row === row ? this.end.column >= column ? 0 : 1 : 0 : this.start.column > column ? -1 : column > this.end.column ? 1 : 0\n    }, this.compareStart = function(row, column) {\n      return this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.compareEnd = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.compare(row, column)\n    }, this.compareInside = function(row, column) {\n      return this.end.row == row && this.end.column == column ? 1 : this.start.row == row && this.start.column == column ? -1 : this.compare(row, column)\n    }, this.clipRows = function(firstRow, lastRow) {\n      if (this.end.row > lastRow) var end = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.end.row) var end = {\n        row: firstRow,\n        column: 0\n      };\n      if (this.start.row > lastRow) var start = {\n        row: lastRow + 1,\n        column: 0\n      };\n      else if (firstRow > this.start.row) var start = {\n        row: firstRow,\n        column: 0\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.extend = function(row, column) {\n      var cmp = this.compare(row, column);\n      if (0 == cmp) return this;\n      if (-1 == cmp) var start = {\n        row: row,\n        column: column\n      };\n      else var end = {\n        row: row,\n        column: column\n      };\n      return Range.fromPoints(start || this.start, end || this.end)\n    }, this.isEmpty = function() {\n      return this.start.row === this.end.row && this.start.column === this.end.column\n    }, this.isMultiLine = function() {\n      return this.start.row !== this.end.row\n    }, this.clone = function() {\n      return Range.fromPoints(this.start, this.end)\n    }, this.collapseRows = function() {\n      return 0 == this.end.column ? new Range(this.start.row, 0, Math.max(this.start.row, this.end.row - 1), 0) : new Range(this.start.row, 0, this.end.row, 0)\n    }, this.toScreenRange = function(session) {\n      var screenPosStart = session.documentToScreenPosition(this.start),\n        screenPosEnd = session.documentToScreenPosition(this.end);\n      return new Range(screenPosStart.row, screenPosStart.column, screenPosEnd.row, screenPosEnd.column)\n    }, this.moveBy = function(row, column) {\n      this.start.row += row, this.start.column += column, this.end.row += row, this.end.column += column\n    }\n  }).call(Range.prototype), Range.fromPoints = function(start, end) {\n    return new Range(start.row, start.column, end.row, end.column)\n  }, Range.comparePoints = comparePoints, Range.comparePoints = function(p1, p2) {\n    return p1.row - p2.row || p1.column - p2.column\n  }, exports.Range = Range\n}), ace.define("ace/apply_delta", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.applyDelta = function(docLines, delta) {\n    var row = delta.start.row,\n      startColumn = delta.start.column,\n      line = docLines[row] || "";\n    switch (delta.action) {\n      case "insert":\n        var lines = delta.lines;\n        if (1 === lines.length) docLines[row] = line.substring(0, startColumn) + delta.lines[0] + line.substring(startColumn);\n        else {\n          var args = [row, 1].concat(delta.lines);\n          docLines.splice.apply(docLines, args), docLines[row] = line.substring(0, startColumn) + docLines[row], docLines[row + delta.lines.length - 1] += line.substring(startColumn)\n        }\n        break;\n      case "remove":\n        var endColumn = delta.end.column,\n          endRow = delta.end.row;\n        row === endRow ? docLines[row] = line.substring(0, startColumn) + line.substring(endColumn) : docLines.splice(row, endRow - row + 1, line.substring(0, startColumn) + docLines[endRow].substring(endColumn))\n    }\n  }\n}), ace.define("ace/lib/event_emitter", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  var EventEmitter = {},\n    stopPropagation = function() {\n      this.propagationStopped = !0\n    },\n    preventDefault = function() {\n      this.defaultPrevented = !0\n    };\n  EventEmitter._emit = EventEmitter._dispatchEvent = function(eventName, e) {\n    this._eventRegistry || (this._eventRegistry = {}), this._defaultHandlers || (this._defaultHandlers = {});\n    var listeners = this._eventRegistry[eventName] || [],\n      defaultHandler = this._defaultHandlers[eventName];\n    if (listeners.length || defaultHandler) {\n      "object" == typeof e && e || (e = {}), e.type || (e.type = eventName), e.stopPropagation || (e.stopPropagation = stopPropagation), e.preventDefault || (e.preventDefault = preventDefault), listeners = listeners.slice();\n      for (var i = 0; listeners.length > i && (listeners[i](e, this), !e.propagationStopped); i++);\n      return defaultHandler && !e.defaultPrevented ? defaultHandler(e, this) : void 0\n    }\n  }, EventEmitter._signal = function(eventName, e) {\n    var listeners = (this._eventRegistry || {})[eventName];\n    if (listeners) {\n      listeners = listeners.slice();\n      for (var i = 0; listeners.length > i; i++) listeners[i](e, this)\n    }\n  }, EventEmitter.once = function(eventName, callback) {\n    var _self = this;\n    callback && this.addEventListener(eventName, function newCallback() {\n      _self.removeEventListener(eventName, newCallback), callback.apply(null, arguments)\n    })\n  }, EventEmitter.setDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers || (handlers = this._defaultHandlers = {\n        _disabled_: {}\n      }), handlers[eventName]) {\n      var old = handlers[eventName],\n        disabled = handlers._disabled_[eventName];\n      disabled || (handlers._disabled_[eventName] = disabled = []), disabled.push(old);\n      var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n    }\n    handlers[eventName] = callback\n  }, EventEmitter.removeDefaultHandler = function(eventName, callback) {\n    var handlers = this._defaultHandlers;\n    if (handlers) {\n      var disabled = handlers._disabled_[eventName];\n      if (handlers[eventName] == callback) handlers[eventName], disabled && this.setDefaultHandler(eventName, disabled.pop());\n      else if (disabled) {\n        var i = disabled.indexOf(callback); - 1 != i && disabled.splice(i, 1)\n      }\n    }\n  }, EventEmitter.on = EventEmitter.addEventListener = function(eventName, callback, capturing) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    return listeners || (listeners = this._eventRegistry[eventName] = []), -1 == listeners.indexOf(callback) && listeners[capturing ? "unshift" : "push"](callback), callback\n  }, EventEmitter.off = EventEmitter.removeListener = EventEmitter.removeEventListener = function(eventName, callback) {\n    this._eventRegistry = this._eventRegistry || {};\n    var listeners = this._eventRegistry[eventName];\n    if (listeners) {\n      var index = listeners.indexOf(callback); - 1 !== index && listeners.splice(index, 1)\n    }\n  }, EventEmitter.removeAllListeners = function(eventName) {\n    this._eventRegistry && (this._eventRegistry[eventName] = [])\n  }, exports.EventEmitter = EventEmitter\n}), ace.define("ace/anchor", ["require", "exports", "module", "ace/lib/oop", "ace/lib/event_emitter"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Anchor = exports.Anchor = function(doc, row, column) {\n      this.$onChange = this.onChange.bind(this), this.attach(doc), column === void 0 ? this.setPosition(row.row, row.column) : this.setPosition(row, column)\n    };\n  (function() {\n    function $pointsInOrder(point1, point2, equalPointsInOrder) {\n      var bColIsAfter = equalPointsInOrder ? point1.column <= point2.column : point1.column < point2.column;\n      return point1.row < point2.row || point1.row == point2.row && bColIsAfter\n    }\n\n    function $getTransformedPoint(delta, point, moveIfEqual) {\n      var deltaIsInsert = "insert" == delta.action,\n        deltaRowShift = (deltaIsInsert ? 1 : -1) * (delta.end.row - delta.start.row),\n        deltaColShift = (deltaIsInsert ? 1 : -1) * (delta.end.column - delta.start.column),\n        deltaStart = delta.start,\n        deltaEnd = deltaIsInsert ? deltaStart : delta.end;\n      return $pointsInOrder(point, deltaStart, moveIfEqual) ? {\n        row: point.row,\n        column: point.column\n      } : $pointsInOrder(deltaEnd, point, !moveIfEqual) ? {\n        row: point.row + deltaRowShift,\n        column: point.column + (point.row == deltaEnd.row ? deltaColShift : 0)\n      } : {\n        row: deltaStart.row,\n        column: deltaStart.column\n      }\n    }\n    oop.implement(this, EventEmitter), this.getPosition = function() {\n      return this.$clipPositionToDocument(this.row, this.column)\n    }, this.getDocument = function() {\n      return this.document\n    }, this.$insertRight = !1, this.onChange = function(delta) {\n      if (!(delta.start.row == delta.end.row && delta.start.row != this.row || delta.start.row > this.row)) {\n        var point = $getTransformedPoint(delta, {\n          row: this.row,\n          column: this.column\n        }, this.$insertRight);\n        this.setPosition(point.row, point.column, !0)\n      }\n    }, this.setPosition = function(row, column, noClip) {\n      var pos;\n      if (pos = noClip ? {\n          row: row,\n          column: column\n        } : this.$clipPositionToDocument(row, column), this.row != pos.row || this.column != pos.column) {\n        var old = {\n          row: this.row,\n          column: this.column\n        };\n        this.row = pos.row, this.column = pos.column, this._signal("change", {\n          old: old,\n          value: pos\n        })\n      }\n    }, this.detach = function() {\n      this.document.removeEventListener("change", this.$onChange)\n    }, this.attach = function(doc) {\n      this.document = doc || this.document, this.document.on("change", this.$onChange)\n    }, this.$clipPositionToDocument = function(row, column) {\n      var pos = {};\n      return row >= this.document.getLength() ? (pos.row = Math.max(0, this.document.getLength() - 1), pos.column = this.document.getLine(pos.row).length) : 0 > row ? (pos.row = 0, pos.column = 0) : (pos.row = row, pos.column = Math.min(this.document.getLine(pos.row).length, Math.max(0, column))), 0 > column && (pos.column = 0), pos\n    }\n  }).call(Anchor.prototype)\n}), ace.define("ace/document", ["require", "exports", "module", "ace/lib/oop", "ace/apply_delta", "ace/lib/event_emitter", "ace/range", "ace/anchor"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("./lib/oop"),\n    applyDelta = acequire("./apply_delta").applyDelta,\n    EventEmitter = acequire("./lib/event_emitter").EventEmitter,\n    Range = acequire("./range").Range,\n    Anchor = acequire("./anchor").Anchor,\n    Document = function(textOrLines) {\n      this.$lines = [""], 0 === textOrLines.length ? this.$lines = [""] : Array.isArray(textOrLines) ? this.insertMergedLines({\n        row: 0,\n        column: 0\n      }, textOrLines) : this.insert({\n        row: 0,\n        column: 0\n      }, textOrLines)\n    };\n  (function() {\n    oop.implement(this, EventEmitter), this.setValue = function(text) {\n      var len = this.getLength() - 1;\n      this.remove(new Range(0, 0, len, this.getLine(len).length)), this.insert({\n        row: 0,\n        column: 0\n      }, text)\n    }, this.getValue = function() {\n      return this.getAllLines().join(this.getNewLineCharacter())\n    }, this.createAnchor = function(row, column) {\n      return new Anchor(this, row, column)\n    }, this.$split = 0 === "aaa".split(/a/).length ? function(text) {\n      return text.replace(/\\r\\n|\\r/g, "\\n").split("\\n")\n    } : function(text) {\n      return text.split(/\\r\\n|\\r|\\n/)\n    }, this.$detectNewLine = function(text) {\n      var match = text.match(/^.*?(\\r\\n|\\r|\\n)/m);\n      this.$autoNewLine = match ? match[1] : "\\n", this._signal("changeNewLineMode")\n    }, this.getNewLineCharacter = function() {\n      switch (this.$newLineMode) {\n        case "windows":\n          return "\\r\\n";\n        case "unix":\n          return "\\n";\n        default:\n          return this.$autoNewLine || "\\n"\n      }\n    }, this.$autoNewLine = "", this.$newLineMode = "auto", this.setNewLineMode = function(newLineMode) {\n      this.$newLineMode !== newLineMode && (this.$newLineMode = newLineMode, this._signal("changeNewLineMode"))\n    }, this.getNewLineMode = function() {\n      return this.$newLineMode\n    }, this.isNewLine = function(text) {\n      return "\\r\\n" == text || "\\r" == text || "\\n" == text\n    }, this.getLine = function(row) {\n      return this.$lines[row] || ""\n    }, this.getLines = function(firstRow, lastRow) {\n      return this.$lines.slice(firstRow, lastRow + 1)\n    }, this.getAllLines = function() {\n      return this.getLines(0, this.getLength())\n    }, this.getLength = function() {\n      return this.$lines.length\n    }, this.getTextRange = function(range) {\n      return this.getLinesForRange(range).join(this.getNewLineCharacter())\n    }, this.getLinesForRange = function(range) {\n      var lines;\n      if (range.start.row === range.end.row) lines = [this.getLine(range.start.row).substring(range.start.column, range.end.column)];\n      else {\n        lines = this.getLines(range.start.row, range.end.row), lines[0] = (lines[0] || "").substring(range.start.column);\n        var l = lines.length - 1;\n        range.end.row - range.start.row == l && (lines[l] = lines[l].substring(0, range.end.column))\n      }\n      return lines\n    }, this.insertLines = function(row, lines) {\n      return console.warn("Use of document.insertLines is deprecated. Use the insertFullLines method instead."), this.insertFullLines(row, lines)\n    }, this.removeLines = function(firstRow, lastRow) {\n      return console.warn("Use of document.removeLines is deprecated. Use the removeFullLines method instead."), this.removeFullLines(firstRow, lastRow)\n    }, this.insertNewLine = function(position) {\n      return console.warn("Use of document.insertNewLine is deprecated. Use insertMergedLines(position, [\'\', \'\']) instead."), this.insertMergedLines(position, ["", ""])\n    }, this.insert = function(position, text) {\n      return 1 >= this.getLength() && this.$detectNewLine(text), this.insertMergedLines(position, this.$split(text))\n    }, this.insertInLine = function(position, text) {\n      var start = this.clippedPos(position.row, position.column),\n        end = this.pos(position.row, position.column + text.length);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: [text]\n      }, !0), this.clonePos(end)\n    }, this.clippedPos = function(row, column) {\n      var length = this.getLength();\n      void 0 === row ? row = length : 0 > row ? row = 0 : row >= length && (row = length - 1, column = void 0);\n      var line = this.getLine(row);\n      return void 0 == column && (column = line.length), column = Math.min(Math.max(column, 0), line.length), {\n        row: row,\n        column: column\n      }\n    }, this.clonePos = function(pos) {\n      return {\n        row: pos.row,\n        column: pos.column\n      }\n    }, this.pos = function(row, column) {\n      return {\n        row: row,\n        column: column\n      }\n    }, this.$clipPosition = function(position) {\n      var length = this.getLength();\n      return position.row >= length ? (position.row = Math.max(0, length - 1), position.column = this.getLine(length - 1).length) : (position.row = Math.max(0, position.row), position.column = Math.min(Math.max(position.column, 0), this.getLine(position.row).length)), position\n    }, this.insertFullLines = function(row, lines) {\n      row = Math.min(Math.max(row, 0), this.getLength());\n      var column = 0;\n      this.getLength() > row ? (lines = lines.concat([""]), column = 0) : (lines = [""].concat(lines), row--, column = this.$lines[row].length), this.insertMergedLines({\n        row: row,\n        column: column\n      }, lines)\n    }, this.insertMergedLines = function(position, lines) {\n      var start = this.clippedPos(position.row, position.column),\n        end = {\n          row: start.row + lines.length - 1,\n          column: (1 == lines.length ? start.column : 0) + lines[lines.length - 1].length\n        };\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "insert",\n        lines: lines\n      }), this.clonePos(end)\n    }, this.remove = function(range) {\n      var start = this.clippedPos(range.start.row, range.start.column),\n        end = this.clippedPos(range.end.row, range.end.column);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }), this.clonePos(start)\n    }, this.removeInLine = function(row, startColumn, endColumn) {\n      var start = this.clippedPos(row, startColumn),\n        end = this.clippedPos(row, endColumn);\n      return this.applyDelta({\n        start: start,\n        end: end,\n        action: "remove",\n        lines: this.getLinesForRange({\n          start: start,\n          end: end\n        })\n      }, !0), this.clonePos(start)\n    }, this.removeFullLines = function(firstRow, lastRow) {\n      firstRow = Math.min(Math.max(0, firstRow), this.getLength() - 1), lastRow = Math.min(Math.max(0, lastRow), this.getLength() - 1);\n      var deleteFirstNewLine = lastRow == this.getLength() - 1 && firstRow > 0,\n        deleteLastNewLine = this.getLength() - 1 > lastRow,\n        startRow = deleteFirstNewLine ? firstRow - 1 : firstRow,\n        startCol = deleteFirstNewLine ? this.getLine(startRow).length : 0,\n        endRow = deleteLastNewLine ? lastRow + 1 : lastRow,\n        endCol = deleteLastNewLine ? 0 : this.getLine(endRow).length,\n        range = new Range(startRow, startCol, endRow, endCol),\n        deletedLines = this.$lines.slice(firstRow, lastRow + 1);\n      return this.applyDelta({\n        start: range.start,\n        end: range.end,\n        action: "remove",\n        lines: this.getLinesForRange(range)\n      }), deletedLines\n    }, this.removeNewLine = function(row) {\n      this.getLength() - 1 > row && row >= 0 && this.applyDelta({\n        start: this.pos(row, this.getLine(row).length),\n        end: this.pos(row + 1, 0),\n        action: "remove",\n        lines: ["", ""]\n      })\n    }, this.replace = function(range, text) {\n      if (range instanceof Range || (range = Range.fromPoints(range.start, range.end)), 0 === text.length && range.isEmpty()) return range.start;\n      if (text == this.getTextRange(range)) return range.end;\n      this.remove(range);\n      var end;\n      return end = text ? this.insert(range.start, text) : range.start\n    }, this.applyDeltas = function(deltas) {\n      for (var i = 0; deltas.length > i; i++) this.applyDelta(deltas[i])\n    }, this.revertDeltas = function(deltas) {\n      for (var i = deltas.length - 1; i >= 0; i--) this.revertDelta(deltas[i])\n    }, this.applyDelta = function(delta, doNotValidate) {\n      var isInsert = "insert" == delta.action;\n      (isInsert ? 1 >= delta.lines.length && !delta.lines[0] : !Range.comparePoints(delta.start, delta.end)) || (isInsert && delta.lines.length > 2e4 && this.$splitAndapplyLargeDelta(delta, 2e4), applyDelta(this.$lines, delta, doNotValidate), this._signal("change", delta))\n    }, this.$splitAndapplyLargeDelta = function(delta, MAX) {\n      for (var lines = delta.lines, l = lines.length, row = delta.start.row, column = delta.start.column, from = 0, to = 0;;) {\n        from = to, to += MAX - 1;\n        var chunk = lines.slice(from, to);\n        if (to > l) {\n          delta.lines = chunk, delta.start.row = row + from, delta.start.column = column;\n          break\n        }\n        chunk.push(""), this.applyDelta({\n          start: this.pos(row + from, column),\n          end: this.pos(row + to, column = 0),\n          action: delta.action,\n          lines: chunk\n        }, !0)\n      }\n    }, this.revertDelta = function(delta) {\n      this.applyDelta({\n        start: this.clonePos(delta.start),\n        end: this.clonePos(delta.end),\n        action: "insert" == delta.action ? "remove" : "insert",\n        lines: delta.lines.slice()\n      })\n    }, this.indexToPosition = function(index, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, i = startRow || 0, l = lines.length; l > i; i++)\n        if (index -= lines[i].length + newlineLength, 0 > index) return {\n          row: i,\n          column: index + lines[i].length + newlineLength\n        };\n      return {\n        row: l - 1,\n        column: lines[l - 1].length\n      }\n    }, this.positionToIndex = function(pos, startRow) {\n      for (var lines = this.$lines || this.getAllLines(), newlineLength = this.getNewLineCharacter().length, index = 0, row = Math.min(pos.row, lines.length), i = startRow || 0; row > i; ++i) index += lines[i].length + newlineLength;\n      return index + pos.column\n    }\n  }).call(Document.prototype), exports.Document = Document\n}), ace.define("ace/lib/lang", ["require", "exports", "module"], function(acequire, exports) {\n  "use strict";\n  exports.last = function(a) {\n    return a[a.length - 1]\n  }, exports.stringReverse = function(string) {\n    return string.split("").reverse().join("")\n  }, exports.stringRepeat = function(string, count) {\n    for (var result = ""; count > 0;) 1 & count && (result += string), (count >>= 1) && (string += string);\n    return result\n  };\n  var trimBeginRegexp = /^\\s\\s*/,\n    trimEndRegexp = /\\s\\s*$/;\n  exports.stringTrimLeft = function(string) {\n    return string.replace(trimBeginRegexp, "")\n  }, exports.stringTrimRight = function(string) {\n    return string.replace(trimEndRegexp, "")\n  }, exports.copyObject = function(obj) {\n    var copy = {};\n    for (var key in obj) copy[key] = obj[key];\n    return copy\n  }, exports.copyArray = function(array) {\n    for (var copy = [], i = 0, l = array.length; l > i; i++) copy[i] = array[i] && "object" == typeof array[i] ? this.copyObject(array[i]) : array[i];\n    return copy\n  }, exports.deepCopy = function deepCopy(obj) {\n    if ("object" != typeof obj || !obj) return obj;\n    var copy;\n    if (Array.isArray(obj)) {\n      copy = [];\n      for (var key = 0; obj.length > key; key++) copy[key] = deepCopy(obj[key]);\n      return copy\n    }\n    if ("[object Object]" !== Object.prototype.toString.call(obj)) return obj;\n    copy = {};\n    for (var key in obj) copy[key] = deepCopy(obj[key]);\n    return copy\n  }, exports.arrayToMap = function(arr) {\n    for (var map = {}, i = 0; arr.length > i; i++) map[arr[i]] = 1;\n    return map\n  }, exports.createMap = function(props) {\n    var map = Object.create(null);\n    for (var i in props) map[i] = props[i];\n    return map\n  }, exports.arrayRemove = function(array, value) {\n    for (var i = 0; array.length >= i; i++) value === array[i] && array.splice(i, 1)\n  }, exports.escapeRegExp = function(str) {\n    return str.replace(/([.*+?^${}()|[\\]\\/\\\\])/g, "\\\\$1")\n  }, exports.escapeHTML = function(str) {\n    return str.replace(/&/g, "&#38;").replace(/"/g, "&#34;").replace(/\'/g, "&#39;").replace(/</g, "&#60;")\n  }, exports.getMatchOffsets = function(string, regExp) {\n    var matches = [];\n    return string.replace(regExp, function(str) {\n      matches.push({\n        offset: arguments[arguments.length - 2],\n        length: str.length\n      })\n    }), matches\n  }, exports.deferredCall = function(fcn) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      deferred = function(timeout) {\n        return deferred.cancel(), timer = setTimeout(callback, timeout || 0), deferred\n      };\n    return deferred.schedule = deferred, deferred.call = function() {\n      return this.cancel(), fcn(), deferred\n    }, deferred.cancel = function() {\n      return clearTimeout(timer), timer = null, deferred\n    }, deferred.isPending = function() {\n      return timer\n    }, deferred\n  }, exports.delayedCall = function(fcn, defaultTimeout) {\n    var timer = null,\n      callback = function() {\n        timer = null, fcn()\n      },\n      _self = function(timeout) {\n        null == timer && (timer = setTimeout(callback, timeout || defaultTimeout))\n      };\n    return _self.delay = function(timeout) {\n      timer && clearTimeout(timer), timer = setTimeout(callback, timeout || defaultTimeout)\n    }, _self.schedule = _self, _self.call = function() {\n      this.cancel(), fcn()\n    }, _self.cancel = function() {\n      timer && clearTimeout(timer), timer = null\n    }, _self.isPending = function() {\n      return timer\n    }, _self\n  }\n}), ace.define("ace/worker/mirror", ["require", "exports", "module", "ace/range", "ace/document", "ace/lib/lang"], function(acequire, exports) {\n  "use strict";\n  acequire("../range").Range;\n  var Document = acequire("../document").Document,\n    lang = acequire("../lib/lang"),\n    Mirror = exports.Mirror = function(sender) {\n      this.sender = sender;\n      var doc = this.doc = new Document(""),\n        deferredUpdate = this.deferredUpdate = lang.delayedCall(this.onUpdate.bind(this)),\n        _self = this;\n      sender.on("change", function(e) {\n        var data = e.data;\n        if (data[0].start) doc.applyDeltas(data);\n        else\n          for (var i = 0; data.length > i; i += 2) {\n            if (Array.isArray(data[i + 1])) var d = {\n              action: "insert",\n              start: data[i],\n              lines: data[i + 1]\n            };\n            else var d = {\n              action: "remove",\n              start: data[i],\n              end: data[i + 1]\n            };\n            doc.applyDelta(d, !0)\n          }\n        return _self.$timeout ? deferredUpdate.schedule(_self.$timeout) : (_self.onUpdate(), void 0)\n      })\n    };\n  (function() {\n    this.$timeout = 500, this.setTimeout = function(timeout) {\n      this.$timeout = timeout\n    }, this.setValue = function(value) {\n      this.doc.setValue(value), this.deferredUpdate.schedule(this.$timeout)\n    }, this.getValue = function(callbackId) {\n      this.sender.callback(this.doc.getValue(), callbackId)\n    }, this.onUpdate = function() {}, this.isPending = function() {\n      return this.deferredUpdate.isPending()\n    }\n  }).call(Mirror.prototype)\n}), ace.define("ace/mode/json/json_parse", ["require", "exports", "module"], function() {\n  "use strict";\n  var at, ch, text, value, escapee = {\n      \'"\': \'"\',\n      "\\\\": "\\\\",\n      "/": "/",\n      b: "\\b",\n      f: "\\f",\n      n: "\\n",\n      r: "\\r",\n      t: "\t"\n    },\n    error = function(m) {\n      throw {\n        name: "SyntaxError",\n        message: m,\n        at: at,\n        text: text\n      }\n    },\n    reset = function (newAt) {\n      ch = text.charAt(newAt);\n      at = newAt + 1;\n    },\n    next = function(c) {\n      return c && c !== ch && error("Expected \'" + c + "\' instead of \'" + ch + "\'"), ch = text.charAt(at), at += 1, ch\n    },\n    nextUpTo = function (upTo, errorMessage) {\n      let currentAt = at,\n        i = text.indexOf(upTo, currentAt);\n      if (i < 0) {\n        error(errorMessage || \'Expected \\\'\' + upTo + \'\\\'\');\n      }\n      reset(i + upTo.length);\n      return text.substring(currentAt, i);\n    },\n    peek = function (c) {\n      return text.substr(at, c.length) === c; // nocommit - double check\n    },\n    number = function() {\n      var number, string = "";\n      for ("-" === ch && (string = "-", next("-")); ch >= "0" && "9" >= ch;) string += ch, next();\n      if ("." === ch)\n        for (string += "."; next() && ch >= "0" && "9" >= ch;) string += ch;\n      if ("e" === ch || "E" === ch)\n        for (string += ch, next(), ("-" === ch || "+" === ch) && (string += ch, next()); ch >= "0" && "9" >= ch;) string += ch, next();\n      return number = +string, isNaN(number) ? (error("Bad number"), void 0) : number\n    },\n    string = function() {\n      var hex, i, uffff, string = "";\n      if (\'"\' === ch) {\n        if (peek(\'""\')) {\n          // literal\n          next(\'"\');\n          next(\'"\');\n          return nextUpTo(\'"""\', \'failed to find closing \\\'"""\\\'\');\n        } else {\n          for (; next();) {\n            if (\'"\' === ch) return next(), string;\n            if ("\\\\" === ch)\n              if (next(), "u" === ch) {\n                for (uffff = 0, i = 0; 4 > i && (hex = parseInt(next(), 16), isFinite(hex)); i += 1) uffff = 16 * uffff + hex;\n                string += String.fromCharCode(uffff)\n              } else {\n                if ("string" != typeof escapee[ch]) break;\n                string += escapee[ch]\n              }\n            else string += ch\n          }\n        }\n      }\n      error("Bad string")\n    },\n    white = function() {\n      for (; ch && " " >= ch;) next()\n    },\n    word = function() {\n      switch (ch) {\n        case "t":\n          return next("t"), next("r"), next("u"), next("e"), !0;\n        case "f":\n          return next("f"), next("a"), next("l"), next("s"), next("e"), !1;\n        case "n":\n          return next("n"), next("u"), next("l"), next("l"), null\n      }\n      error("Unexpected \'" + ch + "\'")\n    },\n    array = function() {\n      var array = [];\n      if ("[" === ch) {\n        if (next("["), white(), "]" === ch) return next("]"), array;\n        for (; ch;) {\n          if (array.push(value()), white(), "]" === ch) return next("]"), array;\n          next(","), white()\n        }\n      }\n      error("Bad array")\n    },\n    object = function() {\n      var key, object = {};\n      if ("{" === ch) {\n        if (next("{"), white(), "}" === ch) return next("}"), object;\n        for (; ch;) {\n          if (key = string(), white(), next(":"), Object.hasOwnProperty.call(object, key) && error(\'Duplicate key "\' + key + \'"\'), object[key] = value(), white(), "}" === ch) return next("}"), object;\n          next(","), white()\n        }\n      }\n      error("Bad object")\n    };\n  return value = function() {\n      switch (white(), ch) {\n        case "{":\n          return object();\n        case "[":\n          return array();\n        case \'"\':\n          return string();\n        case "-":\n          return number();\n        default:\n          return ch >= "0" && "9" >= ch ? number() : word()\n      }\n    },\n    function(source, reviver) {\n      var result;\n      return text = source, at = 0, ch = " ", result = value(), white(), ch && error("Syntax error"), "function" == typeof reviver ? function walk(holder, key) {\n        var k, v, value = holder[key];\n        if (value && "object" == typeof value)\n          for (k in value) Object.hasOwnProperty.call(value, k) && (v = walk(value, k), void 0 !== v ? value[k] = v : delete value[k]);\n        return reviver.call(holder, key, value)\n      }({\n        "": result\n      }, "") : result\n    }\n}), ace.define("ace/mode/json_worker", ["require", "exports", "module", "ace/lib/oop", "ace/worker/mirror", "ace/mode/json/json_parse"], function(acequire, exports) {\n  "use strict";\n  var oop = acequire("../lib/oop"),\n    Mirror = acequire("../worker/mirror").Mirror,\n    parse = acequire("./json/json_parse"),\n    JsonWorker = exports.JsonWorker = function(sender) {\n      Mirror.call(this, sender), this.setTimeout(200)\n    };\n  oop.inherits(JsonWorker, Mirror),\n    function() {\n      this.onUpdate = function() {\n        var value = this.doc.getValue(),\n          errors = [];\n        try {\n          value && parse(value)\n        } catch (e) {\n          var pos = this.doc.indexToPosition(e.at - 1);\n          errors.push({\n            row: pos.row,\n            column: pos.column,\n            text: e.message,\n            type: "error"\n          })\n        }\n        this.sender.emit("annotate", errors)\n      }\n    }.call(JsonWorker.prototype)\n}), ace.define("ace/lib/es5-shim", ["require", "exports", "module"], function() {\n  function Empty() {}\n\n  function doesDefinePropertyWork(object) {\n    try {\n      return Object.defineProperty(object, "sentinel", {}), "sentinel" in object\n    } catch (exception) {}\n  }\n\n  function toInteger(n) {\n    return n = +n, n !== n ? n = 0 : 0 !== n && n !== 1 / 0 && n !== -(1 / 0) && (n = (n > 0 || -1) * Math.floor(Math.abs(n))), n\n  }\n  Function.prototype.bind || (Function.prototype.bind = function(that) {\n    var target = this;\n    if ("function" != typeof target) throw new TypeError("Function.prototype.bind called on incompatible " + target);\n    var args = slice.call(arguments, 1),\n      bound = function() {\n        if (this instanceof bound) {\n          var result = target.apply(this, args.concat(slice.call(arguments)));\n          return Object(result) === result ? result : this\n        }\n        return target.apply(that, args.concat(slice.call(arguments)))\n      };\n    return target.prototype && (Empty.prototype = target.prototype, bound.prototype = new Empty, Empty.prototype = null), bound\n  });\n  var defineGetter, defineSetter, lookupGetter, lookupSetter, supportsAccessors, call = Function.prototype.call,\n    prototypeOfArray = Array.prototype,\n    prototypeOfObject = Object.prototype,\n    slice = prototypeOfArray.slice,\n    _toString = call.bind(prototypeOfObject.toString),\n    owns = call.bind(prototypeOfObject.hasOwnProperty);\n  if ((supportsAccessors = owns(prototypeOfObject, "__defineGetter__")) && (defineGetter = call.bind(prototypeOfObject.__defineGetter__), defineSetter = call.bind(prototypeOfObject.__defineSetter__), lookupGetter = call.bind(prototypeOfObject.__lookupGetter__), lookupSetter = call.bind(prototypeOfObject.__lookupSetter__)), 2 != [1, 2].splice(0).length)\n    if (function() {\n        function makeArray(l) {\n          var a = Array(l + 2);\n          return a[0] = a[1] = 0, a\n        }\n        var lengthBefore, array = [];\n        return array.splice.apply(array, makeArray(20)), array.splice.apply(array, makeArray(26)), lengthBefore = array.length, array.splice(5, 0, "XXX"), lengthBefore + 1 == array.length, lengthBefore + 1 == array.length ? !0 : void 0\n      }()) {\n      var array_splice = Array.prototype.splice;\n      Array.prototype.splice = function(start, deleteCount) {\n        return arguments.length ? array_splice.apply(this, [void 0 === start ? 0 : start, void 0 === deleteCount ? this.length - start : deleteCount].concat(slice.call(arguments, 2))) : []\n      }\n    } else Array.prototype.splice = function(pos, removeCount) {\n      var length = this.length;\n      pos > 0 ? pos > length && (pos = length) : void 0 == pos ? pos = 0 : 0 > pos && (pos = Math.max(length + pos, 0)), length > pos + removeCount || (removeCount = length - pos);\n      var removed = this.slice(pos, pos + removeCount),\n        insert = slice.call(arguments, 2),\n        add = insert.length;\n      if (pos === length) add && this.push.apply(this, insert);\n      else {\n        var remove = Math.min(removeCount, length - pos),\n          tailOldPos = pos + remove,\n          tailNewPos = tailOldPos + add - remove,\n          tailCount = length - tailOldPos,\n          lengthAfterRemove = length - remove;\n        if (tailOldPos > tailNewPos)\n          for (var i = 0; tailCount > i; ++i) this[tailNewPos + i] = this[tailOldPos + i];\n        else if (tailNewPos > tailOldPos)\n          for (i = tailCount; i--;) this[tailNewPos + i] = this[tailOldPos + i];\n        if (add && pos === lengthAfterRemove) this.length = lengthAfterRemove, this.push.apply(this, insert);\n        else\n          for (this.length = lengthAfterRemove + add, i = 0; add > i; ++i) this[pos + i] = insert[i]\n      }\n      return removed\n    };\n  Array.isArray || (Array.isArray = function(obj) {\n    return "[object Array]" == _toString(obj)\n  });\n  var boxedString = Object("a"),\n    splitString = "a" != boxedString[0] || !(0 in boxedString);\n  if (Array.prototype.forEach || (Array.prototype.forEach = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        thisp = arguments[1],\n        i = -1,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError;\n      for (; length > ++i;) i in self && fun.call(thisp, self[i], i, object)\n    }), Array.prototype.map || (Array.prototype.map = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = Array(length),\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (result[i] = fun.call(thisp, self[i], i, object));\n      return result\n    }), Array.prototype.filter || (Array.prototype.filter = function(fun) {\n      var value, object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        result = [],\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++) i in self && (value = self[i], fun.call(thisp, value, i, object) && result.push(value));\n      return result\n    }), Array.prototype.every || (Array.prototype.every = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && !fun.call(thisp, self[i], i, object)) return !1;\n      return !0\n    }), Array.prototype.some || (Array.prototype.some = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0,\n        thisp = arguments[1];\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      for (var i = 0; length > i; i++)\n        if (i in self && fun.call(thisp, self[i], i, object)) return !0;\n      return !1\n    }), Array.prototype.reduce || (Array.prototype.reduce = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduce of empty array with no initial value");\n      var result, i = 0;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i++];\n            break\n          }\n          if (++i >= length) throw new TypeError("reduce of empty array with no initial value")\n        }\n      for (; length > i; i++) i in self && (result = fun.call(void 0, result, self[i], i, object));\n      return result\n    }), Array.prototype.reduceRight || (Array.prototype.reduceRight = function(fun) {\n      var object = toObject(this),\n        self = splitString && "[object String]" == _toString(this) ? this.split("") : object,\n        length = self.length >>> 0;\n      if ("[object Function]" != _toString(fun)) throw new TypeError(fun + " is not a function");\n      if (!length && 1 == arguments.length) throw new TypeError("reduceRight of empty array with no initial value");\n      var result, i = length - 1;\n      if (arguments.length >= 2) result = arguments[1];\n      else\n        for (;;) {\n          if (i in self) {\n            result = self[i--];\n            break\n          }\n          if (0 > --i) throw new TypeError("reduceRight of empty array with no initial value")\n        }\n      do i in this && (result = fun.call(void 0, result, self[i], i, object)); while (i--);\n      return result\n    }), Array.prototype.indexOf && -1 == [0, 1].indexOf(1, 2) || (Array.prototype.indexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = 0;\n      for (arguments.length > 1 && (i = toInteger(arguments[1])), i = i >= 0 ? i : Math.max(0, length + i); length > i; i++)\n        if (i in self && self[i] === sought) return i;\n      return -1\n    }), Array.prototype.lastIndexOf && -1 == [0, 1].lastIndexOf(0, -3) || (Array.prototype.lastIndexOf = function(sought) {\n      var self = splitString && "[object String]" == _toString(this) ? this.split("") : toObject(this),\n        length = self.length >>> 0;\n      if (!length) return -1;\n      var i = length - 1;\n      for (arguments.length > 1 && (i = Math.min(i, toInteger(arguments[1]))), i = i >= 0 ? i : length - Math.abs(i); i >= 0; i--)\n        if (i in self && sought === self[i]) return i;\n      return -1\n    }), Object.getPrototypeOf || (Object.getPrototypeOf = function(object) {\n      return object.__proto__ || (object.constructor ? object.constructor.prototype : prototypeOfObject)\n    }), !Object.getOwnPropertyDescriptor) {\n    var ERR_NON_OBJECT = "Object.getOwnPropertyDescriptor called on a non-object: ";\n    Object.getOwnPropertyDescriptor = function(object, property) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT + object);\n      if (owns(object, property)) {\n        var descriptor, getter, setter;\n        if (descriptor = {\n            enumerable: !0,\n            configurable: !0\n          }, supportsAccessors) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject;\n          var getter = lookupGetter(object, property),\n            setter = lookupSetter(object, property);\n          if (object.__proto__ = prototype, getter || setter) return getter && (descriptor.get = getter), setter && (descriptor.set = setter), descriptor\n        }\n        return descriptor.value = object[property], descriptor\n      }\n    }\n  }\n  if (Object.getOwnPropertyNames || (Object.getOwnPropertyNames = function(object) {\n      return Object.keys(object)\n    }), !Object.create) {\n    var createEmpty;\n    createEmpty = null === Object.prototype.__proto__ ? function() {\n      return {\n        __proto__: null\n      }\n    } : function() {\n      var empty = {};\n      for (var i in empty) empty[i] = null;\n      return empty.constructor = empty.hasOwnProperty = empty.propertyIsEnumerable = empty.isPrototypeOf = empty.toLocaleString = empty.toString = empty.valueOf = empty.__proto__ = null, empty\n    }, Object.create = function(prototype, properties) {\n      var object;\n      if (null === prototype) object = createEmpty();\n      else {\n        if ("object" != typeof prototype) throw new TypeError("typeof prototype[" + typeof prototype + "] != \'object\'");\n        var Type = function() {};\n        Type.prototype = prototype, object = new Type, object.__proto__ = prototype\n      }\n      return void 0 !== properties && Object.defineProperties(object, properties), object\n    }\n  }\n  if (Object.defineProperty) {\n    var definePropertyWorksOnObject = doesDefinePropertyWork({}),\n      definePropertyWorksOnDom = "undefined" == typeof document || doesDefinePropertyWork(document.createElement("div"));\n    if (!definePropertyWorksOnObject || !definePropertyWorksOnDom) var definePropertyFallback = Object.defineProperty\n  }\n  if (!Object.defineProperty || definePropertyFallback) {\n    var ERR_NON_OBJECT_DESCRIPTOR = "Property description must be an object: ",\n      ERR_NON_OBJECT_TARGET = "Object.defineProperty called on non-object: ",\n      ERR_ACCESSORS_NOT_SUPPORTED = "getters & setters can not be defined on this javascript engine";\n    Object.defineProperty = function(object, property, descriptor) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError(ERR_NON_OBJECT_TARGET + object);\n      if ("object" != typeof descriptor && "function" != typeof descriptor || null === descriptor) throw new TypeError(ERR_NON_OBJECT_DESCRIPTOR + descriptor);\n      if (definePropertyFallback) try {\n        return definePropertyFallback.call(Object, object, property, descriptor)\n      } catch (exception) {}\n      if (owns(descriptor, "value"))\n        if (supportsAccessors && (lookupGetter(object, property) || lookupSetter(object, property))) {\n          var prototype = object.__proto__;\n          object.__proto__ = prototypeOfObject, delete object[property], object[property] = descriptor.value, object.__proto__ = prototype\n        } else object[property] = descriptor.value;\n      else {\n        if (!supportsAccessors) throw new TypeError(ERR_ACCESSORS_NOT_SUPPORTED);\n        owns(descriptor, "get") && defineGetter(object, property, descriptor.get), owns(descriptor, "set") && defineSetter(object, property, descriptor.set)\n      }\n      return object\n    }\n  }\n  Object.defineProperties || (Object.defineProperties = function(object, properties) {\n    for (var property in properties) owns(properties, property) && Object.defineProperty(object, property, properties[property]);\n    return object\n  }), Object.seal || (Object.seal = function(object) {\n    return object\n  }), Object.freeze || (Object.freeze = function(object) {\n    return object\n  });\n  try {\n    Object.freeze(function() {})\n  } catch (exception) {\n    Object.freeze = function(freezeObject) {\n      return function(object) {\n        return "function" == typeof object ? object : freezeObject(object)\n      }\n    }(Object.freeze)\n  }\n  if (Object.preventExtensions || (Object.preventExtensions = function(object) {\n      return object\n    }), Object.isSealed || (Object.isSealed = function() {\n      return !1\n    }), Object.isFrozen || (Object.isFrozen = function() {\n      return !1\n    }), Object.isExtensible || (Object.isExtensible = function(object) {\n      if (Object(object) === object) throw new TypeError;\n      for (var name = ""; owns(object, name);) name += "?";\n      object[name] = !0;\n      var returnValue = owns(object, name);\n      return delete object[name], returnValue\n    }), !Object.keys) {\n    var hasDontEnumBug = !0,\n      dontEnums = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"],\n      dontEnumsLength = dontEnums.length;\n    for (var key in {\n        toString: null\n      }) hasDontEnumBug = !1;\n    Object.keys = function(object) {\n      if ("object" != typeof object && "function" != typeof object || null === object) throw new TypeError("Object.keys called on a non-object");\n      var keys = [];\n      for (var name in object) owns(object, name) && keys.push(name);\n      if (hasDontEnumBug)\n        for (var i = 0, ii = dontEnumsLength; ii > i; i++) {\n          var dontEnum = dontEnums[i];\n          owns(object, dontEnum) && keys.push(dontEnum)\n        }\n      return keys\n    }\n  }\n  Date.now || (Date.now = function() {\n    return (new Date).getTime()\n  });\n  var ws = "\t\\n\v\\f\\r   ᠎             　\\u2028\\u2029\ufeff";\n  if (!String.prototype.trim || ws.trim()) {\n    ws = "[" + ws + "]";\n    var trimBeginRegexp = RegExp("^" + ws + ws + "*"),\n      trimEndRegexp = RegExp(ws + ws + "*$");\n    String.prototype.trim = function() {\n      return (this + "").replace(trimBeginRegexp, "").replace(trimEndRegexp, "")\n    }\n  }\n  var toObject = function(o) {\n    if (null == o) throw new TypeError("can\'t convert " + o + " to object");\n    return Object(o)\n  }\n});\n'},function(e,t,a){"use strict";var n=a(446),i=a(447);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=x,t.resolve=function(e,t){return x(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?x(e,!1,!0).resolveObject(t):t},t.format=function(e){i.isString(e)&&(e=x(e));return e instanceof s?e.format():s.prototype.format.call(e)},t.Url=s;var r=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,l=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(c),u=["%","/","?",";","#"].concat(d),p=["/","?","#"],m=/^[+a-z0-9A-Z_-]{0,63}$/,b=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,f={javascript:!0,"javascript:":!0},h={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},j=a(448);function x(e,t,a){if(e&&i.isObject(e)&&e instanceof s)return e;var n=new s;return n.parse(e,t,a),n}s.prototype.parse=function(e,t,a){if(!i.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),o=-1!==s&&s<e.indexOf("#")?"?":"#",c=e.split(o);c[0]=c[0].replace(/\\/g,"/");var x=e=c.join(o);if(x=x.trim(),!a&&1===e.split("#").length){var v=l.exec(x);if(v)return this.path=x,this.href=x,this.pathname=v[1],v[2]?(this.search=v[2],this.query=t?j.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var y=r.exec(x);if(y){var O=(y=y[0]).toLowerCase();this.protocol=O,x=x.substr(y.length)}if(a||y||x.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===x.substr(0,2);!E||y&&h[y]||(x=x.substr(2),this.slashes=!0)}if(!h[y]&&(E||y&&!g[y])){for(var w,M,S=-1,_=0;_<p.length;_++){-1!==(T=x.indexOf(p[_]))&&(-1===S||T<S)&&(S=T)}-1!==(M=-1===S?x.lastIndexOf("@"):x.lastIndexOf("@",S))&&(w=x.slice(0,M),x=x.slice(M+1),this.auth=decodeURIComponent(w)),S=-1;for(_=0;_<u.length;_++){var T;-1!==(T=x.indexOf(u[_]))&&(-1===S||T<S)&&(S=T)}-1===S&&(S=x.length),this.host=x.slice(0,S),x=x.slice(S),this.parseHost(),this.hostname=this.hostname||"";var C="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!C)for(var k=this.hostname.split(/\./),F=(_=0,k.length);_<F;_++){var I=k[_];if(I&&!I.match(m)){for(var D="",A=0,L=I.length;A<L;A++)I.charCodeAt(A)>127?D+="x":D+=I[A];if(!D.match(m)){var R=k.slice(0,_),N=k.slice(_+1),P=I.match(b);P&&(R.push(P[1]),N.unshift(P[2])),N.length&&(x="/"+N.join(".")+x),this.hostname=R.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),C||(this.hostname=n.toASCII(this.hostname));var z=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+z,this.href+=this.host,C&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==x[0]&&(x="/"+x))}if(!f[O])for(_=0,F=d.length;_<F;_++){var J=d[_];if(-1!==x.indexOf(J)){var V=encodeURIComponent(J);V===J&&(V=escape(J)),x=x.split(J).join(V)}}var U=x.indexOf("#");-1!==U&&(this.hash=x.substr(U),x=x.slice(0,U));var G=x.indexOf("?");if(-1!==G?(this.search=x.substr(G),this.query=x.substr(G+1),t&&(this.query=j.parse(this.query)),x=x.slice(0,G)):t&&(this.search="",this.query={}),x&&(this.pathname=x),g[O]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){z=this.pathname||"";var q=this.search||"";this.path=z+q}return this.href=this.format(),this},s.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",a=this.pathname||"",n=this.hash||"",s=!1,r="";this.host?s=e+this.host:this.hostname&&(s=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&i.isObject(this.query)&&Object.keys(this.query).length&&(r=j.stringify(this.query));var o=this.search||r&&"?"+r||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==s?(s="//"+(s||""),a&&"/"!==a.charAt(0)&&(a="/"+a)):s||(s=""),n&&"#"!==n.charAt(0)&&(n="#"+n),o&&"?"!==o.charAt(0)&&(o="?"+o),t+s+(a=a.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(o=o.replace("#","%23"))+n},s.prototype.resolve=function(e){return this.resolveObject(x(e,!1,!0)).format()},s.prototype.resolveObject=function(e){if(i.isString(e)){var t=new s;t.parse(e,!1,!0),e=t}for(var a=new s,n=Object.keys(this),r=0;r<n.length;r++){var o=n[r];a[o]=this[o]}if(a.hash=e.hash,""===e.href)return a.href=a.format(),a;if(e.slashes&&!e.protocol){for(var l=Object.keys(e),c=0;c<l.length;c++){var d=l[c];"protocol"!==d&&(a[d]=e[d])}return g[a.protocol]&&a.hostname&&!a.pathname&&(a.path=a.pathname="/"),a.href=a.format(),a}if(e.protocol&&e.protocol!==a.protocol){if(!g[e.protocol]){for(var u=Object.keys(e),p=0;p<u.length;p++){var m=u[p];a[m]=e[m]}return a.href=a.format(),a}if(a.protocol=e.protocol,e.host||h[e.protocol])a.pathname=e.pathname;else{for(var b=(e.pathname||"").split("/");b.length&&!(e.host=b.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==b[0]&&b.unshift(""),b.length<2&&b.unshift(""),a.pathname=b.join("/")}if(a.search=e.search,a.query=e.query,a.host=e.host||"",a.auth=e.auth,a.hostname=e.hostname||e.host,a.port=e.port,a.pathname||a.search){var f=a.pathname||"",j=a.search||"";a.path=f+j}return a.slashes=a.slashes||e.slashes,a.href=a.format(),a}var x=a.pathname&&"/"===a.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=v||x||a.host&&e.pathname,O=y,E=a.pathname&&a.pathname.split("/")||[],w=(b=e.pathname&&e.pathname.split("/")||[],a.protocol&&!g[a.protocol]);if(w&&(a.hostname="",a.port=null,a.host&&(""===E[0]?E[0]=a.host:E.unshift(a.host)),a.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===b[0]?b[0]=e.host:b.unshift(e.host)),e.host=null),y=y&&(""===b[0]||""===E[0])),v)a.host=e.host||""===e.host?e.host:a.host,a.hostname=e.hostname||""===e.hostname?e.hostname:a.hostname,a.search=e.search,a.query=e.query,E=b;else if(b.length)E||(E=[]),E.pop(),E=E.concat(b),a.search=e.search,a.query=e.query;else if(!i.isNullOrUndefined(e.search)){if(w)a.hostname=a.host=E.shift(),(C=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=C.shift(),a.host=a.hostname=C.shift());return a.search=e.search,a.query=e.query,i.isNull(a.pathname)&&i.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.href=a.format(),a}if(!E.length)return a.pathname=null,a.search?a.path="/"+a.search:a.path=null,a.href=a.format(),a;for(var M=E.slice(-1)[0],S=(a.host||e.host||E.length>1)&&("."===M||".."===M)||""===M,_=0,T=E.length;T>=0;T--)"."===(M=E[T])?E.splice(T,1):".."===M?(E.splice(T,1),_++):_&&(E.splice(T,1),_--);if(!y&&!O)for(;_--;_)E.unshift("..");!y||""===E[0]||E[0]&&"/"===E[0].charAt(0)||E.unshift(""),S&&"/"!==E.join("/").substr(-1)&&E.push("");var C,k=""===E[0]||E[0]&&"/"===E[0].charAt(0);w&&(a.hostname=a.host=k?"":E.length?E.shift():"",(C=!!(a.host&&a.host.indexOf("@")>0)&&a.host.split("@"))&&(a.auth=C.shift(),a.host=a.hostname=C.shift()));return(y=y||a.host&&E.length)&&!k&&E.unshift(""),E.length?a.pathname=E.join("/"):(a.pathname=null,a.path=null),i.isNull(a.pathname)&&i.isNull(a.search)||(a.path=(a.pathname?a.pathname:"")+(a.search?a.search:"")),a.auth=e.auth||a.auth,a.slashes=a.slashes||e.slashes,a.href=a.format(),a},s.prototype.parseHost=function(){var e=this.host,t=o.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,a){(function(e,n){var i;/*! https://mths.be/punycode v1.4.1 by @mathias */!function(s){t&&t.nodeType,e&&e.nodeType;var r="object"==typeof n&&n;r.global!==r&&r.window!==r&&r.self;var o,l=2147483647,c=36,d=/^xn--/,u=/[^\x20-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,m={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=Math.floor,f=String.fromCharCode;function h(e){throw new RangeError(m[e])}function g(e,t){for(var a=e.length,n=[];a--;)n[a]=t(e[a]);return n}function j(e,t){var a=e.split("@"),n="";return a.length>1&&(n=a[0]+"@",e=a[1]),n+g((e=e.replace(p,".")).split("."),t).join(".")}function x(e){for(var t,a,n=[],i=0,s=e.length;i<s;)(t=e.charCodeAt(i++))>=55296&&t<=56319&&i<s?56320==(64512&(a=e.charCodeAt(i++)))?n.push(((1023&t)<<10)+(1023&a)+65536):(n.push(t),i--):n.push(t);return n}function v(e){return g(e,(function(e){var t="";return e>65535&&(t+=f((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=f(e)})).join("")}function y(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function O(e,t,a){var n=0;for(e=a?b(e/700):e>>1,e+=b(e/t);e>455;n+=c)e=b(e/35);return b(n+36*e/(e+38))}function E(e){var t,a,n,i,s,r,o,d,u,p,m,f=[],g=e.length,j=0,x=128,y=72;for((a=e.lastIndexOf("-"))<0&&(a=0),n=0;n<a;++n)e.charCodeAt(n)>=128&&h("not-basic"),f.push(e.charCodeAt(n));for(i=a>0?a+1:0;i<g;){for(s=j,r=1,o=c;i>=g&&h("invalid-input"),((d=(m=e.charCodeAt(i++))-48<10?m-22:m-65<26?m-65:m-97<26?m-97:c)>=c||d>b((l-j)/r))&&h("overflow"),j+=d*r,!(d<(u=o<=y?1:o>=y+26?26:o-y));o+=c)r>b(l/(p=c-u))&&h("overflow"),r*=p;y=O(j-s,t=f.length+1,0==s),b(j/t)>l-x&&h("overflow"),x+=b(j/t),j%=t,f.splice(j++,0,x)}return v(f)}function w(e){var t,a,n,i,s,r,o,d,u,p,m,g,j,v,E,w=[];for(g=(e=x(e)).length,t=128,a=0,s=72,r=0;r<g;++r)(m=e[r])<128&&w.push(f(m));for(n=i=w.length,i&&w.push("-");n<g;){for(o=l,r=0;r<g;++r)(m=e[r])>=t&&m<o&&(o=m);for(o-t>b((l-a)/(j=n+1))&&h("overflow"),a+=(o-t)*j,t=o,r=0;r<g;++r)if((m=e[r])<t&&++a>l&&h("overflow"),m==t){for(d=a,u=c;!(d<(p=u<=s?1:u>=s+26?26:u-s));u+=c)E=d-p,v=c-p,w.push(f(y(p+E%v,0))),d=b(E/v);w.push(f(y(d,0))),s=O(a,j,n==i),a=0,++n}++a,++t}return w.join("")}o={version:"1.4.1",ucs2:{decode:x,encode:v},decode:E,encode:w,toASCII:function(e){return j(e,(function(e){return u.test(e)?"xn--"+w(e):e}))},toUnicode:function(e){return j(e,(function(e){return d.test(e)?E(e.slice(4).toLowerCase()):e}))}},void 0===(i=function(){return o}.call(t,a,t,e))||(e.exports=i)}()}).call(this,a(294)(e),a(133))},function(e,t,a){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,a){"use strict";t.decode=t.parse=a(449),t.encode=t.stringify=a(450)},function(e,t,a){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,a,s){t=t||"&",a=a||"=";var r={};if("string"!=typeof e||0===e.length)return r;var o=/\+/g;e=e.split(t);var l=1e3;s&&"number"==typeof s.maxKeys&&(l=s.maxKeys);var c=e.length;l>0&&c>l&&(c=l);for(var d=0;d<c;++d){var u,p,m,b,f=e[d].replace(o,"%20"),h=f.indexOf(a);h>=0?(u=f.substr(0,h),p=f.substr(h+1)):(u=f,p=""),m=decodeURIComponent(u),b=decodeURIComponent(p),n(r,m)?i(r[m])?r[m].push(b):r[m]=[r[m],b]:r[m]=b}return r};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,a){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,a,o){return t=t||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?s(r(e),(function(r){var o=encodeURIComponent(n(r))+a;return i(e[r])?s(e[r],(function(e){return o+encodeURIComponent(n(e))})).join(t):o+encodeURIComponent(n(e[r]))})).join(t):o?encodeURIComponent(n(o))+a+encodeURIComponent(n(e)):""};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(e,t){if(e.map)return e.map(t);for(var a=[],n=0;n<e.length;n++)a.push(t(e[n],n));return a}var r=Object.keys||function(e){var t=[];for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.push(a);return t}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(452);case"v8light":return a(454)}},function(e,t,a){var n=a(78),i=a(453);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #343741}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#25262E}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#1D1E24;background-color:#36A2EF}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:6px 6px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 6px 6px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(455);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".time-range-selector .time-range-section-container{display:flex}.time-range-selector .time-range-section-title{font-weight:bold;margin-bottom:8px}.time-range-selector .time-range-section{flex:50%;padding:0 8px;border-right:1px solid #D3DAE6}.time-range-selector .tab-stack{margin-bottom:0;padding-left:0;list-style:none}.time-range-selector .tab-stack>li{float:none;position:relative;display:block;margin-bottom:4px}.time-range-selector .tab-stack>li>a{position:relative;display:block;padding:8px 16px;border-radius:4px}.time-range-selector .tab-stack>li>a:hover{background-color:#F5F7FA}.time-range-selector .tab-stack>li .body{display:none}.time-range-selector .tab-stack>li.active>a{color:#fff;background-color:#07C}.time-range-selector .tab-stack>li.active .body{display:block;height:315px}.time-range-selector .tab-stack>li.has-body.active>a{border-radius:6px 6px 0 0}.time-range-selector .tab-stack>li.has-body.active .react-datepicker{border-radius:0 0 6px 6px;border-top:none}.time-range-selector .time-range-section:last-child{border-right:none}\n",""]),e.exports=t},function(e,t,a){e.exports=a.p+"7a4082435b3e1246960afd2e97c6c091.png"},function(e,t,a){"use strict";t.byteLength=function(e){var t=c(e),a=t[0],n=t[1];return 3*(a+n)/4-n},t.toByteArray=function(e){var t,a,n=c(e),r=n[0],o=n[1],l=new s(function(e,t,a){return 3*(t+a)/4-a}(0,r,o)),d=0,u=o>0?r-4:r;for(a=0;a<u;a+=4)t=i[e.charCodeAt(a)]<<18|i[e.charCodeAt(a+1)]<<12|i[e.charCodeAt(a+2)]<<6|i[e.charCodeAt(a+3)],l[d++]=t>>16&255,l[d++]=t>>8&255,l[d++]=255&t;2===o&&(t=i[e.charCodeAt(a)]<<2|i[e.charCodeAt(a+1)]>>4,l[d++]=255&t);1===o&&(t=i[e.charCodeAt(a)]<<10|i[e.charCodeAt(a+1)]<<4|i[e.charCodeAt(a+2)]>>2,l[d++]=t>>8&255,l[d++]=255&t);return l},t.fromByteArray=function(e){for(var t,a=e.length,i=a%3,s=[],r=16383,o=0,l=a-i;o<l;o+=r)s.push(d(e,o,o+r>l?l:o+r));1===i?(t=e[a-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[a-2]<<8)+e[a-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return s.join("")};for(var n=[],i=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=r.length;o<l;++o)n[o]=r[o],i[r.charCodeAt(o)]=o;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var a=e.indexOf("=");return-1===a&&(a=t),[a,a===t?0:4-a%4]}function d(e,t,a){for(var i,s,r=[],o=t;o<a;o+=3)i=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),r.push(n[(s=i)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return r.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,a,n,i){var s,r,o=8*i-n-1,l=(1<<o)-1,c=l>>1,d=-7,u=a?i-1:0,p=a?-1:1,m=e[t+u];for(u+=p,s=m&(1<<-d)-1,m>>=-d,d+=o;d>0;s=256*s+e[t+u],u+=p,d-=8);for(r=s&(1<<-d)-1,s>>=-d,d+=n;d>0;r=256*r+e[t+u],u+=p,d-=8);if(0===s)s=1-c;else{if(s===l)return r?NaN:1/0*(m?-1:1);r+=Math.pow(2,n),s-=c}return(m?-1:1)*r*Math.pow(2,s-n)},t.write=function(e,t,a,n,i,s){var r,o,l,c=8*s-i-1,d=(1<<c)-1,u=d>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,m=n?0:s-1,b=n?1:-1,f=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,r=d):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+u>=1?p/l:p*Math.pow(2,1-u))*l>=2&&(r++,l/=2),r+u>=d?(o=0,r=d):r+u>=1?(o=(t*l-1)*Math.pow(2,i),r+=u):(o=t*Math.pow(2,u-1)*Math.pow(2,i),r=0));i>=8;e[a+m]=255&o,m+=b,o/=256,i-=8);for(r=r<<i|o,c+=i;c>0;e[a+m]=255&r,m+=b,r/=256,c-=8);e[a+m-b]|=128*f}},function(e,t){var a={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==a.call(e)}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var a=function(){};a.prototype=t.prototype,e.prototype=new a,e.prototype.constructor=e}},function(e,t,a){"use strict";var n=a(171),i=a(117).CalendarObject,s=a(117).schema,r=a(198).iCalendar,o=a(197).RRule,l=t.VEvent=function(e,t){e instanceof r||null==e||(t=e,e=null),i.call(this,e,"VEVENT"),void 0!==t&&(this.addProperty("DTSTAMP",new Date),this.addProperty("UID",t))};n.inherits(l,i),l.prototype.setSummary=function(e){this.addProperty("SUMMARY",e)},l.prototype.setLocation=function(e){this.addProperty("LOCATION",e)},l.prototype.setDescription=function(e){this.addProperty("DESCRIPTION",e)},l.prototype.setDate=function(e,t){this.addProperty("DTSTART",e),t instanceof Date?this.addProperty("DTEND",t):this.addProperty("DURATION",t)},l.prototype.rrule=function(){var e=this.getPropertyValue("RRULE");if(!e)return null;for(var t,a=[],n=0;t=this.getPropertyValue("EXDATE",n++);)a.push.apply(a,t);return new o(e,{DTSTART:this.getPropertyValue("DTSTART"),DTEND:this.getPropertyValue("DTEND"),EXDATE:a})},l.prototype.inTimeRange=function(e,t){var a=this.rrule();if(a){var n=a.next(e);return null!==n&&(!t||n<=t)}var i=this.getPropertyValue("DTSTART"),s=this.getPropertyValue("DTEND");if(!s){var r=this.getPropertyValue("DURATION");if(0===r)return(!e||e<=i)&&(!t||t>i);s=r?new Date(i.valueOf()+1e3*this.getPropertyValue("DURATION")):new Date(i.valueOf()+864e5)}return(!e||e<s)&&(!t||t>i)},l.prototype.reply=function(e,t,a){var n=this.clone(!0);a=a||{},!0===t||void 0===t?t="ACCEPTED":!1===t&&(t="DECLINED"),n.setProperty("ATTENDEE",e,{PARTSTAT:t,CN:a.CN||e}),n.setProperty("DTSTAMP",new Date),n.setProperty("LAST-MODIFIED",new Date);var i=new r;return i.addProperty("METHOD","REPLY"),this.calendar&&i.addComponents(this.calendar.getComponents("VTIMEZONE")),i.addComponent(n),i},s.VEVENT={factory:l,valid_properties:[],required_properties:["DTSTAMP","UID"],valid_children:[],required_children:[]}},function(e,t,a){var n=a(232),i=a(171),s=a(117).CalendarObject,r=a(117).schema,o=a(197).RRule,l=t.VTimezone=function(e,t){s.call(this,e,"VTIMEZONE"),this.addProperty("TZID",t)};i.inherits(l,s),l.prototype.getRRule=function(e){var t=this.getComponents(e)[0];return t&&t.getPropertyValue("RRULE")?new o(t.getPropertyValue("RRULE"),t.getPropertyValue("DTSTART"),t.getPropertyValue("DTEND")):null},l.prototype.getOffsetForDate=function(e){if(!this.getComponents("DAYLIGHT").length)return this.getComponents("STANDARD")[0].getPropertyValue("TZOFFSETTO");n.equal(1,this.components.STANDARD.length),n.equal(1,this.components.DAYLIGHT.length);var t=this.getRRule("STANDARD"),a=this.getRRule("DAYLIGHT");return null===t||null===a?this.getComponents("STANDARD")[0].getPropertyValue("TZOFFSETTO"):(t=t.next(e),a=a.next(e),this.getComponents(a<t?"STANDARD":"DAYLIGHT")[0].getPropertyValue("TZOFFSETTO"))},l.prototype.fromLocalTime=function(e){var t=this.getOffsetForDate(e),a=t%100;return t=(t-a)/100,new Date(Date.UTC(e[0],e[1]-1,e[2],e[3]-t,e[4]-a,e[5]))},r.VTIMEZONE={factory:l}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(465);case"v8light":return a(467)}},function(e,t,a){var n=a(78),i=a(466);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(468);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlExpandedRowDetails{padding:0 8px 8px 8px}.mlExpandedRowDetailsSection thead{display:none}\n",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(470);case"v8light":return a(472)}},function(e,t,a){var n=a(78),i=a(471);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(473);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlExpandedRowJobMessages{padding:0 8px 8px 8px}.mlExpandedRowJobMessages .euiTable,.mlExpandedRowJobMessages .euiTableRowCell{background-color:transparent !important}\n",""]),e.exports=t},function(e,t,a){e.exports=a.p+"bd21a7c05ddd7f5b46fe03d98fd506c9.png"},function(e,t,a){"use strict";(function(t){function n(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var i=n(a(478)),s=n(a(479));function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t,a){return t&&l(e.prototype,t),a&&l(e,a),e}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var a=[],n=!0,i=!1,s=void 0;try{for(var r,o=e[Symbol.iterator]();!(n=(r=o.next()).done)&&(a.push(r.value),!t||a.length!==t);n=!0);}catch(e){i=!0,s=e}finally{try{n||null==o.return||o.return()}finally{if(i)throw s}}return a}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var u="undefined"==typeof window?null:window,p=u?u.navigator:null,m=(u&&u.document,r("")),b=r({}),f=r((function(){})),h="undefined"==typeof HTMLElement?"undefined":r(HTMLElement),g=function(e){return e&&e.instanceString&&x(e.instanceString)?e.instanceString():null},j=function(e){return null!=e&&r(e)==m},x=function(e){return null!=e&&r(e)===f},v=function(e){return Array.isArray?Array.isArray(e):null!=e&&e instanceof Array},y=function(e){return null!=e&&r(e)===b&&!v(e)&&e.constructor===Object},O=function(e){return null!=e&&r(e)===r(1)&&!isNaN(e)},E=function(e){return"undefined"===h?void 0:null!=e&&e instanceof HTMLElement},w=function(e){return M(e)||S(e)},M=function(e){return"collection"===g(e)&&e._private.single},S=function(e){return"collection"===g(e)&&!e._private.single},_=function(e){return"core"===g(e)},T=function(e){return"stylesheet"===g(e)},C=function(e){return null==e||!(""!==e&&!e.match(/^\s+$/))},k=function(e){return function(e){return null!=e&&r(e)===b}(e)&&x(e.then)},F=function(e,t){t||(t=function(){if(1===arguments.length)return arguments[0];if(0===arguments.length)return"undefined";for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);return e.join("$")});var a=function a(){var n,i=this,s=arguments,r=t.apply(i,s),o=a.cache;return(n=o[r])||(n=o[r]=e.apply(i,s)),n};return a.cache={},a},I=F((function(e){return e.replace(/([A-Z])/g,(function(e){return"-"+e.toLowerCase()}))})),D=F((function(e){return e.replace(/(-\w)/g,(function(e){return e[1].toUpperCase()}))})),A=F((function(e,t){return e+t[0].toUpperCase()+t.substring(1)}),(function(e,t){return e+"$"+t})),L=function(e){return C(e)?e:e.charAt(0).toUpperCase()+e.substring(1)},R="(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))",N=function(e,t){return e<t?-1:e>t?1:0},P=null!=Object.assign?Object.assign.bind(Object):function(e){for(var t=arguments,a=1;a<t.length;a++){var n=t[a];if(null!=n)for(var i=Object.keys(n),s=0;s<i.length;s++){var r=i[s];e[r]=n[r]}}return e},z=function(e){return(v(e)?e:null)||function(e){return B[e.toLowerCase()]}(e)||function(e){if((4===e.length||7===e.length)&&"#"===e[0]){var t,a,n,i=16;return 4===e.length?(t=parseInt(e[1]+e[1],i),a=parseInt(e[2]+e[2],i),n=parseInt(e[3]+e[3],i)):(t=parseInt(e[1]+e[2],i),a=parseInt(e[3]+e[4],i),n=parseInt(e[5]+e[6],i)),[t,a,n]}}(e)||function(e){var t,a=new RegExp("^rgb[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(e);if(a){t=[];for(var n=[],i=1;i<=3;i++){var s=a[i];if("%"===s[s.length-1]&&(n[i]=!0),s=parseFloat(s),n[i]&&(s=s/100*255),s<0||s>255)return;t.push(Math.floor(s))}var r=n[1]||n[2]||n[3],o=n[1]&&n[2]&&n[3];if(r&&!o)return;var l=a[4];if(void 0!==l){if((l=parseFloat(l))<0||l>1)return;t.push(l)}}return t}(e)||function(e){var t,a,n,i,s,r,o,l;function c(e,t,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+6*(t-e)*a:a<.5?t:a<2/3?e+(t-e)*(2/3-a)*6:e}var d=new RegExp("^hsl[a]?\\(((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*((?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)$").exec(e);if(d){if((a=parseInt(d[1]))<0?a=(360- -1*a%360)%360:a>360&&(a%=360),a/=360,(n=parseFloat(d[2]))<0||n>100)return;if(n/=100,(i=parseFloat(d[3]))<0||i>100)return;if(i/=100,void 0!==(s=d[4])&&((s=parseFloat(s))<0||s>1))return;if(0===n)r=o=l=Math.round(255*i);else{var u=i<.5?i*(1+n):i+n-i*n,p=2*i-u;r=Math.round(255*c(p,u,a+1/3)),o=Math.round(255*c(p,u,a)),l=Math.round(255*c(p,u,a-1/3))}t=[r,o,l,s]}return t}(e)},B={transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},J=function(e){for(var t=e.map,a=e.keys,n=a.length,i=0;i<n;i++){var s=a[i];if(y(s))throw Error("Tried to set map with object key");i<a.length-1?(null==t[s]&&(t[s]={}),t=t[s]):t[s]=e.value}},V=function(e){for(var t=e.map,a=e.keys,n=a.length,i=0;i<n;i++){var s=a[i];if(y(s))throw Error("Tried to get map with object key");if(null==(t=t[s]))return t}return t},U=u?u.performance:null,G=U&&U.now?function(){return U.now()}:function(){return Date.now()},q=function(){if(u){if(u.requestAnimationFrame)return function(e){u.requestAnimationFrame(e)};if(u.mozRequestAnimationFrame)return function(e){u.mozRequestAnimationFrame(e)};if(u.webkitRequestAnimationFrame)return function(e){u.webkitRequestAnimationFrame(e)};if(u.msRequestAnimationFrame)return function(e){u.msRequestAnimationFrame(e)}}return function(e){e&&setTimeout((function(){e(G())}),1e3/60)}}(),W=function(e){return q(e)},H=G,Y=5381,$=function(e){for(var t,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y,n=a;!(t=e.next()).done;)n=(n<<5)+n+t.value|0;return n},X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Y;return(t<<5)+t+e|0},K=function(e,t){var a={value:0,done:!1},n=0,i=e.length;return $({next:function(){return n<i?a.value=e[n++]:a.done=!0,a}},t)},Q=function(e,t){var a={value:0,done:!1},n=0,i=e.length;return $({next:function(){return n<i?a.value=e.charCodeAt(n++):a.done=!0,a}},t)},Z=function(){return ee(arguments)},ee=function(e){for(var t,a=0;a<e.length;a++){var n=e[a];t=0===a?Q(n):Q(n,t)}return t},te=!0,ae=null!=console.warn,ne=null!=console.trace,ie=Number.MAX_SAFE_INTEGER||9007199254740991,se=function(){return!0},re=function(){return!1},oe=function(){return 0},le=function(){},ce=function(e){throw new Error(e)},de=function(e){if(void 0===e)return te;te=!!e},ue=function(e){de()&&(ae?console.warn(e):(console.log(e),ne&&console.trace()))},pe=function(e){return null==e?e:v(e)?e.slice():y(e)?function(e){return P({},e)}(e):e},me=function(e,t){for(t=e="";e++<36;t+=51*e&52?(15^e?8^Math.random()*(20^e?16:4):4).toString(16):"-");return t},be={},fe=function(){return be},he=function(e){var t=Object.keys(e);return function(a){for(var n={},i=0;i<t.length;i++){var s=t[i],r=null==a?void 0:a[s];n[s]=void 0===r?e[s]:r}return n}},ge=function(e,t,a){for(var n=e.length;n>=0&&(e[n]!==t||(e.splice(n,1),a));n--);},je=function(e){e.splice(0,e.length)},xe=function(e,t,a){return a&&(t=A(a,t)),e[t]},ve=function(e,t,a,n){a&&(t=A(a,t)),e[t]=n},ye="undefined"!=typeof Map?Map:function(){function e(){o(this,e),this._obj={}}return c(e,[{key:"set",value:function(e,t){return this._obj[e]=t,this}},{key:"delete",value:function(e){return this._obj[e]=void 0,this}},{key:"clear",value:function(){this._obj={}}},{key:"has",value:function(e){return void 0!==this._obj[e]}},{key:"get",value:function(e){return this._obj[e]}}]),e}(),Oe=function(){function e(t){if(o(this,e),this._obj=Object.create(null),this.size=0,null!=t){var a;a=null!=t.instanceString&&t.instanceString()===this.instanceString()?t.toArray():t;for(var n=0;n<a.length;n++)this.add(a[n])}}return c(e,[{key:"instanceString",value:function(){return"set"}},{key:"add",value:function(e){var t=this._obj;1!==t[e]&&(t[e]=1,this.size++)}},{key:"delete",value:function(e){var t=this._obj;1===t[e]&&(t[e]=0,this.size--)}},{key:"clear",value:function(){this._obj=Object.create(null)}},{key:"has",value:function(e){return 1===this._obj[e]}},{key:"toArray",value:function(){var e=this;return Object.keys(this._obj).filter((function(t){return e.has(t)}))}},{key:"forEach",value:function(e,t){return this.toArray().forEach(e,t)}}]),e}(),Ee="undefined"!==("undefined"==typeof Set?"undefined":r(Set))?Set:Oe,we=function(e,t,a){if(a=!(void 0!==a&&!a),void 0!==e&&void 0!==t&&_(e)){var n=t.group;if(null==n&&(n=t.data&&null!=t.data.source&&null!=t.data.target?"edges":"nodes"),"nodes"===n||"edges"===n){this.length=1,this[0]=this;var i=this._private={cy:e,single:!0,data:t.data||{},position:t.position||{x:0,y:0},autoWidth:void 0,autoHeight:void 0,autoPadding:void 0,compoundBoundsClean:!1,listeners:[],group:n,style:{},rstyle:{},styleCxts:[],styleKeys:{},removed:!0,selected:!!t.selected,selectable:void 0===t.selectable||!!t.selectable,locked:!!t.locked,grabbed:!1,grabbable:void 0===t.grabbable||!!t.grabbable,pannable:void 0===t.pannable?"edges"===n:!!t.pannable,active:!1,classes:new Ee,animation:{current:[],queue:[]},rscratch:{},scratch:t.scratch||{},edges:[],children:[],parent:null,traversalCache:{},backgrounding:!1,bbCache:null,bbCacheShift:{x:0,y:0},bodyBounds:null,overlayBounds:null,labelBounds:{all:null,source:null,target:null,main:null},arrowBounds:{source:null,target:null,"mid-source":null,"mid-target":null}};if(null==i.position.x&&(i.position.x=0),null==i.position.y&&(i.position.y=0),t.renderedPosition){var s=t.renderedPosition,r=e.pan(),o=e.zoom();i.position={x:(s.x-r.x)/o,y:(s.y-r.y)/o}}var l=[];v(t.classes)?l=t.classes:j(t.classes)&&(l=t.classes.split(/\s+/));for(var c=0,d=l.length;c<d;c++){var u=l[c];u&&""!==u&&i.classes.add(u)}this.createEmitter();var p=t.style||t.css;p&&(ue("Setting a `style` bypass at element creation is deprecated"),this.style(p)),(void 0===a||a)&&this.restore()}else ce("An element must be of type `nodes` or `edges`; you specified `"+n+"`")}else ce("An element must have a core reference and parameters set")},Me=function(e){return e={bfs:e.bfs||!e.dfs,dfs:e.dfs||!e.bfs},function(t,a,n){var i;y(t)&&!w(t)&&(t=(i=t).roots||i.root,a=i.visit,n=i.directed),n=2!==arguments.length||x(a)?n:a,a=x(a)?a:function(){};for(var s,r=this._private.cy,o=t=j(t)?this.filter(t):t,l=[],c=[],d={},u={},p={},m=0,b=this.byGroup(),f=b.nodes,h=b.edges,g=0;g<o.length;g++){var v=o[g],O=v.id();v.isNode()&&(l.unshift(v),e.bfs&&(p[O]=!0,c.push(v)),u[O]=0)}var E=function(){var t=e.bfs?l.shift():l.pop(),i=t.id();if(e.dfs){if(p[i])return"continue";p[i]=!0,c.push(t)}var r,o=u[i],b=d[i],g=null!=b?b.source():null,j=null!=b?b.target():null,x=null==b?void 0:t.same(g)?j[0]:g[0];if(!0===(r=a(t,b,x,m++,o)))return s=t,"break";if(!1===r)return"break";for(var v=t.connectedEdges().filter((function(e){return(!n||e.source().same(t))&&h.has(e)})),y=0;y<v.length;y++){var O=v[y],E=O.connectedNodes().filter((function(e){return!e.same(t)&&f.has(e)})),w=E.id();0===E.length||p[w]||(E=E[0],l.push(E),e.bfs&&(p[w]=!0,c.push(E)),d[w]=O,u[w]=u[i]+1)}};e:for(;0!==l.length;){var M=E();switch(M){case"continue":continue;case"break":break e}}for(var S=r.collection(),_=0;_<c.length;_++){var T=c[_],C=d[T.id()];null!=C&&S.merge(C),S.merge(T)}return{path:r.collection(S),found:r.collection(s)}}},Se={breadthFirstSearch:Me({bfs:!0}),depthFirstSearch:Me({dfs:!0})};Se.bfs=Se.breadthFirstSearch,Se.dfs=Se.depthFirstSearch;var _e=he({root:null,weight:function(e){return 1},directed:!1}),Te={dijkstra:function(e){if(!y(e)){var t=arguments;e={root:t[0],weight:t[1],directed:t[2]}}var a=_e(e),n=a.root,i=a.weight,r=a.directed,o=this,l=i,c=j(n)?this.filter(n)[0]:n[0],d={},u={},p={},m=this.byGroup(),b=m.nodes,f=m.edges;f.unmergeBy((function(e){return e.isLoop()}));for(var h=function(e){return d[e.id()]},g=function(e,t){d[e.id()]=t,x.updateItem(e)},x=new s((function(e,t){return h(e)-h(t)})),v=0;v<b.length;v++){var O=b[v];d[O.id()]=O.same(c)?0:1/0,x.push(O)}for(var E=function(e,t){for(var a,n=(r?e.edgesTo(t):e.edgesWith(t)).intersect(f),i=1/0,s=0;s<n.length;s++){var o=n[s],c=l(o);(c<i||!a)&&(i=c,a=o)}return{edge:a,dist:i}};x.size()>0;){var w=x.pop(),M=h(w),S=w.id();if(p[S]=M,M!==1/0)for(var _=w.neighborhood().intersect(b),T=0;T<_.length;T++){var C=_[T],k=C.id(),F=E(w,C),I=M+F.dist;I<h(C)&&(g(C,I),u[k]={node:w,edge:F.edge})}}return{distanceTo:function(e){var t=j(e)?b.filter(e)[0]:e[0];return p[t.id()]},pathTo:function(e){var t=j(e)?b.filter(e)[0]:e[0],a=[],n=t,i=n.id();if(t.length>0)for(a.unshift(t);u[i];){var s=u[i];a.unshift(s.edge),a.unshift(s.node),i=(n=s.node).id()}return o.spawn(a)}}}},Ce={kruskal:function(e){e=e||function(e){return 1};for(var t=this.byGroup(),a=t.nodes,n=t.edges,i=a.length,s=new Array(i),r=a,o=function(e){for(var t=0;t<s.length;t++){if(s[t].has(e))return t}},l=0;l<i;l++)s[l]=this.spawn(a[l]);for(var c=n.sort((function(t,a){return e(t)-e(a)})),d=0;d<c.length;d++){var u=c[d],p=u.source()[0],m=u.target()[0],b=o(p),f=o(m),h=s[b],g=s[f];b!==f&&(r.merge(u),h.merge(g),s.splice(f,1))}return r}},ke=he({root:null,goal:null,weight:function(e){return 1},heuristic:function(e){return 0},directed:!1}),Fe={aStar:function(e){var t=this.cy(),a=ke(e),n=a.root,i=a.goal,r=a.heuristic,o=a.directed,l=a.weight;n=t.collection(n)[0],i=t.collection(i)[0];var c,d,u=n.id(),p=i.id(),m={},b={},f={},h=new s((function(e,t){return b[e.id()]-b[t.id()]})),g=new Ee,j={},x={},v=function(e,t){h.push(e),g.add(t)};v(n,u),m[u]=0,b[u]=r(n);for(var y,O=0;h.size()>0;){if(c=h.pop(),d=c.id(),g.delete(d),O++,d===p){for(var E=[],w=i,M=p,S=x[M];E.unshift(w),null!=S&&E.unshift(S),null!=(w=j[M]);)S=x[M=w.id()];return{found:!0,distance:m[d],path:this.spawn(E),steps:O}}f[d]=!0;for(var _=c._private.edges,T=0;T<_.length;T++){var C=_[T];if(this.hasElementWithId(C.id())&&(!o||C.data("source")===d)){var k=C.source(),F=C.target(),I=k.id()!==d?k:F,D=I.id();if(this.hasElementWithId(D)&&!f[D]){var A=m[d]+l(C);y=D,g.has(y)?A<m[D]&&(m[D]=A,b[D]=A+r(I),j[D]=c):(m[D]=A,b[D]=A+r(I),v(I,D),j[D]=c,x[D]=C)}}}}return{found:!1,distance:void 0,path:void 0,steps:O}}},Ie=he({weight:function(e){return 1},directed:!1}),De={floydWarshall:function(e){for(var t=this.cy(),a=Ie(e),n=a.weight,i=a.directed,s=n,r=this.byGroup(),o=r.nodes,l=r.edges,c=o.length,d=c*c,u=function(e){return o.indexOf(e)},p=function(e){return o[e]},m=new Array(d),b=0;b<d;b++){var f=b%c,h=(b-f)/c;m[b]=h===f?0:1/0}for(var g=new Array(d),x=new Array(d),v=0;v<l.length;v++){var y=l[v],O=y.source()[0],E=y.target()[0];if(O!==E){var w=u(O),M=u(E),S=w*c+M,_=s(y);if(m[S]>_&&(m[S]=_,g[S]=M,x[S]=y),!i){var T=M*c+w;!i&&m[T]>_&&(m[T]=_,g[T]=w,x[T]=y)}}}for(var C=0;C<c;C++)for(var k=0;k<c;k++)for(var F=k*c+C,I=0;I<c;I++){var D=k*c+I,A=C*c+I;m[F]+m[A]<m[D]&&(m[D]=m[F]+m[A],g[D]=g[F])}var L=function(e){return u(function(e){return(j(e)?t.filter(e):e)[0]}(e))};return{distance:function(e,t){var a=L(e),n=L(t);return m[a*c+n]},path:function(e,a){var n=L(e),i=L(a),s=p(n);if(n===i)return s.collection();if(null==g[n*c+i])return t.collection();var r,o=t.collection(),l=n;for(o.merge(s);n!==i;)l=n,n=g[n*c+i],r=x[l*c+n],o.merge(r),o.merge(p(n));return o}}}},Ae=he({weight:function(e){return 1},directed:!1,root:null}),Le={bellmanFord:function(e){var t=this,a=Ae(e),n=a.weight,i=a.directed,s=a.root,r=n,o=this,l=this.cy(),c=this.byGroup(),d=c.edges,u=c.nodes,p=u.length,m=new ye,b=!1;s=l.collection(s)[0],d.unmergeBy((function(e){return e.isLoop()}));for(var f=d.length,h=function(e){var t=m.get(e.id());return t||(t={},m.set(e.id(),t)),t},g=function(e){return(j(e)?l.$(e):e)[0]},x=0;x<p;x++){var v=u[x],y=h(v);v.same(s)?y.dist=0:y.dist=1/0,y.pred=null,y.edge=null}for(var O=!1,E=function(e,t,a,n,i,s){var r=n.dist+s;r<i.dist&&!a.same(n.edge)&&(i.dist=r,i.pred=e,i.edge=a,O=!0)},w=1;w<p;w++){O=!1;for(var M=0;M<f;M++){var S=d[M],_=S.source(),T=S.target(),C=r(S),k=h(_),F=h(T);E(_,0,S,k,F,C),i||E(T,0,S,F,k,C)}if(!O)break}if(O)for(var I=0;I<f;I++){var D=d[I],A=D.source(),L=D.target(),R=r(D),N=h(A).dist,P=h(L).dist;if(N+R<P||!i&&P+R<N){ue("Graph contains a negative weight cycle for Bellman-Ford"),b=!0;break}}return{distanceTo:function(e){return h(g(e)).dist},pathTo:function(e){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:s,n=g(e),i=[],r=n;;){if(null==r)return t.spawn();var l=h(r),c=l.edge,d=l.pred;if(i.unshift(r[0]),r.same(a)&&i.length>0)break;null!=c&&i.unshift(c),r=d}return o.spawn(i)},hasNegativeWeightCycle:b,negativeWeightCycles:[]}}},Re=Math.sqrt(2),Ne=function(e,t,a){0===a.length&&ce("Karger-Stein must be run on a connected (sub)graph");for(var n=a[e],i=n[1],s=n[2],r=t[i],o=t[s],l=a,c=l.length-1;c>=0;c--){var d=l[c],u=d[1],p=d[2];(t[u]===r&&t[p]===o||t[u]===o&&t[p]===r)&&l.splice(c,1)}for(var m=0;m<l.length;m++){var b=l[m];b[1]===o?(l[m]=b.slice(),l[m][1]=r):b[2]===o&&(l[m]=b.slice(),l[m][2]=r)}for(var f=0;f<t.length;f++)t[f]===o&&(t[f]=r);return l},Pe=function(e,t,a,n){for(;a>n;){var i=Math.floor(Math.random()*t.length);t=Ne(i,e,t),a--}return t},ze={kargerStein:function(){var e=this.byGroup(),t=e.nodes,a=e.edges;a.unmergeBy((function(e){return e.isLoop()}));var n=t.length,i=a.length,s=Math.ceil(Math.pow(Math.log(n)/Math.LN2,2)),r=Math.floor(n/Re);if(!(n<2)){for(var o=[],l=0;l<i;l++){var c=a[l];o.push([l,t.indexOf(c.source()),t.indexOf(c.target())])}for(var d=1/0,u=[],p=new Array(n),m=new Array(n),b=new Array(n),f=function(e,t){for(var a=0;a<n;a++)t[a]=e[a]},h=0;h<=s;h++){for(var g=0;g<n;g++)m[g]=g;var j=Pe(m,o.slice(),n,r),x=j.slice();f(m,b);var v=Pe(m,j,r,2),y=Pe(b,x,r,2);v.length<=y.length&&v.length<d?(d=v.length,u=v,f(m,p)):y.length<=v.length&&y.length<d&&(d=y.length,u=y,f(b,p))}for(var O=this.spawn(u.map((function(e){return a[e[0]]}))),E=this.spawn(),w=this.spawn(),M=p[0],S=0;S<p.length;S++){var _=p[S],T=t[S];_===M?E.merge(T):w.merge(T)}return{cut:O,partition1:E,partition2:w}}ce("At least 2 nodes are required for Karger-Stein algorithm")}},Be=function(e,t,a){return{x:e.x*t+a.x,y:e.y*t+a.y}},Je=function(e,t,a){return{x:(e.x-a.x)/t,y:(e.y-a.y)/t}},Ve=function(e){return{x:e[0],y:e[1]}},Ue=function(e,t){return Math.atan2(t,e)-Math.PI/2},Ge=Math.log2||function(e){return Math.log(e)/Math.log(2)},qe=function(e){return e>0?1:e<0?-1:0},We=function(e,t){return Math.sqrt(He(e,t))},He=function(e,t){var a=t.x-e.x,n=t.y-e.y;return a*a+n*n},Ye=function(e){for(var t=e.length,a=0,n=0;n<t;n++)a+=e[n];for(var i=0;i<t;i++)e[i]=e[i]/a;return e},$e=function(e,t,a,n){return(1-n)*(1-n)*e+2*(1-n)*n*t+n*n*a},Xe=function(e,t,a,n){return{x:$e(e.x,t.x,a.x,n),y:$e(e.y,t.y,a.y,n)}},Ke=function(e,t,a){return Math.max(e,Math.min(a,t))},Qe=function(e){if(null==e)return{x1:1/0,y1:1/0,x2:-1/0,y2:-1/0,w:0,h:0};if(null!=e.x1&&null!=e.y1){if(null!=e.x2&&null!=e.y2&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(null!=e.w&&null!=e.h&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},Ze=function(e,t,a){e.x1=Math.min(e.x1,t),e.x2=Math.max(e.x2,t),e.w=e.x2-e.x1,e.y1=Math.min(e.y1,a),e.y2=Math.max(e.y2,a),e.h=e.y2-e.y1},et=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e.x1-=t,e.x2+=t,e.y1-=t,e.y2+=t,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},tt=function(e){var t,a,n,i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0];if(1===s.length)t=a=n=i=s[0];else if(2===s.length)t=n=s[0],i=a=s[1];else if(4===s.length){var r=d(s,4);t=r[0],a=r[1],n=r[2],i=r[3]}return e.x1-=i,e.x2+=a,e.y1-=t,e.y2+=n,e.w=e.x2-e.x1,e.h=e.y2-e.y1,e},at=function(e,t){e.x1=t.x1,e.y1=t.y1,e.x2=t.x2,e.y2=t.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1},nt=function(e,t){e.x1+=t.x,e.x2+=t.x,e.y1+=t.y,e.y2+=t.y},it=function(e,t){return!(e.x1>t.x2)&&(!(t.x1>e.x2)&&(!(e.x2<t.x1)&&(!(t.x2<e.x1)&&(!(e.y2<t.y1)&&(!(t.y2<e.y1)&&(!(e.y1>t.y2)&&!(t.y1>e.y2)))))))},st=function(e,t,a){return e.x1<=t&&t<=e.x2&&e.y1<=a&&a<=e.y2},rt=function(e,t){return st(e,t.x1,t.y1)&&st(e,t.x2,t.y2)},ot=function(e,t,a,n,i,s,r){var o,l=Mt(i,s),c=i/2,d=s/2,u=n-d-r;if((o=xt(e,t,a,n,a-c+l-r,u,a+c-l+r,u,!1)).length>0)return o;var p=a+c+r;if((o=xt(e,t,a,n,p,n-d+l-r,p,n+d-l+r,!1)).length>0)return o;var m=n+d+r;if((o=xt(e,t,a,n,a-c+l-r,m,a+c-l+r,m,!1)).length>0)return o;var b,f=a-c-r;if((o=xt(e,t,a,n,f,n-d+l-r,f,n+d-l+r,!1)).length>0)return o;var h=a-c+l,g=n-d+l;if((b=gt(e,t,a,n,h,g,l+r)).length>0&&b[0]<=h&&b[1]<=g)return[b[0],b[1]];var j=a+c-l,x=n-d+l;if((b=gt(e,t,a,n,j,x,l+r)).length>0&&b[0]>=j&&b[1]<=x)return[b[0],b[1]];var v=a+c-l,y=n+d-l;if((b=gt(e,t,a,n,v,y,l+r)).length>0&&b[0]>=v&&b[1]>=y)return[b[0],b[1]];var O=a-c+l,E=n+d-l;return(b=gt(e,t,a,n,O,E,l+r)).length>0&&b[0]<=O&&b[1]>=E?[b[0],b[1]]:[]},lt=function(e,t,a,n,i,s,r){var o=r,l=Math.min(a,i),c=Math.max(a,i),d=Math.min(n,s),u=Math.max(n,s);return l-o<=e&&e<=c+o&&d-o<=t&&t<=u+o},ct=function(e,t,a,n,i,s,r,o,l){var c=Math.min(a,r,i)-l,d=Math.max(a,r,i)+l,u=Math.min(n,o,s)-l,p=Math.max(n,o,s)+l;return!(e<c||e>d||t<u||t>p)},dt=function(e,t,a,n,i,s,r,o){var l=[];!function(e,t,a,n,i){var s,r,o,l,c,d,u,p;0===e&&(e=1e-5),o=-27*(n/=e)+(t/=e)*(9*(a/=e)-t*t*2),s=(r=(3*a-t*t)/9)*r*r+(o/=54)*o,i[1]=0,u=t/3,s>0?(c=(c=o+Math.sqrt(s))<0?-Math.pow(-c,1/3):Math.pow(c,1/3),d=(d=o-Math.sqrt(s))<0?-Math.pow(-d,1/3):Math.pow(d,1/3),i[0]=-u+c+d,u+=(c+d)/2,i[4]=i[2]=-u,u=Math.sqrt(3)*(-d+c)/2,i[3]=u,i[5]=-u):(i[5]=i[3]=0,0===s?(p=o<0?-Math.pow(-o,1/3):Math.pow(o,1/3),i[0]=2*p-u,i[4]=i[2]=-(p+u)):(l=(r=-r)*r*r,l=Math.acos(o/Math.sqrt(l)),p=2*Math.sqrt(r),i[0]=-u+p*Math.cos(l/3),i[2]=-u+p*Math.cos((l+2*Math.PI)/3),i[4]=-u+p*Math.cos((l+4*Math.PI)/3)))}(1*a*a-4*a*i+2*a*r+4*i*i-4*i*r+r*r+n*n-4*n*s+2*n*o+4*s*s-4*s*o+o*o,9*a*i-3*a*a-3*a*r-6*i*i+3*i*r+9*n*s-3*n*n-3*n*o-6*s*s+3*s*o,3*a*a-6*a*i+a*r-a*e+2*i*i+2*i*e-r*e+3*n*n-6*n*s+n*o-n*t+2*s*s+2*s*t-o*t,1*a*i-a*a+a*e-i*e+n*s-n*n+n*t-s*t,l);for(var c=[],d=0;d<6;d+=2)Math.abs(l[d+1])<1e-7&&l[d]>=0&&l[d]<=1&&c.push(l[d]);c.push(1),c.push(0);for(var u,p,m,b=-1,f=0;f<c.length;f++)u=Math.pow(1-c[f],2)*a+2*(1-c[f])*c[f]*i+c[f]*c[f]*r,p=Math.pow(1-c[f],2)*n+2*(1-c[f])*c[f]*s+c[f]*c[f]*o,m=Math.pow(u-e,2)+Math.pow(p-t,2),b>=0?m<b&&(b=m):b=m;return b},ut=function(e,t,a,n,i,s){var r=[e-a,t-n],o=[i-a,s-n],l=o[0]*o[0]+o[1]*o[1],c=r[0]*r[0]+r[1]*r[1],d=r[0]*o[0]+r[1]*o[1],u=d*d/l;return d<0?c:u>l?(e-i)*(e-i)+(t-s)*(t-s):c-u},pt=function(e,t,a){for(var n,i,s,r,o=0,l=0;l<a.length/2;l++)if(n=a[2*l],i=a[2*l+1],l+1<a.length/2?(s=a[2*(l+1)],r=a[2*(l+1)+1]):(s=a[2*(l+1-a.length/2)],r=a[2*(l+1-a.length/2)+1]),n==e&&s==e);else{if(!(n>=e&&e>=s||n<=e&&e<=s))continue;(e-n)/(s-n)*(r-i)+i>t&&o++}return o%2!=0},mt=function(e,t,a,n,i,s,r,o,l){var c,d=new Array(a.length);null!=o[0]?(c=Math.atan(o[1]/o[0]),o[0]<0?c+=Math.PI/2:c=-c-Math.PI/2):c=o;for(var u,p=Math.cos(-c),m=Math.sin(-c),b=0;b<d.length/2;b++)d[2*b]=s/2*(a[2*b]*p-a[2*b+1]*m),d[2*b+1]=r/2*(a[2*b+1]*p+a[2*b]*m),d[2*b]+=n,d[2*b+1]+=i;if(l>0){var f=ft(d,-l);u=bt(f)}else u=d;return pt(e,t,u)},bt=function(e){for(var t,a,n,i,s,r,o,l,c=new Array(e.length/2),d=0;d<e.length/4;d++){t=e[4*d],a=e[4*d+1],n=e[4*d+2],i=e[4*d+3],d<e.length/4-1?(s=e[4*(d+1)],r=e[4*(d+1)+1],o=e[4*(d+1)+2],l=e[4*(d+1)+3]):(s=e[0],r=e[1],o=e[2],l=e[3]);var u=xt(t,a,n,i,s,r,o,l,!0);c[2*d]=u[0],c[2*d+1]=u[1]}return c},ft=function(e,t){for(var a,n,i,s,r=new Array(2*e.length),o=0;o<e.length/2;o++){a=e[2*o],n=e[2*o+1],o<e.length/2-1?(i=e[2*(o+1)],s=e[2*(o+1)+1]):(i=e[0],s=e[1]);var l=s-n,c=-(i-a),d=Math.sqrt(l*l+c*c),u=l/d,p=c/d;r[4*o]=a+u*t,r[4*o+1]=n+p*t,r[4*o+2]=i+u*t,r[4*o+3]=s+p*t}return r},ht=function(e,t,a,n,i,s,r){return e-=i,t-=s,(e/=a/2+r)*e+(t/=n/2+r)*t<=1},gt=function(e,t,a,n,i,s,r){var o=[a-e,n-t],l=[e-i,t-s],c=o[0]*o[0]+o[1]*o[1],d=2*(l[0]*o[0]+l[1]*o[1]),u=d*d-4*c*(l[0]*l[0]+l[1]*l[1]-r*r);if(u<0)return[];var p=(-d+Math.sqrt(u))/(2*c),m=(-d-Math.sqrt(u))/(2*c),b=Math.min(p,m),f=Math.max(p,m),h=[];if(b>=0&&b<=1&&h.push(b),f>=0&&f<=1&&h.push(f),0===h.length)return[];var g=h[0]*o[0]+e,j=h[0]*o[1]+t;return h.length>1?h[0]==h[1]?[g,j]:[g,j,h[1]*o[0]+e,h[1]*o[1]+t]:[g,j]},jt=function(e,t,a){return t<=e&&e<=a||a<=e&&e<=t?e:e<=t&&t<=a||a<=t&&t<=e?t:a},xt=function(e,t,a,n,i,s,r,o,l){var c=e-i,d=a-e,u=r-i,p=t-s,m=n-t,b=o-s,f=u*p-b*c,h=d*p-m*c,g=b*d-u*m;if(0!==g){var j=f/g,x=h/g,v=-.001;return v<=j&&j<=1.001&&v<=x&&x<=1.001||l?[e+j*d,t+j*m]:[]}return 0===f||0===h?jt(e,a,r)===r?[r,o]:jt(e,a,i)===i?[i,s]:jt(i,r,a)===a?[a,n]:[]:[]},vt=function(e,t,a,n,i,s,r,o){var l,c,d,u,p,m,b=[],f=new Array(a.length),h=!0;if(null==s&&(h=!1),h){for(var g=0;g<f.length/2;g++)f[2*g]=a[2*g]*s+n,f[2*g+1]=a[2*g+1]*r+i;if(o>0){var j=ft(f,-o);c=bt(j)}else c=f}else c=a;for(var x=0;x<c.length/2;x++)d=c[2*x],u=c[2*x+1],x<c.length/2-1?(p=c[2*(x+1)],m=c[2*(x+1)+1]):(p=c[0],m=c[1]),0!==(l=xt(e,t,n,i,d,u,p,m)).length&&b.push(l[0],l[1]);return b},yt=function(e,t,a){var n=[e[0]-t[0],e[1]-t[1]],i=Math.sqrt(n[0]*n[0]+n[1]*n[1]),s=(i-a)/i;return s<0&&(s=1e-5),[t[0]+s*n[0],t[1]+s*n[1]]},Ot=function(e,t){var a=wt(e,t);return a=Et(a)},Et=function(e){for(var t,a,n=e.length/2,i=1/0,s=1/0,r=-1/0,o=-1/0,l=0;l<n;l++)t=e[2*l],a=e[2*l+1],i=Math.min(i,t),r=Math.max(r,t),s=Math.min(s,a),o=Math.max(o,a);for(var c=2/(r-i),d=2/(o-s),u=0;u<n;u++)t=e[2*u]=e[2*u]*c,a=e[2*u+1]=e[2*u+1]*d,i=Math.min(i,t),r=Math.max(r,t),s=Math.min(s,a),o=Math.max(o,a);if(s<-1)for(var p=0;p<n;p++)a=e[2*p+1]=e[2*p+1]+(-1-s);return e},wt=function(e,t){var a=1/e*2*Math.PI,n=e%2==0?Math.PI/2+a/2:Math.PI/2;n+=t;for(var i,s=new Array(2*e),r=0;r<e;r++)i=r*a+n,s[2*r]=Math.cos(i),s[2*r+1]=Math.sin(-i);return s},Mt=function(e,t){return Math.min(e/4,t/4,8)},St=function(e,t){return{heightOffset:Math.min(15,.05*t),widthOffset:Math.min(100,.25*e),ctrlPtOffsetPct:.05}},_t=he({dampingFactor:.8,precision:1e-6,iterations:200,weight:function(e){return 1}}),Tt={pageRank:function(e){for(var t=_t(e),a=t.dampingFactor,n=t.precision,i=t.iterations,s=t.weight,r=this._private.cy,o=this.byGroup(),l=o.nodes,c=o.edges,d=l.length,u=d*d,p=c.length,m=new Array(u),b=new Array(d),f=(1-a)/d,h=0;h<d;h++){for(var g=0;g<d;g++){m[h*d+g]=0}b[h]=0}for(var j=0;j<p;j++){var x=c[j],v=x.data("source"),y=x.data("target");if(v!==y){var O=l.indexOfId(v),E=l.indexOfId(y),w=s(x);m[E*d+O]+=w,b[O]+=w}}for(var M=1/d+f,S=0;S<d;S++)if(0===b[S])for(var _=0;_<d;_++){m[_*d+S]=M}else for(var T=0;T<d;T++){var C=T*d+S;m[C]=m[C]/b[S]+f}for(var k,F=new Array(d),I=new Array(d),D=0;D<d;D++)F[D]=1;for(var A=0;A<i;A++){for(var L=0;L<d;L++)I[L]=0;for(var R=0;R<d;R++)for(var N=0;N<d;N++){var P=R*d+N;I[R]+=m[P]*F[N]}Ye(I),k=F,F=I,I=k;for(var z=0,B=0;B<d;B++){var J=k[B]-F[B];z+=J*J}if(z<n)break}return{rank:function(e){return e=r.collection(e)[0],F[l.indexOf(e)]}}}},Ct=he({root:null,weight:function(e){return 1},directed:!1,alpha:0}),kt={degreeCentralityNormalized:function(e){e=Ct(e);var t=this.cy(),a=this.nodes(),n=a.length;if(e.directed){for(var i={},s={},r=0,o=0,l=0;l<n;l++){var c=a[l],d=c.id();e.root=c;var u=this.degreeCentrality(e);r<u.indegree&&(r=u.indegree),o<u.outdegree&&(o=u.outdegree),i[d]=u.indegree,s[d]=u.outdegree}return{indegree:function(e){return 0==r?0:(j(e)&&(e=t.filter(e)),i[e.id()]/r)},outdegree:function(e){return 0===o?0:(j(e)&&(e=t.filter(e)),s[e.id()]/o)}}}for(var p={},m=0,b=0;b<n;b++){var f=a[b];e.root=f;var h=this.degreeCentrality(e);m<h.degree&&(m=h.degree),p[f.id()]=h.degree}return{degree:function(e){return 0===m?0:(j(e)&&(e=t.filter(e)),p[e.id()]/m)}}},degreeCentrality:function(e){e=Ct(e);var t=this.cy(),a=this,n=e,i=n.root,s=n.weight,r=n.directed,o=n.alpha;if(i=t.collection(i)[0],r){for(var l=i.connectedEdges(),c=l.filter((function(e){return e.target().same(i)&&a.has(e)})),d=l.filter((function(e){return e.source().same(i)&&a.has(e)})),u=c.length,p=d.length,m=0,b=0,f=0;f<c.length;f++)m+=s(c[f]);for(var h=0;h<d.length;h++)b+=s(d[h]);return{indegree:Math.pow(u,1-o)*Math.pow(m,o),outdegree:Math.pow(p,1-o)*Math.pow(b,o)}}for(var g=i.connectedEdges().intersection(a),j=g.length,x=0,v=0;v<g.length;v++)x+=s(g[v]);return{degree:Math.pow(j,1-o)*Math.pow(x,o)}}};kt.dc=kt.degreeCentrality,kt.dcn=kt.degreeCentralityNormalised=kt.degreeCentralityNormalized;var Ft=he({harmonic:!0,weight:function(){return 1},directed:!1,root:null}),It={closenessCentralityNormalized:function(e){for(var t=Ft(e),a=t.harmonic,n=t.weight,i=t.directed,s=this.cy(),r={},o=0,l=this.nodes(),c=this.floydWarshall({weight:n,directed:i}),d=0;d<l.length;d++){for(var u=0,p=l[d],m=0;m<l.length;m++)if(d!==m){var b=c.distance(p,l[m]);u+=a?1/b:b}a||(u=1/u),o<u&&(o=u),r[p.id()]=u}return{closeness:function(e){return 0==o?0:(e=j(e)?s.filter(e)[0].id():e.id(),r[e]/o)}}},closenessCentrality:function(e){var t=Ft(e),a=t.root,n=t.weight,i=t.directed,s=t.harmonic;a=this.filter(a)[0];for(var r=this.dijkstra({root:a,weight:n,directed:i}),o=0,l=this.nodes(),c=0;c<l.length;c++){var d=l[c];if(!d.same(a)){var u=r.distanceTo(d);o+=s?1/u:u}}return s?o:1/o}};It.cc=It.closenessCentrality,It.ccn=It.closenessCentralityNormalised=It.closenessCentralityNormalized;var Dt=he({weight:null,directed:!1}),At={betweennessCentrality:function(e){for(var t=Dt(e),a=t.directed,n=t.weight,i=null!=n,r=this.cy(),o=this.nodes(),l={},c={},d=0,u=function(e,t){c[e]=t,t>d&&(d=t)},p=function(e){return c[e]},m=0;m<o.length;m++){var b=o[m],f=b.id();l[f]=a?b.outgoers().nodes():b.openNeighborhood().nodes(),u(f,0)}for(var h=function(e){for(var t=o[e].id(),a=[],c={},d={},m={},b=new s((function(e,t){return m[e]-m[t]})),f=0;f<o.length;f++){var h=o[f].id();c[h]=[],d[h]=0,m[h]=1/0}for(d[t]=1,m[t]=0,b.push(t);!b.empty();){var g=b.pop();if(a.push(g),i)for(var j=0;j<l[g].length;j++){var x=l[g][j],v=r.getElementById(g),y=void 0;y=v.edgesTo(x).length>0?v.edgesTo(x)[0]:x.edgesTo(v)[0];var O=n(y);x=x.id(),m[x]>m[g]+O&&(m[x]=m[g]+O,b.nodes.indexOf(x)<0?b.push(x):b.updateItem(x),d[x]=0,c[x]=[]),m[x]==m[g]+O&&(d[x]=d[x]+d[g],c[x].push(g))}else for(var E=0;E<l[g].length;E++){var w=l[g][E].id();m[w]==1/0&&(b.push(w),m[w]=m[g]+1),m[w]==m[g]+1&&(d[w]=d[w]+d[g],c[w].push(g))}}for(var M={},S=0;S<o.length;S++)M[o[S].id()]=0;for(;a.length>0;)for(var _=a.pop(),T=0;T<c[_].length;T++){var C=c[_][T];M[C]=M[C]+d[C]/d[_]*(1+M[_]),_!=o[e].id()&&u(_,p(_)+M[_])}},g=0;g<o.length;g++)h(g);var j={betweenness:function(e){var t=r.collection(e).id();return p(t)},betweennessNormalized:function(e){if(0==d)return 0;var t=r.collection(e).id();return p(t)/d}};return j.betweennessNormalised=j.betweennessNormalized,j}};At.bc=At.betweennessCentrality;var Lt=he({expandFactor:2,inflateFactor:2,multFactor:1,maxIterations:20,attributes:[function(e){return 1}]}),Rt=function(e,t){for(var a=0,n=0;n<t.length;n++)a+=t[n](e);return a},Nt=function(e,t){for(var a,n=0;n<t;n++){a=0;for(var i=0;i<t;i++)a+=e[i*t+n];for(var s=0;s<t;s++)e[s*t+n]=e[s*t+n]/a}},Pt=function(e,t,a){for(var n=new Array(a*a),i=0;i<a;i++){for(var s=0;s<a;s++)n[i*a+s]=0;for(var r=0;r<a;r++)for(var o=0;o<a;o++)n[i*a+o]+=e[i*a+r]*t[r*a+o]}return n},zt=function(e,t,a){for(var n=e.slice(0),i=1;i<a;i++)e=Pt(e,n,t);return e},Bt=function(e,t,a){for(var n=new Array(t*t),i=0;i<t*t;i++)n[i]=Math.pow(e[i],a);return Nt(n,t),n},Jt=function(e,t,a,n){for(var i=0;i<a;i++){if(Math.round(e[i]*Math.pow(10,n))/Math.pow(10,n)!==Math.round(t[i]*Math.pow(10,n))/Math.pow(10,n))return!1}return!0},Vt=function(e,t){for(var a=0;a<e.length;a++)if(!t[a]||e[a].id()!==t[a].id())return!1;return!0},Ut=function(e){for(var t=this.nodes(),a=this.edges(),n=this.cy(),i=function(e){return Lt(e)}(e),s={},r=0;r<t.length;r++)s[t[r].id()]=r;for(var o,l=t.length,c=l*l,d=new Array(c),u=0;u<c;u++)d[u]=0;for(var p=0;p<a.length;p++){var m=a[p],b=s[m.source().id()],f=s[m.target().id()],h=Rt(m,i.attributes);d[b*l+f]+=h,d[f*l+b]+=h}!function(e,t,a){for(var n=0;n<t;n++)e[n*t+n]=a}(d,l,i.multFactor),Nt(d,l);for(var g=!0,j=0;g&&j<i.maxIterations;)g=!1,o=zt(d,l,i.expandFactor),d=Bt(o,l,i.inflateFactor),Jt(d,o,c,4)||(g=!0),j++;var x=function(e,t,a,n){for(var i=[],s=0;s<t;s++){for(var r=[],o=0;o<t;o++)Math.round(1e3*e[s*t+o])/1e3>0&&r.push(a[o]);0!==r.length&&i.push(n.collection(r))}return i}(d,l,t,n);return x=function(e){for(var t=0;t<e.length;t++)for(var a=0;a<e.length;a++)t!=a&&Vt(e[t],e[a])&&e.splice(a,1);return e}(x)},Gt={markovClustering:Ut,mcl:Ut},qt=function(e){return e},Wt=function(e,t){return Math.abs(t-e)},Ht=function(e,t,a){return e+Wt(t,a)},Yt=function(e,t,a){return e+Math.pow(a-t,2)},$t=function(e){return Math.sqrt(e)},Xt=function(e,t,a){return Math.max(e,Wt(t,a))},Kt=function(e,t,a,n,i){for(var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:qt,r=n,o=0;o<e;o++)r=i(r,t(o),a(o));return s(r)},Qt={euclidean:function(e,t,a){return e>=2?Kt(e,t,a,0,Yt,$t):Kt(e,t,a,0,Ht)},squaredEuclidean:function(e,t,a){return Kt(e,t,a,0,Yt)},manhattan:function(e,t,a){return Kt(e,t,a,0,Ht)},max:function(e,t,a){return Kt(e,t,a,-1/0,Xt)}};function Zt(e,t,a,n,i,s){var r;return r=x(e)?e:Qt[e]||Qt.euclidean,0===t&&x(e)?r(i,s):r(t,a,n,i,s)}Qt["squared-euclidean"]=Qt.squaredEuclidean,Qt.squaredeuclidean=Qt.squaredEuclidean;var ea=he({k:2,m:2,sensitivityThreshold:1e-4,distance:"euclidean",maxIterations:10,attributes:[],testMode:!1,testCentroids:null}),ta=function(e){return ea(e)},aa=function(e,t,a,n,i){var s="kMedoids"!==i?function(e){return a[e]}:function(e){return n[e](a)},r=a,o=t;return Zt(e,n.length,s,(function(e){return n[e](t)}),r,o)},na=function(e,t,a){for(var n=a.length,i=new Array(n),s=new Array(n),r=new Array(t),o=null,l=0;l<n;l++)i[l]=e.min(a[l]).value,s[l]=e.max(a[l]).value;for(var c=0;c<t;c++){o=[];for(var d=0;d<n;d++)o[d]=Math.random()*(s[d]-i[d])+i[d];r[c]=o}return r},ia=function(e,t,a,n,i){for(var s=1/0,r=0,o=0;o<t.length;o++){var l=aa(a,e,t[o],n,i);l<s&&(s=l,r=o)}return r},sa=function(e,t,a){for(var n=[],i=null,s=0;s<t.length;s++)a[(i=t[s]).id()]===e&&n.push(i);return n},ra=function(e,t,a){for(var n=0;n<e.length;n++)for(var i=0;i<e[n].length;i++){if(Math.abs(e[n][i]-t[n][i])>a)return!1}return!0},oa=function(e,t,a){for(var n=0;n<a;n++)if(e===t[n])return!0;return!1},la=function(e,t){var a=new Array(t);if(e.length<50)for(var n=0;n<t;n++){for(var i=e[Math.floor(Math.random()*e.length)];oa(i,a,n);)i=e[Math.floor(Math.random()*e.length)];a[n]=i}else for(var s=0;s<t;s++)a[s]=e[Math.floor(Math.random()*e.length)];return a},ca=function(e,t,a){for(var n=0,i=0;i<t.length;i++)n+=aa("manhattan",t[i],e,a,"kMedoids");return n},da=function(e,t,a,n,i){for(var s,r,o=0;o<t.length;o++)for(var l=0;l<e.length;l++)n[o][l]=Math.pow(a[o][l],i.m);for(var c=0;c<e.length;c++)for(var d=0;d<i.attributes.length;d++){s=0,r=0;for(var u=0;u<t.length;u++)s+=n[u][c]*i.attributes[d](t[u]),r+=n[u][c];e[c][d]=s/r}},ua=function(e,t,a,n,i){for(var s=0;s<e.length;s++)t[s]=e[s].slice();for(var r,o,l,c=2/(i.m-1),d=0;d<a.length;d++)for(var u=0;u<n.length;u++){r=0;for(var p=0;p<a.length;p++)o=aa(i.distance,n[u],a[d],i.attributes,"cmeans"),l=aa(i.distance,n[u],a[p],i.attributes,"cmeans"),r+=Math.pow(o/l,c);e[u][d]=1/r}},pa=function(e){var t,a,n,i,s=this.cy(),r=this.nodes(),o=ta(e);n=new Array(r.length);for(var l=0;l<r.length;l++)n[l]=new Array(o.k);a=new Array(r.length);for(var c=0;c<r.length;c++)a[c]=new Array(o.k);for(var d=0;d<r.length;d++){for(var u=0,p=0;p<o.k;p++)a[d][p]=Math.random(),u+=a[d][p];for(var m=0;m<o.k;m++)a[d][m]=a[d][m]/u}t=new Array(o.k);for(var b=0;b<o.k;b++)t[b]=new Array(o.attributes.length);i=new Array(r.length);for(var f=0;f<r.length;f++)i[f]=new Array(o.k);for(var h=!0,g=0;h&&g<o.maxIterations;)h=!1,da(t,r,a,i,o),ua(a,n,t,r,o),ra(a,n,o.sensitivityThreshold)||(h=!0),g++;return{clusters:function(e,t,a,n){for(var i,s,r=new Array(a.k),o=0;o<r.length;o++)r[o]=[];for(var l=0;l<t.length;l++){i=-1/0,s=-1;for(var c=0;c<t[0].length;c++)t[l][c]>i&&(i=t[l][c],s=c);r[s].push(e[l])}for(var d=0;d<r.length;d++)r[d]=n.collection(r[d]);return r}(r,a,o,s),degreeOfMembership:a}},ma={kMeans:function(e){var t,a=this.cy(),n=this.nodes(),i=null,s=ta(e),o=new Array(s.k),l={};t=s.testMode?"number"==typeof s.testCentroids?na(n,s.k,s.attributes):"object"===r(s.testCentroids)?s.testCentroids:na(n,s.k,s.attributes):na(n,s.k,s.attributes);for(var c,d,u,p=!0,m=0;p&&m<s.maxIterations;){for(var b=0;b<n.length;b++)l[(i=n[b]).id()]=ia(i,t,s.distance,s.attributes,"kMeans");p=!1;for(var f=0;f<s.k;f++){var h=sa(f,n,l);if(0!==h.length){for(var g=s.attributes.length,j=t[f],x=new Array(g),v=new Array(g),y=0;y<g;y++){v[y]=0;for(var O=0;O<h.length;O++)i=h[O],v[y]+=s.attributes[y](i);x[y]=v[y]/h.length,c=x[y],d=j[y],u=s.sensitivityThreshold,Math.abs(d-c)<=u||(p=!0)}t[f]=x,o[f]=a.collection(h)}}m++}return o},kMedoids:function(e){var t,a,n=this.cy(),i=this.nodes(),s=null,o=ta(e),l=new Array(o.k),c={},d=new Array(o.k);o.testMode?"number"==typeof o.testCentroids||(t="object"===r(o.testCentroids)?o.testCentroids:la(i,o.k)):t=la(i,o.k);for(var u=!0,p=0;u&&p<o.maxIterations;){for(var m=0;m<i.length;m++)c[(s=i[m]).id()]=ia(s,t,o.distance,o.attributes,"kMedoids");u=!1;for(var b=0;b<t.length;b++){var f=sa(b,i,c);if(0!==f.length){d[b]=ca(t[b],f,o.attributes);for(var h=0;h<f.length;h++)(a=ca(f[h],f,o.attributes))<d[b]&&(d[b]=a,t[b]=f[h],u=!0);l[b]=n.collection(f)}}p++}return l},fuzzyCMeans:pa,fcm:pa},ba=he({distance:"euclidean",linkage:"min",mode:"threshold",threshold:1/0,addDendrogram:!1,dendrogramDepth:0,attributes:[]}),fa={single:"min",complete:"max"},ha=function(e,t,a,n,i){for(var s,r=0,o=1/0,l=i.attributes,c=function(e,t){return Zt(i.distance,l.length,(function(t){return l[t](e)}),(function(e){return l[e](t)}),e,t)},d=0;d<e.length;d++){var u=e[d].key,p=a[u][n[u]];p<o&&(r=u,o=p)}if("threshold"===i.mode&&o>=i.threshold||"dendrogram"===i.mode&&1===e.length)return!1;var m,b=t[r],f=t[n[r]];m="dendrogram"===i.mode?{left:b,right:f,key:b.key}:{value:b.value.concat(f.value),key:b.key},e[b.index]=m,e.splice(f.index,1),t[b.key]=m;for(var h=0;h<e.length;h++){var g=e[h];b.key===g.key?s=1/0:"min"===i.linkage?(s=a[b.key][g.key],a[b.key][g.key]>a[f.key][g.key]&&(s=a[f.key][g.key])):"max"===i.linkage?(s=a[b.key][g.key],a[b.key][g.key]<a[f.key][g.key]&&(s=a[f.key][g.key])):s="mean"===i.linkage?(a[b.key][g.key]*b.size+a[f.key][g.key]*f.size)/(b.size+f.size):"dendrogram"===i.mode?c(g.value,b.value):c(g.value[0],b.value[0]),a[b.key][g.key]=a[g.key][b.key]=s}for(var j=0;j<e.length;j++){var x=e[j].key;if(n[x]===b.key||n[x]===f.key){for(var v=x,y=0;y<e.length;y++){var O=e[y].key;a[x][O]<a[x][v]&&(v=O)}n[x]=v}e[j].index=j}return b.key=f.key=b.index=f.index=null,!0},ga=function e(t,a,n){t&&(t.value?a.push(t.value):(t.left&&e(t.left,a),t.right&&e(t.right,a)))},ja=function e(t,a){if(!t)return"";if(t.left&&t.right){var n=e(t.left,a),i=e(t.right,a),s=a.add({group:"nodes",data:{id:n+","+i}});return a.add({group:"edges",data:{source:n,target:s.id()}}),a.add({group:"edges",data:{source:i,target:s.id()}}),s.id()}return t.value?t.value.id():void 0},xa=function e(t,a,n){if(!t)return[];var i=[],s=[],r=[];return 0===a?(t.left&&ga(t.left,i),t.right&&ga(t.right,s),r=i.concat(s),[n.collection(r)]):1===a?t.value?[n.collection(t.value)]:(t.left&&ga(t.left,i),t.right&&ga(t.right,s),[n.collection(i),n.collection(s)]):t.value?[n.collection(t.value)]:(t.left&&(i=e(t.left,a-1,n)),t.right&&(s=e(t.right,a-1,n)),i.concat(s))},va=function(e){for(var t=this.cy(),a=this.nodes(),n=function(e){var t=ba(e),a=fa[t.linkage];return null!=a&&(t.linkage=a),t}(e),i=n.attributes,s=function(e,t){return Zt(n.distance,i.length,(function(t){return i[t](e)}),(function(e){return i[e](t)}),e,t)},r=[],o=[],l=[],c=[],d=0;d<a.length;d++){var u={value:"dendrogram"===n.mode?a[d]:[a[d]],key:d,index:d};r[d]=u,c[d]=u,o[d]=[],l[d]=0}for(var p=0;p<r.length;p++)for(var m=0;m<=p;m++){var b=void 0;b="dendrogram"===n.mode?p===m?1/0:s(r[p].value,r[m].value):p===m?1/0:s(r[p].value[0],r[m].value[0]),o[p][m]=b,o[m][p]=b,b<o[p][l[p]]&&(l[p]=m)}for(var f,h=ha(r,c,o,l,n);h;)h=ha(r,c,o,l,n);return"dendrogram"===n.mode?(f=xa(r[0],n.dendrogramDepth,t),n.addDendrogram&&ja(r[0],t)):(f=new Array(r.length),r.forEach((function(e,a){e.key=e.index=null,f[a]=t.collection(e.value)}))),f},ya={hierarchicalClustering:va,hca:va},Oa=he({distance:"euclidean",preference:"median",damping:.8,maxIterations:1e3,minIterations:100,attributes:[]}),Ea=function(e,t,a,n){var i=function(e,t){return n[t](e)};return-Zt(e,n.length,(function(e){return i(t,e)}),(function(e){return i(a,e)}),t,a)},wa=function(e,t){return"median"===t?function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];arguments.length>3&&void 0!==arguments[3]&&!arguments[3]?(a<e.length&&e.splice(a,e.length-a),t>0&&e.splice(0,t)):e=e.slice(t,a);for(var s=0,r=e.length-1;r>=0;r--){var o=e[r];i?isFinite(o)||(e[r]=-1/0,s++):e.splice(r,1)}n&&e.sort((function(e,t){return e-t}));var l=e.length,c=Math.floor(l/2);return l%2!=0?e[c+1+s]:(e[c-1+s]+e[c+s])/2}(e):"mean"===t?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=0,i=0,s=t;s<a;s++){var r=e[s];isFinite(r)&&(n+=r,i++)}return n/i}(e):"min"===t?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=1/0,i=t;i<a;i++){var s=e[i];isFinite(s)&&(n=Math.min(s,n))}return n}(e):"max"===t?function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length,n=-1/0,i=t;i<a;i++){var s=e[i];isFinite(s)&&(n=Math.max(s,n))}return n}(e):t},Ma=function(e,t,a){for(var n=[],i=0;i<e;i++){for(var s=-1,r=-1/0,o=0;o<a.length;o++){var l=a[o];t[i*e+l]>r&&(s=l,r=t[i*e+l])}s>0&&n.push(s)}for(var c=0;c<a.length;c++)n[a[c]]=a[c];return n},Sa=function(e){for(var t,a,n,i,s,r,o=this.cy(),l=this.nodes(),c=function(e){var t=e.damping,a=e.preference;.5<=t&&t<1||ce("Damping must range on [0.5, 1).  Got: ".concat(t));var n=["median","mean","min","max"];return n.some((function(e){return e===a}))||O(a)||ce("Preference must be one of [".concat(n.map((function(e){return"'".concat(e,"'")})).join(", "),"] or a number.  Got: ").concat(a)),Oa(e)}(e),d={},u=0;u<l.length;u++)d[l[u].id()]=u;a=(t=l.length)*t,n=new Array(a);for(var p=0;p<a;p++)n[p]=-1/0;for(var m=0;m<t;m++)for(var b=0;b<t;b++)m!==b&&(n[m*t+b]=Ea(c.distance,l[m],l[b],c.attributes));i=wa(n,c.preference);for(var f=0;f<t;f++)n[f*t+f]=i;s=new Array(a);for(var h=0;h<a;h++)s[h]=0;r=new Array(a);for(var g=0;g<a;g++)r[g]=0;for(var j=new Array(t),x=new Array(t),v=new Array(t),y=0;y<t;y++)j[y]=0,x[y]=0,v[y]=0;for(var E,w=new Array(t*c.minIterations),M=0;M<w.length;M++)w[M]=0;for(E=0;E<c.maxIterations;E++){for(var S=0;S<t;S++){for(var _=-1/0,T=-1/0,C=-1,k=0,F=0;F<t;F++)j[F]=s[S*t+F],(k=r[S*t+F]+n[S*t+F])>=_?(T=_,_=k,C=F):k>T&&(T=k);for(var I=0;I<t;I++)s[S*t+I]=(1-c.damping)*(n[S*t+I]-_)+c.damping*j[I];s[S*t+C]=(1-c.damping)*(n[S*t+C]-T)+c.damping*j[C]}for(var D=0;D<t;D++){for(var A=0,L=0;L<t;L++)j[L]=r[L*t+D],x[L]=Math.max(0,s[L*t+D]),A+=x[L];A-=x[D],x[D]=s[D*t+D],A+=x[D];for(var R=0;R<t;R++)r[R*t+D]=(1-c.damping)*Math.min(0,A-x[R])+c.damping*j[R];r[D*t+D]=(1-c.damping)*(A-x[D])+c.damping*j[D]}for(var N=0,P=0;P<t;P++){var z=r[P*t+P]+s[P*t+P]>0?1:0;w[E%c.minIterations*t+P]=z,N+=z}if(N>0&&(E>=c.minIterations-1||E==c.maxIterations-1)){for(var B=0,J=0;J<t;J++){v[J]=0;for(var V=0;V<c.minIterations;V++)v[J]+=w[V*t+J];0!==v[J]&&v[J]!==c.minIterations||B++}if(B===t)break}}for(var U=function(e,t,a){for(var n=[],i=0;i<e;i++)t[i*e+i]+a[i*e+i]>0&&n.push(i);return n}(t,s,r),G=function(e,t,a){for(var n=Ma(e,t,a),i=0;i<a.length;i++){for(var s=[],r=0;r<n.length;r++)n[r]===a[i]&&s.push(r);for(var o=-1,l=-1/0,c=0;c<s.length;c++){for(var d=0,u=0;u<s.length;u++)d+=t[s[u]*e+s[c]];d>l&&(o=c,l=d)}a[i]=s[o]}return Ma(e,t,a)}(t,n,U),q={},W=0;W<U.length;W++)q[U[W]]=[];for(var H=0;H<l.length;H++){var Y=G[d[l[H].id()]];null!=Y&&q[Y].push(l[H])}for(var $=new Array(U.length),X=0;X<U.length;X++)$[X]=o.collection(q[U[X]]);return $},_a={};[Se,Te,Ce,Fe,De,Le,ze,Tt,kt,It,At,Gt,ma,ya,{affinityPropagation:Sa,ap:Sa}].forEach((function(e){P(_a,e)}));
/*!
Embeddable Minimum Strictly-Compliant Promises/A+ 1.1.1 Thenable
Copyright (c) 2013-2014 Ralf S. Engelschall (http://engelschall.com)
Licensed under The MIT License (http://opensource.org/licenses/MIT)
*/
var Ta=function e(t){if(!(this instanceof e))return new e(t);this.id="Thenable/1.0.7",this.state=0,this.fulfillValue=void 0,this.rejectReason=void 0,this.onFulfilled=[],this.onRejected=[],this.proxy={then:this.then.bind(this)},"function"==typeof t&&t.call(this,this.fulfill.bind(this),this.reject.bind(this))};Ta.prototype={fulfill:function(e){return Ca(this,1,"fulfillValue",e)},reject:function(e){return Ca(this,2,"rejectReason",e)},then:function(e,t){var a=this,n=new Ta;return a.onFulfilled.push(Ia(e,n,"fulfill")),a.onRejected.push(Ia(t,n,"reject")),ka(a),n.proxy}};var Ca=function(e,t,a,n){return 0===e.state&&(e.state=t,e[a]=n,ka(e)),e},ka=function(e){1===e.state?Fa(e,"onFulfilled",e.fulfillValue):2===e.state&&Fa(e,"onRejected",e.rejectReason)},Fa=function(e,a,n){if(0!==e[a].length){var i=e[a];e[a]=[];var s=function(){for(var e=0;e<i.length;e++)i[e](n)};"function"==typeof t?t(s):setTimeout(s,0)}},Ia=function(e,t,a){return function(n){if("function"!=typeof e)t[a].call(t,n);else{var i;try{i=e(n)}catch(e){return void t.reject(e)}Da(t,i)}}},Da=function e(t,a){if(t!==a&&t.proxy!==a){var n;if("object"===r(a)&&null!==a||"function"==typeof a)try{n=a.then}catch(e){return void t.reject(e)}if("function"!=typeof n)t.fulfill(a);else{var i=!1;try{n.call(a,(function(n){i||(i=!0,n===a?t.reject(new TypeError("circular thenable chain")):e(t,n))}),(function(e){i||(i=!0,t.reject(e))}))}catch(e){i||t.reject(e)}}}else t.reject(new TypeError("cannot resolve promise with itself"))};Ta.all=function(e){return new Ta((function(t,a){for(var n=new Array(e.length),i=0,s=function(a,s){n[a]=s,++i===e.length&&t(n)},r=0;r<e.length;r++)!function(t){var n=e[t];null!=n&&null!=n.then?n.then((function(e){s(t,e)}),(function(e){a(e)})):s(t,n)}(r)}))},Ta.resolve=function(e){return new Ta((function(t,a){t(e)}))},Ta.reject=function(e){return new Ta((function(t,a){a(e)}))};var Aa="undefined"!=typeof Promise?Promise:Ta,La=function(e,t,a){var n=_(e),i=!n,s=this._private=P({duration:1e3},t,a);if(s.target=e,s.style=s.style||s.css,s.started=!1,s.playing=!1,s.hooked=!1,s.applying=!1,s.progress=0,s.completes=[],s.frames=[],s.complete&&x(s.complete)&&s.completes.push(s.complete),i){var r=e.position();s.startPosition=s.startPosition||{x:r.x,y:r.y},s.startStyle=s.startStyle||e.cy().style().getAnimationStartStyle(e,s.style)}if(n){var o=e.pan();s.startPan={x:o.x,y:o.y},s.startZoom=e.zoom()}this.length=1,this[0]=this},Ra=La.prototype;P(Ra,{instanceString:function(){return"animation"},hook:function(){var e=this._private;if(!e.hooked){var t=e.target._private.animation;(e.queue?t.queue:t.current).push(this),w(e.target)&&e.target.cy().addToAnimationPool(e.target),e.hooked=!0}return this},play:function(){var e=this._private;return 1===e.progress&&(e.progress=0),e.playing=!0,e.started=!1,e.stopped=!1,this.hook(),this},playing:function(){return this._private.playing},apply:function(){var e=this._private;return e.applying=!0,e.started=!1,e.stopped=!1,this.hook(),this},applying:function(){return this._private.applying},pause:function(){var e=this._private;return e.playing=!1,e.started=!1,this},stop:function(){var e=this._private;return e.playing=!1,e.started=!1,e.stopped=!0,this},rewind:function(){return this.progress(0)},fastforward:function(){return this.progress(1)},time:function(e){var t=this._private;return void 0===e?t.progress*t.duration:this.progress(e/t.duration)},progress:function(e){var t=this._private,a=t.playing;return void 0===e?t.progress:(a&&this.pause(),t.progress=e,t.started=!1,a&&this.play(),this)},completed:function(){return 1===this._private.progress},reverse:function(){var e=this._private,t=e.playing;t&&this.pause(),e.progress=1-e.progress,e.started=!1;var a=function(t,a){var n=e[t];null!=n&&(e[t]=e[a],e[a]=n)};if(a("zoom","startZoom"),a("pan","startPan"),a("position","startPosition"),e.style)for(var n=0;n<e.style.length;n++){var i=e.style[n],s=i.name,r=e.startStyle[s];e.startStyle[s]=i,e.style[n]=r}return t&&this.play(),this},promise:function(e){var t,a=this._private;switch(e){case"frame":t=a.frames;break;default:case"complete":case"completed":t=a.completes}return new Aa((function(e,a){t.push((function(){e()}))}))}}),Ra.complete=Ra.completed,Ra.run=Ra.play,Ra.running=Ra.playing;var Na={};[{animated:function(){return function(){var e=this,t=void 0!==e.length?e:[e];if(!(this._private.cy||this).styleEnabled())return!1;var a=t[0];return a?a._private.animation.current.length>0:void 0}},clearQueue:function(){return function(){var e=this,t=void 0!==e.length?e:[e];if(!(this._private.cy||this).styleEnabled())return this;for(var a=0;a<t.length;a++){t[a]._private.animation.queue=[]}return this}},delay:function(){return function(e,t){return(this._private.cy||this).styleEnabled()?this.animate({delay:e,duration:e,complete:t}):this}},delayAnimation:function(){return function(e,t){return(this._private.cy||this).styleEnabled()?this.animation({delay:e,duration:e,complete:t}):this}},animation:function(){return function(e,t){var a=this,n=void 0!==a.length,i=n?a:[a],s=this._private.cy||this,r=!n,o=!r;if(!s.styleEnabled())return this;var l=s.style();if(e=P({},e,t),0===Object.keys(e).length)return new La(i[0],e);switch(void 0===e.duration&&(e.duration=400),e.duration){case"slow":e.duration=600;break;case"fast":e.duration=200}if(o&&(e.style=l.getPropsList(e.style||e.css),e.css=void 0),o&&null!=e.renderedPosition){var c=e.renderedPosition,d=s.pan(),u=s.zoom();e.position=Je(c,u,d)}if(r&&null!=e.panBy){var p=e.panBy,m=s.pan();e.pan={x:m.x+p.x,y:m.y+p.y}}var b=e.center||e.centre;if(r&&null!=b){var f=s.getCenterPan(b.eles,e.zoom);null!=f&&(e.pan=f)}if(r&&null!=e.fit){var h=e.fit,g=s.getFitViewport(h.eles||h.boundingBox,h.padding);null!=g&&(e.pan=g.pan,e.zoom=g.zoom)}if(r&&y(e.zoom)){var j=s.getZoomedViewport(e.zoom);null!=j&&(j.zoomed&&(e.zoom=j.zoom),j.panned&&(e.pan=j.pan))}return new La(i[0],e)}},animate:function(){return function(e,t){var a=this,n=void 0!==a.length?a:[a];if(!(this._private.cy||this).styleEnabled())return this;t&&(e=P({},e,t));for(var i=0;i<n.length;i++){var s=n[i],r=s.animated()&&(void 0===e.queue||e.queue);s.animation(e,r?{queue:!0}:void 0).play()}return this}},stop:function(){return function(e,t){var a=this,n=void 0!==a.length?a:[a],i=this._private.cy||this;if(!i.styleEnabled())return this;for(var s=0;s<n.length;s++){for(var r=n[s]._private,o=r.animation.current,l=0;l<o.length;l++){var c=o[l]._private;t&&(c.duration=0)}e&&(r.animation.queue=[]),t||(r.animation.current=[])}return i.notify("draw"),this}}},{data:function(e){return e=P({},{field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,beforeGet:function(e){},beforeSet:function(e,t){},onSet:function(e){},canSet:function(e){return!0}},e),function(t,a){var n=e,i=this,s=void 0!==i.length,r=s?i:[i],o=s?i[0]:i;if(j(t)){var l;if(n.allowGetting&&void 0===a)return o&&(n.beforeGet(o),l=o._private[n.field][t]),l;if(n.allowSetting&&void 0!==a&&!n.immutableKeys[t]){var c=function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}({},t,a);n.beforeSet(i,c);for(var d=0,u=r.length;d<u;d++){var p=r[d];n.canSet(p)&&(p._private[n.field][t]=a)}n.updateStyle&&i.updateStyle(),n.onSet(i),n.settingTriggersEvent&&i[n.triggerFnName](n.settingEvent)}}else if(n.allowSetting&&y(t)){var m,b,f=t,h=Object.keys(f);n.beforeSet(i,f);for(var g=0;g<h.length;g++){if(b=f[m=h[g]],!n.immutableKeys[m])for(var v=0;v<r.length;v++){var O=r[v];n.canSet(O)&&(O._private[n.field][m]=b)}}n.updateStyle&&i.updateStyle(),n.onSet(i),n.settingTriggersEvent&&i[n.triggerFnName](n.settingEvent)}else if(n.allowBinding&&x(t)){var E=t;i.on(n.bindingEvent,E)}else if(n.allowGetting&&void 0===t){var w;return o&&(n.beforeGet(o),w=o._private[n.field]),w}return i}},removeData:function(e){return e=P({},{field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}},e),function(t){var a=e,n=this,i=void 0!==n.length?n:[n];if(j(t)){for(var s=t.split(/\s+/),r=s.length,o=0;o<r;o++){var l=s[o];if(!C(l))if(!a.immutableKeys[l])for(var c=0,d=i.length;c<d;c++)i[c]._private[a.field][l]=void 0}a.triggerEvent&&n[a.triggerFnName](a.event)}else if(void 0===t){for(var u=0,p=i.length;u<p;u++)for(var m=i[u]._private[a.field],b=Object.keys(m),f=0;f<b.length;f++){var h=b[f];!a.immutableKeys[h]&&(m[h]=void 0)}a.triggerEvent&&n[a.triggerFnName](a.event)}return n}}},{eventAliasesOn:function(e){var t=e;t.addListener=t.listen=t.bind=t.on,t.unlisten=t.unbind=t.off=t.removeListener,t.trigger=t.emit,t.pon=t.promiseOn=function(e,t){var a=this,n=Array.prototype.slice.call(arguments,0);return new Aa((function(e,t){var i=n.concat([function(t){a.off.apply(a,s),e(t)}]),s=i.concat([]);a.on.apply(a,i)}))}}}].forEach((function(e){P(Na,e)}));var Pa={animate:Na.animate(),animation:Na.animation(),animated:Na.animated(),clearQueue:Na.clearQueue(),delay:Na.delay(),delayAnimation:Na.delayAnimation(),stop:Na.stop()},za={classes:function(e){var t=this;if(void 0===e){var a=[];return t[0]._private.classes.forEach((function(e){return a.push(e)})),a}v(e)||(e=(e||"").match(/\S+/g)||[]);for(var n=[],i=new Ee(e),s=0;s<t.length;s++){for(var r=t[s],o=r._private,l=o.classes,c=!1,d=0;d<e.length;d++){var u=e[d];if(!l.has(u)){c=!0;break}}c||(c=l.size!==e.length),c&&(o.classes=i,n.push(r))}return n.length>0&&this.spawn(n).updateStyle().emit("class"),t},addClass:function(e){return this.toggleClass(e,!0)},hasClass:function(e){var t=this[0];return null!=t&&t._private.classes.has(e)},toggleClass:function(e,t){v(e)||(e=e.match(/\S+/g)||[]);for(var a=this,n=void 0===t,i=[],s=0,r=a.length;s<r;s++)for(var o=a[s],l=o._private.classes,c=!1,d=0;d<e.length;d++){var u=e[d],p=l.has(u),m=!1;t||n&&!p?(l.add(u),m=!0):(!t||n&&p)&&(l.delete(u),m=!0),!c&&m&&(i.push(o),c=!0)}return i.length>0&&this.spawn(i).updateStyle().emit("class"),a},removeClass:function(e){return this.toggleClass(e,!1)},flashClass:function(e,t){var a=this;if(null==t)t=250;else if(0===t)return a;return a.addClass(e),setTimeout((function(){a.removeClass(e)}),t),a}};za.className=za.classNames=za.classes;var Ba={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:"\"(?:\\\\\"|[^\"])*\"|'(?:\\\\'|[^'])*'",number:R,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$",group:"node|edge|\\*",directedEdge:"\\s+->\\s+",undirectedEdge:"\\s+<->\\s+"};Ba.variable="(?:[\\w-]|(?:\\\\"+Ba.metaChar+"))+",Ba.value=Ba.string+"|"+Ba.number,Ba.className=Ba.variable,Ba.id=Ba.variable,function(){var e,t,a;for(e=Ba.comparatorOp.split("|"),a=0;a<e.length;a++)t=e[a],Ba.comparatorOp+="|@"+t;for(e=Ba.comparatorOp.split("|"),a=0;a<e.length;a++)(t=e[a]).indexOf("!")>=0||"="!==t&&(Ba.comparatorOp+="|\\!"+t)}();var Ja=0,Va=1,Ua=2,Ga=3,qa=4,Wa=5,Ha=6,Ya=7,$a=8,Xa=9,Ka=10,Qa=11,Za=12,en=13,tn=14,an=15,nn=16,sn=17,rn=18,on=19,ln=20,cn=[{selector:":selected",matches:function(e){return e.selected()}},{selector:":unselected",matches:function(e){return!e.selected()}},{selector:":selectable",matches:function(e){return e.selectable()}},{selector:":unselectable",matches:function(e){return!e.selectable()}},{selector:":locked",matches:function(e){return e.locked()}},{selector:":unlocked",matches:function(e){return!e.locked()}},{selector:":visible",matches:function(e){return e.visible()}},{selector:":hidden",matches:function(e){return!e.visible()}},{selector:":transparent",matches:function(e){return e.transparent()}},{selector:":grabbed",matches:function(e){return e.grabbed()}},{selector:":free",matches:function(e){return!e.grabbed()}},{selector:":removed",matches:function(e){return e.removed()}},{selector:":inside",matches:function(e){return!e.removed()}},{selector:":grabbable",matches:function(e){return e.grabbable()}},{selector:":ungrabbable",matches:function(e){return!e.grabbable()}},{selector:":animated",matches:function(e){return e.animated()}},{selector:":unanimated",matches:function(e){return!e.animated()}},{selector:":parent",matches:function(e){return e.isParent()}},{selector:":childless",matches:function(e){return e.isChildless()}},{selector:":child",matches:function(e){return e.isChild()}},{selector:":orphan",matches:function(e){return e.isOrphan()}},{selector:":nonorphan",matches:function(e){return e.isChild()}},{selector:":compound",matches:function(e){return e.isNode()?e.isParent():e.source().isParent()||e.target().isParent()}},{selector:":loop",matches:function(e){return e.isLoop()}},{selector:":simple",matches:function(e){return e.isSimple()}},{selector:":active",matches:function(e){return e.active()}},{selector:":inactive",matches:function(e){return!e.active()}},{selector:":backgrounding",matches:function(e){return e.backgrounding()}},{selector:":nonbackgrounding",matches:function(e){return!e.backgrounding()}}].sort((function(e,t){return function(e,t){return-1*N(e,t)}(e.selector,t.selector)})),dn=function(){for(var e,t={},a=0;a<cn.length;a++)t[(e=cn[a]).selector]=e.matches;return t}(),un="("+cn.map((function(e){return e.selector})).join("|")+")",pn=function(e){return e.replace(new RegExp("\\\\("+Ba.metaChar+")","g"),(function(e,t){return t}))},mn=function(e,t,a){e[e.length-1]=a},bn=[{name:"group",query:!0,regex:"("+Ba.group+")",populate:function(e,t,a){var n=d(a,1)[0];t.checks.push({type:Ja,value:"*"===n?n:n+"s"})}},{name:"state",query:!0,regex:un,populate:function(e,t,a){var n=d(a,1)[0];t.checks.push({type:Ya,value:n})}},{name:"id",query:!0,regex:"\\#("+Ba.id+")",populate:function(e,t,a){var n=d(a,1)[0];t.checks.push({type:$a,value:pn(n)})}},{name:"className",query:!0,regex:"\\.("+Ba.className+")",populate:function(e,t,a){var n=d(a,1)[0];t.checks.push({type:Xa,value:pn(n)})}},{name:"dataExists",query:!0,regex:"\\[\\s*("+Ba.variable+")\\s*\\]",populate:function(e,t,a){var n=d(a,1)[0];t.checks.push({type:qa,field:pn(n)})}},{name:"dataCompare",query:!0,regex:"\\[\\s*("+Ba.variable+")\\s*("+Ba.comparatorOp+")\\s*("+Ba.value+")\\s*\\]",populate:function(e,t,a){var n=d(a,3),i=n[0],s=n[1],r=n[2];r=null!=new RegExp("^"+Ba.string+"$").exec(r)?r.substring(1,r.length-1):parseFloat(r),t.checks.push({type:Ga,field:pn(i),operator:s,value:r})}},{name:"dataBool",query:!0,regex:"\\[\\s*("+Ba.boolOp+")\\s*("+Ba.variable+")\\s*\\]",populate:function(e,t,a){var n=d(a,2),i=n[0],s=n[1];t.checks.push({type:Wa,field:pn(s),operator:i})}},{name:"metaCompare",query:!0,regex:"\\[\\[\\s*("+Ba.meta+")\\s*("+Ba.comparatorOp+")\\s*("+Ba.number+")\\s*\\]\\]",populate:function(e,t,a){var n=d(a,3),i=n[0],s=n[1],r=n[2];t.checks.push({type:Ha,field:pn(i),operator:s,value:parseFloat(r)})}},{name:"nextQuery",separator:!0,regex:Ba.separator,populate:function(e,t){var a=e.currentSubject,n=e.edgeCount,i=e.compoundCount,s=e[e.length-1];return null!=a&&(s.subject=a,e.currentSubject=null),s.edgeCount=n,s.compoundCount=i,e.edgeCount=0,e.compoundCount=0,e[e.length++]={checks:[]}}},{name:"directedEdge",separator:!0,regex:Ba.directedEdge,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},n=t,i={checks:[]};return a.checks.push({type:Qa,source:n,target:i}),mn(e,0,a),e.edgeCount++,i}var s={checks:[]},r=t,o={checks:[]};return s.checks.push({type:Za,source:r,target:o}),mn(e,0,s),e.edgeCount++,o}},{name:"undirectedEdge",separator:!0,regex:Ba.undirectedEdge,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},n=t,i={checks:[]};return a.checks.push({type:Ka,nodes:[n,i]}),mn(e,0,a),e.edgeCount++,i}var s={checks:[]},r=t,o={checks:[]};return s.checks.push({type:tn,node:r,neighbor:o}),mn(e,0,s),o}},{name:"child",separator:!0,regex:Ba.child,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},n={checks:[]},i=e[e.length-1];return a.checks.push({type:an,parent:i,child:n}),mn(e,0,a),e.compoundCount++,n}if(e.currentSubject===t){var s={checks:[]},r=e[e.length-1],o={checks:[]},l={checks:[]},c={checks:[]},d={checks:[]};return s.checks.push({type:on,left:r,right:o,subject:l}),l.checks=t.checks,t.checks=[{type:ln}],d.checks.push({type:ln}),o.checks.push({type:sn,parent:d,child:c}),mn(e,0,s),e.currentSubject=l,e.compoundCount++,c}var u={checks:[]},p={checks:[]},m=[{type:sn,parent:u,child:p}];return u.checks=t.checks,t.checks=m,e.compoundCount++,p}},{name:"descendant",separator:!0,regex:Ba.descendant,populate:function(e,t){if(null==e.currentSubject){var a={checks:[]},n={checks:[]},i=e[e.length-1];return a.checks.push({type:nn,ancestor:i,descendant:n}),mn(e,0,a),e.compoundCount++,n}if(e.currentSubject===t){var s={checks:[]},r=e[e.length-1],o={checks:[]},l={checks:[]},c={checks:[]},d={checks:[]};return s.checks.push({type:on,left:r,right:o,subject:l}),l.checks=t.checks,t.checks=[{type:ln}],d.checks.push({type:ln}),o.checks.push({type:rn,ancestor:d,descendant:c}),mn(e,0,s),e.currentSubject=l,e.compoundCount++,c}var u={checks:[]},p={checks:[]},m=[{type:rn,ancestor:u,descendant:p}];return u.checks=t.checks,t.checks=m,e.compoundCount++,p}},{name:"subject",modifier:!0,regex:Ba.subject,populate:function(e,t){if(null!=e.currentSubject&&e.currentSubject!==t)return ue("Redefinition of subject in selector `"+e.toString()+"`"),!1;e.currentSubject=t;var a=e[e.length-1].checks[0],n=null==a?null:a.type;n===Qa?a.type=en:n===Ka&&(a.type=tn,a.node=a.nodes[1],a.neighbor=a.nodes[0],a.nodes=null)}}];bn.forEach((function(e){return e.regexObj=new RegExp("^"+e.regex)}));var fn=function(e){for(var t,a,n,i=0;i<bn.length;i++){var s=bn[i],r=s.name,o=e.match(s.regexObj);if(null!=o){a=o,t=s,n=r;var l=o[0];e=e.substring(l.length);break}}return{expr:t,match:a,name:n,remaining:e}},hn={parse:function(e){var t=this,a=t.inputText=e,n=t[0]={checks:[]};for(t.length=1,a=function(e){var t=e.match(/^\s+/);if(t){var a=t[0];e=e.substring(a.length)}return e}(a);;){var i=fn(a);if(null==i.expr)return ue("The selector `"+e+"`is invalid"),!1;var s=i.match.slice(1),r=i.expr.populate(t,n,s);if(!1===r)return!1;if(null!=r&&(n=r),(a=i.remaining).match(/^\s*$/))break}var o=t[t.length-1];null!=t.currentSubject&&(o.subject=t.currentSubject),o.edgeCount=t.edgeCount,o.compoundCount=t.compoundCount;for(var l=0;l<t.length;l++){var c=t[l];if(c.compoundCount>0&&c.edgeCount>0)return ue("The selector `"+e+"` is invalid because it uses both a compound selector and an edge selector"),!1;if(c.edgeCount>1)return ue("The selector `"+e+"` is invalid because it uses multiple edge selectors"),!1;1===c.edgeCount&&ue("The selector `"+e+"` is deprecated.  Edge selectors do not take effect on changes to source and target nodes after an edge is added, for performance reasons.  Use a class or data selector on edges instead, updating the class or data of an edge when your app detects a change in source or target nodes.")}return!0},toString:function(){if(null!=this.toStringCache)return this.toStringCache;for(var e=function(e){return null==e?"":e},t=function(t){return j(t)?'"'+t+'"':e(t)},a=function(e){return" "+e+" "},n=function(n,s){var r=n.type,o=n.value;switch(r){case Ja:var l=e(o);return l.substring(0,l.length-1);case Ga:var c=n.field,d=n.operator;return"["+c+a(e(d))+t(o)+"]";case Wa:var u=n.operator,p=n.field;return"["+e(u)+p+"]";case qa:return"["+n.field+"]";case Ha:var m=n.operator;return"[["+n.field+a(e(m))+t(o)+"]]";case Ya:return o;case $a:return"#"+o;case Xa:return"."+o;case sn:case an:return i(n.parent,s)+a(">")+i(n.child,s);case rn:case nn:return i(n.ancestor,s)+" "+i(n.descendant,s);case on:var b=i(n.left,s),f=i(n.subject,s),h=i(n.right,s);return b+(b.length>0?" ":"")+f+h;case ln:return""}},i=function(e,t){return e.checks.reduce((function(a,i,s){return a+(t===e&&0===s?"$":"")+n(i,t)}),"")},s="",r=0;r<this.length;r++){var o=this[r];s+=i(o,o.subject),this.length>1&&r<this.length-1&&(s+=", ")}return this.toStringCache=s,s}},gn=function(e,t,a){var n,i,s,r=j(e),o=O(e),l=j(a),c=!1,d=!1,u=!1;switch(t.indexOf("!")>=0&&(t=t.replace("!",""),d=!0),t.indexOf("@")>=0&&(t=t.replace("@",""),c=!0),(r||l||c)&&(i=r||o?""+e:"",s=""+a),c&&(e=i=i.toLowerCase(),a=s=s.toLowerCase()),t){case"*=":n=i.indexOf(s)>=0;break;case"$=":n=i.indexOf(s,i.length-s.length)>=0;break;case"^=":n=0===i.indexOf(s);break;case"=":n=e===a;break;case">":u=!0,n=e>a;break;case">=":u=!0,n=e>=a;break;case"<":u=!0,n=e<a;break;case"<=":u=!0,n=e<=a;break;default:n=!1}return!d||null==e&&u||(n=!n),n},jn=function(e,t){return e.data(t)},xn=[],vn=function(e,t){return e.checks.every((function(e){return xn[e.type](e,t)}))};xn[Ja]=function(e,t){var a=e.value;return"*"===a||a===t.group()},xn[Ya]=function(e,t){return function(e,t){return dn[e](t)}(e.value,t)},xn[$a]=function(e,t){var a=e.value;return t.id()===a},xn[Xa]=function(e,t){var a=e.value;return t.hasClass(a)},xn[Ha]=function(e,t){var a=e.field,n=e.operator,i=e.value;return gn(function(e,t){return e[t]()}(t,a),n,i)},xn[Ga]=function(e,t){var a=e.field,n=e.operator,i=e.value;return gn(jn(t,a),n,i)},xn[Wa]=function(e,t){var a=e.field,n=e.operator;return function(e,t){switch(t){case"?":return!!e;case"!":return!e;case"^":return void 0===e}}(jn(t,a),n)},xn[qa]=function(e,t){var a=e.field;e.operator;return void 0!==jn(t,a)},xn[Ka]=function(e,t){var a=e.nodes[0],n=e.nodes[1],i=t.source(),s=t.target();return vn(a,i)&&vn(n,s)||vn(n,i)&&vn(a,s)},xn[tn]=function(e,t){return vn(e.node,t)&&t.neighborhood().some((function(t){return t.isNode()&&vn(e.neighbor,t)}))},xn[Qa]=function(e,t){return vn(e.source,t.source())&&vn(e.target,t.target())},xn[Za]=function(e,t){return vn(e.source,t)&&t.outgoers().some((function(t){return t.isNode()&&vn(e.target,t)}))},xn[en]=function(e,t){return vn(e.target,t)&&t.incomers().some((function(t){return t.isNode()&&vn(e.source,t)}))},xn[an]=function(e,t){return vn(e.child,t)&&vn(e.parent,t.parent())},xn[sn]=function(e,t){return vn(e.parent,t)&&t.children().some((function(t){return vn(e.child,t)}))},xn[nn]=function(e,t){return vn(e.descendant,t)&&t.ancestors().some((function(t){return vn(e.ancestor,t)}))},xn[rn]=function(e,t){return vn(e.ancestor,t)&&t.descendants().some((function(t){return vn(e.descendant,t)}))},xn[on]=function(e,t){return vn(e.subject,t)&&vn(e.left,t)&&vn(e.right,t)},xn[ln]=function(){return!0},xn[Va]=function(e,t){return e.value.has(t)},xn[Ua]=function(e,t){return(0,e.value)(t)};var yn=function(e){this.inputText=e,this.currentSubject=null,this.compoundCount=0,this.edgeCount=0,this.length=0,null==e||j(e)&&e.match(/^\s*$/)||(w(e)?this.addQuery({checks:[{type:Va,value:e.collection()}]}):x(e)?this.addQuery({checks:[{type:Ua,value:e}]}):j(e)?this.parse(e)||(this.invalid=!0):ce("A selector must be created from a string; found "))},On=yn.prototype;[hn,{matches:function(e){for(var t=0;t<this.length;t++){var a=this[t];if(vn(a,e))return!0}return!1},filter:function(e){var t=this;if(1===t.length&&1===t[0].checks.length&&t[0].checks[0].type===$a)return e.getElementById(t[0].checks[0].value).collection();var a=function(e){for(var a=0;a<t.length;a++){var n=t[a];if(vn(n,e))return!0}return!1};return null==t.text()&&(a=function(){return!0}),e.filter(a)}}].forEach((function(e){return P(On,e)})),On.text=function(){return this.inputText},On.size=function(){return this.length},On.eq=function(e){return this[e]},On.sameText=function(e){return!this.invalid&&!e.invalid&&this.text()===e.text()},On.addQuery=function(e){this[this.length++]=e},On.selector=On.toString;var En={allAre:function(e){var t=new yn(e);return this.every((function(e){return t.matches(e)}))},is:function(e){var t=new yn(e);return this.some((function(e){return t.matches(e)}))},some:function(e,t){for(var a=0;a<this.length;a++){if(t?e.apply(t,[this[a],a,this]):e(this[a],a,this))return!0}return!1},every:function(e,t){for(var a=0;a<this.length;a++){if(!(t?e.apply(t,[this[a],a,this]):e(this[a],a,this)))return!1}return!0},same:function(e){if(this===e)return!0;e=this.cy().collection(e);var t=this.length;return t===e.length&&(1===t?this[0]===e[0]:this.every((function(t){return e.hasElementWithId(t.id())})))},anySame:function(e){return e=this.cy().collection(e),this.some((function(t){return e.hasElementWithId(t.id())}))},allAreNeighbors:function(e){e=this.cy().collection(e);var t=this.neighborhood();return e.every((function(e){return t.hasElementWithId(e.id())}))},contains:function(e){e=this.cy().collection(e);var t=this;return e.every((function(e){return t.hasElementWithId(e.id())}))}};En.allAreNeighbours=En.allAreNeighbors,En.has=En.contains,En.equal=En.equals=En.same;var wn,Mn,Sn=function(e,t){return function(a,n,i,s){var r,o=a,l=this;if(null==o?r="":w(o)&&1===o.length&&(r=o.id()),1===l.length&&r){var c=l[0]._private,d=c.traversalCache=c.traversalCache||{},u=d[t]=d[t]||[],p=Q(r),m=u[p];return m||(u[p]=e.call(l,a,n,i,s))}return e.call(l,a,n,i,s)}},_n={parent:function(e){var t=[];if(1===this.length){var a=this[0]._private.parent;if(a)return a}for(var n=0;n<this.length;n++){var i=this[n]._private.parent;i&&t.push(i)}return this.spawn(t,{unique:!0}).filter(e)},parents:function(e){for(var t=[],a=this.parent();a.nonempty();){for(var n=0;n<a.length;n++){var i=a[n];t.push(i)}a=a.parent()}return this.spawn(t,{unique:!0}).filter(e)},commonAncestors:function(e){for(var t,a=0;a<this.length;a++){var n=this[a].parents();t=(t=t||n).intersect(n)}return t.filter(e)},orphans:function(e){return this.stdFilter((function(e){return e.isOrphan()})).filter(e)},nonorphans:function(e){return this.stdFilter((function(e){return e.isChild()})).filter(e)},children:Sn((function(e){for(var t=[],a=0;a<this.length;a++)for(var n=this[a]._private.children,i=0;i<n.length;i++)t.push(n[i]);return this.spawn(t,{unique:!0}).filter(e)}),"children"),siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return e.isNode()&&0!==e._private.children.length},isChildless:function(){var e=this[0];if(e)return e.isNode()&&0===e._private.children.length},isChild:function(){var e=this[0];if(e)return e.isNode()&&null!=e._private.parent},isOrphan:function(){var e=this[0];if(e)return e.isNode()&&null==e._private.parent},descendants:function(e){var t=[];return function e(a){for(var n=0;n<a.length;n++){var i=a[n];t.push(i),i.children().nonempty()&&e(i.children())}}(this.children()),this.spawn(t,{unique:!0}).filter(e)}};function Tn(e,t,a,n){for(var i=[],s=new Ee,r=e.cy().hasCompoundNodes(),o=0;o<e.length;o++){var l=e[o];a?i.push(l):r&&n(i,s,l)}for(;i.length>0;){var c=i.shift();t(c),s.add(c.id()),r&&n(i,s,c)}return e}function Cn(e,t,a){if(a.isParent())for(var n=a._private.children,i=0;i<n.length;i++){var s=n[i];t.has(s.id())||e.push(s)}}function kn(e,t,a){if(a.isChild()){var n=a._private.parent;t.has(n.id())||e.push(n)}}function Fn(e,t,a){kn(e,t,a),Cn(e,t,a)}_n.forEachDown=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Tn(this,e,t,Cn)},_n.forEachUp=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Tn(this,e,t,kn)},_n.forEachUpAndDown=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Tn(this,e,t,Fn)},_n.ancestors=_n.parents,(wn=Mn={data:Na.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:Na.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:Na.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,updateStyle:!0}),removeScratch:Na.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0,updateStyle:!0}),rscratch:Na.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:Na.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id}}).attr=wn.data,wn.removeAttr=wn.removeData;var In,Dn,An=Mn,Ln={};function Rn(e){return function(t){var a=this;if(void 0===t&&(t=!0),0!==a.length&&a.isNode()&&!a.removed()){for(var n=0,i=a[0],s=i._private.edges,r=0;r<s.length;r++){var o=s[r];!t&&o.isLoop()||(n+=e(i,o))}return n}}}function Nn(e,t){return function(a){for(var n,i=this.nodes(),s=0;s<i.length;s++){var r=i[s][e](a);void 0===r||void 0!==n&&!t(r,n)||(n=r)}return n}}P(Ln,{degree:Rn((function(e,t){return t.source().same(t.target())?2:1})),indegree:Rn((function(e,t){return t.target().same(e)?1:0})),outdegree:Rn((function(e,t){return t.source().same(e)?1:0}))}),P(Ln,{minDegree:Nn("degree",(function(e,t){return e<t})),maxDegree:Nn("degree",(function(e,t){return e>t})),minIndegree:Nn("indegree",(function(e,t){return e<t})),maxIndegree:Nn("indegree",(function(e,t){return e>t})),minOutdegree:Nn("outdegree",(function(e,t){return e<t})),maxOutdegree:Nn("outdegree",(function(e,t){return e>t}))}),P(Ln,{totalDegree:function(e){for(var t=0,a=this.nodes(),n=0;n<a.length;n++)t+=a[n].degree(e);return t}});var Pn=function(e,t,a){for(var n=0;n<e.length;n++){var i=e[n];if(!i.locked()){var s=i._private.position,r={x:null!=t.x?t.x-s.x:0,y:null!=t.y?t.y-s.y:0};!i.isParent()||0===r.x&&0===r.y||i.children().shift(r,a),i.shiftCachedBoundingBox(r)}}},zn={field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"emitAndNotify",allowGetting:!0,validKeys:["x","y"],beforeGet:function(e){e.updateCompoundBounds()},beforeSet:function(e,t){Pn(e,t,!1)},onSet:function(e){e.dirtyCompoundBoundsCache()},canSet:function(e){return!e.locked()}};(In=Dn={position:Na.data(zn),silentPosition:Na.data(P({},zn,{allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!1,beforeSet:function(e,t){Pn(e,t,!0)}})),positions:function(e,t){if(y(e))t?this.silentPosition(e):this.position(e);else if(x(e)){var a=e,n=this.cy();n.startBatch();for(var i=0;i<this.length;i++){var s,r=this[i];(s=a(r,i))&&(t?r.silentPosition(s):r.position(s))}n.endBatch()}return this},silentPositions:function(e){return this.positions(e,!0)},shift:function(e,t,a){var n;if(y(e)?(n={x:O(e.x)?e.x:0,y:O(e.y)?e.y:0},a=t):j(e)&&O(t)&&((n={x:0,y:0})[e]=t),null!=n){var i=this.cy();i.startBatch();for(var s=0;s<this.length;s++){var r=this[s],o=r.position(),l={x:o.x+n.x,y:o.y+n.y};a?r.silentPosition(l):r.position(l)}i.endBatch()}return this},silentShift:function(e,t){return y(e)?this.shift(e,!0):j(e)&&O(t)&&this.shift(e,t,!0),this},renderedPosition:function(e,t){var a=this[0],n=this.cy(),i=n.zoom(),s=n.pan(),r=y(e)?e:void 0,o=void 0!==r||void 0!==t&&j(e);if(a&&a.isNode()){if(!o){var l=a.position();return r=Be(l,i,s),void 0===e?r:r[e]}for(var c=0;c<this.length;c++){var d=this[c];void 0!==t?d.position(e,(t-s[e])/i):void 0!==r&&d.position(Je(r,i,s))}}else if(!o)return;return this},relativePosition:function(e,t){var a=this[0],n=this.cy(),i=y(e)?e:void 0,s=void 0!==i||void 0!==t&&j(e),r=n.hasCompoundNodes();if(a&&a.isNode()){if(!s){var o=a.position(),l=r?a.parent():null,c=l&&l.length>0,d=c;c&&(l=l[0]);var u=d?l.position():{x:0,y:0};return i={x:o.x-u.x,y:o.y-u.y},void 0===e?i:i[e]}for(var p=0;p<this.length;p++){var m=this[p],b=r?m.parent():null,f=b&&b.length>0,h=f;f&&(b=b[0]);var g=h?b.position():{x:0,y:0};void 0!==t?m.position(e,t+g[e]):void 0!==i&&m.position({x:i.x+g.x,y:i.y+g.y})}}else if(!s)return;return this}}).modelPosition=In.point=In.position,In.modelPositions=In.points=In.positions,In.renderedPoint=In.renderedPosition,In.relativePoint=In.relativePosition;var Bn,Jn,Vn=Dn;Bn=Jn={},Jn.renderedBoundingBox=function(e){var t=this.boundingBox(e),a=this.cy(),n=a.zoom(),i=a.pan(),s=t.x1*n+i.x,r=t.x2*n+i.x,o=t.y1*n+i.y,l=t.y2*n+i.y;return{x1:s,x2:r,y1:o,y2:l,w:r-s,h:l-o}},Jn.dirtyCompoundBoundsCache=function(){var e=this.cy();return e.styleEnabled()&&e.hasCompoundNodes()?(this.forEachUp((function(e){if(e.isParent()){var t=e._private;t.compoundBoundsClean=!1,t.bbCache=null,e.emitAndNotify("bounds")}})),this):this},Jn.updateCompoundBounds=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return this;if(!e&&t.batching())return this;function a(e){if(e.isParent()){var t=e._private,a=e.children(),n="include"===e.pstyle("compound-sizing-wrt-labels").value,i={width:{val:e.pstyle("min-width").pfValue,left:e.pstyle("min-width-bias-left"),right:e.pstyle("min-width-bias-right")},height:{val:e.pstyle("min-height").pfValue,top:e.pstyle("min-height-bias-top"),bottom:e.pstyle("min-height-bias-bottom")}},s=a.boundingBox({includeLabels:n,includeOverlays:!1,useCache:!1}),r=t.position;0!==s.w&&0!==s.h||((s={w:e.pstyle("width").pfValue,h:e.pstyle("height").pfValue}).x1=r.x-s.w/2,s.x2=r.x+s.w/2,s.y1=r.y-s.h/2,s.y2=r.y+s.h/2);var o=i.width.left.value;"px"===i.width.left.units&&i.width.val>0&&(o=100*o/i.width.val);var l=i.width.right.value;"px"===i.width.right.units&&i.width.val>0&&(l=100*l/i.width.val);var c=i.height.top.value;"px"===i.height.top.units&&i.height.val>0&&(c=100*c/i.height.val);var d=i.height.bottom.value;"px"===i.height.bottom.units&&i.height.val>0&&(d=100*d/i.height.val);var u=g(i.width.val-s.w,o,l),p=u.biasDiff,m=u.biasComplementDiff,b=g(i.height.val-s.h,c,d),f=b.biasDiff,h=b.biasComplementDiff;t.autoPadding=function(e,t,a,n){if("%"!==a.units)return"px"===a.units?a.pfValue:0;switch(n){case"width":return e>0?a.pfValue*e:0;case"height":return t>0?a.pfValue*t:0;case"average":return e>0&&t>0?a.pfValue*(e+t)/2:0;case"min":return e>0&&t>0?e>t?a.pfValue*t:a.pfValue*e:0;case"max":return e>0&&t>0?e>t?a.pfValue*e:a.pfValue*t:0;default:return 0}}(s.w,s.h,e.pstyle("padding"),e.pstyle("padding-relative-to").value),t.autoWidth=Math.max(s.w,i.width.val),r.x=(-p+s.x1+s.x2+m)/2,t.autoHeight=Math.max(s.h,i.height.val),r.y=(-f+s.y1+s.y2+h)/2}function g(e,t,a){var n=0,i=0,s=t+a;return e>0&&s>0&&(n=t/s*e,i=a/s*e),{biasDiff:n,biasComplementDiff:i}}}for(var n=0;n<this.length;n++){var i=this[n],s=i._private;s.compoundBoundsClean||(a(i),t.batching()||(s.compoundBoundsClean=!0))}return this};var Un=function(e){return e===1/0||e===-1/0?0:e},Gn=function(e,t,a,n,i){n-t!=0&&i-a!=0&&null!=t&&null!=a&&null!=n&&null!=i&&(e.x1=t<e.x1?t:e.x1,e.x2=n>e.x2?n:e.x2,e.y1=a<e.y1?a:e.y1,e.y2=i>e.y2?i:e.y2,e.w=e.x2-e.x1,e.h=e.y2-e.y1)},qn=function(e,t){return null==t?e:Gn(e,t.x1,t.y1,t.x2,t.y2)},Wn=function(e,t,a){return xe(e,t,a)},Hn=function(e,t,a){if(!t.cy().headless()){var n,i,s=t._private,r=s.rstyle,o=r.arrowWidth/2;if("none"!==t.pstyle(a+"-arrow-shape").value){"source"===a?(n=r.srcX,i=r.srcY):"target"===a?(n=r.tgtX,i=r.tgtY):(n=r.midX,i=r.midY);var l=s.arrowBounds=s.arrowBounds||{},c=l[a]=l[a]||{};c.x1=n-o,c.y1=i-o,c.x2=n+o,c.y2=i+o,c.w=c.x2-c.x1,c.h=c.y2-c.y1,et(c,1),Gn(e,c.x1,c.y1,c.x2,c.y2)}}},Yn=function(e,t,a){if(!t.cy().headless()){var n;n=a?a+"-":"";var i=t._private,s=i.rstyle;if(t.pstyle(n+"label").strValue){var r,o,l,c,d=t.pstyle("text-halign"),u=t.pstyle("text-valign"),p=Wn(s,"labelWidth",a),m=Wn(s,"labelHeight",a),b=Wn(s,"labelX",a),f=Wn(s,"labelY",a),h=t.pstyle(n+"text-margin-x").pfValue,g=t.pstyle(n+"text-margin-y").pfValue,j=t.isEdge(),x=t.pstyle(n+"text-rotation"),v=t.pstyle("text-outline-width").pfValue,y=t.pstyle("text-border-width").pfValue/2,O=t.pstyle("text-background-padding").pfValue,E=m,w=p,M=w/2,S=E/2;if(j)r=b-M,o=b+M,l=f-S,c=f+S;else{switch(d.value){case"left":r=b-w,o=b;break;case"center":r=b-M,o=b+M;break;case"right":r=b,o=b+w}switch(u.value){case"top":l=f-E,c=f;break;case"center":l=f-S,c=f+S;break;case"bottom":l=f,c=f+E}}r+=h-Math.max(v,y)-O,o+=h+Math.max(v,y)+O,l+=g-Math.max(v,y)-O,c+=g+Math.max(v,y)+O;var _=a||"main",T=i.labelBounds,C=T[_]=T[_]||{};C.x1=r,C.y1=l,C.x2=o,C.y2=c,C.w=o-r,C.h=c-l,et(C,1);var k=j&&"autorotate"===x.strValue,F=null!=x.pfValue&&0!==x.pfValue;if(k||F){var I=k?Wn(i.rstyle,"labelAngle",a):x.pfValue,D=Math.cos(I),A=Math.sin(I),L=(r+o)/2,R=(l+c)/2;if(!j){switch(d.value){case"left":L=o;break;case"right":L=r}switch(u.value){case"top":R=c;break;case"bottom":R=l}}var N=function(e,t){return{x:(e-=L)*D-(t-=R)*A+L,y:e*A+t*D+R}},P=N(r,l),z=N(r,c),B=N(o,l),J=N(o,c);r=Math.min(P.x,z.x,B.x,J.x),o=Math.max(P.x,z.x,B.x,J.x),l=Math.min(P.y,z.y,B.y,J.y),c=Math.max(P.y,z.y,B.y,J.y)}Gn(e,r,l,o,c),Gn(i.labelBounds.all,r,l,o,c)}return e}},$n=function(e){var t=0,a=function(e){return(e?1:0)<<t++},n=0;return n+=a(e.incudeNodes),n+=a(e.includeEdges),n+=a(e.includeLabels),n+=a(e.includeMainLabels),n+=a(e.includeSourceLabels),n+=a(e.includeTargetLabels),n+=a(e.includeOverlays)},Xn=function(e){if(e.isEdge()){var t=e.source().position(),a=e.target().position(),n=function(e){return Math.round(e)};return K([n(t.x),n(t.y),n(a.x),n(a.y)])}return 0},Kn=function(e,t){var a,n=e._private,i=e.isEdge(),s=(null==t?Zn:$n(t))===Zn,r=Xn(e),o=n.bbCachePosKey===r,l=!(t.useCache&&o)||null==n.bbCache;if(l?(o||e.recalculateRenderedStyle(),a=function(e,t){var a,n,i,s,r,o,l,c=e._private.cy,d=c.styleEnabled(),u=c.headless(),p=Qe(),m=e._private,b=e.isNode(),f=e.isEdge(),h=m.rstyle,g=b&&d?e.pstyle("bounds-expansion").pfValue:[0],j=function(e){return"none"!==e.pstyle("display").value},x=!d||j(e)&&(!f||j(e.source())&&j(e.target()));if(x){var v=0;d&&t.includeOverlays&&0!==e.pstyle("overlay-opacity").value&&(v=e.pstyle("overlay-padding").value);var y=0;if(d&&(y=e.pstyle("width").pfValue/2),b&&t.includeNodes){var O=e.position();r=O.x,o=O.y;var E=e.outerWidth()/2,w=e.outerHeight()/2;Gn(p,a=r-E,i=o-w,n=r+E,s=o+w)}else if(f&&t.includeEdges)if(d&&!u&&(a=Math.min(h.srcX,h.midX,h.tgtX),n=Math.max(h.srcX,h.midX,h.tgtX),i=Math.min(h.srcY,h.midY,h.tgtY),s=Math.max(h.srcY,h.midY,h.tgtY),Gn(p,a-=y,i-=y,n+=y,s+=y)),d&&!u&&"haystack"===e.pstyle("curve-style").strValue){var M=h.haystackPts||[];if(a=M[0].x,i=M[0].y,a>(n=M[1].x)){var S=a;a=n,n=S}if(i>(s=M[1].y)){var _=i;i=s,s=_}Gn(p,a-y,i-y,n+y,s+y)}else{for(var T=h.bezierPts||h.linePts||[],C=0;C<T.length;C++){var k=T[C];a=k.x-y,n=k.x+y,i=k.y-y,s=k.y+y,Gn(p,a,i,n,s)}if(0===T.length){var F=e.source().position(),I=e.target().position();if((a=F.x)>(n=I.x)){var D=a;a=n,n=D}if((i=F.y)>(s=I.y)){var A=i;i=s,s=A}Gn(p,a-=y,i-=y,n+=y,s+=y)}}if(d&&t.includeEdges&&f&&(Hn(p,e,"mid-source"),Hn(p,e,"mid-target"),Hn(p,e,"source"),Hn(p,e,"target")),d&&"yes"===e.pstyle("ghost").value){var L=e.pstyle("ghost-offset-x").pfValue,R=e.pstyle("ghost-offset-y").pfValue;Gn(p,p.x1+L,p.y1+R,p.x2+L,p.y2+R)}var N=m.bodyBounds=m.bodyBounds||{};at(N,p),tt(N,g),et(N,1),d&&(a=p.x1,n=p.x2,i=p.y1,s=p.y2,Gn(p,a-v,i-v,n+v,s+v));var P=m.overlayBounds=m.overlayBounds||{};at(P,p),tt(P,g),et(P,1);var z=m.labelBounds=m.labelBounds||{};null!=z.all?((l=z.all).x1=1/0,l.y1=1/0,l.x2=-1/0,l.y2=-1/0,l.w=0,l.h=0):z.all=Qe(),d&&t.includeLabels&&(t.includeMainLabels&&Yn(p,e,null),f&&(t.includeSourceLabels&&Yn(p,e,"source"),t.includeTargetLabels&&Yn(p,e,"target")))}return p.x1=Un(p.x1),p.y1=Un(p.y1),p.x2=Un(p.x2),p.y2=Un(p.y2),p.w=Un(p.x2-p.x1),p.h=Un(p.y2-p.y1),p.w>0&&p.h>0&&x&&(tt(p,g),et(p,1)),p}(e,Qn),n.bbCache=a,n.bbCacheShift.x=n.bbCacheShift.y=0,n.bbCachePosKey=r):a=n.bbCache,!l&&(0!==n.bbCacheShift.x||0!==n.bbCacheShift.y)){var c=nt,d=n.bbCacheShift,u=function(e,t){null!=e&&c(e,t)};c(a,d);var p=n.bodyBounds,m=n.overlayBounds,b=n.labelBounds,f=n.arrowBounds;u(p,d),u(m,d),null!=f&&(u(f.source,d),u(f.target,d),u(f["mid-source"],d),u(f["mid-target"],d)),null!=b&&(u(b.main,d),u(b.all,d),u(b.source,d),u(b.target,d))}if(n.bbCacheShift.x=n.bbCacheShift.y=0,!s){var h=e.isNode();a=Qe(),(t.includeNodes&&h||t.includeEdges&&!h)&&(t.includeOverlays?qn(a,n.overlayBounds):qn(a,n.bodyBounds)),t.includeLabels&&(t.includeMainLabels&&(!i||t.includeSourceLabels&&t.includeTargetLabels)?qn(a,n.labelBounds.all):(t.includeMainLabels&&qn(a,n.labelBounds.main),t.includeSourceLabels&&qn(a,n.labelBounds.source),t.includeTargetLabels&&qn(a,n.labelBounds.target))),a.w=a.x2-a.x1,a.h=a.y2-a.y1}return a},Qn={includeNodes:!0,includeEdges:!0,includeLabels:!0,includeMainLabels:!0,includeSourceLabels:!0,includeTargetLabels:!0,includeOverlays:!0,useCache:!0},Zn=$n(Qn),ei=he(Qn);Jn.boundingBox=function(e){var t;if(1!==this.length||null==this[0]._private.bbCache||void 0!==e&&void 0!==e.useCache&&!0!==e.useCache){t=Qe();var a=ei(e=e||Qn),n=this;if(n.cy().styleEnabled())for(var i=0;i<n.length;i++){var s=n[i],r=s._private,o=Xn(s),l=r.bbCachePosKey===o,c=a.useCache&&l;s.recalculateRenderedStyle(c)}this.updateCompoundBounds();for(var d=0;d<n.length;d++){var u=n[d];qn(t,Kn(u,a))}}else e=void 0===e?Qn:ei(e),t=Kn(this[0],e);return t.x1=Un(t.x1),t.y1=Un(t.y1),t.x2=Un(t.x2),t.y2=Un(t.y2),t.w=Un(t.x2-t.x1),t.h=Un(t.y2-t.y1),t},Jn.dirtyBoundingBoxCache=function(){for(var e=0;e<this.length;e++){var t=this[e]._private;t.bbCache=null,t.bbCacheShift.x=t.bbCacheShift.y=0,t.bbCachePosKey=null,t.bodyBounds=null,t.overlayBounds=null,t.labelBounds.all=null,t.labelBounds.source=null,t.labelBounds.target=null,t.labelBounds.main=null,t.arrowBounds.source=null,t.arrowBounds.target=null,t.arrowBounds["mid-source"]=null,t.arrowBounds["mid-target"]=null}return this.emitAndNotify("bounds"),this},Jn.shiftCachedBoundingBox=function(e){for(var t=0;t<this.length;t++){var a=this[t]._private;null!=a.bbCache&&(a.bbCacheShift.x+=e.x,a.bbCacheShift.y+=e.y)}return this.emitAndNotify("bounds"),this},Jn.boundingBoxAt=function(e){var t=this.nodes(),a=this.cy(),n=a.hasCompoundNodes();if(n&&(t=t.filter((function(e){return!e.isParent()}))),y(e)){var i=e;e=function(){return i}}a.startBatch(),t.forEach((function(t,a){return t._private.bbAtOldPos=e(t,a)})).silentPositions(e),n&&this.updateCompoundBounds(!0);var s=function(e){return{x1:e.x1,x2:e.x2,w:e.w,y1:e.y1,y2:e.y2,h:e.h}}(this.boundingBox({useCache:!1}));return t.silentPositions((function(e){return e._private.bbAtOldPos})),a.endBatch(),s},Bn.boundingbox=Bn.bb=Bn.boundingBox,Bn.renderedBoundingbox=Bn.renderedBoundingBox;var ti,ai,ni=Jn;ti=ai={};var ii=function(e){e.uppercaseName=L(e.name),e.autoName="auto"+e.uppercaseName,e.labelName="label"+e.uppercaseName,e.outerName="outer"+e.uppercaseName,e.uppercaseOuterName=L(e.outerName),ti[e.name]=function(){var t=this[0],a=t._private,n=a.cy._private.styleEnabled;if(t){if(!n)return 1;if(t.isParent())return t.updateCompoundBounds(),a[e.autoName]||0;var i=t.pstyle(e.name);switch(i.strValue){case"label":return t.recalculateRenderedStyle(),a.rstyle[e.labelName]||0;default:return i.pfValue}}},ti["outer"+e.uppercaseName]=function(){var t=this[0],a=t._private.cy._private.styleEnabled;if(t)return a?t[e.name]()+t.pstyle("border-width").pfValue+2*t.padding():1},ti["rendered"+e.uppercaseName]=function(){var t=this[0];if(t)return t[e.name]()*this.cy().zoom()},ti["rendered"+e.uppercaseOuterName]=function(){var t=this[0];if(t)return t[e.outerName]()*this.cy().zoom()}};ii({name:"width"}),ii({name:"height"}),ai.padding=function(){var e=this[0],t=e._private;return e.isParent()?(e.updateCompoundBounds(),void 0!==t.autoPadding?t.autoPadding:e.pstyle("padding").pfValue):e.pstyle("padding").pfValue},ai.paddedHeight=function(){var e=this[0];return e.height()+2*e.padding()},ai.paddedWidth=function(){var e=this[0];return e.width()+2*e.padding()};var si=ai,ri={controlPoints:{get:function(e){return e.renderer().getControlPoints(e)},mult:!0},segmentPoints:{get:function(e){return e.renderer().getSegmentPoints(e)},mult:!0},sourceEndpoint:{get:function(e){return e.renderer().getSourceEndpoint(e)}},targetEndpoint:{get:function(e){return e.renderer().getTargetEndpoint(e)}},midpoint:{get:function(e){return e.renderer().getEdgeMidpoint(e)}}},oi=Object.keys(ri).reduce((function(e,t){var a=ri[t],n=function(e){return"rendered"+e[0].toUpperCase()+e.substr(1)}(t);return e[t]=function(){return function(e,t){if(e.isEdge())return t(e)}(this,a.get)},a.mult?e[n]=function(){return function(e,t){if(e.isEdge()){var a=e.cy(),n=a.pan(),i=a.zoom();return t(e).map((function(e){return Be(e,i,n)}))}}(this,a.get)}:e[n]=function(){return function(e,t){if(e.isEdge()){var a=e.cy();return Be(t(e),a.zoom(),a.pan())}}(this,a.get)},e}),{}),li=P({},Vn,ni,si,oi),ci=function(e,t){this.recycle(e,t)};function di(){return!1}function ui(){return!0}ci.prototype={instanceString:function(){return"event"},recycle:function(e,t){if(this.isImmediatePropagationStopped=this.isPropagationStopped=this.isDefaultPrevented=di,null!=e&&e.preventDefault?(this.type=e.type,this.isDefaultPrevented=e.defaultPrevented?ui:di):null!=e&&e.type?t=e:this.type=e,null!=t&&(this.originalEvent=t.originalEvent,this.type=null!=t.type?t.type:this.type,this.cy=t.cy,this.target=t.target,this.position=t.position,this.renderedPosition=t.renderedPosition,this.namespace=t.namespace,this.layout=t.layout),null!=this.cy&&null!=this.position&&null==this.renderedPosition){var a=this.position,n=this.cy.zoom(),i=this.cy.pan();this.renderedPosition={x:a.x*n+i.x,y:a.y*n+i.y}}this.timeStamp=e&&e.timeStamp||Date.now()},preventDefault:function(){this.isDefaultPrevented=ui;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=ui;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=ui,this.stopPropagation()},isDefaultPrevented:di,isPropagationStopped:di,isImmediatePropagationStopped:di};var pi=/^([^.]+)(\.(?:[^.]+))?$/,mi={qualifierCompare:function(e,t){return e===t},eventMatches:function(){return!0},addEventFields:function(){},callbackContext:function(e){return e},beforeEmit:function(){},afterEmit:function(){},bubble:function(){return!1},parent:function(){return null},context:null},bi=Object.keys(mi),fi={};function hi(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fi,t=arguments.length>1?arguments[1]:void 0,a=0;a<bi.length;a++){var n=bi[a];this[n]=e[n]||mi[n]}this.context=t||this.context,this.listeners=[],this.emitting=0}var gi=hi.prototype,ji=function(e,t,a,n,i,s,r){x(n)&&(i=n,n=null),r&&(s=null==s?r:P({},s,r));for(var o=v(a)?a:a.split(/\s+/),l=0;l<o.length;l++){var c=o[l];if(!C(c)){var d=c.match(pi);if(d)if(!1===t(e,c,d[1],d[2]?d[2]:null,n,i,s))break}}},xi=function(e,t){return e.addEventFields(e.context,t),new ci(t.type,t)},vi=function(e,t,a){if("event"!==g(a))if(y(a))t(e,xi(e,a));else for(var n=v(a)?a:a.split(/\s+/),i=0;i<n.length;i++){var s=n[i];if(!C(s)){var r=s.match(pi);if(r){var o=r[1],l=r[2]?r[2]:null;t(e,xi(e,{type:o,namespace:l,target:e.context}))}}}else t(e,a)};gi.on=gi.addListener=function(e,t,a,n,i){return ji(this,(function(e,t,a,n,i,s,r){x(s)&&e.listeners.push({event:t,callback:s,type:a,namespace:n,qualifier:i,conf:r})}),e,t,a,n,i),this},gi.one=function(e,t,a,n){return this.on(e,t,a,n,{one:!0})},gi.removeListener=gi.off=function(e,t,a,n){var i=this;0!==this.emitting&&(this.listeners=this.listeners.slice());for(var s=this.listeners,r=function(r){var o=s[r];ji(i,(function(t,a,n,i,l,c){if((o.type===n||"*"===e)&&(!i&&".*"!==o.namespace||o.namespace===i)&&(!l||t.qualifierCompare(o.qualifier,l))&&(!c||o.callback===c))return s.splice(r,1),!1}),e,t,a,n)},o=s.length-1;o>=0;o--)r(o);return this},gi.removeAllListeners=function(){return this.removeListener("*")},gi.emit=gi.trigger=function(e,t,a){var n=this.listeners,i=n.length;return this.emitting++,v(t)||(t=[t]),vi(this,(function(e,s){null!=a&&(n=[{event:s.event,type:s.type,namespace:s.namespace,callback:a}],i=n.length);for(var r=function(a){var i=n[a];if(i.type===s.type&&(!i.namespace||i.namespace===s.namespace||".*"===i.namespace)&&e.eventMatches(e.context,i,s)){var r=[s];null!=t&&function(e,t){for(var a=0;a<t.length;a++){var n=t[a];e.push(n)}}(r,t),e.beforeEmit(e.context,i,s),i.conf&&i.conf.one&&(e.listeners=e.listeners.filter((function(e){return e!==i})));var o=e.callbackContext(e.context,i,s),l=i.callback.apply(o,r);e.afterEmit(e.context,i,s),!1===l&&(s.stopPropagation(),s.preventDefault())}},o=0;o<i;o++)r(o);e.bubble(e.context)&&!s.isPropagationStopped()&&e.parent(e.context).emit(s,t)}),e),this.emitting--,this};var yi={qualifierCompare:function(e,t){return null==e||null==t?null==e&&null==t:e.sameText(t)},eventMatches:function(e,t,a){var n=t.qualifier;return null==n||e!==a.target&&M(a.target)&&n.matches(a.target)},addEventFields:function(e,t){t.cy=e.cy(),t.target=e},callbackContext:function(e,t,a){return null!=t.qualifier?a.target:e},beforeEmit:function(e,t){t.conf&&t.conf.once&&t.conf.onceCollection.removeListener(t.event,t.qualifier,t.callback)},bubble:function(){return!0},parent:function(e){return e.isChild()?e.parent():e.cy()}},Oi=function(e){return j(e)?new yn(e):e},Ei={createEmitter:function(){for(var e=0;e<this.length;e++){var t=this[e],a=t._private;a.emitter||(a.emitter=new hi(yi,t))}return this},emitter:function(){return this._private.emitter},on:function(e,t,a){for(var n=Oi(t),i=0;i<this.length;i++){this[i].emitter().on(e,n,a)}return this},removeListener:function(e,t,a){for(var n=Oi(t),i=0;i<this.length;i++){this[i].emitter().removeListener(e,n,a)}return this},removeAllListeners:function(){for(var e=0;e<this.length;e++){this[e].emitter().removeAllListeners()}return this},one:function(e,t,a){for(var n=Oi(t),i=0;i<this.length;i++){this[i].emitter().one(e,n,a)}return this},once:function(e,t,a){for(var n=Oi(t),i=0;i<this.length;i++){this[i].emitter().on(e,n,a,{once:!0,onceCollection:this})}},emit:function(e,t){for(var a=0;a<this.length;a++){this[a].emitter().emit(e,t)}return this},emitAndNotify:function(e,t){if(0!==this.length)return this.cy().notify(e,this),this.emit(e,t),this}};Na.eventAliasesOn(Ei);var wi={nodes:function(e){return this.filter((function(e){return e.isNode()})).filter(e)},edges:function(e){return this.filter((function(e){return e.isEdge()})).filter(e)},byGroup:function(){for(var e=this.spawn(),t=this.spawn(),a=0;a<this.length;a++){var n=this[a];n.isNode()?e.merge(n):t.merge(n)}return{nodes:e,edges:t}},filter:function(e,t){if(void 0===e)return this;if(j(e)||w(e))return new yn(e).filter(this);if(x(e)){for(var a=this.spawn(),n=this,i=0;i<n.length;i++){var s=n[i];(t?e.apply(t,[s,i,n]):e(s,i,n))&&a.merge(s)}return a}return this.spawn()},not:function(e){if(e){j(e)&&(e=this.filter(e));for(var t=[],a=e._private.map,n=0;n<this.length;n++){var i=this[n];a.has(i.id())||t.push(i)}return this.spawn(t)}return this},absoluteComplement:function(){return this.cy().mutableElements().not(this)},intersect:function(e){if(j(e)){var t=e;return this.filter(t)}for(var a=[],n=e,i=this.length<e.length,s=i?n._private.map:this._private.map,r=i?this:n,o=0;o<r.length;o++){var l=r[o]._private.data.id,c=s.get(l);c&&a.push(c.ele)}return this.spawn(a)},xor:function(e){var t=this._private.cy;j(e)&&(e=t.$(e));var a=[],n=e,i=function(e,t){for(var n=0;n<e.length;n++){var i=e[n],s=i._private.data.id;t.hasElementWithId(s)||a.push(i)}};return i(this,n),i(n,this),this.spawn(a)},diff:function(e){var t=this._private.cy;j(e)&&(e=t.$(e));var a=[],n=[],i=[],s=e,r=function(e,t,a){for(var n=0;n<e.length;n++){var s=e[n],r=s._private.data.id;t.hasElementWithId(r)?i.push(s):a.push(s)}};return r(this,s,a),r(s,this,n),{left:this.spawn(a,{unique:!0}),right:this.spawn(n,{unique:!0}),both:this.spawn(i,{unique:!0})}},add:function(e){var t=this._private.cy;if(!e)return this;if(j(e)){var a=e;e=t.mutableElements().filter(a)}for(var n=[],i=0;i<this.length;i++)n.push(this[i]);for(var s=this._private.map,r=0;r<e.length;r++){var o=!s.has(e[r].id());o&&n.push(e[r])}return this.spawn(n)},merge:function(e){var t=this._private,a=t.cy;if(!e)return this;if(e&&j(e)){var n=e;e=a.mutableElements().filter(n)}for(var i=t.map,s=0;s<e.length;s++){var r=e[s],o=r._private.data.id;if(!i.has(o)){var l=this.length++;this[l]=r,i.set(o,{ele:r,index:l})}else{var c=i.get(o).index;this[c]=r,i.set(o,{ele:r,index:c})}}return this},unmergeAt:function(e){var t=this[e].id(),a=this._private.map;this[e]=void 0,a.delete(t);var n=e===this.length-1;if(this.length>1&&!n){var i=this.length-1,s=this[i],r=s._private.data.id;this[i]=void 0,this[e]=s,a.set(r,{ele:s,index:e})}return this.length--,this},unmergeOne:function(e){e=e[0];var t=this._private,a=e._private.data.id,n=t.map.get(a);if(!n)return this;var i=n.index;return this.unmergeAt(i),this},unmerge:function(e){var t=this._private.cy;if(!e)return this;if(e&&j(e)){var a=e;e=t.mutableElements().filter(a)}for(var n=0;n<e.length;n++)this.unmergeOne(e[n]);return this},unmergeBy:function(e){for(var t=this.length-1;t>=0;t--){e(this[t])&&this.unmergeAt(t)}return this},map:function(e,t){for(var a=[],n=this,i=0;i<n.length;i++){var s=n[i],r=t?e.apply(t,[s,i,n]):e(s,i,n);a.push(r)}return a},reduce:function(e,t){for(var a=t,n=this,i=0;i<n.length;i++)a=e(a,n[i],i,n);return a},max:function(e,t){for(var a,n=-1/0,i=this,s=0;s<i.length;s++){var r=i[s],o=t?e.apply(t,[r,s,i]):e(r,s,i);o>n&&(n=o,a=r)}return{value:n,ele:a}},min:function(e,t){for(var a,n=1/0,i=this,s=0;s<i.length;s++){var r=i[s],o=t?e.apply(t,[r,s,i]):e(r,s,i);o<n&&(n=o,a=r)}return{value:n,ele:a}}},Mi=wi;Mi.u=Mi["|"]=Mi["+"]=Mi.union=Mi.or=Mi.add,Mi["\\"]=Mi["!"]=Mi["-"]=Mi.difference=Mi.relativeComplement=Mi.subtract=Mi.not,Mi.n=Mi["&"]=Mi["."]=Mi.and=Mi.intersection=Mi.intersect,Mi["^"]=Mi["(+)"]=Mi["(-)"]=Mi.symmetricDifference=Mi.symdiff=Mi.xor,Mi.fnFilter=Mi.filterFn=Mi.stdFilter=Mi.filter,Mi.complement=Mi.abscomp=Mi.absoluteComplement;var Si=function(e,t){var a=e.cy().hasCompoundNodes();function n(e){var t=e.pstyle("z-compound-depth");return"auto"===t.value?a?e.zDepth():0:"bottom"===t.value?-1:"top"===t.value?ie:0}var i=n(e)-n(t);if(0!==i)return i;function s(e){return"auto"===e.pstyle("z-index-compare").value&&e.isNode()?1:0}var r=s(e)-s(t);if(0!==r)return r;var o=e.pstyle("z-index").value-t.pstyle("z-index").value;return 0!==o?o:e.poolIndex()-t.poolIndex()},_i={forEach:function(e,t){if(x(e))for(var a=this.length,n=0;n<a;n++){var i=this[n];if(!1===(t?e.apply(t,[i,n,this]):e(i,n,this)))break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(e,t){var a=[],n=this.length;null==t&&(t=n),null==e&&(e=0),e<0&&(e=n+e),t<0&&(t=n+t);for(var i=e;i>=0&&i<t&&i<n;i++)a.push(this[i]);return this.spawn(a)},size:function(){return this.length},eq:function(e){return this[e]||this.spawn()},first:function(){return this[0]||this.spawn()},last:function(){return this[this.length-1]||this.spawn()},empty:function(){return 0===this.length},nonempty:function(){return!this.empty()},sort:function(e){if(!x(e))return this;var t=this.toArray().sort(e);return this.spawn(t)},sortByZIndex:function(){return this.sort(Si)},zDepth:function(){var e=this[0];if(e){var t=e._private;if("nodes"===t.group){var a=t.data.parent?e.parents().size():0;return e.isParent()?a:ie-1}var n=t.source,i=t.target,s=n.zDepth(),r=i.zDepth();return Math.max(s,r,0)}}};_i.each=_i.forEach;var Ti=he({nodeDimensionsIncludeLabels:!1}),Ci={layoutDimensions:function(e){var t;if(e=Ti(e),this.takesUpSpace())if(e.nodeDimensionsIncludeLabels){var a=this.boundingBox();t={w:a.w,h:a.h}}else t={w:this.outerWidth(),h:this.outerHeight()};else t={w:0,h:0};return 0!==t.w&&0!==t.h||(t.w=t.h=1),t},layoutPositions:function(e,t,a){var n=this.nodes(),i=this.cy(),s=t.eles,r=function(e){return e.id()},o=F(a,r);e.emit({type:"layoutstart",layout:e}),e.animations=[];var l=t.spacingFactor&&1!==t.spacingFactor,c=function(){if(!l)return null;for(var e=Qe(),t=0;t<n.length;t++){var a=n[t],i=o(a,t);Ze(e,i.x,i.y)}return e}(),d=F((function(e,a){var n=o(e,a);l&&(n=function(e,t,a){var n=t.x1+t.w/2,i=t.y1+t.h/2;return{x:n+(a.x-n)*e,y:i+(a.y-i)*e}}(Math.abs(t.spacingFactor),c,n));return null!=t.transform&&(n=t.transform(e,n)),n}),r);if(t.animate){for(var u=0;u<n.length;u++){var p=n[u],m=d(p,u);if(null==t.animateFilter||t.animateFilter(p,u)){var b=p.animation({position:m,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(b)}else p.position(m)}if(t.fit){var f=i.animation({fit:{boundingBox:s.boundingBoxAt(d),padding:t.padding},duration:t.animationDuration,easing:t.animationEasing});e.animations.push(f)}else if(void 0!==t.zoom&&void 0!==t.pan){var h=i.animation({zoom:t.zoom,pan:t.pan,duration:t.animationDuration,easing:t.animationEasing});e.animations.push(h)}e.animations.forEach((function(e){return e.play()})),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),Aa.all(e.animations.map((function(e){return e.promise()}))).then((function(){e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e})}))}else n.positions(d),t.fit&&i.fit(t.eles,t.padding),null!=t.zoom&&i.zoom(t.zoom),t.pan&&i.pan(t.pan),e.one("layoutready",t.ready),e.emit({type:"layoutready",layout:e}),e.one("layoutstop",t.stop),e.emit({type:"layoutstop",layout:e});return this},layout:function(e){return this.cy().makeLayout(P({},e,{eles:this}))}};function ki(e,t,a){var n,i=a._private,s=i.styleCache=i.styleCache||[];return null!=(n=s[e])?n:n=s[e]=t(a)}function Fi(e,t){return e=Q(e),function(a){return ki(e,t,a)}}function Ii(e,t){e=Q(e);var a=function(e){return t.call(e)};return function(){var t=this[0];if(t)return ki(e,a,t)}}Ci.createLayout=Ci.makeLayout=Ci.layout;var Di={recalculateRenderedStyle:function(e){var t=this.cy(),a=t.renderer(),n=t.styleEnabled();return a&&n&&a.recalculateRenderedStyle(this,e),this},dirtyStyleCache:function(){var e,t=this.cy(),a=function(e){return e._private.styleCache=null};t.hasCompoundNodes()?((e=this.spawnSelf().merge(this.descendants()).merge(this.parents())).merge(e.connectedEdges()),e.forEach(a)):this.forEach((function(e){a(e),e.connectedEdges().forEach(a)}));return this},updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t.batching())return t._private.batchStyleEles.merge(this),this;var a=t.hasCompoundNodes(),n=t.style(),i=this;e=!(!e&&void 0!==e),a&&(i=this.spawnSelf().merge(this.descendants()).merge(this.parents()));var s=n.apply(i);return e?s.emitAndNotify("style"):s.emit("style"),this},parsedStyle:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this[0],n=a.cy();if(n.styleEnabled()&&a){var i=a._private.style[e];return null!=i?i:t?n.style().getDefaultProperty(e):null}},numericStyle:function(e){var t=this[0];if(t.cy().styleEnabled()&&t){var a=t.pstyle(e);return void 0!==a.pfValue?a.pfValue:a.value}},numericStyleUnits:function(e){var t=this[0];if(t.cy().styleEnabled())return t?t.pstyle(e).units:void 0},renderedStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var a=this[0];return a?t.style().getRenderedStyle(a,e):void 0},style:function(e,t){var a=this.cy();if(!a.styleEnabled())return this;var n=a.style();if(y(e)){var i=e;n.applyBypass(this,i,false),this.emitAndNotify("style")}else if(j(e)){if(void 0===t){var s=this[0];return s?n.getStylePropertyValue(s,e):void 0}n.applyBypass(this,e,t,false),this.emitAndNotify("style")}else if(void 0===e){var r=this[0];return r?n.getRawStyle(r):void 0}return this},removeStyle:function(e){var t=this.cy();if(!t.styleEnabled())return this;var a=t.style(),n=this;if(void 0===e)for(var i=0;i<n.length;i++){var s=n[i];a.removeAllBypasses(s,false)}else{e=e.split(/\s+/);for(var r=0;r<n.length;r++){var o=n[r];a.removeBypasses(o,e,false)}}return this.emitAndNotify("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),a=this[0];if(a){var n=a._private,i=a.pstyle("opacity").value;if(!t)return i;var s=n.data.parent?a.parents():null;if(s)for(var r=0;r<s.length;r++){i*=s[r].pstyle("opacity").value}return i}},transparent:function(){if(!this.cy().styleEnabled())return!1;var e=this[0],t=e.cy().hasCompoundNodes();return e?t?0===e.effectiveOpacity():0===e.pstyle("opacity").value:void 0},backgrounding:function(){return!!this.cy().styleEnabled()&&!!this[0]._private.backgrounding}};function Ai(e,t){var a=e._private.data.parent?e.parents():null;if(a)for(var n=0;n<a.length;n++){if(!t(a[n]))return!1}return!0}function Li(e){var t=e.ok,a=e.edgeOkViaNode||e.ok,n=e.parentOk||e.ok;return function(){var e=this.cy();if(!e.styleEnabled())return!0;var i=this[0],s=e.hasCompoundNodes();if(i){var r=i._private;if(!t(i))return!1;if(i.isNode())return!s||Ai(i,n);var o=r.source,l=r.target;return a(o)&&(!s||Ai(o,a))&&(o===l||a(l)&&(!s||Ai(l,a)))}}}var Ri=Fi("eleTakesUpSpace",(function(e){return"element"===e.pstyle("display").value&&0!==e.width()&&(!e.isNode()||0!==e.height())}));Di.takesUpSpace=Ii("takesUpSpace",Li({ok:Ri}));var Ni=Fi("eleInteractive",(function(e){return"yes"===e.pstyle("events").value&&"visible"===e.pstyle("visibility").value&&Ri(e)})),Pi=Fi("parentInteractive",(function(e){return"visible"===e.pstyle("visibility").value&&Ri(e)}));Di.interactive=Ii("interactive",Li({ok:Ni,parentOk:Pi,edgeOkViaNode:Ri})),Di.noninteractive=function(){var e=this[0];if(e)return!e.interactive()};var zi=Fi("eleVisible",(function(e){return"visible"===e.pstyle("visibility").value&&0!==e.pstyle("opacity").pfValue&&Ri(e)})),Bi=Ri;Di.visible=Ii("visible",Li({ok:zi,edgeOkViaNode:Bi})),Di.hidden=function(){var e=this[0];if(e)return!e.visible()},Di.isBundledBezier=Ii("isBundledBezier",(function(){return!!this.cy().styleEnabled()&&(!this.removed()&&"bezier"===this.pstyle("curve-style").value&&this.takesUpSpace())})),Di.bypass=Di.css=Di.style,Di.renderedCss=Di.renderedStyle,Di.removeBypass=Di.removeCss=Di.removeStyle,Di.pstyle=Di.parsedStyle;var Ji={};function Vi(e){return function(){var t=arguments,a=[];if(2===t.length){var n=t[0],i=t[1];this.on(e.event,n,i)}else if(1===t.length&&x(t[0])){var s=t[0];this.on(e.event,s)}else if(0===t.length||1===t.length&&v(t[0])){for(var r=1===t.length?t[0]:null,o=0;o<this.length;o++){var l=this[o],c=!e.ableField||l._private[e.ableField],d=l._private[e.field]!=e.value;if(e.overrideAble){var u=e.overrideAble(l);if(void 0!==u&&(c=u,!u))return this}c&&(l._private[e.field]=e.value,d&&a.push(l))}var p=this.spawn(a);p.updateStyle(),p.emit(e.event),r&&p.emit(r)}return this}}function Ui(e){Ji[e.field]=function(){var t=this[0];if(t){if(e.overrideField){var a=e.overrideField(t);if(void 0!==a)return a}return t._private[e.field]}},Ji[e.on]=Vi({event:e.on,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!0}),Ji[e.off]=Vi({event:e.off,field:e.field,ableField:e.ableField,overrideAble:e.overrideAble,value:!1})}Ui({field:"locked",overrideField:function(e){return!!e.cy().autolock()||void 0},on:"lock",off:"unlock"}),Ui({field:"grabbable",overrideField:function(e){return!e.cy().autoungrabify()&&!e.pannable()&&void 0},on:"grabify",off:"ungrabify"}),Ui({field:"selected",ableField:"selectable",overrideAble:function(e){return!e.cy().autounselectify()&&void 0},on:"select",off:"unselect"}),Ui({field:"selectable",overrideField:function(e){return!e.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"}),Ji.deselect=Ji.unselect,Ji.grabbed=function(){var e=this[0];if(e)return e._private.grabbed},Ui({field:"active",on:"activate",off:"unactivate"}),Ui({field:"pannable",on:"panify",off:"unpanify"}),Ji.inactive=function(){var e=this[0];if(e)return!e._private.active};var Gi={},qi=function(e){return function(t){for(var a=[],n=0;n<this.length;n++){var i=this[n];if(i.isNode()){for(var s=!1,r=i.connectedEdges(),o=0;o<r.length;o++){var l=r[o],c=l.source(),d=l.target();if(e.noIncomingEdges&&d===i&&c!==i||e.noOutgoingEdges&&c===i&&d!==i){s=!0;break}}s||a.push(i)}}return this.spawn(a,{unique:!0}).filter(t)}},Wi=function(e){return function(t){for(var a=[],n=0;n<this.length;n++){var i=this[n];if(i.isNode())for(var s=i.connectedEdges(),r=0;r<s.length;r++){var o=s[r],l=o.source(),c=o.target();e.outgoing&&l===i?(a.push(o),a.push(c)):e.incoming&&c===i&&(a.push(o),a.push(l))}}return this.spawn(a,{unique:!0}).filter(t)}},Hi=function(e){return function(t){for(var a=this,n=[],i={};;){var s=e.outgoing?a.outgoers():a.incomers();if(0===s.length)break;for(var r=!1,o=0;o<s.length;o++){var l=s[o],c=l.id();i[c]||(i[c]=!0,n.push(l),r=!0)}if(!r)break;a=s}return this.spawn(n,{unique:!0}).filter(t)}};function Yi(e){return function(t){for(var a=[],n=0;n<this.length;n++){var i=this[n]._private[e.attr];i&&a.push(i)}return this.spawn(a,{unique:!0}).filter(t)}}function $i(e){return function(t){var a=[],n=this._private.cy,i=e||{};j(t)&&(t=n.$(t));for(var s=0;s<t.length;s++)for(var r=t[s]._private.edges,o=0;o<r.length;o++){var l=r[o],c=l._private.data,d=this.hasElementWithId(c.source)&&t.hasElementWithId(c.target),u=t.hasElementWithId(c.source)&&this.hasElementWithId(c.target);if(d||u){if(i.thisIsSrc||i.thisIsTgt){if(i.thisIsSrc&&!d)continue;if(i.thisIsTgt&&!u)continue}a.push(l)}}return this.spawn(a,{unique:!0})}}function Xi(e){return e=P({},{codirected:!1},e),function(t){for(var a=[],n=this.edges(),i=e,s=0;s<n.length;s++)for(var r=n[s]._private,o=r.source,l=o._private.data.id,c=r.data.target,d=o._private.edges,u=0;u<d.length;u++){var p=d[u],m=p._private.data,b=m.target,f=m.source,h=b===c&&f===l,g=l===b&&c===f;(i.codirected&&h||!i.codirected&&(h||g))&&a.push(p)}return this.spawn(a,{unique:!0}).filter(t)}}Gi.clearTraversalCache=function(){for(var e=0;e<this.length;e++)this[e]._private.traversalCache=null},P(Gi,{roots:qi({noIncomingEdges:!0}),leaves:qi({noOutgoingEdges:!0}),outgoers:Sn(Wi({outgoing:!0}),"outgoers"),successors:Hi({outgoing:!0}),incomers:Sn(Wi({incoming:!0}),"incomers"),predecessors:Hi({incoming:!0})}),P(Gi,{neighborhood:Sn((function(e){for(var t=[],a=this.nodes(),n=0;n<a.length;n++)for(var i=a[n],s=i.connectedEdges(),r=0;r<s.length;r++){var o=s[r],l=o.source(),c=o.target(),d=i===l?c:l;d.length>0&&t.push(d[0]),t.push(o[0])}return this.spawn(t,{unique:!0}).filter(e)}),"neighborhood"),closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}}),Gi.neighbourhood=Gi.neighborhood,Gi.closedNeighbourhood=Gi.closedNeighborhood,Gi.openNeighbourhood=Gi.openNeighborhood,P(Gi,{source:Sn((function(e){var t,a=this[0];return a&&(t=a._private.source||a.cy().collection()),t&&e?t.filter(e):t}),"source"),target:Sn((function(e){var t,a=this[0];return a&&(t=a._private.target||a.cy().collection()),t&&e?t.filter(e):t}),"target"),sources:Yi({attr:"source"}),targets:Yi({attr:"target"})}),P(Gi,{edgesWith:Sn($i(),"edgesWith"),edgesTo:Sn($i({thisIsSrc:!0}),"edgesTo")}),P(Gi,{connectedEdges:Sn((function(e){for(var t=[],a=0;a<this.length;a++){var n=this[a];if(n.isNode())for(var i=n._private.edges,s=0;s<i.length;s++){var r=i[s];t.push(r)}}return this.spawn(t,{unique:!0}).filter(e)}),"connectedEdges"),connectedNodes:Sn((function(e){for(var t=[],a=0;a<this.length;a++){var n=this[a];n.isEdge()&&(t.push(n.source()[0]),t.push(n.target()[0]))}return this.spawn(t,{unique:!0}).filter(e)}),"connectedNodes"),parallelEdges:Sn(Xi(),"parallelEdges"),codirectedEdges:Sn(Xi({codirected:!0}),"codirectedEdges")}),P(Gi,{components:function(e){var t=this,a=t.cy(),n=a.collection(),i=null==e?t.nodes():e.nodes(),s=[];null!=e&&i.empty()&&(i=e.sources());var r=function(e,t){n.merge(e),i.unmerge(e),t.merge(e)};if(i.empty())return t.spawn();var o=function(){var e=a.collection();s.push(e);var n=i[0];r(n,e),t.bfs({directed:!1,roots:n,visit:function(t){return r(t,e)}}),e.forEach((function(t){t.connectedEdges().forEach((function(t){e.has(t.source())&&e.has(t.target())&&e.merge(t)}))}))};do{o()}while(i.length>0);return s},component:function(){var e=this[0];return e.cy().mutableElements().components(e)[0]}}),Gi.componentsOf=Gi.components;var Ki=function(e,t,a){for(var n=null!=a?a:me();e.hasElementWithId(n);)n=me();return n},Qi=function(e,t,a){if(void 0!==e&&_(e)){var n=new ye,i=!1;if(t){if(t.length>0&&y(t[0])&&!M(t[0])){i=!0;for(var s=[],r=new Ee,o=0,l=t.length;o<l;o++){var c=t[o];null==c.data&&(c.data={});var d=c.data;if(null==d.id)d.id=Ki(e,c);else if(e.hasElementWithId(d.id)||r.has(d.id))continue;var u=new we(e,c,!1);s.push(u),r.add(d.id)}t=s}}else t=[];this.length=0;for(var p=0,m=t.length;p<m;p++){var b=t[p][0];if(null!=b){var f=b._private.data.id;(null==a||a.unique&&!n.has(f))&&(n.set(f,{index:this.length,ele:b}),this[this.length]=b,this.length++)}}this._private={cy:e,map:n},i&&this.restore()}else ce("A collection must have a reference to the core")},Zi=we.prototype=Qi.prototype;Zi.instanceString=function(){return"collection"},Zi.spawn=function(e,t,a){return _(e)||(a=t,t=e,e=this.cy()),new Qi(e,t,a)},Zi.spawnSelf=function(){return this.spawn(this)},Zi.cy=function(){return this._private.cy},Zi.renderer=function(){return this._private.cy.renderer()},Zi.element=function(){return this[0]},Zi.collection=function(){return S(this)?this:new Qi(this._private.cy,[this])},Zi.unique=function(){return new Qi(this._private.cy,this,{unique:!0})},Zi.hasElementWithId=function(e){return e=""+e,this._private.map.has(e)},Zi.getElementById=function(e){e=""+e;var t=this._private.cy,a=this._private.map.get(e);return a?a.ele:new Qi(t)},Zi.$id=Zi.getElementById,Zi.poolIndex=function(){var e=this._private.cy._private.elements,t=this[0]._private.data.id;return e._private.map.get(t).index},Zi.indexOf=function(e){var t=e[0]._private.data.id;return this._private.map.get(t).index},Zi.indexOfId=function(e){return e=""+e,this._private.map.get(e).index},Zi.json=function(e){var t=this.element(),a=this.cy();if(null==t&&e)return this;if(null!=t){var n=t._private;if(y(e)){if(a.startBatch(),e.data){t.data(e.data);var i=n.data;if(t.isEdge()){var s=!1,r={},o=e.data.source,l=e.data.target;null!=o&&o!=i.source&&(r.source=""+o,s=!0),null!=l&&l!=i.target&&(r.target=""+l,s=!0),s&&(t=t.move(r))}else{var c=e.data.parent;null==c&&null==i.parent||c==i.parent||(void 0===c&&(c=null),null!=c&&(c=""+c),t=t.move({parent:c}))}}e.position&&t.position(e.position);var d=function(a,i,s){var r=e[a];null!=r&&r!==n[a]&&(r?t[i]():t[s]())};return d("removed","remove","restore"),d("selected","select","unselect"),d("selectable","selectify","unselectify"),d("locked","lock","unlock"),d("grabbable","grabify","ungrabify"),d("pannable","panify","unpanify"),null!=e.classes&&t.classes(e.classes),a.endBatch(),this}if(void 0===e){var u={data:pe(n.data),position:pe(n.position),group:n.group,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbable:n.grabbable,pannable:n.pannable,classes:null};u.classes="";var p=0;return n.classes.forEach((function(e){return u.classes+=0==p++?e:" "+e})),u}}},Zi.jsons=function(){for(var e=[],t=0;t<this.length;t++){var a=this[t].json();e.push(a)}return e},Zi.clone=function(){for(var e=this.cy(),t=[],a=0;a<this.length;a++){var n=this[a].json(),i=new we(e,n,!1);t.push(i)}return new Qi(e,t)},Zi.copy=Zi.clone,Zi.restore=function(){for(var e,t,a=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=this,s=i.cy(),r=s._private,o=[],l=[],c=0,d=i.length;c<d;c++){var u=i[c];n&&!u.removed()||(u.isNode()?o.push(u):l.push(u))}e=o.concat(l);var p=function(){e.splice(t,1),t--};for(t=0;t<e.length;t++){var m=e[t],b=m._private,f=b.data;if(m.clearTraversalCache(),n||b.removed)if(void 0===f.id)f.id=Ki(s,m);else if(O(f.id))f.id=""+f.id;else{if(C(f.id)||!j(f.id)){ce("Can not create element with invalid string ID `"+f.id+"`"),p();continue}if(s.hasElementWithId(f.id)){ce("Can not create second element with ID `"+f.id+"`"),p();continue}}else;var h=f.id;if(m.isNode()){var g=b.position;null==g.x&&(g.x=0),null==g.y&&(g.y=0)}if(m.isEdge()){for(var x=m,v=["source","target"],y=v.length,E=!1,w=0;w<y;w++){var M=v[w],S=f[M];O(S)&&(S=f[M]=""+f[M]),null==S||""===S?(ce("Can not create edge `"+h+"` with unspecified "+M),E=!0):s.hasElementWithId(S)||(ce("Can not create edge `"+h+"` with nonexistant "+M+" `"+S+"`"),E=!0)}if(E){p();continue}var _=s.getElementById(f.source),T=s.getElementById(f.target);_.same(T)?_._private.edges.push(x):(_._private.edges.push(x),T._private.edges.push(x)),x._private.source=_,x._private.target=T}b.map=new ye,b.map.set(h,{ele:m,index:0}),b.removed=!1,n&&s.addToPool(m)}for(var k=0;k<o.length;k++){var F=o[k],I=F._private.data;O(I.parent)&&(I.parent=""+I.parent);var D=I.parent,A=null!=D;if(A){var L=s.getElementById(D);if(L.empty())I.parent=void 0;else{for(var R=!1,N=L;!N.empty();){if(F.same(N)){R=!0,I.parent=void 0;break}N=N.parent()}R||(L[0]._private.children.push(F),F._private.parent=L[0],r.hasCompoundNodes=!0)}}}if(e.length>0){for(var P=new Qi(s,e),z=0;z<P.length;z++){var B=P[z];B.isNode()||(B.parallelEdges().clearTraversalCache(),B.source().clearTraversalCache(),B.target().clearTraversalCache())}(r.hasCompoundNodes?s.collection().merge(P).merge(P.connectedNodes()).merge(P.parent()):P).dirtyCompoundBoundsCache().dirtyBoundingBoxCache().updateStyle(a),a?P.emitAndNotify("add"):n&&P.emit("add")}return i},Zi.removed=function(){var e=this[0];return e&&e._private.removed},Zi.inside=function(){var e=this[0];return e&&!e._private.removed},Zi.remove=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=this,n=[],i={},s=a._private.cy;function r(e){for(var t=e._private.edges,a=0;a<t.length;a++)l(t[a])}function o(e){for(var t=e._private.children,a=0;a<t.length;a++)l(t[a])}function l(e){var a=i[e.id()];t&&e.removed()||a||(i[e.id()]=!0,e.isNode()?(n.push(e),r(e),o(e)):n.unshift(e))}for(var c=0,d=a.length;c<d;c++){var u=a[c];l(u)}function p(e,t){var a=e._private.edges;ge(a,t),e.clearTraversalCache()}function m(e){e.clearTraversalCache()}var b=[];function f(e,t){t=t[0];var a=(e=e[0])._private.children,n=e.id();ge(a,t),t._private.parent=null,b.ids[n]||(b.ids[n]=!0,b.push(e))}b.ids={},a.dirtyCompoundBoundsCache(),t&&s.removeFromPool(n);for(var h=0;h<n.length;h++){var g=n[h];if(g.isEdge()){var j=g.source()[0],x=g.target()[0];p(j,g),p(x,g);for(var v=g.parallelEdges(),y=0;y<v.length;y++){var O=v[y];m(O),O.isBundledBezier()&&O.dirtyBoundingBoxCache()}}else{var E=g.parent();0!==E.length&&f(E,g)}t&&(g._private.removed=!0)}var w=s._private.elements;s._private.hasCompoundNodes=!1;for(var M=0;M<w.length;M++){var S=w[M];if(S.isParent()){s._private.hasCompoundNodes=!0;break}}var _=new Qi(this.cy(),n);_.size()>0&&(e?_.emitAndNotify("remove"):t&&_.emit("remove"));for(var T=0;T<b.length;T++){var C=b[T];t&&C.removed()||C.updateStyle()}return _},Zi.move=function(e){var t=this._private.cy,a=this,n=!1,i=!1,s=function(e){return null==e?e:""+e};if(void 0!==e.source||void 0!==e.target){var r=s(e.source),o=s(e.target),l=null!=r&&t.hasElementWithId(r),c=null!=o&&t.hasElementWithId(o);(l||c)&&(t.batch((function(){a.remove(n,i),a.emitAndNotify("moveout");for(var e=0;e<a.length;e++){var t=a[e],s=t._private.data;t.isEdge()&&(l&&(s.source=r),c&&(s.target=o))}a.restore(n,i)})),a.emitAndNotify("move"))}else if(void 0!==e.parent){var d=s(e.parent);if(null===d||t.hasElementWithId(d)){var u=null===d?void 0:d;t.batch((function(){var e=a.remove(n,i);e.emitAndNotify("moveout");for(var t=0;t<a.length;t++){var s=a[t],r=s._private.data;s.isNode()&&(r.parent=u)}e.restore(n,i)})),a.emitAndNotify("move")}}return this},[_a,Pa,za,En,_n,An,Ln,li,Ei,wi,{isNode:function(){return"nodes"===this.group()},isEdge:function(){return"edges"===this.group()},isLoop:function(){return this.isEdge()&&this.source()[0]===this.target()[0]},isSimple:function(){return this.isEdge()&&this.source()[0]!==this.target()[0]},group:function(){var e=this[0];if(e)return e._private.group}},_i,Ci,Di,Ji,Gi].forEach((function(e){P(Zi,e)}));var es={add:function(e){var t,a=this;if(w(e)){var n=e;if(n._private.cy===a)t=n.restore();else{for(var i=[],s=0;s<n.length;s++){var r=n[s];i.push(r.json())}t=new Qi(a,i)}}else if(v(e)){t=new Qi(a,e)}else if(y(e)&&(v(e.nodes)||v(e.edges))){for(var o=e,l=[],c=["nodes","edges"],d=0,u=c.length;d<u;d++){var p=c[d],m=o[p];if(v(m))for(var b=0,f=m.length;b<f;b++){var h=P({group:p},m[b]);l.push(h)}}t=new Qi(a,l)}else{t=new we(a,e).collection()}return t},remove:function(e){if(w(e));else if(j(e)){var t=e;e=this.$(t)}return e.remove()}};
/*! Bezier curve function generator. Copyright Gaetan Renaudeau. MIT License: http://en.wikipedia.org/wiki/MIT_License */
/*! Runge-Kutta spring physics function generator. Adapted from Framer.js, copyright Koen Bok. MIT License: http://en.wikipedia.org/wiki/MIT_License */
var ts=function(){function e(e){return-e.tension*e.x-e.friction*e.v}function t(t,a,n){var i={x:t.x+n.dx*a,v:t.v+n.dv*a,tension:t.tension,friction:t.friction};return{dx:i.v,dv:e(i)}}function a(a,n){var i={dx:a.v,dv:e(a)},s=t(a,.5*n,i),r=t(a,.5*n,s),o=t(a,n,r),l=1/6*(i.dx+2*(s.dx+r.dx)+o.dx),c=1/6*(i.dv+2*(s.dv+r.dv)+o.dv);return a.x=a.x+l*n,a.v=a.v+c*n,a}return function e(t,n,i){var s,r,o,l={x:-1,v:0,tension:null,friction:null},c=[0],d=0,u=1e-4;for(t=parseFloat(t)||500,n=parseFloat(n)||20,i=i||null,l.tension=t,l.friction=n,r=(s=null!==i)?(d=e(t,n))/i*.016:.016;o=a(o||l,r),c.push(1+o.x),d+=16,Math.abs(o.x)>u&&Math.abs(o.v)>u;);return s?function(e){return c[e*(c.length-1)|0]}:d}}(),as=function(e,t,a,n){var i=function(e,t,a,n){var i=4,s=.001,r=1e-7,o=10,l=11,c=1/(l-1),d="undefined"!=typeof Float32Array;if(4!==arguments.length)return!1;for(var u=0;u<4;++u)if("number"!=typeof arguments[u]||isNaN(arguments[u])||!isFinite(arguments[u]))return!1;e=Math.min(e,1),a=Math.min(a,1),e=Math.max(e,0),a=Math.max(a,0);var p=d?new Float32Array(l):new Array(l);function m(e,t){return 1-3*t+3*e}function b(e,t){return 3*t-6*e}function f(e){return 3*e}function h(e,t,a){return((m(t,a)*e+b(t,a))*e+f(t))*e}function g(e,t,a){return 3*m(t,a)*e*e+2*b(t,a)*e+f(t)}function j(t,n){for(var s=0;s<i;++s){var r=g(n,e,a);if(0===r)return n;n-=(h(n,e,a)-t)/r}return n}function x(){for(var t=0;t<l;++t)p[t]=h(t*c,e,a)}function v(t,n,i){var s,l,c=0;do{(s=h(l=n+(i-n)/2,e,a)-t)>0?i=l:n=l}while(Math.abs(s)>r&&++c<o);return l}function y(t){for(var n=0,i=1,r=l-1;i!==r&&p[i]<=t;++i)n+=c;--i;var o=n+(t-p[i])/(p[i+1]-p[i])*c,d=g(o,e,a);return d>=s?j(t,o):0===d?o:v(t,n,n+c)}var O=!1;function E(){O=!0,e===t&&a===n||x()}var w=function(i){return O||E(),e===t&&a===n?i:0===i?0:1===i?1:h(y(i),t,n)};w.getControlPoints=function(){return[{x:e,y:t},{x:a,y:n}]};var M="generateBezier("+[e,t,a,n]+")";return w.toString=function(){return M},w}(e,t,a,n);return function(e,t,a){return e+(t-e)*i(a)}},ns={linear:function(e,t,a){return e+(t-e)*a},ease:as(.25,.1,.25,1),"ease-in":as(.42,0,1,1),"ease-out":as(0,0,.58,1),"ease-in-out":as(.42,0,.58,1),"ease-in-sine":as(.47,0,.745,.715),"ease-out-sine":as(.39,.575,.565,1),"ease-in-out-sine":as(.445,.05,.55,.95),"ease-in-quad":as(.55,.085,.68,.53),"ease-out-quad":as(.25,.46,.45,.94),"ease-in-out-quad":as(.455,.03,.515,.955),"ease-in-cubic":as(.55,.055,.675,.19),"ease-out-cubic":as(.215,.61,.355,1),"ease-in-out-cubic":as(.645,.045,.355,1),"ease-in-quart":as(.895,.03,.685,.22),"ease-out-quart":as(.165,.84,.44,1),"ease-in-out-quart":as(.77,0,.175,1),"ease-in-quint":as(.755,.05,.855,.06),"ease-out-quint":as(.23,1,.32,1),"ease-in-out-quint":as(.86,0,.07,1),"ease-in-expo":as(.95,.05,.795,.035),"ease-out-expo":as(.19,1,.22,1),"ease-in-out-expo":as(1,0,0,1),"ease-in-circ":as(.6,.04,.98,.335),"ease-out-circ":as(.075,.82,.165,1),"ease-in-out-circ":as(.785,.135,.15,.86),spring:function(e,t,a){if(0===a)return ns.linear;var n=ts(e,t,a);return function(e,t,a){return e+(t-e)*n(a)}},"cubic-bezier":as};function is(e,t,a,n,i){if(1===n)return a;var s=i(t,a,n);return null==e||((e.roundValue||e.color)&&(s=Math.round(s)),void 0!==e.min&&(s=Math.max(s,e.min)),void 0!==e.max&&(s=Math.min(s,e.max))),s}function ss(e,t){return null!=e.pfValue||null!=e.value?null==e.pfValue||null!=t&&"%"===t.type.units?e.value:e.pfValue:e}function rs(e,t,a,n,i){var s=null!=i?i.type:null;a<0?a=0:a>1&&(a=1);var r=ss(e,i),o=ss(t,i);if(O(r)&&O(o))return is(s,r,o,a,n);if(v(r)&&v(o)){for(var l=[],c=0;c<o.length;c++){var d=r[c],u=o[c];if(null!=d&&null!=u){var p=is(s,d,u,a,n);l.push(p)}else l.push(u)}return l}}function os(e,t,a,n){var i=!n,s=e._private,r=t._private,o=r.easing,l=r.startTime,c=(n?e:e.cy()).style();if(!r.easingImpl)if(null==o)r.easingImpl=ns.linear;else{var d,u,p;if(j(o))d=c.parse("transition-timing-function",o).value;else d=o;j(d)?(u=d,p=[]):(u=d[1],p=d.slice(2).map((function(e){return+e}))),p.length>0?("spring"===u&&p.push(r.duration),r.easingImpl=ns[u].apply(null,p)):r.easingImpl=ns[u]}var m,b=r.easingImpl;if(m=0===r.duration?1:(a-l)/r.duration,r.applying&&(m=r.progress),m<0?m=0:m>1&&(m=1),null==r.delay){var f=r.startPosition,h=r.position;if(h&&i&&!e.locked()){var g={};ls(f.x,h.x)&&(g.x=rs(f.x,h.x,m,b)),ls(f.y,h.y)&&(g.y=rs(f.y,h.y,m,b)),e.position(g)}var x=r.startPan,v=r.pan,y=s.pan,O=null!=v&&n;O&&(ls(x.x,v.x)&&(y.x=rs(x.x,v.x,m,b)),ls(x.y,v.y)&&(y.y=rs(x.y,v.y,m,b)),e.emit("pan"));var E=r.startZoom,w=r.zoom,M=null!=w&&n;M&&(ls(E,w)&&(s.zoom=Ke(s.minZoom,rs(E,w,m,b),s.maxZoom)),e.emit("zoom")),(O||M)&&e.emit("viewport");var S=r.style;if(S&&S.length>0&&i){for(var _=0;_<S.length;_++){var T=S[_],C=T.name,k=T,F=r.startStyle[C],I=rs(F,k,m,b,c.properties[F.name]);c.overrideBypass(e,C,I)}e.emit("style")}}return r.progress=m,m}function ls(e,t){return null!=e&&null!=t&&(!(!O(e)||!O(t))||!(!e||!t))}function cs(e,t,a,n){var i=t._private;i.started=!0,i.startTime=a-i.progress*i.duration}function ds(e,t){var a=t._private.aniEles,n=[];function i(t,a){var i=t._private,s=i.animation.current,r=i.animation.queue,o=!1;if(!a&&"none"===t.pstyle("display").value){s=s.splice(0,s.length).concat(r.splice(0,r.length));for(var l=0;l<s.length;l++)s[l].stop()}if(0===s.length){var c=r.shift();c&&s.push(c)}for(var d=function(e){for(var t=e.length-1;t>=0;t--){(0,e[t])()}e.splice(0,e.length)},u=s.length-1;u>=0;u--){var p=s[u],m=p._private;m.stopped?(s.splice(u,1),m.hooked=!1,m.playing=!1,m.started=!1,d(m.frames)):(m.playing||m.applying)&&(m.playing&&m.applying&&(m.applying=!1),m.started||cs(0,p,e),os(t,p,e,a),m.applying&&(m.applying=!1),d(m.frames),null!=m.step&&m.step(e),p.completed()&&(s.splice(u,1),m.hooked=!1,m.playing=!1,m.started=!1,d(m.completes)),o=!0)}return a||0!==s.length||0!==r.length||n.push(t),o}for(var s=!1,r=0;r<a.length;r++){var o=i(a[r]);s=s||o}var l=i(t,!0);(s||l)&&(a.length>0?t.notify("draw",a):t.notify("draw")),a.unmerge(n),t.emit("step")}var us={animate:Na.animate(),animation:Na.animation(),animated:Na.animated(),clearQueue:Na.clearQueue(),delay:Na.delay(),delayAnimation:Na.delayAnimation(),stop:Na.stop(),addToAnimationPool:function(e){this.styleEnabled()&&this._private.aniEles.merge(e)},stopAnimationLoop:function(){this._private.animationsRunning=!1},startAnimationLoop:function(){var e=this;if(e._private.animationsRunning=!0,e.styleEnabled()){var t=e.renderer();t&&t.beforeRender?t.beforeRender((function(t,a){ds(a,e)}),t.beforeRenderPriorities.animations):function t(){e._private.animationsRunning&&W((function(a){ds(a,e),t()}))}()}}},ps={qualifierCompare:function(e,t){return null==e||null==t?null==e&&null==t:e.sameText(t)},eventMatches:function(e,t,a){var n=t.qualifier;return null==n||e!==a.target&&M(a.target)&&n.matches(a.target)},addEventFields:function(e,t){t.cy=e,t.target=e},callbackContext:function(e,t,a){return null!=t.qualifier?a.target:e}},ms=function(e){return j(e)?new yn(e):e},bs={createEmitter:function(){var e=this._private;return e.emitter||(e.emitter=new hi(ps,this)),this},emitter:function(){return this._private.emitter},on:function(e,t,a){return this.emitter().on(e,ms(t),a),this},removeListener:function(e,t,a){return this.emitter().removeListener(e,ms(t),a),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},one:function(e,t,a){return this.emitter().one(e,ms(t),a),this},once:function(e,t,a){return this.emitter().one(e,ms(t),a),this},emit:function(e,t){return this.emitter().emit(e,t),this},emitAndNotify:function(e,t){return this.emit(e),this.notify(e,t),this}};Na.eventAliasesOn(bs);var fs={png:function(e){return e=e||{},this._private.renderer.png(e)},jpg:function(e){var t=this._private.renderer;return(e=e||{}).bg=e.bg||"#fff",t.jpg(e)}};fs.jpeg=fs.jpg;var hs={layout:function(e){var t=this;if(null!=e)if(null!=e.name){var a=e.name,n=t.extension("layout",a);if(null!=n){var i;i=j(e.eles)?t.$(e.eles):null!=e.eles?e.eles:t.$();var s=new n(P({},e,{cy:t,eles:i}));return s}ce("No such layout `"+a+"` found.  Did you forget to import it and `cytoscape.use()` it?")}else ce("A `name` must be specified to make a layout");else ce("Layout options must be specified to make a layout")}};hs.createLayout=hs.makeLayout=hs.layout;var gs={notify:function(e,t){var a=this._private;if(this.batching()){a.batchNotifications=a.batchNotifications||{};var n=a.batchNotifications[e]=a.batchNotifications[e]||this.collection();null!=t&&n.merge(t)}else if(a.notificationsEnabled){var i=this.renderer();!this.destroyed()&&i&&i.notify(e,t)}},notifications:function(e){var t=this._private;return void 0===e?t.notificationsEnabled:(t.notificationsEnabled=!!e,this)},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},batching:function(){return this._private.batchCount>0},startBatch:function(){var e=this._private;return null==e.batchCount&&(e.batchCount=0),0===e.batchCount&&(e.batchStyleEles=this.collection(),e.batchNotifications={}),e.batchCount++,this},endBatch:function(){var e=this._private;if(0===e.batchCount)return this;if(e.batchCount--,0===e.batchCount){e.batchStyleEles.updateStyle();var t=this.renderer();Object.keys(e.batchNotifications).forEach((function(a){var n=e.batchNotifications[a];n.empty()?t.notify(a):t.notify(a,n)}))}return this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch((function(){for(var a=Object.keys(e),n=0;n<a.length;n++){var i=a[n],s=e[i];t.getElementById(i).data(s)}}))}},js=he({hideEdgesOnViewport:!1,textureOnViewport:!1,motionBlur:!1,motionBlurOpacity:.05,pixelRatio:void 0,desktopTapThreshold:4,touchTapThreshold:8,wheelSensitivity:1,debug:!1,showFps:!1}),xs={renderTo:function(e,t,a,n){return this._private.renderer.renderTo(e,t,a,n),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify("draw"),this},resize:function(){return this.invalidateSize(),this.emitAndNotify("resize"),this},initRenderer:function(e){var t=this,a=t.extension("renderer",e.name);if(null!=a){void 0!==e.wheelSensitivity&&ue("You have set a custom wheel sensitivity.  This will make your app zoom unnaturally when using mainstream mice.  You should change this value from the default only if you can guarantee that all your users will use the same hardware and OS configuration as your current machine.");var n=js(e);n.cy=t,t._private.renderer=new a(n),this.notify("init")}else ce("Can not initialise: No such renderer `".concat(e.name,"` found. Did you forget to import it and `cytoscape.use()` it?"))},destroyRenderer:function(){var e=this;e.notify("destroy");var t=e.container();if(t)for(t._cyreg=null;t.childNodes.length>0;)t.removeChild(t.childNodes[0]);e._private.renderer=null,e.mutableElements().forEach((function(e){var t=e._private;t.rscratch={},t.rstyle={},t.animation.current=[],t.animation.queue=[]}))},onRender:function(e){return this.on("render",e)},offRender:function(e){return this.off("render",e)}};xs.invalidateDimensions=xs.resize;var vs={collection:function(e,t){return j(e)?this.$(e):w(e)?e.collection():v(e)?new Qi(this,e,t):new Qi(this)},nodes:function(e){var t=this.$((function(e){return e.isNode()}));return e?t.filter(e):t},edges:function(e){var t=this.$((function(e){return e.isEdge()}));return e?t.filter(e):t},$:function(e){var t=this._private.elements;return e?t.filter(e):t.spawnSelf()},mutableElements:function(){return this._private.elements}};vs.elements=vs.filter=vs.$;var ys={},Os="t";ys.apply=function(e){var t=this,a=t._private,n=a.cy.collection();a.newStyle&&(a.contextStyles={},a.propDiffs={},t.cleanElements(e,!0));for(var i=0;i<e.length;i++){var s=e[i],r=t.getContextMeta(s);if(!r.empty){var o=t.getContextStyle(r),l=t.applyContextStyle(r,o,s);a.newStyle||t.updateTransitions(s,l.diffProps),t.updateStyleHints(s)&&n.merge(s)}}return a.newStyle=!1,n},ys.getPropertiesDiff=function(e,t){var a=this,n=a._private.propDiffs=a._private.propDiffs||{},i=e+"-"+t,s=n[i];if(s)return s;for(var r=[],o={},l=0;l<a.length;l++){var c=a[l],d=e[l]===Os,u=t[l]===Os,p=d!==u,m=c.mappedProperties.length>0;if(p||u&&m){var b=void 0;p&&m||p?b=c.properties:m&&(b=c.mappedProperties);for(var f=0;f<b.length;f++){for(var h=b[f],g=h.name,j=!1,x=l+1;x<a.length;x++){var v=a[x];if(t[x]===Os&&(j=null!=v.properties[h.name]))break}o[g]||j||(o[g]=!0,r.push(g))}}}return n[i]=r,r},ys.getContextMeta=function(e){var t,a=this,n="",i=e._private.styleCxtKey||"";a._private.newStyle&&(i="");for(var s=0;s<a.length;s++){var r=a[s];n+=r.selector&&r.selector.matches(e)?Os:"f"}return t=a.getPropertiesDiff(i,n),e._private.styleCxtKey=n,{key:n,diffPropNames:t,empty:0===t.length}},ys.getContextStyle=function(e){var t=e.key,a=this._private.contextStyles=this._private.contextStyles||{};if(a[t])return a[t];for(var n={_private:{key:t}},i=0;i<this.length;i++){var s=this[i];if(t[i]===Os)for(var r=0;r<s.properties.length;r++){var o=s.properties[r];n[o.name]=o}}return a[t]=n,n},ys.applyContextStyle=function(e,t,a){for(var n=e.diffPropNames,i={},s=this.types,r=0;r<n.length;r++){var o=n[r],l=t[o],c=a.pstyle(o);if(!l){if(!c)continue;l=c.bypass?{name:o,deleteBypassed:!0}:{name:o,delete:!0}}if(c!==l){if(l.mapped===s.fn&&null!=c&&null!=c.mapping&&c.mapping.value===l.value){var d=c.mapping;if((d.fnValue=l.value(a))===d.prevFnValue)continue}var u=i[o]={prev:c};this.applyParsedProperty(a,l),u.next=a.pstyle(o),u.next&&u.next.bypass&&(u.next=u.next.bypassed)}}return{diffProps:i}},ys.updateStyleHints=function(e){var t=e._private,a=this,n=a.propertyGroupNames,i=a.propertyGroupKeys,s=function(e,t,n){return a.getPropertiesHash(e,t,n)},r=t.styleKey;if(e.removed())return!1;var o="nodes"===t.group,l=e._private.style;n=Object.keys(l);for(var c=0;c<i.length;c++){var d=i[c];t.styleKeys[d]=0}for(var u=function(e,a){return t.styleKeys[a]=X(e,t.styleKeys[a])},p=function(e,t){for(var a=0;a<e.length;a++)u(e.charCodeAt(a),t)},m=function(e){return-128<e&&e<128&&Math.floor(e)!==e?2e9-(1024*e|0):e},b=0;b<n.length;b++){var f=n[b],h=l[f];if(null!=h){var g=this.properties[f],j=g.type,x=g.groupKey,v=void 0;null!=g.hashOverride?v=g.hashOverride(e,h):null!=h.pfValue&&(v=h.pfValue);var y=null==g.enums?h.value:null,O=null!=v,E=O||null!=y,w=h.units;if(j.number&&E){var M=O?v:y;if(j.multiple)for(var S=0;S<M.length;S++)u(m(M[S]),x);else u(m(M),x);O||null==w||p(w,x)}else p(h.strValue,x)}}for(var _=0,T=0;T<i.length;T++){var C=i[T],k=t.styleKeys[C];_=X(k,_)}t.styleKey=_;var F=t.labelDimsKey=t.styleKeys.labelDimensions;if(t.labelKey=s(e,["label"],F),t.labelStyleKey=X(t.styleKeys.commonLabel,t.labelKey),o||(t.sourceLabelKey=s(e,["source-label"],F),t.sourceLabelStyleKey=X(t.styleKeys.commonLabel,t.sourceLabelKey),t.targetLabelKey=s(e,["target-label"],F),t.targetLabelStyleKey=X(t.styleKeys.commonLabel,t.targetLabelKey)),o){var I=t.styleKeys,D=I.nodeBody,A=I.nodeBorder,L=I.backgroundImage,R=I.compound,N=I.pie;t.nodeKey=K([A,L,R,N],D),t.hasPie=0!=N}return r!==t.styleKey},ys.clearStyleHints=function(e){var t=e._private;t.styleKeys={},t.styleKey=null,t.labelKey=null,t.labelStyleKey=null,t.sourceLabelKey=null,t.sourceLabelStyleKey=null,t.targetLabelKey=null,t.targetLabelStyleKey=null,t.nodeKey=null,t.hasPie=null},ys.applyParsedProperty=function(e,t){var a,n=this,i=t,s=e._private.style,r=n.types,o=n.properties[i.name].type,l=i.bypass,c=s[i.name],d=c&&c.bypass,u=e._private,p="mapping",m=function(e){return null==e?null:null!=e.pfValue?e.pfValue:e.value},b=function(){var t=m(c),a=m(i);n.checkTriggers(e,i.name,t,a)};if("curve-style"===t.name&&e.isEdge()&&("bezier"!==t.value&&e.isLoop()||"haystack"===t.value&&(e.source().isParent()||e.target().isParent()))&&(i=t=this.parse(t.name,"bezier",l)),i.delete)return s[i.name]=void 0,b(),!0;if(i.deleteBypassed)return c?!!c.bypass&&(c.bypassed=void 0,b(),!0):(b(),!0);if(i.deleteBypass)return c?!!c.bypass&&(s[i.name]=c.bypassed,b(),!0):(b(),!0);var f=function(){ue("Do not assign mappings to elements without corresponding data (i.e. ele `"+e.id()+"` has no mapping for property `"+i.name+"` with data field `"+i.field+"`); try a `["+i.field+"]` selector to limit scope to elements with `"+i.field+"` defined")};switch(i.mapped){case r.mapData:for(var h,g=i.field.split("."),j=u.data,x=0;x<g.length&&j;x++){j=j[g[x]]}if(null==j)return f(),!1;if(!O(j))return ue("Do not use continuous mappers without specifying numeric data (i.e. `"+i.field+": "+j+"` for `"+e.id()+"` is non-numeric)"),!1;var v=i.fieldMax-i.fieldMin;if((h=0===v?0:(j-i.fieldMin)/v)<0?h=0:h>1&&(h=1),o.color){var y=i.valueMin[0],E=i.valueMax[0],w=i.valueMin[1],M=i.valueMax[1],S=i.valueMin[2],_=i.valueMax[2],T=null==i.valueMin[3]?1:i.valueMin[3],C=null==i.valueMax[3]?1:i.valueMax[3],k=[Math.round(y+(E-y)*h),Math.round(w+(M-w)*h),Math.round(S+(_-S)*h),Math.round(T+(C-T)*h)];a={bypass:i.bypass,name:i.name,value:k,strValue:"rgb("+k[0]+", "+k[1]+", "+k[2]+")"}}else{if(!o.number)return!1;var F=i.valueMin+(i.valueMax-i.valueMin)*h;a=this.parse(i.name,F,i.bypass,p)}if(!a)return f(),!1;a.mapping=i,i=a;break;case r.data:for(var I=i.field.split("."),D=u.data,A=0;A<I.length&&D;A++){D=D[I[A]]}if(null!=D&&(a=this.parse(i.name,D,i.bypass,p)),!a)return f(),!1;a.mapping=i,i=a;break;case r.fn:var L=i.value,R=null!=i.fnValue?i.fnValue:L(e);if(i.prevFnValue=R,null==R)return ue("Custom function mappers may not return null (i.e. `"+i.name+"` for ele `"+e.id()+"` is null)"),!1;if(!(a=this.parse(i.name,R,i.bypass,p)))return ue("Custom function mappers may not return invalid values for the property type (i.e. `"+i.name+"` for ele `"+e.id()+"` is invalid)"),!1;a.mapping=pe(i),i=a;break;case void 0:break;default:return!1}return l?(i.bypassed=d?c.bypassed:c,s[i.name]=i):d?c.bypassed=i:s[i.name]=i,b(),!0},ys.cleanElements=function(e,t){for(var a=0;a<e.length;a++){var n=e[a];if(this.clearStyleHints(n),n.dirtyCompoundBoundsCache(),n.dirtyBoundingBoxCache(),t)for(var i=n._private.style,s=Object.keys(i),r=0;r<s.length;r++){var o=s[r],l=i[o];null!=l&&(l.bypass?l.bypassed=null:i[o]=null)}else n._private.style={}}},ys.update=function(){this._private.cy.mutableElements().updateStyle()},ys.updateTransitions=function(e,t){var a=this,n=e._private,i=e.pstyle("transition-property").value,s=e.pstyle("transition-duration").pfValue,r=e.pstyle("transition-delay").pfValue;if(i.length>0&&s>0){for(var o={},l=!1,c=0;c<i.length;c++){var d=i[c],u=e.pstyle(d),p=t[d];if(p){var m=p.prev,b=null!=p.next?p.next:u,f=!1,h=void 0,g=1e-6;m&&(O(m.pfValue)&&O(b.pfValue)?(f=b.pfValue-m.pfValue,h=m.pfValue+g*f):O(m.value)&&O(b.value)?(f=b.value-m.value,h=m.value+g*f):v(m.value)&&v(b.value)&&(f=m.value[0]!==b.value[0]||m.value[1]!==b.value[1]||m.value[2]!==b.value[2],h=m.strValue),f&&(o[d]=b.strValue,this.applyBypass(e,d,h),l=!0))}}if(!l)return;n.transitioning=!0,new Aa((function(t){r>0?e.delayAnimation(r).play().promise().then(t):t()})).then((function(){return e.animation({style:o,duration:s,easing:e.pstyle("transition-timing-function").value,queue:!1}).play().promise()})).then((function(){a.removeBypasses(e,i),e.emitAndNotify("style"),n.transitioning=!1}))}else n.transitioning&&(this.removeBypasses(e,i),e.emitAndNotify("style"),n.transitioning=!1)},ys.checkTrigger=function(e,t,a,n,i,s){var r=this.properties[t],o=i(r);null!=o&&o(a,n)&&s(r)},ys.checkZOrderTrigger=function(e,t,a,n){var i=this;this.checkTrigger(e,t,a,n,(function(e){return e.triggersZOrder}),(function(){i._private.cy.notify("zorder",e)}))},ys.checkBoundsTrigger=function(e,t,a,n){this.checkTrigger(e,t,a,n,(function(e){return e.triggersBounds}),(function(i){e.dirtyCompoundBoundsCache(),e.dirtyBoundingBoxCache(),"bezier"!==e.pstyle("curve-style").value&&("curve-style"!==t||"bezier"!==a&&"bezier"!==n)||!i.triggersBoundsOfParallelBeziers||e.parallelEdges().forEach((function(e){e.isBundledBezier()&&e.dirtyBoundingBoxCache()}))}))},ys.checkTriggers=function(e,t,a,n){e.dirtyStyleCache(),this.checkZOrderTrigger(e,t,a,n),this.checkBoundsTrigger(e,t,a,n)};var Es={applyBypass:function(e,t,a,n){var i=[];if("*"===t||"**"===t){if(void 0!==a)for(var s=0;s<this.properties.length;s++){var r=this.properties[s].name,o=this.parse(r,a,!0);o&&i.push(o)}}else if(j(t)){var l=this.parse(t,a,!0);l&&i.push(l)}else{if(!y(t))return!1;var c=t;n=a;for(var d=Object.keys(c),u=0;u<d.length;u++){var p=d[u],m=c[p];if(void 0===m&&(m=c[D(p)]),void 0!==m){var b=this.parse(p,m,!0);b&&i.push(b)}}}if(0===i.length)return!1;for(var f=!1,h=0;h<e.length;h++){for(var g=e[h],x={},v=void 0,O=0;O<i.length;O++){var E=i[O];if(n){var w=g.pstyle(E.name);v=x[E.name]={prev:w}}f=this.applyParsedProperty(g,E)||f,n&&(v.next=g.pstyle(E.name))}f&&this.updateStyleHints(g),n&&this.updateTransitions(g,x,true)}return f},overrideBypass:function(e,t,a){t=I(t);for(var n=0;n<e.length;n++){var i=e[n],s=i._private.style[t],r=this.properties[t].type,o=r.color,l=r.mutiple,c=s?null!=s.pfValue?s.pfValue:s.value:null;s&&s.bypass?(s.value=a,null!=s.pfValue&&(s.pfValue=a),s.strValue=o?"rgb("+a.join(",")+")":l?a.join(" "):""+a,this.updateStyleHints(i)):this.applyBypass(i,t,a),this.checkTriggers(i,t,c,a)}},removeAllBypasses:function(e,t){return this.removeBypasses(e,this.propertyNames,t)},removeBypasses:function(e,t,a){for(var n=0;n<e.length;n++){for(var i=e[n],s={},r=0;r<t.length;r++){var o=t[r],l=this.properties[o],c=i.pstyle(l.name);if(c&&c.bypass){var d=this.parse(o,"",!0),u=s[l.name]={prev:c};this.applyParsedProperty(i,d),u.next=i.pstyle(l.name)}}this.updateStyleHints(i),a&&this.updateTransitions(i,s,true)}}},ws={getEmSizeInPixels:function(){var e=this.containerCss("font-size");return null!=e?parseFloat(e):1},containerCss:function(e){var t=this._private.cy.container();if(u&&t&&u.getComputedStyle)return u.getComputedStyle(t).getPropertyValue(e)}},Ms={getRenderedStyle:function(e,t){return t?this.getStylePropertyValue(e,t,!0):this.getRawStyle(e,!0)},getRawStyle:function(e,t){var a=this;if(e=e[0]){for(var n={},i=0;i<a.properties.length;i++){var s=a.properties[i],r=a.getStylePropertyValue(e,s.name,t);null!=r&&(n[s.name]=r,n[D(s.name)]=r)}return n}},getIndexedStyle:function(e,t,a,n){var i=e.pstyle(t)[a][n];return null!=i?i:e.cy().style().getDefaultProperty(t)[a][0]},getStylePropertyValue:function(e,t,a){if(e=e[0]){var n=this.properties[t];n.alias&&(n=n.pointsTo);var i=n.type,s=e.pstyle(n.name);if(s){var r=s.value,o=s.units,l=s.strValue;if(a&&i.number&&null!=r&&O(r)){var c=e.cy().zoom(),d=function(e){return e*c},u=function(e,t){return d(e)+t},p=v(r);return(p?o.every((function(e){return null!=e})):null!=o)?p?r.map((function(e,t){return u(e,o[t])})).join(" "):u(r,o):p?r.map((function(e){return j(e)?e:""+d(e)})).join(" "):""+d(r)}if(null!=l)return l}return null}},getAnimationStartStyle:function(e,t){for(var a={},n=0;n<t.length;n++){var i=t[n].name,s=e.pstyle(i);void 0!==s&&(s=y(s)?this.parse(i,s.strValue):this.parse(i,s)),s&&(a[i]=s)}return a},getPropsList:function(e){var t=[],a=e,n=this.properties;if(a)for(var i=Object.keys(a),s=0;s<i.length;s++){var r=i[s],o=a[r],l=n[r]||n[I(r)],c=this.parse(l.name,o);c&&t.push(c)}return t},getNonDefaultPropertiesHash:function(e,t,a){var n,i,s,r,o,l,c=a;for(o=0;o<t.length;o++)if(n=t[o],null!=(i=e.pstyle(n,!1)))if(null!=i.pfValue)c=X(r,c);else for(s=i.strValue,l=0;l<s.length;l++)r=s.charCodeAt(l),c=X(r,c);return c}};Ms.getPropertiesHash=Ms.getNonDefaultPropertiesHash;var Ss={appendFromJson:function(e){for(var t=this,a=0;a<e.length;a++){var n=e[a],i=n.selector,s=n.style||n.css,r=Object.keys(s);t.selector(i);for(var o=0;o<r.length;o++){var l=r[o],c=s[l];t.css(l,c)}}return t},fromJson:function(e){var t=this;return t.resetToDefault(),t.appendFromJson(e),t},json:function(){for(var e=[],t=this.defaultLength;t<this.length;t++){for(var a=this[t],n=a.selector,i=a.properties,s={},r=0;r<i.length;r++){var o=i[r];s[o.name]=o.strValue}e.push({selector:n?n.toString():"core",style:s})}return e}},_s={appendFromString:function(e){var t,a,n,i=this,s=""+e;function r(){s=s.length>t.length?s.substr(t.length):""}function o(){a=a.length>n.length?a.substr(n.length):""}for(s=s.replace(/[/][*](\s|.)+?[*][/]/g,"");;){if(s.match(/^\s*$/))break;var l=s.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!l){ue("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+s);break}t=l[0];var c=l[1];if("core"!==c)if(new yn(c).invalid){ue("Skipping parsing of block: Invalid selector found in string stylesheet: "+c),r();continue}var d=l[2],u=!1;a=d;for(var p=[];;){if(a.match(/^\s*$/))break;var m=a.match(/^\s*(.+?)\s*:\s*(.+?)\s*;/);if(!m){ue("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+d),u=!0;break}n=m[0];var b=m[1],f=m[2];if(this.properties[b])i.parse(b,f)?(p.push({name:b,val:f}),o()):(ue("Skipping property: Invalid property definition in: "+n),o());else ue("Skipping property: Invalid property name in: "+n),o()}if(u){r();break}i.selector(c);for(var h=0;h<p.length;h++){var g=p[h];i.css(g.name,g.val)}r()}return i},fromString:function(e){var t=this;return t.resetToDefault(),t.appendFromString(e),t}},Ts={};!function(){var e=R,t=function(e){return"^"+e+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},a=function(t){var a=e+"|\\w+|rgb[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%]?)(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|hsl[a]?\\((?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?)))\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))[%])(?:\\s*,\\s*(?:(?:[-+]?(?:(?:\\d+|\\d*\\.\\d+)(?:[Ee][+-]?\\d+)?))))?\\)|\\#[0-9a-fA-F]{3}|\\#[0-9a-fA-F]{6}";return"^"+t+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+e+")\\s*\\,\\s*("+e+")\\s*,\\s*("+a+")\\s*\\,\\s*("+a+")\\)$"},n=["^url\\s*\\(\\s*['\"]?(.+?)['\"]?\\s*\\)$","^(none)$","^(.+)$"];Ts.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%",implicitUnits:"%"},percentages:{number:!0,min:0,max:100,units:"%",implicitUnits:"%",multiple:!0},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},zeroOneNumbers:{number:!0,min:0,max:1,unitless:!0,multiple:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},nodeSize:{number:!0,min:0,enums:["label"]},number:{number:!0,unitless:!0},numbers:{number:!0,unitless:!0,multiple:!0},positiveNumber:{number:!0,unitless:!0,min:0,strictMin:!0},size:{number:!0,min:0},bidirectionalSize:{number:!0},bidirectionalSizes:{number:!0,multiple:!0},sizeMaybePercent:{number:!0,min:0,allowPercent:!0},axisDirection:{enums:["horizontal","leftward","rightward","vertical","upward","downward","auto"]},paddingRelativeTo:{enums:["width","height","average","min","max"]},bgWH:{number:!0,min:0,allowPercent:!0,enums:["auto"],multiple:!0},bgPos:{number:!0,allowPercent:!0,multiple:!0},bgRelativeTo:{enums:["inner","include-padding"],multiple:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"],multiple:!0},bgFit:{enums:["none","contain","cover"],multiple:!0},bgCrossOrigin:{enums:["anonymous","use-credentials"],multiple:!0},bgClip:{enums:["none","node"],multiple:!0},color:{color:!0},colors:{color:!0,multiple:!0},fill:{enums:["solid","linear-gradient","radial-gradient"]},bool:{enums:["yes","no"]},lineStyle:{enums:["solid","dotted","dashed"]},lineCap:{enums:["butt","round","square"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack","segments","straight","taxi"]},fontFamily:{regex:'^([\\w- \\"]+(?:\\s*,\\s*[\\w- \\"]+)*)$'},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},textWrap:{enums:["none","wrap","ellipsis"]},textOverflowWrap:{enums:["whitespace","anywhere"]},textBackgroundShape:{enums:["rectangle","roundrectangle","round-rectangle"]},nodeShape:{enums:["rectangle","roundrectangle","round-rectangle","cutrectangle","cut-rectangle","bottomroundrectangle","bottom-round-rectangle","barrel","ellipse","triangle","square","pentagon","hexagon","concavehexagon","concave-hexagon","heptagon","octagon","tag","star","diamond","vee","rhomboid","polygon"]},compoundIncludeLabels:{enums:["include","exclude"]},arrowShape:{enums:["tee","triangle","triangle-tee","triangle-cross","triangle-backcurve","vee","square","circle","diamond","chevron","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},zCompoundDepth:{enums:["bottom","orphan","auto","top"]},zIndexCompare:{enums:["auto","manual"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},justification:{enums:["left","center","right","auto"]},text:{string:!0},data:{mapping:!0,regex:t("data")},layoutData:{mapping:!0,regex:t("layoutData")},scratch:{mapping:!0,regex:t("scratch")},mapData:{mapping:!0,regex:a("mapData")},mapLayoutData:{mapping:!0,regex:a("mapLayoutData")},mapScratch:{mapping:!0,regex:a("mapScratch")},fn:{mapping:!0,fn:!0},url:{regexes:n,singleRegexMatchValue:!0},urls:{regexes:n,singleRegexMatchValue:!0,multiple:!0},propList:{propList:!0},angle:{number:!0,units:"deg|rad",implicitUnits:"rad"},textRotation:{number:!0,units:"deg|rad",implicitUnits:"rad",enums:["none","autorotate"]},polygonPointList:{number:!0,multiple:!0,evenMultiple:!0,min:-1,max:1,unitless:!0},edgeDistances:{enums:["intersection","node-position"]},edgeEndpoint:{number:!0,multiple:!0,units:"%|px|em|deg|rad",implicitUnits:"px",enums:["inside-to-node","outside-to-node","outside-to-node-or-label","outside-to-line","outside-to-line-or-label"],singleEnum:!0,validate:function(e,t){switch(e.length){case 2:return"deg"!==t[0]&&"rad"!==t[0]&&"deg"!==t[1]&&"rad"!==t[1];case 1:return j(e[0])||"deg"===t[0]||"rad"===t[0];default:return!1}}},easing:{regexes:["^(spring)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$","^(cubic-bezier)\\s*\\(\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*,\\s*("+e+")\\s*\\)$"],enums:["linear","ease","ease-in","ease-out","ease-in-out","ease-in-sine","ease-out-sine","ease-in-out-sine","ease-in-quad","ease-out-quad","ease-in-out-quad","ease-in-cubic","ease-out-cubic","ease-in-out-cubic","ease-in-quart","ease-out-quart","ease-in-out-quart","ease-in-quint","ease-out-quint","ease-in-out-quint","ease-in-expo","ease-out-expo","ease-in-out-expo","ease-in-circ","ease-out-circ","ease-in-out-circ"]},gradientDirection:{enums:["to-bottom","to-top","to-left","to-right","to-bottom-right","to-bottom-left","to-top-right","to-top-left","to-right-bottom","to-left-bottom","to-right-top","to-left-top"]},boundsExpansion:{number:!0,multiple:!0,min:0,validate:function(e){var t=e.length;return 1===t||2===t||4===t}}};var i={zeroNonZero:function(e,t){return(null==e||null==t)&&e!==t||(0==e&&0!=t||0!=e&&0==t)},any:function(e,t){return e!=t}},s=Ts.types,r=[{name:"label",type:s.text,triggersBounds:i.any},{name:"text-rotation",type:s.textRotation,triggersBounds:i.any},{name:"text-margin-x",type:s.bidirectionalSize,triggersBounds:i.any},{name:"text-margin-y",type:s.bidirectionalSize,triggersBounds:i.any}],o=[{name:"source-label",type:s.text,triggersBounds:i.any},{name:"source-text-rotation",type:s.textRotation,triggersBounds:i.any},{name:"source-text-margin-x",type:s.bidirectionalSize,triggersBounds:i.any},{name:"source-text-margin-y",type:s.bidirectionalSize,triggersBounds:i.any},{name:"source-text-offset",type:s.size,triggersBounds:i.any}],l=[{name:"target-label",type:s.text,triggersBounds:i.any},{name:"target-text-rotation",type:s.textRotation,triggersBounds:i.any},{name:"target-text-margin-x",type:s.bidirectionalSize,triggersBounds:i.any},{name:"target-text-margin-y",type:s.bidirectionalSize,triggersBounds:i.any},{name:"target-text-offset",type:s.size,triggersBounds:i.any}],c=[{name:"font-family",type:s.fontFamily,triggersBounds:i.any},{name:"font-style",type:s.fontStyle,triggersBounds:i.any},{name:"font-weight",type:s.fontWeight,triggersBounds:i.any},{name:"font-size",type:s.size,triggersBounds:i.any},{name:"text-transform",type:s.textTransform,triggersBounds:i.any},{name:"text-wrap",type:s.textWrap,triggersBounds:i.any},{name:"text-overflow-wrap",type:s.textOverflowWrap,triggersBounds:i.any},{name:"text-max-width",type:s.size,triggersBounds:i.any},{name:"text-outline-width",type:s.size,triggersBounds:i.any},{name:"line-height",type:s.positiveNumber,triggersBounds:i.any}],d=[{name:"text-valign",type:s.valign,triggersBounds:i.any},{name:"text-halign",type:s.halign,triggersBounds:i.any},{name:"color",type:s.color},{name:"text-outline-color",type:s.color},{name:"text-outline-opacity",type:s.zeroOneNumber},{name:"text-background-color",type:s.color},{name:"text-background-opacity",type:s.zeroOneNumber},{name:"text-background-padding",type:s.size,triggersBounds:i.any},{name:"text-border-opacity",type:s.zeroOneNumber},{name:"text-border-color",type:s.color},{name:"text-border-width",type:s.size,triggersBounds:i.any},{name:"text-border-style",type:s.borderStyle,triggersBounds:i.any},{name:"text-background-shape",type:s.textBackgroundShape,triggersBounds:i.any},{name:"text-justification",type:s.justification}],u=[{name:"events",type:s.bool},{name:"text-events",type:s.bool}],p=[{name:"display",type:s.display,triggersZOrder:i.any,triggersBounds:i.any,triggersBoundsOfParallelBeziers:!0},{name:"visibility",type:s.visibility,triggersZOrder:i.any},{name:"opacity",type:s.zeroOneNumber,triggersZOrder:i.zeroNonZero},{name:"text-opacity",type:s.zeroOneNumber},{name:"min-zoomed-font-size",type:s.size},{name:"z-compound-depth",type:s.zCompoundDepth,triggersZOrder:i.any},{name:"z-index-compare",type:s.zIndexCompare,triggersZOrder:i.any},{name:"z-index",type:s.nonNegativeInt,triggersZOrder:i.any}],m=[{name:"overlay-padding",type:s.size,triggersBounds:i.any},{name:"overlay-color",type:s.color},{name:"overlay-opacity",type:s.zeroOneNumber,triggersBounds:i.zeroNonZero}],b=[{name:"transition-property",type:s.propList},{name:"transition-duration",type:s.time},{name:"transition-delay",type:s.time},{name:"transition-timing-function",type:s.easing}],f=function(e,t){return"label"===t.value?-e.poolIndex():t.pfValue},h=[{name:"height",type:s.nodeSize,triggersBounds:i.any,hashOverride:f},{name:"width",type:s.nodeSize,triggersBounds:i.any,hashOverride:f},{name:"shape",type:s.nodeShape,triggersBounds:i.any},{name:"shape-polygon-points",type:s.polygonPointList,triggersBounds:i.any},{name:"background-color",type:s.color},{name:"background-fill",type:s.fill},{name:"background-opacity",type:s.zeroOneNumber},{name:"background-blacken",type:s.nOneOneNumber},{name:"background-gradient-stop-colors",type:s.colors},{name:"background-gradient-stop-positions",type:s.percentages},{name:"background-gradient-direction",type:s.gradientDirection},{name:"padding",type:s.sizeMaybePercent,triggersBounds:i.any},{name:"padding-relative-to",type:s.paddingRelativeTo,triggersBounds:i.any},{name:"bounds-expansion",type:s.boundsExpansion,triggersBounds:i.any}],g=[{name:"border-color",type:s.color},{name:"border-opacity",type:s.zeroOneNumber},{name:"border-width",type:s.size,triggersBounds:i.any},{name:"border-style",type:s.borderStyle}],x=[{name:"background-image",type:s.urls},{name:"background-image-crossorigin",type:s.bgCrossOrigin},{name:"background-image-opacity",type:s.zeroOneNumbers},{name:"background-position-x",type:s.bgPos},{name:"background-position-y",type:s.bgPos},{name:"background-width-relative-to",type:s.bgRelativeTo},{name:"background-height-relative-to",type:s.bgRelativeTo},{name:"background-repeat",type:s.bgRepeat},{name:"background-fit",type:s.bgFit},{name:"background-clip",type:s.bgClip},{name:"background-width",type:s.bgWH},{name:"background-height",type:s.bgWH},{name:"background-offset-x",type:s.bgPos},{name:"background-offset-y",type:s.bgPos}],v=[{name:"position",type:s.position,triggersBounds:i.any},{name:"compound-sizing-wrt-labels",type:s.compoundIncludeLabels,triggersBounds:i.any},{name:"min-width",type:s.size,triggersBounds:i.any},{name:"min-width-bias-left",type:s.sizeMaybePercent,triggersBounds:i.any},{name:"min-width-bias-right",type:s.sizeMaybePercent,triggersBounds:i.any},{name:"min-height",type:s.size,triggersBounds:i.any},{name:"min-height-bias-top",type:s.sizeMaybePercent,triggersBounds:i.any},{name:"min-height-bias-bottom",type:s.sizeMaybePercent,triggersBounds:i.any}],y=[{name:"line-style",type:s.lineStyle},{name:"line-color",type:s.color},{name:"line-fill",type:s.fill},{name:"line-cap",type:s.lineCap},{name:"line-dash-pattern",type:s.numbers},{name:"line-dash-offset",type:s.number},{name:"line-gradient-stop-colors",type:s.colors},{name:"line-gradient-stop-positions",type:s.percentages},{name:"curve-style",type:s.curveStyle,triggersBounds:i.any,triggersBoundsOfParallelBeziers:!0},{name:"haystack-radius",type:s.zeroOneNumber,triggersBounds:i.any},{name:"source-endpoint",type:s.edgeEndpoint,triggersBounds:i.any},{name:"target-endpoint",type:s.edgeEndpoint,triggersBounds:i.any},{name:"control-point-step-size",type:s.size,triggersBounds:i.any},{name:"control-point-distances",type:s.bidirectionalSizes,triggersBounds:i.any},{name:"control-point-weights",type:s.numbers,triggersBounds:i.any},{name:"segment-distances",type:s.bidirectionalSizes,triggersBounds:i.any},{name:"segment-weights",type:s.numbers,triggersBounds:i.any},{name:"taxi-turn",type:s.sizeMaybePercent,triggersBounds:i.any},{name:"taxi-turn-min-distance",type:s.size,triggersBounds:i.any},{name:"taxi-direction",type:s.axisDirection,triggersBounds:i.any},{name:"edge-distances",type:s.edgeDistances,triggersBounds:i.any},{name:"arrow-scale",type:s.positiveNumber,triggersBounds:i.any},{name:"loop-direction",type:s.angle,triggersBounds:i.any},{name:"loop-sweep",type:s.angle,triggersBounds:i.any},{name:"source-distance-from-node",type:s.size,triggersBounds:i.any},{name:"target-distance-from-node",type:s.size,triggersBounds:i.any}],O=[{name:"ghost",type:s.bool,triggersBounds:i.any},{name:"ghost-offset-x",type:s.bidirectionalSize,triggersBounds:i.any},{name:"ghost-offset-y",type:s.bidirectionalSize,triggersBounds:i.any},{name:"ghost-opacity",type:s.zeroOneNumber}],E=[{name:"selection-box-color",type:s.color},{name:"selection-box-opacity",type:s.zeroOneNumber},{name:"selection-box-border-color",type:s.color},{name:"selection-box-border-width",type:s.size},{name:"active-bg-color",type:s.color},{name:"active-bg-opacity",type:s.zeroOneNumber},{name:"active-bg-size",type:s.size},{name:"outside-texture-bg-color",type:s.color},{name:"outside-texture-bg-opacity",type:s.zeroOneNumber}],w=[];Ts.pieBackgroundN=16,w.push({name:"pie-size",type:s.sizeMaybePercent});for(var M=1;M<=Ts.pieBackgroundN;M++)w.push({name:"pie-"+M+"-background-color",type:s.color}),w.push({name:"pie-"+M+"-background-size",type:s.percent}),w.push({name:"pie-"+M+"-background-opacity",type:s.zeroOneNumber});var S=[],_=Ts.arrowPrefixes=["source","mid-source","target","mid-target"];[{name:"arrow-shape",type:s.arrowShape,triggersBounds:i.any},{name:"arrow-color",type:s.color},{name:"arrow-fill",type:s.arrowFill}].forEach((function(e){_.forEach((function(t){var a=t+"-"+e.name,n=e.type,i=e.triggersBounds;S.push({name:a,type:n,triggersBounds:i})}))}),{});var T=Ts.properties=[].concat(u,b,p,m,O,d,c,r,o,l,h,g,x,w,v,y,S,E),C=Ts.propertyGroups={behavior:u,transition:b,visibility:p,overlay:m,ghost:O,commonLabel:d,labelDimensions:c,mainLabel:r,sourceLabel:o,targetLabel:l,nodeBody:h,nodeBorder:g,backgroundImage:x,pie:w,compound:v,edgeLine:y,edgeArrow:S,core:E},k=Ts.propertyGroupNames={};(Ts.propertyGroupKeys=Object.keys(C)).forEach((function(e){k[e]=C[e].map((function(e){return e.name})),C[e].forEach((function(t){return t.groupKey=e}))}));var F=Ts.aliases=[{name:"content",pointsTo:"label"},{name:"control-point-distance",pointsTo:"control-point-distances"},{name:"control-point-weight",pointsTo:"control-point-weights"},{name:"edge-text-rotation",pointsTo:"text-rotation"},{name:"padding-left",pointsTo:"padding"},{name:"padding-right",pointsTo:"padding"},{name:"padding-top",pointsTo:"padding"},{name:"padding-bottom",pointsTo:"padding"}];Ts.propertyNames=T.map((function(e){return e.name}));for(var I=0;I<T.length;I++){var D=T[I];T[D.name]=D}for(var A=0;A<F.length;A++){var L=F[A],N=T[L.pointsTo],P={name:L.name,alias:!0,pointsTo:N};T.push(P),T[L.name]=P}}(),Ts.getDefaultProperty=function(e){return this.getDefaultProperties()[e]},Ts.getDefaultProperties=function(){var e=this._private;if(null!=e.defaultProperties)return e.defaultProperties;for(var t=P({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":30,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125,events:"yes","text-events":"no","text-valign":"top","text-halign":"center","text-justification":"auto","line-height":1,color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","text-wrap":"none","text-overflow-wrap":"whitespace","text-max-width":9999,"text-background-color":"#000","text-background-opacity":0,"text-background-shape":"rectangle","text-background-padding":0,"text-border-opacity":0,"text-border-width":0,"text-border-style":"solid","text-border-color":"#000","font-family":"Helvetica Neue, Helvetica, sans-serif","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,"text-rotation":"none","source-text-rotation":"none","target-text-rotation":"none",visibility:"visible",display:"element",opacity:1,"z-compound-depth":"auto","z-index-compare":"auto","z-index":0,label:"","text-margin-x":0,"text-margin-y":0,"source-label":"","source-text-offset":0,"source-text-margin-x":0,"source-text-margin-y":0,"target-label":"","target-text-offset":0,"target-text-margin-x":0,"target-text-margin-y":0,"overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"transition-property":"none","transition-duration":0,"transition-delay":0,"transition-timing-function":"linear","background-blacken":0,"background-color":"#999","background-fill":"solid","background-opacity":1,"background-image":"none","background-image-crossorigin":"anonymous","background-image-opacity":1,"background-position-x":"50%","background-position-y":"50%","background-offset-x":0,"background-offset-y":0,"background-width-relative-to":"include-padding","background-height-relative-to":"include-padding","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","background-width":"auto","background-height":"auto","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","shape-polygon-points":"-1, -1,   1, -1,   1, 1,   -1, 1","bounds-expansion":0,"background-gradient-direction":"to-bottom","background-gradient-stop-colors":"#999","background-gradient-stop-positions":"0%",ghost:"no","ghost-offset-y":0,"ghost-offset-x":0,"ghost-opacity":0,padding:0,"padding-relative-to":"width",position:"origin","compound-sizing-wrt-labels":"include","min-width":0,"min-width-bias-left":0,"min-width-bias-right":0,"min-height":0,"min-height-bias-top":0,"min-height-bias-bottom":0},{"pie-size":"100%"},[{name:"pie-{{i}}-background-color",value:"black"},{name:"pie-{{i}}-background-size",value:"0%"},{name:"pie-{{i}}-background-opacity",value:1}].reduce((function(e,t){for(var a=1;a<=Ts.pieBackgroundN;a++){var n=t.name.replace("{{i}}",a),i=t.value;e[n]=i}return e}),{}),{"line-style":"solid","line-color":"#999","line-fill":"solid","line-cap":"butt","line-gradient-stop-colors":"#999","line-gradient-stop-positions":"0%","control-point-step-size":40,"control-point-weights":.5,"segment-weights":.5,"segment-distances":20,"taxi-turn":"50%","taxi-turn-min-distance":10,"taxi-direction":"auto","edge-distances":"intersection","curve-style":"haystack","haystack-radius":0,"arrow-scale":1,"loop-direction":"-45deg","loop-sweep":"-90deg","source-distance-from-node":0,"target-distance-from-node":0,"source-endpoint":"outside-to-node","target-endpoint":"outside-to-node","line-dash-pattern":[6,3],"line-dash-offset":0},[{name:"arrow-shape",value:"none"},{name:"arrow-color",value:"#999"},{name:"arrow-fill",value:"filled"}].reduce((function(e,t){return Ts.arrowPrefixes.forEach((function(a){var n=a+"-"+t.name,i=t.value;e[n]=i})),e}),{})),a={},n=0;n<this.properties.length;n++){var i=this.properties[n];if(!i.pointsTo){var s=i.name,r=t[s],o=this.parse(s,r);a[s]=o}}return e.defaultProperties=a,e.defaultProperties},Ts.addDefaultStylesheet=function(){this.selector(":parent").css({shape:"rectangle",padding:10,"background-color":"#eee","border-color":"#ccc","border-width":1}).selector("edge").css({width:3}).selector(":loop").css({"curve-style":"bezier"}).selector("edge:compound").css({"curve-style":"bezier","source-endpoint":"outside-to-line","target-endpoint":"outside-to-line"}).selector(":selected").css({"background-color":"#0169D9","line-color":"#0169D9","source-arrow-color":"#0169D9","target-arrow-color":"#0169D9","mid-source-arrow-color":"#0169D9","mid-target-arrow-color":"#0169D9"}).selector(":parent:selected").css({"background-color":"#CCE1F9","border-color":"#aec8e5"}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}),this.defaultLength=this.length};var Cs={parse:function(e,t,a,n){var i=this;if(x(t))return i.parseImplWarn(e,t,a,n);var s,r=Z(e,""+t,a?"t":"f","mapping"===n||!0===n||!1===n||null==n?"dontcare":n),o=i.propCache=i.propCache||[];return(s=o[r])||(s=o[r]=i.parseImplWarn(e,t,a,n)),(a||"mapping"===n)&&(s=pe(s))&&(s.value=pe(s.value)),s},parseImplWarn:function(e,t,a,n){var i=this.parseImpl(e,t,a,n);return i||null==t||ue("The style property `".concat(e,": ").concat(t,"` is invalid")),i}};Cs.parseImpl=function(e,t,a,n){var i=this;e=I(e);var s=i.properties[e],r=t,o=i.types;if(!s)return null;if(void 0===t)return null;s.alias&&(s=s.pointsTo,e=s.name);var l=j(t);l&&(t=t.trim());var c,d,u=s.type;if(!u)return null;if(a&&(""===t||null===t))return{name:e,value:t,bypass:!0,deleteBypass:!0};if(x(t))return{name:e,value:t,strValue:"fn",mapped:o.fn,bypass:a};if(!l||n||t.length<7||"a"!==t[1]);else{if(t.length>=7&&"d"===t[0]&&(c=new RegExp(o.data.regex).exec(t))){if(a)return!1;var p=o.data;return{name:e,value:c,strValue:""+t,mapped:p,field:c[1],bypass:a}}if(t.length>=10&&"m"===t[0]&&(d=new RegExp(o.mapData.regex).exec(t))){if(a)return!1;if(u.multiple)return!1;var m=o.mapData;if(!u.color&&!u.number)return!1;var b=this.parse(e,d[4]);if(!b||b.mapped)return!1;var f=this.parse(e,d[5]);if(!f||f.mapped)return!1;if(b.pfValue===f.pfValue||b.strValue===f.strValue)return ue("`"+e+": "+t+"` is not a valid mapper because the output range is zero; converting to `"+e+": "+b.strValue+"`"),this.parse(e,b.strValue);if(u.color){var h=b.value,g=f.value;if(!(h[0]!==g[0]||h[1]!==g[1]||h[2]!==g[2]||h[3]!==g[3]&&(null!=h[3]&&1!==h[3]||null!=g[3]&&1!==g[3])))return!1}return{name:e,value:d,strValue:""+t,mapped:m,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:b.value,valueMax:f.value,bypass:a}}}if(u.multiple&&"multiple"!==n){var y;if(y=l?t.split(/\s+/):v(t)?t:[t],u.evenMultiple&&y.length%2!=0)return null;for(var E=[],w=[],M=[],S="",_=!1,T=0;T<y.length;T++){var C=i.parse(e,y[T],a,"multiple");_=_||j(C.value),E.push(C.value),M.push(null!=C.pfValue?C.pfValue:C.value),w.push(C.units),S+=(T>0?" ":"")+C.strValue}return u.validate&&!u.validate(E,w)?null:u.singleEnum&&_?1===E.length&&j(E[0])?{name:e,value:E[0],strValue:E[0],bypass:a}:null:{name:e,value:E,pfValue:M,strValue:S,bypass:a,units:w}}var k,F,D=function(){for(var n=0;n<u.enums.length;n++){if(u.enums[n]===t)return{name:e,value:t,strValue:""+t,bypass:a}}return null};if(u.number){var A,L="px";if(u.units&&(A=u.units),u.implicitUnits&&(L=u.implicitUnits),!u.unitless)if(l){var N="px|em"+(u.allowPercent?"|\\%":"");A&&(N=A);var P=t.match("^("+R+")("+N+")?$");P&&(t=P[1],A=P[2]||L)}else A&&!u.implicitUnits||(A=L);if(t=parseFloat(t),isNaN(t)&&void 0===u.enums)return null;if(isNaN(t)&&void 0!==u.enums)return t=r,D();if(u.integer&&(!O(F=t)||Math.floor(F)!==F))return null;if(void 0!==u.min&&(t<u.min||u.strictMin&&t===u.min)||void 0!==u.max&&(t>u.max||u.strictMax&&t===u.max))return null;var B={name:e,value:t,strValue:""+t+(A||""),units:A,bypass:a};return u.unitless||"px"!==A&&"em"!==A?B.pfValue=t:B.pfValue="px"!==A&&A?this.getEmSizeInPixels()*t:t,"ms"!==A&&"s"!==A||(B.pfValue="ms"===A?t:1e3*t),"deg"!==A&&"rad"!==A||(B.pfValue="rad"===A?t:(k=t,Math.PI*k/180)),"%"===A&&(B.pfValue=t/100),B}if(u.propList){var J=[],V=""+t;if("none"===V);else{for(var U=V.split(/\s*,\s*|\s+/),G=0;G<U.length;G++){var q=U[G].trim();i.properties[q]?J.push(q):ue("`"+q+"` is not a valid property name")}if(0===J.length)return null}return{name:e,value:J,strValue:0===J.length?"none":J.join(" "),bypass:a}}if(u.color){var W=z(t);return W?{name:e,value:W,pfValue:W,strValue:"rgb("+W[0]+","+W[1]+","+W[2]+")",bypass:a}:null}if(u.regex||u.regexes){if(u.enums){var H=D();if(H)return H}for(var Y=u.regexes?u.regexes:[u.regex],$=0;$<Y.length;$++){var X=new RegExp(Y[$]).exec(t);if(X)return{name:e,value:u.singleRegexMatchValue?X[1]:X,strValue:""+t,bypass:a}}return null}return u.string?{name:e,value:""+t,strValue:""+t,bypass:a}:u.enums?D():null};var ks=function e(t){if(!(this instanceof e))return new e(t);_(t)?(this._private={cy:t,coreStyle:{}},this.length=0,this.resetToDefault()):ce("A style must have a core reference")},Fs=ks.prototype;Fs.instanceString=function(){return"style"},Fs.clear=function(){for(var e=0;e<this.length;e++)this[e]=void 0;return this.length=0,this._private.newStyle=!0,this},Fs.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this},Fs.core=function(e){return this._private.coreStyle[e]||this.getDefaultProperty(e)},Fs.selector=function(e){var t="core"===e?null:new yn(e),a=this.length++;return this[a]={selector:t,properties:[],mappedProperties:[],index:a},this},Fs.css=function(){var e=this,t=arguments;if(1===t.length)for(var a=t[0],n=0;n<e.properties.length;n++){var i=e.properties[n],s=a[i.name];void 0===s&&(s=a[D(i.name)]),void 0!==s&&this.cssRule(i.name,s)}else 2===t.length&&this.cssRule(t[0],t[1]);return this},Fs.style=Fs.css,Fs.cssRule=function(e,t){var a=this.parse(e,t);if(a){var n=this.length-1;this[n].properties.push(a),this[n].properties[a.name]=a,a.name.match(/pie-(\d+)-background-size/)&&a.value&&(this._private.hasPie=!0),a.mapped&&this[n].mappedProperties.push(a),!this[n].selector&&(this._private.coreStyle[a.name]=a)}return this},Fs.append=function(e){return T(e)?e.appendToStyle(this):v(e)?this.appendFromJson(e):j(e)&&this.appendFromString(e),this},ks.fromJson=function(e,t){var a=new ks(e);return a.fromJson(t),a},ks.fromString=function(e,t){return new ks(e).fromString(t)},[ys,Es,ws,Ms,Ss,_s,Ts,Cs].forEach((function(e){P(Fs,e)})),ks.types=Fs.types,ks.properties=Fs.properties,ks.propertyGroups=Fs.propertyGroups,ks.propertyGroupNames=Fs.propertyGroupNames,ks.propertyGroupKeys=Fs.propertyGroupKeys;var Is={style:function(e){e&&this.setStyle(e).update();return this._private.style},setStyle:function(e){var t=this._private;return T(e)?t.style=e.generateStyle(this):v(e)?t.style=ks.fromJson(this,e):j(e)?t.style=ks.fromString(this,e):t.style=ks(this),t.style}},Ds={autolock:function(e){return void 0===e?this._private.autolock:(this._private.autolock=!!e,this)},autoungrabify:function(e){return void 0===e?this._private.autoungrabify:(this._private.autoungrabify=!!e,this)},autounselectify:function(e){return void 0===e?this._private.autounselectify:(this._private.autounselectify=!!e,this)},selectionType:function(e){var t=this._private;return null==t.selectionType&&(t.selectionType="single"),void 0===e?t.selectionType:("additive"!==e&&"single"!==e||(t.selectionType=e),this)},panningEnabled:function(e){return void 0===e?this._private.panningEnabled:(this._private.panningEnabled=!!e,this)},userPanningEnabled:function(e){return void 0===e?this._private.userPanningEnabled:(this._private.userPanningEnabled=!!e,this)},zoomingEnabled:function(e){return void 0===e?this._private.zoomingEnabled:(this._private.zoomingEnabled=!!e,this)},userZoomingEnabled:function(e){return void 0===e?this._private.userZoomingEnabled:(this._private.userZoomingEnabled=!!e,this)},boxSelectionEnabled:function(e){return void 0===e?this._private.boxSelectionEnabled:(this._private.boxSelectionEnabled=!!e,this)},pan:function(){var e,t,a,n,i,s=arguments,r=this._private.pan;switch(s.length){case 0:return r;case 1:if(j(s[0]))return r[e=s[0]];if(y(s[0])){if(!this._private.panningEnabled)return this;n=(a=s[0]).x,i=a.y,O(n)&&(r.x=n),O(i)&&(r.y=i),this.emit("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;e=s[0],t=s[1],"x"!==e&&"y"!==e||!O(t)||(r[e]=t),this.emit("pan viewport")}return this.notify("viewport"),this},panBy:function(e,t){var a,n,i,s,r,o=arguments,l=this._private.pan;if(!this._private.panningEnabled)return this;switch(o.length){case 1:y(e)&&(s=(i=o[0]).x,r=i.y,O(s)&&(l.x+=s),O(r)&&(l.y+=r),this.emit("pan viewport"));break;case 2:n=t,"x"!==(a=e)&&"y"!==a||!O(n)||(l[a]+=n),this.emit("pan viewport")}return this.notify("viewport"),this},fit:function(e,t){var a=this.getFitViewport(e,t);if(a){var n=this._private;n.zoom=a.zoom,n.pan=a.pan,this.emit("pan zoom viewport"),this.notify("viewport")}return this},getFitViewport:function(e,t){if(O(e)&&void 0===t&&(t=e,e=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){var a,n;if(j(e)){var i=e;e=this.$(i)}else if(y(n=e)&&O(n.x1)&&O(n.x2)&&O(n.y1)&&O(n.y2)){var s=e;(a={x1:s.x1,y1:s.y1,x2:s.x2,y2:s.y2}).w=a.x2-a.x1,a.h=a.y2-a.y1}else w(e)||(e=this.mutableElements());if(!w(e)||!e.empty()){a=a||e.boundingBox();var r,o=this.width(),l=this.height();if(t=O(t)?t:0,!isNaN(o)&&!isNaN(l)&&o>0&&l>0&&!isNaN(a.w)&&!isNaN(a.h)&&a.w>0&&a.h>0)return{zoom:r=(r=(r=Math.min((o-2*t)/a.w,(l-2*t)/a.h))>this._private.maxZoom?this._private.maxZoom:r)<this._private.minZoom?this._private.minZoom:r,pan:{x:(o-r*(a.x1+a.x2))/2,y:(l-r*(a.y1+a.y2))/2}}}}},zoomRange:function(e,t){var a=this._private;if(null==t){var n=e;e=n.min,t=n.max}return O(e)&&O(t)&&e<=t?(a.minZoom=e,a.maxZoom=t):O(e)&&void 0===t&&e<=a.maxZoom?a.minZoom=e:O(t)&&void 0===e&&t>=a.minZoom&&(a.maxZoom=t),this},minZoom:function(e){return void 0===e?this._private.minZoom:this.zoomRange({min:e})},maxZoom:function(e){return void 0===e?this._private.maxZoom:this.zoomRange({max:e})},getZoomedViewport:function(e){var t,a,n=this._private,i=n.pan,s=n.zoom,r=!1;if(n.zoomingEnabled||(r=!0),O(e)?a=e:y(e)&&(a=e.level,null!=e.position?t=Be(e.position,s,i):null!=e.renderedPosition&&(t=e.renderedPosition),null==t||n.panningEnabled||(r=!0)),a=(a=a>n.maxZoom?n.maxZoom:a)<n.minZoom?n.minZoom:a,r||!O(a)||a===s||null!=t&&(!O(t.x)||!O(t.y)))return null;if(null!=t){var o=i,l=s,c=a;return{zoomed:!0,panned:!0,zoom:c,pan:{x:-c/l*(t.x-o.x)+t.x,y:-c/l*(t.y-o.y)+t.y}}}return{zoomed:!0,panned:!1,zoom:a,pan:i}},zoom:function(e){if(void 0===e)return this._private.zoom;var t=this.getZoomedViewport(e),a=this._private;return null!=t&&t.zoomed?(a.zoom=t.zoom,t.panned&&(a.pan.x=t.pan.x,a.pan.y=t.pan.y),this.emit("zoom"+(t.panned?" pan":"")+" viewport"),this.notify("viewport"),this):this},viewport:function(e){var t=this._private,a=!0,n=!0,i=[],s=!1,r=!1;if(!e)return this;if(O(e.zoom)||(a=!1),y(e.pan)||(n=!1),!a&&!n)return this;if(a){var o=e.zoom;o<t.minZoom||o>t.maxZoom||!t.zoomingEnabled?s=!0:(t.zoom=o,i.push("zoom"))}if(n&&(!s||!e.cancelOnFailedZoom)&&t.panningEnabled){var l=e.pan;O(l.x)&&(t.pan.x=l.x,r=!1),O(l.y)&&(t.pan.y=l.y,r=!1),r||i.push("pan")}return i.length>0&&(i.push("viewport"),this.emit(i.join(" ")),this.notify("viewport")),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.emit("pan viewport"),this.notify("viewport")),this},getCenterPan:function(e,t){if(this._private.panningEnabled){if(j(e)){var a=e;e=this.mutableElements().filter(a)}else w(e)||(e=this.mutableElements());if(0!==e.length){var n=e.boundingBox(),i=this.width(),s=this.height();return{x:(i-(t=void 0===t?this._private.zoom:t)*(n.x1+n.x2))/2,y:(s-t*(n.y1+n.y2))/2}}}},reset:function(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},invalidateSize:function(){this._private.sizeCache=null},size:function(){var e,t,a=this._private,n=a.container;return a.sizeCache=a.sizeCache||(n?(e=u.getComputedStyle(n),t=function(t){return parseFloat(e.getPropertyValue(t))},{width:n.clientWidth-t("padding-left")-t("padding-right"),height:n.clientHeight-t("padding-top")-t("padding-bottom")}):{width:1,height:1})},width:function(){return this.size().width},height:function(){return this.size().height},extent:function(){var e=this._private.pan,t=this._private.zoom,a=this.renderedExtent(),n={x1:(a.x1-e.x)/t,x2:(a.x2-e.x)/t,y1:(a.y1-e.y)/t,y2:(a.y2-e.y)/t};return n.w=n.x2-n.x1,n.h=n.y2-n.y1,n},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}}};Ds.centre=Ds.center,Ds.autolockNodes=Ds.autolock,Ds.autoungrabifyNodes=Ds.autoungrabify;var As={data:Na.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0}),removeData:Na.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0}),scratch:Na.data({field:"scratch",bindingEvent:"scratch",allowBinding:!0,allowSetting:!0,settingEvent:"scratch",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0}),removeScratch:Na.removeData({field:"scratch",event:"scratch",triggerFnName:"trigger",triggerEvent:!0})};As.attr=As.data,As.removeAttr=As.removeData;var Ls=function(e){var t=this,a=(e=P({},e)).container;a&&!E(a)&&E(a[0])&&(a=a[0]);var n=a?a._cyreg:null;(n=n||{})&&n.cy&&(n.cy.destroy(),n={});var i=n.readies=n.readies||[];a&&(a._cyreg=n),n.cy=t;var s=void 0!==u&&void 0!==a&&!e.headless,r=e;r.layout=P({name:s?"grid":"null"},r.layout),r.renderer=P({name:s?"canvas":"null"},r.renderer);var o=function(e,t,a){return void 0!==t?t:void 0!==a?a:e},l=this._private={container:a,ready:!1,options:r,elements:new Qi(this),listeners:[],aniEles:new Qi(this),data:{},scratch:{},layout:null,renderer:null,destroyed:!1,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:o(!0,r.zoomingEnabled),userZoomingEnabled:o(!0,r.userZoomingEnabled),panningEnabled:o(!0,r.panningEnabled),userPanningEnabled:o(!0,r.userPanningEnabled),boxSelectionEnabled:o(!0,r.boxSelectionEnabled),autolock:o(!1,r.autolock,r.autolockNodes),autoungrabify:o(!1,r.autoungrabify,r.autoungrabifyNodes),autounselectify:o(!1,r.autounselectify),styleEnabled:void 0===r.styleEnabled?s:r.styleEnabled,zoom:O(r.zoom)?r.zoom:1,pan:{x:y(r.pan)&&O(r.pan.x)?r.pan.x:0,y:y(r.pan)&&O(r.pan.y)?r.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1};this.createEmitter(),this.selectionType(r.selectionType),this.zoomRange({min:r.minZoom,max:r.maxZoom});l.styleEnabled&&t.setStyle([]);var c=P({},r,r.renderer);t.initRenderer(c);!function(e,t){if(e.some(k))return Aa.all(e).then(t);t(e)}([r.style,r.elements],(function(e){var a=e[0],s=e[1];l.styleEnabled&&t.style().append(a),function(e,a,n){t.notifications(!1);var i=t.mutableElements();i.length>0&&i.remove(),null!=e&&(y(e)||v(e))&&t.add(e),t.one("layoutready",(function(e){t.notifications(!0),t.emit(e),t.one("load",a),t.emitAndNotify("load")})).one("layoutstop",(function(){t.one("done",n),t.emit("done")}));var s=P({},t._private.options.layout);s.eles=t.elements(),t.layout(s).run()}(s,(function(){t.startAnimationLoop(),l.ready=!0,x(r.ready)&&t.on("ready",r.ready);for(var e=0;e<i.length;e++){var a=i[e];t.on("ready",a)}n&&(n.readies=[]),t.emit("ready")}),r.done)}))},Rs=Ls.prototype;P(Rs,{instanceString:function(){return"core"},isReady:function(){return this._private.ready},destroyed:function(){return this._private.destroyed},ready:function(e){return this.isReady()?this.emitter().emit("ready",[],e):this.on("ready",e),this},destroy:function(){var e=this;if(!e.destroyed())return e.stopAnimationLoop(),e.destroyRenderer(),this.emit("destroy"),e._private.destroyed=!0,e},hasElementWithId:function(e){return this._private.elements.hasElementWithId(e)},getElementById:function(e){return this._private.elements.getElementById(e)},hasCompoundNodes:function(){return this._private.hasCompoundNodes},headless:function(){return this._private.renderer.isHeadless()},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){return this._private.elements.merge(e),this},removeFromPool:function(e){return this._private.elements.unmerge(e),this},container:function(){return this._private.container||null},mount:function(e){if(null!=e){var t=this,a=t._private,n=a.options;return!E(e)&&E(e[0])&&(e=e[0]),t.stopAnimationLoop(),t.destroyRenderer(),a.container=e,a.styleEnabled=!0,t.invalidateSize(),t.initRenderer(P({},n,n.renderer,{name:"null"===n.renderer.name?"canvas":n.renderer.name})),t.startAnimationLoop(),t.style(n.style),t.emit("mount"),t}},unmount:function(){var e=this;return e.stopAnimationLoop(),e.destroyRenderer(),e.initRenderer({name:"null"}),e.emit("unmount"),e},options:function(){return pe(this._private.options)},json:function(e){var t=this,a=t._private,n=t.mutableElements();if(y(e)){if(t.startBatch(),e.elements){var i={},s=function(e,a){for(var n=[],s=[],r=0;r<e.length;r++){var o=e[r],l=""+o.data.id,c=t.getElementById(l);i[l]=!0,0!==c.length?s.push({ele:c,json:o}):a?(o.group=a,n.push(o)):n.push(o)}t.add(n);for(var d=0;d<s.length;d++){var u=s[d],p=u.ele,m=u.json;p.json(m)}};if(v(e.elements))s(e.elements);else for(var r=["nodes","edges"],o=0;o<r.length;o++){var l=r[o],c=e.elements[l];v(c)&&s(c,l)}var d=t.collection();n.filter((function(e){return!i[e.id()]})).forEach((function(e){e.isParent()?d.merge(e):e.remove()})),d.forEach((function(e){return e.children().move({parent:null})})),d.forEach((function(e){return function(e){return t.getElementById(e.id())}(e).remove()}))}e.style&&t.style(e.style),null!=e.zoom&&e.zoom!==a.zoom&&t.zoom(e.zoom),e.pan&&(e.pan.x===a.pan.x&&e.pan.y===a.pan.y||t.pan(e.pan)),e.data&&t.data(e.data);for(var u=["minZoom","maxZoom","zoomingEnabled","userZoomingEnabled","panningEnabled","userPanningEnabled","boxSelectionEnabled","autolock","autoungrabify","autounselectify"],p=0;p<u.length;p++){var m=u[p];null!=e[m]&&t[m](e[m])}return t.endBatch(),this}var b={};!!e?b.elements=this.elements().map((function(e){return e.json()})):(b.elements={},n.forEach((function(e){var t=e.group();b.elements[t]||(b.elements[t]=[]),b.elements[t].push(e.json())}))),this._private.styleEnabled&&(b.style=t.style().json()),b.data=pe(t.data());var f=a.options;return b.zoomingEnabled=a.zoomingEnabled,b.userZoomingEnabled=a.userZoomingEnabled,b.zoom=a.zoom,b.minZoom=a.minZoom,b.maxZoom=a.maxZoom,b.panningEnabled=a.panningEnabled,b.userPanningEnabled=a.userPanningEnabled,b.pan=pe(a.pan),b.boxSelectionEnabled=a.boxSelectionEnabled,b.renderer=pe(f.renderer),b.hideEdgesOnViewport=f.hideEdgesOnViewport,b.textureOnViewport=f.textureOnViewport,b.wheelSensitivity=f.wheelSensitivity,b.motionBlur=f.motionBlur,b}}),Rs.$id=Rs.getElementById,[es,us,bs,fs,hs,gs,xs,vs,Is,Ds,As].forEach((function(e){P(Rs,e)}));var Ns={fit:!0,directed:!1,padding:30,circle:!1,grid:!1,spacingFactor:1.75,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,roots:void 0,maximal:!1,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}},Ps=function(e){return e.scratch("breadthfirst")},zs=function(e,t){return e.scratch("breadthfirst",t)};function Bs(e){this.options=P({},Ns,e)}Bs.prototype.run=function(){var e,t=this.options,a=t,n=t.cy,i=a.eles,s=i.nodes().filter((function(e){return!e.isParent()})),r=i,o=a.directed,l=a.maximal||a.maximalAdjustments>0,c=Qe(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});if(w(a.roots))e=a.roots;else if(v(a.roots)){for(var d=[],u=0;u<a.roots.length;u++){var p=a.roots[u],m=n.getElementById(p);d.push(m)}e=n.collection(d)}else if(j(a.roots))e=n.$(a.roots);else if(o)e=s.roots();else{var b=i.components();e=n.collection();for(var f=function(t){var a=b[t],n=a.maxDegree(!1),i=a.filter((function(e){return e.degree(!1)===n}));e=e.add(i)},h=0;h<b.length;h++)f(h)}var g=[],x={},y=function(e,t){null==g[t]&&(g[t]=[]);var a=g[t].length;g[t].push(e),zs(e,{index:a,depth:t})};r.bfs({roots:e,directed:a.directed,visit:function(e,t,a,n,i){var s=e[0],r=s.id();y(s,i),x[r]=!0}});for(var O=[],E=0;E<s.length;E++){var M=s[E];x[M.id()]||O.push(M)}var S=function(e){for(var t=g[e],a=0;a<t.length;a++){var n=t[a];null!=n?zs(n,{depth:e,index:a}):(t.splice(a,1),a--)}},_=function(){for(var e=0;e<g.length;e++)S(e)},T=function(e,t){for(var a=Ps(e),n=e.incomers().filter((function(e){return e.isNode()&&i.has(e)})),s=-1,r=e.id(),o=0;o<n.length;o++){var l=n[o],c=Ps(l);s=Math.max(s,c.depth)}return a.depth<=s&&(t[r]?null:(function(e,t){var a=Ps(e),n=a.depth,i=a.index;g[n][i]=null,y(e,t)}(e,s+1),t[r]=!0,!0))};if(o&&l){var C=[],k={},F=function(e){return C.push(e)};for(s.forEach((function(e){return C.push(e)}));C.length>0;){var I=C.shift(),D=T(I,k);if(D)I.outgoers().filter((function(e){return e.isNode()&&i.has(e)})).forEach(F);else if(null===D){ue("Detected double maximal shift for node `"+I.id()+"`.  Bailing maximal adjustment due to cycle.  Use `options.maximal: true` only on DAGs.");break}}}_();var A=0;if(a.avoidOverlap)for(var L=0;L<s.length;L++){var R=s[L].layoutDimensions(a),P=R.w,z=R.h;A=Math.max(A,P,z)}for(var B={},J=function(e){if(B[e.id()])return B[e.id()];for(var t=Ps(e).depth,a=e.neighborhood(),n=0,i=0,r=0;r<a.length;r++){var o=a[r];if(!o.isEdge()&&!o.isParent()&&s.has(o)){var l=Ps(o),c=l.index,d=l.depth;if(null!=c&&null!=d){var u=g[d].length;d<t&&(n+=c/u,i++)}}}return n/=i=Math.max(1,i),0===i&&(n=0),B[e.id()]=n,n},V=function(e,t){var a=J(e)-J(t);return 0===a?N(e.id(),t.id()):a},U=0;U<g.length;U++)g[U].sort(V),S(U);for(var G=[],q=0;q<O.length;q++)G.push(O[q]);g.unshift(G),_();for(var W=0,H=0;H<g.length;H++)W=Math.max(g[H].length,W);var Y=c.x1+c.w/2,$=c.x1+c.h/2,X=g.reduce((function(e,t){return Math.max(e,t.length)}),0);return s.layoutPositions(this,a,(function(e){var t=Ps(e),n=t.depth,i=t.index,s=g[n].length,r=Math.max(c.w/((a.grid?X:s)+1),A),o=Math.max(c.h/(g.length+1),A),l=Math.min(c.w/2/g.length,c.h/2/g.length);if(l=Math.max(l,A),a.circle){var d=l*n+l-(g.length>0&&g[0].length<=3?l/2:0),u=2*Math.PI/g[n].length*i;return 0===n&&1===g[0].length&&(d=1),{x:Y+d*Math.cos(u),y:$+d*Math.sin(u)}}return{x:Y+(i+1-(s+1)/2)*r,y:(n+1)*o}})),this};var Js={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,radius:void 0,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function Vs(e){this.options=P({},Js,e)}Vs.prototype.run=function(){var e=this.options,t=e,a=e.cy,n=t.eles,i=void 0!==t.counterclockwise?!t.counterclockwise:t.clockwise,s=n.nodes().not(":parent");t.sort&&(s=s.sort(t.sort));for(var r,o=Qe(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()}),l=o.x1+o.w/2,c=o.y1+o.h/2,d=(void 0===t.sweep?2*Math.PI-2*Math.PI/s.length:t.sweep)/Math.max(1,s.length-1),u=0,p=0;p<s.length;p++){var m=s[p].layoutDimensions(t),b=m.w,f=m.h;u=Math.max(u,b,f)}if(r=O(t.radius)?t.radius:s.length<=1?0:Math.min(o.h,o.w)/2-u,s.length>1&&t.avoidOverlap){u*=1.75;var h=Math.cos(d)-Math.cos(0),g=Math.sin(d)-Math.sin(0),j=Math.sqrt(u*u/(h*h+g*g));r=Math.max(j,r)}return s.layoutPositions(this,t,(function(e,a){var n=t.startAngle+a*d*(i?1:-1),s=r*Math.cos(n),o=r*Math.sin(n);return{x:l+s,y:c+o}})),this};var Us,Gs={fit:!0,padding:30,startAngle:1.5*Math.PI,sweep:void 0,clockwise:!0,equidistant:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,nodeDimensionsIncludeLabels:!1,height:void 0,width:void 0,spacingFactor:void 0,concentric:function(e){return e.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function qs(e){this.options=P({},Gs,e)}qs.prototype.run=function(){for(var e=this.options,t=e,a=void 0!==t.counterclockwise?!t.counterclockwise:t.clockwise,n=e.cy,i=t.eles.nodes().not(":parent"),s=Qe(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()}),r=s.x1+s.w/2,o=s.y1+s.h/2,l=[],c=0,d=0;d<i.length;d++){var u,p=i[d];u=t.concentric(p),l.push({value:u,node:p}),p._private.scratch.concentric=u}i.updateStyle();for(var m=0;m<i.length;m++){var b=i[m].layoutDimensions(t);c=Math.max(c,b.w,b.h)}l.sort((function(e,t){return t.value-e.value}));for(var f=t.levelWidth(i),h=[[]],g=h[0],j=0;j<l.length;j++){var x=l[j];if(g.length>0)Math.abs(g[0].value-x.value)>=f&&(g=[],h.push(g));g.push(x)}var v=c+t.minNodeSpacing;if(!t.avoidOverlap){var y=h.length>0&&h[0].length>1,O=(Math.min(s.w,s.h)/2-v)/(h.length+y?1:0);v=Math.min(v,O)}for(var E=0,w=0;w<h.length;w++){var M=h[w],S=void 0===t.sweep?2*Math.PI-2*Math.PI/M.length:t.sweep,_=M.dTheta=S/Math.max(1,M.length-1);if(M.length>1&&t.avoidOverlap){var T=Math.cos(_)-Math.cos(0),C=Math.sin(_)-Math.sin(0),k=Math.sqrt(v*v/(T*T+C*C));E=Math.max(k,E)}M.r=E,E+=v}if(t.equidistant){for(var F=0,I=0,D=0;D<h.length;D++){var A=h[D].r-I;F=Math.max(F,A)}I=0;for(var L=0;L<h.length;L++){var R=h[L];0===L&&(I=R.r),R.r=I,I+=F}}for(var N={},P=0;P<h.length;P++)for(var z=h[P],B=z.dTheta,J=z.r,V=0;V<z.length;V++){var U=z[V],G=t.startAngle+(a?1:-1)*B*V,q={x:r+J*Math.cos(G),y:o+J*Math.sin(G)};N[U.node.id()]=q}return i.layoutPositions(this,t,(function(e){var t=e.id();return N[t]})),this};var Ws={ready:function(){},stop:function(){},animate:!0,animationEasing:void 0,animationDuration:void 0,animateFilter:function(e,t){return!0},animationThreshold:250,refresh:20,fit:!0,padding:30,boundingBox:void 0,nodeDimensionsIncludeLabels:!1,randomize:!1,componentSpacing:40,nodeRepulsion:function(e){return 2048},nodeOverlap:4,idealEdgeLength:function(e){return 32},edgeElasticity:function(e){return 32},nestingFactor:1.2,gravity:1,numIter:1e3,initialTemp:1e3,coolingFactor:.99,minTemp:1};function Hs(e){this.options=P({},Ws,e),this.options.layout=this}Hs.prototype.run=function(){var e=this.options,t=e.cy,a=this;a.stopped=!1,!0!==e.animate&&!1!==e.animate||a.emit({type:"layoutstart",layout:a}),Us=!0===e.debug;var n=Ys(t,a,e);Us&&undefined(n),e.randomize&&Ks(n);var i=H(),s=function(){Zs(n,t,e),!0===e.fit&&t.fit(e.padding)},r=function(t){return!(a.stopped||t>=e.numIter)&&(er(n,e),n.temperature=n.temperature*e.coolingFactor,!(n.temperature<e.minTemp))},o=function(){if(!0===e.animate||!1===e.animate)s(),a.one("layoutstop",e.stop),a.emit({type:"layoutstop",layout:a});else{var t=e.eles.nodes(),i=Qs(n,e,t);t.layoutPositions(a,e,i)}},l=0,c=!0;if(!0===e.animate){!function t(){for(var a=0;c&&a<e.refresh;)c=r(l),l++,a++;c?(H()-i>=e.animationThreshold&&s(),W(t)):(pr(n,e),o())}()}else{for(;c;)c=r(l),l++;pr(n,e),o()}return this},Hs.prototype.stop=function(){return this.stopped=!0,this.thread&&this.thread.stop(),this.emit("layoutstop"),this},Hs.prototype.destroy=function(){return this.thread&&this.thread.stop(),this};var Ys=function(e,t,a){for(var n=a.eles.edges(),i=a.eles.nodes(),s={isCompound:e.hasCompoundNodes(),layoutNodes:[],idToIndex:{},nodeSize:i.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:n.size(),temperature:a.initialTemp,clientWidth:e.width(),clientHeight:e.width(),boundingBox:Qe(a.boundingBox?a.boundingBox:{x1:0,y1:0,w:e.width(),h:e.height()})},r=a.eles.components(),o={},l=0;l<r.length;l++)for(var c=r[l],d=0;d<c.length;d++){o[c[d].id()]=l}for(l=0;l<s.nodeSize;l++){var u=(h=i[l]).layoutDimensions(a);(D={}).isLocked=h.locked(),D.id=h.data("id"),D.parentId=h.data("parent"),D.cmptId=o[h.id()],D.children=[],D.positionX=h.position("x"),D.positionY=h.position("y"),D.offsetX=0,D.offsetY=0,D.height=u.w,D.width=u.h,D.maxX=D.positionX+D.width/2,D.minX=D.positionX-D.width/2,D.maxY=D.positionY+D.height/2,D.minY=D.positionY-D.height/2,D.padLeft=parseFloat(h.style("padding")),D.padRight=parseFloat(h.style("padding")),D.padTop=parseFloat(h.style("padding")),D.padBottom=parseFloat(h.style("padding")),D.nodeRepulsion=x(a.nodeRepulsion)?a.nodeRepulsion(h):a.nodeRepulsion,s.layoutNodes.push(D),s.idToIndex[D.id]=l}var p=[],m=0,b=-1,f=[];for(l=0;l<s.nodeSize;l++){var h,g=(h=s.layoutNodes[l]).parentId;null!=g?s.layoutNodes[s.idToIndex[g]].children.push(h.id):(p[++b]=h.id,f.push(h.id))}for(s.graphSet.push(f);m<=b;){var j=p[m++],v=s.idToIndex[j],y=s.layoutNodes[v].children;if(y.length>0){s.graphSet.push(y);for(l=0;l<y.length;l++)p[++b]=y[l]}}for(l=0;l<s.graphSet.length;l++){var O=s.graphSet[l];for(d=0;d<O.length;d++){var E=s.idToIndex[O[d]];s.indexToGraph[E]=l}}for(l=0;l<s.edgeSize;l++){var w=n[l],M={};M.id=w.data("id"),M.sourceId=w.data("source"),M.targetId=w.data("target");var S=x(a.idealEdgeLength)?a.idealEdgeLength(w):a.idealEdgeLength,_=x(a.edgeElasticity)?a.edgeElasticity(w):a.edgeElasticity,T=s.idToIndex[M.sourceId],C=s.idToIndex[M.targetId];if(s.indexToGraph[T]!=s.indexToGraph[C]){for(var k=$s(M.sourceId,M.targetId,s),F=s.graphSet[k],I=0,D=s.layoutNodes[T];-1===F.indexOf(D.id);)D=s.layoutNodes[s.idToIndex[D.parentId]],I++;for(D=s.layoutNodes[C];-1===F.indexOf(D.id);)D=s.layoutNodes[s.idToIndex[D.parentId]],I++;S*=I*a.nestingFactor}M.idealLength=S,M.elasticity=_,s.layoutEdges.push(M)}return s},$s=function(e,t,a){var n=Xs(e,t,0,a);return 2>n.count?0:n.graph},Xs=function e(t,a,n,i){var s=i.graphSet[n];if(-1<s.indexOf(t)&&-1<s.indexOf(a))return{count:2,graph:n};for(var r=0,o=0;o<s.length;o++){var l=s[o],c=i.idToIndex[l],d=i.layoutNodes[c].children;if(0!==d.length){var u=e(t,a,i.indexToGraph[i.idToIndex[d[0]]],i);if(0!==u.count){if(1!==u.count)return u;if(2===++r)break}}}return{count:r,graph:n}},Ks=function(e,t){for(var a=e.clientWidth,n=e.clientHeight,i=0;i<e.nodeSize;i++){var s=e.layoutNodes[i];0!==s.children.length||s.isLocked||(s.positionX=Math.random()*a,s.positionY=Math.random()*n)}},Qs=function(e,t,a){var n=e.boundingBox,i={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};return t.boundingBox&&(a.forEach((function(t){var a=e.layoutNodes[e.idToIndex[t.data("id")]];i.x1=Math.min(i.x1,a.positionX),i.x2=Math.max(i.x2,a.positionX),i.y1=Math.min(i.y1,a.positionY),i.y2=Math.max(i.y2,a.positionY)})),i.w=i.x2-i.x1,i.h=i.y2-i.y1),function(a,s){var r=e.layoutNodes[e.idToIndex[a.data("id")]];if(t.boundingBox){var o=(r.positionX-i.x1)/i.w,l=(r.positionY-i.y1)/i.h;return{x:n.x1+o*n.w,y:n.y1+l*n.h}}return{x:r.positionX,y:r.positionY}}},Zs=function(e,t,a){var n=a.layout,i=a.eles.nodes(),s=Qs(e,a,i);i.positions(s),!0!==e.ready&&(e.ready=!0,n.one("layoutready",a.ready),n.emit({type:"layoutready",layout:this}))},er=function(e,t,a){tr(e,t),rr(e),or(e,t),lr(e),cr(e)},tr=function(e,t){for(var a=0;a<e.graphSet.length;a++)for(var n=e.graphSet[a],i=n.length,s=0;s<i;s++)for(var r=e.layoutNodes[e.idToIndex[n[s]]],o=s+1;o<i;o++){var l=e.layoutNodes[e.idToIndex[n[o]]];nr(r,l,e,t)}},ar=function(e){return-e+2*e*Math.random()},nr=function(e,t,a,n){if(e.cmptId===t.cmptId||a.isCompound){var i=t.positionX-e.positionX,s=t.positionY-e.positionY;0===i&&0===s&&(i=ar(1),s=ar(1));var r=ir(e,t,i,s);if(r>0)var o=(c=n.nodeOverlap*r)*i/(f=Math.sqrt(i*i+s*s)),l=c*s/f;else{var c,d=sr(e,i,s),u=sr(t,-1*i,-1*s),p=u.x-d.x,m=u.y-d.y,b=p*p+m*m,f=Math.sqrt(b);o=(c=(e.nodeRepulsion+t.nodeRepulsion)/b)*p/f,l=c*m/f}e.isLocked||(e.offsetX-=o,e.offsetY-=l),t.isLocked||(t.offsetX+=o,t.offsetY+=l)}},ir=function(e,t,a,n){if(a>0)var i=e.maxX-t.minX;else i=t.maxX-e.minX;if(n>0)var s=e.maxY-t.minY;else s=t.maxY-e.minY;return i>=0&&s>=0?Math.sqrt(i*i+s*s):0},sr=function(e,t,a){var n=e.positionX,i=e.positionY,s=e.height||1,r=e.width||1,o=a/t,l=s/r,c={};return 0===t&&0<a||0===t&&0>a?(c.x=n,c.y=i+s/2,c):0<t&&-1*l<=o&&o<=l?(c.x=n+r/2,c.y=i+r*a/2/t,c):0>t&&-1*l<=o&&o<=l?(c.x=n-r/2,c.y=i-r*a/2/t,c):0<a&&(o<=-1*l||o>=l)?(c.x=n+s*t/2/a,c.y=i+s/2,c):0>a&&(o<=-1*l||o>=l)?(c.x=n-s*t/2/a,c.y=i-s/2,c):c},rr=function(e,t){for(var a=0;a<e.edgeSize;a++){var n=e.layoutEdges[a],i=e.idToIndex[n.sourceId],s=e.layoutNodes[i],r=e.idToIndex[n.targetId],o=e.layoutNodes[r],l=o.positionX-s.positionX,c=o.positionY-s.positionY;if(0!==l||0!==c){var d=sr(s,l,c),u=sr(o,-1*l,-1*c),p=u.x-d.x,m=u.y-d.y,b=Math.sqrt(p*p+m*m),f=Math.pow(n.idealLength-b,2)/n.elasticity;if(0!==b)var h=f*p/b,g=f*m/b;else h=0,g=0;s.isLocked||(s.offsetX+=h,s.offsetY+=g),o.isLocked||(o.offsetX-=h,o.offsetY-=g)}}},or=function(e,t){for(var a=0;a<e.graphSet.length;a++){var n=e.graphSet[a],i=n.length;if(0===a)var s=e.clientHeight/2,r=e.clientWidth/2;else{var o=e.layoutNodes[e.idToIndex[n[0]]],l=e.layoutNodes[e.idToIndex[o.parentId]];s=l.positionX,r=l.positionY}for(var c=0;c<i;c++){var d=e.layoutNodes[e.idToIndex[n[c]]];if(!d.isLocked){var u=s-d.positionX,p=r-d.positionY,m=Math.sqrt(u*u+p*p);if(m>1){var b=t.gravity*u/m,f=t.gravity*p/m;d.offsetX+=b,d.offsetY+=f}}}}},lr=function(e,t){var a=[],n=0,i=-1;for(a.push.apply(a,e.graphSet[0]),i+=e.graphSet[0].length;n<=i;){var s=a[n++],r=e.idToIndex[s],o=e.layoutNodes[r],l=o.children;if(0<l.length&&!o.isLocked){for(var c=o.offsetX,d=o.offsetY,u=0;u<l.length;u++){var p=e.layoutNodes[e.idToIndex[l[u]]];p.offsetX+=c,p.offsetY+=d,a[++i]=l[u]}o.offsetX=0,o.offsetY=0}}},cr=function(e,t){for(var a=0;a<e.nodeSize;a++){0<(i=e.layoutNodes[a]).children.length&&(i.maxX=void 0,i.minX=void 0,i.maxY=void 0,i.minY=void 0)}for(a=0;a<e.nodeSize;a++){if(!(0<(i=e.layoutNodes[a]).children.length||i.isLocked)){var n=dr(i.offsetX,i.offsetY,e.temperature);i.positionX+=n.x,i.positionY+=n.y,i.offsetX=0,i.offsetY=0,i.minX=i.positionX-i.width,i.maxX=i.positionX+i.width,i.minY=i.positionY-i.height,i.maxY=i.positionY+i.height,ur(i,e)}}for(a=0;a<e.nodeSize;a++){var i;0<(i=e.layoutNodes[a]).children.length&&!i.isLocked&&(i.positionX=(i.maxX+i.minX)/2,i.positionY=(i.maxY+i.minY)/2,i.width=i.maxX-i.minX,i.height=i.maxY-i.minY)}},dr=function(e,t,a){var n=Math.sqrt(e*e+t*t);if(n>a)var i={x:a*e/n,y:a*t/n};else i={x:e,y:t};return i},ur=function e(t,a){var n=t.parentId;if(null!=n){var i=a.layoutNodes[a.idToIndex[n]],s=!1;return(null==i.maxX||t.maxX+i.padRight>i.maxX)&&(i.maxX=t.maxX+i.padRight,s=!0),(null==i.minX||t.minX-i.padLeft<i.minX)&&(i.minX=t.minX-i.padLeft,s=!0),(null==i.maxY||t.maxY+i.padBottom>i.maxY)&&(i.maxY=t.maxY+i.padBottom,s=!0),(null==i.minY||t.minY-i.padTop<i.minY)&&(i.minY=t.minY-i.padTop,s=!0),s?e(i,a):void 0}},pr=function(e,t){for(var a=e.layoutNodes,n=[],i=0;i<a.length;i++){var s=a[i],r=s.cmptId;(n[r]=n[r]||[]).push(s)}var o=0;for(i=0;i<n.length;i++){if(f=n[i]){f.x1=1/0,f.x2=-1/0,f.y1=1/0,f.y2=-1/0;for(var l=0;l<f.length;l++){var c=f[l];f.x1=Math.min(f.x1,c.positionX-c.width/2),f.x2=Math.max(f.x2,c.positionX+c.width/2),f.y1=Math.min(f.y1,c.positionY-c.height/2),f.y2=Math.max(f.y2,c.positionY+c.height/2)}f.w=f.x2-f.x1,f.h=f.y2-f.y1,o+=f.w*f.h}}n.sort((function(e,t){return t.w*t.h-e.w*e.h}));var d=0,u=0,p=0,m=0,b=Math.sqrt(o)*e.clientWidth/e.clientHeight;for(i=0;i<n.length;i++){var f;if(f=n[i]){for(l=0;l<f.length;l++){(c=f[l]).isLocked||(c.positionX+=d-f.x1,c.positionY+=u-f.y1)}d+=f.w+t.componentSpacing,p+=f.w+t.componentSpacing,m=Math.max(m,f.h),p>b&&(u+=m+t.componentSpacing,d=0,p=0,m=0)}}},mr={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,avoidOverlapPadding:10,nodeDimensionsIncludeLabels:!1,spacingFactor:void 0,condense:!1,rows:void 0,cols:void 0,position:function(e){},sort:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function br(e){this.options=P({},mr,e)}br.prototype.run=function(){var e=this.options,t=e,a=e.cy,n=t.eles.nodes().not(":parent");t.sort&&(n=n.sort(t.sort));var i=Qe(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:a.width(),h:a.height()});if(0===i.h||0===i.w)n.layoutPositions(this,t,(function(e){return{x:i.x1,y:i.y1}}));else{var s=n.size(),r=Math.sqrt(s*i.h/i.w),o=Math.round(r),l=Math.round(i.w/i.h*r),c=function(e){if(null==e)return Math.min(o,l);Math.min(o,l)==o?o=e:l=e},d=function(e){if(null==e)return Math.max(o,l);Math.max(o,l)==o?o=e:l=e},u=t.rows,p=null!=t.cols?t.cols:t.columns;if(null!=u&&null!=p)o=u,l=p;else if(null!=u&&null==p)o=u,l=Math.ceil(s/o);else if(null==u&&null!=p)l=p,o=Math.ceil(s/l);else if(l*o>s){var m=c(),b=d();(m-1)*b>=s?c(m-1):(b-1)*m>=s&&d(b-1)}else for(;l*o<s;){var f=c(),h=d();(h+1)*f>=s?d(h+1):c(f+1)}var g=i.w/l,j=i.h/o;if(t.condense&&(g=0,j=0),t.avoidOverlap)for(var x=0;x<n.length;x++){var v=n[x],y=v._private.position;null!=y.x&&null!=y.y||(y.x=0,y.y=0);var O=v.layoutDimensions(t),E=t.avoidOverlapPadding,w=O.w+E,M=O.h+E;g=Math.max(g,w),j=Math.max(j,M)}for(var S={},_=function(e,t){return!!S["c-"+e+"-"+t]},T=function(e,t){S["c-"+e+"-"+t]=!0},C=0,k=0,F=function(){++k>=l&&(k=0,C++)},I={},D=0;D<n.length;D++){var A=n[D],L=t.position(A);if(L&&(void 0!==L.row||void 0!==L.col)){var R={row:L.row,col:L.col};if(void 0===R.col)for(R.col=0;_(R.row,R.col);)R.col++;else if(void 0===R.row)for(R.row=0;_(R.row,R.col);)R.row++;I[A.id()]=R,T(R.row,R.col)}}n.layoutPositions(this,t,(function(e,t){var a,n;if(e.locked()||e.isParent())return!1;var s=I[e.id()];if(s)a=s.col*g+g/2+i.x1,n=s.row*j+j/2+i.y1;else{for(;_(C,k);)F();a=k*g+g/2+i.x1,n=C*j+j/2+i.y1,T(C,k),F()}return{x:a,y:n}}))}return this};var fr={ready:function(){},stop:function(){}};function hr(e){this.options=P({},fr,e)}hr.prototype.run=function(){var e=this.options,t=e.eles,a=this;e.cy;return a.emit("layoutstart"),t.nodes().positions((function(){return{x:0,y:0}})),a.one("layoutready",e.ready),a.emit("layoutready"),a.one("layoutstop",e.stop),a.emit("layoutstop"),this},hr.prototype.stop=function(){return this};var gr={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function jr(e){this.options=P({},gr,e)}jr.prototype.run=function(){var e=this.options,t=e.eles.nodes(),a=x(e.positions);return t.layoutPositions(this,e,(function(t,n){var i=function(t){if(null==e.positions)return function(e){return{x:e.x,y:e.y}}(t.position());if(a)return e.positions(t);var n=e.positions[t._private.data.id];return null==n?null:n}(t);return!t.locked()&&null!=i&&i})),this};var xr={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,animationEasing:void 0,animateFilter:function(e,t){return!0},ready:void 0,stop:void 0,transform:function(e,t){return t}};function vr(e){this.options=P({},xr,e)}vr.prototype.run=function(){var e=this.options,t=e.cy,a=e.eles.nodes().not(":parent"),n=Qe(e.boundingBox?e.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()});return a.layoutPositions(this,e,(function(e,t){return{x:n.x1+Math.round(Math.random()*n.w),y:n.y1+Math.round(Math.random()*n.h)}})),this};var yr=[{name:"breadthfirst",impl:Bs},{name:"circle",impl:Vs},{name:"concentric",impl:qs},{name:"cose",impl:Hs},{name:"grid",impl:br},{name:"null",impl:hr},{name:"preset",impl:jr},{name:"random",impl:vr}];function Or(e){this.options=e,this.notifications=0}var Er=function(){};Or.prototype={recalculateRenderedStyle:Er,notify:function(){this.notifications++},init:Er,isHeadless:function(){return!0}};var wr={arrowShapeWidth:.3,registerArrowShapes:function(){var e=this.arrowShapes={},t=this,a=function(e,t,a,n,i,s,r){var o=i.x-a/2-r,l=i.x+a/2+r,c=i.y-a/2-r,d=i.y+a/2+r;return o<=e&&e<=l&&c<=t&&t<=d},n=function(e,t,a,n,i){var s=e*Math.cos(n)-t*Math.sin(n),r=(e*Math.sin(n)+t*Math.cos(n))*a;return{x:s*a+i.x,y:r+i.y}},i=function(e,t,a,i){for(var s=[],r=0;r<e.length;r+=2){var o=e[r],l=e[r+1];s.push(n(o,l,t,a,i))}return s},s=function(e){for(var t=[],a=0;a<e.length;a++){var n=e[a];t.push(n.x,n.y)}return t},r=function(e){return e.pstyle("width").pfValue*e.pstyle("arrow-scale").pfValue*2},o=function(n,o){j(o)&&(o=e[o]),e[n]=P({name:n,points:[-.15,-.3,.15,-.3,.15,.3,-.15,.3],collide:function(e,t,a,n,r,o){var l=s(i(this.points,a+2*o,n,r));return pt(e,t,l)},roughCollide:a,draw:function(e,a,n,s){var r=i(this.points,a,n,s);t.arrowShapeImpl("polygon")(e,r)},spacing:function(e){return 0},gap:r},o)};o("none",{collide:re,roughCollide:re,draw:le,spacing:oe,gap:oe}),o("triangle",{points:[-.15,-.3,0,0,.15,-.3]}),o("arrow","triangle"),o("triangle-backcurve",{points:e.triangle.points,controlPoint:[0,-.15],roughCollide:a,draw:function(e,a,s,r,o){var l=i(this.points,a,s,r),c=this.controlPoint,d=n(c[0],c[1],a,s,r);t.arrowShapeImpl(this.name)(e,l,d)},gap:function(e){return.8*r(e)}}),o("triangle-tee",{points:[0,0,.15,-.3,-.15,-.3,0,0],pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(e,t,a,n,r,o,l){var c=s(i(this.points,a+2*l,n,r)),d=s(i(this.pointsTee,a+2*l,n,r));return pt(e,t,c)||pt(e,t,d)},draw:function(e,a,n,s,r){var o=i(this.points,a,n,s),l=i(this.pointsTee,a,n,s);t.arrowShapeImpl(this.name)(e,o,l)}}),o("triangle-cross",{points:[0,0,.15,-.3,-.15,-.3,0,0],baseCrossLinePts:[-.15,-.4,-.15,-.4,.15,-.4,.15,-.4],crossLinePts:function(e,t){var a=this.baseCrossLinePts.slice(),n=t/e;return a[3]=a[3]-n,a[5]=a[5]-n,a},collide:function(e,t,a,n,r,o,l){var c=s(i(this.points,a+2*l,n,r)),d=s(i(this.crossLinePts(a,o),a+2*l,n,r));return pt(e,t,c)||pt(e,t,d)},draw:function(e,a,n,s,r){var o=i(this.points,a,n,s),l=i(this.crossLinePts(a,r),a,n,s);t.arrowShapeImpl(this.name)(e,o,l)}}),o("vee",{points:[-.15,-.3,0,0,.15,-.3,0,-.15],gap:function(e){return.525*r(e)}}),o("circle",{radius:.15,collide:function(e,t,a,n,i,s,r){var o=i;return Math.pow(o.x-e,2)+Math.pow(o.y-t,2)<=Math.pow((a+2*r)*this.radius,2)},draw:function(e,a,n,i,s){t.arrowShapeImpl(this.name)(e,i.x,i.y,this.radius*a)},spacing:function(e){return t.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.radius}}),o("tee",{points:[-.15,0,-.15,-.1,.15,-.1,.15,0],spacing:function(e){return 1},gap:function(e){return 1}}),o("square",{points:[-.15,0,.15,0,.15,-.3,-.15,-.3]}),o("diamond",{points:[-.15,-.15,0,-.3,.15,-.15,0,0],gap:function(e){return e.pstyle("width").pfValue*e.pstyle("arrow-scale").value}}),o("chevron",{points:[0,0,-.15,-.15,-.1,-.2,0,-.1,.1,-.2,.15,-.15],gap:function(e){return.95*e.pstyle("width").pfValue*e.pstyle("arrow-scale").value}})}},Mr={projectIntoViewport:function(e,t){var a=this.cy,n=this.findContainerClientCoords(),i=n[0],s=n[1],r=n[4],o=a.pan(),l=a.zoom();return[((e-i)/r-o.x)/l,((t-s)/r-o.y)/l]},findContainerClientCoords:function(){if(this.containerBB)return this.containerBB;var e=this.container,t=e.getBoundingClientRect(),a=u.getComputedStyle(e),n=function(e){return parseFloat(a.getPropertyValue(e))},i=n("padding-left"),s=n("padding-right"),r=n("padding-top"),o=n("padding-bottom"),l=n("border-left-width"),c=n("border-right-width"),d=n("border-top-width"),p=(n("border-bottom-width"),e.clientWidth),m=e.clientHeight,b=i+s,f=r+o,h=l+c,g=t.width/(p+h),j=p-b,x=m-f,v=t.left+i+l,y=t.top+r+d;return this.containerBB=[v,y,j,x,g]},invalidateContainerClientCoordsCache:function(){this.containerBB=null},findNearestElement:function(e,t,a,n){return this.findNearestElements(e,t,a,n)[0]},findNearestElements:function(e,t,a,n){var i,s,r=this,o=this,l=o.getCachedZSortedEles(),c=[],d=o.cy.zoom(),u=o.cy.hasCompoundNodes(),p=(n?24:8)/d,m=(n?8:2)/d,b=(n?8:2)/d,f=1/0;function h(e,t){if(e.isNode()){if(s)return;s=e,c.push(e)}if(e.isEdge()&&(null==t||t<f))if(i){if(i.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value&&i.pstyle("z-compound-depth").value===e.pstyle("z-compound-depth").value)for(var a=0;a<c.length;a++)if(c[a].isEdge()){c[a]=e,i=e,f=null!=t?t:f;break}}else c.push(e),i=e,f=null!=t?t:f}function g(a){var n=a.outerWidth()+2*m,i=a.outerHeight()+2*m,s=n/2,l=i/2,c=a.position();if(c.x-s<=e&&e<=c.x+s&&c.y-l<=t&&t<=c.y+l&&o.nodeShapes[r.getNodeShape(a)].checkPoint(e,t,0,n,i,c.x,c.y))return h(a,0),!0}function j(a){var n,i=a._private,s=i.rscratch,l=a.pstyle("width").pfValue,d=a.pstyle("arrow-scale").value,m=l/2+p,b=m*m,f=2*m,j=i.source,x=i.target;if("segments"===s.edgeType||"straight"===s.edgeType||"haystack"===s.edgeType){for(var v=s.allpts,y=0;y+3<v.length;y+=2)if(lt(e,t,v[y],v[y+1],v[y+2],v[y+3],f)&&b>(n=ut(e,t,v[y],v[y+1],v[y+2],v[y+3])))return h(a,n),!0}else if("bezier"===s.edgeType||"multibezier"===s.edgeType||"self"===s.edgeType||"compound"===s.edgeType)for(v=s.allpts,y=0;y+5<s.allpts.length;y+=4)if(ct(e,t,v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5],f)&&b>(n=dt(e,t,v[y],v[y+1],v[y+2],v[y+3],v[y+4],v[y+5])))return h(a,n),!0;j=j||i.source,x=x||i.target;var O=r.getArrowWidth(l,d),E=[{name:"source",x:s.arrowStartX,y:s.arrowStartY,angle:s.srcArrowAngle},{name:"target",x:s.arrowEndX,y:s.arrowEndY,angle:s.tgtArrowAngle},{name:"mid-source",x:s.midX,y:s.midY,angle:s.midsrcArrowAngle},{name:"mid-target",x:s.midX,y:s.midY,angle:s.midtgtArrowAngle}];for(y=0;y<E.length;y++){var w=E[y],M=o.arrowShapes[a.pstyle(w.name+"-arrow-shape").value],S=a.pstyle("width").pfValue;if(M.roughCollide(e,t,O,w.angle,{x:w.x,y:w.y},S,p)&&M.collide(e,t,O,w.angle,{x:w.x,y:w.y},S,p))return h(a),!0}u&&c.length>0&&(g(j),g(x))}function x(e,t,a){return xe(e,t,a)}function v(a,n){var i,s=a._private,r=b;i=n?n+"-":"";var o=s.labelBounds[n||"main"],l=a.pstyle(i+"label").value;if("yes"===a.pstyle("text-events").strValue&&l){var c=s.rstyle,d=x(c,"labelX",n),u=x(c,"labelY",n),p=x(s.rscratch,"labelAngle",n),m=o.x1-r,f=o.x2+r,g=o.y1-r,j=o.y2+r;if(p){var v=Math.cos(p),y=Math.sin(p),O=function(e,t){return{x:(e-=d)*v-(t-=u)*y+d,y:e*y+t*v+u}},E=O(m,g),w=O(m,j),M=O(f,g),S=O(f,j),_=[E.x,E.y,M.x,M.y,S.x,S.y,w.x,w.y];if(pt(e,t,_))return h(a),!0}else if(st(o,e,t))return h(a),!0}}a&&(l=l.interactive);for(var y=l.length-1;y>=0;y--){var O=l[y];O.isNode()?g(O)||v(O):j(O)||v(O)||v(O,"source")||v(O,"target")}return c},getAllInBox:function(e,t,a,n){for(var i,s,r=this.getCachedZSortedEles().interactive,o=[],l=Math.min(e,a),c=Math.max(e,a),d=Math.min(t,n),u=Math.max(t,n),p=Qe({x1:e=l,y1:t=d,x2:a=c,y2:n=u}),m=0;m<r.length;m++){var b=r[m];if(b.isNode()){var f=b,h=f.boundingBox({includeNodes:!0,includeEdges:!1,includeLabels:!1});it(p,h)&&!rt(h,p)&&o.push(f)}else{var g=b,j=g._private,x=j.rscratch;if(null!=x.startX&&null!=x.startY&&!st(p,x.startX,x.startY))continue;if(null!=x.endX&&null!=x.endY&&!st(p,x.endX,x.endY))continue;if("bezier"===x.edgeType||"multibezier"===x.edgeType||"self"===x.edgeType||"compound"===x.edgeType||"segments"===x.edgeType||"haystack"===x.edgeType){for(var v=j.rstyle.bezierPts||j.rstyle.linePts||j.rstyle.haystackPts,y=!0,O=0;O<v.length;O++)if(i=p,s=v[O],!st(i,s.x,s.y)){y=!1;break}y&&o.push(g)}else"haystack"!==x.edgeType&&"straight"!==x.edgeType||o.push(g)}}return o}},Sr={calculateArrowAngles:function(e){var t,a,n,i,s,r,o=e._private.rscratch,l="haystack"===o.edgeType,c="bezier"===o.edgeType,d="multibezier"===o.edgeType,u="segments"===o.edgeType,p="compound"===o.edgeType,m="self"===o.edgeType;if(l?(n=o.haystackPts[0],i=o.haystackPts[1],s=o.haystackPts[2],r=o.haystackPts[3]):(n=o.arrowStartX,i=o.arrowStartY,s=o.arrowEndX,r=o.arrowEndY),f=o.midX,h=o.midY,u)t=n-o.segpts[0],a=i-o.segpts[1];else if(d||p||m||c){var b=o.allpts;t=n-$e(b[0],b[2],b[4],.1),a=i-$e(b[1],b[3],b[5],.1)}else t=n-f,a=i-h;o.srcArrowAngle=Ue(t,a);var f=o.midX,h=o.midY;if(l&&(f=(n+s)/2,h=(i+r)/2),t=s-n,a=r-i,u)if((b=o.allpts).length/2%2==0){var g=(j=b.length/2)-2;t=b[j]-b[g],a=b[j+1]-b[g+1]}else{g=(j=b.length/2-1)-2;var j,x=j+2;t=b[j]-b[g],a=b[j+1]-b[g+1]}else if(d||p||m){var v,y,O,E,b=o.allpts;if(o.ctrlpts.length/2%2==0){var w=(M=(S=b.length/2-1)+2)+2;v=$e(b[S],b[M],b[w],0),y=$e(b[S+1],b[M+1],b[w+1],0),O=$e(b[S],b[M],b[w],1e-4),E=$e(b[S+1],b[M+1],b[w+1],1e-4)}else{var M,S;w=(M=b.length/2-1)+2;v=$e(b[S=M-2],b[M],b[w],.4999),y=$e(b[S+1],b[M+1],b[w+1],.4999),O=$e(b[S],b[M],b[w],.5),E=$e(b[S+1],b[M+1],b[w+1],.5)}t=O-v,a=E-y}(o.midtgtArrowAngle=Ue(t,a),o.midDispX=t,o.midDispY=a,t*=-1,a*=-1,u)&&((b=o.allpts).length/2%2==0||(t=-(b[x=(j=b.length/2-1)+2]-b[j]),a=-(b[x+1]-b[j+1])));if(o.midsrcArrowAngle=Ue(t,a),u)t=s-o.segpts[o.segpts.length-2],a=r-o.segpts[o.segpts.length-1];else if(d||p||m||c){var _=(b=o.allpts).length;t=s-$e(b[_-6],b[_-4],b[_-2],.9),a=r-$e(b[_-5],b[_-3],b[_-1],.9)}else t=s-f,a=r-h;o.tgtArrowAngle=Ue(t,a)}};Sr.getArrowWidth=Sr.getArrowHeight=function(e,t){var a=this.arrowWidthCache=this.arrowWidthCache||{},n=a[e+", "+t];return n||(n=Math.max(Math.pow(13.37*e,.9),29)*t,a[e+", "+t]=n,n)};var _r={};function Tr(e){var t=[];if(null!=e){for(var a=0;a<e.length;a+=2){var n=e[a],i=e[a+1];t.push({x:n,y:i})}return t}}_r.findHaystackPoints=function(e){for(var t=0;t<e.length;t++){var a=e[t],n=a._private,i=n.rscratch;if(!i.haystack){var s=2*Math.random()*Math.PI;i.source={x:Math.cos(s),y:Math.sin(s)},s=2*Math.random()*Math.PI,i.target={x:Math.cos(s),y:Math.sin(s)}}var r=n.source,o=n.target,l=r.position(),c=o.position(),d=r.width(),u=o.width(),p=r.height(),m=o.height(),b=a.pstyle("haystack-radius").value/2;i.haystackPts=i.allpts=[i.source.x*d*b+l.x,i.source.y*p*b+l.y,i.target.x*u*b+c.x,i.target.y*m*b+c.y],i.midX=(i.allpts[0]+i.allpts[2])/2,i.midY=(i.allpts[1]+i.allpts[3])/2,i.edgeType="haystack",i.haystack=!0,this.storeEdgeProjections(a),this.calculateArrowAngles(a),this.recalculateEdgeLabelProjections(a),this.calculateLabelAngles(a)}},_r.findSegmentsPoints=function(e,t){var a=e._private.rscratch,n=t.posPts,i=t.intersectionPts,s=t.vectorNormInverse,r=e.pstyle("edge-distances").value,o=e.pstyle("segment-weights"),l=e.pstyle("segment-distances"),c=Math.min(o.pfValue.length,l.pfValue.length);a.edgeType="segments",a.segpts=[];for(var d=0;d<c;d++){var u=o.pfValue[d],p=l.pfValue[d],m=1-u,b=u,f="node-position"===r?n:i,h={x:f.x1*m+f.x2*b,y:f.y1*m+f.y2*b};a.segpts.push(h.x+s.x*p,h.y+s.y*p)}},_r.findLoopPoints=function(e,t,a,n){var i=e._private.rscratch,s=t.dirCounts,r=t.srcPos,o=e.pstyle("control-point-distances"),l=o?o.pfValue[0]:void 0,c=e.pstyle("loop-direction").pfValue,d=e.pstyle("loop-sweep").pfValue,u=e.pstyle("control-point-step-size").pfValue;i.edgeType="self";var p=a,m=u;n&&(p=0,m=l);var b=c-Math.PI/2,f=b-d/2,h=b+d/2,g=String(c+"_"+d);p=void 0===s[g]?s[g]=0:++s[g],i.ctrlpts=[r.x+1.4*Math.cos(f)*m*(p/3+1),r.y+1.4*Math.sin(f)*m*(p/3+1),r.x+1.4*Math.cos(h)*m*(p/3+1),r.y+1.4*Math.sin(h)*m*(p/3+1)]},_r.findCompoundLoopPoints=function(e,t,a,n){var i=e._private.rscratch;i.edgeType="compound";var s=t.srcPos,r=t.tgtPos,o=t.srcW,l=t.srcH,c=t.tgtW,d=t.tgtH,u=e.pstyle("control-point-step-size").pfValue,p=e.pstyle("control-point-distances"),m=p?p.pfValue[0]:void 0,b=a,f=u;n&&(b=0,f=m);var h={x:s.x-o/2,y:s.y-l/2},g={x:r.x-c/2,y:r.y-d/2},j={x:Math.min(h.x,g.x),y:Math.min(h.y,g.y)},x=Math.max(.5,Math.log(.01*o)),v=Math.max(.5,Math.log(.01*c));i.ctrlpts=[j.x,j.y-(1+Math.pow(50,1.12)/100)*f*(b/3+1)*x,j.x-(1+Math.pow(50,1.12)/100)*f*(b/3+1)*v,j.y]},_r.findStraightEdgePoints=function(e){e._private.rscratch.edgeType="straight"},_r.findBezierPoints=function(e,t,a,n,i){var s=e._private.rscratch,r=t.vectorNormInverse,o=t.posPts,l=t.intersectionPts,c=e.pstyle("edge-distances").value,d=e.pstyle("control-point-step-size").pfValue,u=e.pstyle("control-point-distances"),p=e.pstyle("control-point-weights"),m=u&&p?Math.min(u.value.length,p.value.length):1,b=u?u.pfValue[0]:void 0,f=p.value[0],h=n;s.edgeType=h?"multibezier":"bezier",s.ctrlpts=[];for(var g=0;g<m;g++){var j=(.5-t.eles.length/2+a)*d*(i?-1:1),x=void 0,v=qe(j);h&&(b=u?u.pfValue[g]:d,f=p.value[g]);var y=void 0!==(x=n?b:void 0!==b?v*b:void 0)?x:j,O=1-f,E=f,w="node-position"===c?o:l,M={x:w.x1*O+w.x2*E,y:w.y1*O+w.y2*E};s.ctrlpts.push(M.x+r.x*y,M.y+r.y*y)}},_r.findTaxiPoints=function(e,t){var a=e._private.rscratch;a.edgeType="segments";var n="vertical",i="horizontal",s="leftward",r="rightward",o="downward",l="upward",c=t.posPts,d=t.srcW,u=t.srcH,p=t.tgtW,m=t.tgtH,b="node-position"!==e.pstyle("edge-distances").value,f=e.pstyle("taxi-direction").value,h=f,g=e.pstyle("taxi-turn"),j=g.pfValue,x=e.pstyle("taxi-turn-min-distance").pfValue,v="%"===g.units,y=b?(d+p)/2:0,O=b?(u+m)/2:0,E=c.x2-c.x1,w=c.y2-c.y1,M=function(e,t){return e>0?Math.max(e-t,0):Math.min(e+t,0)},S=M(E,y),_=M(w,O),T=!1;"auto"===f?f=Math.abs(S)>Math.abs(_)?i:n:f===l||f===o?(f=n,T=!0):f!==s&&f!==r||(f=i,T=!0);var C=f===n,k=C?_:S,F=C?w:E,I=qe(F),D=!1;T&&v||!(h===o&&F<0||h===l&&F>0||h===s&&F>0||h===r&&F<0)||(k=(I*=-1)*Math.abs(k),D=!0);var A=v?j*k:j*I,L=function(e){return Math.abs(e)<x||Math.abs(e)>=Math.abs(k)},R=L(A),N=L(k-A);if((R||N)&&!D)if(C){var P=Math.abs(F)<=u/2,z=Math.abs(E)<=p/2;if(P){var B=(c.x1+c.x2)/2,J=c.y1,V=c.y2;a.segpts=[B,J,B,V]}else if(z){var U=(c.y1+c.y2)/2,G=c.x1,q=c.x2;a.segpts=[G,U,q,U]}else a.segpts=[c.x1,c.y2]}else{var W=Math.abs(F)<=d/2,H=Math.abs(w)<=m/2;if(W){var Y=(c.y1+c.y2)/2,$=c.x1,X=c.x2;a.segpts=[$,Y,X,Y]}else if(H){var K=(c.x1+c.x2)/2,Q=c.y1,Z=c.y2;a.segpts=[K,Q,K,Z]}else a.segpts=[c.x2,c.y1]}else if(C){var ee=c.y1+A+(b?u/2*I:0),te=c.x1,ae=c.x2;a.segpts=[te,ee,ae,ee]}else{var ne=c.x1+A+(b?d/2*I:0),ie=c.y1,se=c.y2;a.segpts=[ne,ie,ne,se]}},_r.tryToCorrectInvalidPoints=function(e,t){var a=e._private.rscratch;if("bezier"===a.edgeType){var n=t.srcPos,i=t.tgtPos,s=t.srcW,r=t.srcH,o=t.tgtW,l=t.tgtH,c=t.srcShape,d=t.tgtShape,u=!O(a.startX)||!O(a.startY),p=!O(a.arrowStartX)||!O(a.arrowStartY),m=!O(a.endX)||!O(a.endY),b=!O(a.arrowEndX)||!O(a.arrowEndY),f=3*(this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth),h=We({x:a.ctrlpts[0],y:a.ctrlpts[1]},{x:a.startX,y:a.startY}),g=h<f,j=We({x:a.ctrlpts[0],y:a.ctrlpts[1]},{x:a.endX,y:a.endY}),x=j<f,v=!1;if(u||p||g){v=!0;var y={x:a.ctrlpts[0]-n.x,y:a.ctrlpts[1]-n.y},E=Math.sqrt(y.x*y.x+y.y*y.y),w={x:y.x/E,y:y.y/E},M=Math.max(s,r),S={x:a.ctrlpts[0]+2*w.x*M,y:a.ctrlpts[1]+2*w.y*M},_=c.intersectLine(n.x,n.y,s,r,S.x,S.y,0);g?(a.ctrlpts[0]=a.ctrlpts[0]+w.x*(f-h),a.ctrlpts[1]=a.ctrlpts[1]+w.y*(f-h)):(a.ctrlpts[0]=_[0]+w.x*f,a.ctrlpts[1]=_[1]+w.y*f)}if(m||b||x){v=!0;var T={x:a.ctrlpts[0]-i.x,y:a.ctrlpts[1]-i.y},C=Math.sqrt(T.x*T.x+T.y*T.y),k={x:T.x/C,y:T.y/C},F=Math.max(s,r),I={x:a.ctrlpts[0]+2*k.x*F,y:a.ctrlpts[1]+2*k.y*F},D=d.intersectLine(i.x,i.y,o,l,I.x,I.y,0);x?(a.ctrlpts[0]=a.ctrlpts[0]+k.x*(f-j),a.ctrlpts[1]=a.ctrlpts[1]+k.y*(f-j)):(a.ctrlpts[0]=D[0]+k.x*f,a.ctrlpts[1]=D[1]+k.y*f)}v&&this.findEndpoints(e)}},_r.storeAllpts=function(e){var t=e._private.rscratch;if("multibezier"===t.edgeType||"bezier"===t.edgeType||"self"===t.edgeType||"compound"===t.edgeType){t.allpts=[],t.allpts.push(t.startX,t.startY);for(var a=0;a+1<t.ctrlpts.length;a+=2)t.allpts.push(t.ctrlpts[a],t.ctrlpts[a+1]),a+3<t.ctrlpts.length&&t.allpts.push((t.ctrlpts[a]+t.ctrlpts[a+2])/2,(t.ctrlpts[a+1]+t.ctrlpts[a+3])/2);var n;t.allpts.push(t.endX,t.endY),t.ctrlpts.length/2%2==0?(n=t.allpts.length/2-1,t.midX=t.allpts[n],t.midY=t.allpts[n+1]):(n=t.allpts.length/2-3,.5,t.midX=$e(t.allpts[n],t.allpts[n+2],t.allpts[n+4],.5),t.midY=$e(t.allpts[n+1],t.allpts[n+3],t.allpts[n+5],.5))}else if("straight"===t.edgeType)t.allpts=[t.startX,t.startY,t.endX,t.endY],t.midX=(t.startX+t.endX+t.arrowStartX+t.arrowEndX)/4,t.midY=(t.startY+t.endY+t.arrowStartY+t.arrowEndY)/4;else if("segments"===t.edgeType)if(t.allpts=[],t.allpts.push(t.startX,t.startY),t.allpts.push.apply(t.allpts,t.segpts),t.allpts.push(t.endX,t.endY),t.segpts.length%4==0){var i=t.segpts.length/2,s=i-2;t.midX=(t.segpts[s]+t.segpts[i])/2,t.midY=(t.segpts[s+1]+t.segpts[i+1])/2}else{var r=t.segpts.length/2-1;t.midX=t.segpts[r],t.midY=t.segpts[r+1]}},_r.checkForInvalidEdgeWarning=function(e){var t=e[0]._private.rscratch;t.nodesOverlap||O(t.startX)&&O(t.startY)&&O(t.endX)&&O(t.endY)?t.loggedErr=!1:t.loggedErr||(t.loggedErr=!0,ue("Edge `"+e.id()+"` has invalid endpoints and so it is impossible to draw.  Adjust your edge style (e.g. control points) accordingly or use an alternative edge type.  This is expected behaviour when the source node and the target node overlap."))},_r.findEdgeControlPoints=function(e){var t=this;if(e&&0!==e.length){for(var a=this,n=a.cy.hasCompoundNodes(),i={map:new ye,get:function(e){var t=this.map.get(e[0]);return null!=t?t.get(e[1]):null},set:function(e,t){var a=this.map.get(e[0]);null==a&&(a=new ye,this.map.set(e[0],a)),a.set(e[1],t)}},s=[],r=[],o=0;o<e.length;o++){var l=e[o],c=l._private,d=l.pstyle("curve-style").value;if(!l.removed()&&l.takesUpSpace())if("haystack"!==d){var u="unbundled-bezier"===d||"segments"===d||"straight"===d||"taxi"===d,p="unbundled-bezier"===d||"bezier"===d,m=c.source,b=c.target,f=[m.poolIndex(),b.poolIndex()].sort(),h=i.get(f);null==h&&(h={eles:[]},i.set(f,h),s.push(f)),h.eles.push(l),u&&(h.hasUnbundled=!0),p&&(h.hasBezier=!0)}else r.push(l)}for(var g=function(e){var r=s[e],o=i.get(r),l=void 0;if(!o.hasUnbundled){var c=o.eles[0].parallelEdges().filter((function(e){return e.isBundledBezier()}));je(o.eles),c.forEach((function(e){return o.eles.push(e)})),o.eles.sort((function(e,t){return e.poolIndex()-t.poolIndex()}))}var d=o.eles[0],u=d.source(),p=d.target();if(u.poolIndex()>p.poolIndex()){var m=u;u=p,p=m}var b=o.srcPos=u.position(),f=o.tgtPos=p.position(),h=o.srcW=u.outerWidth(),g=o.srcH=u.outerHeight(),j=o.tgtW=p.outerWidth(),x=o.tgtH=p.outerHeight(),v=o.srcShape=a.nodeShapes[t.getNodeShape(u)],y=o.tgtShape=a.nodeShapes[t.getNodeShape(p)];o.dirCounts={north:0,west:0,south:0,east:0,northwest:0,southwest:0,northeast:0,southeast:0};for(var E=0;E<o.eles.length;E++){var w=o.eles[E],M=w[0]._private.rscratch,S=w.pstyle("curve-style").value,_="unbundled-bezier"===S||"segments"===S||"taxi"===S,T=!u.same(w.source());if(!o.calculatedIntersection&&u!==p&&(o.hasBezier||o.hasUnbundled)){o.calculatedIntersection=!0;var C=v.intersectLine(b.x,b.y,h,g,f.x,f.y,0),k=o.srcIntn=C,F=y.intersectLine(f.x,f.y,j,x,b.x,b.y,0),I=o.tgtIntn=F,D=o.intersectionPts={x1:C[0],x2:F[0],y1:C[1],y2:F[1]},A=o.posPts={x1:b.x,x2:f.x,y1:b.y,y2:f.y},L=F[1]-C[1],R=F[0]-C[0],N=Math.sqrt(R*R+L*L),P=o.vector={x:R,y:L},z=o.vectorNorm={x:P.x/N,y:P.y/N},B={x:-z.y,y:z.x};o.nodesOverlap=!O(N)||y.checkPoint(C[0],C[1],0,j,x,f.x,f.y)||v.checkPoint(F[0],F[1],0,h,g,b.x,b.y),o.vectorNormInverse=B,l={nodesOverlap:o.nodesOverlap,dirCounts:o.dirCounts,calculatedIntersection:!0,hasBezier:o.hasBezier,hasUnbundled:o.hasUnbundled,eles:o.eles,srcPos:f,tgtPos:b,srcW:j,srcH:x,tgtW:h,tgtH:g,srcIntn:I,tgtIntn:k,srcShape:y,tgtShape:v,posPts:{x1:A.x2,y1:A.y2,x2:A.x1,y2:A.y1},intersectionPts:{x1:D.x2,y1:D.y2,x2:D.x1,y2:D.y1},vector:{x:-P.x,y:-P.y},vectorNorm:{x:-z.x,y:-z.y},vectorNormInverse:{x:-B.x,y:-B.y}}}var J=T?l:o;M.nodesOverlap=J.nodesOverlap,M.srcIntn=J.srcIntn,M.tgtIntn=J.tgtIntn,n&&(u.isParent()||u.isChild()||p.isParent()||p.isChild())&&(u.parents().anySame(p)||p.parents().anySame(u)||u.same(p)&&u.isParent())?t.findCompoundLoopPoints(w,J,E,_):u===p?t.findLoopPoints(w,J,E,_):"segments"===S?t.findSegmentsPoints(w,J):"taxi"===S?t.findTaxiPoints(w,J):"straight"===S||!_&&o.eles.length%2==1&&E===Math.floor(o.eles.length/2)?t.findStraightEdgePoints(w):t.findBezierPoints(w,J,E,_,T),t.findEndpoints(w),t.tryToCorrectInvalidPoints(w,J),t.checkForInvalidEdgeWarning(w),t.storeAllpts(w),t.storeEdgeProjections(w),t.calculateArrowAngles(w),t.recalculateEdgeLabelProjections(w),t.calculateLabelAngles(w)}},j=0;j<s.length;j++)g(j);this.findHaystackPoints(r)}},_r.getSegmentPoints=function(e){var t=e[0]._private.rscratch;if("segments"===t.edgeType)return this.recalculateRenderedStyle(e),Tr(t.segpts)},_r.getControlPoints=function(e){var t=e[0]._private.rscratch,a=t.edgeType;if("bezier"===a||"multibezier"===a||"self"===a||"compound"===a)return this.recalculateRenderedStyle(e),Tr(t.ctrlpts)},_r.getEdgeMidpoint=function(e){var t=e[0]._private.rscratch;return this.recalculateRenderedStyle(e),{x:t.midX,y:t.midY}};var Cr={manualEndptToPx:function(e,t){var a=e.position(),n=e.outerWidth(),i=e.outerHeight();if(2===t.value.length){var s=[t.pfValue[0],t.pfValue[1]];return"%"===t.units[0]&&(s[0]=s[0]*n),"%"===t.units[1]&&(s[1]=s[1]*i),s[0]+=a.x,s[1]+=a.y,s}var r=t.pfValue[0];r=-Math.PI/2+r;var o=2*Math.max(n,i),l=[a.x+Math.cos(r)*o,a.y+Math.sin(r)*o];return this.nodeShapes[this.getNodeShape(e)].intersectLine(a.x,a.y,n,i,l[0],l[1],0)},findEndpoints:function(e){var t,a,n,i,s,r=this,o=e.source()[0],l=e.target()[0],c=o.position(),d=l.position(),u=e.pstyle("target-arrow-shape").value,p=e.pstyle("source-arrow-shape").value,m=e.pstyle("target-distance-from-node").pfValue,b=e.pstyle("source-distance-from-node").pfValue,f=e.pstyle("curve-style").value,h=e._private.rscratch,g=h.edgeType,j="self"===g||"compound"===g,x="bezier"===g||"multibezier"===g||j,v="bezier"!==g,y="straight"===g||"segments"===g,E="segments"===g,w=x||v||y,M=j||"taxi"===f,S=e.pstyle("source-endpoint"),_=M?"outside-to-node":S.value,T=e.pstyle("target-endpoint"),C=M?"outside-to-node":T.value;if(h.srcManEndpt=S,h.tgtManEndpt=T,x){var k=[h.ctrlpts[0],h.ctrlpts[1]];a=v?[h.ctrlpts[h.ctrlpts.length-2],h.ctrlpts[h.ctrlpts.length-1]]:k,n=k}else if(y){var F=E?h.segpts.slice(0,2):[d.x,d.y];a=E?h.segpts.slice(h.segpts.length-2):[c.x,c.y],n=F}if("inside-to-node"===C)t=[d.x,d.y];else if(T.units)t=this.manualEndptToPx(l,T);else if("outside-to-line"===C)t=h.tgtIntn;else if("outside-to-node"===C||"outside-to-node-or-label"===C?i=a:"outside-to-line"!==C&&"outside-to-line-or-label"!==C||(i=[c.x,c.y]),t=r.nodeShapes[this.getNodeShape(l)].intersectLine(d.x,d.y,l.outerWidth(),l.outerHeight(),i[0],i[1],0),"outside-to-node-or-label"===C||"outside-to-line-or-label"===C){var I=l._private.rscratch,D=I.labelWidth,A=I.labelHeight,L=I.labelX,R=I.labelY,N=l.pstyle("text-valign").value;"top"===N?R-=A/2:"bottom"===N&&(R+=A/2);var P=l.pstyle("text-halign").value;"left"===P?L-=D/2:"right"===P&&(L+=D/2);var z=r.nodeShapes.rectangle.intersectLine(L,R,D,A,i[0],i[1],0),B=c,J=He(B,Ve(t));He(B,Ve(z))<J&&(t=z)}var V=yt(t,a,r.arrowShapes[u].spacing(e)+m),U=yt(t,a,r.arrowShapes[u].gap(e)+m);if(h.endX=U[0],h.endY=U[1],h.arrowEndX=V[0],h.arrowEndY=V[1],"inside-to-node"===_)t=[c.x,c.y];else if(S.units)t=this.manualEndptToPx(o,S);else if("outside-to-line"===_)t=h.srcIntn;else if("outside-to-node"===_||"outside-to-node-or-label"===_?s=n:"outside-to-line"!==_&&"outside-to-line-or-label"!==_||(s=[d.x,d.y]),t=r.nodeShapes[this.getNodeShape(o)].intersectLine(c.x,c.y,o.outerWidth(),o.outerHeight(),s[0],s[1],0),"outside-to-node-or-label"===_||"outside-to-line-or-label"===_){var G=o._private.rscratch,q=G.labelWidth,W=G.labelHeight,H=G.labelX,Y=G.labelY,$=o.pstyle("text-valign").value;"top"===$?Y-=W/2:"bottom"===$&&(Y+=W/2);var X=o.pstyle("text-halign").value;"left"===X?H-=q/2:"right"===X&&(H+=q/2);var K=r.nodeShapes.rectangle.intersectLine(H,Y,q,W,s[0],s[1],0),Q=d,Z=He(Q,Ve(t));He(Q,Ve(K))<Z&&(t=K)}var ee=yt(t,n,r.arrowShapes[p].spacing(e)+b),te=yt(t,n,r.arrowShapes[p].gap(e)+b);h.startX=te[0],h.startY=te[1],h.arrowStartX=ee[0],h.arrowStartY=ee[1],w&&(O(h.startX)&&O(h.startY)&&O(h.endX)&&O(h.endY)?h.badLine=!1:h.badLine=!0)},getSourceEndpoint:function(e){var t=e[0]._private.rscratch;switch(this.recalculateRenderedStyle(e),t.edgeType){case"haystack":return{x:t.haystackPts[0],y:t.haystackPts[1]};default:return{x:t.arrowStartX,y:t.arrowStartY}}},getTargetEndpoint:function(e){var t=e[0]._private.rscratch;switch(this.recalculateRenderedStyle(e),t.edgeType){case"haystack":return{x:t.haystackPts[2],y:t.haystackPts[3]};default:return{x:t.arrowEndX,y:t.arrowEndY}}}},kr={};function Fr(e,t,a){for(var n=function(e,t,a,n){return $e(e,t,a,n)},i=t._private.rstyle.bezierPts,s=0;s<e.bezierProjPcts.length;s++){var r=e.bezierProjPcts[s];i.push({x:n(a[0],a[2],a[4],r),y:n(a[1],a[3],a[5],r)})}}kr.storeEdgeProjections=function(e){var t=e._private,a=t.rscratch,n=a.edgeType;if(t.rstyle.bezierPts=null,t.rstyle.linePts=null,t.rstyle.haystackPts=null,"multibezier"===n||"bezier"===n||"self"===n||"compound"===n){t.rstyle.bezierPts=[];for(var i=0;i+5<a.allpts.length;i+=4)Fr(this,e,a.allpts.slice(i,i+6))}else if("segments"===n){var s=t.rstyle.linePts=[];for(i=0;i+1<a.allpts.length;i+=2)s.push({x:a.allpts[i],y:a.allpts[i+1]})}else if("haystack"===n){var r=a.haystackPts;t.rstyle.haystackPts=[{x:r[0],y:r[1]},{x:r[2],y:r[3]}]}t.rstyle.arrowWidth=this.getArrowWidth(e.pstyle("width").pfValue,e.pstyle("arrow-scale").value)*this.arrowShapeWidth},kr.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)};var Ir={recalculateNodeLabelProjection:function(e){var t=e.pstyle("label").strValue;if(!C(t)){var a,n,i=e._private,s=e.width(),r=e.height(),o=e.padding(),l=e.position(),c=e.pstyle("text-halign").strValue,d=e.pstyle("text-valign").strValue,u=i.rscratch,p=i.rstyle;switch(c){case"left":a=l.x-s/2-o;break;case"right":a=l.x+s/2+o;break;default:a=l.x}switch(d){case"top":n=l.y-r/2-o;break;case"bottom":n=l.y+r/2+o;break;default:n=l.y}u.labelX=a,u.labelY=n,p.labelX=a,p.labelY=n,this.applyLabelDimensions(e)}}},Dr=function(e,t){var a=Math.atan(t/e);return 0===e&&a<0&&(a*=-1),a},Ar=function(e,t){var a=t.x-e.x,n=t.y-e.y;return Dr(a,n)};Ir.recalculateEdgeLabelProjections=function(e){var t,a=e._private,n=a.rscratch,i=this,s={mid:e.pstyle("label").strValue,source:e.pstyle("source-label").strValue,target:e.pstyle("target-label").strValue};if(s.mid||s.source||s.target){t={x:n.midX,y:n.midY};var r=function(e,t,n){ve(a.rscratch,e,t,n),ve(a.rstyle,e,t,n)};r("labelX",null,t.x),r("labelY",null,t.y);var o=Dr(n.midDispX,n.midDispY);r("labelAutoAngle",null,o);var l=function e(){if(e.cache)return e.cache;for(var t=[],s=0;s+5<n.allpts.length;s+=4){var r={x:n.allpts[s],y:n.allpts[s+1]},o={x:n.allpts[s+2],y:n.allpts[s+3]},l={x:n.allpts[s+4],y:n.allpts[s+5]};t.push({p0:r,p1:o,p2:l,startDist:0,length:0,segments:[]})}var c=a.rstyle.bezierPts,d=i.bezierProjPcts.length;function u(e,t,a,n,i){var s=We(t,a),r=e.segments[e.segments.length-1],o={p0:t,p1:a,t0:n,t1:i,startDist:r?r.startDist+r.length:0,length:s};e.segments.push(o),e.length+=s}for(var p=0;p<t.length;p++){var m=t[p],b=t[p-1];b&&(m.startDist=b.startDist+b.length),u(m,m.p0,c[p*d],0,i.bezierProjPcts[0]);for(var f=0;f<d-1;f++)u(m,c[p*d+f],c[p*d+f+1],i.bezierProjPcts[f],i.bezierProjPcts[f+1]);u(m,c[p*d+d-1],m.p2,i.bezierProjPcts[d-1],1)}return e.cache=t},c=function(a){var i,o="source"===a;if(s[a]){var c=e.pstyle(a+"-text-offset").pfValue;switch(n.edgeType){case"self":case"compound":case"bezier":case"multibezier":for(var d,u=l(),p=0,m=0,b=0;b<u.length;b++){for(var f=u[o?b:u.length-1-b],h=0;h<f.segments.length;h++){var g=f.segments[o?h:f.segments.length-1-h],j=b===u.length-1&&h===f.segments.length-1;if(p=m,(m+=g.length)>=c||j){d={cp:f,segment:g};break}}if(d)break}var x=d.cp,v=d.segment,y=(c-p)/v.length,O=v.t1-v.t0,E=o?v.t0+O*y:v.t1-O*y;E=Ke(0,E,1),t=Xe(x.p0,x.p1,x.p2,E),i=function(e,t,a,n){var i=Ke(0,n-.001,1),s=Ke(0,n+.001,1),r=Xe(e,t,a,i),o=Xe(e,t,a,s);return Ar(r,o)}(x.p0,x.p1,x.p2,E);break;case"straight":case"segments":case"haystack":for(var w,M,S,_,T=0,C=n.allpts.length,k=0;k+3<C&&(o?(S={x:n.allpts[k],y:n.allpts[k+1]},_={x:n.allpts[k+2],y:n.allpts[k+3]}):(S={x:n.allpts[C-2-k],y:n.allpts[C-1-k]},_={x:n.allpts[C-4-k],y:n.allpts[C-3-k]}),M=T,!((T+=w=We(S,_))>=c));k+=2);var F=(c-M)/w;F=Ke(0,F,1),t=function(e,t,a,n){var i=t.x-e.x,s=t.y-e.y,r=We(e,t),o=i/r,l=s/r;return a=null==a?0:a,n=null!=n?n:a*r,{x:e.x+o*n,y:e.y+l*n}}(S,_,F),i=Ar(S,_)}r("labelX",a,t.x),r("labelY",a,t.y),r("labelAutoAngle",a,i)}};c("source"),c("target"),this.applyLabelDimensions(e)}},Ir.applyLabelDimensions=function(e){this.applyPrefixedLabelDimensions(e),e.isEdge()&&(this.applyPrefixedLabelDimensions(e,"source"),this.applyPrefixedLabelDimensions(e,"target"))},Ir.applyPrefixedLabelDimensions=function(e,t){var a=e._private,n=this.getLabelText(e,t),i=this.calculateLabelDimensions(e,n),s=e.pstyle("line-height").pfValue,r=e.pstyle("text-wrap").strValue,o=xe(a.rscratch,"labelWrapCachedLines",t)||[],l="wrap"!==r?1:Math.max(o.length,1),c=i.height/l,d=c*s,u=i.width,p=i.height+(l-1)*(s-1)*c;ve(a.rstyle,"labelWidth",t,u),ve(a.rscratch,"labelWidth",t,u),ve(a.rstyle,"labelHeight",t,p),ve(a.rscratch,"labelHeight",t,p),ve(a.rscratch,"labelLineHeight",t,d)},Ir.getLabelText=function(e,t){var a=e._private,n=t?t+"-":"",i=e.pstyle(n+"label").strValue,s=e.pstyle("text-transform").value,r=function(e,n){return n?(ve(a.rscratch,e,t,n),n):xe(a.rscratch,e,t)};if(!i)return"";"none"==s||("uppercase"==s?i=i.toUpperCase():"lowercase"==s&&(i=i.toLowerCase()));var o=e.pstyle("text-wrap").value;if("wrap"===o){var l=r("labelKey");if(null!=l&&r("labelWrapKey")===l)return r("labelWrapCachedText");for(var c=i.split("\n"),d=e.pstyle("text-max-width").pfValue,u="anywhere"===e.pstyle("text-overflow-wrap").value,p=[],m=/[\s\u200b]+/,b=u?"":" ",f=0;f<c.length;f++){var h=c[f],g=this.calculateLabelDimensions(e,h).width;if(u){var j=h.split("").join("​");h=j}if(g>d){for(var x=h.split(m),v="",y=0;y<x.length;y++){var O=x[y],E=0===v.length?O:v+b+O;this.calculateLabelDimensions(e,E).width<=d?v+=O+b:(p.push(v),v=O+b)}v.match(/^[\s\u200b]+$/)||p.push(v)}else p.push(h)}r("labelWrapCachedLines",p),i=r("labelWrapCachedText",p.join("\n")),r("labelWrapKey",l)}else if("ellipsis"===o){for(var w=e.pstyle("text-max-width").pfValue,M="",S=!1,_=0;_<i.length;_++){if(this.calculateLabelDimensions(e,M+i[_]+"…").width>w)break;M+=i[_],_===i.length-1&&(S=!0)}return S||(M+="…"),M}return i},Ir.getLabelJustification=function(e){var t=e.pstyle("text-justification").strValue,a=e.pstyle("text-halign").strValue;if("auto"!==t)return t;if(!e.isNode())return"center";switch(a){case"left":return"right";case"right":return"left";default:return"center"}},Ir.calculateLabelDimensions=function(e,t){var a=Q(t,e._private.labelDimsKey),n=this.labelDimCache||(this.labelDimCache=[]),i=n[a];if(null!=i)return i;var s=e.pstyle("font-style").strValue,r=1*e.pstyle("font-size").pfValue+"px",o=e.pstyle("font-family").strValue,l=e.pstyle("font-weight").strValue,c=this.labelCalcDiv;c||(c=this.labelCalcDiv=document.createElement("div"),document.body.appendChild(c));var d=c.style;return d.fontFamily=o,d.fontStyle=s,d.fontSize=r,d.fontWeight=l,d.position="absolute",d.left="-9999px",d.top="-9999px",d.zIndex="-1",d.visibility="hidden",d.pointerEvents="none",d.padding="0",d.lineHeight="1","wrap"===e.pstyle("text-wrap").value?d.whiteSpace="pre":d.whiteSpace="normal",c.textContent=t,n[a]={width:Math.ceil(c.clientWidth/1),height:Math.ceil(c.clientHeight/1)}},Ir.calculateLabelAngle=function(e,t){var a=e._private.rscratch,n=e.isEdge(),i=t?t+"-":"",s=e.pstyle(i+"text-rotation"),r=s.strValue;return"none"===r?0:n&&"autorotate"===r?a.labelAutoAngle:"autorotate"===r?0:s.pfValue},Ir.calculateLabelAngles=function(e){var t=this,a=e.isEdge(),n=e._private.rscratch;n.labelAngle=t.calculateLabelAngle(e),a&&(n.sourceLabelAngle=t.calculateLabelAngle(e,"source"),n.targetLabelAngle=t.calculateLabelAngle(e,"target"))};var Lr={},Rr=!1;Lr.getNodeShape=function(e){var t=e.pstyle("shape").value;if("cutrectangle"===t&&(e.width()<28||e.height()<28))return Rr||(ue("The `cutrectangle` node shape can not be used at small sizes so `rectangle` is used instead"),Rr=!0),"rectangle";if(e.isParent())return"rectangle"===t||"roundrectangle"===t||"cutrectangle"===t||"barrel"===t?t:"rectangle";if("polygon"===t){var a=e.pstyle("shape-polygon-points").value;return this.nodeShapes.makePolygon(a).name}return t};var Nr={registerCalculationListeners:function(){var e=this.cy,t=e.collection(),a=this,n=function(e){var a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(t.merge(e),a)for(var n=0;n<e.length;n++){var i=e[n],s=i._private,r=s.rstyle;r.clean=!1,r.cleanConnected=!1}};a.binder(e).on("bounds.* dirty.*",(function(e){var t=e.target;n(t)})).on("style.* background.*",(function(e){var t=e.target;n(t,!1)}));var i=function(i){if(i){for(var s=a.onUpdateEleCalcsFns,r=0;r<t.length;r++){var o=t[r],l=o._private.rstyle;o.isNode()&&!l.cleanConnected&&(n(o.connectedEdges()),l.cleanConnected=!0)}if(s)for(r=0;r<s.length;r++){(0,s[r])(i,t)}a.recalculateRenderedStyle(t),t=e.collection()}};a.flushRenderedStyleQueue=function(){i(!0)},a.beforeRender(i,a.beforeRenderPriorities.eleCalcs)},onUpdateEleCalcs:function(e){(this.onUpdateEleCalcsFns=this.onUpdateEleCalcsFns||[]).push(e)},recalculateRenderedStyle:function(e,t){var a=[],n=[];if(!this.destroyed){void 0===t&&(t=!0);for(var i=0;i<e.length;i++){var s=(l=(o=e[i])._private).rstyle;t&&s.clean||o.removed()||"none"!==o.pstyle("display").value&&("nodes"===l.group?n.push(o):a.push(o),s.clean=!0)}for(i=0;i<n.length;i++){s=(l=(o=n[i])._private).rstyle;var r=o.position();this.recalculateNodeLabelProjection(o),s.nodeX=r.x,s.nodeY=r.y,s.nodeW=o.pstyle("width").pfValue,s.nodeH=o.pstyle("height").pfValue}this.recalculateEdgeProjections(a);for(i=0;i<a.length;i++){s=(l=(o=a[i])._private).rstyle;var o,l,c=l.rscratch;s.srcX=c.arrowStartX,s.srcY=c.arrowStartY,s.tgtX=c.arrowEndX,s.tgtY=c.arrowEndY,s.midX=c.midX,s.midY=c.midY,s.labelAngle=c.labelAngle,s.sourceLabelAngle=c.sourceLabelAngle,s.targetLabelAngle=c.targetLabelAngle}}}},Pr={updateCachedGrabbedEles:function(){var e=this.cachedZSortedEles;if(e){e.drag=[],e.nondrag=[];for(var t=[],a=0;a<e.length;a++){var n=(i=e[a])._private.rscratch;i.grabbed()&&!i.isParent()?t.push(i):n.inDragLayer?e.drag.push(i):e.nondrag.push(i)}for(a=0;a<t.length;a++){var i=t[a];e.drag.push(i)}}},invalidateCachedZSortedEles:function(){this.cachedZSortedEles=null},getCachedZSortedEles:function(e){if(e||!this.cachedZSortedEles){var t=this.cy.mutableElements().toArray();t.sort(Si),t.interactive=t.filter((function(e){return e.interactive()})),this.cachedZSortedEles=t,this.updateCachedGrabbedEles()}else t=this.cachedZSortedEles;return t}},zr={};[Mr,Sr,_r,Cr,kr,Ir,Lr,Nr,Pr].forEach((function(e){P(zr,e)}));var Br={getCachedImage:function(e,t,a){var n=this.imageCache=this.imageCache||{},i=n[e];if(i)return i.image.complete||i.image.addEventListener("load",a),i.image;var s=(i=n[e]=n[e]||{}).image=new Image;s.addEventListener("load",a),s.addEventListener("error",(function(){s.error=!0}));var r="data:";return e.substring(0,r.length).toLowerCase()===r||(s.crossOrigin=t),s.src=e,s}},Jr={registerBinding:function(e,t,a,n){var i=Array.prototype.slice.apply(arguments,[1]),s=this.binder(e);return s.on.apply(s,i)}};Jr.binder=function(e){var t,a=this,n=e===window||e===document||e===document.body||(t=e,"undefined"!=typeof HTMLElement&&t instanceof HTMLElement);if(null==a.supportsPassiveEvents){var i=!1;try{var s=Object.defineProperty({},"passive",{get:function(){return i=!0,!0}});window.addEventListener("test",null,s)}catch(e){}a.supportsPassiveEvents=i}var r=function(t,i,s){var r=Array.prototype.slice.call(arguments);return n&&a.supportsPassiveEvents&&(r[2]={capture:null!=s&&s,passive:!1,once:!1}),a.bindings.push({target:e,args:r}),(e.addEventListener||e.on).apply(e,r),this};return{on:r,addEventListener:r,addListener:r,bind:r}},Jr.nodeIsDraggable=function(e){return e&&e.isNode()&&!e.locked()&&e.grabbable()},Jr.nodeIsGrabbable=function(e){return this.nodeIsDraggable(e)&&e.interactive()},Jr.load=function(){var e=this,t=function(e){return e.selected()},a=function(t,a,n,i){null==t&&(t=e.cy);for(var s=0;s<a.length;s++){var r=a[s];t.emit({originalEvent:n,type:r,position:i})}},n=function(e){return e.shiftKey||e.metaKey||e.ctrlKey},s=function(t,a){var n=!0;if(e.cy.hasCompoundNodes()&&t&&t.pannable())for(var i=0;a&&i<a.length;i++){if((t=a[i]).isNode()&&t.isParent()){n=!1;break}}else n=!0;return n},r=function(e){e[0]._private.rscratch.inDragLayer=!0},o=function(e){e[0]._private.rscratch.isGrabTarget=!0},l=function(e,t){var a=t.addToList;a.has(e)||(a.merge(e),function(e){e[0]._private.grabbed=!0}(e))},c=function(t,a){a=a||{};var n=t.cy().hasCompoundNodes();a.inDragLayer&&(t.forEach(r),t.neighborhood().stdFilter((function(e){return!n||e.isEdge()})).forEach(r)),a.addToList&&t.forEach((function(e){l(e,a)})),function(e,t){if(e.cy().hasCompoundNodes()&&(null!=t.inDragLayer||null!=t.addToList)){var a=e.descendants();t.inDragLayer&&(a.forEach(r),a.connectedEdges().forEach(r)),t.addToList&&t.addToList.unmerge(a)}}(t,a),p(t,{inDragLayer:a.inDragLayer}),e.updateCachedGrabbedEles()},d=c,u=function(t){t&&(e.getCachedZSortedEles().forEach((function(e){!function(e){e[0]._private.grabbed=!1}(e),function(e){e[0]._private.rscratch.inDragLayer=!1}(e),function(e){e[0]._private.rscratch.isGrabTarget=!1}(e)})),e.updateCachedGrabbedEles())},p=function(e,t){if((null!=t.inDragLayer||null!=t.addToList)&&e.cy().hasCompoundNodes()){var a=e.ancestors().orphans();if(!a.same(e)){var n=a.descendants().spawnSelf().merge(a).unmerge(e).unmerge(e.descendants()),i=n.connectedEdges();t.inDragLayer&&(i.forEach(r),n.forEach(r)),t.addToList&&n.forEach((function(e){l(e,t)}))}}},m=function(){null!=document.activeElement&&null!=document.activeElement.blur&&document.activeElement.blur()},b="undefined"!=typeof MutationObserver,f="undefined"!=typeof ResizeObserver;b?(e.removeObserver=new MutationObserver((function(t){for(var a=0;a<t.length;a++){var n=t[a].removedNodes;if(n)for(var i=0;i<n.length;i++){if(n[i]===e.container){e.destroy();break}}}})),e.container.parentNode&&e.removeObserver.observe(e.container.parentNode,{childList:!0})):e.registerBinding(e.container,"DOMNodeRemoved",(function(t){e.destroy()}));var h=i((function(){e.cy.resize()}),100);b&&(e.styleObserver=new MutationObserver(h),e.styleObserver.observe(e.container,{attributes:!0})),e.registerBinding(window,"resize",h),f&&(e.resizeObserver=new ResizeObserver(h),e.resizeObserver.observe(e.container));var g=function(){e.invalidateContainerClientCoordsCache()};!function(e,t){for(;null!=e;)t(e),e=e.parentNode}(e.container,(function(t){e.registerBinding(t,"transitionend",g),e.registerBinding(t,"animationend",g),e.registerBinding(t,"scroll",g)})),e.registerBinding(e.container,"contextmenu",(function(e){e.preventDefault()}));var j=function(t){for(var a=e.findContainerClientCoords(),n=a[0],i=a[1],s=a[2],r=a[3],o=t.touches?t.touches:[t],l=!1,c=0;c<o.length;c++){var d=o[c];if(n<=d.clientX&&d.clientX<=n+s&&i<=d.clientY&&d.clientY<=i+r){l=!0;break}}if(!l)return!1;for(var u=e.container,p=t.target.parentNode,m=!1;p;){if(p===u){m=!0;break}p=p.parentNode}return!!m};e.registerBinding(e.container,"mousedown",(function(t){if(j(t)){t.preventDefault(),m(),e.hoverData.capture=!0,e.hoverData.which=t.which;var n=e.cy,i=[t.clientX,t.clientY],s=e.projectIntoViewport(i[0],i[1]),r=e.selection,l=e.findNearestElements(s[0],s[1],!0,!1),u=l[0],p=e.dragData.possibleDragElements;e.hoverData.mdownPos=s,e.hoverData.mdownGPos=i;if(3==t.which){e.hoverData.cxtStarted=!0;var b={originalEvent:t,type:"cxttapstart",position:{x:s[0],y:s[1]}};u?(u.activate(),u.emit(b),e.hoverData.down=u):n.emit(b),e.hoverData.downTime=(new Date).getTime(),e.hoverData.cxtDragged=!1}else if(1==t.which){if(u&&u.activate(),null!=u&&e.nodeIsGrabbable(u)){var f=function(e){return{originalEvent:t,type:e,position:{x:s[0],y:s[1]}}};if(o(u),u.selected()){p=e.dragData.possibleDragElements=n.collection();var h=n.$((function(t){return t.isNode()&&t.selected()&&e.nodeIsGrabbable(t)}));c(h,{addToList:p}),u.emit(f("grabon")),h.forEach((function(e){e.emit(f("grab"))}))}else p=e.dragData.possibleDragElements=n.collection(),d(u,{addToList:p}),u.emit(f("grabon")).emit(f("grab"));e.redrawHint("eles",!0),e.redrawHint("drag",!0)}e.hoverData.down=u,e.hoverData.downs=l,e.hoverData.downTime=(new Date).getTime(),a(u,["mousedown","tapstart","vmousedown"],t,{x:s[0],y:s[1]}),null==u?(r[4]=1,e.data.bgActivePosistion={x:s[0],y:s[1]},e.redrawHint("select",!0),e.redraw()):u.pannable()&&(r[4]=1),e.hoverData.tapholdCancelled=!1,clearTimeout(e.hoverData.tapholdTimeout),e.hoverData.tapholdTimeout=setTimeout((function(){if(!e.hoverData.tapholdCancelled){var a=e.hoverData.down;a?a.emit({originalEvent:t,type:"taphold",position:{x:s[0],y:s[1]}}):n.emit({originalEvent:t,type:"taphold",position:{x:s[0],y:s[1]}})}}),e.tapholdDuration)}r[0]=r[2]=s[0],r[1]=r[3]=s[1]}}),!1),e.registerBinding(window,"mousemove",(function(t){if(e.hoverData.capture||j(t)){var i=!1,r=e.cy,o=r.zoom(),l=[t.clientX,t.clientY],d=e.projectIntoViewport(l[0],l[1]),p=e.hoverData.mdownPos,m=e.hoverData.mdownGPos,b=e.selection,f=null;e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.selecting||(f=e.findNearestElement(d[0],d[1],!0,!1));var h,g=e.hoverData.last,x=e.hoverData.down,v=[d[0]-b[2],d[1]-b[3]],y=e.dragData.possibleDragElements;if(m){var E=l[0]-m[0],w=E*E,M=l[1]-m[1],S=w+M*M;e.hoverData.isOverThresholdDrag=h=S>=e.desktopTapThreshold2}var _=n(t);h&&(e.hoverData.tapholdCancelled=!0);i=!0,a(f,["mousemove","vmousemove","tapdrag"],t,{x:d[0],y:d[1]});var T=function(){e.data.bgActivePosistion=void 0,e.hoverData.selecting||r.emit({originalEvent:t,type:"boxstart",position:{x:d[0],y:d[1]}}),b[4]=1,e.hoverData.selecting=!0,e.redrawHint("select",!0),e.redraw()};if(3===e.hoverData.which){if(h){var C={originalEvent:t,type:"cxtdrag",position:{x:d[0],y:d[1]}};x?x.emit(C):r.emit(C),e.hoverData.cxtDragged=!0,e.hoverData.cxtOver&&f===e.hoverData.cxtOver||(e.hoverData.cxtOver&&e.hoverData.cxtOver.emit({originalEvent:t,type:"cxtdragout",position:{x:d[0],y:d[1]}}),e.hoverData.cxtOver=f,f&&f.emit({originalEvent:t,type:"cxtdragover",position:{x:d[0],y:d[1]}}))}}else if(e.hoverData.dragging){if(i=!0,r.panningEnabled()&&r.userPanningEnabled()){var k;if(e.hoverData.justStartedPan){var F=e.hoverData.mdownPos;k={x:(d[0]-F[0])*o,y:(d[1]-F[1])*o},e.hoverData.justStartedPan=!1}else k={x:v[0]*o,y:v[1]*o};r.panBy(k),e.hoverData.dragged=!0}d=e.projectIntoViewport(t.clientX,t.clientY)}else if(1!=b[4]||null!=x&&!x.pannable()){if(x&&x.pannable()&&x.active()&&x.unactivate(),x&&x.grabbed()||f==g||(g&&a(g,["mouseout","tapdragout"],t,{x:d[0],y:d[1]}),f&&a(f,["mouseover","tapdragover"],t,{x:d[0],y:d[1]}),e.hoverData.last=f),x)if(h){if(r.boxSelectionEnabled()&&_)x&&x.grabbed()&&(u(y),x.emit("freeon"),y.emit("free"),e.dragData.didDrag&&(x.emit("dragfreeon"),y.emit("dragfree"))),T();else if(x&&x.grabbed()&&e.nodeIsDraggable(x)){var I=!e.dragData.didDrag;I&&e.redrawHint("eles",!0),e.dragData.didDrag=!0;var D=r.collection();e.hoverData.draggingEles||c(y,{inDragLayer:!0});var A={x:0,y:0};if(O(v[0])&&O(v[1])&&(A.x+=v[0],A.y+=v[1],I)){var L=e.hoverData.dragDelta;L&&O(L[0])&&O(L[1])&&(A.x+=L[0],A.y+=L[1])}for(var R=0;R<y.length;R++){var N=y[R];e.nodeIsDraggable(N)&&N.grabbed()&&D.merge(N)}e.hoverData.draggingEles=!0,D.silentShift(A).emit("position drag"),e.redrawHint("drag",!0),e.redraw()}}else!function(){var t=e.hoverData.dragDelta=e.hoverData.dragDelta||[];0===t.length?(t.push(v[0]),t.push(v[1])):(t[0]+=v[0],t[1]+=v[1])}();i=!0}else if(h){if(e.hoverData.dragging||!r.boxSelectionEnabled()||!_&&r.panningEnabled()&&r.userPanningEnabled()){if(!e.hoverData.selecting&&r.panningEnabled()&&r.userPanningEnabled()){s(x,e.hoverData.downs)&&(e.hoverData.dragging=!0,e.hoverData.justStartedPan=!0,b[4]=0,e.data.bgActivePosistion=Ve(p),e.redrawHint("select",!0),e.redraw())}}else T();x&&x.pannable()&&x.active()&&x.unactivate()}return b[2]=d[0],b[3]=d[1],i?(t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),!1):void 0}}),!1),e.registerBinding(window,"mouseup",(function(i){if(e.hoverData.capture){e.hoverData.capture=!1;var s=e.cy,r=e.projectIntoViewport(i.clientX,i.clientY),o=e.selection,l=e.findNearestElement(r[0],r[1],!0,!1),c=e.dragData.possibleDragElements,d=e.hoverData.down,p=n(i);if(e.data.bgActivePosistion&&(e.redrawHint("select",!0),e.redraw()),e.hoverData.tapholdCancelled=!0,e.data.bgActivePosistion=void 0,d&&d.unactivate(),3===e.hoverData.which){var m={originalEvent:i,type:"cxttapend",position:{x:r[0],y:r[1]}};if(d?d.emit(m):s.emit(m),!e.hoverData.cxtDragged){var b={originalEvent:i,type:"cxttap",position:{x:r[0],y:r[1]}};d?d.emit(b):s.emit(b)}e.hoverData.cxtDragged=!1,e.hoverData.which=null}else if(1===e.hoverData.which){if(a(l,["mouseup","tapend","vmouseup"],i,{x:r[0],y:r[1]}),e.dragData.didDrag||e.hoverData.dragged||e.hoverData.selecting||e.hoverData.isOverThresholdDrag||a(d,["click","tap","vclick"],i,{x:r[0],y:r[1]}),null!=d||e.dragData.didDrag||e.hoverData.selecting||e.hoverData.dragged||n(i)||(s.$(t).unselect(["tapunselect"]),c.length>0&&e.redrawHint("eles",!0),e.dragData.possibleDragElements=c=s.collection()),l!=d||e.dragData.didDrag||e.hoverData.selecting||null!=l&&l._private.selectable&&(e.hoverData.dragging||("additive"===s.selectionType()||p?l.selected()?l.unselect(["tapunselect"]):l.select(["tapselect"]):p||(s.$(t).unmerge(l).unselect(["tapunselect"]),l.select(["tapselect"]))),e.redrawHint("eles",!0)),e.hoverData.selecting){var f=s.collection(e.getAllInBox(o[0],o[1],o[2],o[3]));e.redrawHint("select",!0),f.length>0&&e.redrawHint("eles",!0),s.emit({type:"boxend",originalEvent:i,position:{x:r[0],y:r[1]}});var h=function(e){return e.selectable()&&!e.selected()};"additive"===s.selectionType()||p||s.$(t).unmerge(f).unselect(),f.emit("box").stdFilter(h).select().emit("boxselect"),e.redraw()}if(e.hoverData.dragging&&(e.hoverData.dragging=!1,e.redrawHint("select",!0),e.redrawHint("eles",!0),e.redraw()),!o[4]){e.redrawHint("drag",!0),e.redrawHint("eles",!0);var g=d&&d.grabbed();u(c),g&&(d.emit("freeon"),c.emit("free"),e.dragData.didDrag&&(d.emit("dragfreeon"),c.emit("dragfree")))}}o[4]=0,e.hoverData.down=null,e.hoverData.cxtStarted=!1,e.hoverData.draggingEles=!1,e.hoverData.selecting=!1,e.hoverData.isOverThresholdDrag=!1,e.dragData.didDrag=!1,e.hoverData.dragged=!1,e.hoverData.dragDelta=[],e.hoverData.mdownPos=null,e.hoverData.mdownGPos=null}}),!1);var x,v,y,E,w,M,S,_,T,C,k,F,I;e.registerBinding(e.container,"wheel",(function(t){if(!e.scrollingPage){var a,n=e.cy,i=e.projectIntoViewport(t.clientX,t.clientY),s=[i[0]*n.zoom()+n.pan().x,i[1]*n.zoom()+n.pan().y];if(e.hoverData.draggingEles||e.hoverData.dragging||e.hoverData.cxtStarted||0!==e.selection[4])t.preventDefault();else if(n.panningEnabled()&&n.userPanningEnabled()&&n.zoomingEnabled()&&n.userZoomingEnabled())t.preventDefault(),e.data.wheelZooming=!0,clearTimeout(e.data.wheelTimeout),e.data.wheelTimeout=setTimeout((function(){e.data.wheelZooming=!1,e.redrawHint("eles",!0),e.redraw()}),150),a=null!=t.deltaY?t.deltaY/-250:null!=t.wheelDeltaY?t.wheelDeltaY/1e3:t.wheelDelta/1e3,a*=e.wheelSensitivity,1===t.deltaMode&&(a*=33),n.zoom({level:n.zoom()*Math.pow(10,a),renderedPosition:{x:s[0],y:s[1]}})}}),!0),e.registerBinding(window,"scroll",(function(t){e.scrollingPage=!0,clearTimeout(e.scrollingPageTimeout),e.scrollingPageTimeout=setTimeout((function(){e.scrollingPage=!1}),250)}),!0),e.registerBinding(e.container,"mouseout",(function(t){var a=e.projectIntoViewport(t.clientX,t.clientY);e.cy.emit({originalEvent:t,type:"mouseout",position:{x:a[0],y:a[1]}})}),!1),e.registerBinding(e.container,"mouseover",(function(t){var a=e.projectIntoViewport(t.clientX,t.clientY);e.cy.emit({originalEvent:t,type:"mouseover",position:{x:a[0],y:a[1]}})}),!1);var D,A,L,R,N=function(e,t,a,n){return Math.sqrt((a-e)*(a-e)+(n-t)*(n-t))},P=function(e,t,a,n){return(a-e)*(a-e)+(n-t)*(n-t)};if(e.registerBinding(e.container,"touchstart",D=function(t){if(j(t)){m(),e.touchData.capture=!0,e.data.bgActivePosistion=void 0;var n=e.cy,i=e.touchData.now,s=e.touchData.earlier;if(t.touches[0]){var r=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);i[0]=r[0],i[1]=r[1]}if(t.touches[1]){r=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);i[2]=r[0],i[3]=r[1]}if(t.touches[2]){r=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);i[4]=r[0],i[5]=r[1]}if(t.touches[1]){e.touchData.singleTouchMoved=!0,u(e.dragData.touchDragEles);var l=e.findContainerClientCoords();T=l[0],C=l[1],k=l[2],F=l[3],x=t.touches[0].clientX-T,v=t.touches[0].clientY-C,y=t.touches[1].clientX-T,E=t.touches[1].clientY-C,I=0<=x&&x<=k&&0<=y&&y<=k&&0<=v&&v<=F&&0<=E&&E<=F;var p=n.pan(),b=n.zoom();w=N(x,v,y,E),M=P(x,v,y,E),_=[((S=[(x+y)/2,(v+E)/2])[0]-p.x)/b,(S[1]-p.y)/b];if(M<4e4&&!t.touches[2]){var f=e.findNearestElement(i[0],i[1],!0,!0),h=e.findNearestElement(i[2],i[3],!0,!0);return f&&f.isNode()?(f.activate().emit({originalEvent:t,type:"cxttapstart",position:{x:i[0],y:i[1]}}),e.touchData.start=f):h&&h.isNode()?(h.activate().emit({originalEvent:t,type:"cxttapstart",position:{x:i[0],y:i[1]}}),e.touchData.start=h):n.emit({originalEvent:t,type:"cxttapstart",position:{x:i[0],y:i[1]}}),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!0,e.touchData.cxtDragged=!1,e.data.bgActivePosistion=void 0,void e.redraw()}}if(t.touches[2])n.boxSelectionEnabled()&&t.preventDefault();else if(t.touches[1]);else if(t.touches[0]){var g=e.findNearestElements(i[0],i[1],!0,!0),O=g[0];if(null!=O&&(O.activate(),e.touchData.start=O,e.touchData.starts=g,e.nodeIsGrabbable(O))){var D=e.dragData.touchDragEles=n.collection(),A=null;e.redrawHint("eles",!0),e.redrawHint("drag",!0),O.selected()?(A=n.$((function(t){return t.selected()&&e.nodeIsGrabbable(t)})),c(A,{addToList:D})):d(O,{addToList:D}),o(O);var L=function(e){return{originalEvent:t,type:e,position:{x:i[0],y:i[1]}}};O.emit(L("grabon")),A?A.forEach((function(e){e.emit(L("grab"))})):O.emit(L("grab"))}a(O,["touchstart","tapstart","vmousedown"],t,{x:i[0],y:i[1]}),null==O&&(e.data.bgActivePosistion={x:r[0],y:r[1]},e.redrawHint("select",!0),e.redraw()),e.touchData.singleTouchMoved=!1,e.touchData.singleTouchStartTime=+new Date,clearTimeout(e.touchData.tapholdTimeout),e.touchData.tapholdTimeout=setTimeout((function(){!1!==e.touchData.singleTouchMoved||e.pinching||e.touchData.selecting||a(e.touchData.start,["taphold"],t,{x:i[0],y:i[1]})}),e.tapholdDuration)}if(t.touches.length>=1){for(var R=e.touchData.startPosition=[],z=0;z<i.length;z++)R[z]=s[z]=i[z];var B=t.touches[0];e.touchData.startGPosition=[B.clientX,B.clientY]}}},!1),e.registerBinding(window,"touchmove",A=function(t){var n=e.touchData.capture;if(n||j(t)){var i=e.selection,r=e.cy,o=e.touchData.now,l=e.touchData.earlier,d=r.zoom();if(t.touches[0]){var p=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);o[0]=p[0],o[1]=p[1]}if(t.touches[1]){p=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);o[2]=p[0],o[3]=p[1]}if(t.touches[2]){p=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);o[4]=p[0],o[5]=p[1]}var m,b=e.touchData.startGPosition;if(n&&t.touches[0]&&b){for(var f=[],h=0;h<o.length;h++)f[h]=o[h]-l[h];var g=t.touches[0].clientX-b[0],S=g*g,k=t.touches[0].clientY-b[1];m=S+k*k>=e.touchTapThreshold2}if(n&&e.touchData.cxt){t.preventDefault();var F=t.touches[0].clientX-T,D=t.touches[0].clientY-C,A=t.touches[1].clientX-T,L=t.touches[1].clientY-C,R=P(F,D,A,L);if(R/M>=2.25||R>=22500){e.touchData.cxt=!1,e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var z={originalEvent:t,type:"cxttapend",position:{x:o[0],y:o[1]}};e.touchData.start?(e.touchData.start.unactivate().emit(z),e.touchData.start=null):r.emit(z)}}if(n&&e.touchData.cxt){z={originalEvent:t,type:"cxtdrag",position:{x:o[0],y:o[1]}};e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.touchData.start?e.touchData.start.emit(z):r.emit(z),e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxtDragged=!0;var B=e.findNearestElement(o[0],o[1],!0,!0);e.touchData.cxtOver&&B===e.touchData.cxtOver||(e.touchData.cxtOver&&e.touchData.cxtOver.emit({originalEvent:t,type:"cxtdragout",position:{x:o[0],y:o[1]}}),e.touchData.cxtOver=B,B&&B.emit({originalEvent:t,type:"cxtdragover",position:{x:o[0],y:o[1]}}))}else if(n&&t.touches[2]&&r.boxSelectionEnabled())t.preventDefault(),e.data.bgActivePosistion=void 0,this.lastThreeTouch=+new Date,e.touchData.selecting||r.emit({originalEvent:t,type:"boxstart",position:{x:o[0],y:o[1]}}),e.touchData.selecting=!0,e.touchData.didSelect=!0,i[4]=1,i&&0!==i.length&&void 0!==i[0]?(i[2]=(o[0]+o[2]+o[4])/3,i[3]=(o[1]+o[3]+o[5])/3):(i[0]=(o[0]+o[2]+o[4])/3,i[1]=(o[1]+o[3]+o[5])/3,i[2]=(o[0]+o[2]+o[4])/3+1,i[3]=(o[1]+o[3]+o[5])/3+1),e.redrawHint("select",!0),e.redraw();else if(n&&t.touches[1]&&!e.touchData.didSelect&&r.zoomingEnabled()&&r.panningEnabled()&&r.userZoomingEnabled()&&r.userPanningEnabled()){if(t.preventDefault(),e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),ee=e.dragData.touchDragEles){e.redrawHint("drag",!0);for(var J=0;J<ee.length;J++){var V=ee[J]._private;V.grabbed=!1,V.rscratch.inDragLayer=!1}}var U=e.touchData.start,G=(F=t.touches[0].clientX-T,D=t.touches[0].clientY-C,A=t.touches[1].clientX-T,L=t.touches[1].clientY-C,N(F,D,A,L)),q=G/w;if(I){var W=(F-x+(A-y))/2,H=(D-v+(L-E))/2,Y=r.zoom(),$=Y*q,X=r.pan(),K=_[0]*Y+X.x,Q=_[1]*Y+X.y,Z={x:-$/Y*(K-X.x-W)+K,y:-$/Y*(Q-X.y-H)+Q};if(U&&U.active()){var ee=e.dragData.touchDragEles;u(ee),e.redrawHint("drag",!0),e.redrawHint("eles",!0),U.unactivate().emit("freeon"),ee.emit("free"),e.dragData.didDrag&&(U.emit("dragfreeon"),ee.emit("dragfree"))}r.viewport({zoom:$,pan:Z,cancelOnFailedZoom:!0}),w=G,x=F,v=D,y=A,E=L,e.pinching=!0}if(t.touches[0]){p=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);o[0]=p[0],o[1]=p[1]}if(t.touches[1]){p=e.projectIntoViewport(t.touches[1].clientX,t.touches[1].clientY);o[2]=p[0],o[3]=p[1]}if(t.touches[2]){p=e.projectIntoViewport(t.touches[2].clientX,t.touches[2].clientY);o[4]=p[0],o[5]=p[1]}}else if(t.touches[0]&&!e.touchData.didSelect){var te=e.touchData.start,ae=e.touchData.last;if(e.hoverData.draggingEles||e.swipePanning||(B=e.findNearestElement(o[0],o[1],!0,!0)),n&&null!=te&&t.preventDefault(),n&&null!=te&&e.nodeIsDraggable(te))if(m){ee=e.dragData.touchDragEles;var ne=!e.dragData.didDrag;ne&&c(ee,{inDragLayer:!0}),e.dragData.didDrag=!0;var ie={x:0,y:0};if(O(f[0])&&O(f[1]))if(ie.x+=f[0],ie.y+=f[1],ne)e.redrawHint("eles",!0),(se=e.touchData.dragDelta)&&O(se[0])&&O(se[1])&&(ie.x+=se[0],ie.y+=se[1]);e.hoverData.draggingEles=!0,ee.silentShift(ie).emit("position drag"),e.redrawHint("drag",!0),e.touchData.startPosition[0]==l[0]&&e.touchData.startPosition[1]==l[1]&&e.redrawHint("eles",!0),e.redraw()}else{var se;0===(se=e.touchData.dragDelta=e.touchData.dragDelta||[]).length?(se.push(f[0]),se.push(f[1])):(se[0]+=f[0],se[1]+=f[1])}if(a(te||B,["touchmove","tapdrag","vmousemove"],t,{x:o[0],y:o[1]}),te&&te.grabbed()||B==ae||(ae&&ae.emit({originalEvent:t,type:"tapdragout",position:{x:o[0],y:o[1]}}),B&&B.emit({originalEvent:t,type:"tapdragover",position:{x:o[0],y:o[1]}})),e.touchData.last=B,n)for(J=0;J<o.length;J++)o[J]&&e.touchData.startPosition[J]&&m&&(e.touchData.singleTouchMoved=!0);if(n&&(null==te||te.pannable())&&r.panningEnabled()&&r.userPanningEnabled()){s(te,e.touchData.starts)&&(t.preventDefault(),e.data.bgActivePosistion||(e.data.bgActivePosistion=Ve(e.touchData.startPosition)),e.swipePanning?r.panBy({x:f[0]*d,y:f[1]*d}):m&&(e.swipePanning=!0,r.panBy({x:g*d,y:k*d}),te&&(te.unactivate(),e.redrawHint("select",!0),e.touchData.start=null)));p=e.projectIntoViewport(t.touches[0].clientX,t.touches[0].clientY);o[0]=p[0],o[1]=p[1]}}for(h=0;h<o.length;h++)l[h]=o[h];n&&t.touches.length>0&&!e.hoverData.draggingEles&&!e.swipePanning&&null!=e.data.bgActivePosistion&&(e.data.bgActivePosistion=void 0,e.redrawHint("select",!0),e.redraw())}},!1),e.registerBinding(window,"touchcancel",L=function(t){var a=e.touchData.start;e.touchData.capture=!1,a&&a.unactivate()}),e.registerBinding(window,"touchend",R=function(n){var i=e.touchData.start;if(e.touchData.capture){0===n.touches.length&&(e.touchData.capture=!1),n.preventDefault();var s=e.selection;e.swipePanning=!1,e.hoverData.draggingEles=!1;var r,o=e.cy,l=o.zoom(),c=e.touchData.now,d=e.touchData.earlier;if(n.touches[0]){var p=e.projectIntoViewport(n.touches[0].clientX,n.touches[0].clientY);c[0]=p[0],c[1]=p[1]}if(n.touches[1]){p=e.projectIntoViewport(n.touches[1].clientX,n.touches[1].clientY);c[2]=p[0],c[3]=p[1]}if(n.touches[2]){p=e.projectIntoViewport(n.touches[2].clientX,n.touches[2].clientY);c[4]=p[0],c[5]=p[1]}if(i&&i.unactivate(),e.touchData.cxt){if(r={originalEvent:n,type:"cxttapend",position:{x:c[0],y:c[1]}},i?i.emit(r):o.emit(r),!e.touchData.cxtDragged){var m={originalEvent:n,type:"cxttap",position:{x:c[0],y:c[1]}};i?i.emit(m):o.emit(m)}return e.touchData.start&&(e.touchData.start._private.grabbed=!1),e.touchData.cxt=!1,e.touchData.start=null,void e.redraw()}if(!n.touches[2]&&o.boxSelectionEnabled()&&e.touchData.selecting){e.touchData.selecting=!1;var b=o.collection(e.getAllInBox(s[0],s[1],s[2],s[3]));s[0]=void 0,s[1]=void 0,s[2]=void 0,s[3]=void 0,s[4]=0,e.redrawHint("select",!0),o.emit({type:"boxend",originalEvent:n,position:{x:c[0],y:c[1]}});b.emit("box").stdFilter((function(e){return e.selectable()&&!e.selected()})).select().emit("boxselect"),b.nonempty()&&e.redrawHint("eles",!0),e.redraw()}if(null!=i&&i.unactivate(),n.touches[2])e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);else if(n.touches[1]);else if(n.touches[0]);else if(!n.touches[0]){e.data.bgActivePosistion=void 0,e.redrawHint("select",!0);var f=e.dragData.touchDragEles;if(null!=i){var h=i._private.grabbed;u(f),e.redrawHint("drag",!0),e.redrawHint("eles",!0),h&&(i.emit("freeon"),f.emit("free"),e.dragData.didDrag&&(i.emit("dragfreeon"),f.emit("dragfree"))),a(i,["touchend","tapend","vmouseup","tapdragout"],n,{x:c[0],y:c[1]}),i.unactivate(),e.touchData.start=null}else{var g=e.findNearestElement(c[0],c[1],!0,!0);a(g,["touchend","tapend","vmouseup","tapdragout"],n,{x:c[0],y:c[1]})}var j=e.touchData.startPosition[0]-c[0],x=j*j,v=e.touchData.startPosition[1]-c[1],y=(x+v*v)*l*l;e.touchData.singleTouchMoved||(i||o.$(":selected").unselect(["tapunselect"]),a(i,["tap","vclick"],n,{x:c[0],y:c[1]})),null!=i&&!e.dragData.didDrag&&i._private.selectable&&y<e.touchTapThreshold2&&!e.pinching&&("single"===o.selectionType()?(o.$(t).unmerge(i).unselect(["tapunselect"]),i.select(["tapselect"])):i.selected()?i.unselect(["tapunselect"]):i.select(["tapselect"]),e.redrawHint("eles",!0)),e.touchData.singleTouchMoved=!0}for(var O=0;O<c.length;O++)d[O]=c[O];e.dragData.didDrag=!1,0===n.touches.length&&(e.touchData.dragDelta=[],e.touchData.startPosition=null,e.touchData.startGPosition=null,e.touchData.didSelect=!1),n.touches.length<2&&(1===n.touches.length&&(e.touchData.startGPosition=[n.touches[0].clientX,n.touches[0].clientY]),e.pinching=!1,e.redrawHint("eles",!0),e.redraw())}},!1),"undefined"==typeof TouchEvent){var z=[],B=function(e){return{clientX:e.clientX,clientY:e.clientY,force:1,identifier:e.pointerId,pageX:e.pageX,pageY:e.pageY,radiusX:e.width/2,radiusY:e.height/2,screenX:e.screenX,screenY:e.screenY,target:e.target}},J=function(e){z.push(function(e){return{event:e,touch:B(e)}}(e))},V=function(e){for(var t=0;t<z.length;t++){if(z[t].event.pointerId===e.pointerId)return void z.splice(t,1)}},U=function(e){e.touches=z.map((function(e){return e.touch}))},G=function(e){return"mouse"===e.pointerType||4===e.pointerType};e.registerBinding(e.container,"pointerdown",(function(e){G(e)||(e.preventDefault(),J(e),U(e),D(e))})),e.registerBinding(e.container,"pointerup",(function(e){G(e)||(V(e),U(e),R(e))})),e.registerBinding(e.container,"pointercancel",(function(e){G(e)||(V(e),U(e),L())})),e.registerBinding(e.container,"pointermove",(function(e){G(e)||(e.preventDefault(),function(e){var t=z.filter((function(t){return t.event.pointerId===e.pointerId}))[0];t.event=e,t.touch=B(e)}(e),U(e),A(e))}))}};var Vr={generatePolygon:function(e,t){return this.nodeShapes[e]={renderer:this,name:e,points:t,draw:function(e,t,a,n,i){this.renderer.nodeShapeImpl("polygon",e,t,a,n,i,this.points)},intersectLine:function(e,t,a,n,i,s,r){return vt(i,s,this.points,e,t,a/2,n/2,r)},checkPoint:function(e,t,a,n,i,s,r){return mt(e,t,this.points,s,r,n,i,[0,-1],a)}}}};Vr.generateEllipse=function(){return this.nodeShapes.ellipse={renderer:this,name:"ellipse",draw:function(e,t,a,n,i){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i)},intersectLine:function(e,t,a,n,i,s,r){return function(e,t,a,n,i,s){var r=a-e,o=n-t;r/=i,o/=s;var l=Math.sqrt(r*r+o*o),c=l-1;if(c<0)return[];var d=c/l;return[(a-e)*d+e,(n-t)*d+t]}(i,s,e,t,a/2+r,n/2+r)},checkPoint:function(e,t,a,n,i,s,r){return ht(e,t,n,i,s,r,a)}}},Vr.generateRoundRectangle=function(){return this.nodeShapes["round-rectangle"]=this.nodeShapes.roundrectangle={renderer:this,name:"round-rectangle",points:Ot(4,0),draw:function(e,t,a,n,i){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i)},intersectLine:function(e,t,a,n,i,s,r){return ot(i,s,e,t,a,n,r)},checkPoint:function(e,t,a,n,i,s,r){var o=Mt(n,i),l=2*o;return!!mt(e,t,this.points,s,r,n,i-l,[0,-1],a)||(!!mt(e,t,this.points,s,r,n-l,i,[0,-1],a)||(!!ht(e,t,l,l,s-n/2+o,r-i/2+o,a)||(!!ht(e,t,l,l,s+n/2-o,r-i/2+o,a)||(!!ht(e,t,l,l,s+n/2-o,r+i/2-o,a)||!!ht(e,t,l,l,s-n/2+o,r+i/2-o,a)))))}}},Vr.generateCutRectangle=function(){return this.nodeShapes["cut-rectangle"]=this.nodeShapes.cutrectangle={renderer:this,name:"cut-rectangle",cornerLength:8,points:Ot(4,0),draw:function(e,t,a,n,i){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i)},generateCutTrianglePts:function(e,t,a,n){var i=this.cornerLength,s=t/2,r=e/2,o=a-r,l=a+r,c=n-s,d=n+s;return{topLeft:[o,c+i,o+i,c,o+i,c+i],topRight:[l-i,c,l,c+i,l-i,c+i],bottomRight:[l,d-i,l-i,d,l-i,d-i],bottomLeft:[o+i,d,o,d-i,o+i,d-i]}},intersectLine:function(e,t,a,n,i,s,r){var o=this.generateCutTrianglePts(a+2*r,n+2*r,e,t),l=[].concat.apply([],[o.topLeft.splice(0,4),o.topRight.splice(0,4),o.bottomRight.splice(0,4),o.bottomLeft.splice(0,4)]);return vt(i,s,l,e,t)},checkPoint:function(e,t,a,n,i,s,r){if(mt(e,t,this.points,s,r,n,i-2*this.cornerLength,[0,-1],a))return!0;if(mt(e,t,this.points,s,r,n-2*this.cornerLength,i,[0,-1],a))return!0;var o=this.generateCutTrianglePts(n,i,s,r);return pt(e,t,o.topLeft)||pt(e,t,o.topRight)||pt(e,t,o.bottomRight)||pt(e,t,o.bottomLeft)}}},Vr.generateBarrel=function(){return this.nodeShapes.barrel={renderer:this,name:"barrel",points:Ot(4,0),draw:function(e,t,a,n,i){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i)},intersectLine:function(e,t,a,n,i,s,r){var o=this.generateBarrelBezierPts(a+2*r,n+2*r,e,t),l=function(e){var t=Xe({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},.15),a=Xe({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},.5),n=Xe({x:e[0],y:e[1]},{x:e[2],y:e[3]},{x:e[4],y:e[5]},.85);return[e[0],e[1],t.x,t.y,a.x,a.y,n.x,n.y,e[4],e[5]]},c=[].concat(l(o.topLeft),l(o.topRight),l(o.bottomRight),l(o.bottomLeft));return vt(i,s,c,e,t)},generateBarrelBezierPts:function(e,t,a,n){var i=t/2,s=e/2,r=a-s,o=a+s,l=n-i,c=n+i,d=St(e,t),u=d.heightOffset,p=d.widthOffset,m=d.ctrlPtOffsetPct*e,b={topLeft:[r,l+u,r+m,l,r+p,l],topRight:[o-p,l,o-m,l,o,l+u],bottomRight:[o,c-u,o-m,c,o-p,c],bottomLeft:[r+p,c,r+m,c,r,c-u]};return b.topLeft.isTop=!0,b.topRight.isTop=!0,b.bottomLeft.isBottom=!0,b.bottomRight.isBottom=!0,b},checkPoint:function(e,t,a,n,i,s,r){var o=St(n,i),l=o.heightOffset,c=o.widthOffset;if(mt(e,t,this.points,s,r,n,i-2*l,[0,-1],a))return!0;if(mt(e,t,this.points,s,r,n-2*c,i,[0,-1],a))return!0;for(var d=this.generateBarrelBezierPts(n,i,s,r),u=function(e,t,a){var n,i,s=a[4],r=a[2],o=a[0],l=a[5],c=a[1],d=Math.min(s,o),u=Math.max(s,o),p=Math.min(l,c),m=Math.max(l,c);if(d<=e&&e<=u&&p<=t&&t<=m){var b=[(n=s)-2*(i=r)+o,2*(i-n),n],f=function(e,t,a,n){var i=t*t-4*e*(a-=n);if(i<0)return[];var s=Math.sqrt(i),r=2*e;return[(-t+s)/r,(-t-s)/r]}(b[0],b[1],b[2],e).filter((function(e){return 0<=e&&e<=1}));if(f.length>0)return f[0]}return null},p=Object.keys(d),m=0;m<p.length;m++){var b=d[p[m]],f=u(e,t,b);if(null!=f){var h=b[5],g=b[3],j=b[1],x=$e(h,g,j,f);if(b.isTop&&x<=t)return!0;if(b.isBottom&&t<=x)return!0}}return!1}}},Vr.generateBottomRoundrectangle=function(){return this.nodeShapes["bottom-round-rectangle"]=this.nodeShapes.bottomroundrectangle={renderer:this,name:"bottom-round-rectangle",points:Ot(4,0),draw:function(e,t,a,n,i){this.renderer.nodeShapeImpl(this.name,e,t,a,n,i)},intersectLine:function(e,t,a,n,i,s,r){var o=t-(n/2+r),l=xt(i,s,e,t,e-(a/2+r),o,e+(a/2+r),o,!1);return l.length>0?l:ot(i,s,e,t,a,n,r)},checkPoint:function(e,t,a,n,i,s,r){var o=Mt(n,i),l=2*o;if(mt(e,t,this.points,s,r,n,i-l,[0,-1],a))return!0;if(mt(e,t,this.points,s,r,n-l,i,[0,-1],a))return!0;var c=n/2+2*a,d=i/2+2*a;return!!pt(e,t,[s-c,r-d,s-c,r,s+c,r,s+c,r-d])||(!!ht(e,t,l,l,s+n/2-o,r+i/2-o,a)||!!ht(e,t,l,l,s-n/2+o,r+i/2-o,a))}}},Vr.registerNodeShapes=function(){var e=this.nodeShapes={},t=this;this.generateEllipse(),this.generatePolygon("triangle",Ot(3,0)),this.generatePolygon("rectangle",Ot(4,0)),e.square=e.rectangle,this.generateRoundRectangle(),this.generateCutRectangle(),this.generateBarrel(),this.generateBottomRoundrectangle(),this.generatePolygon("diamond",[0,1,1,0,0,-1,-1,0]),this.generatePolygon("pentagon",Ot(5,0)),this.generatePolygon("hexagon",Ot(6,0)),this.generatePolygon("heptagon",Ot(7,0)),this.generatePolygon("octagon",Ot(8,0));var a=new Array(20),n=wt(5,0),i=wt(5,Math.PI/5),s=.5*(3-Math.sqrt(5));s*=1.57;for(var r=0;r<i.length/2;r++)i[2*r]*=s,i[2*r+1]*=s;for(r=0;r<5;r++)a[4*r]=n[2*r],a[4*r+1]=n[2*r+1],a[4*r+2]=i[2*r],a[4*r+3]=i[2*r+1];a=Et(a),this.generatePolygon("star",a),this.generatePolygon("vee",[-1,-1,0,-.333,1,-1,0,1]),this.generatePolygon("rhomboid",[-1,-1,.333,-1,1,1,-.333,1]),this.nodeShapes.concavehexagon=this.generatePolygon("concave-hexagon",[-1,-.95,-.75,0,-1,.95,1,.95,.75,0,1,-.95]),this.generatePolygon("tag",[-1,-1,.25,-1,1,0,.25,1,-1,1]),e.makePolygon=function(e){var a,n="polygon-"+e.join("$");return(a=this[n])?a:t.generatePolygon(n,e)}};var Ur={timeToRender:function(){return this.redrawTotalTime/this.redrawCount},redraw:function(e){e=e||fe();var t=this;void 0===t.averageRedrawTime&&(t.averageRedrawTime=0),void 0===t.lastRedrawTime&&(t.lastRedrawTime=0),void 0===t.lastDrawTime&&(t.lastDrawTime=0),t.requestedFrame=!0,t.renderOptions=e},beforeRender:function(e,t){if(!this.destroyed){null==t&&ce("Priority is not optional for beforeRender");var a=this.beforeRenderCallbacks;a.push({fn:e,priority:t}),a.sort((function(e,t){return t.priority-e.priority}))}}},Gr=function(e,t,a){for(var n=e.beforeRenderCallbacks,i=0;i<n.length;i++)n[i].fn(t,a)};Ur.startRenderLoop=function(){var e=this,t=e.cy;if(!e.renderLoopStarted){e.renderLoopStarted=!0;W((function a(n){if(!e.destroyed){if(t.batching());else if(e.requestedFrame&&!e.skipFrame){Gr(e,!0,n);var i=H();e.render(e.renderOptions);var s=e.lastDrawTime=H();void 0===e.averageRedrawTime&&(e.averageRedrawTime=s-i),void 0===e.redrawCount&&(e.redrawCount=0),e.redrawCount++,void 0===e.redrawTotalTime&&(e.redrawTotalTime=0);var r=s-i;e.redrawTotalTime+=r,e.lastRedrawTime=r,e.averageRedrawTime=e.averageRedrawTime/2+r/2,e.requestedFrame=!1}else Gr(e,!1,n);e.skipFrame=!1,W(a)}}))}};var qr=function(e){this.init(e)},Wr=qr.prototype;Wr.clientFunctions=["redrawHint","render","renderTo","matchCanvasSize","nodeShapeImpl","arrowShapeImpl"],Wr.init=function(e){var t=this;t.options=e,t.cy=e.cy;var a=t.container=e.cy.container();if(u){var n=u.document,i=n.head,s="__________cytoscape_stylesheet",r="__________cytoscape_container",o=null!=n.getElementById(s);if(a.className.indexOf(r)<0&&(a.className=(a.className||"")+" "+r),!o){var l=n.createElement("style");l.id=s,l.innerHTML="."+r+" { position: relative; }",i.insertBefore(l,i.children[0])}"static"===u.getComputedStyle(a).getPropertyValue("position")&&ue("A Cytoscape container has style position:static and so can not use UI extensions properly")}t.selection=[void 0,void 0,void 0,void 0,0],t.bezierProjPcts=[.05,.225,.4,.5,.6,.775,.95],t.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},t.dragData={possibleDragElements:[]},t.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},t.redraws=0,t.showFps=e.showFps,t.debug=e.debug,t.hideEdgesOnViewport=e.hideEdgesOnViewport,t.hideLabelsOnViewport=e.hideLabelsOnViewport,t.textureOnViewport=e.textureOnViewport,t.wheelSensitivity=e.wheelSensitivity,t.motionBlurEnabled=e.motionBlur,t.forcedPixelRatio=O(e.pixelRatio)?e.pixelRatio:null,t.motionBlur=e.motionBlur,t.motionBlurOpacity=e.motionBlurOpacity,t.motionBlurTransparency=1-t.motionBlurOpacity,t.motionBlurPxRatio=1,t.mbPxRBlurry=1,t.minMbLowQualFrames=4,t.fullQualityMb=!1,t.clearedForMotionBlur=[],t.desktopTapThreshold=e.desktopTapThreshold,t.desktopTapThreshold2=e.desktopTapThreshold*e.desktopTapThreshold,t.touchTapThreshold=e.touchTapThreshold,t.touchTapThreshold2=e.touchTapThreshold*e.touchTapThreshold,t.tapholdDuration=500,t.bindings=[],t.beforeRenderCallbacks=[],t.beforeRenderPriorities={animations:400,eleCalcs:300,eleTxrDeq:200,lyrTxrDeq:150,lyrTxrSkip:100},t.registerNodeShapes(),t.registerArrowShapes(),t.registerCalculationListeners()},Wr.notify=function(e,t){var a=this,n=a.cy;this.destroyed||("init"!==e?"destroy"!==e?(("add"===e||"remove"===e||"move"===e&&n.hasCompoundNodes()||"load"===e||"zorder"===e||"mount"===e)&&a.invalidateCachedZSortedEles(),"viewport"===e&&a.redrawHint("select",!0),"load"!==e&&"resize"!==e&&"mount"!==e||(a.invalidateContainerClientCoordsCache(),a.matchCanvasSize(a.container)),a.redrawHint("eles",!0),a.redrawHint("drag",!0),this.startRenderLoop(),this.redraw()):a.destroy():a.load())},Wr.destroy=function(){var e=this;e.destroyed=!0,e.cy.stopAnimationLoop();for(var t=0;t<e.bindings.length;t++){var a=e.bindings[t],n=a.target;(n.off||n.removeEventListener).apply(n,a.args)}if(e.bindings=[],e.beforeRenderCallbacks=[],e.onUpdateEleCalcsFns=[],e.removeObserver&&e.removeObserver.disconnect(),e.styleObserver&&e.styleObserver.disconnect(),e.resizeObserver&&e.resizeObserver.disconnect(),e.labelCalcDiv)try{document.body.removeChild(e.labelCalcDiv)}catch(e){}},Wr.isHeadless=function(){return!1},[wr,zr,Br,Jr,Vr,Ur].forEach((function(e){P(Wr,e)}));var Hr=1e3/60,Yr=function(e){return function(){var t=this,a=this.renderer;if(!t.dequeueingSetup){t.dequeueingSetup=!0;var n=i((function(){a.redrawHint("eles",!0),a.redrawHint("drag",!0),a.redraw()}),e.deqRedrawThreshold),s=e.priority||le;a.beforeRender((function(i,s){var r=H(),o=a.averageRedrawTime,l=a.lastRedrawTime,c=[],d=a.cy.extent(),u=a.getPixelRatio();for(i||a.flushRenderedStyleQueue();;){var p=H(),m=p-r,b=p-s;if(l<Hr){var f=Hr-(i?o:0);if(b>=e.deqFastCost*f)break}else if(i){if(m>=e.deqCost*l||m>=e.deqAvgCost*o)break}else if(b>=e.deqNoDrawCost*Hr)break;var h=e.deq(t,u,d);if(!(h.length>0))break;for(var g=0;g<h.length;g++)c.push(h[g])}c.length>0&&(e.onDeqd(t,c),!i&&e.shouldRedraw(t,c,u,d)&&n())}),s(t))}}},$r=function(){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:re;o(this,e),this.idsByKey=new ye,this.keyForId=new ye,this.cachesByLvl=new ye,this.lvls=[],this.getKey=t,this.doesEleInvalidateKey=a}return c(e,[{key:"getIdsFor",value:function(e){null==e&&ce("Can not get id list for null key");var t=this.idsByKey,a=this.idsByKey.get(e);return a||(a=new Ee,t.set(e,a)),a}},{key:"addIdForKey",value:function(e,t){null!=e&&this.getIdsFor(e).add(t)}},{key:"deleteIdForKey",value:function(e,t){null!=e&&this.getIdsFor(e).delete(t)}},{key:"getNumberOfIdsForKey",value:function(e){return null==e?0:this.getIdsFor(e).size}},{key:"updateKeyMappingFor",value:function(e){var t=e.id(),a=this.keyForId.get(t),n=this.getKey(e);this.deleteIdForKey(a,t),this.addIdForKey(n,t),this.keyForId.set(t,n)}},{key:"deleteKeyMappingFor",value:function(e){var t=e.id(),a=this.keyForId.get(t);this.deleteIdForKey(a,t),this.keyForId.delete(t)}},{key:"keyHasChangedFor",value:function(e){var t=e.id();return this.keyForId.get(t)!==this.getKey(e)}},{key:"isInvalid",value:function(e){return this.keyHasChangedFor(e)||this.doesEleInvalidateKey(e)}},{key:"getCachesAt",value:function(e){var t=this.cachesByLvl,a=this.lvls,n=t.get(e);return n||(n=new ye,t.set(e,n),a.push(e)),n}},{key:"getCache",value:function(e,t){return this.getCachesAt(t).get(e)}},{key:"get",value:function(e,t){var a=this.getKey(e),n=this.getCache(a,t);return null!=n&&this.updateKeyMappingFor(e),n}},{key:"getForCachedKey",value:function(e,t){var a=this.keyForId.get(e.id());return this.getCache(a,t)}},{key:"hasCache",value:function(e,t){return this.getCachesAt(t).has(e)}},{key:"has",value:function(e,t){var a=this.getKey(e);return this.hasCache(a,t)}},{key:"setCache",value:function(e,t,a){a.key=e,this.getCachesAt(t).set(e,a)}},{key:"set",value:function(e,t,a){var n=this.getKey(e);this.setCache(n,t,a),this.updateKeyMappingFor(e)}},{key:"deleteCache",value:function(e,t){this.getCachesAt(t).delete(e)}},{key:"delete",value:function(e,t){var a=this.getKey(e);this.deleteCache(a,t)}},{key:"invalidateKey",value:function(e){var t=this;this.lvls.forEach((function(a){return t.deleteCache(e,a)}))}},{key:"invalidate",value:function(e){var t=e.id(),a=this.keyForId.get(t);this.deleteKeyMappingFor(e);var n=this.doesEleInvalidateKey(e);return n&&this.invalidateKey(a),n||0===this.getNumberOfIdsForKey(a)}}]),e}(),Xr={dequeue:"dequeue",downscale:"downscale",highQuality:"highQuality"},Kr=he({getKey:null,doesEleInvalidateKey:re,drawElement:null,getBoundingBox:null,getRotationPoint:null,getRotationOffset:null,isVisible:se,allowEdgeTxrCaching:!0,allowParentTxrCaching:!0}),Qr=function(e,t){var a=this;a.renderer=e,a.onDequeues=[];var n=Kr(t);P(a,n),a.lookup=new $r(n.getKey,n.doesEleInvalidateKey),a.setupDequeueing()},Zr=Qr.prototype;Zr.reasons=Xr,Zr.getTextureQueue=function(e){var t=this;return t.eleImgCaches=t.eleImgCaches||{},t.eleImgCaches[e]=t.eleImgCaches[e]||[]},Zr.getRetiredTextureQueue=function(e){var t=this.eleImgCaches.retired=this.eleImgCaches.retired||{};return t[e]=t[e]||[]},Zr.getElementQueue=function(){return this.eleCacheQueue=this.eleCacheQueue||new s((function(e,t){return t.reqs-e.reqs}))},Zr.getElementKeyToQueue=function(){return this.eleKeyToCacheQueue=this.eleKeyToCacheQueue||{}},Zr.getElement=function(e,t,a,n,i){var s=this,r=this.renderer,o=r.cy.zoom(),l=this.lookup;if(0===t.w||0===t.h||isNaN(t.w)||isNaN(t.h)||!e.visible())return null;if(!s.allowEdgeTxrCaching&&e.isEdge()||!s.allowParentTxrCaching&&e.isParent())return null;if(null==n&&(n=Math.ceil(Ge(o*a))),n<-4)n=-4;else if(o>=7.99||n>3)return null;var c=Math.pow(2,n),d=t.h*c,u=t.w*c,p=r.eleTextBiggerThanMin(e,c);if(!this.isVisible(e,p))return null;var m,b=l.get(e,n);if(b&&b.invalidated&&(b.invalidated=!1,b.texture.invalidatedWidth-=b.width),b)return b;if(m=d<=25?25:d<=50?50:50*Math.ceil(d/50),d>1024||u>1024)return null;var f=s.getTextureQueue(m),h=f[f.length-2],g=function(){return s.recycleTexture(m,u)||s.addTexture(m,u)};h||(h=f[f.length-1]),h||(h=g()),h.width-h.usedWidth<u&&(h=g());for(var j,x=function(e){return e&&e.scaledLabelShown===p},v=i&&i===Xr.dequeue,y=i&&i===Xr.highQuality,O=i&&i===Xr.downscale,E=n+1;E<=3;E++){var w=l.get(e,E);if(w){j=w;break}}var M=j&&j.level===n+1?j:null,S=function(){h.context.drawImage(M.texture.canvas,M.x,0,M.width,M.height,h.usedWidth,0,u,d)};if(h.context.setTransform(1,0,0,1,0,0),h.context.clearRect(h.usedWidth,0,u,m),x(M))S();else if(x(j)){if(!y)return s.queueElement(e,j.level-1),j;for(var _=j.level;_>n;_--)M=s.getElement(e,t,a,_,Xr.downscale);S()}else{var T;if(!v&&!y&&!O)for(var C=n-1;C>=-4;C--){var k=l.get(e,C);if(k){T=k;break}}if(x(T))return s.queueElement(e,n),T;h.context.translate(h.usedWidth,0),h.context.scale(c,c),this.drawElement(h.context,e,t,p,!1),h.context.scale(1/c,1/c),h.context.translate(-h.usedWidth,0)}return b={x:h.usedWidth,texture:h,level:n,scale:c,width:u,height:d,scaledLabelShown:p},h.usedWidth+=Math.ceil(u+8),h.eleCaches.push(b),l.set(e,n,b),s.checkTextureFullness(h),b},Zr.invalidateElements=function(e){for(var t=0;t<e.length;t++)this.invalidateElement(e[t])},Zr.invalidateElement=function(e){var t=this,a=t.lookup,n=[];if(a.isInvalid(e)){for(var i=-4;i<=3;i++){var s=a.getForCachedKey(e,i);s&&n.push(s)}if(a.invalidate(e))for(var r=0;r<n.length;r++){var o=n[r],l=o.texture;l.invalidatedWidth+=o.width,o.invalidated=!0,t.checkTextureUtility(l)}t.removeFromQueue(e)}},Zr.checkTextureUtility=function(e){e.invalidatedWidth>=.2*e.width&&this.retireTexture(e)},Zr.checkTextureFullness=function(e){var t=this.getTextureQueue(e.height);e.usedWidth/e.width>.8&&e.fullnessChecks>=10?ge(t,e):e.fullnessChecks++},Zr.retireTexture=function(e){var t=e.height,a=this.getTextureQueue(t),n=this.lookup;ge(a,e),e.retired=!0;for(var i=e.eleCaches,s=0;s<i.length;s++){var r=i[s];n.deleteCache(r.key,r.level)}je(i),this.getRetiredTextureQueue(t).push(e)},Zr.addTexture=function(e,t){var a={};return this.getTextureQueue(e).push(a),a.eleCaches=[],a.height=e,a.width=Math.max(1024,t),a.usedWidth=0,a.invalidatedWidth=0,a.fullnessChecks=0,a.canvas=this.renderer.makeOffscreenCanvas(a.width,a.height),a.context=a.canvas.getContext("2d"),a},Zr.recycleTexture=function(e,t){for(var a=this.getTextureQueue(e),n=this.getRetiredTextureQueue(e),i=0;i<n.length;i++){var s=n[i];if(s.width>=t)return s.retired=!1,s.usedWidth=0,s.invalidatedWidth=0,s.fullnessChecks=0,je(s.eleCaches),s.context.setTransform(1,0,0,1,0,0),s.context.clearRect(0,0,s.width,s.height),ge(n,s),a.push(s),s}},Zr.queueElement=function(e,t){var a=this.getElementQueue(),n=this.getElementKeyToQueue(),i=this.getKey(e),s=n[i];if(s)s.level=Math.max(s.level,t),s.eles.merge(e),s.reqs++,a.updateItem(s);else{var r={eles:e.spawn().merge(e),level:t,reqs:1,key:i};a.push(r),n[i]=r}},Zr.dequeue=function(e){for(var t=this,a=t.getElementQueue(),n=t.getElementKeyToQueue(),i=[],s=t.lookup,r=0;r<1&&a.size()>0;r++){var o=a.pop(),l=o.key,c=o.eles[0],d=s.hasCache(c,o.level);if(n[l]=null,!d){i.push(o);var u=t.getBoundingBox(c);t.getElement(c,u,e,o.level,Xr.dequeue)}}return i},Zr.removeFromQueue=function(e){var t=this.getElementQueue(),a=this.getElementKeyToQueue(),n=this.getKey(e),i=a[n];null!=i&&(1===i.eles.length?(i.reqs=ie,t.updateItem(i),t.pop(),a[n]=null):i.eles.unmerge(e))},Zr.onDequeue=function(e){this.onDequeues.push(e)},Zr.offDequeue=function(e){ge(this.onDequeues,e)},Zr.setupDequeueing=Yr({deqRedrawThreshold:100,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(e,t,a){return e.dequeue(t,a)},onDeqd:function(e,t){for(var a=0;a<e.onDequeues.length;a++){(0,e.onDequeues[a])(t)}},shouldRedraw:function(e,t,a,n){for(var i=0;i<t.length;i++)for(var s=t[i].eles,r=0;r<s.length;r++){var o=s[r].boundingBox();if(it(o,n))return!0}return!1},priority:function(e){return e.renderer.beforeRenderPriorities.eleTxrDeq}});var eo=function(e){var t=this,a=t.renderer=e,n=a.cy;t.layersByLevel={},t.firstGet=!0,t.lastInvalidationTime=H()-500,t.skipping=!1,t.eleTxrDeqs=n.collection(),t.scheduleElementRefinement=i((function(){t.refineElementTextures(t.eleTxrDeqs),t.eleTxrDeqs.unmerge(t.eleTxrDeqs)}),50),a.beforeRender((function(e,a){a-t.lastInvalidationTime<=250?t.skipping=!0:t.skipping=!1}),a.beforeRenderPriorities.lyrTxrSkip);t.layersQueue=new s((function(e,t){return t.reqs-e.reqs})),t.setupDequeueing()},to=eo.prototype,ao=0,no=Math.pow(2,53)-1;to.makeLayer=function(e,t){var a=Math.pow(2,t),n=Math.ceil(e.w*a),i=Math.ceil(e.h*a),s=this.renderer.makeOffscreenCanvas(n,i),r={id:ao=++ao%no,bb:e,level:t,width:n,height:i,canvas:s,context:s.getContext("2d"),eles:[],elesQueue:[],reqs:0},o=r.context,l=-r.bb.x1,c=-r.bb.y1;return o.scale(a,a),o.translate(l,c),r},to.getLayers=function(e,t,a){var n=this,i=n.renderer.cy.zoom(),s=n.firstGet;if(n.firstGet=!1,null==a)if((a=Math.ceil(Ge(i*t)))<-4)a=-4;else if(i>=3.99||a>2)return null;n.validateLayersElesOrdering(a,e);var r,o,l=n.layersByLevel,c=Math.pow(2,a),d=l[a]=l[a]||[];if(n.levelIsComplete(a,e))return d;!function(){var t=function(t){if(n.validateLayersElesOrdering(t,e),n.levelIsComplete(t,e))return o=l[t],!0},i=function(e){if(!o)for(var n=a+e;-4<=n&&n<=2&&!t(n);n+=e);};i(1),i(-1);for(var s=d.length-1;s>=0;s--){var r=d[s];r.invalid&&ge(d,r)}}();var u=function(t){var i=(t=t||{}).after;if(function(){if(!r){r=Qe();for(var t=0;t<e.length;t++)a=r,n=e[t].boundingBox(),a.x1=Math.min(a.x1,n.x1),a.x2=Math.max(a.x2,n.x2),a.w=a.x2-a.x1,a.y1=Math.min(a.y1,n.y1),a.y2=Math.max(a.y2,n.y2),a.h=a.y2-a.y1}var a,n}(),r.w*c*(r.h*c)>16e6)return null;var s=n.makeLayer(r,a);if(null!=i){var o=d.indexOf(i)+1;d.splice(o,0,s)}else(void 0===t.insert||t.insert)&&d.unshift(s);return s};if(n.skipping&&!s)return null;for(var p=null,m=e.length/1,b=!s,f=0;f<e.length;f++){var h=e[f],g=h._private.rscratch,j=g.imgLayerCaches=g.imgLayerCaches||{},x=j[a];if(x)p=x;else{if((!p||p.eles.length>=m||!rt(p.bb,h.boundingBox()))&&!(p=u({insert:!0,after:p})))return null;o||b?n.queueLayer(p,h):n.drawEleInLayer(p,h,a,t),p.eles.push(h),j[a]=p}}return o||(b?null:d)},to.getEleLevelForLayerLevel=function(e,t){return e},to.drawEleInLayer=function(e,t,a,n){var i=this.renderer,s=e.context,r=t.boundingBox();0!==r.w&&0!==r.h&&t.visible()&&(a=this.getEleLevelForLayerLevel(a,n),i.setImgSmoothing(s,!1),i.drawCachedElement(s,t,null,null,a,true),i.setImgSmoothing(s,!0))},to.levelIsComplete=function(e,t){var a=this.layersByLevel[e];if(!a||0===a.length)return!1;for(var n=0,i=0;i<a.length;i++){var s=a[i];if(s.reqs>0)return!1;if(s.invalid)return!1;n+=s.eles.length}return n===t.length},to.validateLayersElesOrdering=function(e,t){var a=this.layersByLevel[e];if(a)for(var n=0;n<a.length;n++){for(var i=a[n],s=-1,r=0;r<t.length;r++)if(i.eles[0]===t[r]){s=r;break}if(s<0)this.invalidateLayer(i);else{var o=s;for(r=0;r<i.eles.length;r++)if(i.eles[r]!==t[o+r]){this.invalidateLayer(i);break}}}},to.updateElementsInLayers=function(e,t){for(var a=M(e[0]),n=0;n<e.length;n++)for(var i=a?null:e[n],s=a?e[n]:e[n].ele,r=s._private.rscratch,o=r.imgLayerCaches=r.imgLayerCaches||{},l=-4;l<=2;l++){var c=o[l];c&&(i&&this.getEleLevelForLayerLevel(c.level)!==i.level||t(c,s,i))}},to.haveLayers=function(){for(var e=!1,t=-4;t<=2;t++){var a=this.layersByLevel[t];if(a&&a.length>0){e=!0;break}}return e},to.invalidateElements=function(e){var t=this;0!==e.length&&(t.lastInvalidationTime=H(),0!==e.length&&t.haveLayers()&&t.updateElementsInLayers(e,(function(e,a,n){t.invalidateLayer(e)})))},to.invalidateLayer=function(e){if(this.lastInvalidationTime=H(),!e.invalid){var t=e.level,a=e.eles,n=this.layersByLevel[t];ge(n,e),e.elesQueue=[],e.invalid=!0,e.replacement&&(e.replacement.invalid=!0);for(var i=0;i<a.length;i++){var s=a[i]._private.rscratch.imgLayerCaches;s&&(s[t]=null)}}},to.refineElementTextures=function(e){var t=this;t.updateElementsInLayers(e,(function(e,a,n){var i=e.replacement;if(i||((i=e.replacement=t.makeLayer(e.bb,e.level)).replaces=e,i.eles=e.eles),!i.reqs)for(var s=0;s<i.eles.length;s++)t.queueLayer(i,i.eles[s])}))},to.enqueueElementRefinement=function(e){this.eleTxrDeqs.merge(e),this.scheduleElementRefinement()},to.queueLayer=function(e,t){var a=this.layersQueue,n=e.elesQueue,i=n.hasId=n.hasId||{};if(!e.replacement){if(t){if(i[t.id()])return;n.push(t),i[t.id()]=!0}e.reqs?(e.reqs++,a.updateItem(e)):(e.reqs=1,a.push(e))}},to.dequeue=function(e){for(var t=this,a=t.layersQueue,n=[],i=0;i<1&&0!==a.size();){var s=a.peek();if(s.replacement)a.pop();else if(s.replaces&&s!==s.replaces.replacement)a.pop();else if(s.invalid)a.pop();else{var r=s.elesQueue.shift();r&&(t.drawEleInLayer(s,r,s.level,e),i++),0===n.length&&n.push(!0),0===s.elesQueue.length&&(a.pop(),s.reqs=0,s.replaces&&t.applyLayerReplacement(s),t.requestRedraw())}}return n},to.applyLayerReplacement=function(e){var t=this.layersByLevel[e.level],a=e.replaces,n=t.indexOf(a);if(!(n<0||a.invalid)){t[n]=e;for(var i=0;i<e.eles.length;i++){var s=e.eles[i]._private,r=s.imgLayerCaches=s.imgLayerCaches||{};r&&(r[e.level]=e)}this.requestRedraw()}},to.requestRedraw=i((function(){var e=this.renderer;e.redrawHint("eles",!0),e.redrawHint("drag",!0),e.redraw()}),100),to.setupDequeueing=Yr({deqRedrawThreshold:50,deqCost:.15,deqAvgCost:.1,deqNoDrawCost:.9,deqFastCost:.9,deq:function(e,t){return e.dequeue(t)},onDeqd:le,shouldRedraw:se,priority:function(e){return e.renderer.beforeRenderPriorities.lyrTxrDeq}});var io,so={};function ro(e,t){for(var a=0;a<t.length;a++){var n=t[a];e.lineTo(n.x,n.y)}}function oo(e,t,a){for(var n,i=0;i<t.length;i++){var s=t[i];0===i&&(n=s),e.lineTo(s.x,s.y)}e.quadraticCurveTo(a.x,a.y,n.x,n.y)}function lo(e,t,a){e.beginPath&&e.beginPath();for(var n=t,i=0;i<n.length;i++){var s=n[i];e.lineTo(s.x,s.y)}var r=a,o=a[0];e.moveTo(o.x,o.y);for(i=1;i<r.length;i++){s=r[i];e.lineTo(s.x,s.y)}e.closePath&&e.closePath()}function co(e,t,a,n){e.arc(t,a,n,0,2*Math.PI,!1)}so.arrowShapeImpl=function(e){return(io||(io={polygon:ro,"triangle-backcurve":oo,"triangle-tee":lo,"triangle-cross":lo,circle:co}))[e]};var uo={drawElement:function(e,t,a,n,i,s){t.isNode()?this.drawNode(e,t,a,n,i,s):this.drawEdge(e,t,a,n,i,s)},drawElementOverlay:function(e,t){t.isNode()?this.drawNodeOverlay(e,t):this.drawEdgeOverlay(e,t)},drawCachedElementPortion:function(e,t,a,n,i,s,r,o){var l=this,c=a.getBoundingBox(t);if(0!==c.w&&0!==c.h){var d=a.getElement(t,c,n,i,s);if(null!=d){var u=o(l,t);if(0===u)return;var p,m,b,f,h,g,j=r(l,t),x=c.x1,v=c.y1,y=c.w,O=c.h;if(0!==j){var E=a.getRotationPoint(t);b=E.x,f=E.y,e.translate(b,f),e.rotate(j),(h=l.getImgSmoothing(e))||l.setImgSmoothing(e,!0);var w=a.getRotationOffset(t);p=w.x,m=w.y}else p=x,m=v;1!==u&&(g=e.globalAlpha,e.globalAlpha=g*u),e.drawImage(d.texture.canvas,d.x,0,d.width,d.height,p,m,y,O),1!==u&&(e.globalAlpha=g),0!==j&&(e.rotate(-j),e.translate(-b,-f),h||l.setImgSmoothing(e,!1))}else a.drawElement(e,t)}}},po=function(){return 0},mo=function(e,t){return e.getTextAngle(t,null)},bo=function(e,t){return e.getTextAngle(t,"source")},fo=function(e,t){return e.getTextAngle(t,"target")},ho=function(e,t){return t.effectiveOpacity()},go=function(e,t){return t.pstyle("text-opacity").pfValue*t.effectiveOpacity()};uo.drawCachedElement=function(e,t,a,n,i,s){var r=this,o=r.data,l=o.eleTxrCache,c=o.lblTxrCache,d=o.slbTxrCache,u=o.tlbTxrCache,p=t.boundingBox(),m=!0===s?l.reasons.highQuality:null;0!==p.w&&0!==p.h&&t.visible()&&(n&&!it(p,n)||(r.drawCachedElementPortion(e,t,l,a,i,m,po,ho),r.drawCachedElementPortion(e,t,c,a,i,m,mo,go),t.isEdge()&&(r.drawCachedElementPortion(e,t,d,a,i,m,bo,go),r.drawCachedElementPortion(e,t,u,a,i,m,fo,go)),r.drawElementOverlay(e,t)))},uo.drawElements=function(e,t){for(var a=0;a<t.length;a++){var n=t[a];this.drawElement(e,n)}},uo.drawCachedElements=function(e,t,a,n){for(var i=0;i<t.length;i++){var s=t[i];this.drawCachedElement(e,s,a,n)}},uo.drawCachedNodes=function(e,t,a,n){for(var i=0;i<t.length;i++){var s=t[i];s.isNode()&&this.drawCachedElement(e,s,a,n)}},uo.drawLayeredElements=function(e,t,a,n){var i=this.data.lyrTxrCache.getLayers(t,a);if(i)for(var s=0;s<i.length;s++){var r=i[s],o=r.bb;0!==o.w&&0!==o.h&&e.drawImage(r.canvas,o.x1,o.y1,o.w,o.h)}else this.drawCachedElements(e,t,a,n)};var jo={drawEdge:function(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this,o=t._private.rscratch;if((!s||t.visible())&&!o.badLine&&null!=o.allpts&&!isNaN(o.allpts[0])){var l;a&&(l=a,e.translate(-l.x1,-l.y1));var c=s?t.pstyle("opacity").value:1,d=t.pstyle("line-style").value,u=t.pstyle("width").pfValue,p=t.pstyle("line-cap").value,m=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;e.lineWidth=u,e.lineCap=p,r.eleStrokeStyle(e,t,a),r.drawEdgePath(t,e,o.allpts,d),e.lineCap="butt"},b=function(){i&&r.drawEdgeOverlay(e,t)},f=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c;r.drawArrowheads(e,t,a)},h=function(){r.drawElementText(e,t,null,n)};e.lineJoin="round";var g="yes"===t.pstyle("ghost").value;if(g){var j=t.pstyle("ghost-offset-x").pfValue,x=t.pstyle("ghost-offset-y").pfValue,v=t.pstyle("ghost-opacity").value,y=c*v;e.translate(j,x),m(y),f(y),e.translate(-j,-x)}m(),f(),b(),h(),a&&e.translate(l.x1,l.y1)}},drawEdgeOverlay:function(e,t){if(t.visible()){var a=t.pstyle("overlay-opacity").value;if(0!==a){var n=this,i=n.usePaths(),s=t._private.rscratch,r=2*t.pstyle("overlay-padding").pfValue,o=t.pstyle("overlay-color").value;e.lineWidth=r,"self"!==s.edgeType||i?e.lineCap="round":e.lineCap="butt",n.colorStrokeStyle(e,o[0],o[1],o[2],a),n.drawEdgePath(t,e,s.allpts,"solid")}}},drawEdgePath:function(e,t,a,n){var i,s=e._private.rscratch,r=t,o=!1,l=this.usePaths(),c=e.pstyle("line-dash-pattern").pfValue,d=e.pstyle("line-dash-offset").pfValue;if(l){var u=a.join("$");s.pathCacheKey&&s.pathCacheKey===u?(i=t=s.pathCache,o=!0):(i=t=new Path2D,s.pathCacheKey=u,s.pathCache=i)}if(r.setLineDash)switch(n){case"dotted":r.setLineDash([1,1]);break;case"dashed":r.setLineDash(c),r.lineDashOffset=d;break;case"solid":r.setLineDash([])}if(!o&&!s.badLine)switch(t.beginPath&&t.beginPath(),t.moveTo(a[0],a[1]),s.edgeType){case"bezier":case"self":case"compound":case"multibezier":for(var p=2;p+3<a.length;p+=4)t.quadraticCurveTo(a[p],a[p+1],a[p+2],a[p+3]);break;case"straight":case"segments":case"haystack":for(var m=2;m+1<a.length;m+=2)t.lineTo(a[m],a[m+1])}t=r,l?t.stroke(i):t.stroke(),t.setLineDash&&t.setLineDash([])},drawArrowheads:function(e,t,a){var n=t._private.rscratch,i="haystack"===n.edgeType;i||this.drawArrowhead(e,t,"source",n.arrowStartX,n.arrowStartY,n.srcArrowAngle,a),this.drawArrowhead(e,t,"mid-target",n.midX,n.midY,n.midtgtArrowAngle,a),this.drawArrowhead(e,t,"mid-source",n.midX,n.midY,n.midsrcArrowAngle,a),i||this.drawArrowhead(e,t,"target",n.arrowEndX,n.arrowEndY,n.tgtArrowAngle,a)},drawArrowhead:function(e,t,a,n,i,s,r){if(!(isNaN(n)||null==n||isNaN(i)||null==i||isNaN(s)||null==s)){var o=this,l=t.pstyle(a+"-arrow-shape").value;if("none"!==l){var c="hollow"===t.pstyle(a+"-arrow-fill").value?"both":"filled",d=t.pstyle(a+"-arrow-fill").value,u=t.pstyle("width").pfValue,p=t.pstyle("opacity").value;void 0===r&&(r=p);var m=e.globalCompositeOperation;1===r&&"hollow"!==d||(e.globalCompositeOperation="destination-out",o.colorFillStyle(e,255,255,255,1),o.colorStrokeStyle(e,255,255,255,1),o.drawArrowShape(t,e,c,u,l,n,i,s),e.globalCompositeOperation=m);var b=t.pstyle(a+"-arrow-color").value;o.colorFillStyle(e,b[0],b[1],b[2],r),o.colorStrokeStyle(e,b[0],b[1],b[2],r),o.drawArrowShape(t,e,d,u,l,n,i,s)}}},drawArrowShape:function(e,t,a,n,i,s,r,o){var l,c=this,d=this.usePaths()&&"triangle-cross"!==i,u=!1,p=t,m={x:s,y:r},b=e.pstyle("arrow-scale").value,f=this.getArrowWidth(n,b),h=c.arrowShapes[i];if(d){var g=c.arrowPathCache=c.arrowPathCache||[],j=Q(i),x=g[j];null!=x?(l=t=x,u=!0):(l=t=new Path2D,g[j]=l)}t.beginPath&&t.beginPath(),u||(d?h.draw(t,1,0,{x:0,y:0},1):h.draw(t,f,o,m,n)),t.closePath&&t.closePath(),t=p,d&&(t.translate(s,r),t.rotate(o),t.scale(f,f)),"filled"!==a&&"both"!==a||(d?t.fill(l):t.fill()),"hollow"!==a&&"both"!==a||(t.lineWidth=(h.matchEdgeWidth?n:1)/(d?f:1),t.lineJoin="miter",d?t.stroke(l):t.stroke()),d&&(t.scale(1/f,1/f),t.rotate(-o),t.translate(-s,-r))}},xo={safeDrawImage:function(e,t,a,n,i,s,r,o,l,c){i<=0||s<=0||l<=0||c<=0||e.drawImage(t,a,n,i,s,r,o,l,c)},drawInscribedImage:function(e,t,a,n,i){var s=this,r=a.position(),o=r.x,l=r.y,c=a.cy().style(),d=c.getIndexedStyle.bind(c),u=d(a,"background-fit","value",n),p=d(a,"background-repeat","value",n),m=a.width(),b=a.height(),f=2*a.padding(),h=m+("inner"===d(a,"background-width-relative-to","value",n)?0:f),g=b+("inner"===d(a,"background-height-relative-to","value",n)?0:f),j=a._private.rscratch,x="node"===d(a,"background-clip","value",n),v=d(a,"background-image-opacity","value",n)*i,y=t.width||t.cachedW,O=t.height||t.cachedH;null!=y&&null!=O||(document.body.appendChild(t),y=t.cachedW=t.width||t.offsetWidth,O=t.cachedH=t.height||t.offsetHeight,document.body.removeChild(t));var E=y,w=O;if("auto"!==d(a,"background-width","value",n)&&(E="%"===d(a,"background-width","units",n)?d(a,"background-width","pfValue",n)*h:d(a,"background-width","pfValue",n)),"auto"!==d(a,"background-height","value",n)&&(w="%"===d(a,"background-height","units",n)?d(a,"background-height","pfValue",n)*g:d(a,"background-height","pfValue",n)),0!==E&&0!==w){if("contain"===u)E*=M=Math.min(h/E,g/w),w*=M;else if("cover"===u){var M;E*=M=Math.max(h/E,g/w),w*=M}var S=o-h/2,_=d(a,"background-position-x","units",n),T=d(a,"background-position-x","pfValue",n);S+="%"===_?(h-E)*T:T;var C=d(a,"background-offset-x","units",n),k=d(a,"background-offset-x","pfValue",n);S+="%"===C?(h-E)*k:k;var F=l-g/2,I=d(a,"background-position-y","units",n),D=d(a,"background-position-y","pfValue",n);F+="%"===I?(g-w)*D:D;var A=d(a,"background-offset-y","units",n),L=d(a,"background-offset-y","pfValue",n);F+="%"===A?(g-w)*L:L,j.pathCache&&(S-=o,F-=l,o=0,l=0);var R=e.globalAlpha;if(e.globalAlpha=v,"no-repeat"===p)x&&(e.save(),j.pathCache?e.clip(j.pathCache):(s.nodeShapes[s.getNodeShape(a)].draw(e,o,l,h,g),e.clip())),s.safeDrawImage(e,t,0,0,y,O,S,F,E,w),x&&e.restore();else{var N=e.createPattern(t,p);e.fillStyle=N,s.nodeShapes[s.getNodeShape(a)].draw(e,o,l,h,g),e.translate(S,F),e.fill(),e.translate(-S,-F)}e.globalAlpha=R}}},vo={};function yo(e,t,a,n,i){var s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:5;e.beginPath(),e.moveTo(t+s,a),e.lineTo(t+n-s,a),e.quadraticCurveTo(t+n,a,t+n,a+s),e.lineTo(t+n,a+i-s),e.quadraticCurveTo(t+n,a+i,t+n-s,a+i),e.lineTo(t+s,a+i),e.quadraticCurveTo(t,a+i,t,a+i-s),e.lineTo(t,a+s),e.quadraticCurveTo(t,a,t+s,a),e.closePath(),e.fill()}vo.eleTextBiggerThanMin=function(e,t){if(!t){var a=e.cy().zoom(),n=this.getPixelRatio(),i=Math.ceil(Ge(a*n));t=Math.pow(2,i)}return!(e.pstyle("font-size").pfValue*t<e.pstyle("min-zoomed-font-size").pfValue)},vo.drawElementText=function(e,t,a,n,i){var s=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],r=this;if(null==n){if(s&&!r.eleTextBiggerThanMin(t))return}else if(!1===n)return;if(t.isNode()){var o=t.pstyle("label");if(!o||!o.value)return;var l=r.getLabelJustification(t);e.textAlign=l,e.textBaseline="bottom"}else{var c=t.pstyle("label"),d=t.pstyle("source-label"),u=t.pstyle("target-label");if(!(c&&c.value||d&&d.value||u&&u.value))return;e.textAlign="center",e.textBaseline="bottom"}var p,m=!a;a&&(p=a,e.translate(-p.x1,-p.y1)),null==i?(r.drawText(e,t,null,m,s),t.isEdge()&&(r.drawText(e,t,"source",m,s),r.drawText(e,t,"target",m,s))):r.drawText(e,t,i,m,s),a&&e.translate(p.x1,p.y1)},vo.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var a=0;a<this.fontCaches.length;a++)if((t=this.fontCaches[a]).context===e)return t;return t={context:e},this.fontCaches.push(t),t},vo.setupTextStyle=function(e,t){var a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.pstyle("font-style").strValue,i=t.pstyle("font-size").pfValue+"px",s=t.pstyle("font-family").strValue,r=t.pstyle("font-weight").strValue,o=a?t.effectiveOpacity()*t.pstyle("text-opacity").value:1,l=t.pstyle("text-outline-opacity").value*o,c=t.pstyle("color").value,d=t.pstyle("text-outline-color").value;e.font=n+" "+r+" "+i+" "+s,e.lineJoin="round",this.colorFillStyle(e,c[0],c[1],c[2],o),this.colorStrokeStyle(e,d[0],d[1],d[2],l)},vo.getTextAngle=function(e,t){var a=e._private.rscratch,n=t?t+"-":"",i=e.pstyle(n+"text-rotation"),s=xe(a,"labelAngle",t);return"autorotate"===i.strValue?e.isEdge()?s:0:"none"===i.strValue?0:i.pfValue},vo.drawText=function(e,t,a){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=t._private,r=s.rscratch,o=i?t.effectiveOpacity():1;if(!i||0!==o&&0!==t.pstyle("text-opacity").value){"main"===a&&(a=null);var l,c,d=xe(r,"labelX",a),u=xe(r,"labelY",a),p=this.getLabelText(t,a);if(null!=p&&""!==p&&!isNaN(d)&&!isNaN(u)){this.setupTextStyle(e,t,i);var m,b=a?a+"-":"",f=xe(r,"labelWidth",a),h=xe(r,"labelHeight",a),g=t.pstyle(b+"text-margin-x").pfValue,j=t.pstyle(b+"text-margin-y").pfValue,x=t.isEdge(),v=t.pstyle("text-halign").value,y=t.pstyle("text-valign").value;switch(x&&(v="center",y="center"),d+=g,u+=j,0!==(m=n?this.getTextAngle(t,a):0)&&(l=d,c=u,e.translate(l,c),e.rotate(m),d=0,u=0),y){case"top":break;case"center":u+=h/2;break;case"bottom":u+=h}var O=t.pstyle("text-background-opacity").value,E=t.pstyle("text-border-opacity").value,w=t.pstyle("text-border-width").pfValue,M=t.pstyle("text-background-padding").pfValue;if(O>0||w>0&&E>0){var S=d-M;switch(v){case"left":S-=f;break;case"center":S-=f/2}var _=u-h-M,T=f+2*M,C=h+2*M;if(O>0){var k=e.fillStyle,F=t.pstyle("text-background-color").value;e.fillStyle="rgba("+F[0]+","+F[1]+","+F[2]+","+O*o+")";var I=t.pstyle("text-background-shape").strValue;"roundrectangle"==I?yo(e,S,_,T,C,2):e.fillRect(S,_,T,C),e.fillStyle=k}if(w>0&&E>0){var D=e.strokeStyle,A=e.lineWidth,L=t.pstyle("text-border-color").value,R=t.pstyle("text-border-style").value;if(e.strokeStyle="rgba("+L[0]+","+L[1]+","+L[2]+","+E*o+")",e.lineWidth=w,e.setLineDash)switch(R){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"double":e.lineWidth=w/4,e.setLineDash([]);break;case"solid":e.setLineDash([])}if(e.strokeRect(S,_,T,C),"double"===R){var N=w/2;e.strokeRect(S+N,_+N,T-2*N,C-2*N)}e.setLineDash&&e.setLineDash([]),e.lineWidth=A,e.strokeStyle=D}}var P=2*t.pstyle("text-outline-width").pfValue;if(P>0&&(e.lineWidth=P),"wrap"===t.pstyle("text-wrap").value){var z=xe(r,"labelWrapCachedLines",a),B=xe(r,"labelLineHeight",a),J=f/2,V=this.getLabelJustification(t);switch("auto"===V||("left"===v?"left"===V?d+=-f:"center"===V&&(d+=-J):"center"===v?"left"===V?d+=-J:"right"===V&&(d+=J):"right"===v&&("center"===V?d+=J:"right"===V&&(d+=f))),y){case"top":u-=(z.length-1)*B;break;case"center":case"bottom":u-=(z.length-1)*B}for(var U=0;U<z.length;U++)P>0&&e.strokeText(z[U],d,u),e.fillText(z[U],d,u),u+=B}else P>0&&e.strokeText(p,d,u),e.fillText(p,d,u);0!==m&&(e.rotate(-m),e.translate(-l,-c))}}};var Oo={drawNode:function(e,t,a){var n,i,s=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],l=this,c=t._private,d=c.rscratch,u=t.position();if(O(u.x)&&O(u.y)&&(!o||t.visible())){var p,m,b=o?t.effectiveOpacity():1,f=l.usePaths(),h=!1,g=t.padding();n=t.width()+2*g,i=t.height()+2*g,a&&(m=a,e.translate(-m.x1,-m.y1));for(var j=t.pstyle("background-image"),x=j.value,v=new Array(x.length),y=new Array(x.length),E=0,w=0;w<x.length;w++){var M=x[w],S=v[w]=null!=M&&"none"!==M;if(S){var _=t.cy().style().getIndexedStyle(t,"background-image-crossorigin","value",w);E++,y[w]=l.getCachedImage(M,_,(function(){c.backgroundTimestamp=Date.now(),t.emitAndNotify("background")}))}}var T=t.pstyle("background-blacken").value,C=t.pstyle("border-width").pfValue,k=t.pstyle("background-opacity").value*b,F=t.pstyle("border-color").value,I=t.pstyle("border-style").value,D=t.pstyle("border-opacity").value*b;e.lineJoin="miter";var A=function(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k;l.eleFillStyle(e,t,a)},L=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D;l.colorStrokeStyle(e,F[0],F[1],F[2],t)},R=t.pstyle("shape").strValue,N=t.pstyle("shape-polygon-points").pfValue;if(f){e.translate(u.x,u.y);var P=l.nodePathCache=l.nodePathCache||[],z=Z("polygon"===R?R+","+N.join(","):R,""+i,""+n),B=P[z];null!=B?(p=B,h=!0,d.pathCache=p):(p=new Path2D,P[z]=d.pathCache=p)}var J=function(){if(!h){var a=u;f&&(a={x:0,y:0}),l.nodeShapes[l.getNodeShape(t)].draw(p||e,a.x,a.y,n,i)}f?e.fill(p):e.fill()},V=function(){for(var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,n=c.backgrounding,i=0,s=0;s<y.length;s++)v[s]&&y[s].complete&&!y[s].error&&(i++,l.drawInscribedImage(e,y[s],t,s,a));c.backgrounding=!(i===E),n!==c.backgrounding&&t.updateStyle(!1)},U=function(){var a=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:b;l.hasPie(t)&&(l.drawPie(e,t,s),a&&(f||l.nodeShapes[l.getNodeShape(t)].draw(e,u.x,u.y,n,i)))},G=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,a=(T>0?T:-T)*t,n=T>0?0:255;0!==T&&(l.colorFillStyle(e,n,n,n,a),f?e.fill(p):e.fill())},q=function(){if(C>0){if(e.lineWidth=C,e.lineCap="butt",e.setLineDash)switch(I){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"solid":case"double":e.setLineDash([])}if(f?e.stroke(p):e.stroke(),"double"===I){e.lineWidth=C/3;var t=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",f?e.stroke(p):e.stroke(),e.globalCompositeOperation=t}e.setLineDash&&e.setLineDash([])}},W=function(){r&&l.drawNodeOverlay(e,t,u,n,i)},H=function(){l.drawElementText(e,t,null,s)},Y="yes"===t.pstyle("ghost").value;if(Y){var $=t.pstyle("ghost-offset-x").pfValue,X=t.pstyle("ghost-offset-y").pfValue,K=t.pstyle("ghost-opacity").value,Q=K*b;e.translate($,X),A(K*k),J(),V(Q),U(0!==T||0!==C),G(Q),L(K*D),q(),e.translate(-$,-X)}A(),J(),V(),U(0!==T||0!==C),G(),L(),q(),f&&e.translate(-u.x,-u.y),H(),W(),a&&e.translate(m.x1,m.y1)}},drawNodeOverlay:function(e,t,a,n,i){if(t.visible()){var s=t.pstyle("overlay-padding").pfValue,r=t.pstyle("overlay-opacity").value,o=t.pstyle("overlay-color").value;if(r>0){if(a=a||t.position(),null==n||null==i){var l=t.padding();n=t.width()+2*l,i=t.height()+2*l}this.colorFillStyle(e,o[0],o[1],o[2],r),this.nodeShapes.roundrectangle.draw(e,a.x,a.y,n+2*s,i+2*s),e.fill()}}},hasPie:function(e){return(e=e[0])._private.hasPie},drawPie:function(e,t,a,n){t=t[0],n=n||t.position();var i=t.cy().style(),s=t.pstyle("pie-size"),r=n.x,o=n.y,l=t.width(),c=t.height(),d=Math.min(l,c)/2,u=0;this.usePaths()&&(r=0,o=0),"%"===s.units?d*=s.pfValue:void 0!==s.pfValue&&(d=s.pfValue/2);for(var p=1;p<=i.pieBackgroundN;p++){var m=t.pstyle("pie-"+p+"-background-size").value,b=t.pstyle("pie-"+p+"-background-color").value,f=t.pstyle("pie-"+p+"-background-opacity").value*a,h=m/100;h+u>1&&(h=1-u);var g=1.5*Math.PI+2*Math.PI*u,j=g+2*Math.PI*h;0===m||u>=1||u+h>1||(e.beginPath(),e.moveTo(r,o),e.arc(r,o,d,g,j),e.closePath(),this.colorFillStyle(e,b[0],b[1],b[2],f),e.fill(),u+=h)}}},Eo={};Eo.getPixelRatio=function(){var e=this.data.contexts[0];if(null!=this.forcedPixelRatio)return this.forcedPixelRatio;var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t},Eo.paintCache=function(e){for(var t,a=this.paintCaches=this.paintCaches||[],n=!0,i=0;i<a.length;i++)if((t=a[i]).context===e){n=!1;break}return n&&(t={context:e},a.push(t)),t},Eo.createGradientStyleFor=function(e,t,a,n,i){var s,r=this.usePaths(),o=a.pstyle(t+"-gradient-stop-colors").value,l=a.pstyle(t+"-gradient-stop-positions").pfValue;if("radial-gradient"===n)if(a.isEdge()){var c=a.sourceEndpoint(),d=a.targetEndpoint(),u=a.midpoint(),p=We(c,u),m=We(d,u);s=e.createRadialGradient(u.x,u.y,0,u.x,u.y,Math.max(p,m))}else{var b=r?{x:0,y:0}:a.position(),f=a.paddedWidth(),h=a.paddedHeight();s=e.createRadialGradient(b.x,b.y,0,b.x,b.y,Math.max(f,h))}else if(a.isEdge()){var g=a.sourceEndpoint(),j=a.targetEndpoint();s=e.createLinearGradient(g.x,g.y,j.x,j.y)}else{var x=r?{x:0,y:0}:a.position(),v=a.paddedWidth()/2,y=a.paddedHeight()/2;switch(a.pstyle("background-gradient-direction").value){case"to-bottom":s=e.createLinearGradient(x.x,x.y-y,x.x,x.y+y);break;case"to-top":s=e.createLinearGradient(x.x,x.y+y,x.x,x.y-y);break;case"to-left":s=e.createLinearGradient(x.x+v,x.y,x.x-v,x.y);break;case"to-right":s=e.createLinearGradient(x.x-v,x.y,x.x+v,x.y);break;case"to-bottom-right":case"to-right-bottom":s=e.createLinearGradient(x.x-v,x.y-y,x.x+v,x.y+y);break;case"to-top-right":case"to-right-top":s=e.createLinearGradient(x.x-v,x.y+y,x.x+v,x.y-y);break;case"to-bottom-left":case"to-left-bottom":s=e.createLinearGradient(x.x+v,x.y-y,x.x-v,x.y+y);break;case"to-top-left":case"to-left-top":s=e.createLinearGradient(x.x+v,x.y+y,x.x-v,x.y-y)}}if(!s)return null;for(var O=l.length===o.length,E=o.length,w=0;w<E;w++)s.addColorStop(O?l[w]:w/(E-1),"rgba("+o[w][0]+","+o[w][1]+","+o[w][2]+","+i+")");return s},Eo.gradientFillStyle=function(e,t,a,n){var i=this.createGradientStyleFor(e,"background",t,a,n);if(!i)return null;e.fillStyle=i},Eo.colorFillStyle=function(e,t,a,n,i){e.fillStyle="rgba("+t+","+a+","+n+","+i+")"},Eo.eleFillStyle=function(e,t,a){var n=t.pstyle("background-fill").value;if("linear-gradient"===n||"radial-gradient"===n)this.gradientFillStyle(e,t,n,a);else{var i=t.pstyle("background-color").value;this.colorFillStyle(e,i[0],i[1],i[2],a)}},Eo.gradientStrokeStyle=function(e,t,a,n){var i=this.createGradientStyleFor(e,"line",t,a,n);if(!i)return null;e.strokeStyle=i},Eo.colorStrokeStyle=function(e,t,a,n,i){e.strokeStyle="rgba("+t+","+a+","+n+","+i+")"},Eo.eleStrokeStyle=function(e,t,a){var n=t.pstyle("line-fill").value;if("linear-gradient"===n||"radial-gradient"===n)this.gradientStrokeStyle(e,t,n,a);else{var i=t.pstyle("line-color").value;this.colorStrokeStyle(e,i[0],i[1],i[2],a)}},Eo.matchCanvasSize=function(e){var t=this,a=t.data,n=t.findContainerClientCoords(),i=n[2],s=n[3],r=t.getPixelRatio(),o=t.motionBlurPxRatio;e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_NODE]&&e!==t.data.bufferCanvases[t.MOTIONBLUR_BUFFER_DRAG]||(r=o);var l,c=i*r,d=s*r;if(c!==t.canvasWidth||d!==t.canvasHeight){t.fontCaches=null;var u=a.canvasContainer;u.style.width=i+"px",u.style.height=s+"px";for(var p=0;p<t.CANVAS_LAYERS;p++)(l=a.canvases[p]).width=c,l.height=d,l.style.width=i+"px",l.style.height=s+"px";for(p=0;p<t.BUFFER_COUNT;p++)(l=a.bufferCanvases[p]).width=c,l.height=d,l.style.width=i+"px",l.style.height=s+"px";t.textureMult=1,r<=1&&(l=a.bufferCanvases[t.TEXTURE_BUFFER],t.textureMult=2,l.width=c*t.textureMult,l.height=d*t.textureMult),t.canvasWidth=c,t.canvasHeight=d}},Eo.renderTo=function(e,t,a,n){this.render({forcedContext:e,forcedZoom:t,forcedPan:a,drawAllLayers:!0,forcedPxRatio:n})},Eo.render=function(e){var t=(e=e||fe()).forcedContext,a=e.drawAllLayers,n=e.drawOnlyNodeLayer,i=e.forcedZoom,s=e.forcedPan,r=this,o=void 0===e.forcedPxRatio?this.getPixelRatio():e.forcedPxRatio,l=r.cy,c=r.data,d=c.canvasNeedsRedraw,u=r.textureOnViewport&&!t&&(r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming),p=void 0!==e.motionBlur?e.motionBlur:r.motionBlur,m=r.motionBlurPxRatio,b=l.hasCompoundNodes(),f=r.hoverData.draggingEles,h=!(!r.hoverData.selecting&&!r.touchData.selecting),g=p=p&&!t&&r.motionBlurEnabled&&!h;t||(r.prevPxRatio!==o&&(r.invalidateContainerClientCoordsCache(),r.matchCanvasSize(r.container),r.redrawHint("eles",!0),r.redrawHint("drag",!0)),r.prevPxRatio=o),!t&&r.motionBlurTimeout&&clearTimeout(r.motionBlurTimeout),p&&(null==r.mbFrames&&(r.mbFrames=0),r.mbFrames++,r.mbFrames<3&&(g=!1),r.mbFrames>r.minMbLowQualFrames&&(r.motionBlurPxRatio=r.mbPxRBlurry)),r.clearingMotionBlur&&(r.motionBlurPxRatio=1),r.textureDrawLastFrame&&!u&&(d[r.NODE]=!0,d[r.SELECT_BOX]=!0);var j=l.style(),x=l.zoom(),v=void 0!==i?i:x,y=l.pan(),O={x:y.x,y:y.y},E={zoom:x,pan:{x:y.x,y:y.y}},w=r.prevViewport;void 0===w||E.zoom!==w.zoom||E.pan.x!==w.pan.x||E.pan.y!==w.pan.y||f&&!b||(r.motionBlurPxRatio=1),s&&(O=s),v*=o,O.x*=o,O.y*=o;var M=r.getCachedZSortedEles();function S(e,t,a,n,i){var s=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",r.colorFillStyle(e,255,255,255,r.motionBlurTransparency),e.fillRect(t,a,n,i),e.globalCompositeOperation=s}function _(e,n){var o,l,d,u;r.clearingMotionBlur||e!==c.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]&&e!==c.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]?(o=O,l=v,d=r.canvasWidth,u=r.canvasHeight):(o={x:y.x*m,y:y.y*m},l=x*m,d=r.canvasWidth*m,u=r.canvasHeight*m),e.setTransform(1,0,0,1,0,0),"motionBlur"===n?S(e,0,0,d,u):t||void 0!==n&&!n||e.clearRect(0,0,d,u),a||(e.translate(o.x,o.y),e.scale(l,l)),s&&e.translate(s.x,s.y),i&&e.scale(i,i)}if(u||(r.textureDrawLastFrame=!1),u){if(r.textureDrawLastFrame=!0,!r.textureCache){r.textureCache={},r.textureCache.bb=l.mutableElements().boundingBox(),r.textureCache.texture=r.data.bufferCanvases[r.TEXTURE_BUFFER];var T=r.data.bufferContexts[r.TEXTURE_BUFFER];T.setTransform(1,0,0,1,0,0),T.clearRect(0,0,r.canvasWidth*r.textureMult,r.canvasHeight*r.textureMult),r.render({forcedContext:T,drawOnlyNodeLayer:!0,forcedPxRatio:o*r.textureMult}),(E=r.textureCache.viewport={zoom:l.zoom(),pan:l.pan(),width:r.canvasWidth,height:r.canvasHeight}).mpan={x:(0-E.pan.x)/E.zoom,y:(0-E.pan.y)/E.zoom}}d[r.DRAG]=!1,d[r.NODE]=!1;var C=c.contexts[r.NODE],k=r.textureCache.texture;E=r.textureCache.viewport;C.setTransform(1,0,0,1,0,0),p?S(C,0,0,E.width,E.height):C.clearRect(0,0,E.width,E.height);var F=j.core("outside-texture-bg-color").value,I=j.core("outside-texture-bg-opacity").value;r.colorFillStyle(C,F[0],F[1],F[2],I),C.fillRect(0,0,E.width,E.height);x=l.zoom();_(C,!1),C.clearRect(E.mpan.x,E.mpan.y,E.width/E.zoom/o,E.height/E.zoom/o),C.drawImage(k,E.mpan.x,E.mpan.y,E.width/E.zoom/o,E.height/E.zoom/o)}else r.textureOnViewport&&!t&&(r.textureCache=null);var D=l.extent(),A=r.pinching||r.hoverData.dragging||r.swipePanning||r.data.wheelZooming||r.hoverData.draggingEles||r.cy.animated(),L=r.hideEdgesOnViewport&&A,R=[];if(R[r.NODE]=!d[r.NODE]&&p&&!r.clearedForMotionBlur[r.NODE]||r.clearingMotionBlur,R[r.NODE]&&(r.clearedForMotionBlur[r.NODE]=!0),R[r.DRAG]=!d[r.DRAG]&&p&&!r.clearedForMotionBlur[r.DRAG]||r.clearingMotionBlur,R[r.DRAG]&&(r.clearedForMotionBlur[r.DRAG]=!0),d[r.NODE]||a||n||R[r.NODE]){var N=p&&!R[r.NODE]&&1!==m;_(C=t||(N?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_NODE]:c.contexts[r.NODE]),p&&!N?"motionBlur":void 0),L?r.drawCachedNodes(C,M.nondrag,o,D):r.drawLayeredElements(C,M.nondrag,o,D),r.debug&&r.drawDebugPoints(C,M.nondrag),a||p||(d[r.NODE]=!1)}if(!n&&(d[r.DRAG]||a||R[r.DRAG])){N=p&&!R[r.DRAG]&&1!==m;_(C=t||(N?r.data.bufferContexts[r.MOTIONBLUR_BUFFER_DRAG]:c.contexts[r.DRAG]),p&&!N?"motionBlur":void 0),L?r.drawCachedNodes(C,M.drag,o,D):r.drawCachedElements(C,M.drag,o,D),r.debug&&r.drawDebugPoints(C,M.drag),a||p||(d[r.DRAG]=!1)}if(r.showFps||!n&&d[r.SELECT_BOX]&&!a){if(_(C=t||c.contexts[r.SELECT_BOX]),1==r.selection[4]&&(r.hoverData.selecting||r.touchData.selecting)){x=r.cy.zoom();var P=j.core("selection-box-border-width").value/x;C.lineWidth=P,C.fillStyle="rgba("+j.core("selection-box-color").value[0]+","+j.core("selection-box-color").value[1]+","+j.core("selection-box-color").value[2]+","+j.core("selection-box-opacity").value+")",C.fillRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]),P>0&&(C.strokeStyle="rgba("+j.core("selection-box-border-color").value[0]+","+j.core("selection-box-border-color").value[1]+","+j.core("selection-box-border-color").value[2]+","+j.core("selection-box-opacity").value+")",C.strokeRect(r.selection[0],r.selection[1],r.selection[2]-r.selection[0],r.selection[3]-r.selection[1]))}if(c.bgActivePosistion&&!r.hoverData.selecting){x=r.cy.zoom();var z=c.bgActivePosistion;C.fillStyle="rgba("+j.core("active-bg-color").value[0]+","+j.core("active-bg-color").value[1]+","+j.core("active-bg-color").value[2]+","+j.core("active-bg-opacity").value+")",C.beginPath(),C.arc(z.x,z.y,j.core("active-bg-size").pfValue/x,0,2*Math.PI),C.fill()}var B=r.lastRedrawTime;if(r.showFps&&B){B=Math.round(B);var J=Math.round(1e3/B);C.setTransform(1,0,0,1,0,0),C.fillStyle="rgba(255, 0, 0, 0.75)",C.strokeStyle="rgba(255, 0, 0, 0.75)",C.lineWidth=1,C.fillText("1 frame = "+B+" ms = "+J+" fps",0,20);C.strokeRect(0,30,250,20),C.fillRect(0,30,250*Math.min(J/60,1),20)}a||(d[r.SELECT_BOX]=!1)}if(p&&1!==m){var V=c.contexts[r.NODE],U=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_NODE],G=c.contexts[r.DRAG],q=r.data.bufferCanvases[r.MOTIONBLUR_BUFFER_DRAG],W=function(e,t,a){e.setTransform(1,0,0,1,0,0),a||!g?e.clearRect(0,0,r.canvasWidth,r.canvasHeight):S(e,0,0,r.canvasWidth,r.canvasHeight);var n=m;e.drawImage(t,0,0,r.canvasWidth*n,r.canvasHeight*n,0,0,r.canvasWidth,r.canvasHeight)};(d[r.NODE]||R[r.NODE])&&(W(V,U,R[r.NODE]),d[r.NODE]=!1),(d[r.DRAG]||R[r.DRAG])&&(W(G,q,R[r.DRAG]),d[r.DRAG]=!1)}r.prevViewport=E,r.clearingMotionBlur&&(r.clearingMotionBlur=!1,r.motionBlurCleared=!0,r.motionBlur=!0),p&&(r.motionBlurTimeout=setTimeout((function(){r.motionBlurTimeout=null,r.clearedForMotionBlur[r.NODE]=!1,r.clearedForMotionBlur[r.DRAG]=!1,r.motionBlur=!1,r.clearingMotionBlur=!u,r.mbFrames=0,d[r.NODE]=!0,d[r.DRAG]=!0,r.redraw()}),100)),t||l.emit("render")};for(var wo={drawPolygonPath:function(e,t,a,n,i,s){var r=n/2,o=i/2;e.beginPath&&e.beginPath(),e.moveTo(t+r*s[0],a+o*s[1]);for(var l=1;l<s.length/2;l++)e.lineTo(t+r*s[2*l],a+o*s[2*l+1]);e.closePath()},drawRoundRectanglePath:function(e,t,a,n,i){var s=n/2,r=i/2,o=Mt(n,i);e.beginPath&&e.beginPath(),e.moveTo(t,a-r),e.arcTo(t+s,a-r,t+s,a,o),e.arcTo(t+s,a+r,t,a+r,o),e.arcTo(t-s,a+r,t-s,a,o),e.arcTo(t-s,a-r,t,a-r,o),e.lineTo(t,a-r),e.closePath()},drawBottomRoundRectanglePath:function(e,t,a,n,i){var s=n/2,r=i/2,o=Mt(n,i);e.beginPath&&e.beginPath(),e.moveTo(t,a-r),e.lineTo(t+s,a-r),e.lineTo(t+s,a),e.arcTo(t+s,a+r,t,a+r,o),e.arcTo(t-s,a+r,t-s,a,o),e.lineTo(t-s,a-r),e.lineTo(t,a-r),e.closePath()},drawCutRectanglePath:function(e,t,a,n,i){var s=n/2,r=i/2;e.beginPath&&e.beginPath(),e.moveTo(t-s+8,a-r),e.lineTo(t+s-8,a-r),e.lineTo(t+s,a-r+8),e.lineTo(t+s,a+r-8),e.lineTo(t+s-8,a+r),e.lineTo(t-s+8,a+r),e.lineTo(t-s,a+r-8),e.lineTo(t-s,a-r+8),e.closePath()},drawBarrelPath:function(e,t,a,n,i){var s=n/2,r=i/2,o=t-s,l=t+s,c=a-r,d=a+r,u=St(n,i),p=u.widthOffset,m=u.heightOffset,b=u.ctrlPtOffsetPct*p;e.beginPath&&e.beginPath(),e.moveTo(o,c+m),e.lineTo(o,d-m),e.quadraticCurveTo(o+b,d,o+p,d),e.lineTo(l-p,d),e.quadraticCurveTo(l-b,d,l,d-m),e.lineTo(l,c+m),e.quadraticCurveTo(l-b,c,l-p,c),e.lineTo(o+p,c),e.quadraticCurveTo(o+b,c,o,c+m),e.closePath()}},Mo=Math.sin(0),So=Math.cos(0),_o={},To={},Co=Math.PI/40,ko=0*Math.PI;ko<2*Math.PI;ko+=Co)_o[ko]=Math.sin(ko),To[ko]=Math.cos(ko);wo.drawEllipsePath=function(e,t,a,n,i){if(e.beginPath&&e.beginPath(),e.ellipse)e.ellipse(t,a,n/2,i/2,0,0,2*Math.PI);else for(var s,r,o=n/2,l=i/2,c=0*Math.PI;c<2*Math.PI;c+=Co)s=t-o*_o[c]*Mo+o*To[c]*So,r=a+l*To[c]*Mo+l*_o[c]*So,0===c?e.moveTo(s,r):e.lineTo(s,r);e.closePath()};var Fo={};function Io(e){var t=e.indexOf(",");return e.substr(t+1)}function Do(e,t,a){var n=function(){return t.toDataURL(a,e.quality)};switch(e.output){case"blob-promise":return new Aa((function(n,i){try{t.toBlob((function(e){null!=e?n(e):i(new Error("`canvas.toBlob()` sent a null value in its callback"))}),a,e.quality)}catch(e){i(e)}}));case"blob":return function(e,t){for(var a=atob(e),n=new ArrayBuffer(a.length),i=new Uint8Array(n),s=0;s<a.length;s++)i[s]=a.charCodeAt(s);return new Blob([n],{type:t})}(Io(n()),a);case"base64":return Io(n());case"base64uri":default:return n()}}Fo.createBuffer=function(e,t){var a=document.createElement("canvas");return a.width=e,a.height=t,[a,a.getContext("2d")]},Fo.bufferCanvasImage=function(e){var t=this.cy,a=t.mutableElements().boundingBox(),n=this.findContainerClientCoords(),i=e.full?Math.ceil(a.w):n[2],s=e.full?Math.ceil(a.h):n[3],r=O(e.maxWidth)||O(e.maxHeight),o=this.getPixelRatio(),l=1;if(void 0!==e.scale)i*=e.scale,s*=e.scale,l=e.scale;else if(r){var c=1/0,d=1/0;O(e.maxWidth)&&(c=l*e.maxWidth/i),O(e.maxHeight)&&(d=l*e.maxHeight/s),i*=l=Math.min(c,d),s*=l}r||(i*=o,s*=o,l*=o);var u=document.createElement("canvas");u.width=i,u.height=s,u.style.width=i+"px",u.style.height=s+"px";var p=u.getContext("2d");if(i>0&&s>0){p.clearRect(0,0,i,s),p.globalCompositeOperation="source-over";var m=this.getCachedZSortedEles();if(e.full)p.translate(-a.x1*l,-a.y1*l),p.scale(l,l),this.drawElements(p,m),p.scale(1/l,1/l),p.translate(a.x1*l,a.y1*l);else{var b=t.pan(),f={x:b.x*l,y:b.y*l};l*=t.zoom(),p.translate(f.x,f.y),p.scale(l,l),this.drawElements(p,m),p.scale(1/l,1/l),p.translate(-f.x,-f.y)}e.bg&&(p.globalCompositeOperation="destination-over",p.fillStyle=e.bg,p.rect(0,0,i,s),p.fill())}return u},Fo.png=function(e){return Do(e,this.bufferCanvasImage(e),"image/png")},Fo.jpg=function(e){return Do(e,this.bufferCanvasImage(e),"image/jpeg")};var Ao={nodeShapeImpl:function(e,t,a,n,i,s,r){switch(e){case"ellipse":return this.drawEllipsePath(t,a,n,i,s);case"polygon":return this.drawPolygonPath(t,a,n,i,s,r);case"roundrectangle":case"round-rectangle":return this.drawRoundRectanglePath(t,a,n,i,s);case"cutrectangle":case"cut-rectangle":return this.drawCutRectanglePath(t,a,n,i,s);case"bottomroundrectangle":case"bottom-round-rectangle":return this.drawBottomRoundRectanglePath(t,a,n,i,s);case"barrel":return this.drawBarrelPath(t,a,n,i,s)}}},Lo=No,Ro=No.prototype;function No(e){var t=this;t.data={canvases:new Array(Ro.CANVAS_LAYERS),contexts:new Array(Ro.CANVAS_LAYERS),canvasNeedsRedraw:new Array(Ro.CANVAS_LAYERS),bufferCanvases:new Array(Ro.BUFFER_COUNT),bufferContexts:new Array(Ro.CANVAS_LAYERS)};var a="-webkit-tap-highlight-color",n="rgba(0,0,0,0)";t.data.canvasContainer=document.createElement("div");var i=t.data.canvasContainer.style;t.data.canvasContainer.style[a]=n,i.position="relative",i.zIndex="0",i.overflow="hidden";var s=e.cy.container();s.appendChild(t.data.canvasContainer),s.style[a]=n;var r={"-webkit-user-select":"none","-moz-user-select":"-moz-none","user-select":"none","-webkit-tap-highlight-color":"rgba(0,0,0,0)","outline-style":"none"};p&&p.userAgent.match(/msie|trident|edge/i)&&(r["-ms-touch-action"]="none",r["touch-action"]="none");for(var o=0;o<Ro.CANVAS_LAYERS;o++){var l=t.data.canvases[o]=document.createElement("canvas");t.data.contexts[o]=l.getContext("2d"),Object.keys(r).forEach((function(e){l.style[e]=r[e]})),l.style.position="absolute",l.setAttribute("data-id","layer"+o),l.style.zIndex=String(Ro.CANVAS_LAYERS-o),t.data.canvasContainer.appendChild(l),t.data.canvasNeedsRedraw[o]=!1}t.data.topCanvas=t.data.canvases[0],t.data.canvases[Ro.NODE].setAttribute("data-id","layer"+Ro.NODE+"-node"),t.data.canvases[Ro.SELECT_BOX].setAttribute("data-id","layer"+Ro.SELECT_BOX+"-selectbox"),t.data.canvases[Ro.DRAG].setAttribute("data-id","layer"+Ro.DRAG+"-drag");for(o=0;o<Ro.BUFFER_COUNT;o++)t.data.bufferCanvases[o]=document.createElement("canvas"),t.data.bufferContexts[o]=t.data.bufferCanvases[o].getContext("2d"),t.data.bufferCanvases[o].style.position="absolute",t.data.bufferCanvases[o].setAttribute("data-id","buffer"+o),t.data.bufferCanvases[o].style.zIndex=String(-o-1),t.data.bufferCanvases[o].style.visibility="hidden";t.pathsEnabled=!0;var c=Qe(),d=function(e){return{x:-e.w/2,y:-e.h/2}},u=function(e){return e.boundingBox(),e[0]._private.bodyBounds},m=function(e){return e.boundingBox(),e[0]._private.labelBounds.main||c},b=function(e){return e.boundingBox(),e[0]._private.labelBounds.source||c},f=function(e){return e.boundingBox(),e[0]._private.labelBounds.target||c},h=function(e,t){return t},g=function(e,t){return{x:e.x+t.pstyle("text-margin-x").pfValue,y:e.y+t.pstyle("text-margin-y").pfValue}},j=function(e,t,a){var n=e[0]._private.rscratch;return{x:n[t],y:n[a]}},x=t.data.eleTxrCache=new Qr(t,{getKey:function(e){return e[0]._private.nodeKey},doesEleInvalidateKey:function(e){var t=e[0]._private;return!(t.oldBackgroundTimestamp===t.backgroundTimestamp)},drawElement:function(e,a,n,i,s){return t.drawElement(e,a,n,!1,!1,s)},getBoundingBox:u,getRotationPoint:function(e){return{x:((t=u(e)).x1+t.x2)/2,y:(t.y1+t.y2)/2};var t},getRotationOffset:function(e){return d(u(e))},allowEdgeTxrCaching:!1,allowParentTxrCaching:!1}),v=t.data.lblTxrCache=new Qr(t,{getKey:function(e){return e[0]._private.labelStyleKey},drawElement:function(e,a,n,i,s){return t.drawElementText(e,a,n,i,"main",s)},getBoundingBox:m,getRotationPoint:function(e){return g(j(e,"labelX","labelY"),e)},getRotationOffset:function(e){var t=m(e),a=d(m(e));if(e.isNode()){switch(e.pstyle("text-halign").value){case"left":a.x=-t.w;break;case"right":a.x=0}switch(e.pstyle("text-valign").value){case"top":a.y=-t.h;break;case"bottom":a.y=0}}return a},isVisible:h}),y=t.data.slbTxrCache=new Qr(t,{getKey:function(e){return e[0]._private.sourceLabelStyleKey},drawElement:function(e,a,n,i,s){return t.drawElementText(e,a,n,i,"source",s)},getBoundingBox:b,getRotationPoint:function(e){return g(j(e,"sourceLabelX","sourceLabelY"),e)},getRotationOffset:function(e){return d(b(e))},isVisible:h}),O=t.data.tlbTxrCache=new Qr(t,{getKey:function(e){return e[0]._private.targetLabelStyleKey},drawElement:function(e,a,n,i,s){return t.drawElementText(e,a,n,i,"target",s)},getBoundingBox:f,getRotationPoint:function(e){return g(j(e,"targetLabelX","targetLabelY"),e)},getRotationOffset:function(e){return d(f(e))},isVisible:h}),E=t.data.lyrTxrCache=new eo(t);t.onUpdateEleCalcs((function(e,t){x.invalidateElements(t),v.invalidateElements(t),y.invalidateElements(t),O.invalidateElements(t),E.invalidateElements(t);for(var a=0;a<t.length;a++){var n=t[a]._private;n.oldBackgroundTimestamp=n.backgroundTimestamp}}));var w=function(e){for(var t=0;t<e.length;t++)E.enqueueElementRefinement(e[t].ele)};x.onDequeue(w),v.onDequeue(w),y.onDequeue(w),O.onDequeue(w)}Ro.CANVAS_LAYERS=3,Ro.SELECT_BOX=0,Ro.DRAG=1,Ro.NODE=2,Ro.BUFFER_COUNT=3,Ro.TEXTURE_BUFFER=0,Ro.MOTIONBLUR_BUFFER_NODE=1,Ro.MOTIONBLUR_BUFFER_DRAG=2,Ro.redrawHint=function(e,t){var a=this;switch(e){case"eles":a.data.canvasNeedsRedraw[Ro.NODE]=t;break;case"drag":a.data.canvasNeedsRedraw[Ro.DRAG]=t;break;case"select":a.data.canvasNeedsRedraw[Ro.SELECT_BOX]=t}};var Po="undefined"!=typeof Path2D;Ro.path2dEnabled=function(e){if(void 0===e)return this.pathsEnabled;this.pathsEnabled=!!e},Ro.usePaths=function(){return Po&&this.pathsEnabled},Ro.setImgSmoothing=function(e,t){null!=e.imageSmoothingEnabled?e.imageSmoothingEnabled=t:(e.webkitImageSmoothingEnabled=t,e.mozImageSmoothingEnabled=t,e.msImageSmoothingEnabled=t)},Ro.getImgSmoothing=function(e){return null!=e.imageSmoothingEnabled?e.imageSmoothingEnabled:e.webkitImageSmoothingEnabled||e.mozImageSmoothingEnabled||e.msImageSmoothingEnabled},Ro.makeOffscreenCanvas=function(e,t){var a;return"undefined"!==("undefined"==typeof OffscreenCanvas?"undefined":r(OffscreenCanvas))?a=new OffscreenCanvas(e,t):((a=document.createElement("canvas")).width=e,a.height=t),a},[so,uo,jo,xo,vo,Oo,Eo,wo,Fo,Ao].forEach((function(e){P(Ro,e)}));var zo=[{type:"layout",extensions:yr},{type:"renderer",extensions:[{name:"null",impl:Or},{name:"base",impl:qr},{name:"canvas",impl:Lo}]}],Bo={},Jo={};function Vo(e,t,a){var n=a,i=function(a){ce("Can not register `"+t+"` for `"+e+"` since `"+a+"` already exists in the prototype and can not be overridden")};if("core"===e){if(Ls.prototype[t])return i(t);Ls.prototype[t]=a}else if("collection"===e){if(Qi.prototype[t])return i(t);Qi.prototype[t]=a}else if("layout"===e){for(var s=function(e){this.options=e,a.call(this,e),y(this._private)||(this._private={}),this._private.cy=e.cy,this._private.listeners=[],this.createEmitter()},r=s.prototype=Object.create(a.prototype),o=[],l=0;l<o.length;l++){var c=o[l];r[c]=r[c]||function(){return this}}r.start&&!r.run?r.run=function(){return this.start(),this}:!r.start&&r.run&&(r.start=function(){return this.run(),this});var d=a.prototype.stop;r.stop=function(){var e=this.options;if(e&&e.animate){var t=this.animations;if(t)for(var a=0;a<t.length;a++)t[a].stop()}return d?d.call(this):this.emit("layoutstop"),this},r.destroy||(r.destroy=function(){return this}),r.cy=function(){return this._private.cy};var u=function(e){return e._private.cy},p={addEventFields:function(e,t){t.layout=e,t.cy=u(e),t.target=e},bubble:function(){return!0},parent:function(e){return u(e)}};P(r,{createEmitter:function(){return this._private.emitter=new hi(p,this),this},emitter:function(){return this._private.emitter},on:function(e,t){return this.emitter().on(e,t),this},one:function(e,t){return this.emitter().one(e,t),this},once:function(e,t){return this.emitter().one(e,t),this},removeListener:function(e,t){return this.emitter().removeListener(e,t),this},removeAllListeners:function(){return this.emitter().removeAllListeners(),this},emit:function(e,t){return this.emitter().emit(e,t),this}}),Na.eventAliasesOn(r),n=s}else if("renderer"===e&&"null"!==t&&"base"!==t){var m=Uo("renderer","base"),b=m.prototype,f=a,h=a.prototype,g=function(){m.apply(this,arguments),f.apply(this,arguments)},j=g.prototype;for(var x in b){var v=b[x];if(null!=h[x])return i(x);j[x]=v}for(var O in h)j[O]=h[O];b.clientFunctions.forEach((function(e){j[e]=j[e]||function(){ce("Renderer does not implement `renderer."+e+"()` on its prototype")}})),n=g}return J({map:Bo,keys:[e,t],value:n})}function Uo(e,t){return V({map:Bo,keys:[e,t]})}function Go(e,t,a,n,i){return J({map:Jo,keys:[e,t,a,n],value:i})}function qo(e,t,a,n){return V({map:Jo,keys:[e,t,a,n]})}var Wo=function(){return 2===arguments.length?Uo.apply(null,arguments):3===arguments.length?Vo.apply(null,arguments):4===arguments.length?qo.apply(null,arguments):5===arguments.length?Go.apply(null,arguments):void ce("Invalid extension access syntax")};Ls.prototype.extension=Wo,zo.forEach((function(e){e.extensions.forEach((function(t){Vo(e.type,t.name,t.impl)}))}));var Ho=function e(){if(!(this instanceof e))return new e;this.length=0},Yo=Ho.prototype;Yo.instanceString=function(){return"stylesheet"},Yo.selector=function(e){return this[this.length++]={selector:e,properties:[]},this},Yo.css=function(e,t){var a=this.length-1;if(j(e))this[a].properties.push({name:e,value:t});else if(y(e))for(var n=e,i=Object.keys(n),s=0;s<i.length;s++){var r=i[s],o=n[r];if(null!=o){var l=ks.properties[r]||ks.properties[D(r)];if(null!=l){var c=l.name,d=o;this[a].properties.push({name:c,value:d})}}}return this},Yo.style=Yo.css,Yo.generateStyle=function(e){var t=new ks(e);return this.appendToStyle(t)},Yo.appendToStyle=function(e){for(var t=0;t<this.length;t++){var a=this[t],n=a.selector,i=a.properties;e.selector(n);for(var s=0;s<i.length;s++){var r=i[s];e.css(r.name,r.value)}}return e};var $o=function(e){return void 0===e&&(e={}),y(e)?new Ls(e):j(e)?Wo.apply(Wo,arguments):void 0};$o.use=function(e){var t=Array.prototype.slice.call(arguments,1);return t.unshift($o),e.apply(null,t),this},$o.warnings=function(e){return de(e)},$o.version="3.10.0",$o.stylesheet=$o.Stylesheet=Ho,e.exports=$o}).call(this,a(476).setImmediate)},function(e,t,a){(function(e){var n=Function.prototype.apply;function i(e,t){this._id=e,this._clearFn=t}t.setTimeout=function(){return new i(n.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new i(n.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout((function(){e._onTimeout&&e._onTimeout()}),t))},a(477),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(this,a(133))},function(e,t,a){(function(e,t){!function(e,a){"use strict";if(!e.setImmediate){var n,i,s,r,o,l=1,c={},d=!1,u=e.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(e);p=p&&p.setTimeout?p:e,"[object process]"==={}.toString.call(e.process)?n=function(e){t.nextTick((function(){b(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,a=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=a,t}}()?e.MessageChannel?((s=new MessageChannel).port1.onmessage=function(e){b(e.data)},n=function(e){s.port2.postMessage(e)}):u&&"onreadystatechange"in u.createElement("script")?(i=u.documentElement,n=function(e){var t=u.createElement("script");t.onreadystatechange=function(){b(e),t.onreadystatechange=null,i.removeChild(t),t=null},i.appendChild(t)}):n=function(e){setTimeout(b,0,e)}:(r="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&b(+t.data.slice(r.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),n=function(t){e.postMessage(r+t,"*")}),p.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),a=0;a<t.length;a++)t[a]=arguments[a+1];var i={callback:e,args:t};return c[l]=i,n(l),l++},p.clearImmediate=m}function m(e){delete c[e]}function b(e){if(d)setTimeout(b,0,e);else{var t=c[e];if(t){d=!0;try{!function(e){var t=e.callback,a=e.args;switch(a.length){case 0:t();break;case 1:t(a[0]);break;case 2:t(a[0],a[1]);break;case 3:t(a[0],a[1],a[2]);break;default:t.apply(void 0,a)}}(t)}finally{m(e),d=!1}}}}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,a(133),a(221))},function(e,t,a){(function(t){var a=/^\s+|\s+$/g,n=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,s=/^0o[0-7]+$/i,r=parseInt,o="object"==typeof t&&t&&t.Object===Object&&t,l="object"==typeof self&&self&&self.Object===Object&&self,c=o||l||Function("return this")(),d=Object.prototype.toString,u=Math.max,p=Math.min,m=function(){return c.Date.now()};function b(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function f(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==d.call(e)}(e))return NaN;if(b(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=b(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var o=i.test(e);return o||s.test(e)?r(e.slice(2),o?2:8):n.test(e)?NaN:+e}e.exports=function(e,t,a){var n,i,s,r,o,l,c=0,d=!1,h=!1,g=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function j(t){var a=n,s=i;return n=i=void 0,c=t,r=e.apply(s,a)}function x(e){return c=e,o=setTimeout(y,t),d?j(e):r}function v(e){var a=e-l;return void 0===l||a>=t||a<0||h&&e-c>=s}function y(){var e=m();if(v(e))return O(e);o=setTimeout(y,function(e){var a=t-(e-l);return h?p(a,s-(e-c)):a}(e))}function O(e){return o=void 0,g&&n?j(e):(n=i=void 0,r)}function E(){var e=m(),a=v(e);if(n=arguments,i=this,l=e,a){if(void 0===o)return x(l);if(h)return o=setTimeout(y,t),j(l)}return void 0===o&&(o=setTimeout(y,t)),r}return t=f(t)||0,b(a)&&(d=!!a.leading,s=(h="maxWait"in a)?u(f(a.maxWait)||0,t):s,g="trailing"in a?!!a.trailing:g),E.cancel=function(){void 0!==o&&clearTimeout(o),c=0,n=l=i=o=void 0},E.flush=function(){return void 0===o?r:O(m())},E}}).call(this,a(133))},function(e,t,a){e.exports=a(480)},function(e,t,a){var n,i,s;(function(){var a,r,o,l,c,d,u,p,m,b,f,h,g,j,x;o=Math.floor,b=Math.min,r=function(e,t){return e<t?-1:e>t?1:0},m=function(e,t,a,n,i){var s;if(null==a&&(a=0),null==i&&(i=r),a<0)throw new Error("lo must be non-negative");for(null==n&&(n=e.length);a<n;)i(t,e[s=o((a+n)/2)])<0?n=s:a=s+1;return[].splice.apply(e,[a,a-a].concat(t)),t},d=function(e,t,a){return null==a&&(a=r),e.push(t),j(e,0,e.length-1,a)},c=function(e,t){var a,n;return null==t&&(t=r),a=e.pop(),e.length?(n=e[0],e[0]=a,x(e,0,t)):n=a,n},p=function(e,t,a){var n;return null==a&&(a=r),n=e[0],e[0]=t,x(e,0,a),n},u=function(e,t,a){var n;return null==a&&(a=r),e.length&&a(e[0],t)<0&&(t=(n=[e[0],t])[0],e[0]=n[1],x(e,0,a)),t},l=function(e,t){var a,n,i,s,l,c;for(null==t&&(t=r),l=[],n=0,i=(s=function(){c=[];for(var t=0,a=o(e.length/2);0<=a?t<a:t>a;0<=a?t++:t--)c.push(t);return c}.apply(this).reverse()).length;n<i;n++)a=s[n],l.push(x(e,a,t));return l},g=function(e,t,a){var n;if(null==a&&(a=r),-1!==(n=e.indexOf(t)))return j(e,0,n,a),x(e,n,a)},f=function(e,t,a){var n,i,s,o,c;if(null==a&&(a=r),!(i=e.slice(0,t)).length)return i;for(l(i,a),s=0,o=(c=e.slice(t)).length;s<o;s++)n=c[s],u(i,n,a);return i.sort(a).reverse()},h=function(e,t,a){var n,i,s,o,d,u,p,f,h;if(null==a&&(a=r),10*t<=e.length){if(!(s=e.slice(0,t).sort(a)).length)return s;for(i=s[s.length-1],o=0,u=(p=e.slice(t)).length;o<u;o++)a(n=p[o],i)<0&&(m(s,n,0,null,a),s.pop(),i=s[s.length-1]);return s}for(l(e,a),h=[],d=0,f=b(t,e.length);0<=f?d<f:d>f;0<=f?++d:--d)h.push(c(e,a));return h},j=function(e,t,a,n){var i,s,o;for(null==n&&(n=r),i=e[a];a>t&&n(i,s=e[o=a-1>>1])<0;)e[a]=s,a=o;return e[a]=i},x=function(e,t,a){var n,i,s,o,l;for(null==a&&(a=r),i=e.length,l=t,s=e[t],n=2*t+1;n<i;)(o=n+1)<i&&!(a(e[n],e[o])<0)&&(n=o),e[t]=e[n],n=2*(t=n)+1;return e[t]=s,j(e,l,t,a)},a=function(){function e(e){this.cmp=null!=e?e:r,this.nodes=[]}return e.push=d,e.pop=c,e.replace=p,e.pushpop=u,e.heapify=l,e.updateItem=g,e.nlargest=f,e.nsmallest=h,e.prototype.push=function(e){return d(this.nodes,e,this.cmp)},e.prototype.pop=function(){return c(this.nodes,this.cmp)},e.prototype.peek=function(){return this.nodes[0]},e.prototype.contains=function(e){return-1!==this.nodes.indexOf(e)},e.prototype.replace=function(e){return p(this.nodes,e,this.cmp)},e.prototype.pushpop=function(e){return u(this.nodes,e,this.cmp)},e.prototype.heapify=function(){return l(this.nodes,this.cmp)},e.prototype.updateItem=function(e){return g(this.nodes,e,this.cmp)},e.prototype.clear=function(){return this.nodes=[]},e.prototype.empty=function(){return 0===this.nodes.length},e.prototype.size=function(){return this.nodes.length},e.prototype.clone=function(){var t;return(t=new e).nodes=this.nodes.slice(0),t},e.prototype.toArray=function(){return this.nodes.slice(0)},e.prototype.insert=e.prototype.push,e.prototype.top=e.prototype.peek,e.prototype.front=e.prototype.peek,e.prototype.has=e.prototype.contains,e.prototype.copy=e.prototype.clone,e}(),i=[],void 0===(s="function"==typeof(n=function(){return a})?n.apply(t,i):n)||(e.exports=s)}).call(this)},function(e,t,a){var n;n=function(e){return function(e){var t={};function a(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,a),i.l=!0,i.exports}return a.m=e,a.c=t,a.i=function(e){return e},a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="",a(a.s=3)}([function(e,t,a){"use strict";var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i=a(2),s=a(1),r=a(4);function o(e){this.options=s({},i,e)}o.prototype.run=function(){var e=this.options,t=e.cy,a=e.eles,i=function(e,t){return"function"==typeof t?t.apply(e,[e]):t},s=e.boundingBox||{x1:0,y1:0,w:t.width(),h:t.height()};void 0===s.x2&&(s.x2=s.x1+s.w),void 0===s.w&&(s.w=s.x2-s.x1),void 0===s.y2&&(s.y2=s.y1+s.h),void 0===s.h&&(s.h=s.y2-s.y1);var o=new r.graphlib.Graph({multigraph:!0,compound:!0}),l={},c=function(e,t){null!=t&&(l[e]=t)};c("nodesep",e.nodeSep),c("edgesep",e.edgeSep),c("ranksep",e.rankSep),c("rankdir",e.rankDir),c("ranker",e.ranker),o.setGraph(l),o.setDefaultEdgeLabel((function(){return{}})),o.setDefaultNodeLabel((function(){return{}}));for(var d=a.nodes(),u=0;u<d.length;u++){var p=d[u],m=p.layoutDimensions(e);o.setNode(p.id(),{width:m.w,height:m.h,name:p.id()})}for(var b=0;b<d.length;b++){var f=d[b];f.isChild()&&o.setParent(f.id(),f.parent().id())}for(var h=a.edges().stdFilter((function(e){return!e.source().isParent()&&!e.target().isParent()})),g=0;g<h.length;g++){var j=h[g];o.setEdge(j.source().id(),j.target().id(),{minlen:i(j,e.minLen),weight:i(j,e.edgeWeight),name:j.id()},j.id())}r.layout(o);for(var x=o.nodes(),v=0;v<x.length;v++){var y=x[v],O=o.node(y);t.getElementById(y).scratch().dagre=O}var E=void 0;return e.boundingBox?(E={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},d.forEach((function(e){var t=e.scratch().dagre;E.x1=Math.min(E.x1,t.x),E.x2=Math.max(E.x2,t.x),E.y1=Math.min(E.y1,t.y),E.y2=Math.max(E.y2,t.y)})),E.w=E.x2-E.x1,E.h=E.y2-E.y1):E=s,d.layoutPositions(this,e,(function(t){var a=(t="object"===(void 0===t?"undefined":n(t))?t:this).scratch().dagre;return function(t){if(e.boundingBox){var a=0===E.w?0:(t.x-E.x1)/E.w,n=0===E.h?0:(t.y-E.y1)/E.h;return{x:s.x1+a*s.w,y:s.y1+n*s.h}}return t}({x:a.x,y:a.y})})),this},e.exports=o},function(e,t,a){"use strict";e.exports=null!=Object.assign?Object.assign.bind(Object):function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return a.forEach((function(t){Object.keys(t).forEach((function(a){return e[a]=t[a]}))})),e}},function(e,t,a){"use strict";var n={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,ranker:void 0,minLen:function(e){return 1},edgeWeight:function(e){return 1},fit:!0,padding:30,spacingFactor:void 0,nodeDimensionsIncludeLabels:!1,animate:!1,animateFilter:function(e,t){return!0},animationDuration:500,animationEasing:void 0,boundingBox:void 0,transform:function(e,t){return t},ready:function(){},stop:function(){}};e.exports=n},function(e,t,a){"use strict";var n=a(0),i=function(e){e&&e("layout","dagre",n)};"undefined"!=typeof cytoscape&&i(cytoscape),e.exports=i},function(t,a){t.exports=e}])},e.exports=n(a(482))},function(e,t,a){e.exports={graphlib:a(121),layout:a(538),debug:a(604),util:{time:a(108).time,notime:a(108).notime},version:a(605)}},function(e,t,a){var n=a(484);e.exports={Graph:n.Graph,json:a(528),alg:a(529),version:n.version}},function(e,t,a){e.exports={Graph:a(234),version:a(527)}},function(e,t,a){var n=a(313);e.exports=function(e){return n(e,4)}},function(e,t){e.exports=function(e){return function(t,a,n){for(var i=-1,s=Object(t),r=n(t),o=r.length;o--;){var l=r[e?o:++i];if(!1===a(s[l],l,s))break}return t}}},function(e,t,a){var n=a(158);e.exports=function(e,t){return function(a,i){if(null==a)return a;if(!n(a))return e(a,i);for(var s=a.length,r=t?s:-1,o=Object(a);(t?r--:++r<s)&&!1!==i(o[r],r,o););return a}}},function(e,t,a){e.exports=a(23)(3053)},function(e,t,a){var n=a(200);e.exports=function(e,t){var a=[];return n(e,(function(e,n,i){t(e,n,i)&&a.push(e)})),a}},function(e,t,a){var n=a(491),i=a(492),s=a(323);e.exports=function(e){var t=i(e);return 1==t.length&&t[0][2]?s(t[0][0],t[0][1]):function(a){return a===e||n(a,e,t)}}},function(e,t,a){var n=a(320),i=a(321);e.exports=function(e,t,a,s){var r=a.length,o=r,l=!s;if(null==e)return!o;for(e=Object(e);r--;){var c=a[r];if(l&&c[2]?c[1]!==e[c[0]]:!(c[0]in e))return!1}for(;++r<o;){var d=(c=a[r])[0],u=e[d],p=c[1];if(l&&c[2]){if(void 0===u&&!(d in e))return!1}else{var m=new n;if(s)var b=s(u,p,d,e,t,m);if(!(void 0===b?i(p,u,3,s,m):b))return!1}}return!0}},function(e,t,a){var n=a(322),i=a(172);e.exports=function(e){for(var t=i(e),a=t.length;a--;){var s=t[a],r=e[s];t[a]=[s,r,n(r)]}return t}},function(e,t,a){var n=a(321),i=a(494),s=a(324),r=a(327),o=a(322),l=a(323),c=a(201);e.exports=function(e,t){return r(e)&&o(t)?l(c(e),t):function(a){var r=i(a,e);return void 0===r&&r===t?s(a,e):n(t,r,3)}}},function(e,t,a){e.exports=a(23)(988)},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,a){e.exports=a(23)(1293)},function(e,t,a){var n=a(328),i=a(498),s=a(327),r=a(201);e.exports=function(e){return s(e)?n(r(e)):i(e)}},function(e,t,a){var n=a(239);e.exports=function(e){return function(t){return n(t,e)}}},function(e,t){var a=Object.prototype.hasOwnProperty;e.exports=function(e,t){return null!=e&&a.call(e,t)}},function(e,t,a){var n=a(330),i=a(331),s=a(238),r=a(122),o=a(158),l=a(240),c=a(501),d=a(241),u=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(o(e)&&(r(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||d(e)||s(e)))return!e.length;var t=i(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(c(e))return!n(e).length;for(var a in e)if(u.call(e,a))return!1;return!0}},function(e,t,a){e.exports=a(23)(937)},function(e,t){e.exports=function(e,t,a,n){var i=-1,s=null==e?0:e.length;for(n&&s&&(a=e[++i]);++i<s;)a=t(a,e[i],i,e);return a}},function(e,t){e.exports=function(e,t,a,n,i){return i(e,(function(e,i,s){a=n?(n=!1,e):t(a,e,i,s)})),a}},function(e,t,a){var n=a(330),i=a(331),s=a(158),r=a(505),o=a(506);e.exports=function(e){if(null==e)return 0;if(s(e))return r(e)?o(e):e.length;var t=i(e);return"[object Map]"==t||"[object Set]"==t?e.size:n(e).length}},function(e,t,a){e.exports=a(23)(972)},function(e,t,a){var n=a(507),i=a(508),s=a(509);e.exports=function(e){return i(e)?s(e):n(e)}},function(e,t,a){var n=a(328)("length");e.exports=n},function(e,t){var a=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");e.exports=function(e){return a.test(e)}},function(e,t){var a="[\\ud800-\\udfff]",n="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",i="\\ud83c[\\udffb-\\udfff]",s="[^\\ud800-\\udfff]",r="(?:\\ud83c[\\udde6-\\uddff]){2}",o="[\\ud800-\\udbff][\\udc00-\\udfff]",l="(?:"+n+"|"+i+")"+"?",c="[\\ufe0e\\ufe0f]?",d=c+l+("(?:\\u200d(?:"+[s,r,o].join("|")+")"+c+l+")*"),u="(?:"+[s+n+"?",n,r,o,a].join("|")+")",p=RegExp(i+"(?="+i+")|"+u+d,"g");e.exports=function(e){for(var t=p.lastIndex=0;p.test(e);)++t;return t}},function(e,t,a){var n=a(317),i=a(511),s=a(235),r=a(134),o=a(512),l=a(122),c=a(240),d=a(242),u=a(173),p=a(241);e.exports=function(e,t,a){var m=l(e),b=m||c(e)||p(e);if(t=r(t,4),null==a){var f=e&&e.constructor;a=b?m?new f:[]:u(e)&&d(f)?i(o(e)):{}}return(b?n:s)(e,(function(e,n,i){return t(a,e,n,i)})),a}},function(e,t,a){e.exports=a(23)(3066)},function(e,t,a){e.exports=a(23)(941)},function(e,t,a){var n=a(336),i=a(244),s=a(514),r=a(339),o=i((function(e){return s(n(e,1,r,!0))}));e.exports=o},function(e,t,a){var n=a(515),i=a(516),s=a(520),r=a(521),o=a(522),l=a(338);e.exports=function(e,t,a){var c=-1,d=i,u=e.length,p=!0,m=[],b=m;if(a)p=!1,d=s;else if(u>=200){var f=t?null:o(e);if(f)return l(f);p=!1,d=r,b=new n}else b=t?[]:m;e:for(;++c<u;){var h=e[c],g=t?t(h):h;if(h=a||0!==h?h:0,p&&g==g){for(var j=b.length;j--;)if(b[j]===g)continue e;t&&b.push(g),m.push(h)}else d(b,g,a)||(b!==m&&b.push(g),m.push(h))}return m}},function(e,t,a){e.exports=a(23)(3088)},function(e,t,a){var n=a(517);e.exports=function(e,t){return!!(null==e?0:e.length)&&n(e,t,0)>-1}},function(e,t,a){var n=a(337),i=a(518),s=a(519);e.exports=function(e,t,a){return t==t?s(e,t,a):n(e,i,a)}},function(e,t){e.exports=function(e){return e!=e}},function(e,t){e.exports=function(e,t,a){for(var n=a-1,i=e.length;++n<i;)if(e[n]===t)return n;return-1}},function(e,t){e.exports=function(e,t,a){for(var n=-1,i=null==e?0:e.length;++n<i;)if(a(t,e[n]))return!0;return!1}},function(e,t,a){e.exports=a(23)(3092)},function(e,t,a){var n=a(523),i=a(524),s=a(338),r=n&&1/s(new n([,-0]))[1]==1/0?function(e){return new n(e)}:i;e.exports=r},function(e,t,a){e.exports=a(23)(3057)},function(e,t){e.exports=function(){}},function(e,t,a){e.exports=a(23)(223)},function(e,t,a){var n=a(243);e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},function(e,t){e.exports="2.1.8"},function(e,t,a){var n=a(118),i=a(234);function s(e){return n.map(e.nodes(),(function(t){var a=e.node(t),i=e.parent(t),s={v:t};return n.isUndefined(a)||(s.value=a),n.isUndefined(i)||(s.parent=i),s}))}function r(e){return n.map(e.edges(),(function(t){var a=e.edge(t),i={v:t.v,w:t.w};return n.isUndefined(t.name)||(i.name=t.name),n.isUndefined(a)||(i.value=a),i}))}e.exports={write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:s(e),edges:r(e)};n.isUndefined(e.graph())||(t.value=n.clone(e.graph()));return t},read:function(e){var t=new i(e.options).setGraph(e.value);return n.each(e.nodes,(function(e){t.setNode(e.v,e.value),e.parent&&t.setParent(e.v,e.parent)})),n.each(e.edges,(function(e){t.setEdge({v:e.v,w:e.w,name:e.name},e.value)})),t}}},function(e,t,a){e.exports={components:a(530),dijkstra:a(341),dijkstraAll:a(531),findCycles:a(532),floydWarshall:a(533),isAcyclic:a(534),postorder:a(535),preorder:a(536),prim:a(537),tarjan:a(343),topsort:a(344)}},function(e,t,a){var n=a(118);e.exports=function(e){var t,a={},i=[];function s(i){n.has(a,i)||(a[i]=!0,t.push(i),n.each(e.successors(i),s),n.each(e.predecessors(i),s))}return n.each(e.nodes(),(function(e){t=[],s(e),t.length&&i.push(t)})),i}},function(e,t,a){var n=a(341),i=a(118);e.exports=function(e,t,a){return i.transform(e.nodes(),(function(i,s){i[s]=n(e,s,t,a)}),{})}},function(e,t,a){var n=a(118),i=a(343);e.exports=function(e){return n.filter(i(e),(function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))}},function(e,t,a){var n=a(118);e.exports=function(e,t,a){return function(e,t,a){var n={},i=e.nodes();return i.forEach((function(e){n[e]={},n[e][e]={distance:0},i.forEach((function(t){e!==t&&(n[e][t]={distance:Number.POSITIVE_INFINITY})})),a(e).forEach((function(a){var i=a.v===e?a.w:a.v,s=t(a);n[e][i]={distance:s,predecessor:e}}))})),i.forEach((function(e){var t=n[e];i.forEach((function(a){var s=n[a];i.forEach((function(a){var n=s[e],i=t[a],r=s[a],o=n.distance+i.distance;o<r.distance&&(r.distance=o,r.predecessor=i.predecessor)}))}))})),n}(e,t||i,a||function(t){return e.outEdges(t)})};var i=n.constant(1)},function(e,t,a){var n=a(344);e.exports=function(e){try{n(e)}catch(e){if(e instanceof n.CycleException)return!1;throw e}return!0}},function(e,t,a){var n=a(345);e.exports=function(e,t){return n(e,t,"post")}},function(e,t,a){var n=a(345);e.exports=function(e,t){return n(e,t,"pre")}},function(e,t,a){var n=a(118),i=a(234),s=a(342);e.exports=function(e,t){var a,r=new i,o={},l=new s;function c(e){var n=e.v===a?e.w:e.v,i=l.priority(n);if(void 0!==i){var s=t(e);s<i&&(o[n]=a,l.decrease(n,s))}}if(0===e.nodeCount())return r;n.each(e.nodes(),(function(e){l.add(e,Number.POSITIVE_INFINITY),r.setNode(e)})),l.decrease(e.nodes()[0],0);var d=!1;for(;l.size()>0;){if(a=l.removeMin(),n.has(o,a))r.setEdge(a,o[a]);else{if(d)throw new Error("Input graph is not connected: "+e);d=!0}e.nodeEdges(a).forEach(c)}return r}},function(e,t,a){"use strict";var n=a(88),i=a(583),s=a(586),r=a(587),o=a(108).normalizeRanks,l=a(589),c=a(108).removeEmptyRanks,d=a(590),u=a(591),p=a(592),m=a(593),b=a(602),f=a(108),h=a(121).Graph;e.exports=function(e,t){var a=t&&t.debugTiming?f.time:f.notime;a("layout",(function(){var t=a("  buildLayoutGraph",(function(){return function(e){var t=new h({multigraph:!0,compound:!0}),a=S(e.graph());return t.setGraph(n.merge({},j,M(a,g),n.pick(a,x))),n.forEach(e.nodes(),(function(a){var i=S(e.node(a));t.setNode(a,n.defaults(M(i,v),y)),t.setParent(a,e.parent(a))})),n.forEach(e.edges(),(function(a){var i=S(e.edge(a));t.setEdge(a,n.merge({},E,M(i,O),n.pick(i,w)))})),t}(e)}));a("  runLayout",(function(){!function(e,t){t("    makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();t.ranksep/=2,n.forEach(e.edges(),(function(a){var n=e.edge(a);n.minlen*=2,"c"!==n.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?n.width+=n.labeloffset:n.height+=n.labeloffset)}))}(e)})),t("    removeSelfEdges",(function(){!function(e){n.forEach(e.edges(),(function(t){if(t.v===t.w){var a=e.node(t.v);a.selfEdges||(a.selfEdges=[]),a.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}))}(e)})),t("    acyclic",(function(){i.run(e)})),t("    nestingGraph.run",(function(){d.run(e)})),t("    rank",(function(){r(f.asNonCompoundGraph(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){n.forEach(e.edges(),(function(t){var a=e.edge(t);if(a.width&&a.height){var n=e.node(t.v),i={rank:(e.node(t.w).rank-n.rank)/2+n.rank,e:t};f.addDummyNode(e,"edge-proxy",i,"_ep")}}))}(e)})),t("    removeEmptyRanks",(function(){c(e)})),t("    nestingGraph.cleanup",(function(){d.cleanup(e)})),t("    normalizeRanks",(function(){o(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;n.forEach(e.nodes(),(function(a){var i=e.node(a);i.borderTop&&(i.minRank=e.node(i.borderTop).rank,i.maxRank=e.node(i.borderBottom).rank,t=n.max(t,i.maxRank))})),e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){n.forEach(e.nodes(),(function(t){var a=e.node(t);"edge-proxy"===a.dummy&&(e.edge(a.e).labelRank=a.rank,e.removeNode(t))}))}(e)})),t("    normalize.run",(function(){s.run(e)})),t("    parentDummyChains",(function(){l(e)})),t("    addBorderSegments",(function(){u(e)})),t("    order",(function(){m(e)})),t("    insertSelfEdges",(function(){!function(e){var t=f.buildLayerMatrix(e);n.forEach(t,(function(t){var a=0;n.forEach(t,(function(t,i){var s=e.node(t);s.order=i+a,n.forEach(s.selfEdges,(function(t){f.addDummyNode(e,"selfedge",{width:t.label.width,height:t.label.height,rank:s.rank,order:i+ ++a,e:t.e,label:t.label},"_se")})),delete s.selfEdges}))}))}(e)})),t("    adjustCoordinateSystem",(function(){p.adjust(e)})),t("    position",(function(){b(e)})),t("    positionSelfEdges",(function(){!function(e){n.forEach(e.nodes(),(function(t){var a=e.node(t);if("selfedge"===a.dummy){var n=e.node(a.e.v),i=n.x+n.width/2,s=n.y,r=a.x-i,o=n.height/2;e.setEdge(a.e,a.label),e.removeNode(t),a.label.points=[{x:i+2*r/3,y:s-o},{x:i+5*r/6,y:s-o},{x:i+r,y:s},{x:i+5*r/6,y:s+o},{x:i+2*r/3,y:s+o}],a.label.x=a.x,a.label.y=a.y}}))}(e)})),t("    removeBorderNodes",(function(){!function(e){n.forEach(e.nodes(),(function(t){if(e.children(t).length){var a=e.node(t),i=e.node(a.borderTop),s=e.node(a.borderBottom),r=e.node(n.last(a.borderLeft)),o=e.node(n.last(a.borderRight));a.width=Math.abs(o.x-r.x),a.height=Math.abs(s.y-i.y),a.x=r.x+a.width/2,a.y=i.y+a.height/2}})),n.forEach(e.nodes(),(function(t){"border"===e.node(t).dummy&&e.removeNode(t)}))}(e)})),t("    normalize.undo",(function(){s.undo(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){n.forEach(e.edges(),(function(t){var a=e.edge(t);if(n.has(a,"x"))switch("l"!==a.labelpos&&"r"!==a.labelpos||(a.width-=a.labeloffset),a.labelpos){case"l":a.x-=a.width/2+a.labeloffset;break;case"r":a.x+=a.width/2+a.labeloffset}}))}(e)})),t("    undoCoordinateSystem",(function(){p.undo(e)})),t("    translateGraph",(function(){!function(e){var t=Number.POSITIVE_INFINITY,a=0,i=Number.POSITIVE_INFINITY,s=0,r=e.graph(),o=r.marginx||0,l=r.marginy||0;function c(e){var n=e.x,r=e.y,o=e.width,l=e.height;t=Math.min(t,n-o/2),a=Math.max(a,n+o/2),i=Math.min(i,r-l/2),s=Math.max(s,r+l/2)}n.forEach(e.nodes(),(function(t){c(e.node(t))})),n.forEach(e.edges(),(function(t){var a=e.edge(t);n.has(a,"x")&&c(a)})),t-=o,i-=l,n.forEach(e.nodes(),(function(a){var n=e.node(a);n.x-=t,n.y-=i})),n.forEach(e.edges(),(function(a){var s=e.edge(a);n.forEach(s.points,(function(e){e.x-=t,e.y-=i})),n.has(s,"x")&&(s.x-=t),n.has(s,"y")&&(s.y-=i)})),r.width=a-t+o,r.height=s-i+l}(e)})),t("    assignNodeIntersects",(function(){!function(e){n.forEach(e.edges(),(function(t){var a,n,i=e.edge(t),s=e.node(t.v),r=e.node(t.w);i.points?(a=i.points[0],n=i.points[i.points.length-1]):(i.points=[],a=r,n=s),i.points.unshift(f.intersectRect(s,a)),i.points.push(f.intersectRect(r,n))}))}(e)})),t("    reversePoints",(function(){!function(e){n.forEach(e.edges(),(function(t){var a=e.edge(t);a.reversed&&a.points.reverse()}))}(e)})),t("    acyclic.undo",(function(){i.undo(e)}))}(t,a)})),a("  updateInputGraph",(function(){!function(e,t){n.forEach(e.nodes(),(function(a){var n=e.node(a),i=t.node(a);n&&(n.x=i.x,n.y=i.y,t.children(a).length&&(n.width=i.width,n.height=i.height))})),n.forEach(e.edges(),(function(a){var i=e.edge(a),s=t.edge(a);i.points=s.points,n.has(s,"x")&&(i.x=s.x,i.y=s.y)})),e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)}))}))};var g=["nodesep","edgesep","ranksep","marginx","marginy"],j={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},x=["acyclicer","ranker","rankdir","align"],v=["width","height"],y={width:0,height:0},O=["minlen","weight","width","height","labeloffset"],E={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},w=["labelpos"];function M(e,t){return n.mapValues(n.pick(e,t),Number)}function S(e){var t={};return n.forEach(e,(function(e,a){t[a.toLowerCase()]=e})),t}},function(e,t,a){var n=a(313);e.exports=function(e){return n(e,5)}},function(e,t,a){e.exports=a(23)(1637)},function(e,t,a){var n=a(542)(a(543));e.exports=n},function(e,t,a){var n=a(134),i=a(158),s=a(172);e.exports=function(e){return function(t,a,r){var o=Object(t);if(!i(t)){var l=n(a,3);t=s(t),a=function(e){return l(o[e],e,o)}}var c=e(t,a,r);return c>-1?o[l?t[c]:c]:void 0}}},function(e,t,a){var n=a(337),i=a(134),s=a(544),r=Math.max;e.exports=function(e,t,a){var o=null==e?0:e.length;if(!o)return-1;var l=null==a?0:s(a);return l<0&&(l=r(o+l,0)),n(e,i(t,3),l)}},function(e,t,a){e.exports=a(23)(3001)},function(e,t,a){e.exports=a(23)(3078)},function(e,t,a){var n=a(236),i=a(318),s=a(245);e.exports=function(e,t){return null==e?e:n(e,i(t),s)}},function(e,t,a){e.exports=a(23)(3072)},function(e,t,a){var n=a(346),i=a(235),s=a(134);e.exports=function(e,t){var a={};return t=s(t,3),i(e,(function(e,i,s){n(a,i,t(e,i,s))})),a}},function(e,t,a){var n=a(246),i=a(550),s=a(202);e.exports=function(e){return e&&e.length?n(e,s,i):void 0}},function(e,t){e.exports=function(e,t){return e>t}},function(e,t,a){var n=a(552),i=a(562)((function(e,t,a){n(e,t,a)}));e.exports=i},function(e,t,a){var n=a(320),i=a(348),s=a(236),r=a(554),o=a(173),l=a(245),c=a(349);e.exports=function e(t,a,d,u,p){t!==a&&s(a,(function(s,l){if(p||(p=new n),o(s))r(t,a,l,d,e,u,p);else{var m=u?u(c(t,l),s,l+"",t,a,p):void 0;void 0===m&&(m=s),i(t,l,m)}}),l)}},function(e,t,a){e.exports=a(23)(547)},function(e,t,a){var n=a(348),i=a(555),s=a(556),r=a(557),o=a(558),l=a(238),c=a(122),d=a(339),u=a(240),p=a(242),m=a(173),b=a(559),f=a(241),h=a(349),g=a(560);e.exports=function(e,t,a,j,x,v,y){var O=h(e,a),E=h(t,a),w=y.get(E);if(w)n(e,a,w);else{var M=v?v(O,E,a+"",e,t,y):void 0,S=void 0===M;if(S){var _=c(E),T=!_&&u(E),C=!_&&!T&&f(E);M=E,_||T||C?c(O)?M=O:d(O)?M=r(O):T?(S=!1,M=i(E,!0)):C?(S=!1,M=s(E,!0)):M=[]:b(E)||l(E)?(M=O,l(O)?M=g(O):m(O)&&!p(O)||(M=o(E))):S=!1}S&&(y.set(E,M),x(M,E,j,v,y),y.delete(E)),n(e,a,M)}}},function(e,t,a){e.exports=a(23)(3050)},function(e,t,a){e.exports=a(23)(3064)},function(e,t,a){e.exports=a(23)(3051)},function(e,t,a){e.exports=a(23)(3065)},function(e,t,a){e.exports=a(23)(3076)},function(e,t,a){var n=a(561),i=a(245);e.exports=function(e){return n(e,i(e))}},function(e,t,a){e.exports=a(23)(548)},function(e,t,a){var n=a(244),i=a(350);e.exports=function(e){return n((function(t,a){var n=-1,s=a.length,r=s>1?a[s-1]:void 0,o=s>2?a[2]:void 0;for(r=e.length>3&&"function"==typeof r?(s--,r):void 0,o&&i(a[0],a[1],o)&&(r=s<3?void 0:r,s=1),t=Object(t);++n<s;){var l=a[n];l&&e(t,l,n,r)}return t}))}},function(e,t,a){var n=a(246),i=a(351),s=a(202);e.exports=function(e){return e&&e.length?n(e,s,i):void 0}},function(e,t,a){var n=a(246),i=a(134),s=a(351);e.exports=function(e,t){return e&&e.length?n(e,i(t,2),s):void 0}},function(e,t,a){var n=a(566);e.exports=function(){return n.Date.now()}},function(e,t,a){e.exports=a(23)(245)},function(e,t,a){var n=a(568),i=a(571)((function(e,t){return null==e?{}:n(e,t)}));e.exports=i},function(e,t,a){var n=a(569),i=a(324);e.exports=function(e,t){return n(e,t,(function(t,a){return i(e,a)}))}},function(e,t,a){var n=a(239),i=a(570),s=a(237);e.exports=function(e,t,a){for(var r=-1,o=t.length,l={};++r<o;){var c=t[r],d=n(e,c);a(d,c)&&i(l,s(c,e),d)}return l}},function(e,t,a){var n=a(352),i=a(237),s=a(326),r=a(173),o=a(201);e.exports=function(e,t,a,l){if(!r(e))return e;for(var c=-1,d=(t=i(t,e)).length,u=d-1,p=e;null!=p&&++c<d;){var m=o(t[c]),b=a;if("__proto__"===m||"constructor"===m||"prototype"===m)return e;if(c!=u){var f=p[m];void 0===(b=l?l(f,m,p):void 0)&&(b=r(f)?f:s(t[c+1])?[]:{})}n(p,m,b),p=p[m]}return e}},function(e,t,a){e.exports=a(23)(3077)},function(e,t,a){e.exports=a(23)(1626)},function(e,t,a){var n=a(336),i=a(574),s=a(244),r=a(350),o=s((function(e,t){if(null==e)return[];var a=t.length;return a>1&&r(e,t[0],t[1])?t=[]:a>2&&r(t[0],t[1],t[2])&&(t=[t[0]]),i(e,n(t,1),[])}));e.exports=o},function(e,t,a){var n=a(243),i=a(239),s=a(134),r=a(334),o=a(575),l=a(576),c=a(577),d=a(202),u=a(122);e.exports=function(e,t,a){t=t.length?n(t,(function(e){return u(e)?function(t){return i(t,1===e.length?e[0]:e)}:e})):[d];var p=-1;t=n(t,l(s));var m=r(e,(function(e,a,i){return{criteria:n(t,(function(t){return t(e)})),index:++p,value:e}}));return o(m,(function(e,t){return c(e,t,a)}))}},function(e,t){e.exports=function(e,t){var a=e.length;for(e.sort(t);a--;)e[a]=e[a].value;return e}},function(e,t,a){e.exports=a(23)(935)},function(e,t,a){var n=a(578);e.exports=function(e,t,a){for(var i=-1,s=e.criteria,r=t.criteria,o=s.length,l=a.length;++i<o;){var c=n(s[i],r[i]);if(c)return i>=l?c:c*("desc"==a[i]?-1:1)}return e.index-t.index}},function(e,t,a){var n=a(347);e.exports=function(e,t){if(e!==t){var a=void 0!==e,i=null===e,s=e==e,r=n(e),o=void 0!==t,l=null===t,c=t==t,d=n(t);if(!l&&!d&&!r&&e>t||r&&o&&c&&!l&&!d||i&&o&&c||!a&&c||!s)return 1;if(!i&&!r&&!d&&e<t||d&&a&&s&&!i&&!r||l&&a&&s||!o&&s||!c)return-1}return 0}},function(e,t,a){var n=a(580),i=0;e.exports=function(e){var t=++i;return n(e)+t}},function(e,t,a){e.exports=a(23)(3032)},function(e,t,a){var n=a(352),i=a(582);e.exports=function(e,t){return i(e||[],t||[],n)}},function(e,t){e.exports=function(e,t,a){for(var n=-1,i=e.length,s=t.length,r={};++n<i;){var o=n<s?t[n]:void 0;a(r,e[n],o)}return r}},function(e,t,a){"use strict";var n=a(88),i=a(584);e.exports={run:function(e){var t="greedy"===e.graph().acyclicer?i(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],a={},i={};function s(r){n.has(i,r)||(i[r]=!0,a[r]=!0,n.forEach(e.outEdges(r),(function(e){n.has(a,e.w)?t.push(e):s(e.w)})),delete a[r])}return n.forEach(e.nodes(),s),t}(e);n.forEach(t,(function(t){var a=e.edge(t);e.removeEdge(t),a.forwardName=t.name,a.reversed=!0,e.setEdge(t.w,t.v,a,n.uniqueId("rev"))}))},undo:function(e){n.forEach(e.edges(),(function(t){var a=e.edge(t);if(a.reversed){e.removeEdge(t);var n=a.forwardName;delete a.reversed,delete a.forwardName,e.setEdge(t.w,t.v,a,n)}}))}}},function(e,t,a){var n=a(88),i=a(121).Graph,s=a(585);e.exports=function(e,t){if(e.nodeCount()<=1)return[];var a=function(e,t){var a=new i,r=0,o=0;n.forEach(e.nodes(),(function(e){a.setNode(e,{v:e,in:0,out:0})})),n.forEach(e.edges(),(function(e){var n=a.edge(e.v,e.w)||0,i=t(e),s=n+i;a.setEdge(e.v,e.w,s),o=Math.max(o,a.node(e.v).out+=i),r=Math.max(r,a.node(e.w).in+=i)}));var c=n.range(o+r+3).map((function(){return new s})),d=r+1;return n.forEach(a.nodes(),(function(e){l(c,d,a.node(e))})),{graph:a,buckets:c,zeroIdx:d}}(e,t||r),c=function(e,t,a){var n,i=[],s=t[t.length-1],r=t[0];for(;e.nodeCount();){for(;n=r.dequeue();)o(e,t,a,n);for(;n=s.dequeue();)o(e,t,a,n);if(e.nodeCount())for(var l=t.length-2;l>0;--l)if(n=t[l].dequeue()){i=i.concat(o(e,t,a,n,!0));break}}return i}(a.graph,a.buckets,a.zeroIdx);return n.flatten(n.map(c,(function(t){return e.outEdges(t.v,t.w)})),!0)};var r=n.constant(1);function o(e,t,a,i,s){var r=s?[]:void 0;return n.forEach(e.inEdges(i.v),(function(n){var i=e.edge(n),o=e.node(n.v);s&&r.push({v:n.v,w:n.w}),o.out-=i,l(t,a,o)})),n.forEach(e.outEdges(i.v),(function(n){var i=e.edge(n),s=n.w,r=e.node(s);r.in-=i,l(t,a,r)})),e.removeNode(i.v),r}function l(e,t,a){a.out?a.in?e[a.out-a.in+t].enqueue(a):e[e.length-1].enqueue(a):e[0].enqueue(a)}},function(e,t){function a(){var e={};e._next=e._prev=e,this._sentinel=e}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function i(e,t){if("_next"!==e&&"_prev"!==e)return t}e.exports=a,a.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t},a.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&n(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t},a.prototype.toString=function(){for(var e=[],t=this._sentinel,a=t._prev;a!==t;)e.push(JSON.stringify(a,i)),a=a._prev;return"["+e.join(", ")+"]"}},function(e,t,a){"use strict";var n=a(88),i=a(108);e.exports={run:function(e){e.graph().dummyChains=[],n.forEach(e.edges(),(function(t){!function(e,t){var a,n,s,r=t.v,o=e.node(r).rank,l=t.w,c=e.node(l).rank,d=t.name,u=e.edge(t),p=u.labelRank;if(c===o+1)return;for(e.removeEdge(t),s=0,++o;o<c;++s,++o)u.points=[],n={width:0,height:0,edgeLabel:u,edgeObj:t,rank:o},a=i.addDummyNode(e,"edge",n,"_d"),o===p&&(n.width=u.width,n.height=u.height,n.dummy="edge-label",n.labelpos=u.labelpos),e.setEdge(r,a,{weight:u.weight},d),0===s&&e.graph().dummyChains.push(a),r=a;e.setEdge(r,l,{weight:u.weight},d)}(e,t)}))},undo:function(e){n.forEach(e.graph().dummyChains,(function(t){var a,n=e.node(t),i=n.edgeLabel;for(e.setEdge(n.edgeObj,i);n.dummy;)a=e.successors(t)[0],e.removeNode(t),i.points.push({x:n.x,y:n.y}),"edge-label"===n.dummy&&(i.x=n.x,i.y=n.y,i.width=n.width,i.height=n.height),t=a,n=e.node(t)}))}}},function(e,t,a){"use strict";var n=a(203).longestPath,i=a(353),s=a(588);e.exports=function(e){switch(e.graph().ranker){case"network-simplex":o(e);break;case"tight-tree":!function(e){n(e),i(e)}(e);break;case"longest-path":r(e);break;default:o(e)}};var r=n;function o(e){s(e)}},function(e,t,a){"use strict";var n=a(88),i=a(353),s=a(203).slack,r=a(203).longestPath,o=a(121).alg.preorder,l=a(121).alg.postorder,c=a(108).simplify;function d(e){e=c(e),r(e);var t,a=i(e);for(m(a),u(a,e);t=f(a);)g(a,e,t,h(a,e,t))}function u(e,t){var a=l(e,e.nodes());a=a.slice(0,a.length-1),n.forEach(a,(function(a){!function(e,t,a){var n=e.node(a).parent;e.edge(a,n).cutvalue=p(e,t,a)}(e,t,a)}))}function p(e,t,a){var i=e.node(a).parent,s=!0,r=t.edge(a,i),o=0;return r||(s=!1,r=t.edge(i,a)),o=r.weight,n.forEach(t.nodeEdges(a),(function(n){var r,l,c=n.v===a,d=c?n.w:n.v;if(d!==i){var u=c===s,p=t.edge(n).weight;if(o+=u?p:-p,r=a,l=d,e.hasEdge(r,l)){var m=e.edge(a,d).cutvalue;o+=u?-m:m}}})),o}function m(e,t){arguments.length<2&&(t=e.nodes()[0]),b(e,{},1,t)}function b(e,t,a,i,s){var r=a,o=e.node(i);return t[i]=!0,n.forEach(e.neighbors(i),(function(s){n.has(t,s)||(a=b(e,t,a,s,i))})),o.low=r,o.lim=a++,s?o.parent=s:delete o.parent,a}function f(e){return n.find(e.edges(),(function(t){return e.edge(t).cutvalue<0}))}function h(e,t,a){var i=a.v,r=a.w;t.hasEdge(i,r)||(i=a.w,r=a.v);var o=e.node(i),l=e.node(r),c=o,d=!1;o.lim>l.lim&&(c=l,d=!0);var u=n.filter(t.edges(),(function(t){return d===j(e,e.node(t.v),c)&&d!==j(e,e.node(t.w),c)}));return n.minBy(u,(function(e){return s(t,e)}))}function g(e,t,a,i){var s=a.v,r=a.w;e.removeEdge(s,r),e.setEdge(i.v,i.w,{}),m(e),u(e,t),function(e,t){var a=n.find(e.nodes(),(function(e){return!t.node(e).parent})),i=o(e,a);i=i.slice(1),n.forEach(i,(function(a){var n=e.node(a).parent,i=t.edge(a,n),s=!1;i||(i=t.edge(n,a),s=!0),t.node(a).rank=t.node(n).rank+(s?i.minlen:-i.minlen)}))}(e,t)}function j(e,t,a){return a.low<=t.lim&&t.lim<=a.lim}e.exports=d,d.initLowLimValues=m,d.initCutValues=u,d.calcCutValue=p,d.leaveEdge=f,d.enterEdge=h,d.exchangeEdges=g},function(e,t,a){var n=a(88);e.exports=function(e){var t=function(e){var t={},a=0;function i(s){var r=a;n.forEach(e.children(s),i),t[s]={low:r,lim:a++}}return n.forEach(e.children(),i),t}(e);n.forEach(e.graph().dummyChains,(function(a){for(var n=e.node(a),i=n.edgeObj,s=function(e,t,a,n){var i,s,r=[],o=[],l=Math.min(t[a].low,t[n].low),c=Math.max(t[a].lim,t[n].lim);i=a;do{i=e.parent(i),r.push(i)}while(i&&(t[i].low>l||c>t[i].lim));s=i,i=n;for(;(i=e.parent(i))!==s;)o.push(i);return{path:r.concat(o.reverse()),lca:s}}(e,t,i.v,i.w),r=s.path,o=s.lca,l=0,c=r[l],d=!0;a!==i.w;){if(n=e.node(a),d){for(;(c=r[l])!==o&&e.node(c).maxRank<n.rank;)l++;c===o&&(d=!1)}if(!d){for(;l<r.length-1&&e.node(c=r[l+1]).minRank<=n.rank;)l++;c=r[l]}e.setParent(a,c),a=e.successors(a)[0]}}))}},function(e,t,a){var n=a(88),i=a(108);function s(e,t,a,r,o,l,c){var d=e.children(c);if(d.length){var u=i.addBorderNode(e,"_bt"),p=i.addBorderNode(e,"_bb"),m=e.node(c);e.setParent(u,c),m.borderTop=u,e.setParent(p,c),m.borderBottom=p,n.forEach(d,(function(n){s(e,t,a,r,o,l,n);var i=e.node(n),d=i.borderTop?i.borderTop:n,m=i.borderBottom?i.borderBottom:n,b=i.borderTop?r:2*r,f=d!==m?1:o-l[c]+1;e.setEdge(u,d,{weight:b,minlen:f,nestingEdge:!0}),e.setEdge(m,p,{weight:b,minlen:f,nestingEdge:!0})})),e.parent(c)||e.setEdge(t,u,{weight:0,minlen:o+l[c]})}else c!==t&&e.setEdge(t,c,{weight:0,minlen:a})}e.exports={run:function(e){var t=i.addDummyNode(e,"root",{},"_root"),a=function(e){var t={};function a(i,s){var r=e.children(i);r&&r.length&&n.forEach(r,(function(e){a(e,s+1)})),t[i]=s}return n.forEach(e.children(),(function(e){a(e,1)})),t}(e),r=n.max(n.values(a))-1,o=2*r+1;e.graph().nestingRoot=t,n.forEach(e.edges(),(function(t){e.edge(t).minlen*=o}));var l=function(e){return n.reduce(e.edges(),(function(t,a){return t+e.edge(a).weight}),0)}(e)+1;n.forEach(e.children(),(function(n){s(e,t,o,l,r,a,n)})),e.graph().nodeRankFactor=o},cleanup:function(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,n.forEach(e.edges(),(function(t){e.edge(t).nestingEdge&&e.removeEdge(t)}))}}},function(e,t,a){var n=a(88),i=a(108);function s(e,t,a,n,s,r){var o={width:0,height:0,rank:r,borderType:t},l=s[t][r-1],c=i.addDummyNode(e,"border",o,a);s[t][r]=c,e.setParent(c,n),l&&e.setEdge(l,c,{weight:1})}e.exports=function(e){n.forEach(e.children(),(function t(a){var i=e.children(a),r=e.node(a);if(i.length&&n.forEach(i,t),n.has(r,"minRank")){r.borderLeft=[],r.borderRight=[];for(var o=r.minRank,l=r.maxRank+1;o<l;++o)s(e,"borderLeft","_bl",a,r,o),s(e,"borderRight","_br",a,r,o)}}))}},function(e,t,a){"use strict";var n=a(88);function i(e){n.forEach(e.nodes(),(function(t){s(e.node(t))})),n.forEach(e.edges(),(function(t){s(e.edge(t))}))}function s(e){var t=e.width;e.width=e.height,e.height=t}function r(e){e.y=-e.y}function o(e){var t=e.x;e.x=e.y,e.y=t}e.exports={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||i(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){n.forEach(e.nodes(),(function(t){r(e.node(t))})),n.forEach(e.edges(),(function(t){var a=e.edge(t);n.forEach(a.points,r),n.has(a,"y")&&r(a)}))}(e);"lr"!==t&&"rl"!==t||(!function(e){n.forEach(e.nodes(),(function(t){o(e.node(t))})),n.forEach(e.edges(),(function(t){var a=e.edge(t);n.forEach(a.points,o),n.has(a,"x")&&o(a)}))}(e),i(e))}}},function(e,t,a){"use strict";var n=a(88),i=a(594),s=a(595),r=a(596),o=a(600),l=a(601),c=a(121).Graph,d=a(108);function u(e,t,a){return n.map(t,(function(t){return o(e,t,a)}))}function p(e,t){var a=new c;n.forEach(e,(function(e){var i=e.graph().root,s=r(e,i,a,t);n.forEach(s.vs,(function(t,a){e.node(t).order=a})),l(e,a,s.vs)}))}function m(e,t){n.forEach(t,(function(t){n.forEach(t,(function(t,a){e.node(t).order=a}))}))}e.exports=function(e){var t=d.maxRank(e),a=u(e,n.range(1,t+1),"inEdges"),r=u(e,n.range(t-1,-1,-1),"outEdges"),o=i(e);m(e,o);for(var l,c=Number.POSITIVE_INFINITY,b=0,f=0;f<4;++b,++f){p(b%2?a:r,b%4>=2),o=d.buildLayerMatrix(e);var h=s(e,o);h<c&&(f=0,l=n.cloneDeep(o),c=h)}m(e,l)}},function(e,t,a){"use strict";var n=a(88);e.exports=function(e){var t={},a=n.filter(e.nodes(),(function(t){return!e.children(t).length})),i=n.max(n.map(a,(function(t){return e.node(t).rank}))),s=n.map(n.range(i+1),(function(){return[]}));var r=n.sortBy(a,(function(t){return e.node(t).rank}));return n.forEach(r,(function a(i){if(n.has(t,i))return;t[i]=!0;var r=e.node(i);s[r.rank].push(i),n.forEach(e.successors(i),a)})),s}},function(e,t,a){"use strict";var n=a(88);function i(e,t,a){for(var i=n.zipObject(a,n.map(a,(function(e,t){return t}))),s=n.flatten(n.map(t,(function(t){return n.sortBy(n.map(e.outEdges(t),(function(t){return{pos:i[t.w],weight:e.edge(t).weight}})),"pos")})),!0),r=1;r<a.length;)r<<=1;var o=2*r-1;r-=1;var l=n.map(new Array(o),(function(){return 0})),c=0;return n.forEach(s.forEach((function(e){var t=e.pos+r;l[t]+=e.weight;for(var a=0;t>0;)t%2&&(a+=l[t+1]),l[t=t-1>>1]+=e.weight;c+=e.weight*a}))),c}e.exports=function(e,t){for(var a=0,n=1;n<t.length;++n)a+=i(e,t[n-1],t[n]);return a}},function(e,t,a){var n=a(88),i=a(597),s=a(598),r=a(599);e.exports=function e(t,a,o,l){var c=t.children(a),d=t.node(a),u=d?d.borderLeft:void 0,p=d?d.borderRight:void 0,m={};u&&(c=n.filter(c,(function(e){return e!==u&&e!==p})));var b=i(t,c);n.forEach(b,(function(a){if(t.children(a.v).length){var i=e(t,a.v,o,l);m[a.v]=i,n.has(i,"barycenter")&&(s=a,r=i,n.isUndefined(s.barycenter)?(s.barycenter=r.barycenter,s.weight=r.weight):(s.barycenter=(s.barycenter*s.weight+r.barycenter*r.weight)/(s.weight+r.weight),s.weight+=r.weight))}var s,r}));var f=s(b,o);!function(e,t){n.forEach(e,(function(e){e.vs=n.flatten(e.vs.map((function(e){return t[e]?t[e].vs:e})),!0)}))}(f,m);var h=r(f,l);if(u&&(h.vs=n.flatten([u,h.vs,p],!0),t.predecessors(u).length)){var g=t.node(t.predecessors(u)[0]),j=t.node(t.predecessors(p)[0]);n.has(h,"barycenter")||(h.barycenter=0,h.weight=0),h.barycenter=(h.barycenter*h.weight+g.order+j.order)/(h.weight+2),h.weight+=2}return h}},function(e,t,a){var n=a(88);e.exports=function(e,t){return n.map(t,(function(t){var a=e.inEdges(t);if(a.length){var i=n.reduce(a,(function(t,a){var n=e.edge(a),i=e.node(a.v);return{sum:t.sum+n.weight*i.order,weight:t.weight+n.weight}}),{sum:0,weight:0});return{v:t,barycenter:i.sum/i.weight,weight:i.weight}}return{v:t}}))}},function(e,t,a){"use strict";var n=a(88);e.exports=function(e,t){var a={};return n.forEach(e,(function(e,t){var i=a[e.v]={indegree:0,in:[],out:[],vs:[e.v],i:t};n.isUndefined(e.barycenter)||(i.barycenter=e.barycenter,i.weight=e.weight)})),n.forEach(t.edges(),(function(e){var t=a[e.v],i=a[e.w];n.isUndefined(t)||n.isUndefined(i)||(i.indegree++,t.out.push(a[e.w]))})),function(e){var t=[];function a(e){return function(t){t.merged||(n.isUndefined(t.barycenter)||n.isUndefined(e.barycenter)||t.barycenter>=e.barycenter)&&function(e,t){var a=0,n=0;e.weight&&(a+=e.barycenter*e.weight,n+=e.weight);t.weight&&(a+=t.barycenter*t.weight,n+=t.weight);e.vs=t.vs.concat(e.vs),e.barycenter=a/n,e.weight=n,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function i(t){return function(a){a.in.push(t),0==--a.indegree&&e.push(a)}}for(;e.length;){var s=e.pop();t.push(s),n.forEach(s.in.reverse(),a(s)),n.forEach(s.out,i(s))}return n.map(n.filter(t,(function(e){return!e.merged})),(function(e){return n.pick(e,["vs","i","barycenter","weight"])}))}(n.filter(a,(function(e){return!e.indegree})))}},function(e,t,a){var n=a(88),i=a(108);function s(e,t,a){for(var i;t.length&&(i=n.last(t)).i<=a;)t.pop(),e.push(i.vs),a++;return a}e.exports=function(e,t){var a=i.partition(e,(function(e){return n.has(e,"barycenter")})),r=a.lhs,o=n.sortBy(a.rhs,(function(e){return-e.i})),l=[],c=0,d=0,u=0;r.sort((p=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:p?t.i-e.i:e.i-t.i})),u=s(l,o,u),n.forEach(r,(function(e){u+=e.vs.length,l.push(e.vs),c+=e.barycenter*e.weight,d+=e.weight,u=s(l,o,u)}));var p;var m={vs:n.flatten(l,!0)};d&&(m.barycenter=c/d,m.weight=d);return m}},function(e,t,a){var n=a(88),i=a(121).Graph;e.exports=function(e,t,a){var s=function(e){var t;for(;e.hasNode(t=n.uniqueId("_root")););return t}(e),r=new i({compound:!0}).setGraph({root:s}).setDefaultNodeLabel((function(t){return e.node(t)}));return n.forEach(e.nodes(),(function(i){var o=e.node(i),l=e.parent(i);(o.rank===t||o.minRank<=t&&t<=o.maxRank)&&(r.setNode(i),r.setParent(i,l||s),n.forEach(e[a](i),(function(t){var a=t.v===i?t.w:t.v,s=r.edge(a,i),o=n.isUndefined(s)?0:s.weight;r.setEdge(a,i,{weight:e.edge(t).weight+o})})),n.has(o,"minRank")&&r.setNode(i,{borderLeft:o.borderLeft[t],borderRight:o.borderRight[t]}))})),r}},function(e,t,a){var n=a(88);e.exports=function(e,t,a){var i,s={};n.forEach(a,(function(a){for(var n,r,o=e.parent(a);o;){if((n=e.parent(o))?(r=s[n],s[n]=o):(r=i,i=o),r&&r!==o)return void t.setEdge(r,o);o=n}}))}},function(e,t,a){"use strict";var n=a(88),i=a(108),s=a(603).positionX;e.exports=function(e){(function(e){var t=i.buildLayerMatrix(e),a=e.graph().ranksep,s=0;n.forEach(t,(function(t){var i=n.max(n.map(t,(function(t){return e.node(t).height})));n.forEach(t,(function(t){e.node(t).y=s+i/2})),s+=i+a}))})(e=i.asNonCompoundGraph(e)),n.forEach(s(e),(function(t,a){e.node(a).x=t}))}},function(e,t,a){"use strict";var n=a(88),i=a(121).Graph,s=a(108);function r(e,t){var a={};return n.reduce(t,(function(t,i){var s=0,r=0,o=t.length,c=n.last(i);return n.forEach(i,(function(t,d){var u=function(e,t){if(e.node(t).dummy)return n.find(e.predecessors(t),(function(t){return e.node(t).dummy}))}(e,t),p=u?e.node(u).order:o;(u||t===c)&&(n.forEach(i.slice(r,d+1),(function(t){n.forEach(e.predecessors(t),(function(n){var i=e.node(n),r=i.order;!(r<s||p<r)||i.dummy&&e.node(t).dummy||l(a,n,t)}))})),r=d+1,s=p)})),i})),a}function o(e,t){var a={};function i(t,i,s,r,o){var c;n.forEach(n.range(i,s),(function(i){c=t[i],e.node(c).dummy&&n.forEach(e.predecessors(c),(function(t){var n=e.node(t);n.dummy&&(n.order<r||n.order>o)&&l(a,t,c)}))}))}return n.reduce(t,(function(t,a){var s,r=-1,o=0;return n.forEach(a,(function(n,l){if("border"===e.node(n).dummy){var c=e.predecessors(n);c.length&&(s=e.node(c[0]).order,i(a,o,l,r,s),o=l,r=s)}i(a,o,a.length,s,t.length)})),a})),a}function l(e,t,a){if(t>a){var n=t;t=a,a=n}var i=e[t];i||(e[t]=i={}),i[a]=!0}function c(e,t,a){if(t>a){var i=t;t=a,a=i}return n.has(e[t],a)}function d(e,t,a,i){var s={},r={},o={};return n.forEach(t,(function(e){n.forEach(e,(function(e,t){s[e]=e,r[e]=e,o[e]=t}))})),n.forEach(t,(function(e){var t=-1;n.forEach(e,(function(e){var l=i(e);if(l.length)for(var d=((l=n.sortBy(l,(function(e){return o[e]}))).length-1)/2,u=Math.floor(d),p=Math.ceil(d);u<=p;++u){var m=l[u];r[e]===e&&t<o[m]&&!c(a,e,m)&&(r[m]=e,r[e]=s[e]=s[m],t=o[m])}}))})),{root:s,align:r}}function u(e,t,a,s,r){var o={},l=function(e,t,a,s){var r=new i,o=e.graph(),l=function(e,t,a){return function(i,s,r){var o,l=i.node(s),c=i.node(r),d=0;if(d+=l.width/2,n.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":o=-l.width/2;break;case"r":o=l.width/2}if(o&&(d+=a?o:-o),o=0,d+=(l.dummy?t:e)/2,d+=(c.dummy?t:e)/2,d+=c.width/2,n.has(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":o=c.width/2;break;case"r":o=-c.width/2}return o&&(d+=a?o:-o),o=0,d}}(o.nodesep,o.edgesep,s);return n.forEach(t,(function(t){var i;n.forEach(t,(function(t){var n=a[t];if(r.setNode(n),i){var s=a[i],o=r.edge(s,n);r.setEdge(s,n,Math.max(l(e,t,i),o||0))}i=t}))})),r}(e,t,a,r),c=r?"borderLeft":"borderRight";function d(e,t){for(var a=l.nodes(),n=a.pop(),i={};n;)i[n]?e(n):(i[n]=!0,a.push(n),a=a.concat(t(n))),n=a.pop()}return d((function(e){o[e]=l.inEdges(e).reduce((function(e,t){return Math.max(e,o[t.v]+l.edge(t))}),0)}),l.predecessors.bind(l)),d((function(t){var a=l.outEdges(t).reduce((function(e,t){return Math.min(e,o[t.w]-l.edge(t))}),Number.POSITIVE_INFINITY),n=e.node(t);a!==Number.POSITIVE_INFINITY&&n.borderType!==c&&(o[t]=Math.max(o[t],a))}),l.successors.bind(l)),n.forEach(s,(function(e){o[e]=o[a[e]]})),o}function p(e,t){return n.minBy(n.values(t),(function(t){var a=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;return n.forIn(t,(function(t,n){var s=function(e,t){return e.node(t).width}(e,n)/2;a=Math.max(t+s,a),i=Math.min(t-s,i)})),a-i}))}function m(e,t){var a=n.values(t),i=n.min(a),s=n.max(a);n.forEach(["u","d"],(function(a){n.forEach(["l","r"],(function(r){var o,l=a+r,c=e[l];if(c!==t){var d=n.values(c);(o="l"===r?i-n.min(d):s-n.max(d))&&(e[l]=n.mapValues(c,(function(e){return e+o})))}}))}))}function b(e,t){return n.mapValues(e.ul,(function(a,i){if(t)return e[t.toLowerCase()][i];var s=n.sortBy(n.map(e,i));return(s[1]+s[2])/2}))}e.exports={positionX:function(e){var t,a=s.buildLayerMatrix(e),i=n.merge(r(e,a),o(e,a)),l={};n.forEach(["u","d"],(function(s){t="u"===s?a:n.values(a).reverse(),n.forEach(["l","r"],(function(a){"r"===a&&(t=n.map(t,(function(e){return n.values(e).reverse()})));var r=("u"===s?e.predecessors:e.successors).bind(e),o=d(e,t,i,r),c=u(e,t,o.root,o.align,"r"===a);"r"===a&&(c=n.mapValues(c,(function(e){return-e}))),l[s+a]=c}))}));var c=p(e,l);return m(l,c),b(l,e.graph().align)},findType1Conflicts:r,findType2Conflicts:o,addConflict:l,hasConflict:c,verticalAlignment:d,horizontalCompaction:u,alignCoordinates:m,findSmallestWidthAlignment:p,balance:b}},function(e,t,a){var n=a(88),i=a(108),s=a(121).Graph;e.exports={debugOrdering:function(e){var t=i.buildLayerMatrix(e),a=new s({compound:!0,multigraph:!0}).setGraph({});return n.forEach(e.nodes(),(function(t){a.setNode(t,{label:t}),a.setParent(t,"layer"+e.node(t).rank)})),n.forEach(e.edges(),(function(e){a.setEdge(e.v,e.w,{},e.name)})),n.forEach(t,(function(e,t){var i="layer"+t;a.setNode(i,{rank:"same"}),n.reduce(e,(function(e,t){return a.setEdge(e,t,{style:"invis"}),t}))})),a}}},function(e,t){e.exports="0.8.5"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICA8cGF0aCBkPSJNNi45OTk4NSAxNnY1LjAwMDJIOS4wMzc5QzkuMDEyOCAyMS4zMzAxIDkgMjEuNjYzNiA5IDIyYzAgLjMzNjQuMDEyOC42Njk5LjAzNzkuOTk5OEg2Ljk5OTg1VjI4aC0xLjk5OTd2LTUuMDAwMkgwdi0xLjk5OTZoNS4wMDAxNVYxNmgxLjk5OTd6bTAtMTZ2NS4wMDAxNUgxMnYxLjk5OTdINi45OTk4NVYxMmgtMS45OTk3VjYuOTk5ODVIMHYtMS45OTk3aDUuMDAwMTVWMGgxLjk5OTd6TTIyLjk5OTggMHY1LjAwMDE1SDI4djEuOTk5N2gtNS4wMDAyVjkuMDM3OUMyMi42Njk5IDkuMDEyOCAyMi4zMzY0IDkgMjIgOWMtLjMzNjQgMC0uNjY5OS4wMTI4LS45OTk4LjAzNzlWNi45OTk4NUgxNnYtMS45OTk3aDUuMDAwMlYwaDEuOTk5NnoiIC8+CiAgICA8cGF0aAogICAgICBmaWxsPSIjMDE3RDczIgogICAgICBkPSJNMjIgMTBjMy4wNzM0IDAgNS44NzcgMS4xNTU0IDggMy4wNTU2djMuMjUyNWMtLjMxNS0uNDQyNy0uNjY4Mi0uODYxMy0xLjA1NzUtMS4yNTA2LTEuODQxMy0xLjg0MTMtNC4zMzg2LTIuODc1Ny02Ljk0MjUtMi44NzU3LTUuNDIyNCAwLTkuODE4MiA0LjM5NTgtOS44MTgyIDkuODE4MiAwIDMuMzAwMSAxLjYyODIgNi4yMTk5IDQuMTI1MSA4aC0zLjI1MTNDMTEuMTU1NCAyNy44NzcgMTAgMjUuMDczNCAxMCAyMmMwLTYuNjI3NCA1LjM3MjYtMTIgMTItMTJ6bS45OTk4IDh2My4wMDAySDI2djEuOTk5NmgtMy4wMDAyVjI2aC0xLjk5OTZ2LTMuMDAwMkgxOHYtMS45OTk2aDMuMDAwMlYxOGgxLjk5OTZ6IgogICAgLz4KPC9zdmc+Cg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICAgIDxwYXRoIGQ9Ik0yIDEydjZoNnYySDB2LThoMnptMTggMHY4aC04di0yaDZ2LTZoMnpNOCAwdjJIMnY2SDBWMGg4em0xMiAwdjhoLTJWMmgtNlYwaDh6IiAvPgogICAgPHBhdGgKICAgICAgZmlsbD0iIzAxN0Q3MyIKICAgICAgZD0iTTE2IDI0YzIuMjA5MSAwIDQgMS43OTA5IDQgNCAwIDIuMjA5MS0xLjc5MDkgNC00IDQtMi4yMDkxIDAtNC0xLjc5MDktNC00IDAtMi4yMDkxIDEuNzkwOS00IDQtNHptMTIgMGMyLjIwOTEgMCA0IDEuNzkwOSA0IDQgMCAyLjIwOTEtMS43OTA5IDQtNCA0LTIuMjA5MSAwLTQtMS43OTA5LTQtNCAwLTIuMjA5MSAxLjc5MDktNCA0LTR6bS0xMiAxLjc1Yy0xLjI0MjYgMC0yLjI1IDEuMDA3NC0yLjI1IDIuMjVzMS4wMDc0IDIuMjUgMi4yNSAyLjI1IDIuMjUtMS4wMDc0IDIuMjUtMi4yNS0xLjAwNzQtMi4yNS0yLjI1LTIuMjV6bTEyIDBjLTEuMjQyNiAwLTIuMjUgMS4wMDc0LTIuMjUgMi4yNXMxLjAwNzQgMi4yNSAyLjI1IDIuMjUgMi4yNS0xLjAwNzQgMi4yNS0yLjI1LTEuMDA3NC0yLjI1LTIuMjUtMi4yNXpNMjggMTJjMi4yMDkxIDAgNCAxLjc5MDkgNCA0IDAgMi4yMDkxLTEuNzkwOSA0LTQgNC0yLjIwOTEgMC00LTEuNzkwOS00LTQgMC0yLjIwOTEgMS43OTA5LTQgNC00em0wIDEuNzVjLTEuMjQyNiAwLTIuMjUgMS4wMDc0LTIuMjUgMi4yNXMxLjAwNzQgMi4yNSAyLjI1IDIuMjUgMi4yNS0xLjAwNzQgMi4yNS0yLjI1LTEuMDA3NC0yLjI1LTIuMjUtMi4yNXpNMTAgNmMyLjIwOTEgMCA0IDEuNzkwODYgNCA0IDAgMi4yMDkxLTEuNzkwOSA0LTQgNC0yLjIwOTE0IDAtNC0xLjc5MDktNC00IDAtMi4yMDkxNCAxLjc5MDg2LTQgNC00em0wIDEuNzVjLTEuMjQyNjQgMC0yLjI1IDEuMDA3MzYtMi4yNSAyLjI1IDAgMS4yNDI2IDEuMDA3MzYgMi4yNSAyLjI1IDIuMjUgMS4yNDI2IDAgMi4yNS0xLjAwNzQgMi4yNS0yLjI1IDAtMS4yNDI2NC0xLjAwNzQtMi4yNS0yLjI1LTIuMjV6IgogICAgLz4KPC9zdmc+Cg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMiIgaGVpZ2h0PSIzMiIgdmlld0JveD0iMCAwIDMyIDMyIiBmaWxsPSIjMzQzNzQxIj4KICA8cGF0aCBkPSJNMjQgMGM0LjQxODMgMCA4IDMuNTgxNzIgOCA4IDAgMi4xMjE3LS44NDI5IDQuMTU2Ni0yLjM0MzEgNS42NTY5QzI4LjE1NjYgMTUuMTU3MSAyNi4xMjE3IDE2IDI0IDE2Yy0xLjg0ODcgMC0zLjU1MDktLjYyNzEtNC45MDU2LTEuNjgwMWwtNC43NzQ1IDQuNzc0NUMxNS4zNzI5IDIwLjQ0OTEgMTYgMjIuMTUxMyAxNiAyNGMwIDIuMTIxNy0uODQyOSA0LjE1NjYtMi4zNDMxIDUuNjU2OUMxMi4xNTY2IDMxLjE1NzEgMTAuMTIxNyAzMiA4IDMyYy00LjQxODI4IDAtOC0zLjU4MTctOC04czMuNTgxNzItOCA4LThjMS44NDg3MiAwIDMuNTUxLjYyNzEgNC45MDU3IDEuNjgwMmw0Ljc3NDUtNC43NzQ1QzE2LjYyNzEgMTEuNTUxIDE2IDkuODQ4NzIgMTYgOGMwLTQuNDE4MjggMy41ODE3LTggOC04ek04IDE4Yy0zLjMxMzcxIDAtNiAyLjY4NjMtNiA2czIuNjg2MjkgNiA2IDZjMy4zMTM3IDAgNi0yLjY4NjMgNi02IDAtMS41OTEzLS42MzIxLTMuMTE3NC0xLjc1NzQtNC4yNDI2QzExLjExNzQgMTguNjMyMSA5LjU5MTMgMTggOCAxOHpNMjQgMmMtMy4zMTM3IDAtNiAyLjY4NjI5LTYgNiAwIDMuMzEzNyAyLjY4NjMgNiA2IDZzNi0yLjY4NjMgNi02YzAtMS41OTEzLS42MzIxLTMuMTE3NDItMS43NTc0LTQuMjQyNjRDMjcuMTE3NCAyLjYzMjE0IDI1LjU5MTMgMiAyNCAyeiIvPgogIDxwYXRoIGZpbGw9IiMwMTdENzMiICBkPSJNMzIgMjB2MTJIMjBWMjBoMTJ6bS0yIDJoLTh2OGg4di04ek0xMiAwdjEySDBWMGgxMnptLTIgMkgydjhoOFYyeiIvPgo8L3N2Zz4K"},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(51),i=a(16),s=n.__importDefault(a(610)),r=a(612);t.default=function(e,t){void 0===e&&(e=1/0),void 0===t&&(t=1/0);var a=s.default({width:r.isClient?window.innerWidth:e,height:r.isClient?window.innerHeight:t}),n=a[0],o=a[1];return i.useEffect((function(){if(r.isClient){var e=function(){o({width:window.innerWidth,height:window.innerHeight})};return window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}}}),[]),n}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(51),i=a(16),s=n.__importDefault(a(611));t.default=function(e){var t=i.useRef(0),a=i.useState(e),n=a[0],r=a[1],o=i.useCallback((function(e){cancelAnimationFrame(t.current),t.current=requestAnimationFrame((function(){r(e)}))}),[]);return s.default((function(){cancelAnimationFrame(t.current)})),[n,o]}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(51),i=a(16),s=n.__importDefault(a(247));t.default=function(e){var t=i.useRef(e);t.current=e,s.default((function(){return function(){return t.current()}}))}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=a(51).__importDefault(a(613));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var n,i,s;if(Array.isArray(t)){if((n=t.length)!=a.length)return!1;for(i=n;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((n=(s=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,s[i]))return!1;for(i=n;0!=i--;){var r=s[i];if(("_owner"!==r||!t.$$typeof)&&!e(t[r],a[r]))return!1}return!0}return t!=t&&a!=a}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(615);case"v8light":return a(617)}},function(e,t,a){var n=a(78),i=a(616);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(618);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlScatterplotMatrix{overflow-x:auto}.mlScatterplotMatrix .vega-bind span{font-size:12px;padding:0 4px}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(620);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(622);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlExpandableSection{padding:0 8px 8px 8px}.mlExpandableSection-contentPadding{padding:8px}[id^='echTooltipPortal']{z-index:9000 !important}\n",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(16),i=a(624);t.default=function(e,t){var a=i.useFirstMountState();n.useEffect((function(){if(!a)return e()}),t)}},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.useFirstMountState=void 0;var n=a(16);t.useFirstMountState=function(){var e=n.useRef(!0);return e.current?(e.current=!1,!0):e.current}},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(626);case"v8light":return a(628)}},function(e,t,a){var n=a(78),i=a(627);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}.mlDataFrameAnalyticsClassification__evaluationMetrics{width:60%}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(629);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlDataFrameAnalyticsClassification{width:100%}.mlDataFrameAnalyticsClassification__evaluateSectionContent{padding:0 5%}.mlDataFrameAnalyticsClassification__evaluateSectionContent:after{content:'';display:table;clear:both}.mlDataFrameAnalyticsClassification__actualLabel{float:left;width:80px;padding-top:64px}.mlDataFrameAnalyticsClassification__dataGridMinWidth{float:left;min-width:480px;width:calc(100% - 80px)}.mlDataFrameAnalyticsClassification__dataGridMinWidth .euiDataGridRowCell--boolean{text-transform:none}.mlDataFrameAnalyticsClassification__evaluationMetrics{width:60%}\n",""]),e.exports=t},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(631);case"v8light":return a(633)}},function(e,t,a){var n=a(78),i=a(632);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlHelpPopover__panel{max-width:480px}.mlHelpPopover__content{scrollbar-color:rgba(152,162,179,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:40vh;padding:8px}.mlHelpPopover__content::-webkit-scrollbar{width:16px;height:16px}.mlHelpPopover__content::-webkit-scrollbar-thumb{background-color:rgba(152,162,179,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.mlHelpPopover__content::-webkit-scrollbar-corner,.mlHelpPopover__content::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.mlHelpPopover__content:focus{outline:none}.mlHelpPopover__content[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(634);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlHelpPopover__panel{max-width:480px}.mlHelpPopover__content{scrollbar-color:rgba(105,112,125,0.5) rgba(0,0,0,0);scrollbar-width:thin;height:100%;overflow-y:auto;overflow-x:hidden;-webkit-mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);mask-image:linear-gradient(to bottom, rgba(255,0,0,0.1) 0%,red 7.5px,red calc(100% - 7.5px),rgba(255,0,0,0.1) 100%);max-height:40vh;padding:8px}.mlHelpPopover__content::-webkit-scrollbar{width:16px;height:16px}.mlHelpPopover__content::-webkit-scrollbar-thumb{background-color:rgba(105,112,125,0.5);background-clip:content-box;border-radius:16px;border:6px solid rgba(0,0,0,0)}.mlHelpPopover__content::-webkit-scrollbar-corner,.mlHelpPopover__content::-webkit-scrollbar-track{background-color:rgba(0,0,0,0)}.mlHelpPopover__content:focus{outline:none}.mlHelpPopover__content[tabindex='0']:focus:focus-visible{outline-style:auto}\n",""]),e.exports=t},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ES_FIELD_TYPES",{enumerable:!0,get:function(){return s.ES_FIELD_TYPES}}),Object.defineProperty(t,"KBN_FIELD_TYPES",{enumerable:!0,get:function(){return s.KBN_FIELD_TYPES}}),Object.defineProperty(t,"KbnFieldType",{enumerable:!0,get:function(){return n.KbnFieldType}}),Object.defineProperty(t,"castEsToKbnFieldTypeName",{enumerable:!0,get:function(){return i.castEsToKbnFieldTypeName}}),Object.defineProperty(t,"getFilterableKbnTypeNames",{enumerable:!0,get:function(){return i.getFilterableKbnTypeNames}}),Object.defineProperty(t,"getKbnFieldType",{enumerable:!0,get:function(){return i.getKbnFieldType}}),Object.defineProperty(t,"getKbnTypeNames",{enumerable:!0,get:function(){return i.getKbnTypeNames}});var n=a(355),i=a(636),s=a(204)},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getKbnTypeNames=t.getKbnFieldType=t.getFilterableKbnTypeNames=t.castEsToKbnFieldTypeName=void 0;var n=a(637),i=a(204);const s=(0,n.createKbnFieldTypes)();t.getKbnFieldType=e=>s.find((t=>t.name===e))||n.kbnFieldTypeUnknown;t.getKbnTypeNames=()=>s.filter((e=>e.name)).map((e=>e.name));t.castEsToKbnFieldTypeName=e=>{const t=s.find((t=>t.esTypes.includes(e)));return t&&t.name?t.name:i.KBN_FIELD_TYPES.UNKNOWN};t.getFilterableKbnTypeNames=()=>s.filter((e=>e.filterable)).map((e=>e.name))},function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.kbnFieldTypeUnknown=t.createKbnFieldTypes=void 0;var n=a(355),i=a(204);const s=new n.KbnFieldType({name:i.KBN_FIELD_TYPES.UNKNOWN});t.kbnFieldTypeUnknown=s;t.createKbnFieldTypes=()=>[new n.KbnFieldType({name:i.KBN_FIELD_TYPES.STRING,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.STRING,i.ES_FIELD_TYPES.TEXT,i.ES_FIELD_TYPES.KEYWORD,i.ES_FIELD_TYPES.VERSION,i.ES_FIELD_TYPES._TYPE,i.ES_FIELD_TYPES._ID]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.NUMBER,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.FLOAT,i.ES_FIELD_TYPES.HALF_FLOAT,i.ES_FIELD_TYPES.SCALED_FLOAT,i.ES_FIELD_TYPES.DOUBLE,i.ES_FIELD_TYPES.INTEGER,i.ES_FIELD_TYPES.LONG,i.ES_FIELD_TYPES.UNSIGNED_LONG,i.ES_FIELD_TYPES.SHORT,i.ES_FIELD_TYPES.BYTE,i.ES_FIELD_TYPES.TOKEN_COUNT]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.NUMBER_RANGE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.FLOAT_RANGE,i.ES_FIELD_TYPES.DOUBLE_RANGE,i.ES_FIELD_TYPES.INTEGER_RANGE,i.ES_FIELD_TYPES.LONG_RANGE]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.DATE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.DATE,i.ES_FIELD_TYPES.DATE_NANOS]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.DATE_RANGE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.DATE_RANGE]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.IP,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.IP]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.IP_RANGE,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.IP_RANGE]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.BOOLEAN,sortable:!0,filterable:!0,esTypes:[i.ES_FIELD_TYPES.BOOLEAN]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.OBJECT,esTypes:[i.ES_FIELD_TYPES.OBJECT]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.NESTED,esTypes:[i.ES_FIELD_TYPES.NESTED]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.GEO_POINT,esTypes:[i.ES_FIELD_TYPES.GEO_POINT]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.GEO_SHAPE,esTypes:[i.ES_FIELD_TYPES.GEO_SHAPE]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.ATTACHMENT,esTypes:[i.ES_FIELD_TYPES.ATTACHMENT]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.MURMUR3,esTypes:[i.ES_FIELD_TYPES.MURMUR3]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES._SOURCE,esTypes:[i.ES_FIELD_TYPES._SOURCE]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.HISTOGRAM,filterable:!0,esTypes:[i.ES_FIELD_TYPES.HISTOGRAM]}),new n.KbnFieldType({name:i.KBN_FIELD_TYPES.CONFLICT}),s]},function(e,t,a){switch(window.__kbnThemeTag__){case"v8dark":return a(639);case"v8light":return a(641)}},function(e,t,a){var n=a(78),i=a(640);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}\n",""]),e.exports=t},function(e,t,a){var n=a(78),i=a(642);"string"==typeof(i=i.__esModule?i.default:i)&&(i=[[e.i,i,""]]);var s={insert:"head",singleton:!1};n(i,s);e.exports=i.locals||{}},function(e,t,a){(t=a(79)(!1)).push([e.i,".mlJobSelectorFlyoutBody>.euiFlyoutBody__overflow{padding-top:8px}.mlJobSelector__ganttBar{background-color:#79ADDA;height:12px;border-radius:2px}.mlJobSelector__ganttBarBackEdge{height:16px;border-left:1px solid #D6D6D6;border-right:1px solid #D6D6D6;margin-bottom:-14px;padding-top:8px}.mlJobSelector__ganttBarDashed{height:1px;border-top:1px dashed #D6D6D6}.mlJobSelector__ganttBarRunning{background-image:linear-gradient(45deg, rgba(255,255,255,0.15) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.15) 50%, rgba(255,255,255,0.15) 75%, transparent 75%, transparent);background-size:40px 40px;animation:progress-bar-stripes 2s linear infinite}\n",""]),e.exports=t},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(16);t.default=function(e){var t=n.useRef();return n.useEffect((function(){t.current=e})),t.current}}])]);