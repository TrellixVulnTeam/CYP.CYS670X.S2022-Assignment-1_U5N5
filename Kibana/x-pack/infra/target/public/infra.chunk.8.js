/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[8],{173:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(13),n=a(1),i=a(2),s=a.n(i);const o=({options:e,onChange:t,fields:a,errorOptions:o})=>{const l=Object(i.useCallback)((e=>{const a=e.map((e=>e.label));t(a)}),[t]),c=Array.isArray(e.groupBy)?e.groupBy.map((e=>({label:e,color:null!=o&&o.includes(e)?"danger":void 0}))):e.groupBy?[{label:e.groupBy,color:null!=o&&o.includes(e.groupBy)?"danger":void 0}]:[];return s.a.createElement(r.EuiComboBox,{"data-test-subj":"metricsExplorer-groupBy",placeholder:n.i18n.translate("xpack.infra.metricsExplorer.groupByLabel",{defaultMessage:"Everything"}),"aria-label":n.i18n.translate("xpack.infra.metricsExplorer.groupByAriaLabel",{defaultMessage:"Graph per"}),fullWidth:!0,singleSelection:!1,selectedOptions:c,options:a.filter((e=>e.aggregatable&&"string"===e.type)).map((e=>({label:e.name}))),onChange:l,isClearable:!0})}},174:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));var r=a(10),n=a.n(r),i=a(2),s=a(27),o=a(98),l=a(112),c=a(4),u=a(19),d=a(84);function m(e,t,a,r,m,p,g=!0){var f;const b=null===(f=Object(c.useKibana)().services.http)||void 0===f?void 0:f.fetch,[h,y]=Object(i.useState)(null),[E,v]=Object(i.useState)(!0),[x,k]=Object(i.useState)(null),[O,M]=Object(i.useState)(null),[w,j]=Object(i.useState)(null),S=n.a.parse(r.from),C=n.a.parse(r.to,{roundUp:!0}),[,T]=Object(d.c)({cancelPreviousOn:"creation",createPromise:()=>(v(!0),S&&C?b?t?b?b("/api/infra/metrics_explorer",{method:"POST",body:JSON.stringify({forceInterval:e.forceInterval,dropLastBucket:null==e.dropLastBucket||e.dropLastBucket,metrics:"count"===e.aggregation?[{aggregation:"count"}]:e.metrics.map((e=>({aggregation:e.aggregation,field:e.field}))),groupBy:e.groupBy,afterKey:m,limit:e.limit,indexPattern:t.metricAlias,filterQuery:e.filterQuery&&Object(l.a)(e.filterQuery,a)||void 0,timerange:{...r,from:S.valueOf(),to:C.valueOf()}})}):Promise.reject(new Error("HTTP service is unavailable")):Promise.reject(new Error("Source is unavailable")):Promise.reject(new Error("HTTP service is unavailable")):Promise.reject(new Error("Unalble to parse timerange"))),onResolve:t=>{v(!1);const a=Object(u.b)(o.e)(t);if(a){if(x&&O&&x.pageInfo.afterKey!==a.pageInfo.afterKey&&(n=O,i=e,Object(s.isEqual)(n,i))&&Object(s.isEqual)(r,w)&&m){const{series:e}=x;k({...a,series:[...e,...a.series]})}else k(a);M(e),j(r),y(null)}var n,i},onReject:e=>{y(e),v(!1)}},[t,r,e,p,m]);return Object(i.useEffect)((()=>{g&&T()}),[T,g]),{error:h,loading:E,data:x,loadData:T}}},223:function(e,t,a){var r=a(286),n={};for(var i in r)r.hasOwnProperty(i)&&(n[r[i]]=i);var s=e.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var o in s)if(s.hasOwnProperty(o)){if(!("channels"in s[o]))throw new Error("missing channels property: "+o);if(!("labels"in s[o]))throw new Error("missing channel labels property: "+o);if(s[o].labels.length!==s[o].channels)throw new Error("channel and label counts mismatch: "+o);var l=s[o].channels,c=s[o].labels;delete s[o].channels,delete s[o].labels,Object.defineProperty(s[o],"channels",{value:l}),Object.defineProperty(s[o],"labels",{value:c})}s.rgb.hsl=function(e){var t,a,r=e[0]/255,n=e[1]/255,i=e[2]/255,s=Math.min(r,n,i),o=Math.max(r,n,i),l=o-s;return o===s?t=0:r===o?t=(n-i)/l:n===o?t=2+(i-r)/l:i===o&&(t=4+(r-n)/l),(t=Math.min(60*t,360))<0&&(t+=360),a=(s+o)/2,[t,100*(o===s?0:a<=.5?l/(o+s):l/(2-o-s)),100*a]},s.rgb.hsv=function(e){var t,a,r,n,i,s=e[0]/255,o=e[1]/255,l=e[2]/255,c=Math.max(s,o,l),u=c-Math.min(s,o,l),d=function(e){return(c-e)/6/u+.5};return 0===u?n=i=0:(i=u/c,t=d(s),a=d(o),r=d(l),s===c?n=r-a:o===c?n=1/3+t-r:l===c&&(n=2/3+a-t),n<0?n+=1:n>1&&(n-=1)),[360*n,100*i,100*c]},s.rgb.hwb=function(e){var t=e[0],a=e[1],r=e[2];return[s.rgb.hsl(e)[0],100*(1/255*Math.min(t,Math.min(a,r))),100*(r=1-1/255*Math.max(t,Math.max(a,r)))]},s.rgb.cmyk=function(e){var t,a=e[0]/255,r=e[1]/255,n=e[2]/255;return[100*((1-a-(t=Math.min(1-a,1-r,1-n)))/(1-t)||0),100*((1-r-t)/(1-t)||0),100*((1-n-t)/(1-t)||0),100*t]},s.rgb.keyword=function(e){var t=n[e];if(t)return t;var a,i,s,o=1/0;for(var l in r)if(r.hasOwnProperty(l)){var c=r[l],u=(i=e,s=c,Math.pow(i[0]-s[0],2)+Math.pow(i[1]-s[1],2)+Math.pow(i[2]-s[2],2));u<o&&(o=u,a=l)}return a},s.keyword.rgb=function(e){return r[e]},s.rgb.xyz=function(e){var t=e[0]/255,a=e[1]/255,r=e[2]/255;return[100*(.4124*(t=t>.04045?Math.pow((t+.055)/1.055,2.4):t/12.92)+.3576*(a=a>.04045?Math.pow((a+.055)/1.055,2.4):a/12.92)+.1805*(r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92)),100*(.2126*t+.7152*a+.0722*r),100*(.0193*t+.1192*a+.9505*r)]},s.rgb.lab=function(e){var t=s.rgb.xyz(e),a=t[0],r=t[1],n=t[2];return r/=100,n/=108.883,a=(a/=95.047)>.008856?Math.pow(a,1/3):7.787*a+16/116,[116*(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116)-16,500*(a-r),200*(r-(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116))]},s.hsl.rgb=function(e){var t,a,r,n,i,s=e[0]/360,o=e[1]/100,l=e[2]/100;if(0===o)return[i=255*l,i,i];t=2*l-(a=l<.5?l*(1+o):l+o-l*o),n=[0,0,0];for(var c=0;c<3;c++)(r=s+1/3*-(c-1))<0&&r++,r>1&&r--,i=6*r<1?t+6*(a-t)*r:2*r<1?a:3*r<2?t+(a-t)*(2/3-r)*6:t,n[c]=255*i;return n},s.hsl.hsv=function(e){var t=e[0],a=e[1]/100,r=e[2]/100,n=a,i=Math.max(r,.01);return a*=(r*=2)<=1?r:2-r,n*=i<=1?i:2-i,[t,100*(0===r?2*n/(i+n):2*a/(r+a)),100*((r+a)/2)]},s.hsv.rgb=function(e){var t=e[0]/60,a=e[1]/100,r=e[2]/100,n=Math.floor(t)%6,i=t-Math.floor(t),s=255*r*(1-a),o=255*r*(1-a*i),l=255*r*(1-a*(1-i));switch(r*=255,n){case 0:return[r,l,s];case 1:return[o,r,s];case 2:return[s,r,l];case 3:return[s,o,r];case 4:return[l,s,r];case 5:return[r,s,o]}},s.hsv.hsl=function(e){var t,a,r,n=e[0],i=e[1]/100,s=e[2]/100,o=Math.max(s,.01);return r=(2-i)*s,a=i*o,[n,100*(a=(a/=(t=(2-i)*o)<=1?t:2-t)||0),100*(r/=2)]},s.hwb.rgb=function(e){var t,a,r,n,i,s,o,l=e[0]/360,c=e[1]/100,u=e[2]/100,d=c+u;switch(d>1&&(c/=d,u/=d),r=6*l-(t=Math.floor(6*l)),0!=(1&t)&&(r=1-r),n=c+r*((a=1-u)-c),t){default:case 6:case 0:i=a,s=n,o=c;break;case 1:i=n,s=a,o=c;break;case 2:i=c,s=a,o=n;break;case 3:i=c,s=n,o=a;break;case 4:i=n,s=c,o=a;break;case 5:i=a,s=c,o=n}return[255*i,255*s,255*o]},s.cmyk.rgb=function(e){var t=e[0]/100,a=e[1]/100,r=e[2]/100,n=e[3]/100;return[255*(1-Math.min(1,t*(1-n)+n)),255*(1-Math.min(1,a*(1-n)+n)),255*(1-Math.min(1,r*(1-n)+n))]},s.xyz.rgb=function(e){var t,a,r,n=e[0]/100,i=e[1]/100,s=e[2]/100;return a=-.9689*n+1.8758*i+.0415*s,r=.0557*n+-.204*i+1.057*s,t=(t=3.2406*n+-1.5372*i+-.4986*s)>.0031308?1.055*Math.pow(t,1/2.4)-.055:12.92*t,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:12.92*a,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:12.92*r,[255*(t=Math.min(Math.max(0,t),1)),255*(a=Math.min(Math.max(0,a),1)),255*(r=Math.min(Math.max(0,r),1))]},s.xyz.lab=function(e){var t=e[0],a=e[1],r=e[2];return a/=100,r/=108.883,t=(t/=95.047)>.008856?Math.pow(t,1/3):7.787*t+16/116,[116*(a=a>.008856?Math.pow(a,1/3):7.787*a+16/116)-16,500*(t-a),200*(a-(r=r>.008856?Math.pow(r,1/3):7.787*r+16/116))]},s.lab.xyz=function(e){var t,a,r,n=e[0];t=e[1]/500+(a=(n+16)/116),r=a-e[2]/200;var i=Math.pow(a,3),s=Math.pow(t,3),o=Math.pow(r,3);return a=i>.008856?i:(a-16/116)/7.787,t=s>.008856?s:(t-16/116)/7.787,r=o>.008856?o:(r-16/116)/7.787,[t*=95.047,a*=100,r*=108.883]},s.lab.lch=function(e){var t,a=e[0],r=e[1],n=e[2];return(t=360*Math.atan2(n,r)/2/Math.PI)<0&&(t+=360),[a,Math.sqrt(r*r+n*n),t]},s.lch.lab=function(e){var t,a=e[0],r=e[1];return t=e[2]/360*2*Math.PI,[a,r*Math.cos(t),r*Math.sin(t)]},s.rgb.ansi16=function(e){var t=e[0],a=e[1],r=e[2],n=1 in arguments?arguments[1]:s.rgb.hsv(e)[2];if(0===(n=Math.round(n/50)))return 30;var i=30+(Math.round(r/255)<<2|Math.round(a/255)<<1|Math.round(t/255));return 2===n&&(i+=60),i},s.hsv.ansi16=function(e){return s.rgb.ansi16(s.hsv.rgb(e),e[2])},s.rgb.ansi256=function(e){var t=e[0],a=e[1],r=e[2];return t===a&&a===r?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(a/255*5)+Math.round(r/255*5)},s.ansi16.rgb=function(e){var t=e%10;if(0===t||7===t)return e>50&&(t+=3.5),[t=t/10.5*255,t,t];var a=.5*(1+~~(e>50));return[(1&t)*a*255,(t>>1&1)*a*255,(t>>2&1)*a*255]},s.ansi256.rgb=function(e){if(e>=232){var t=10*(e-232)+8;return[t,t,t]}var a;return e-=16,[Math.floor(e/36)/5*255,Math.floor((a=e%36)/6)/5*255,a%6/5*255]},s.rgb.hex=function(e){var t=(((255&Math.round(e[0]))<<16)+((255&Math.round(e[1]))<<8)+(255&Math.round(e[2]))).toString(16).toUpperCase();return"000000".substring(t.length)+t},s.hex.rgb=function(e){var t=e.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!t)return[0,0,0];var a=t[0];3===t[0].length&&(a=a.split("").map((function(e){return e+e})).join(""));var r=parseInt(a,16);return[r>>16&255,r>>8&255,255&r]},s.rgb.hcg=function(e){var t,a=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(Math.max(a,r),n),s=Math.min(Math.min(a,r),n),o=i-s;return t=o<=0?0:i===a?(r-n)/o%6:i===r?2+(n-a)/o:4+(a-r)/o+4,t/=6,[360*(t%=1),100*o,100*(o<1?s/(1-o):0)]},s.hsl.hcg=function(e){var t=e[1]/100,a=e[2]/100,r=1,n=0;return(r=a<.5?2*t*a:2*t*(1-a))<1&&(n=(a-.5*r)/(1-r)),[e[0],100*r,100*n]},s.hsv.hcg=function(e){var t=e[1]/100,a=e[2]/100,r=t*a,n=0;return r<1&&(n=(a-r)/(1-r)),[e[0],100*r,100*n]},s.hcg.rgb=function(e){var t=e[0]/360,a=e[1]/100,r=e[2]/100;if(0===a)return[255*r,255*r,255*r];var n,i=[0,0,0],s=t%1*6,o=s%1,l=1-o;switch(Math.floor(s)){case 0:i[0]=1,i[1]=o,i[2]=0;break;case 1:i[0]=l,i[1]=1,i[2]=0;break;case 2:i[0]=0,i[1]=1,i[2]=o;break;case 3:i[0]=0,i[1]=l,i[2]=1;break;case 4:i[0]=o,i[1]=0,i[2]=1;break;default:i[0]=1,i[1]=0,i[2]=l}return n=(1-a)*r,[255*(a*i[0]+n),255*(a*i[1]+n),255*(a*i[2]+n)]},s.hcg.hsv=function(e){var t=e[1]/100,a=t+e[2]/100*(1-t),r=0;return a>0&&(r=t/a),[e[0],100*r,100*a]},s.hcg.hsl=function(e){var t=e[1]/100,a=e[2]/100*(1-t)+.5*t,r=0;return a>0&&a<.5?r=t/(2*a):a>=.5&&a<1&&(r=t/(2*(1-a))),[e[0],100*r,100*a]},s.hcg.hwb=function(e){var t=e[1]/100,a=t+e[2]/100*(1-t);return[e[0],100*(a-t),100*(1-a)]},s.hwb.hcg=function(e){var t=e[1]/100,a=1-e[2]/100,r=a-t,n=0;return r<1&&(n=(a-r)/(1-r)),[e[0],100*r,100*n]},s.apple.rgb=function(e){return[e[0]/65535*255,e[1]/65535*255,e[2]/65535*255]},s.rgb.apple=function(e){return[e[0]/255*65535,e[1]/255*65535,e[2]/255*65535]},s.gray.rgb=function(e){return[e[0]/100*255,e[0]/100*255,e[0]/100*255]},s.gray.hsl=s.gray.hsv=function(e){return[0,0,e[0]]},s.gray.hwb=function(e){return[0,100,e[0]]},s.gray.cmyk=function(e){return[0,0,0,e[0]]},s.gray.lab=function(e){return[e[0],0,0]},s.gray.hex=function(e){var t=255&Math.round(e[0]/100*255),a=((t<<16)+(t<<8)+t).toString(16).toUpperCase();return"000000".substring(a.length)+a},s.rgb.gray=function(e){return[(e[0]+e[1]+e[2])/3/255*100]}},266:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(267),n=a(21);t.ThrowReporter={report:function(e){if(n.isLeft(e))throw new Error(r.PathReporter.report(e).join("\n"))}}},267:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a(0),n=a(21);function i(e){return void 0!==e.message?e.message:"Invalid value "+(("function"==typeof(t=e.value)?r.getFunctionName(t):"number"!=typeof t||isFinite(t)?JSON.stringify(t):isNaN(t)?"NaN":t>0?"Infinity":"-Infinity")+" supplied to ")+e.context.map((function(e){return e.key+": "+e.type.name})).join("/");var t}function s(e){return e.map(i)}function o(){return["No errors!"]}t.failure=s,t.success=o,t.PathReporter={report:n.fold(s,o)}},268:function(e){e.exports=JSON.parse('{"job_type":"anomaly_detector","groups":["hosts","metrics"],"description":"Metrics: Hosts - Identify unusual spikes in memory usage across hosts.","analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(\'system.memory.actual.used.pct\')","function":"max","field_name":"system.memory.actual.used.pct","custom_rules":[{"actions":["skip_result"],"conditions":[{"applies_to":"actual","operator":"lt","value":0.1}]}]}],"influencers":["host.name"]},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"64mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-hosts","custom_urls":[{"url_name":"Host Metrics","url_value":"metrics/detail/host/$host.name$?metricTime=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},269:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"system.memory"}}]}}}')},270:function(e){e.exports=JSON.parse('{"job_type":"anomaly_detector","description":"Metrics: Hosts - Identify unusual spikes in inbound traffic across hosts.","groups":["hosts","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_in_derivative)","function":"max","field_name":"bytes_in_derivative"}],"influencers":["host.name"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-hosts","custom_urls":[{"url_name":"Host Metrics","url_value":"metrics/detail/host/$host.name$?metricTime=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},271:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"system.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"host.name":{"terms":{"field":"host.name","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_in_max":{"max":{"field":"system.network.in.bytes"}},"bytes_in_derivative":{"derivative":{"buckets_path":"bytes_in_max"}},"positive_only":{"bucket_script":{"buckets_path":{"in_derivative":"bytes_in_derivative.value"},"script":"params.in_derivative > 0.0 ? params.in_derivative : 0.0"}}}}}}}}')},272:function(e){e.exports=JSON.parse('{"job_type":"anomaly_detector","description":"Metrics: Hosts - Identify unusual spikes in outbound traffic across hosts.","groups":["hosts","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_out_derivative)","function":"max","field_name":"bytes_out_derivative"}],"influencers":["host.name"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-hosts","custom_urls":[{"url_name":"Host Metrics","url_value":"metrics/detail/host/$host.name$?metricTime=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},273:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"system.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"host.name":{"terms":{"field":"host.name","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_out_max":{"max":{"field":"system.network.out.bytes"}},"bytes_out_derivative":{"derivative":{"buckets_path":"bytes_out_max"}},"positive_only":{"bucket_script":{"buckets_path":{"out_derivative":"bytes_out_derivative.value"},"script":"params.out_derivative > 0.0 ? params.out_derivative : 0.0"}}}}}}}}')},274:function(e){e.exports=JSON.parse('{"job_type":"anomaly_detector","groups":["k8s","metrics"],"description":"Metrics: Kubernetes - Identify unusual spikes in memory usage across Kubernetes pods.","analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(\'kubernetes.pod.memory.usage.node.pct\')","function":"max","field_name":"kubernetes.pod.memory.usage.node.pct","partition_field_name":"kubernetes.namespace","custom_rules":[{"actions":["skip_result"],"conditions":[{"applies_to":"actual","operator":"lt","value":0.1}]}]}],"influencers":["kubernetes.namespace","kubernetes.node.name","kubernetes.pod.uid"]},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"64mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-k8s","custom_urls":[{"url_name":"Pod Metrics","url_value":"metrics/detail/pod/$kubernetes.pod.uid$?metricTime=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},275:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"kubernetes.pod.uid"}},{"exists":{"field":"kubernetes.pod.memory"}}]}}}')},276:function(e){e.exports=JSON.parse('{"job_type":"anomaly_detector","description":"Metrics: Kubernetes - Identify unusual spikes in inbound traffic across Kubernetes pods.","groups":["k8s","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_in_derivative)","function":"max","field_name":"bytes_in_derivative","partition_field_name":"kubernetes.namespace"}],"influencers":["kubernetes.namespace","kubernetes.pod.uid"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-k8s","custom_urls":[{"url_name":"Pod Metrics","url_value":"metrics/detail/pod/$kubernetes.pod.uid$?metricTime=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},277:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"kubernetes.pod.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"kubernetes.namespace":{"terms":{"field":"kubernetes.namespace","size":25},"aggregations":{"kubernetes.pod.uid":{"terms":{"field":"kubernetes.pod.uid","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_in_max":{"max":{"field":"kubernetes.pod.network.rx.bytes"}},"bytes_in_derivative":{"derivative":{"buckets_path":"bytes_in_max"}},"positive_only":{"bucket_script":{"buckets_path":{"in_derivative":"bytes_in_derivative.value"},"script":"params.in_derivative > 0.0 ? params.in_derivative : 0.0"}}}}}}}}}}')},278:function(e){e.exports=JSON.parse('{"job_type":"anomaly_detector","description":"Metrics: Kubernetes - Identify unusual spikes in outbound traffic across Kubernetes pods.","groups":["k8s","metrics"],"analysis_config":{"bucket_span":"15m","detectors":[{"detector_description":"max(bytes_out_derivative)","function":"max","field_name":"bytes_out_derivative","partition_field_name":"kubernetes.namespace"}],"influencers":["kubernetes.namespace","kubernetes.pod.uid"],"summary_count_field_name":"doc_count"},"data_description":{"time_field":"@timestamp"},"analysis_limits":{"model_memory_limit":"32mb"},"custom_settings":{"managed":true,"created_by":"ml-module-metrics-ui-k8s","custom_urls":[{"url_name":"Pod Metrics","url_value":"metrics/detail/pod/$kubernetes.pod.uid$?metricTime=(autoReload:!f,refreshInterval:5000,time:(from:%27$earliest$%27,interval:%3E%3D1m,to:%27$latest$%27))"}]}}')},279:function(e){e.exports=JSON.parse('{"job_id":"JOB_ID","indices":["INDEX_PATTERN_NAME"],"indices_options":{"allow_no_indices":true},"query":{"bool":{"must":[{"exists":{"field":"kubernetes.pod.network"}}]}},"chunking_config":{"mode":"manual","time_span":"900s"},"aggregations":{"kubernetes.namespace":{"terms":{"field":"kubernetes.namespace","size":25},"aggregations":{"kubernetes.pod.uid":{"terms":{"field":"kubernetes.pod.uid","size":100},"aggregations":{"buckets":{"date_histogram":{"field":"@timestamp","fixed_interval":"5m"},"aggregations":{"@timestamp":{"max":{"field":"@timestamp"}},"bytes_out_max":{"max":{"field":"kubernetes.pod.network.tx.bytes"}},"bytes_out_derivative":{"derivative":{"buckets_path":"bytes_out_max"}},"positive_only":{"bucket_script":{"buckets_path":{"pos_derivative":"bytes_out_derivative.value"},"script":"params.pos_derivative > 0.0 ? params.pos_derivative : 0.0"}}}}}}}}}}')},280:function(e,t,a){"use strict";var r=a(281),n=a(285),i=[].slice,s=["keyword","gray","hex"],o={};Object.keys(n).forEach((function(e){o[i.call(n[e].labels).sort().join("")]=e}));var l={};function c(e,t){if(!(this instanceof c))return new c(e,t);if(t&&t in s&&(t=null),t&&!(t in n))throw new Error("Unknown model: "+t);var a,u;if(e)if(e instanceof c)this.model=e.model,this.color=e.color.slice(),this.valpha=e.valpha;else if("string"==typeof e){var d=r.get(e);if(null===d)throw new Error("Unable to parse color from string: "+e);this.model=d.model,u=n[this.model].channels,this.color=d.value.slice(0,u),this.valpha="number"==typeof d.value[u]?d.value[u]:1}else if(e.length){this.model=t||"rgb",u=n[this.model].channels;var m=i.call(e,0,u);this.color=p(m,u),this.valpha="number"==typeof e[u]?e[u]:1}else if("number"==typeof e)e&=16777215,this.model="rgb",this.color=[e>>16&255,e>>8&255,255&e],this.valpha=1;else{this.valpha=1;var g=Object.keys(e);"alpha"in e&&(g.splice(g.indexOf("alpha"),1),this.valpha="number"==typeof e.alpha?e.alpha:0);var f=g.sort().join("");if(!(f in o))throw new Error("Unable to parse color from object: "+JSON.stringify(e));this.model=o[f];var b=n[this.model].labels,h=[];for(a=0;a<b.length;a++)h.push(e[b[a]]);this.color=p(h)}else this.model="rgb",this.color=[0,0,0],this.valpha=1;if(l[this.model])for(u=n[this.model].channels,a=0;a<u;a++){var y=l[this.model][a];y&&(this.color[a]=y(this.color[a]))}this.valpha=Math.max(0,Math.min(1,this.valpha)),Object.freeze&&Object.freeze(this)}function u(e,t,a){return(e=Array.isArray(e)?e:[e]).forEach((function(e){(l[e]||(l[e]=[]))[t]=a})),e=e[0],function(r){var n;return arguments.length?(a&&(r=a(r)),(n=this[e]()).color[t]=r,n):(n=this[e]().color[t],a&&(n=a(n)),n)}}function d(e){return function(t){return Math.max(0,Math.min(e,t))}}function m(e){return Array.isArray(e)?e:[e]}function p(e,t){for(var a=0;a<t;a++)"number"!=typeof e[a]&&(e[a]=0);return e}c.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(e){var t=this.model in r.to?this:this.rgb(),a=1===(t=t.round("number"==typeof e?e:1)).valpha?t.color:t.color.concat(this.valpha);return r.to[t.model](a)},percentString:function(e){var t=this.rgb().round("number"==typeof e?e:1),a=1===t.valpha?t.color:t.color.concat(this.valpha);return r.to.rgb.percent(a)},array:function(){return 1===this.valpha?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var e={},t=n[this.model].channels,a=n[this.model].labels,r=0;r<t;r++)e[a[r]]=this.color[r];return 1!==this.valpha&&(e.alpha=this.valpha),e},unitArray:function(){var e=this.rgb().color;return e[0]/=255,e[1]/=255,e[2]/=255,1!==this.valpha&&e.push(this.valpha),e},unitObject:function(){var e=this.rgb().object();return e.r/=255,e.g/=255,e.b/=255,1!==this.valpha&&(e.alpha=this.valpha),e},round:function(e){return e=Math.max(e||0,0),new c(this.color.map(function(e){return function(t){return function(e,t){return Number(e.toFixed(t))}(t,e)}}(e)).concat(this.valpha),this.model)},alpha:function(e){return arguments.length?new c(this.color.concat(Math.max(0,Math.min(1,e))),this.model):this.valpha},red:u("rgb",0,d(255)),green:u("rgb",1,d(255)),blue:u("rgb",2,d(255)),hue:u(["hsl","hsv","hsl","hwb","hcg"],0,(function(e){return(e%360+360)%360})),saturationl:u("hsl",1,d(100)),lightness:u("hsl",2,d(100)),saturationv:u("hsv",1,d(100)),value:u("hsv",2,d(100)),chroma:u("hcg",1,d(100)),gray:u("hcg",2,d(100)),white:u("hwb",1,d(100)),wblack:u("hwb",2,d(100)),cyan:u("cmyk",0,d(100)),magenta:u("cmyk",1,d(100)),yellow:u("cmyk",2,d(100)),black:u("cmyk",3,d(100)),x:u("xyz",0,d(100)),y:u("xyz",1,d(100)),z:u("xyz",2,d(100)),l:u("lab",0,d(100)),a:u("lab",1),b:u("lab",2),keyword:function(e){return arguments.length?new c(e):n[this.model].keyword(this.color)},hex:function(e){return arguments.length?new c(e):r.to.hex(this.rgb().round().color)},rgbNumber:function(){var e=this.rgb().color;return(255&e[0])<<16|(255&e[1])<<8|255&e[2]},luminosity:function(){for(var e=this.rgb().color,t=[],a=0;a<e.length;a++){var r=e[a]/255;t[a]=r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4)}return.2126*t[0]+.7152*t[1]+.0722*t[2]},contrast:function(e){var t=this.luminosity(),a=e.luminosity();return t>a?(t+.05)/(a+.05):(a+.05)/(t+.05)},level:function(e){var t=this.contrast(e);return t>=7.1?"AAA":t>=4.5?"AA":""},dark:function(){var e=this.rgb().color;return(299*e[0]+587*e[1]+114*e[2])/1e3<128},light:function(){return!this.dark()},negate:function(){for(var e=this.rgb(),t=0;t<3;t++)e.color[t]=255-e.color[t];return e},lighten:function(e){var t=this.hsl();return t.color[2]+=t.color[2]*e,t},darken:function(e){var t=this.hsl();return t.color[2]-=t.color[2]*e,t},saturate:function(e){var t=this.hsl();return t.color[1]+=t.color[1]*e,t},desaturate:function(e){var t=this.hsl();return t.color[1]-=t.color[1]*e,t},whiten:function(e){var t=this.hwb();return t.color[1]+=t.color[1]*e,t},blacken:function(e){var t=this.hwb();return t.color[2]+=t.color[2]*e,t},grayscale:function(){var e=this.rgb().color,t=.3*e[0]+.59*e[1]+.11*e[2];return c.rgb(t,t,t)},fade:function(e){return this.alpha(this.valpha-this.valpha*e)},opaquer:function(e){return this.alpha(this.valpha+this.valpha*e)},rotate:function(e){var t=this.hsl(),a=t.color[0];return a=(a=(a+e)%360)<0?360+a:a,t.color[0]=a,t},mix:function(e,t){var a=this.rgb(),r=e.rgb(),n=void 0===t?.5:t,i=2*n-1,s=a.alpha()-r.alpha(),o=((i*s==-1?i:(i+s)/(1+i*s))+1)/2,l=1-o;return c.rgb(o*a.red()+l*r.red(),o*a.green()+l*r.green(),o*a.blue()+l*r.blue(),a.alpha()*n+r.alpha()*(1-n))}},Object.keys(n).forEach((function(e){if(-1===s.indexOf(e)){var t=n[e].channels;c.prototype[e]=function(){if(this.model===e)return new c(this);if(arguments.length)return new c(arguments,e);var a="number"==typeof arguments[t]?t:this.valpha;return new c(m(n[this.model][e].raw(this.color)).concat(a),e)},c[e]=function(a){return"number"==typeof a&&(a=p(i.call(arguments),t)),new c(a,e)}}})),e.exports=c},281:function(e,t,a){var r=a(282),n=a(283),i={};for(var s in r)r.hasOwnProperty(s)&&(i[r[s]]=s);var o=e.exports={to:{},get:{}};function l(e,t,a){return Math.min(Math.max(t,e),a)}function c(e){var t=e.toString(16).toUpperCase();return t.length<2?"0"+t:t}o.get=function(e){var t,a;switch(e.substring(0,3).toLowerCase()){case"hsl":t=o.get.hsl(e),a="hsl";break;case"hwb":t=o.get.hwb(e),a="hwb";break;default:t=o.get.rgb(e),a="rgb"}return t?{model:a,value:t}:null},o.get.rgb=function(e){if(!e)return null;var t,a,n,i=[0,0,0,1];if(t=e.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(n=t[2],t=t[1],a=0;a<3;a++){var s=2*a;i[a]=parseInt(t.slice(s,s+2),16)}n&&(i[3]=parseInt(n,16)/255)}else if(t=e.match(/^#([a-f0-9]{3,4})$/i)){for(n=(t=t[1])[3],a=0;a<3;a++)i[a]=parseInt(t[a]+t[a],16);n&&(i[3]=parseInt(n+n,16)/255)}else if(t=e.match(/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)){for(a=0;a<3;a++)i[a]=parseInt(t[a+1],0);t[4]&&(i[3]=parseFloat(t[4]))}else{if(!(t=e.match(/^rgba?\(\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*,\s*([+-]?[\d\.]+)\%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/)))return(t=e.match(/(\D+)/))?"transparent"===t[1]?[0,0,0,0]:(i=r[t[1]])?(i[3]=1,i):null:null;for(a=0;a<3;a++)i[a]=Math.round(2.55*parseFloat(t[a+1]));t[4]&&(i[3]=parseFloat(t[4]))}for(a=0;a<3;a++)i[a]=l(i[a],0,255);return i[3]=l(i[3],0,1),i},o.get.hsl=function(e){if(!e)return null;var t=e.match(/^hsla?\(\s*([+-]?(?:\d{0,3}\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var a=parseFloat(t[4]);return[(parseFloat(t[1])+360)%360,l(parseFloat(t[2]),0,100),l(parseFloat(t[3]),0,100),l(isNaN(a)?1:a,0,1)]}return null},o.get.hwb=function(e){if(!e)return null;var t=e.match(/^hwb\(\s*([+-]?\d{0,3}(?:\.\d+)?)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(t){var a=parseFloat(t[4]);return[(parseFloat(t[1])%360+360)%360,l(parseFloat(t[2]),0,100),l(parseFloat(t[3]),0,100),l(isNaN(a)?1:a,0,1)]}return null},o.to.hex=function(){var e=n(arguments);return"#"+c(e[0])+c(e[1])+c(e[2])+(e[3]<1?c(Math.round(255*e[3])):"")},o.to.rgb=function(){var e=n(arguments);return e.length<4||1===e[3]?"rgb("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+")":"rgba("+Math.round(e[0])+", "+Math.round(e[1])+", "+Math.round(e[2])+", "+e[3]+")"},o.to.rgb.percent=function(){var e=n(arguments),t=Math.round(e[0]/255*100),a=Math.round(e[1]/255*100),r=Math.round(e[2]/255*100);return e.length<4||1===e[3]?"rgb("+t+"%, "+a+"%, "+r+"%)":"rgba("+t+"%, "+a+"%, "+r+"%, "+e[3]+")"},o.to.hsl=function(){var e=n(arguments);return e.length<4||1===e[3]?"hsl("+e[0]+", "+e[1]+"%, "+e[2]+"%)":"hsla("+e[0]+", "+e[1]+"%, "+e[2]+"%, "+e[3]+")"},o.to.hwb=function(){var e=n(arguments),t="";return e.length>=4&&1!==e[3]&&(t=", "+e[3]),"hwb("+e[0]+", "+e[1]+"%, "+e[2]+"%"+t+")"},o.to.keyword=function(e){return i[e.slice(0,3)]}},282:function(e,t,a){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},283:function(e,t,a){"use strict";var r=a(284),n=Array.prototype.concat,i=Array.prototype.slice,s=e.exports=function(e){for(var t=[],a=0,s=e.length;a<s;a++){var o=e[a];r(o)?t=n.call(t,i.call(o)):t.push(o)}return t};s.wrap=function(e){return function(){return e(s(arguments))}}},284:function(e,t){e.exports=function(e){return!(!e||"string"==typeof e)&&(e instanceof Array||Array.isArray(e)||e.length>=0&&(e.splice instanceof Function||Object.getOwnPropertyDescriptor(e,e.length-1)&&"String"!==e.constructor.name))}},285:function(e,t,a){var r=a(223),n=a(287),i={};Object.keys(r).forEach((function(e){i[e]={},Object.defineProperty(i[e],"channels",{value:r[e].channels}),Object.defineProperty(i[e],"labels",{value:r[e].labels});var t=n(e);Object.keys(t).forEach((function(a){var r=t[a];i[e][a]=function(e){var t=function(t){if(null==t)return t;arguments.length>1&&(t=Array.prototype.slice.call(arguments));var a=e(t);if("object"==typeof a)for(var r=a.length,n=0;n<r;n++)a[n]=Math.round(a[n]);return a};return"conversion"in e&&(t.conversion=e.conversion),t}(r),i[e][a].raw=function(e){var t=function(t){return null==t?t:(arguments.length>1&&(t=Array.prototype.slice.call(arguments)),e(t))};return"conversion"in e&&(t.conversion=e.conversion),t}(r)}))})),e.exports=i},286:function(e,t,a){"use strict";e.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},287:function(e,t,a){var r=a(223);function n(e){var t=function(){for(var e={},t=Object.keys(r),a=t.length,n=0;n<a;n++)e[t[n]]={distance:-1,parent:null};return e}(),a=[e];for(t[e].distance=0;a.length;)for(var n=a.pop(),i=Object.keys(r[n]),s=i.length,o=0;o<s;o++){var l=i[o],c=t[l];-1===c.distance&&(c.distance=t[n].distance+1,c.parent=n,a.unshift(l))}return t}function i(e,t){return function(a){return t(e(a))}}function s(e,t){for(var a=[t[e].parent,e],n=r[t[e].parent][e],s=t[e].parent;t[s].parent;)a.unshift(t[s].parent),n=i(r[t[s].parent][s],n),s=t[s].parent;return n.conversion=a,n}e.exports=function(e){for(var t=n(e),a={},r=Object.keys(t),i=r.length,o=0;o<i;o++){var l=r[o];null!==t[l].parent&&(a[l]=s(l,t))}return a}},289:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return $c}));var r=a(2),n=a.n(r),i=a(25),s=a.n(i),o=a(68),l=a(38),c=(a(185),a(188)),u=a(83),d=a.n(u),m=a(65),p=a.n(m),g=a(10),f=a.n(g),b=a(0),h=a(28),y=a(21),E=a(22),v=a(99),x=a(105);const k=e=>{const t=f.a.parse(e.from.toString()),a=f.a.parse(e.to.toString(),{roundUp:!0});return{...e,from:t&&t.valueOf()||p()().subtract(1,"hour").valueOf(),to:a&&a.valueOf()||p()().valueOf()}},O={from:"now-1h",to:"now",interval:">=1m"},M={time:O,autoReload:!1,refreshInterval:5e3},w=b.type({from:b.union([b.string,b.number]),to:b.union([b.string,b.number]),interval:b.string}),j=b.partial({time:w,autoReload:b.boolean,refreshInterval:b.number}),S=j.encode,C=e=>Object(h.pipe)(j.decode(e),Object(y.fold)(Object(E.constant)(void 0),E.identity)),T=(e,t)=>Number.isNaN(e)||Number.isNaN(t)?e=>e:Object(x.d)("metricTime",{autoReload:!1,time:{interval:">=1m",from:p()(e).toISOString(),to:p()(t).toISOString()}}),F=d()((()=>{const[e,t]=Object(v.b)({defaultState:M,decodeUrlState:C,encodeUrlState:S,urlStateKey:"metricTime"}),[a,n]=Object(r.useState)(e.autoReload||!1),[i,s]=Object(r.useState)(e.refreshInterval||5e3),[o,l]=Object(r.useState)(p()().valueOf()),[c,u]=Object(r.useState)(e.time||O);Object(r.useEffect)((()=>t({time:c,autoReload:a,refreshInterval:i})),[a,i,t,c]);const[d,m]=Object(r.useState)(k(e.time||O)),g=Object(r.useCallback)((e=>{u(e),m(k(e))}),[]);return{timeRange:c,setTimeRange:g,parsedTimeRange:d,refreshInterval:i,setRefreshInterval:s,isAutoReloading:a,setAutoReload:n,lastRefresh:o,triggerRefresh:Object(r.useCallback)((()=>l(p()().valueOf())),[l])}})),[L,P]=F;var I=a(135);const D=({match:{params:{nodeId:e,nodeType:t}},location:a})=>{const r=T(Object(I.b)(a),Object(I.d)(a))("");return n.a.createElement(o.Redirect,{to:`/detail/${t}/${e}?${r}`})},_=({nodeType:e,nodeId:t,to:a,from:r})=>({app:"metrics",pathname:`link-to/${e}-detail/${t}`,search:a&&r?{to:`${a}`,from:`${r}`}:void 0});var R=a(1),A=a(4);var B=a(106),N=a(13),V=a(18),z=a(17),$=a(170);const U=Object(z.euiStyled)($.b)`
  overflow: auto;
  background-color: ${e=>e.theme.eui.euiColorLightestShade};
`,H=({message:e})=>n.a.createElement($.a,null,n.a.createElement(U,null,n.a.createElement(q,{message:e}))),q=({message:e})=>n.a.createElement(N.EuiPage,{style:{flex:"1 0 auto"}},n.a.createElement(N.EuiPageBody,null,n.a.createElement(N.EuiPageHeader,null,n.a.createElement(N.EuiPageHeaderSection,null,n.a.createElement(N.EuiTitle,{size:"m"},n.a.createElement("h1",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.errorPage.unexpectedErrorTitle",defaultMessage:"Oops!"}))))),n.a.createElement(N.EuiPageContent,null,n.a.createElement(N.EuiCallOut,{color:"danger",title:e,iconType:"alert"},n.a.createElement("p",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.errorPage.tryAgainDescription ",defaultMessage:"Please click the back button and try again."}))))));var J=a(133);const G=({match:{params:{hostIp:e}},location:t})=>{const{source:a}=Object(J.a)({sourceId:"default"}),{error:i,name:s}=((e,t)=>{var a;const n=null===(a=Object(A.useKibana)().services.http)||void 0===a?void 0:a.fetch,[i,s]=Object(r.useState)(null),[o,l]=Object(r.useState)(!0),[c,u]=Object(r.useState)(null);return Object(r.useEffect)((()=>{(async()=>{l(!0),s(null);try{if(!n)throw new Error("HTTP service is unavailable");if(e&&t){const a=await n("/api/infra/ip_to_host",{method:"POST",body:JSON.stringify({ip:e,index_pattern:t})});l(!1),u(a)}}catch(e){l(!1),s(e)}})()}),[e,t,n]),{name:c&&c.host||null,loading:o,error:i}})(e,a&&a.configuration&&a.configuration.metricAlias||null);if(i)return n.a.createElement(H,{message:R.i18n.translate("xpack.infra.linkTo.hostWithIp.error",{defaultMessage:'Host not found with IP address "{hostIp}".',values:{hostIp:e}})});const l=T(Object(I.b)(t),Object(I.d)(t))("");return s?n.a.createElement(o.Redirect,{to:`/detail/host/${s}?${l}`}):n.a.createElement(B.a,{message:R.i18n.translate("xpack.infra.linkTo.hostWithIp.loading",{defaultMessage:'Loading host with IP address "{hostIp}".',values:{hostIp:e}})})};var K=a(23);const W=({location:e})=>{const t=function(e){if(0===e.length)return{};const t=Object(K.parse)(e.substring(1));for(const e in t)Object.hasOwnProperty.call(t,e)&&(t[e]||delete t[e],Array.isArray(t.key)&&(t[e]=t[e][0]));return t}(e.search),a="?waffleFilter=(expression:'',kind:kuery)&waffleTime=(currentTime:{timestamp},isAutoReloading:!f)&waffleOptions=(accountId:'',autoBounds:!t,boundsOverride:(max:1,min:0),customMetrics:!({customMetric}),customOptions:!(),groupBy:!(),legend:(palette:cool,reverseColors:!f,steps:10),metric:{metric},nodeType:{nodeType},region:'',sort:(by:name,direction:desc),timelineOpen:!f,view:map)".replace(/{(\w+)}/g,((e,a)=>t[a]||""));return n.a.createElement(o.Redirect,{to:"/inventory"+a})};var Q=a(88);const X=Q.d.map((e=>e.id)).join("|"),Y=e=>n.a.createElement(o.Switch,null,n.a.createElement(o.Route,{path:`${e.match.url}/:nodeType(${X})-detail/:nodeId`,component:D}),n.a.createElement(o.Route,{path:`${e.match.url}/host-detail-via-ip/:hostIp`,component:G}),n.a.createElement(o.Route,{path:`${e.match.url}/inventory`,component:W}),n.a.createElement(o.Redirect,{to:"/"}));var Z=a(33),ee=a.n(Z),te=a(107),ae=a(197),re=a(211),ne=a(94),ie=a(75),se=a(266);const oe=()=>{const{options:e,chartOptions:t,setChartOptions:a,currentTimerange:i,setOptions:s,setTimeRange:o}=Object(r.useContext)(ne.c.Context),l=Object(r.useMemo)((()=>({options:e,chartOptions:t,timerange:i})),[e,t,i]),c=e=>{var t;e&&e.options&&(t=e.options,s(t)),e&&e.timerange&&o(e.timerange),e&&e.chartOptions&&a(e.chartOptions)};return n.a.createElement(x.a,{urlState:l,urlStateKey:"metricsExplorer",mapToUrlState:le,onChange:c,onInitialize:c,populateWithInitialState:!0})};const le=e=>{const t={};if(e)return e.options&&function(e){const t=ne.e.decode(e);try{return se.ThrowReporter.report(t),!0}catch(e){return!1}}(e.options)&&(e.options.source="url",Object(ie.set)(t,"options",e.options)),e.timerange&&function(e){const t=ne.g.decode(e);try{return se.ThrowReporter.report(t),!0}catch(e){return!1}}(e.timerange)&&Object(ie.set)(t,"timerange",e.timerange),e.chartOptions&&function(e){const t=ne.f.decode(e);try{return se.ThrowReporter.report(t),!0}catch(e){return!1}}(e.chartOptions)&&Object(ie.set)(t,"chartOptions",e.chartOptions),t};var ce=a(85);const ue=({children:e})=>{const{createSourceConfiguration:t,createDerivedIndexPattern:a,source:n,sourceExists:i,sourceId:s,metricIndicesExist:o,isLoading:l,loadSource:c,hasFailedLoadingSource:u,loadSourceFailureMessage:d,updateSourceConfiguration:m,version:p}=Object(r.useContext)(ce.a.Context);return e({create:t,configuration:n&&n.configuration,createDerivedIndexPattern:a,exists:i,hasFailed:u,isLoading:l,lastFailureMessage:d,load:c,metricIndicesExist:o,sourceId:s,update:m,version:p})};var de=a(66),me=a(199),pe=a(5),ge=a(95);const fe=e=>{Object(me.a)(pe.e,ge.f,e)};var be=a(158),he=a(130),ye=a(166),Ee=a(67),ve=a(27),xe=a(131),ke=a(117),Oe=a(24),Me=a(6),we=a(122);const je=e=>{const{visible:t,setVisible:a}=e,{triggersActionsUI:i}=Object(r.useContext)(Oe.a),s=Object(r.useCallback)((()=>a(!1)),[a]),o=Object(r.useMemo)((()=>i&&i.getAddAlertFlyout({consumer:"infrastructure",onClose:s,canChangeTrigger:!1,alertTypeId:Me.d,metadata:{currentOptions:e.options,series:e.series}})),[i,s]);return n.a.createElement(n.a.Fragment,null,t&&o)},Se=({onClose:e})=>{const{metricThresholdPrefill:t}=Object(we.b)(),{groupBy:a,filterQuery:r,metrics:i}=t;return n.a.createElement(je,{options:{groupBy:a,filterQuery:r,metrics:i},visible:!0,setVisible:e})};var Ce=a(15),Te=a(41),Fe=a.n(Te),Le=a(90),Pe=a(212),Ie=a(35),De=a(213);const _e="metric*",Re=e=>{if("rate"===e.aggregation){const t=Fe.a.v1(),a=Fe.a.v1(),r=Fe.a.v1();return[{id:t,type:"max",field:e.field||void 0},{id:r,type:"derivative",field:t,unit:"1s"},{id:a,type:"positive_only",field:r}]}if("p95"===e.aggregation||"p99"===e.aggregation){const t="p95"===e.aggregation?"95":"99";return[{id:Fe.a.v1(),type:"percentile",field:e.field,percentiles:[{id:Fe.a.v1(),value:t,mode:"line",percentile:"",shade:.2}]}]}return[{id:Fe.a.v1(),type:e.aggregation,field:e.field||void 0}]},Ae=e=>t=>{const a=Object(Pe.a)(t);return{label:Object(De.a)(t),axis_position:"right",chart_type:"line",color:t.color&&Object(Le.b)(t.color)||Object(Le.b)(Le.a.color0),fill:e.type===ne.b.area?.5:0,formatter:a===Ie.b.bits?Ie.b.bytes:a,value_template:"rate"===t.aggregation?"{{value}}/s":"{{value}}",id:Fe.a.v1(),line_width:2,metrics:Re(t),point_size:0,separate_axis:0,split_mode:"everything",stacked:e.stack?"stacked":"none"}},Be=(e,t)=>{const a=[];if(e.filterQuery&&a.push(e.filterQuery),e.groupBy){const r=t.id.replace('"','\\"'),n=Array.isArray(e.groupBy)?e.groupBy.map(((e,a)=>{if(!t.keys)return null;const r=t.keys[a];return r?`${e}: "${r.replace('"','\\"')}"`:null})).join(" and "):`${e.groupBy} : "${r}"`;a.push(n)}return{language:"kuery",query:a.join(" and ")}},Ne=(e,t,a,r,n)=>{const i=(s=e&&e.metricAlias||_e).split(",").length>1?_e:s;var s;const o={filters:[],linked:!1,query:{language:"kuery",query:""},uiState:{},vis:{aggs:[],params:{axis_formatter:"number",axis_position:"left",axis_scale:"normal",id:Fe.a.v1(),default_index_pattern:i,index_pattern:i,interval:"auto",series:t.metrics.map(Ae(n)),show_grid:1,show_legend:1,time_field:pe.i,type:"timeseries",filter:Be(t,a)},title:a.id,type:"metrics"}};n.yAxisMode===ne.d.fromZero&&Object(ie.set)(o,"vis.params.axis_min",0);const l={refreshInterval:{pause:!0,value:0},time:{from:r.from,to:r.to}};return{app:"visualize",hash:"/create",search:{type:"metrics",_g:Object(Ce.encode)(l),_a:Object(Ce.encode)(o)}}};var Ve=a(34);const ze=(e,t=!1)=>{const a=f.a.parse(e,{roundUp:t});if(!a)throw new Error(`"${e}" is not a valid time string`);return a.valueOf()},$e=(e,t,a,r)=>_({nodeType:e,nodeId:t,from:ze(a),to:ze(r,!0)}),Ue=({onFilter:e,options:t,series:a,source:i,timeRange:s,uiCapabilities:o,chartOptions:l})=>{var c,u;const[d,m]=Object(r.useState)(!1),[p,g]=Object(r.useState)(!1),f=null!=t.groupBy&&null!=e,b=Object(r.useCallback)((()=>{f&&e&&(Array.isArray(t.groupBy)?e(t.groupBy.map(((e,t)=>{var r;return`${e}: "${null===(r=a.keys)||void 0===r?void 0:r[t]}"`})).join(" and ")):e(`${t.groupBy}: "${a.id}"`)),m(!1)}),[f,e,t,a.keys,a.id]),h=f?[{name:R.i18n.translate("xpack.infra.metricsExplorer.filterByLabel",{defaultMessage:"Add filter"}),icon:"metricsApp",onClick:b,"data-test-subj":"metricsExplorerAction-AddFilter"}]:[],y=i&&t.groupBy&&((e,t)=>{const a=Array.isArray(t)?t:[t];return a.includes(pe.c)?"host":a.includes(pe.g)?"pod":a.includes(pe.a)?"container":void 0})(0,t.groupBy),E=Object(Ve.b)({app:"metrics",...y?$e(y,a.id,s.from,s.to):{}}),v=Object(Ve.b)({...Ne(i,t,a,s,l)}),x=y?[{name:R.i18n.translate("xpack.infra.metricsExplorer.viewNodeDetail",{defaultMessage:"View metrics for {name}",values:{name:y}}),icon:"metricsApp",...y?E:{},"data-test-subj":"metricsExplorerAction-ViewNodeMetrics"}]:[],k=[...h,...null!=o&&null!==(c=o.visualize)&&void 0!==c&&c.show?[{name:R.i18n.translate("xpack.infra.metricsExplorer.openInTSVB",{defaultMessage:"Open in Visualize"}),...v,icon:"visualizeApp",disabled:0===t.metrics.length,"data-test-subj":"metricsExplorerAction-OpenInTSVB"}]:[],...x,...null!=o&&null!==(u=o.infrastructure)&&void 0!==u&&u.save?[{name:R.i18n.translate("xpack.infra.metricsExplorer.alerts.createRuleButton",{defaultMessage:"Create threshold rule"}),icon:"bell",onClick(){g(!0)}}]:[]];if(0===k.length)return null;const O=[{id:0,title:"Actions",items:k}],M=R.i18n.translate("xpack.infra.metricsExplorer.actionsLabel.aria",{defaultMessage:"Actions for {grouping}",values:{grouping:a.id}}),w=R.i18n.translate("xpack.infra.metricsExplorer.actionsLabel.button",{defaultMessage:"Actions"}),j=n.a.createElement(N.EuiButtonEmpty,{contentProps:{"aria-label":M},onClick:()=>m(!0),size:"s",iconType:"arrowDown",iconSide:"right"},w);return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiPopover,{closePopover:()=>m(!1),id:`${a.id}-popover`,button:j,isOpen:d,panelPaddingSize:"none"},n.a.createElement(N.EuiContextMenu,{initialPanelId:0,panels:O}),n.a.createElement(je,{series:a,options:t,setVisible:g,visible:p})))},He=()=>n.a.createElement(N.EuiEmptyPrompt,{iconType:"stats",title:n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.emptyChart.title",defaultMessage:"Chart Data Missing"})),body:n.a.createElement("p",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.emptyChart.body",defaultMessage:"Unable to render chart."}))}),qe=()=>n.a.createElement(N.EuiEmptyPrompt,{"data-test-subj":"metricsExplorer-missingMetricMessage",iconType:"stats",title:n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.noMetrics.title",defaultMessage:"Missing Metric"})),body:n.a.createElement("p",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.noMetrics.body",defaultMessage:"Please choose a metric above."}))});function Je(e){return e?Ee.DARK_THEME:Ee.LIGHT_THEME}function Ge(e){return e?Ee.DARK_THEME:Object(Ee.mergeWithDefaultTheme)(Ke,Ee.LIGHT_THEME)}const Ke={crosshair:{band:{fill:"#D3DAE6"}},axes:{gridLine:{horizontal:{stroke:"#eaeaea"}}}};var We=a(110),Qe=a(118);const Xe=R.i18n.translate("xpack.infra.metricsExplorer.everything",{defaultMessage:"Everything"}),Ye=({series:e})=>{if(null!=e.keys){const{keys:t}=e;return n.a.createElement(N.EuiFlexGroup,{gutterSize:"xs"},t.map(((e,a)=>n.a.createElement(r.Fragment,{key:e},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiText,{size:"m",color:t.length-1>a?"subdued":"default"},n.a.createElement("strong",null,"*"===e?Xe:e))),t.length-1>a&&n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiText,{size:"m",color:"subdued"},n.a.createElement("span",null,"/")))))))}return n.a.createElement("span",null,e.id)},Ze=({source:e,options:t,chartOptions:a,series:i,title:s,onFilter:o,height:l=200,width:c="100%",timeRange:u,onTimeChange:d})=>{var m;const g=null===(m=Object(A.useKibana)().services.application)||void 0===m?void 0:m.capabilities,f=Object(A.useUiSetting)("theme:darkMode"),{metrics:b}=t,[h]=Object(We.a)("dateFormat"),y=Object(r.useMemo)((()=>{const e=Object(ve.first)(i.rows),t=Object(ve.last)(i.rows);return e&&t?Object(Ee.niceTimeFormatter)([e.timestamp,t.timestamp]):e=>`${e}`}),[i.rows]),E={headerFormatter:Object(r.useCallback)((e=>p()(e.value).format(h||"Y-MM-DD HH:mm:ss.SSS")),[h])},v=Object(r.useCallback)(Object(xe.a)(Object(ve.first)(b)),[t]),x=Object(Qe.a)(i,b,a.stack),k=a.yAxisMode===ne.d.fromZero?{...x,min:0}:x;return n.a.createElement("div",{style:{padding:24},"data-test-subj":"metricsExplorer-chart"},t.groupBy?n.a.createElement(N.EuiTitle,{size:"xs"},n.a.createElement(N.EuiFlexGroup,{alignItems:"center"},n.a.createElement(et,null,n.a.createElement(N.EuiToolTip,{content:s,anchorClassName:"metricsExplorerTitleAnchor"},n.a.createElement(Ye,{series:i}))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(Ue,{timeRange:u,options:t,chartOptions:a,series:i,onFilter:o,source:e,uiCapabilities:g})))):n.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd"},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(Ue,{options:t,chartOptions:a,series:i,source:e,timeRange:u,uiCapabilities:g}))),n.a.createElement("div",{className:"metricsExplorerChart",style:{height:l,width:c}},b.length&&i.rows.length>0?n.a.createElement(Ee.Chart,null,b.map(((e,t)=>n.a.createElement(ke.a,{type:a.type,key:t,metric:e,id:t,series:i,stack:a.stack}))),n.a.createElement(Ee.Axis,{id:"timestamp",position:Ee.Position.Bottom,showOverlappingTicks:!0,tickFormat:y}),n.a.createElement(Ee.Axis,{id:"values",position:Ee.Position.Left,tickFormat:v,domain:k}),n.a.createElement(Ee.Settings,{tooltip:E,onBrushEnd:({x:e})=>{if(!e)return;const[t,a]=e;d(p()(t).toISOString(),p()(a).toISOString())},theme:Je(f)})):t.metrics.length>0?n.a.createElement(He,null):n.a.createElement(qe,null)))},et=z.euiStyled.div`
  width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  text-align: left;
  flex: 1 1 auto;
  margin: 12px;
`,tt=({loading:e,data:t,onLoadMore:a,options:r,chartOptions:i,onRefetch:s,onFilter:o,source:l,timeRange:c,onTimeChange:u})=>{if(e)return n.a.createElement(he.a,{height:800,width:"100%",text:R.i18n.translate("xpack.infra.metricsExplorer.loadingCharts",{defaultMessage:"Loading charts"})});if(!t||0===t.series.length)return n.a.createElement(ye.a,{titleText:R.i18n.translate("xpack.infra.metricsExplorer.noDataTitle",{defaultMessage:"There is no data to display."}),bodyText:R.i18n.translate("xpack.infra.metricsExplorer.noDataBodyText",{defaultMessage:"Try adjusting your time, filters or group by settings."}),refetchText:R.i18n.translate("xpack.infra.metricsExplorer.noDataRefetchText",{defaultMessage:"Check for new data"}),testString:"metrics-explorer-no-data",onRefetch:s});const d=R.i18n.translate("xpack.infra.metricsExplorer.andLabel",{defaultMessage:'" and "'});return n.a.createElement("div",{style:{width:"100%"}},n.a.createElement(N.EuiFlexGrid,{gutterSize:"s",columns:1===t.series.length?1:3},t.series.map((e=>n.a.createElement(N.EuiFlexItem,{key:e.id,style:{minWidth:0}},n.a.createElement(Ze,{key:`chart-${e.id}`,onFilter:o,options:r,chartOptions:i,title:r.groupBy?e.id:null,height:t.series.length>1?200:400,series:e,source:l,timeRange:c,onTimeChange:u}))))),t.series.length>1?n.a.createElement("div",{style:{textAlign:"center",marginBottom:16}},n.a.createElement(N.EuiHorizontalRule,null),n.a.createElement(N.EuiText,{color:"subdued"},n.a.createElement("p",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.footerPaginationMessage",defaultMessage:'Displaying {length} of {total} charts grouped by "{groupBy}".',values:{length:t.series.length,total:t.pageInfo.total,groupBy:Array.isArray(r.groupBy)?r.groupBy.join(d):r.groupBy}}))),t.pageInfo.afterKey?n.a.createElement("div",{style:{margin:"16px 0"}},n.a.createElement(N.EuiButton,{isLoading:e,size:"s",onClick:()=>a(t.pageInfo.afterKey||null)},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.loadMoreChartsButton",defaultMessage:"Load More Charts"}))):null):null)};var at=a(70),rt=a(147);const nt=({options:e,onChange:t,fields:a,autoFocus:i=!1})=>{const s=Object.keys(Le.a),[o,l]=Object(r.useState)(i),c=Object(r.useCallback)((e=>{e&&o&&(e.focus(),l(!1))}),[o]),u=Object(r.useCallback)((a=>{t(a.map(((t,a)=>({aggregation:e.aggregation,field:t.value,color:s[a]}))))}),[t,e.aggregation,s]),d=a.map((e=>({label:e.name,value:e.name}))),m=e.metrics.filter((e=>"count"!==e.aggregation)).map((e=>({label:e.field||"",value:e.field||"",color:Object(Le.b)(e.color||Le.a.color0)}))),p=R.i18n.translate("xpack.infra.metricsExplorer.metricComboBoxPlaceholder",{defaultMessage:"choose a metric to plot"});return n.a.createElement(N.EuiComboBox,{"data-test-subj":"metricsExplorer-metrics","aria-label":p,isDisabled:"count"===e.aggregation,placeholder:p,fullWidth:!0,options:d,selectedOptions:m,onChange:u,isClearable:!0,inputRef:c})};var it=a(173),st=a(98);const ot=({options:e,onChange:t})=>{const a={avg:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.avg",{defaultMessage:"Average"}),sum:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.sum",{defaultMessage:"Sum"}),max:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.max",{defaultMessage:"Max"}),min:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.min",{defaultMessage:"Min"}),cardinality:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.cardinality",{defaultMessage:"Cardinality"}),rate:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.rate",{defaultMessage:"Rate"}),p95:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.p95",{defaultMessage:"95th Percentile"}),p99:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.p99",{defaultMessage:"99th Percentile"}),count:R.i18n.translate("xpack.infra.metricsExplorer.aggregationLables.count",{defaultMessage:"Document count"})},i=Object(r.useCallback)((e=>{const a=st.c.is(e.target.value)&&e.target.value||"avg";t(a)}),[t]),s=R.i18n.translate("xpack.infra.metricsExplorer.aggregationSelectLabel",{defaultMessage:"Select an aggregation"});return n.a.createElement(N.EuiSelect,{"aria-label":s,placeholder:s,fullWidth:!0,value:e.aggregation,options:st.a.map((e=>({text:a[e],value:e}))),onChange:i})},lt=({chartOptions:e,onChange:t})=>{const[a,i]=Object(r.useState)(!1),s=Object(r.useCallback)((()=>{i(!1)}),[]),o=Object(r.useCallback)((()=>{i(!0)}),[]),l=n.a.createElement(N.EuiButtonEmpty,{iconSide:"left",iconType:"eye",onClick:o,"data-test-subj":"metricsExplorer-customize"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.customizeChartOptions",defaultMessage:"Customize"})),c=[{id:ne.d.auto,label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.autoLabel",{defaultMessage:"Automatic (min to max)"})},{id:ne.d.fromZero,label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.fromZeroLabel",{defaultMessage:"From zero (0 to max)"})}],u=[{"data-test-subj":"metricsExplorer-chartRadio-line",id:ne.b.line,label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.lineLabel",{defaultMessage:"Line"})},{"data-test-subj":"metricsExplorer-chartRadio-area",id:ne.b.area,label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.areaLabel",{defaultMessage:"Area"})},{"data-test-subj":"metricsExplorer-chartRadio-bar",id:ne.b.bar,label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.barLabel",{defaultMessage:"Bar"})}],d=Object(r.useCallback)((a=>{t({...e,yAxisMode:a})}),[e,t]),m=Object(r.useCallback)((a=>{t({...e,type:a})}),[e,t]),p=Object(r.useCallback)((a=>{t({...e,stack:a.target.checked})}),[e,t]);return n.a.createElement(N.EuiPopover,{id:"MetricExplorerChartOptionsPopover",button:l,isOpen:a,closePopover:s},n.a.createElement(N.EuiForm,null,n.a.createElement(N.EuiFormRow,{display:"rowCompressed",label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.typeLabel",{defaultMessage:"Chart style"})},n.a.createElement(N.EuiRadioGroup,{compressed:!0,options:u,idSelected:e.type,onChange:m})),n.a.createElement(N.EuiFormRow,{display:"rowCompressed",label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.stackLabel",{defaultMessage:"Stack series"})},n.a.createElement(N.EuiSwitch,{label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.stackSwitchLabel",{defaultMessage:"Stack"}),checked:e.stack,onChange:p})),n.a.createElement(N.EuiFormRow,{display:"rowCompressed",label:R.i18n.translate("xpack.infra.metricsExplorer.chartOptions.yAxisDomainLabel",{defaultMessage:"Y Axis Domain"})},n.a.createElement(N.EuiRadioGroup,{compressed:!0,options:c,idSelected:e.yAxisMode,onChange:d}))))},ct=e=>e?e.map((e=>({start:e.from,end:e.to,label:e.display}))):[],ut=({timeRange:e,derivedIndexPattern:t,options:a,onTimeChange:r,onRefresh:i,onGroupByChange:s,onFilterQuerySubmit:o,onMetricsChange:l,onAggregationChange:c,chartOptions:u,onChartOptionsChange:d})=>{const m="avg"===a.aggregation&&0===a.metrics.length,[p]=Object(We.a)(at.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),g=ct(p);return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlexGroup,{alignItems:"center"},n.a.createElement(N.EuiFlexItem,{grow:"count"===a.aggregation&&2},n.a.createElement(ot,{fullWidth:!0,options:a,onChange:c})),"count"!==a.aggregation&&n.a.createElement(N.EuiText,{size:"s",color:"subdued"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.aggregationLabel",defaultMessage:"of"})),"count"!==a.aggregation&&n.a.createElement(N.EuiFlexItem,{grow:2},n.a.createElement(nt,{autoFocus:m,fields:t.fields,options:a,onChange:l})),n.a.createElement(N.EuiText,{size:"s",color:"subdued"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metricsExplorer.groupByToolbarLabel",defaultMessage:"graph per"})),n.a.createElement(N.EuiFlexItem,{grow:1},n.a.createElement(it.a,{onChange:s,fields:t.fields,options:a}))),n.a.createElement(N.EuiFlexGroup,{alignItems:"center"},n.a.createElement(N.EuiFlexItem,null,n.a.createElement(rt.a,{derivedIndexPattern:t,onSubmit:o,value:a.filterQuery})),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(lt,{onChange:d,chartOptions:u})),n.a.createElement(N.EuiFlexItem,{grow:!1,style:{marginRight:5}},n.a.createElement(N.EuiSuperDatePicker,{start:e.from,end:e.to,onTimeChange:({start:e,end:t})=>r(e,t),onRefresh:i,commonlyUsedRanges:g}))))};var dt=a(174);const mt=({errors:e,name:t,onChange:a,value:r})=>({error:e,isInvalid:e.length>0,name:t,onChange:e=>a(e.currentTarget.value),value:r}),pt=e=>""===e?[n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.fieldEmptyErrorMessage",defaultMessage:"The field must not be empty"})]:[],gt={name:"",description:"",metricAlias:"",anomalyThreshold:0},ft=e=>{const t=(({initialFormState:e=gt})=>{const[t,a]=Object(r.useState)({}),n=Object(r.useCallback)((()=>a({})),[]),i=Object(r.useMemo)((()=>({...e,...t})),[e,t]),s=Object(r.useMemo)((()=>mt({errors:pt(i.name),name:"name",onChange:e=>a((t=>({...t,name:e}))),value:i.name})),[i.name]),o=Object(r.useMemo)((()=>mt({errors:pt(i.metricAlias),name:"metricAlias",onChange:e=>a((t=>({...t,metricAlias:e}))),value:i.metricAlias})),[i.metricAlias]),l=Object(r.useMemo)((()=>(({errors:e,name:t,onChange:a,value:r})=>({error:e,isInvalid:e.length>0,name:t,onChange:(e,t)=>a(+e.currentTarget.value,t),value:r}))({errors:pt(i.anomalyThreshold),name:"anomalyThreshold",onChange:e=>a((t=>({...t,anomalyThreshold:e}))),value:i.anomalyThreshold})),[i.anomalyThreshold]),c=Object(r.useMemo)((()=>({name:s,metricAlias:o,anomalyThreshold:l})),[s,o,l]),u=Object(r.useMemo)((()=>Object.values(c).reduce(((e,{error:t})=>[...e,...t]),[])),[c]),d=Object(r.useMemo)((()=>u.length<=0),[u]),m=Object(r.useMemo)((()=>Object.keys(t).length>0),[t]);return{errors:u,fieldProps:c,formState:i,formStateChanges:t,isFormDirty:m,isFormValid:d,resetForm:n}})({initialFormState:Object(r.useMemo)((()=>e?{name:e.name,description:e.description,metricAlias:e.metricAlias,anomalyThreshold:e.anomalyThreshold}:void 0),[e])}),a=Object(r.useMemo)((()=>[...t.errors]),[t.errors]),n=Object(r.useCallback)((()=>{t.resetForm()}),[t]),i=Object(r.useMemo)((()=>t.isFormDirty),[t.isFormDirty]),s=Object(r.useMemo)((()=>t.isFormValid),[t.isFormValid]);return{errors:a,formState:Object(r.useMemo)((()=>({name:t.formState.name,description:t.formState.description,metricAlias:t.formState.metricAlias,anomalyThreshold:t.formState.anomalyThreshold})),[t.formState]),formStateChanges:Object(r.useMemo)((()=>({name:t.formStateChanges.name,description:t.formStateChanges.description,metricAlias:t.formStateChanges.metricAlias,anomalyThreshold:t.formStateChanges.anomalyThreshold})),[t.formStateChanges]),isFormDirty:i,isFormValid:s,indicesConfigurationProps:t.fieldProps,resetForm:n}},bt=b.type({viewId:b.string}),ht={viewId:"0"},yt=d()((e=>{const{source:t,isLoading:a,sourceExists:n,createSourceConfiguration:i,updateSourceConfiguration:s}=Object(r.useContext)(ce.a.Context),{viewType:o,defaultViewState:l}=e,{data:c,loading:u,find:d,error:m,hasView:p}=(e=>{const t=Object(de.useUiTracker)({app:"infra_metrics"}),a=Object(A.useKibana)(),[n,i]=Object(r.useState)(null),[s,o]=Object(r.useState)(null),[l,c]=Object(r.useState)(!1);return{hasView:async t=>{var r;const n=null===(r=a.services.savedObjects)||void 0===r?void 0:r.client;if(!n)throw new Error("Saved objects client is unavailable");return(await n.find({type:e})).savedObjects.find((e=>e.attributes.name===t))},data:n,loading:l,error:s,find:Object(r.useCallback)(((r,n=[])=>{c(!0),(async()=>{try{var s;const l=null===(s=a.services.savedObjects)||void 0===s?void 0:s.client;if(!l)throw new Error("Saved objects client is unavailable");const u=await l.find({type:e,search:r,searchFields:n,page:1,perPage:1e3});o(null),c(!1),i(u),u.total>1e3?t({metric:`over_1000_saved_objects_for_${e}`}):t({metric:`under_1000_saved_objects_for_${e}`})}catch(e){c(!1),o(e)}})()}),[e,a.services.savedObjects,t])}})(o),[g,f]=Object(v.b)({defaultState:ht,decodeUrlState:kt,encodeUrlState:xt,urlStateKey:"savedView"}),[b]=Object(r.useState)(e.shouldLoadDefault),[h,y]=Object(r.useState)(null),[E,x]=Object(r.useState)(null),{create:k,error:O,data:M,createdId:w}=(e=>{const t=Object(A.useKibana)(),[a,n]=Object(r.useState)(null),[i,s]=Object(r.useState)(null),[o,l]=Object(r.useState)(null),[c,u]=Object(r.useState)(!1);return{data:a,loading:c,error:o,create:Object(r.useCallback)(((a,r)=>{u(!0),(async()=>{try{var i;const o=null===(i=t.services.savedObjects)||void 0===i?void 0:i.client;if(!o)throw new Error("Saved objects client is unavailable");const c=await o.create(e,a,r);s(c.id),l(null),n(c),u(!1)}catch(e){u(!1),l(e)}})()}),[e,t.services.savedObjects]),createdId:i}})(o),{update:j,error:S,data:C,updatedId:T}=(e=>{const t=Object(A.useKibana)(),[a,n]=Object(r.useState)(null),[i,s]=Object(r.useState)(null),[o,l]=Object(r.useState)(null),[c,u]=Object(r.useState)(!1);return{data:a,loading:c,error:o,update:Object(r.useCallback)(((a,r,i)=>{u(!0),(async()=>{try{var o;const c=null===(o=t.services.savedObjects)||void 0===o?void 0:o.client;if(!c)throw new Error("Saved objects client is unavailable");const d=await c.update(e,a,r,i);s(d.id),l(null),n(d),u(!1)}catch(e){u(!1),l(e)}})()}),[e,t.services.savedObjects]),updatedId:i}})(o),{deleteObject:F,deletedId:L}=(e=>{const t=Object(A.useKibana)(),[a,n]=Object(r.useState)(null),[i,s]=Object(r.useState)(!1),[o,l]=Object(r.useState)(null);return{loading:i,error:a,deleteObject:Object(r.useCallback)((a=>{s(!0),(async()=>{try{var r;await(null===(r=t.services.savedObjects)||void 0===r?void 0:r.client.delete(e,a)),n(null),l(a),s(!1)}catch(e){s(!1),n(e)}})()}),[e,t.services.savedObjects]),deletedId:o}})(o),{getObject:P,data:I}=(e=>{const t=Object(A.useKibana)(),[a,n]=Object(r.useState)(null),[i,s]=Object(r.useState)(null),[o,l]=Object(r.useState)(!1);return{data:a,loading:o,error:i,getObject:Object(r.useCallback)((a=>{l(!0),(async()=>{try{var r;const i=null===(r=t.services.savedObjects)||void 0===r?void 0:r.client;if(!i)throw new Error("Saved objects client is unavailable");const o=await i.get(e,a);s(null),l(!1),n(o)}catch(e){l(!1),s(e)}})()}),[e,t.services.savedObjects])}})(o),[D,_]=Object(r.useState)(null);Object(r.useEffect)((()=>_(O)),[O]);const B=Object(r.useCallback)((e=>F(e)),[F]),N=ft(t&&t.configuration),V=Object(r.useMemo)((()=>"inventory-view"===o?"inventoryDefaultView":"metricsExplorerDefaultView"),[o]),z=Object(r.useCallback)((async e=>{n?await s({...N.formStateChanges,[V]:e}):await i({...N.formState,[V]:e})}),[N.formState,N.formStateChanges,n,V,i,s]),$=Object(r.useCallback)((e=>{_(null),(async()=>{await p(e.name)?_(R.i18n.translate("xpack.infra.savedView.errorOnCreate.duplicateViewName",{defaultMessage:"A view with that name already exists."})):k(e)})()}),[k,p]),U=Object(r.useCallback)(((e,t)=>{_(null),(async()=>{const a=await p(t.name);a&&a.id!==e?_(R.i18n.translate("xpack.infra.savedView.errorOnCreate.duplicateViewName",{defaultMessage:"A view with that name already exists."})):j(e,t)})()}),[j,p]),H=Object(r.useMemo)((()=>t&&t.configuration?"inventoryDefaultView"===V?t.configuration.inventoryDefaultView:"metricsExplorerDefaultView"===V?t.configuration.metricsExplorerDefaultView:"":""),[t,V]),q=Object(r.useCallback)((e=>({...e.attributes,id:e.id,isDefault:H===e.id})),[H]),J=Object(r.useMemo)((()=>c?c.savedObjects:[]),[c]),G=Object(r.useMemo)((()=>{const e=[{name:R.i18n.translate("xpack.infra.savedView.defaultViewNameHosts",{defaultMessage:"Default view"}),id:"0",isDefault:!H||"0"===H,...l}];return J.forEach((t=>t.type===o&&e.push(q(t)))),e}),[l,J,o,H,q]),K=Object(r.useMemo)((()=>M?q(M):null),[M,q]),W=Object(r.useMemo)((()=>C?q(C):null),[C,q]),Q=Object(r.useCallback)((()=>{x(!0),P(H)}),[x,P,H]);Object(r.useEffect)((()=>{I&&(y(q(I)),x(!1))}),[I,H,q]);const X=Object(r.useCallback)((()=>{y({name:R.i18n.translate("xpack.infra.savedView.defaultViewNameHosts",{defaultMessage:"Default view"}),id:"0",isDefault:!H||"0"===H,...l})}),[y,H,l]),Y=Object(r.useCallback)((()=>{"0"!==H?Q():(X(),x(!1))}),[H,Q,X,x]);return Object(r.useEffect)((()=>{E||h||!b||Y()}),[Y,E,h,b]),Object(r.useEffect)((()=>{h&&g.viewId!==h.id&&c&&f({viewId:h.id})}),[g,f,h,H,c]),Object(r.useEffect)((()=>{if(!h&&!u&&c&&b){const e=G.find((e=>e.id===g.viewId));e?y(e):Y()}}),[u,h,c,G,y,Y,g.viewId,b]),{views:G,saveView:$,defaultViewId:H,loading:u,updateView:U,updatedView:W,updatedId:T,deletedId:L,createdId:w,createdView:K,errorOnUpdate:S,errorOnFind:m,errorOnCreate:D,shouldLoadDefault:b,makeDefault:z,sourceIsLoading:a,deleteView:B,loadingDefaultView:E,setCurrentView:y,currentView:h,loadDefaultView:Q,find:d}})),[Et,vt]=yt,xt=e=>bt.encode(e),kt=e=>Object(h.pipe)(bt.decode(e),Object(y.fold)(Object(E.constant)(void 0),E.identity));var Ot=a(20);const Mt=({hasData:e=!0,"data-test-subj":t,...a})=>{const{services:{observability:{navigation:{PageTemplate:r}},docLinks:i}}=Object(Ot.b)(),s=e?void 0:{solution:R.i18n.translate("xpack.infra.metrics.noDataConfig.solutionName",{defaultMessage:"Observability"}),actions:{beats:{title:R.i18n.translate("xpack.infra.metrics.noDataConfig.beatsCard.title",{defaultMessage:"Add a metrics integration"}),description:R.i18n.translate("xpack.infra.metrics.noDataConfig.beatsCard.description",{defaultMessage:"Use Beats to send metrics data to Elasticsearch. We make it easy with modules for many popular systems and apps."})}},docsLink:i.links.observability.guide};return n.a.createElement(r,ee()({"data-test-subj":e?t:"noDataPage",noDataConfig:s},a))},wt=({close:e,save:t,isInvalid:a})=>{const[i,s]=Object(r.useState)(""),[o,l]=Object(r.useState)(!1),c=Object(r.useCallback)((e=>l(e.target.checked)),[]),u=Object(r.useCallback)((e=>s(e.target.value)),[]),d=Object(r.useCallback)((()=>{t(i,o)}),[o,t,i]);return n.a.createElement(N.EuiModal,{onClose:e,"data-test-subj":"savedViews-createModal"},n.a.createElement(N.EuiModalHeader,null,n.a.createElement(N.EuiModalHeaderTitle,null,n.a.createElement(V.FormattedMessage,{defaultMessage:"Save View",id:"xpack.infra.waffle.savedView.createHeader"}))),n.a.createElement(N.EuiModalBody,null,n.a.createElement(N.EuiFieldText,{isInvalid:a,placeholder:R.i18n.translate("xpack.infra.waffle.savedViews.viewNamePlaceholder",{defaultMessage:"Name"}),"data-test-subj":"savedViewViweName",value:i,onChange:u,"aria-label":R.i18n.translate("xpack.infra.waffle.savedViews.viewNamePlaceholder",{defaultMessage:"Name"})}),n.a.createElement(N.EuiSpacer,{size:"xl"}),n.a.createElement(N.EuiSwitch,{id:"saved-view-save-time-checkbox",label:n.a.createElement(V.FormattedMessage,{defaultMessage:"Store time with view",id:"xpack.infra.waffle.savedViews.includeTimeFilterLabel"}),checked:o,onChange:c}),n.a.createElement(N.EuiSpacer,{size:"s"}),n.a.createElement(N.EuiText,{size:"xs",grow:!1,style:{maxWidth:400}},n.a.createElement(V.FormattedMessage,{defaultMessage:"This changes the time filter to the currently selected time each time the view is loaded",id:"xpack.infra.waffle.savedViews.includeTimeHelpText"}))),n.a.createElement(N.EuiModalFooter,null,n.a.createElement(N.EuiButtonEmpty,{onClick:e},n.a.createElement(V.FormattedMessage,{defaultMessage:"Cancel",id:"xpack.infra.waffle.savedViews.cancelButton"})),n.a.createElement(N.EuiButton,{color:"primary",disabled:!i,fill:!0,onClick:d,"data-test-subj":"createSavedViewButton"},n.a.createElement(V.FormattedMessage,{defaultMessage:"Save",id:"xpack.infra.waffle.savedViews.saveButton"}))))};function jt({close:e,save:t,isInvalid:a,currentView:i}){const[s,o]=Object(r.useState)(i.name),[l,c]=Object(r.useState)(!1),u=Object(r.useCallback)((e=>c(e.target.checked)),[]),d=Object(r.useCallback)((e=>o(e.target.value)),[]),m=Object(r.useCallback)((()=>{t(s,l)}),[l,t,s]);return n.a.createElement(N.EuiModal,{onClose:e},n.a.createElement(N.EuiModalHeader,null,n.a.createElement(N.EuiModalHeaderTitle,null,n.a.createElement(V.FormattedMessage,{defaultMessage:"Update View",id:"xpack.infra.waffle.savedView.updateHeader"}))),n.a.createElement(N.EuiModalBody,null,n.a.createElement(N.EuiFieldText,{isInvalid:a,placeholder:R.i18n.translate("xpack.infra.waffle.savedViews.viewNamePlaceholder",{defaultMessage:"Name"}),"data-test-subj":"savedViewViweName",value:s,onChange:d,"aria-label":R.i18n.translate("xpack.infra.waffle.savedViews.viewNamePlaceholder",{defaultMessage:"Name"})}),n.a.createElement(N.EuiSpacer,{size:"xl"}),n.a.createElement(N.EuiSwitch,{id:"saved-view-save-time-checkbox",label:n.a.createElement(V.FormattedMessage,{defaultMessage:"Store time with view",id:"xpack.infra.waffle.savedViews.includeTimeFilterLabel"}),checked:l,onChange:u}),n.a.createElement(N.EuiSpacer,{size:"s"}),n.a.createElement(N.EuiText,{size:"xs",grow:!1,style:{maxWidth:400}},n.a.createElement(V.FormattedMessage,{defaultMessage:"This changes the time filter to the currently selected time each time the view is loaded",id:"xpack.infra.waffle.savedViews.includeTimeHelpText"}))),n.a.createElement(N.EuiModalFooter,null,n.a.createElement(N.EuiButtonEmpty,{onClick:e},n.a.createElement(V.FormattedMessage,{defaultMessage:"Cancel",id:"xpack.infra.waffle.savedViews.cancelButton"})),n.a.createElement(N.EuiButton,{color:"primary",disabled:!s,fill:!0,onClick:m,"data-test-subj":"updateSavedViewButton"},n.a.createElement(V.FormattedMessage,{defaultMessage:"Save",id:"xpack.infra.waffle.savedViews.saveButton"}))))}const St=e=>{const[t,a]=Object(r.useState)(!1),i=Object(r.useCallback)((()=>a(!0)),[]),s=Object(r.useCallback)((()=>a(!1)),[]);return n.a.createElement(n.a.Fragment,null,t&&n.a.createElement(N.EuiFlexGroup,null,n.a.createElement(N.EuiButtonEmpty,{onClick:s,"data-test-subj":"hideConfirm"},n.a.createElement(V.FormattedMessage,{defaultMessage:"cancel",id:"xpack.infra.waffle.savedViews.cancel"})),n.a.createElement(N.EuiButton,{disabled:e.isDisabled,fill:!0,iconType:"trash",color:"danger",onClick:e.confirmedAction,"data-test-subj":"showConfirm"},n.a.createElement(V.FormattedMessage,{defaultMessage:"Delete view?",id:"xpack.infra.openView.actionNames.deleteConfirmation"}))),!t&&n.a.createElement(N.EuiButtonEmpty,{iconType:"trash",color:"danger",onClick:i}))};function Ct({close:e,views:t,defaultViewId:a,setView:i,makeDefault:s,deleteView:o,loading:l,sourceIsLoading:c}){const[u,d]=Object(r.useState)(null),m=Object(r.useCallback)(((t,a)=>n.a.createElement(N.EuiButtonEmpty,{onClick:()=>{i(a),e()}},t)),[i,e]),p=Object(r.useCallback)((e=>"0"===e.id?n.a.createElement(n.a.Fragment,null):n.a.createElement(St,{isDisabled:e.isDefault,confirmedAction:()=>{o(e.id)}})),[o]),g=Object(r.useCallback)((e=>{const t=e.id===a;return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiButtonEmpty,{isLoading:u===e.id&&c,iconType:t?"starFilled":"starEmpty",onClick:()=>{d(e.id),s(e.id)}}))}),[s,a,c,u]),f=[{field:"name",name:R.i18n.translate("xpack.infra.openView.columnNames.name",{defaultMessage:"Name"}),sortable:!0,truncateText:!0,render:m},{name:R.i18n.translate("xpack.infra.openView.columnNames.actions",{defaultMessage:"Actions"}),actions:[{available:()=>!0,render:g},{available:e=>!0,render:p}]}];return n.a.createElement(N.EuiPortal,null,n.a.createElement(N.EuiFlyout,{onClose:e,"data-test-subj":"loadViewsFlyout"},n.a.createElement(N.EuiFlyoutHeader,null,n.a.createElement(N.EuiTitle,{size:"m"},n.a.createElement("h2",null,n.a.createElement(V.FormattedMessage,{defaultMessage:"Manage saved views",id:"xpack.infra.openView.flyoutHeader"})))),n.a.createElement(N.EuiFlyoutBody,null,n.a.createElement(N.EuiInMemoryTable,{items:t,columns:f,loading:l,search:!0,pagination:!0,sorting:!0})),n.a.createElement(N.EuiModalFooter,null,n.a.createElement(N.EuiButtonEmpty,{"data-test-subj":"cancelSavedViewModal",onClick:e},n.a.createElement(V.FormattedMessage,{defaultMessage:"Cancel",id:"xpack.infra.openView.cancelButton"})))))}function Tt({close:e,views:t,setView:a,currentView:i}){const[s,o]=Object(r.useState)(null),l=Object(r.useCallback)((e=>{o(e)}),[]),c=Object(r.useCallback)((()=>{if(!s)return void e();const r=s.find((e=>e.checked));r?(a(t.find((e=>e.id===r.key))),e()):e()}),[s,t,a,e]),u=Object(r.useMemo)((()=>t.map((e=>({label:e.name,key:e.id,checked:(null==i?void 0:i.id)===e.id?"on":void 0})))),[t,i]);return n.a.createElement(N.EuiModal,{onClose:e,"data-test-subj":"savedViews-loadModal"},n.a.createElement(N.EuiModalHeader,null,n.a.createElement(N.EuiModalHeaderTitle,null,n.a.createElement(V.FormattedMessage,{defaultMessage:"Select a view to load",id:"xpack.infra.waffle.savedView.selectViewHeader"}))),n.a.createElement(N.EuiModalBody,null,n.a.createElement(N.EuiSelectable,{singleSelection:!0,searchable:!0,options:s||u,onChange:l,searchProps:{placeholder:R.i18n.translate("xpack.infra.savedView.searchPlaceholder",{defaultMessage:"Search for saved views"})},listProps:{bordered:!0}},((e,t)=>n.a.createElement(n.a.Fragment,null,t,n.a.createElement("div",{style:{marginTop:20},"data-test-subj":"savedViews-loadList"},e))))),n.a.createElement(N.EuiModalFooter,null,n.a.createElement(N.EuiButtonEmpty,{"data-test-subj":"cancelSavedViewModal",onClick:e},n.a.createElement(V.FormattedMessage,{defaultMessage:"Cancel",id:"xpack.infra.openView.cancelButton"})),n.a.createElement(N.EuiButton,{fill:!0,color:"primary","data-test-subj":"loadSavedViewModal",onClick:c},n.a.createElement(V.FormattedMessage,{defaultMessage:"Load view",id:"xpack.infra.openView.loadButton"}))))}function Ft(e){const t=Object(A.useKibana)(),{views:a,saveView:i,loading:s,updateView:o,deletedId:l,deleteView:c,defaultViewId:u,makeDefault:d,sourceIsLoading:m,find:p,errorOnFind:g,errorOnCreate:f,createdView:b,updatedView:h,currentView:y,setCurrentView:E}=vt(),[v,x]=Object(r.useState)(!1),[k,O]=Object(r.useState)(!1),[M,w]=Object(r.useState)(!1),[j,S]=Object(r.useState)(!1),[C,T]=Object(r.useState)(!1),[F,L]=Object(r.useState)(!1),P=Object(r.useCallback)((()=>{S(!1)}),[S]),I=Object(r.useCallback)((()=>{P(),p(),O(!0)}),[O,p,P]),D=Object(r.useCallback)((()=>{O(!1)}),[O]),_=Object(r.useCallback)((()=>{P(),w(!1),T(!0)}),[P]),B=Object(r.useCallback)((()=>{P(),w(!1),L(!0)}),[P]),V=Object(r.useCallback)((()=>x(!1)),[]),z=Object(r.useCallback)((()=>T(!1)),[]),$=Object(r.useCallback)((()=>L(!1)),[]),U=Object(r.useCallback)((()=>{P(),p(),x(!0)}),[p,P]),H=Object(r.useCallback)((()=>{S(!j)}),[S,j]),q=Object(r.useCallback)(((t,a=!1)=>{const r={...e.viewState,...a?{}:{time:void 0}};i({...r,name:t})}),[e.viewState,i]),J=Object(r.useCallback)(((t,a=!1)=>{const r={...e.viewState,...a?{}:{time:void 0}};o(y.id,{...r,name:t})}),[e.viewState,o,y]);return Object(r.useEffect)((()=>{f&&w(!0)}),[f]),Object(r.useEffect)((()=>{void 0!==h&&(E(h),$())}),[h,E,$]),Object(r.useEffect)((()=>{void 0!==b&&(E(b),z())}),[b,E,z]),Object(r.useEffect)((()=>{void 0!==l&&p()}),[l,p]),Object(r.useEffect)((()=>{f?t.notifications.toasts.warning(Lt("create",f)):g&&t.notifications.toasts.warning(Lt("find",g))}),[f,g,t]),n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiPopover,{"data-test-subj":"savedViews-popover",button:n.a.createElement(N.EuiButton,{onClick:H,"data-test-subj":"savedViews-openPopover",iconType:"arrowDown",iconSide:"right"},y?y.name:R.i18n.translate("xpack.infra.savedView.unknownView",{defaultMessage:"No view selected"})),isOpen:j,closePopover:P,anchorPosition:"leftCenter"},n.a.createElement(N.EuiListGroup,{flush:!0},n.a.createElement(N.EuiListGroupItem,{"data-test-subj":"savedViews-manageViews",iconType:"indexSettings",onClick:U,label:R.i18n.translate("xpack.infra.savedView.manageViews",{defaultMessage:"Manage views"})}),n.a.createElement(N.EuiListGroupItem,{"data-test-subj":"savedViews-updateView",iconType:"refresh",onClick:B,isDisabled:!y||"0"===y.id,label:R.i18n.translate("xpack.infra.savedView.updateView",{defaultMessage:"Update view"})}),n.a.createElement(N.EuiListGroupItem,{"data-test-subj":"savedViews-loadView",iconType:"importAction",onClick:I,label:R.i18n.translate("xpack.infra.savedView.loadView",{defaultMessage:"Load view"})}),n.a.createElement(N.EuiListGroupItem,{"data-test-subj":"savedViews-saveNewView",iconType:"save",onClick:_,label:R.i18n.translate("xpack.infra.savedView.saveNewView",{defaultMessage:"Save new view"})}))),C&&n.a.createElement(wt,{isInvalid:M,close:z,save:q}),F&&n.a.createElement(jt,{currentView:y,isInvalid:M,close:$,save:J}),k&&n.a.createElement(Tt,{currentView:y,views:a,close:D,setView:E}),v&&n.a.createElement(Ct,{sourceIsLoading:m,loading:s,views:a,defaultViewId:u,makeDefault:d,deleteView:c,close:V,setView:E}))}const Lt=(e,t)=>"create"===e?{toastLifeTimeMs:3e3,title:t||R.i18n.translate("xpack.infra.savedView.errorOnCreate.title",{defaultMessage:"An error occured saving view."})}:"find"===e?{toastLifeTimeMs:3e3,title:t||R.i18n.translate("xpack.infra.savedView.findError.title",{defaultMessage:"An error occurred while loading views."})}:void 0,Pt=({source:e,derivedIndexPattern:t})=>{const{loading:a,error:i,data:s,currentTimerange:o,options:l,chartOptions:c,setChartOptions:u,handleAggregationChange:d,handleMetricsChange:m,handleFilterQuerySubmit:p,handleGroupByChange:g,handleTimeChange:f,handleRefresh:b,handleLoadMore:h,onViewStateChange:y,loadData:E}=((e,t,a=!0)=>{const[n,i]=Object(r.useState)(0),[s,o]=Object(r.useState)(null),{defaultViewState:l,options:c,currentTimerange:u,chartOptions:d,setChartOptions:m,setTimeRange:p,setOptions:g}=Object(r.useContext)(ne.c.Context),{loading:f,error:b,data:h,loadData:y}=Object(dt.a)(c,e,t,u,s,n,a),E=Object(r.useCallback)((()=>{o(null),i(n+1)}),[n]),v=Object(r.useCallback)(((e,t)=>{o(null),p({...u,from:e,to:t})}),[u,p]),x=Object(r.useCallback)((e=>{o(null),g({...c,groupBy:e||void 0})}),[c,g]),k=Object(r.useCallback)((e=>{o(null),g({...c,filterQuery:e})}),[c,g]),O=Object(r.useCallback)((e=>{o(null),g({...c,metrics:e})}),[c,g]),M=Object(r.useCallback)((e=>{o(null);const t="count"===e?[{aggregation:e}]:c.metrics.filter((e=>"count"!==e.aggregation)).map((t=>({...t,aggregation:e})));g({...c,aggregation:e,metrics:t})}),[c,g]),w=Object(r.useCallback)((e=>{e.chartOptions&&m(e.chartOptions),e.currentTimerange&&"0"!==e.id&&p(e.currentTimerange),e.options&&g(e.options)}),[m,g,p]);return{loading:f,error:b,data:h,currentTimerange:u,options:c,chartOptions:d,setChartOptions:m,handleAggregationChange:M,handleMetricsChange:O,handleFilterQuerySubmit:k,handleGroupByChange:x,handleTimeChange:v,handleRefresh:E,handleLoadMore:o,defaultViewState:l,onViewStateChange:w,loadData:y,refreshSignal:n,afterKey:s}})(e,t,!1),{currentView:v,shouldLoadDefault:x}=vt();Object(de.useTrackPageview)({app:"infra_metrics",path:"metrics_explorer"}),Object(de.useTrackPageview)({app:"infra_metrics",path:"metrics_explorer",delay:15e3});const{metricIndicesExist:k}=Object(r.useContext)(ce.a.Context);return Object(r.useEffect)((()=>{v&&y(v)}),[v,y]),Object(r.useEffect)((()=>{null==v&&x||E()}),[E,x]),fe([{text:ge.e}]),n.a.createElement(N.EuiErrorBoundary,null,n.a.createElement(te.a,{title:e=>R.i18n.translate("xpack.infra.infrastructureMetricsExplorerPage.documentTitle",{defaultMessage:"{previousTitle} | Metrics Explorer",values:{previousTitle:e}})}),n.a.createElement(Mt,{hasData:k,pageHeader:{pageTitle:ge.e,rightSideItems:[n.a.createElement(Ft,{viewState:{options:l,chartOptions:c,currentTimerange:o}})]}},n.a.createElement(ut,{derivedIndexPattern:t,timeRange:o,options:l,chartOptions:c,onRefresh:b,onTimeChange:f,onGroupByChange:g,onFilterQuerySubmit:p,onMetricsChange:m,onAggregationChange:d,onChartOptionsChange:u}),i?n.a.createElement(be.a,{titleText:"Whoops!",bodyText:R.i18n.translate("xpack.infra.metricsExplorer.errorMessage",{defaultMessage:'It looks like the request failed with "{message}"',values:{message:i.message}}),onRefetch:b,refetchText:"Try Again"}):n.a.createElement(tt,{timeRange:o,loading:a,data:s,source:e,options:l,chartOptions:c,onLoadMore:h,onFilter:p,onRefetch:b,onTimeChange:f})))},It=new RegExp(`^([\\d\\.]+)\\s*(${f.a.units.join("|")})$`),Dt=(b.keyof({seconds:null,minutes:null,hours:null,days:null,weeks:null,months:null,years:null}),["seconds","minutes","hours","days","weeks","months","years"]),_t={seconds:R.i18n.translate("xpack.infra.durationUnits.seconds.plural",{defaultMessage:"seconds"}),minutes:R.i18n.translate("xpack.infra.durationUnits.minutes.plural",{defaultMessage:"minutes"}),hours:R.i18n.translate("xpack.infra.durationUnits.hours.plural",{defaultMessage:"hours"}),days:R.i18n.translate("xpack.infra.durationUnits.days.plural",{defaultMessage:"days"}),weeks:R.i18n.translate("xpack.infra.durationUnits.weeks.plural",{defaultMessage:"weeks"}),months:R.i18n.translate("xpack.infra.durationUnits.months.plural",{defaultMessage:"months"}),years:R.i18n.translate("xpack.infra.durationUnits.years.plural",{defaultMessage:"years"})},Rt={seconds:R.i18n.translate("xpack.infra.durationUnits.seconds.singular",{defaultMessage:"second"}),minutes:R.i18n.translate("xpack.infra.durationUnits.minutes.singular",{defaultMessage:"minute"}),hours:R.i18n.translate("xpack.infra.durationUnits.hours.singular",{defaultMessage:"hour"}),days:R.i18n.translate("xpack.infra.durationUnits.days.singular",{defaultMessage:"day"}),weeks:R.i18n.translate("xpack.infra.durationUnits.weeks.singular",{defaultMessage:"week"}),months:R.i18n.translate("xpack.infra.durationUnits.months.singular",{defaultMessage:"month"}),years:R.i18n.translate("xpack.infra.durationUnits.years.singular",{defaultMessage:"year"})},At=e=>{const t=(e=>{if(e){const t=e.match(It);if(t)return{value:Number(t[1]),unit:t[2]}}throw new Error(R.i18n.translate("xpack.infra.parseInterval.errorMessage",{defaultMessage:"{value} is not an interval string",values:{value:e}}))})(e);if("s"===(null==t?void 0:t.unit)){const e=p.a.duration(t.value,t.unit),n=Dt.reduce(((t,a)=>e.as(a)>=1?a:t),"seconds"),i=e.as(n);return`${Math.floor(i)} ${a=i,r=n,1===Math.floor(a)?Rt[r]:_t[r]}`}var a,r};var Bt=a(126);const Nt={currentTime:Date.now(),isAutoReloading:!1},Vt=b.type({currentTime:b.number,isAutoReloading:b.boolean}),zt=Vt.encode,$t=e=>Object(h.pipe)(Vt.decode(e),Object(y.fold)(Object(E.constant)(void 0),E.identity)),Ut=d()((()=>{const[e]=Object(Bt.a)({from:"now",to:"now"}),t=f.a.parse(e().to),[a,n]=Object(v.b)({defaultState:{...Nt,currentTime:t?t.toDate().getTime():Date.now()},decodeUrlState:$t,encodeUrlState:zt,urlStateKey:"waffleTime"}),[i,s]=Object(r.useState)(a);Object(r.useEffect)((()=>{n(i)}),[n,i]);const{currentTime:o,isAutoReloading:l}=a;return{currentTime:o,currentTimeRange:{from:o-3e5,interval:"1m",to:o},isAutoReloading:l,startAutoReload:Object(r.useCallback)((()=>{s((e=>({...e,isAutoReloading:!0})))}),[s]),stopAutoReload:Object(r.useCallback)((()=>{s((e=>({...e,isAutoReloading:!1})))}),[s]),jumpToTime:Object(r.useCallback)((e=>{s((t=>({...t,currentTime:e})))}),[s]),setWaffleTimeState:s}})),[Ht,qt]=Ut,Jt=Object(z.withTheme)((({interval:e})=>{const{currentTime:t,isAutoReloading:a,startAutoReload:i,stopAutoReload:s,jumpToTime:o}=qt(),l=p()(t),c=At(e),u=a?n.a.createElement(N.EuiButton,{color:"primary",iconSide:"left",iconType:"pause",onClick:s},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.waffleTime.stopRefreshingButtonLabel",defaultMessage:"Stop refreshing"})):n.a.createElement(N.EuiButton,{iconSide:"left",iconType:"play",onClick:i},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.waffleTime.autoRefreshButtonLabel",defaultMessage:"Auto-refresh"})),d=Object(r.useCallback)((e=>{e&&o(e.valueOf())}),[o]);return n.a.createElement(N.EuiFlexGroup,{gutterSize:"m"},n.a.createElement(N.EuiFlexItem,{grow:!1,"data-test-subj":"waffleDatePicker"},n.a.createElement(N.EuiToolTip,{content:`Last ${c} of data for the selected time`,delay:"long",display:"inlineBlock",position:"top","data-test-subj":"waffleDatePickerIntervalTooltip"},n.a.createElement(N.EuiDatePicker,{dateFormat:"L LTS",disabled:a,injectTimes:l?[l]:[],isLoading:a,onChange:d,popoverPlacement:"top-end",selected:l,shouldCloseOnSelect:!0,showTimeSelect:!0,timeFormat:"LT"}))),n.a.createElement(N.EuiFlexItem,{grow:!1},u))}));var Gt=a(231),Kt=a(214),Wt=a(121),Qt=a(112);const Xt={kind:"kuery",expression:""},Yt=b.type({kind:b.literal("kuery"),expression:b.string}),Zt=Yt.encode,ea=e=>Object(h.pipe)(Yt.decode(e),Object(y.fold)(Object(E.constant)(void 0),E.identity)),ta=d()((()=>{const{createDerivedIndexPattern:e}=Object(ce.b)(),t=e(),[a,n]=Object(v.b)({defaultState:Xt,decodeUrlState:ea,encodeUrlState:Zt,urlStateKey:"waffleFilter"}),[i,s]=Object(r.useState)(a);Object(r.useEffect)((()=>n(i)),[n,i]);const[o,l]=Object(r.useState)(a.expression),c=Object(r.useMemo)((()=>Object(Qt.a)(a.expression,t)),[t,a.expression]),u=Object(r.useCallback)((e=>{s((t=>({...t,kind:"kuery",expression:e})))}),[s]),d=Object(r.useCallback)((e=>{s(e),l(e.expression)}),[]),m=Object(r.useMemo)((()=>(e=>{try{Object(Wt.c)(e)}catch(e){return!1}return!0})(o)),[o]),{inventoryPrefill:p}=Object(we.b)(),g=Object(r.useMemo)((()=>p),[p]);return Object(r.useEffect)((()=>g.setFilterQuery(i.expression)),[g,i]),{filterQuery:a,filterQueryDraft:o,filterQueryAsJson:c,applyFilterQuery:d,setFilterQueryDraftFromKueryExpression:l,applyFilterQueryFromKueryExpression:u,isFilterQueryDraftValid:m,setWaffleFiltersState:d}})),[aa,ra]=ta,na=()=>{const{createDerivedIndexPattern:e}=Object(r.useContext)(ce.a.Context),{applyFilterQueryFromKueryExpression:t,filterQueryDraft:a,isFilterQueryDraftValid:i,setFilterQueryDraftFromKueryExpression:s}=ra();return n.a.createElement(Kt.a,{indexPattern:e()},(({isLoadingSuggestions:e,loadSuggestions:r,suggestions:o})=>n.a.createElement(Gt.a,{isLoadingSuggestions:e,isValid:i,loadSuggestions:r,onChange:s,onSubmit:t,placeholder:R.i18n.translate("xpack.infra.homePage.toolbar.kqlSearchFieldPlaceholder",{defaultMessage:"Search for infrastructure data… (e.g. host.name:host-1)"}),suggestions:o,value:a||"",autoFocus:!0})))},ia=({interval:e})=>n.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween",gutterSize:"m",style:{flexGrow:0}},n.a.createElement(N.EuiFlexItem,null,n.a.createElement(na,null)),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(Jt,{interval:e})));var sa=a(138);const oa=({detailedMessage:e,retry:t,shortMessage:a})=>n.a.createElement(sa.a,{isEmptyState:!0},n.a.createElement(N.EuiCallOut,{color:"danger",iconType:"cross",title:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.errorPage.errorOccurredTitle",defaultMessage:"An error occurred"})},n.a.createElement(N.EuiFlexGroup,{alignItems:"center"},n.a.createElement(N.EuiFlexItem,null,a),t?n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,{onClick:t,iconType:"refresh"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.errorPage.tryAgainButtonLabel",defaultMessage:"Try again"}))):null),e?n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiSpacer,null),n.a.createElement("div",null,e)):null)),la=({errorMessage:e,retry:t})=>n.a.createElement(oa,{shortMessage:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceErrorPage.failedToLoadDataSourcesMessage",defaultMessage:"Failed to load data sources."}),detailedMessage:n.a.createElement("code",null,e),retry:t});var ca=a(111),ua=a(127),da=a.n(ua),ma=a(115);function pa(e){return e&&null!=e.nodes&&Array.isArray(e.nodes)}function ga(e){return e&&null!=e.groups&&Array.isArray(e.groups)}function fa(e){return e.map((e=>e.value)).join("/")}function ba(e,t){const a=0===t.length?"__all__":fa(t),r=Object(ve.first)(t);if(2===t.length&&r){const t=r.value,n=e.find((e=>e.id===t));if(ga(n)){const e=n.groups.find((e=>e.id===a));if(pa(e))return e}}const n=Object(ve.last)(t),i=e.find((e=>e.id===a));return pa(i)?i:{id:a,name:"__all__"===a?R.i18n.translate("xpack.infra.nodesToWaffleMap.groupsWithNodes.allName",{defaultMessage:"All"}):n&&n.label||"Unknown Group",count:0,width:0,squareSize:0,nodes:[]}}function ha(e){const t=Object(ve.last)(e.path);if(!t)throw new Error("There must be at least one node path item");return{pathId:e.path.map((e=>e.value)).join("/"),path:e.path,id:t.value,ip:t.ip,name:t.label||t.value,metrics:e.metrics}}function ya(e){return t=>t.id!==e.id}function Ea(e){return e.reduce(((e,t)=>{const a=ha(t);if(2===t.path.length){const r=ba(e,t.path.slice(0,t.path.length-1));return r.nodes.push(a),e.filter(ya(r)).concat([r])}if(3===t.path.length){const r=ba(e,t.path.slice(0,t.path.length-1));r.nodes.push(a);const n=function(e,t){const a=0===t.length?"__all__":fa(t),r=Object(ve.last)(t),n=e.find((e=>e.id===a));return ga(n)?n:{id:a,name:"__all__"===a?R.i18n.translate("xpack.infra.nodesToWaffleMap.groupsWithGroups.allName",{defaultMessage:"All"}):r&&r.label||"Unknown Group",count:0,width:0,squareSize:0,groups:[]}}(e,t.path.slice(0,t.path.length-2));return n.groups=n.groups.filter(ya(r)).concat([r]),e.filter(ya(n)).concat([n])}const r=ba(e,[]);return r.nodes.push(a),e.filter(ya(r)).concat([r])}),[])}var va=a(14),xa=a.n(va);class group_name_GroupName extends n.a.PureComponent{constructor(...e){super(...e),xa()(this,"handleClick",(e=>{e.preventDefault();const{groupBy:t}=this.props.options;if(0===t.length)return;const a=this.props.isChild&&t.length>1?t[1]:t[0];this.props.onDrilldown(`${a.field}: "${this.props.group.name}"`)}))}render(){const{group:e,isChild:t}=this.props,a={fontSize:t?"0.85em":"1em"};return n.a.createElement(ka,null,n.a.createElement(Oa,{isChild:t},n.a.createElement(Ma,null,n.a.createElement(N.EuiToolTip,{position:"top",content:e.name},n.a.createElement(N.EuiLink,{style:a,onClickCapture:this.handleClick,"data-test-subj":"groupNameLink"},e.name))),n.a.createElement(wa,null,e.count)))}}const ka=z.euiStyled.div`
  position: relative;
  text-align: center;
  font-size: 16px;
  margin-bottom: 5px;
  top: 20px;
  display: flex;
  justify-content: center;
  padding: 0 10px;
`,Oa=z.euiStyled.div`
  border: 1px solid ${e=>e.theme.eui.euiBorderColor};
  background-color: ${e=>e.isChild?e.theme.eui.euiColorLightestShade:e.theme.eui.euiColorEmptyShade};
  border-radius: 4px;
  box-shadow: 0px 2px 0px 0px ${e=>e.theme.eui.euiBorderColor};
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
`,Ma=z.euiStyled.div`
  flex: 1 1 auto;
  padding: 6px 10px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,wa=z.euiStyled.div`
  flex: 0 0 auto;
  border-left: 1px solid ${e=>e.theme.eui.euiBorderColor};
  padding: 6px 10px;
  font-size: 0.85em;
  font-weight: normal;
`;var ja=a(108),Sa=a(119),Ca=a(89),Ta=a(148),Fa=a(149),La=a(150);const Pa=Object.keys(Ca.e).reduce(((e,t)=>{var a;const r=null===(a=Object(La.a)(t))||void 0===a?void 0:a.text;return r?{...e,[t]:r}:e}),{});var Ia=a(91);const Da=Object(z.withTheme)((({theme:e,node:t,nodeType:a,currentTime:r})=>{const{sourceId:i}=Object(ce.b)(),s=Object(Q.b)(a),{customMetrics:o}=Object(Ia.d)(),l=s.tooltipMetrics.map((e=>({type:e}))).concat(o),c=JSON.stringify({bool:{filter:{match_phrase:{[s.fields.id]:t.id}}}}),{nodes:u}=Object(Ta.a)(c,l,[],a,i,r,"",""),d=Object(ve.first)(u),m=d&&d.metrics||[];return n.a.createElement("div",{style:{minWidth:200},"data-test-subj":`conditionalTooltipContent-${t.name}`},n.a.createElement("div",{style:{borderBottom:`1px solid ${null==e?void 0:e.eui.euiColorMediumShade}`,paddingBottom:null==e?void 0:e.eui.paddingSizes.xs,marginBottom:null==e?void 0:e.eui.paddingSizes.xs}},t.name),m.map((e=>{const t=Ca.f.is(e.name)?e.name:"custom",a=Pa[t]||t,r="custom"===a?o.find((t=>t.id===e.name)):null,i=r?Object(xe.a)(r):Object(Fa.a)({type:t});return n.a.createElement(N.EuiFlexGroup,{gutterSize:"s",key:e.name},n.a.createElement(N.EuiFlexItem,{grow:1,className:"eui-textTruncate eui-displayBlock","data-test-subj":"conditionalTooltipContent-metric"},r?Object(Sa.a)(r):a),n.a.createElement(N.EuiFlexItem,{grow:!1,"data-test-subj":"conditionalTooltipContent-value"},e.value&&i(e.value)||"-"))})))})),_a={[Ie.c.eq]:ve.isEqual,[Ie.c.lt]:ve.lt,[Ie.c.lte]:ve.lte,[Ie.c.gte]:ve.gte,[Ie.c.gt]:ve.gt},Ra=e=>Object(ja.toColorString)(Object(ja.parseToRgb)(e)),Aa=(e,t,a)=>(a-e)/(t-e),Ba=(e,t,a,r="rgba(217, 217, 217, 1)")=>{var n,i;const s=Aa(a.min,a.max,Number(t)),o=e.length,l=Object(ve.last)(e);return l&&Object(ve.gte)(s,l.value)?l.color:e.reduce(((e,t)=>{const a=t.value-1/o,r=t.value;return Object(ve.gte)(s,a)&&Object(ve.lte)(s,r)?t.color:e}),null!==(n=null===(i=Object(ve.first)(e))||void 0===i?void 0:i.color)&&void 0!==n?n:r)},Na=(e,t,a="rgba(217, 217, 217, 1)")=>e.reduce(((e,a)=>(0,_a[a.operator])(t,a.value)?a.color:e),a),Va=(e,t,a,r="rgba(0, 179, 164, 1)")=>{if(0===e.length)return r;if(1===e.length)return Object(ve.last)(e).color;const{min:n,max:i}=a,s=Object(ve.sortBy)(e,"value"),o=Aa(n,i,Number(t)),l=s.reduce(((e,t)=>t.value<=o?t:e),Object(ve.first)(s)),c=s.filter((e=>e!==l)).find((e=>e.value>=o));if(!c)return l.color;const u=Aa(l.value,c.value,o);return Object(ja.mix)(u,c.color,l.color)},za=z.euiStyled.div`
  padding: ${e=>e.theme.eui.paddingSizes.m};
  flex: 1;
  overflow-y: auto;
  overflow-x: hidden;
`,$a=({title:e,metrics:t})=>n.a.createElement(N.EuiFlexGroup,{gutterSize:"s",responsive:!1},n.a.createElement(Ua,{grow:1},n.a.createElement(N.EuiText,{size:"s"},n.a.createElement(Ha,null,e))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},t.map((e=>n.a.createElement(N.EuiFlexItem,{key:e.label},n.a.createElement(N.EuiFlexGroup,{key:e.label,gutterSize:"xs",alignItems:"center",responsive:!1},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiIcon,{color:Object(Le.b)(e.color),type:"dot"})),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiText,{size:"xs"},e.label))))))))),Ua=Object(z.euiStyled)(N.EuiFlexItem).attrs({grow:1})`
  overflow: hidden;
`,Ha=Object(z.euiStyled)("h4")`
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
`,qa=["100%",160],Ja=({title:e,style:t,chartRef:a,series:r,tickFormatterForTime:i,tickFormatter:s,onPointerUpdate:o,domain:l,stack:c=!1})=>{const u=Object(A.useUiSetting)("theme:darkMode"),d=r.map((e=>e.metric)),m={headerFormatter:e=>p()(e.value).format("Y-MM-DD HH:mm:ss.SSS")};return n.a.createElement(n.a.Fragment,null,n.a.createElement($a,{title:e,metrics:d}),n.a.createElement(Ee.Chart,{ref:a,size:qa},r.map(((e,a)=>n.a.createElement(ke.a,{type:t,metric:e.metric,id:"0",key:e.series.id,series:e.series,stack:c}))),n.a.createElement(Ee.Axis,{id:"timestamp",position:Ee.Position.Bottom,showOverlappingTicks:!0,tickFormat:i}),n.a.createElement(Ee.Axis,{id:"values",position:Ee.Position.Left,tickFormat:s,domain:l,ticks:6,showGridLines:!0}),n.a.createElement(Ee.Settings,{onPointerUpdate:o,tooltip:m,theme:Ge(u)})))},Ga=R.i18n.translate("xpack.infra.nodeDetails.metrics.system",{defaultMessage:"System"}),Ka=R.i18n.translate("xpack.infra.nodeDetails.metrics.user",{defaultMessage:"User"}),Wa=R.i18n.translate("xpack.infra.nodeDetails.metrics.inbound",{defaultMessage:"Inbound"}),Qa=R.i18n.translate("xpack.infra.nodeDetails.metrics.outbound",{defaultMessage:"Outbound"}),Xa=R.i18n.translate("xpack.infra.nodeDetails.metrics.used",{defaultMessage:"Used"}),Ya=(R.i18n.translate("xpack.infra.nodeDetails.metrics.cached",{defaultMessage:"Cached"}),R.i18n.translate("xpack.infra.nodeDetails.metrics.free",{defaultMessage:"Free"})),Za=R.i18n.translate("xpack.infra.nodeDetails.metrics.charts.networkTitle",{defaultMessage:"Network"}),er=R.i18n.translate("xpack.infra.nodeDetails.metrics.charts.memoryTitle",{defaultMessage:"Memory"}),tr=R.i18n.translate("xpack.infra.nodeDetails.metrics.fcharts.cpuTitle",{defaultMessage:"CPU"}),ar=R.i18n.translate("xpack.infra.nodeDetails.metrics.charts.loadTitle",{defaultMessage:"Load"}),rr=R.i18n.translate("xpack.infra.nodeDetails.metrics.logRate",{defaultMessage:"Log Rate"}),nr=R.i18n.translate("xpack.infra.nodeDetails.metrics.charts.logRateTitle",{defaultMessage:"Log Rate"}),ir=e=>n.a.createElement(N.EuiSelect,{fullWidth:!0,options:[{text:R.i18n.translate("xpack.infra.nodeDetails.metrics.last15Minutes",{defaultMessage:"Last 15 minutes"}),value:9e5},{text:R.i18n.translate("xpack.infra.nodeDetails.metrics.lastHour",{defaultMessage:"Last hour"}),value:36e5},{text:R.i18n.translate("xpack.infra.nodeDetails.metrics.last3Hours",{defaultMessage:"Last 3 hours"}),value:108e5},{text:R.i18n.translate("xpack.infra.nodeDetails.metrics.last24Hours",{defaultMessage:"Last 24 hours"}),value:864e5},{text:R.i18n.translate("xpack.infra.nodeDetails.metrics.last7Days",{defaultMessage:"Last 7 days"}),value:6048e5}],value:e.value,onChange:e.onChange}),sr=Object(z.euiStyled)(N.EuiFlexItem)`
  overflow: hidden
`,or=()=>n.a.createElement("div",{style:{width:"100%",height:"200px",padding:"16px",display:"flex",alignItems:"center",justifyContent:"center"}},n.a.createElement(N.EuiLoadingChart,{size:"xl"})),lr={id:"metrics",name:R.i18n.translate("xpack.infra.nodeDetails.tabs.metrics",{defaultMessage:"Metrics"}),content:e=>{const t=Object(r.useRef)(null),a=Object(r.useRef)(null),i=Object(r.useRef)(null),s=Object(r.useRef)(null),o=Object(r.useRef)(null),l=Object(r.useRef)({}),[c,u]=Object(r.useState)(36e5),d=Object(r.useMemo)((()=>[...[t,a,i,s,o],l]),[t,a,i,s,o,l]),{sourceId:m,createDerivedIndexPattern:p}=Object(ce.b)(),{nodeType:g,accountId:f,region:b,customMetrics:h}=Object(Ia.d)(),{currentTime:y,node:E}=e,v=Object(r.useMemo)((()=>p()),[p]);let x=`${Object(Q.a)(g).id}: "${E.id}"`;x&&(x=Object(Qt.a)(x,v));const k=Object(r.useCallback)(((e,t,a="avg")=>({type:"custom",aggregation:a,field:e,id:t})),[]),O=Object(r.useCallback)((e=>{u(Number(e.currentTarget.value))}),[u]),M={interval:"1m",to:y,from:y-c,ignoreLookback:!0},w=[{type:"rx"},{type:"tx"},k("system.cpu.user.pct","user"),k("system.cpu.system.pct","system"),k("system.load.1","load1m"),k("system.load.5","load5m"),k("system.load.15","load15m"),k("system.memory.actual.used.bytes","usedMemory"),k("system.memory.actual.free","freeMemory"),k("system.cpu.cores","cores","max")],{nodes:j,reload:S}=Object(Ta.a)(x,[...w,...h],[],g,m,y,f,b,!1,M),{nodes:C,reload:T}=Object(Ta.a)(x,[{type:"logRate"}],[],g,m,y,f,b,!1,M),F=Object(r.useCallback)(((e,t)=>{const a=e?Object(Qe.a)(e,t,!1):null;return a?{max:1.1*a.max,min:a.min}:{max:0,min:0}}),[]),L=Object(r.useCallback)((e=>{var t,a;if(!e)return()=>"";const r=null===(t=Object(ve.first)(e.rows))||void 0===t?void 0:t.timestamp,n=null===(a=Object(ve.last)(e.rows))||void 0===a?void 0:a.timestamp;return null==r||null==n?e=>`${e}`:Object(Ee.niceTimeFormatter)([r,n])}),[]),P=Object(r.useMemo)((()=>Object(Fa.a)({type:"rx"})),[]),I=Object(r.useMemo)((()=>Object(Fa.a)({type:"cpu"})),[]),D=Object(r.useMemo)((()=>Object(Fa.a)({type:"s3BucketSize"})),[]),_=Object(r.useMemo)((()=>Object(Fa.a)({type:"load"})),[]),R=Object(r.useMemo)((()=>Object(Fa.a)({type:"logRate"})),[]),A=Object(r.useCallback)(((...e)=>{const t=e[0],a=e.slice(1);return t.rows=t.rows.map(((e,t)=>{const r={...e};return a.forEach(((e,a)=>{r[`metric_${a+1}`]=e.rows[t].metric_0})),r})),t}),[]),B=Object(r.useCallback)(((e,t)=>{const a={color:Le.a.color0,aggregation:t,label:"System"};return e.map(((e,t)=>({...a,color:Le.a[`color${t}`],label:e})))}),[]),V=Object(r.useCallback)((e=>{d.forEach((t=>{if(t.current)if(t.current instanceof Ee.Chart)t.current.dispatchExternalPointerEvent(e);else{Object.values(t.current).forEach((t=>{t&&t.dispatchExternalPointerEvent(e)}))}}))}),[d]),z=Object(r.useCallback)((e=>j&&j.length?j[0].metrics.find((t=>t.name===e)).timeseries:null),[j]),$=Object(r.useCallback)((()=>C?0===C.length?{rows:[],columns:[],id:"0"}:C[0].metrics.find((e=>"logRate"===e.name)).timeseries:null),[C]),U=Object(r.useMemo)((()=>z("system")),[z]),H=Object(r.useMemo)((()=>z("user")),[z]),q=Object(r.useMemo)((()=>z("rx")),[z]),J=Object(r.useMemo)((()=>z("tx")),[z]),G=Object(r.useMemo)((()=>z("load1m")),[z]),K=Object(r.useMemo)((()=>z("load5m")),[z]),W=Object(r.useMemo)((()=>z("load15m")),[z]),X=Object(r.useMemo)((()=>z("usedMemory")),[z]),Y=Object(r.useMemo)((()=>z("freeMemory")),[z]),Z=Object(r.useMemo)((()=>z("cores")),[z]),ee=Object(r.useMemo)((()=>$()),[$]);if(Object(r.useEffect)((()=>{S(),T()}),[c,S,T]),!(U&&H&&q&&J&&G&&K&&W&&X&&Y&&ee))return n.a.createElement(or,null);const te=B([Ga,Ka],"avg"),ae=B([rr],"rate"),re=B([Wa,Qa],"rate"),ie=B(["1m","5m","15m"],"avg"),se=B([Xa,Ya],"rate");U.rows=U.rows.slice().map(((e,t)=>{const a=e.metric_0,r=Z.rows[t].metric_0;return a&&r&&(e.metric_0=a/r),e})),H.rows=H.rows.slice().map(((e,t)=>{const a=e.metric_0,r=Z.rows[t].metric_0;return a&&r&&(e.metric_0=a/r),e}));const oe=A(U,H),le=A(ee),ue=A(q,J),de=A(G,K,W),me=A(X,Y),pe=L(q);return n.a.createElement(za,null,n.a.createElement(ir,{value:c,onChange:O}),n.a.createElement(N.EuiSpacer,{size:"l"}),n.a.createElement(N.EuiFlexGrid,{columns:2,gutterSize:"l",responsive:!1},n.a.createElement(sr,null,n.a.createElement(Ja,{title:tr,style:ne.b.line,chartRef:t,series:[{metric:te[0],series:U},{metric:te[1],series:H}],tickFormatterForTime:pe,tickFormatter:I,onPointerUpdate:V,domain:F(oe,te)})),n.a.createElement(sr,null,n.a.createElement(Ja,{title:ar,style:ne.b.line,chartRef:s,series:[{metric:ie[0],series:G},{metric:ie[1],series:K},{metric:ie[2],series:W}],tickFormatterForTime:pe,tickFormatter:_,onPointerUpdate:V,domain:F(de,ie)})),n.a.createElement(sr,null,n.a.createElement(Ja,{title:er,style:ne.b.line,chartRef:i,series:[{metric:se[0],series:X},{metric:se[1],series:Y}],tickFormatterForTime:pe,tickFormatter:D,onPointerUpdate:V,domain:F(me,se)})),n.a.createElement(sr,null,n.a.createElement(Ja,{title:Za,style:ne.b.line,chartRef:a,series:[{metric:re[0],series:q},{metric:re[1],series:J}],tickFormatterForTime:pe,tickFormatter:P,onPointerUpdate:V,domain:F(ue,re),stack:!0})),n.a.createElement(sr,null,n.a.createElement(Ja,{title:nr,style:ne.b.line,chartRef:o,series:[{metric:ae[0],series:ee}],tickFormatterForTime:pe,tickFormatter:R,onPointerUpdate:V,domain:F(le,ae),stack:!0})),h.map((e=>{const t=z(e.id),a=B([e.field],e.aggregation);return t?n.a.createElement(sr,null,n.a.createElement(Ja,{title:Object(Sa.a)(e),style:ne.b.line,chartRef:t=>{l.current[e.id]=t},series:[{metric:a[0],series:t}],tickFormatterForTime:pe,tickFormatter:Object(xe.a)(e),onPointerUpdate:V,domain:F(A(t),a),stack:!0})):null}))))}};var cr=a(171),ur=a.n(cr),dr=a(202),mr=(a(181),a(136));const pr={id:"logs",name:R.i18n.translate("xpack.infra.nodeDetails.tabs.logs",{defaultMessage:"Logs"}),content:e=>{const[t,a]=Object(r.useState)(""),i=e.currentTime,s=i-36e5,{nodeType:o}=Object(Ia.d)(),{node:l}=e,c=ur()(t,gr),u=Object(r.useMemo)((()=>({language:"kuery",query:[`${Object(Q.a)(o).id}: "${l.id}"`,...""!==c?[c]:[]].join(" and ")})),[o,l.id,c]),d=Object(r.useCallback)((e=>{a(e.target.value)}),[]),m=Object(Ve.b)(Object(mr.b)({nodeType:o,nodeId:l.id,time:s}));return n.a.createElement(za,null,n.a.createElement(N.EuiFlexGroup,{gutterSize:"m",alignItems:"center",responsive:!1},n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiFieldSearch,{fullWidth:!0,placeholder:R.i18n.translate("xpack.infra.nodeDetails.logs.textFieldPlaceholder",{defaultMessage:"Search for log entries..."}),value:t,isClearable:!0,onChange:d})),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButtonEmpty,ee()({size:"xs",flush:"both",iconType:"popout"},m),n.a.createElement(V.FormattedMessage,{id:"xpack.infra.nodeDetails.logs.openLogsLink",defaultMessage:"Open in Logs"})))),n.a.createElement(dr.a,{startTimestamp:s,endTimestamp:i,query:u}))}},gr=1e3;var fr=a(97),br=a(19),hr=a(101);const yr=d()((function(e){const{hostTerm:t,to:a}=e,{createDerivedIndexPattern:r}=Object(ce.b)();return{hostTerm:t,indexPattern:r().title,to:a}})),[Er,vr]=yr,xr={running:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateRunning",{defaultMessage:"Running"}),sleeping:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateSleeping",{defaultMessage:"Sleeping"}),dead:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateDead",{defaultMessage:"Dead"}),stopped:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateStopped",{defaultMessage:"Stopped"}),idle:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateIdle",{defaultMessage:"Idle"}),zombie:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateZombie",{defaultMessage:"Zombie"}),unknown:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.stateUnknown",{defaultMessage:"Unknown"})},kr=["running","sleeping","stopped","idle","dead","zombie","unknown"],Or=({processSummary:e,isLoading:t})=>{const a=Object(r.useMemo)((()=>({total:t?-1:e.total,...Object(ve.mapValues)(xr,(()=>t?-1:0)),...t?{}:e})),[e,t]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlexGroup,{gutterSize:"m",responsive:!1,wrap:!0},Object.entries(a).map((([e,t])=>n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiDescriptionList,{compressed:!0},n.a.createElement(jr,null,Mr[e]),n.a.createElement(N.EuiDescriptionListDescription,null,-1===t?n.a.createElement(wr,null):t)))))),n.a.createElement(N.EuiHorizontalRule,{margin:"m"}))},Mr={total:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.headingTotalProcesses",{defaultMessage:"Total processes"}),...xr},wr=Object(z.euiStyled)(N.EuiLoadingSpinner).attrs({size:"m"})`
  margin-top: 2px;
  margin-bottom: 3px;
`,jr=Object(z.euiStyled)(N.EuiDescriptionListTitle)`
  white-space: nowrap;
`;var Sr=a(37);const Cr=({command:e})=>{const{loading:t,error:a,response:i}=function(e){const[t,a]=Object(r.useState)(!1),{hostTerm:n,indexPattern:i,to:s}=vr(),{error:o,loading:l,response:c,makeRequest:u}=Object(hr.a)("/api/metrics/process_list/chart","POST",JSON.stringify({hostTerm:n,indexPattern:i,to:s,command:e}),(e=>Object(h.pipe)(fr.h.decode(e),Object(y.fold)(Object(br.c)(br.a),E.identity))));return Object(r.useEffect)((()=>a(!0)),[o]),Object(r.useEffect)((()=>a(!1)),[l]),Object(r.useEffect)((()=>{u()}),[u]),{error:t,loading:l,response:c,makeRequest:u}}(e),s=t||!i,o=a?n.a.createElement(N.EuiEmptyPrompt,{iconType:"alert",title:n.a.createElement(N.EuiText,null,Ir)}):s?n.a.createElement(N.EuiLoadingChart,null):n.a.createElement(Tr,{timeseries:i.cpu,color:Le.a.color2,label:Lr}),l=a?n.a.createElement(N.EuiEmptyPrompt,{iconType:"alert",title:n.a.createElement(N.EuiText,null,Ir)}):s?n.a.createElement(N.EuiLoadingChart,null):n.a.createElement(Tr,{timeseries:i.memory,color:Le.a.color0,label:Pr});return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiDescriptionListTitle,null,Lr),n.a.createElement(N.EuiDescriptionListDescription,null,o)),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiDescriptionListTitle,null,Pr),n.a.createElement(N.EuiDescriptionListDescription,null,l)))},Tr=({timeseries:e,color:t,label:a})=>{const i={color:t,aggregation:"avg",label:a},s=Object(A.useUiSetting)("theme:darkMode"),o=Object(r.useMemo)((()=>{var t,a;if(!e)return()=>"";const r=null===(t=Object(ve.first)(e.rows))||void 0===t?void 0:t.timestamp,n=null===(a=Object(ve.last)(e.rows))||void 0===a?void 0:a.timestamp;return null==r||null==n?e=>`${e}`:Object(Ee.niceTimeFormatter)([r,n])}),[e]),l=Object(Sr.b)("percent"),c={headerFormatter:e=>p()(e.value).format("Y-MM-DD HH:mm:ss.SSS")},u=Object(Qe.a)(e,[i],!1),d=u?{max:1.1*u.max,min:u.min}:{max:0,min:0};return n.a.createElement(Fr,null,n.a.createElement(Ee.Chart,null,n.a.createElement(ke.a,{type:ne.b.area,metric:i,id:"0",series:e,stack:!1}),n.a.createElement(Ee.Axis,{id:"timestamp",position:Ee.Position.Bottom,showOverlappingTicks:!0,tickFormat:o}),n.a.createElement(Ee.Axis,{id:"values",position:Ee.Position.Left,tickFormat:l,domain:d,ticks:6,showGridLines:!0}),n.a.createElement(Ee.Settings,{tooltip:c,theme:Je(s)})))},Fr=z.euiStyled.div`
  width: 100%;
  height: 140px;
`,Lr=R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelCPU",{defaultMessage:"CPU"}),Pr=R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelMemory",{defaultMessage:"Memory"}),Ir=R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.failedToLoadChart",{defaultMessage:"Unable to load chart"}),Dr=({cells:e,item:t})=>{const[a,i]=Object(r.useState)(!1);return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiTableRow,null,n.a.createElement(N.EuiTableRowCell,{isExpander:!0,textOnly:!1},n.a.createElement(N.EuiButtonEmpty,{iconType:a?"arrowDown":"arrowRight","aria-expanded":a,onClick:()=>i(!a)})),e),n.a.createElement(N.EuiTableRow,{isExpandable:!0,isExpandedRow:a},a&&n.a.createElement(ma.a,{bounds:!0},(({measureRef:e,bounds:{height:a=0}})=>n.a.createElement(Br,{commandHeight:a},n.a.createElement(N.EuiSpacer,{size:"s"}),n.a.createElement(_r,null,n.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},n.a.createElement(N.EuiFlexItem,null,n.a.createElement("div",{ref:e},n.a.createElement(N.EuiDescriptionListTitle,null,R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelCommand",{defaultMessage:"Command"})),n.a.createElement(N.EuiDescriptionListDescription,null,n.a.createElement(Ar,null,t.command)))),t.apmTrace&&n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,null,R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.viewTraceInAPM",{defaultMessage:"View trace in APM"})))),n.a.createElement(N.EuiFlexGrid,{columns:2,gutterSize:"s",responsive:!1},n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiDescriptionListTitle,null,R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelPID",{defaultMessage:"PID"})),n.a.createElement(N.EuiDescriptionListDescription,null,n.a.createElement(Rr,null,t.pid))),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiDescriptionListTitle,null,R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.expandedRowLabelUser",{defaultMessage:"User"})),n.a.createElement(N.EuiDescriptionListDescription,null,n.a.createElement(Rr,null,t.user))),n.a.createElement(Cr,{command:t.command}))))))))},_r=Object(z.euiStyled)(N.EuiDescriptionList).attrs({compressed:!0})`
  width: 100%;
`,Rr=Object(z.euiStyled)(N.EuiCode).attrs({transparentBackground:!0})`
  padding: 0 !important;
  & code.euiCodeBlock__code {
    white-space: nowrap !important;
    vertical-align: middle;
  }
`,Ar=Object(z.euiStyled)(N.EuiCode).attrs({transparentBackground:!0})`
  padding: 0 !important;
  margin-bottom: ${e=>e.theme.eui.euiSizeS};
`,Br=Object(z.euiStyled)(N.EuiTableRowCell).attrs({textOnly:!1,colSpan:6})`
  height: ${e=>e.commandHeight+240}px;
  padding: 0 ${e=>e.theme.eui.paddingSizes.m};
  background-color: ${e=>e.theme.eui.euiColorLightestShade};
`,Nr=({state:e})=>{switch(e){case"running":return n.a.createElement(N.EuiBadge,{color:"success"},xr.running);case"sleeping":return n.a.createElement(N.EuiBadge,{color:"default"},xr.sleeping);case"dead":return n.a.createElement(N.EuiBadge,{color:"danger"},xr.dead);case"stopped":return n.a.createElement(N.EuiBadge,{color:"warning"},xr.stopped);case"idle":return n.a.createElement(N.EuiBadge,{color:"primary"},xr.idle);case"zombie":return n.a.createElement(N.EuiBadge,{color:"danger"},xr.zombie);default:return n.a.createElement(N.EuiBadge,{color:"hollow"},xr.unknown)}};const Vr=({processList:e,currentTime:t,isLoading:a,sortBy:i,setSortBy:s,clearSearchBar:o})=>{const{updateSortableProperties:l}=function(e,t,a){const[n]=Object(r.useState)(new N.SortableProperties(e,t));return{updateSortableProperties:Object(r.useCallback)((e=>{n.sortOn(e),a(Object(ve.omit)(n.getSortedProperty(),"getValue"))}),[n,a])}}([{name:"startTime",getValue:e=>Date.parse(e.startTime),isAscending:!0},{name:"cpu",getValue:e=>e.cpu,isAscending:!1},{name:"memory",getValue:e=>e.memory,isAscending:!1}],"cpu",s),c=Object(r.useMemo)((()=>e.sort(((e,t)=>kr.indexOf(e.state)-kr.indexOf(t.state)))),[e]);return a?n.a.createElement(zr,null):0===c.length?n.a.createElement(N.EuiEmptyPrompt,{iconType:"search",titleSize:"s",title:n.a.createElement("strong",null,R.i18n.translate("xpack.infra.metrics.nodeDetails.noProcesses",{defaultMessage:"No processes found"})),body:n.a.createElement(N.EuiText,{size:"s"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.noProcessesBody",defaultMessage:"Try modifying your filter. Only processes that are within the configured {metricbeatDocsLink} will display here.",values:{metricbeatDocsLink:n.a.createElement(N.EuiLink,{href:"https://www.elastic.co/guide/en/beats/metricbeat/current/metricbeat-module-system.html",target:"_blank"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metrics.nodeDetails.noProcessesBody.metricbeatDocsLinkText",defaultMessage:"top N by CPU or Memory"}))}})),actions:n.a.createElement(N.EuiButton,{onClick:o},R.i18n.translate("xpack.infra.metrics.nodeDetails.noProcessesClearFilters",{defaultMessage:"Clear filters"}))}):n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiTable,{responsive:!1},n.a.createElement(N.EuiTableHeader,null,n.a.createElement(N.EuiTableHeaderCell,{width:24}),Gr.map((e=>{var t;return n.a.createElement(N.EuiTableHeaderCell,{key:`${String(e.field)}-header`,align:null!==(t=e.align)&&void 0!==t?t:N.LEFT_ALIGNMENT,width:e.width,onSort:e.sortable?()=>l(e.field):void 0,isSorted:i.name===e.field,isSortAscending:i.name===e.field&&i.isAscending},e.name)}))),n.a.createElement(Ur,null,n.a.createElement($r,{items:c,currentTime:t}))))},zr=()=>n.a.createElement("div",{style:{width:"100%",height:"200px",padding:"16px",display:"flex",alignItems:"center",justifyContent:"center"}},n.a.createElement(N.EuiLoadingChart,{size:"xl"})),$r=({items:e,currentTime:t})=>n.a.createElement(n.a.Fragment,null,e.map(((e,a)=>{const r=Gr.map((r=>{var i,s;return n.a.createElement(N.EuiTableRowCell,{key:`${String(r.field)}-${a}`,mobileOptions:{header:r.name},align:null!==(i=r.align)&&void 0!==i?i:N.LEFT_ALIGNMENT,textOnly:null===(s=r.textOnly)||void 0===s||s},r.render?r.render(e[r.field],t):e[r.field])}));return n.a.createElement(Dr,{cells:r,item:e,key:`row-${a}`})}))),Ur=Object(z.euiStyled)(N.EuiTableBody)`
  & .euiTableCellContent {
    padding-top: 0;
    padding-bottom: 0;

  }
`,Hr=6e4,qr=36e5,Jr=({startTime:e,currentTime:t})=>{let a=t-e;const r=Math.floor(a/qr);a-=r*qr;const i=Math.floor(a/Hr);a-=i*Hr;const s=Math.floor(a/1e3);a-=1e3*s;const o=r?`${r}:`:"",l=i<10?`0${i}:`:`${i}:`,c=s<10?`0${s}`:s;return n.a.createElement(n.a.Fragment,null,`${o}${l}${c}`)},Gr=[{field:"state",name:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelState",{defaultMessage:"State"}),sortable:!1,render:e=>n.a.createElement(Nr,{state:e}),width:84,textOnly:!1},{field:"command",name:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelCommand",{defaultMessage:"Command"}),sortable:!1,width:"40%",render:e=>n.a.createElement(Kr,null,e)},{field:"startTime",name:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelTime",{defaultMessage:"Time"}),align:N.RIGHT_ALIGNMENT,sortable:!0,render:(e,t)=>n.a.createElement(Jr,{startTime:e,currentTime:t})},{field:"cpu",name:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelCPU",{defaultMessage:"CPU"}),sortable:!0,render:e=>Sr.a.percent(e)},{field:"memory",name:R.i18n.translate("xpack.infra.metrics.nodeDetails.processes.columnLabelMemory",{defaultMessage:"Mem."}),sortable:!0,render:e=>Sr.a.percent(e)}],Kr=z.euiStyled.div`
  font-family: ${e=>e.theme.eui.euiCodeFontFamily};
  font-size: ${e=>e.theme.eui.euiFontSizeS};
  white-space: pre;
  overflow: hidden;
  text-overflow: ellipsis;
`,Wr=e=>e.replace(/([+-=!\(\)\{\}\[\]^"~*?:\\/!]|&&|\|\|)/g,"\\$1"),Qr={id:"processes",name:R.i18n.translate("xpack.infra.metrics.nodeDetails.tabs.processes",{defaultMessage:"Processes"}),content:({currentTime:e,node:t,nodeType:a})=>{var i,s;const[o,l]=Object(r.useState)(N.Query.MATCH_ALL),[c,u]=Object(r.useState)(""),[d,m]=Object(r.useState)({name:"cpu",isAscending:!1}),p=Object(r.useMemo)((()=>{var e;return{[null!==(e=Object(Q.c)(a))&&void 0!==e?e:a]:t.name}}),[t,a]),{loading:g,error:f,response:b,makeRequest:v}=function(e,t,a,n){const{createDerivedIndexPattern:i}=Object(ce.b)(),s=i().title,[o,l]=Object(r.useState)(!1),c="runtimeLength"===a.name?{...a,name:"startTime"}:a,{error:u,loading:d,response:m,makeRequest:p}=Object(hr.a)("/api/metrics/process_list","POST",JSON.stringify({hostTerm:e,indexPattern:s,to:t,sortBy:c,searchFilter:n}),(e=>Object(h.pipe)(fr.i.decode(e),Object(y.fold)(Object(br.c)(br.a),E.identity))));return Object(r.useEffect)((()=>l(!0)),[u]),Object(r.useEffect)((()=>l(!1)),[d]),Object(r.useEffect)((()=>{p()}),[p]),{error:o,loading:d,response:m,makeRequest:p}}(p,e,d,(e=>{if(""===e.trim())return[{match_all:{}}];const t=e.split(" ").map((e=>e.trim())).filter(Boolean),a=t.filter((e=>e.startsWith("state=")));return[...t.filter((e=>!e.startsWith("state="))).map((e=>({query_string:{fields:["system.process.cmdline"],query:`*${Wr(e)}*`,minimum_should_match:1}}))),...a.map((e=>({match:{"system.process.state":e.replace("state=","")}})))]})(c)),x=Object(r.useMemo)((()=>Object(ve.debounce)((e=>u(e)),500)),[u]),k=Object(r.useCallback)((({query:e,queryText:t})=>{l(e),x(t)}),[l,x]),O=Object(r.useCallback)((()=>{l(N.Query.MATCH_ALL),u("")}),[l,u]);return n.a.createElement(za,null,n.a.createElement(Er,{hostTerm:p,to:e},n.a.createElement(Or,{isLoading:g,processSummary:null!==(i=f?null:null==b?void 0:b.summary)&&void 0!==i?i:{total:0}}),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiText,null,n.a.createElement("h4",null,R.i18n.translate("xpack.infra.metrics.nodeDetails.processesHeader",{defaultMessage:"Top processes"})," ",n.a.createElement(N.EuiIconTip,{"aria-label":R.i18n.translate("xpack.infra.metrics.nodeDetails.processesHeader.tooltipLabel",{defaultMessage:"More info"}),size:"m",type:"iInCircle",content:R.i18n.translate("xpack.infra.metrics.nodeDetails.processesHeader.tooltipBody",{defaultMessage:"The table below aggregates the top CPU and top memory consuming processes. It does not display all processes."})}))),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiSearchBar,{query:o,onChange:k,box:{incremental:!0,placeholder:R.i18n.translate("xpack.infra.metrics.nodeDetails.searchForProcesses",{defaultMessage:"Search for processes…"})},filters:[{type:"field_value_selection",field:"state",name:"State",operator:"exact",multiSelect:!1,options:Object.entries(xr).map((([e,t])=>({value:e,view:t})))}]}),n.a.createElement(N.EuiSpacer,{size:"m"}),f?n.a.createElement(N.EuiEmptyPrompt,{iconType:"alert",title:n.a.createElement("h4",null,R.i18n.translate("xpack.infra.metrics.nodeDetails.processListError",{defaultMessage:"Unable to load process data"})),actions:n.a.createElement(N.EuiButton,{color:"primary",fill:!0,onClick:v},R.i18n.translate("xpack.infra.metrics.nodeDetails.processListRetry",{defaultMessage:"Try again"}))}):n.a.createElement(Vr,{currentTime:e,isLoading:g||!b,processList:null!==(s=null==b?void 0:b.processList)&&void 0!==s?s:[],sortBy:d,setSortBy:m,clearSearchBar:O})))}};var Xr=a(162),Yr=a(176);const Zr=(e,t)=>{const a=t.filter((e=>e&&"metrics"===e.source)).map((e=>e&&e.name));return e.filter((e=>{const t=(0,Yr.a.tsvb[e])(pe.i,"test",">=1m");return a.some((e=>e&&t.requires.includes(e)))}))};function en(e,t,a,n,i){const{error:s,loading:o,response:l,makeRequest:c}=Object(hr.a)("/api/infra/metadata","POST",JSON.stringify({nodeId:e,nodeType:t,sourceId:n,timeRange:{from:i.from,to:i.to}}),(e=>Object(h.pipe)(Xr.a.decode(e),Object(y.fold)(Object(br.c)(br.a),E.identity))));return Object(r.useEffect)((()=>{(async()=>{await c()})()}),[c]),{name:l&&l.name||"",filteredRequiredMetrics:l&&Zr(a,l.features)||[],error:s&&s.message||null,loading:o,metadata:l,cloudId:l&&l.info&&l.info.cloud&&l.info.cloud.instance&&l.info.cloud.instance.id||""}}const tn=(e,t)=>{var a,r,n,i,s,o,l,c,u,d,m,p,g,f,b,h,y,E,v,x,k,O,M,w,j,S,C,T,F,L,P,I,D,_,R,A,B,N,V,z,$,U,H,q,J,G,K,W,Q,X,Y,Z,ee,te,ae,re,ne;switch(t){case"host":return an([{name:"host.architecture",value:null===(a=e.info)||void 0===a||null===(r=a.host)||void 0===r?void 0:r.architecture},{name:"host.hostname",value:null===(n=e.info)||void 0===n||null===(i=n.host)||void 0===i?void 0:i.name},{name:"host.id",value:null===(s=e.info)||void 0===s||null===(o=s.host)||void 0===o?void 0:o.id},{name:"host.ip",value:null===(l=e.info)||void 0===l||null===(c=l.host)||void 0===c?void 0:c.ip},{name:"host.mac",value:null===(u=e.info)||void 0===u||null===(d=u.host)||void 0===d?void 0:d.mac},{name:"host.name",value:null===(m=e.info)||void 0===m||null===(p=m.host)||void 0===p?void 0:p.name},{name:"host.os.build",value:null===(g=e.info)||void 0===g||null===(f=g.host)||void 0===f||null===(b=f.os)||void 0===b?void 0:b.build},{name:"host.os.family",value:null===(h=e.info)||void 0===h||null===(y=h.host)||void 0===y||null===(E=y.os)||void 0===E?void 0:E.family},{name:"host.os.name",value:null===(v=e.info)||void 0===v||null===(x=v.host)||void 0===x||null===(k=x.os)||void 0===k?void 0:k.name},{name:"host.os.kernel",value:null===(O=e.info)||void 0===O||null===(M=O.host)||void 0===M||null===(w=M.os)||void 0===w?void 0:w.kernel},{name:"host.os.platform",value:null===(j=e.info)||void 0===j||null===(S=j.host)||void 0===S||null===(C=S.os)||void 0===C?void 0:C.platform},{name:"host.os.version",value:null===(T=e.info)||void 0===T||null===(F=T.host)||void 0===F||null===(L=F.os)||void 0===L?void 0:L.version}]);case"cloud":return an([{name:"cloud.account.id",value:null===(P=e.info)||void 0===P||null===(I=P.cloud)||void 0===I||null===(D=I.account)||void 0===D?void 0:D.id},{name:"cloud.account.name",value:null===(_=e.info)||void 0===_||null===(R=_.cloud)||void 0===R||null===(A=R.account)||void 0===A?void 0:A.name},{name:"cloud.availability_zone",value:null===(B=e.info)||void 0===B||null===(N=B.cloud)||void 0===N?void 0:N.availability_zone},{name:"cloud.instance.id",value:null===(V=e.info)||void 0===V||null===(z=V.cloud)||void 0===z||null===($=z.instance)||void 0===$?void 0:$.id},{name:"cloud.instance.name",value:null===(U=e.info)||void 0===U||null===(H=U.cloud)||void 0===H||null===(q=H.instance)||void 0===q?void 0:q.name},{name:"cloud.machine.type",value:null===(J=e.info)||void 0===J||null===(G=J.cloud)||void 0===G||null===(K=G.machine)||void 0===K?void 0:K.type},{name:"cloud.provider",value:null===(W=e.info)||void 0===W||null===(Q=W.cloud)||void 0===Q?void 0:Q.provider},{name:"cloud.region",value:null===(X=e.info)||void 0===X||null===(Y=X.cloud)||void 0===Y?void 0:Y.region}]);case"agent":return an([{name:"agent.id",value:null===(Z=e.info)||void 0===Z||null===(ee=Z.agent)||void 0===ee?void 0:ee.id},{name:"agent.version",value:null===(te=e.info)||void 0===te||null===(ae=te.agent)||void 0===ae?void 0:ae.version},{name:"agent.policy",value:null===(re=e.info)||void 0===re||null===(ne=re.agent)||void 0===ne?void 0:ne.policy}])}},an=e=>e.filter((e=>!!e.value)),rn=e=>{const{rows:t,title:a,onClick:i}=e,s=Object(r.useMemo)((()=>[{field:"name",name:"",width:"35%",sortable:!1,render:(e,t)=>n.a.createElement(N.EuiText,{size:"xs"},n.a.createElement("strong",null,t.name))},{field:"value",name:"",width:"65%",sortable:!1,render:(e,t)=>n.a.createElement("span",null,n.a.createElement(N.EuiFlexGroup,{gutterSize:"xs",alignItems:"center",responsive:!1},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiToolTip,{content:R.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.setFilterTooltip",{defaultMessage:"View event with filter"})},n.a.createElement(N.EuiButtonIcon,{color:"text",size:"s",iconType:"filter","aria-label":R.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.filterAriaLabel",{defaultMessage:"Filter"}),onClick:()=>i(t)}))),n.a.createElement(N.EuiFlexItem,null,!Array.isArray(t.value)&&t.value,Array.isArray(t.value)&&n.a.createElement(nn,{values:t.value}))))}]),[i]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiText,null,n.a.createElement("h4",null,a)),n.a.createElement(N.EuiSpacer,{size:"s"}),n.a.createElement(table_TableWithoutHeader,{tableLayout:"fixed",compressed:!0,responsive:!1,columns:s,items:t}))};class table_TableWithoutHeader extends N.EuiBasicTable{renderTableHead(){return n.a.createElement(n.a.Fragment,null)}}const nn=e=>{const{values:t}=e,[a,i]=Object(r.useState)(!1),s=Object(r.useCallback)((()=>{i(!0)}),[]),o=Object(r.useCallback)((()=>{i(!1)}),[]);return n.a.createElement(n.a.Fragment,null,!a&&n.a.createElement(N.EuiFlexGroup,{gutterSize:"xs",responsive:!1,alignItems:"baseline",wrap:!0},n.a.createElement(N.EuiFlexItem,{grow:!1},Object(ve.first)(t)," ... "),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiLink,{onClick:s},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.nodeDetails.tabs.metadata.seeMore",defaultMessage:"+{count} more",values:{count:t.length}})))),a&&n.a.createElement("div",null,t.map((e=>n.a.createElement("div",{key:e},e))),n.a.createElement(N.EuiLink,{onClick:o},R.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.seeLess",{defaultMessage:"Show less"}))))},sn=z.euiStyled.div`
  &:not(:last-child) {
    margin-bottom: 16px
  }
`,on=()=>n.a.createElement("div",{style:{width:"100%",height:"200px",padding:"16px",display:"flex",alignItems:"center",justifyContent:"center"}},n.a.createElement(N.EuiLoadingChart,{size:"xl"})),ln={id:"properties",name:R.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.title",{defaultMessage:"Metadata"}),content:e=>{const t=e.node.id,a=e.nodeType,i=Object(Q.b)(a),{sourceId:s}=Object(r.useContext)(ce.a.Context),{currentTimeRange:o}=qt(),{applyFilterQuery:l}=ra(),{loading:c,metadata:u}=en(t,a,i.requiredMetrics,s,o),d=Object(r.useMemo)((()=>u?tn(u,"host"):null),[u]),m=Object(r.useMemo)((()=>u?tn(u,"cloud"):null),[u]),p=Object(r.useMemo)((()=>u?tn(u,"agent"):null),[u]),g=Object(r.useCallback)((e=>{l({kind:"kuery",expression:`${e.name}: "${e.value}"`})}),[l]);return c?n.a.createElement(on,null):n.a.createElement(za,null,d&&d.length>0&&n.a.createElement(sn,null,n.a.createElement(rn,{title:R.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.hostsHeader",{defaultMessage:"Hosts"}),onClick:g,rows:d})),m&&m.length>0&&n.a.createElement(sn,null,n.a.createElement(rn,{title:R.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.cloudHeader",{defaultMessage:"Cloud"}),onClick:g,rows:m})),p&&p.length>0&&n.a.createElement(sn,null,n.a.createElement(rn,{title:R.i18n.translate("xpack.infra.nodeDetails.tabs.metadata.agentHeader",{defaultMessage:"Agent"}),onClick:g,rows:p})))}};var cn=a(30);var un=a(7);const dn=b.tuple([b.union([b.string,b.number]),b.union([b.string,b.number])]),mn=b.keyof({metrics_hosts:null,metrics_k8s:null}),pn=b.keyof({anomalyScore:null,dataset:null,startTime:null}),gn=b.keyof({asc:null,desc:null}),fn=b.type({searchBefore:dn}),bn=b.type({searchAfter:dn}),hn=b.intersection([b.type({pageSize:b.number}),b.partial({cursor:b.union([fn,bn])})]),yn=b.type({field:pn,direction:gn}),En=b.keyof({memory_usage:null,network_in:null,network_out:null}),vn=b.intersection([b.type({id:b.string,anomalyScore:b.number,typical:b.number,actual:b.number,type:mn,influencers:b.array(b.string),duration:b.number,startTime:b.number,jobId:b.string}),b.partial({partitionFieldName:b.string,partitionFieldValue:b.string})]),xn=b.intersection([b.type({data:b.intersection([b.type({anomalies:b.array(vn),hasMoreEntries:b.boolean}),b.partial({paginationCursors:b.type({previousPageCursor:dn,nextPageCursor:dn})})])}),b.partial({timing:un.c})]),kn=b.type({data:b.intersection([b.type({sourceId:b.string,anomalyThreshold:b.number,timeRange:un.d}),b.partial({query:b.string,hostName:b.string,metric:En,pagination:hn,sort:yn})])}),On=b.intersection([b.type({id:b.string,anomalyScore:b.number,typical:b.number,actual:b.number,type:mn,influencers:b.array(b.string),duration:b.number,startTime:b.number,jobId:b.string}),b.partial({partitionFieldName:b.string,partitionFieldValue:b.string})]),Mn=b.intersection([b.type({data:b.intersection([b.type({anomalies:b.array(On),hasMoreEntries:b.boolean}),b.partial({paginationCursors:b.type({previousPageCursor:dn,nextPageCursor:dn})})])}),b.partial({timing:un.c})]),wn=b.type({data:b.intersection([b.type({sourceId:b.string,anomalyThreshold:b.number,timeRange:un.d}),b.partial({query:b.string,metric:En,pagination:hn,sort:yn})])});var jn=a(84);const Sn=(e,t)=>{const a={page:1,paginationCursor:void 0};switch(t.type){case"changePaginationOptions":case"changeSortOptions":return{...e,...a,...t.payload};case"changeHasNextPage":case"changeLastReceivedCursors":return{...e,...t.payload};case"fetchNextPage":return e.lastReceivedCursors?{...e,page:e.page+1,paginationCursor:{searchAfter:e.lastReceivedCursors.nextPageCursor}}:e;case"fetchPreviousPage":return e.lastReceivedCursors?{...e,page:e.page-1,paginationCursor:{searchBefore:e.lastReceivedCursors.previousPageCursor}}:e;case"changeTimeRange":case"changeFilteredDatasets":return{...e,...a,...t.payload};default:return e}},Cn={page:1,lastReceivedCursors:void 0,paginationCursor:void 0,hasNextPage:!1},Tn=({endTime:e,startTime:t,sourceId:a,anomalyThreshold:n,defaultSortOptions:i,defaultPaginationOptions:s,onGetMetricsHostsAnomaliesDatasetsError:o,filteredDatasets:l})=>{const{services:c}=Object(Ot.b)(),[u,d]=Object(r.useReducer)(Sn,Cn,(a=>({...a,paginationOptions:s,sortOptions:i,filteredDatasets:l,timeRange:{start:t,end:e}}))),[m,p]=Object(r.useState)([]),[g,f]=Object(jn.c)({cancelPreviousOn:"creation",createPromise:async(e,t)=>{const{timeRange:{start:r,end:i},sortOptions:s,paginationOptions:o,paginationCursor:l}=u;return await Fn({sourceId:a,anomalyThreshold:n,startTime:r,endTime:i,metric:e,query:t,sort:s,pagination:{...o,cursor:l}},c.http.fetch)},onResolve:({data:{anomalies:e,paginationCursors:t,hasMoreEntries:a}})=>{const{paginationCursor:r}=u;t&&d({type:"changeLastReceivedCursors",payload:{lastReceivedCursors:t}}),!r||r&&"searchAfter"in r?d({type:"changeHasNextPage",payload:{hasNextPage:a}}):r&&"searchBefore"in r&&d({type:"changeHasNextPage",payload:{hasNextPage:!0}}),p(e)}},[a,n,d,u.timeRange.start,u.timeRange.end,u.sortOptions,u.paginationOptions,u.paginationCursor,u.filteredDatasets]),b=Object(r.useCallback)((e=>{d({type:"changeSortOptions",payload:{sortOptions:e}})}),[d]),h=Object(r.useCallback)((e=>{d({type:"changePaginationOptions",payload:{paginationOptions:e}})}),[d]);Object(r.useEffect)((()=>{d({type:"changeTimeRange",payload:{timeRange:{start:t,end:e}}})}),[t,e]),Object(r.useEffect)((()=>{d({type:"changeFilteredDatasets",payload:{filteredDatasets:l}})}),[l]);const y=Object(r.useCallback)((()=>{u.lastReceivedCursors&&d({type:"fetchNextPage"})}),[d,u]),E=Object(r.useCallback)((()=>{u.lastReceivedCursors&&d({type:"fetchPreviousPage"})}),[d,u]);return{metricsK8sAnomalies:m,getMetricsK8sAnomalies:f,isLoadingMetricsK8sAnomalies:Object(r.useMemo)((()=>"pending"===g.state),[g.state]),hasFailedLoadingMetricsK8sAnomalies:Object(r.useMemo)((()=>"rejected"===g.state),[g.state]),changeSortOptions:b,sortOptions:u.sortOptions,changePaginationOptions:h,paginationOptions:u.paginationOptions,fetchPreviousPage:u.page>1?E:void 0,fetchNextPage:u.hasNextPage?y:void 0,page:u.page}},Fn=async(e,t)=>{const{sourceId:a,anomalyThreshold:r,startTime:n,endTime:i,metric:s,query:o,sort:l,pagination:c}=e,u=await t("/api/infra/infra_ml/results/metrics_k8s_anomalies",{method:"POST",body:JSON.stringify(wn.encode({data:{sourceId:a,anomalyThreshold:r,timeRange:{startTime:n,endTime:i},metric:s,query:o,sort:l,pagination:c}}))});return Object(br.b)(Mn)(u)},Ln=(e,t)=>{const a={page:1,paginationCursor:void 0};switch(t.type){case"changePaginationOptions":case"changeSortOptions":return{...e,...a,...t.payload};case"changeHasNextPage":case"changeLastReceivedCursors":return{...e,...t.payload};case"fetchNextPage":return e.lastReceivedCursors?{...e,page:e.page+1,paginationCursor:{searchAfter:e.lastReceivedCursors.nextPageCursor}}:e;case"fetchPreviousPage":return e.lastReceivedCursors?{...e,page:e.page-1,paginationCursor:{searchBefore:e.lastReceivedCursors.previousPageCursor}}:e;case"changeTimeRange":case"changeFilteredDatasets":return{...e,...a,...t.payload};default:return e}},Pn={page:1,lastReceivedCursors:void 0,paginationCursor:void 0,hasNextPage:!1},In=({endTime:e,startTime:t,sourceId:a,anomalyThreshold:n,defaultSortOptions:i,defaultPaginationOptions:s,onGetMetricsHostsAnomaliesDatasetsError:o,filteredDatasets:l})=>{const{services:c}=Object(Ot.b)(),[u,d]=Object(r.useReducer)(Ln,Pn,(a=>({...a,paginationOptions:s,sortOptions:i,filteredDatasets:l,timeRange:{start:t,end:e}}))),[m,p]=Object(r.useState)([]),[g,f]=Object(jn.c)({cancelPreviousOn:"creation",createPromise:async(e,t,r)=>{const{timeRange:{start:i,end:s},sortOptions:o,paginationOptions:l,paginationCursor:d}=u;return await Dn({sourceId:a,anomalyThreshold:n,startTime:i,endTime:s,metric:e,query:t,sort:o,pagination:{...l,cursor:d},hostName:r},c.http.fetch)},onResolve:({data:{anomalies:e,paginationCursors:t,hasMoreEntries:a}})=>{const{paginationCursor:r}=u;t&&d({type:"changeLastReceivedCursors",payload:{lastReceivedCursors:t}}),!r||r&&"searchAfter"in r?d({type:"changeHasNextPage",payload:{hasNextPage:a}}):r&&"searchBefore"in r&&d({type:"changeHasNextPage",payload:{hasNextPage:!0}}),p(e)}},[a,n,d,u.timeRange.start,u.timeRange.end,u.sortOptions,u.paginationOptions,u.paginationCursor,u.filteredDatasets]),b=Object(r.useCallback)((e=>{d({type:"changeSortOptions",payload:{sortOptions:e}})}),[d]),h=Object(r.useCallback)((e=>{d({type:"changePaginationOptions",payload:{paginationOptions:e}})}),[d]);Object(r.useEffect)((()=>{d({type:"changeTimeRange",payload:{timeRange:{start:t,end:e}}})}),[t,e]),Object(r.useEffect)((()=>{d({type:"changeFilteredDatasets",payload:{filteredDatasets:l}})}),[l]);const y=Object(r.useCallback)((()=>{u.lastReceivedCursors&&d({type:"fetchNextPage"})}),[d,u]),E=Object(r.useCallback)((()=>{u.lastReceivedCursors&&d({type:"fetchPreviousPage"})}),[d,u]);return{metricsHostsAnomalies:m,getMetricsHostsAnomalies:f,isLoadingMetricsHostsAnomalies:Object(r.useMemo)((()=>"pending"===g.state),[g.state]),hasFailedLoadingMetricsHostsAnomalies:Object(r.useMemo)((()=>"rejected"===g.state),[g.state]),changeSortOptions:b,sortOptions:u.sortOptions,changePaginationOptions:h,paginationOptions:u.paginationOptions,fetchPreviousPage:u.page>1?E:void 0,fetchNextPage:u.hasNextPage?y:void 0,page:u.page,timeRange:u.timeRange}},Dn=async(e,t)=>{const{sourceId:a,anomalyThreshold:r,startTime:n,endTime:i,metric:s,sort:o,pagination:l,query:c,hostName:u}=e,d=await t("/api/infra/infra_ml/results/metrics_hosts_anomalies",{method:"POST",body:JSON.stringify(kn.encode({data:{sourceId:a,anomalyThreshold:r,timeRange:{startTime:n,endTime:i},query:c,metric:s,sort:o,pagination:l,hostName:u}}))});return Object(br.b)(xn)(d)},_n=R.i18n.translate("xpack.infra.logs.analysis.anomaliesTablePreviousPageLabel",{defaultMessage:"Previous page"}),Rn=R.i18n.translate("xpack.infra.logs.analysis.anomaliesTableNextPageLabel",{defaultMessage:"Next page"}),An=({fetchPreviousPage:e,fetchNextPage:t,page:a,isLoading:r})=>n.a.createElement(N.EuiFlexGroup,{justifyContent:"center"},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiFlexGroup,null,n.a.createElement(N.EuiButtonIcon,{iconType:"arrowLeft",isDisabled:!e||r,onClick:e,"aria-label":_n}),n.a.createElement("span",null,n.a.createElement("strong",null,a)),n.a.createElement(N.EuiButtonIcon,{iconType:"arrowRight",isDisabled:!t||r,onClick:t,"aria-label":Rn}))));var Bn=a(82);const Nn=({anomaly:e})=>{const{actual:t,typical:a}=e,r=R.i18n.translate("xpack.infra.ml.anomalyFlyout.anomaliesTableMoreThanExpectedAnomalyMessage",{defaultMessage:"more"}),i=R.i18n.translate("xpack.infra.ml.anomalyFlyout.anomaliesTableFewerThanExpectedAnomalyMessage",{defaultMessage:"fewer"}),s=t>a,o=s?r:i,l=s?t/a:a/t,c=s?"sortUp":"sortDown",u=l!==1/0?`${Object(Bn.h)(l)}x`:"";return n.a.createElement(N.EuiFlexGroup,{gutterSize:"s",responsive:!1,alignItems:"center"},n.a.createElement(N.EuiFlexItem,{grow:!1,component:"span"},n.a.createElement(N.EuiIcon,{type:c})),n.a.createElement(N.EuiFlexItem,{component:"span"},`${u} ${o}`))};var Vn=a(168),zn=a(71),$n=a(182);const Un=b.type({capabilities:b.type({canGetJobs:b.boolean,canCreateJob:b.boolean,canDeleteJob:b.boolean,canOpenJob:b.boolean,canCloseJob:b.boolean,canForecastJob:b.boolean,canGetDatafeeds:b.boolean,canStartStopDatafeed:b.boolean,canUpdateJob:b.boolean,canUpdateDatafeed:b.boolean,canPreviewDatafeed:b.boolean}),isPlatinumOrTrialLicense:b.boolean,mlFeatureEnabledInSpace:b.boolean,upgradeInProgress:b.boolean}),Hn=()=>{const{services:e}=Object(Ot.b)(),[t,a]=Object(r.useState)(Gn),[n,i]=Object(jn.c)({cancelPreviousOn:"resolution",createPromise:async()=>{const t=await e.http.fetch("/api/ml/ml_capabilities");return Object(h.pipe)(Un.decode(t),Object(y.fold)(Object(br.c)(br.a),E.identity))},onResolve:e=>{a(e)}},[]);Object(r.useEffect)((()=>{i()}),[i]);const s=Object(r.useMemo)((()=>"pending"===n.state),[n.state]),o=t.capabilities.canCreateJob,l=t.capabilities.canGetJobs;return{hasInfraMLCapabilities:t.isPlatinumOrTrialLicense&&t.mlFeatureEnabledInSpace,hasInfraMLReadCapabilities:l,hasInfraMLSetupCapabilities:o,isLoading:s}},[qn,Jn]=d()(Hn),Gn={capabilities:{canGetJobs:!1,canCreateJob:!1,canDeleteJob:!1,canOpenJob:!1,canCloseJob:!1,canForecastJob:!1,canGetDatafeeds:!1,canStartStopDatafeed:!1,canUpdateJob:!1,canUpdateDatafeed:!1,canPreviewDatafeed:!1,canGetCalendars:!1,canCreateCalendar:!1,canDeleteCalendar:!1,canGetFilters:!1,canCreateFilter:!1,canDeleteFilter:!1,canFindFileStructure:!1,canGetDataFrameJobs:!1,canDeleteDataFrameJob:!1,canPreviewDataFrameJob:!1,canCreateDataFrameJob:!1,canStartStopDataFrameJob:!1},isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var Kn=a(177),Wn=a(103);const Qn=({jobTypes:e})=>({jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{}),jobSummaries:[],lastSetupErrorMessages:[],setupStatus:{type:"initializing"}}),Xn=e=>t=>t.filter((t=>t.id===e&&t.success&&!t.error)).length>0,Yn=e=>t=>t.filter((t=>t.id===e&&t.success&&t.started&&!t.error)).length>0,Zn=e=>t=>t.filter((t=>t.id===e)).map((e=>"failed"===e.jobState||""===e.datafeedState?"failed":"closed"===e.jobState&&"stopped"===e.datafeedState&&e.fullJob&&null!=e.fullJob.finished_time?"finished":"closed"===e.jobState||"closing"===e.jobState||"stopped"===e.datafeedState?"stopped":"opening"===e.jobState&&!1===e.awaitingNodeAssignment?"initializing":"opened"===e.jobState&&"started"===e.datafeedState||"opening"===e.jobState&&"starting"===e.datafeedState&&!0===e.awaitingNodeAssignment?"started":"unknown"))[0]||"missing",ei=e=>t=>Object.entries(e).reduce(((e,[,t])=>"missing"===t?{type:"required"}:"required"===e.type||"succeeded"===e.type?e:"skipped"===e.type||Object(Wn.e)(t)?{type:"skipped",newlyCreated:"skipped"===e.type&&e.newlyCreated}:e),t),ti=e=>null!=e.error,ai=e=>Object(r.useReducer)((e=>(t,a)=>{switch(a.type){case"startedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"initializing"})),{}),setupStatus:{type:"pending"}};case"finishedSetup":{const{datafeedSetupResults:r,jobSetupResults:n,jobSummaries:i,spaceId:s,sourceId:o}=a,l=e.reduce(((e,t)=>({...e,[t]:Xn(Object(Wn.c)(s,o,t))(n)&&Yn(Object(Wn.b)(s,o,t))(r)?"started":"failed"})),{}),c=Object.values(l).every((e=>"started"===e))?{type:"succeeded"}:{type:"failed",reasons:[...Object.values(r).filter(ti).map((e=>e.error.msg)),...Object.values(n).filter(ti).map((e=>e.error.msg))]};return{...t,jobStatus:l,jobSummaries:i,setupStatus:c}}case"failedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"failed"})),{}),setupStatus:{type:"failed",reasons:["unknown"]}};case"fetchingJobStatuses":return{...t,setupStatus:"unknown"===t.setupStatus.type?{type:"initializing"}:t.setupStatus};case"fetchedJobStatuses":{const{payload:r,spaceId:n,sourceId:i}=a,{setupStatus:s}=t,o=e.reduce(((e,t)=>({...e,[t]:Zn(Object(Wn.c)(n,i,t))(r)})),{}),l=ei(o)(s);return{...t,jobSummaries:r,jobStatus:o,setupStatus:l}}case"failedFetchingJobStatuses":return{...t,setupStatus:{type:"unknown"},jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{})};case"viewedResults":return{...t,setupStatus:{type:"skipped",newlyCreated:!0}};default:return t}})(e),{jobTypes:e},Qn),ri=({sourceConfiguration:e,moduleDescriptor:t})=>{const{services:a}=Object(Ot.b)(),{spaceId:n,sourceId:i}=e,[s,o]=ai(t.jobTypes),[,l]=Object(jn.c)({cancelPreviousOn:"resolution",createPromise:async()=>(o({type:"fetchingJobStatuses"}),await t.getJobSummary(n,i,a.http.fetch)),onResolve:e=>{o({type:"fetchedJobStatuses",payload:e,spaceId:n,sourceId:i})},onReject:()=>{o({type:"failedFetchingJobStatuses"})}},[n,i]),[,c]=Object(jn.c)({cancelPreviousOn:"resolution",createPromise:async(e,r,s,l,c)=>{o({type:"startedSetup"});return{setupResult:await t.setUpModule({start:r,end:s,filter:l,moduleSourceConfiguration:{indices:e,sourceId:i,spaceId:n},partitionField:c},a.http.fetch),jobSummaries:await t.getJobSummary(n,i,a.http.fetch)}},onResolve:({setupResult:{datafeeds:e,jobs:t},jobSummaries:a})=>{o({type:"finishedSetup",datafeedSetupResults:e,jobSetupResults:t,jobSummaries:a,spaceId:n,sourceId:i})},onReject:()=>{o({type:"failedSetup"})}},[t.setUpModule,n,i]),[u,d]=Object(jn.c)({cancelPreviousOn:"resolution",createPromise:async()=>await t.cleanUpModule(n,i,a.http.fetch)},[n,i]),m=Object(r.useMemo)((()=>"pending"===u.state),[u.state]),p=Object(r.useCallback)(((e,t,a,r,n)=>{o({type:"startedSetup"}),d().then((()=>{c(e,t,a,r,n)})).catch((()=>{o({type:"failedSetup"})}))}),[d,o,c]),g=Object(r.useCallback)((()=>{o({type:"viewedResults"})}),[o]),f=Object(r.useMemo)((()=>t.getJobIds(n,i)),[t,n,i]);return{cleanUpAndSetUpModule:p,cleanUpModule:d,fetchJobStatus:l,isCleaningUp:m,jobIds:f,jobStatus:s.jobStatus,jobSummaries:s.jobSummaries,lastSetupErrorMessages:s.lastSetupErrorMessages,moduleDescriptor:t,setUpModule:c,setupStatus:s.setupStatus,sourceConfiguration:e,viewResults:g}},ni=({moduleDescriptor:e,sourceConfiguration:t})=>({getIsJobConfigurationOutdated:Object(r.useMemo)((()=>ii(e,t)),[t,e])}),ii=({bucketSpan:e},t)=>a=>{if(!a.fullJob||!a.fullJob.custom_settings)return!1;const r=a.fullJob.custom_settings.metrics_source_config;return!(r&&r.bucketSpan===e&&r.indexPattern&&si(new Set(r.indexPattern.split(",")),new Set(t.indices)))},si=(e,t)=>Array.from(e).every((e=>t.has(e))),oi=({sourceConfiguration:{spaceId:e,sourceId:t},moduleDescriptor:a})=>{const{services:n}=Object(Ot.b)(),[i,s]=Object(r.useState)(),o=Object(r.useMemo)((()=>i?i.jobs.reduce(((a,r)=>({...a,[Object(Bn.k)(e,t,r.id)]:r})),{}):{}),[i,t,e]),[l,c]=Object(jn.c)({cancelPreviousOn:"resolution",createPromise:async()=>await a.getModuleDefinition(n.http.fetch),onResolve:e=>{s(e)},onReject:()=>{s(void 0)}},[a.getModuleDefinition,e,t]),u=Object(r.useCallback)((e=>{var t,a,r;const n=o[e.id];if(null==n)return!1;const i=null==n?void 0:n.config.custom_settings.job_revision;return(null!==(t=null===(a=e.fullJob)||void 0===a||null===(r=a.custom_settings)||void 0===r?void 0:r.job_revision)&&void 0!==t?t:0)<(null!=i?i:0)}),[o]);return{fetchModuleDefinition:c,fetchModuleDefinitionRequestState:l.state,getIsJobDefinitionOutdated:u,jobDefinitionByJobId:o,moduleDefinition:i}},li=async e=>{const t=await e("/api/ml/jobs/deleting_jobs_tasks");return Object(br.b)(di)(t)},ci=b.type({jobIds:b.array(b.string)}),ui=b.record(b.string,b.type({deleted:b.boolean})),di=b.type({jobIds:b.array(b.string)}),mi=b.type({datafeedIds:b.array(b.string)}),pi=b.record(b.string,b.type({stopped:b.boolean})),gi=async(e,t,a,r)=>{try{await(async(e,t)=>{const{spaceId:a,sourceId:r,jobTypes:n}=e,i=await t("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify(mi.encode({datafeedIds:n.map((e=>Object(Wn.b)(a,r,e)))}))});return Object(br.b)(pi)(i)})({spaceId:e,sourceId:t,jobTypes:a},r)}catch(e){var n;if(404!==(null==e||null===(n=e.res)||void 0===n?void 0:n.status))throw e}return await fi(e,t,a,r)},fi=async(e,t,a,r)=>{const n=await(async(e,t)=>{const{spaceId:a,sourceId:r,jobTypes:n}=e,i=await t("/api/ml/jobs/delete_jobs",{method:"POST",body:JSON.stringify(ci.encode({jobIds:n.map((e=>Object(Wn.c)(a,r,e)))}))});return Object(br.b)(ui)(i)})({spaceId:e,sourceId:t,jobTypes:a},r);return await bi(e,t,a,r),n},bi=async(e,t,a,r)=>{const n=a.map((a=>Object(Wn.c)(e,t,a)));for(;;){const{jobIds:e}=await li(r);if(!e.some((e=>n.includes(e))))return!0;await hi(1e3)}},hi=e=>new Promise((t=>setTimeout(t,e))),yi=async(e,t)=>{const{spaceId:a,sourceId:r,jobTypes:n}=e,i=await t("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify(Ei.encode({jobIds:n.map((e=>Object(Wn.c)(a,r,e)))}))});return Object(br.b)(wi)(i)},Ei=b.type({jobIds:b.array(b.string)}),vi=b.keyof({started:null,starting:null,stopped:null,stopping:null,"":null}),xi=b.keyof({closed:null,closing:null,deleting:null,failed:null,opened:null,opening:null}),ki=b.keyof({ok:null,warn:null}),Oi=b.type({categorization_status:ki,categorized_doc_count:b.number,dead_category_count:b.number,frequent_category_count:b.number,rare_category_count:b.number,total_category_count:b.number}),Mi=b.intersection([b.type({id:b.string,jobState:xi}),b.partial({awaitingNodeAssignment:b.boolean,datafeedIndices:b.array(b.string),datafeedState:vi,fullJob:b.partial({custom_settings:Wn.f,finished_time:b.number,model_size_stats:Oi})})]),wi=b.array(Mi),ji=async(e,t)=>{const a=await t(`/api/ml/modules/get_module/${e}`,{method:"GET"});return Object(br.b)(Ci)(a)},Si=b.type({id:b.string,config:b.type({custom_settings:Bn.q})}),Ci=b.type({id:b.string,jobs:b.array(Si)}),Ti=async(e,t)=>{const{moduleId:a,start:r,end:n,spaceId:i,sourceId:s,indexPattern:o,jobOverrides:l=[],datafeedOverrides:c=[],query:u}=e,d=await t(`/api/ml/modules/setup/${a}`,{method:"POST",body:JSON.stringify(Di.encode({start:r,end:n,indexPatternName:o,prefix:Object(Wn.d)(i,s),startDatafeed:!0,jobOverrides:l,datafeedOverrides:c,query:u}))});return Object(br.b)(Bi)(d)},Fi=b.partial({start:b.number,end:b.number}),Li=b.type({job_id:b.string,custom_settings:Wn.f}),Pi=b.object,Ii=b.intersection([b.strict({indexPatternName:b.string,prefix:b.string,startDatafeed:b.boolean,jobOverrides:b.array(Li),datafeedOverrides:b.array(Pi)}),b.exact(b.partial({query:b.object}))]),Di=b.intersection([Fi,Ii]),_i=b.type({msg:b.string}),Ri=b.intersection([b.type({id:b.string,started:b.boolean,success:b.boolean}),b.partial({error:_i})]),Ai=b.intersection([b.type({id:b.string,success:b.boolean}),b.partial({error:_i})]),Bi=b.type({datafeeds:b.array(Ri),jobs:b.array(Ai)});var Ni=a(268),Vi=a(269),zi=a(270),$i=a(271),Ui=a(272),Hi=a(273);const qi="metrics_ui_hosts",Ji=R.i18n.translate("xpack.infra.ml.metricsModuleName",{defaultMessage:"Metrics anomanly detection"}),Gi=R.i18n.translate("xpack.infra.ml.metricsHostModuleDescription",{defaultMessage:"Use Machine Learning to automatically detect anomalous log entry rates."}),Ki=(e,t)=>Wn.g.reduce(((a,r)=>({...a,[r]:Object(Wn.c)(e,t,r)})),{}),Wi=e=>{switch(e){case"hosts_memory_usage":return{datafeed:Vi,job:Ni};case"hosts_network_in":return{datafeed:$i,job:zi};case"hosts_network_out":return{datafeed:Hi,job:Ui}}},Qi={moduleId:qi,moduleName:Ji,moduleDescription:Gi,jobTypes:Wn.g,bucketSpan:Wn.a,getJobIds:Ki,getJobSummary:async(e,t,a)=>{const r=await yi({spaceId:e,sourceId:t,jobTypes:Wn.g},a),n=Object.values(Ki(e,t));return r.filter((e=>n.includes(e.id)))},getModuleDefinition:async e=>await ji(qi,e),setUpModule:async(e,t)=>{const{start:a,end:r,filter:n,moduleSourceConfiguration:{spaceId:i,sourceId:s,indices:o},partitionField:l}=e,c=o.join(","),u=["hosts_memory_usage","hosts_network_in","hosts_network_out"],d=u.map((e=>{const{job:t}=Wi(e),a={...t.analysis_config};return l&&(a.detectors[0].partition_field_name=l,-1===a.influencers.indexOf(l)&&a.influencers.push(l)),{job_id:e,data_description:{time_field:pe.i},analysis_config:a,custom_settings:{metrics_source_config:{indexPattern:c,timestampField:pe.i,bucketSpan:Wn.a}}}})),m=u.map((e=>{const{datafeed:t}=Wi(e),a={...t};if(n){const e=JSON.parse(n);a.query.bool={...a.query.bool,...e.bool}}if(!l||"hosts_memory_usage"===e)return{...a,job_id:e};const r={[l]:{terms:{field:l},aggregations:{...t.aggregations}}};return{...a,job_id:e,aggregations:r}}));return Ti({moduleId:qi,start:a,end:r,spaceId:i,sourceId:s,indexPattern:c,jobOverrides:d,datafeedOverrides:m},t)},cleanUpModule:async(e,t,a)=>await gi(e,t,Wn.g,a)},[Xi,Yi]=d()((({indexPattern:e,sourceId:t,spaceId:a})=>{const n=Object(r.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a})),[e,t,a]),i=ri({moduleDescriptor:Qi,sourceConfiguration:n}),{getIsJobConfigurationOutdated:s}=ni({sourceConfiguration:n,moduleDescriptor:Qi}),{fetchModuleDefinition:o,getIsJobDefinitionOutdated:l}=oi({sourceConfiguration:n,moduleDescriptor:Qi}),c=Object(r.useMemo)((()=>i.jobSummaries.some(s)),[s,i.jobSummaries]),u=Object(r.useMemo)((()=>i.jobSummaries.some(l)),[l,i.jobSummaries]),d=Object(r.useMemo)((()=>Object.values(i.jobStatus).some((e=>"stopped"===e))),[i.jobStatus]);return{...i,fetchModuleDefinition:o,hasOutdatedJobConfigurations:c,hasOutdatedJobDefinitions:u,hasStoppedJobs:d}}));var Zi=a(274),es=a(275),ts=a(276),as=a(277),rs=a(278),ns=a(279);const is="kubernetes.namespace",ss="metrics_ui_k8s",os=R.i18n.translate("xpack.infra.ml.metricsModuleName",{defaultMessage:"Metrics anomanly detection"}),ls=R.i18n.translate("xpack.infra.ml.metricsHostModuleDescription",{defaultMessage:"Use Machine Learning to automatically detect anomalous log entry rates."}),cs=(e,t)=>Wn.h.reduce(((a,r)=>({...a,[r]:Object(Wn.c)(e,t,r)})),{}),us=e=>{switch(e){case"k8s_memory_usage":return{datafeed:es,job:Zi};case"k8s_network_in":return{datafeed:as,job:ts};case"k8s_network_out":return{datafeed:ns,job:rs}}},ds={moduleId:ss,moduleName:os,moduleDescription:ls,jobTypes:Wn.h,bucketSpan:Wn.a,getJobIds:cs,getJobSummary:async(e,t,a)=>{const r=await yi({spaceId:e,sourceId:t,jobTypes:Wn.h},a),n=Object.values(cs(e,t));return r.filter((e=>n.includes(e.id)))},getModuleDefinition:async e=>await ji(ss,e),setUpModule:async(e,t)=>{const{start:a,end:r,filter:n,moduleSourceConfiguration:{spaceId:i,sourceId:s,indices:o},partitionField:l}=e,c=o.join(","),u=["k8s_memory_usage","k8s_network_in","k8s_network_out"],d=u.map((e=>{const{job:t}=us(e),a={...t.analysis_config};return l&&(a.detectors[0].partition_field_name=l,-1===a.influencers.indexOf(l)&&a.influencers.push(l)),{job_id:e,data_description:{time_field:pe.i},analysis_config:a,custom_settings:{metrics_source_config:{indexPattern:c,timestampField:pe.i,bucketSpan:Wn.a}}}})),m=u.map((e=>{const{datafeed:t}=us(e),a={...t};if(n){const e=JSON.parse(n);a.query.bool={...a.query.bool,...e.bool}}if(!l||"k8s_memory_usage"===e)return{...a,job_id:e};const r=t.aggregations["kubernetes.namespace"].aggregations,i={[l]:{terms:{field:l,size:25},aggregations:{...r}}};return{...a,job_id:e,aggregations:i}}));return Ti({moduleId:ss,start:a,end:r,spaceId:i,sourceId:s,indexPattern:c,jobOverrides:d,datafeedOverrides:m},t)},cleanUpModule:async(e,t,a)=>await gi(e,t,Wn.h,a)},[ms,ps]=d()((({indexPattern:e,sourceId:t,spaceId:a})=>{const n=Object(r.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a})),[e,t,a]),i=ri({moduleDescriptor:ds,sourceConfiguration:n}),{getIsJobConfigurationOutdated:s}=ni({sourceConfiguration:n,moduleDescriptor:ds}),{fetchModuleDefinition:o,getIsJobDefinitionOutdated:l}=oi({sourceConfiguration:n,moduleDescriptor:ds}),c=Object(r.useMemo)((()=>i.jobSummaries.some(s)),[s,i.jobSummaries]),u=Object(r.useMemo)((()=>i.jobSummaries.some(l)),[l,i.jobSummaries]),d=Object(r.useMemo)((()=>Object.values(i.jobStatus).some((e=>"stopped"===e))),[i.jobStatus]);return{...i,fetchModuleDefinition:o,hasOutdatedJobConfigurations:c,hasOutdatedJobDefinitions:u,hasStoppedJobs:d}})),gs=e=>{const[t,a]=Object(r.useState)("jobs"),{goToSetup:i,closeFlyout:s}=e,{fetchJobStatus:o,setupStatus:l,jobSummaries:c}=Yi(),{fetchJobStatus:u,setupStatus:d,jobSummaries:m}=ps(),{hasInfraMLCapabilities:p,hasInfraMLReadCapabilities:g,hasInfraMLSetupCapabilities:f}=Jn(),b=Object(r.useCallback)((()=>{i("hosts")}),[i]),h=Object(r.useCallback)((()=>{i("kubernetes")}),[i]),y=[...(m||[]).map((e=>e.id)),...(c||[]).map((e=>e.id))];Object(r.useEffect)((()=>{g&&(o(),u())}),[u,o,g]);const E=c.length>0||m.length>0,v=Object(Ve.b)({app:"ml",pathname:"/jobs"});return p?g?"initializing"===l.type||"initializing"===d.type?n.a.createElement(B.b,{message:R.i18n.translate("xpack.infra.ml.anomalyFlyout.jobStatusLoadingMessage",{defaultMessage:"Checking status of metrics jobs..."})}):f?n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlyoutHeader,null,n.a.createElement(N.EuiTitle,{size:"m"},n.a.createElement("h2",null,n.a.createElement(V.FormattedMessage,{defaultMessage:"Machine Learning anomaly detection",id:"xpack.infra.ml.anomalyFlyout.flyoutHeader"})))),n.a.createElement(N.EuiTabs,null,n.a.createElement(N.EuiTab,{isSelected:"jobs"===t,onClick:()=>a("jobs")},"Jobs"),n.a.createElement(N.EuiTab,{isSelected:"anomalies"===t,onClick:()=>a("anomalies"),"data-test-subj":"anomalyFlyoutAnomaliesTab"},"Anomalies")),n.a.createElement(N.EuiFlyoutBody,{banner:n.a.createElement(n.a.Fragment,null,"jobs"===t&&E&&n.a.createElement(n.a.Fragment,null,n.a.createElement(fs,{hasHostJobs:c.length>0,hasK8sJobs:m.length>0,jobIds:y})),n.a.createElement(zn.MLJobsAwaitingNodeWarning,{jobIds:y}))},"jobs"===t&&n.a.createElement(n.a.Fragment,null,E&&n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlexGroup,{gutterSize:"s"},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,ee()({},v,{style:{marginRight:5}}),n.a.createElement(V.FormattedMessage,{defaultMessage:"Manage jobs in ML",id:"xpack.infra.ml.anomalyFlyout.manageJobs"})))),n.a.createElement(N.EuiSpacer,{size:"l"})),n.a.createElement(N.EuiText,null,n.a.createElement("h4",null,"Create ML Jobs"),n.a.createElement("p",null,n.a.createElement(V.FormattedMessage,{defaultMessage:"Anomaly detection is powered by machine learning. Machine learning jobs are available for the following resource types. Enable these jobs to begin detecting anomalies in your infrastructure metrics.",id:"xpack.infra.ml.anomalyFlyout.createJobs"}))),n.a.createElement(N.EuiSpacer,{size:"l"}),n.a.createElement(bs,{hasHostJobs:c.length>0,hasK8sJobs:m.length>0,hasSetupCapabilities:e.hasSetupCapabilities,createHosts:b,createK8s:h})),"anomalies"===t&&n.a.createElement(ks,{closeFlyout:s}))):n.a.createElement(Kn.c,null):n.a.createElement(Kn.b,null):n.a.createElement($n.b,null)},fs=e=>{let t="";return e.hasHostJobs&&e.hasK8sJobs?t=`${R.i18n.translate("xpack.infra.ml.anomalyFlyout.create.hostTitle",{defaultMessage:"Hosts"})} and ${R.i18n.translate("xpack.infra.ml.anomalyFlyout.create.k8sSuccessTitle",{defaultMessage:"Kubernetes"})}`:e.hasHostJobs?t=R.i18n.translate("xpack.infra.ml.anomalyFlyout.create.hostSuccessTitle",{defaultMessage:"Hosts"}):e.hasK8sJobs&&(t=R.i18n.translate("xpack.infra.ml.anomalyFlyout.create.k8sSuccessTitle",{defaultMessage:"Kubernetes"})),n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiCallOut,{size:"m",color:"success",title:n.a.createElement(V.FormattedMessage,{defaultMessage:"Anomaly detection enabled for {target}",id:"xpack.infra.ml.anomalyFlyout.enabledCallout",values:{target:t}}),iconType:"check"}))},bs=e=>n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlexGroup,{gutterSize:"m"},n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiCard,{isDisabled:!e.hasSetupCapabilities,icon:n.a.createElement(N.EuiIcon,{type:"storage",size:"xl"}),title:n.a.createElement(V.FormattedMessage,{defaultMessage:"Hosts",id:"xpack.infra.ml.anomalyFlyout.create.hostTitle"}),description:n.a.createElement(V.FormattedMessage,{defaultMessage:"Detect anomalies for memory usage and network traffic on hosts.",id:"xpack.infra.ml.anomalyFlyout.create.hostDescription"}),footer:n.a.createElement(n.a.Fragment,null,e.hasHostJobs&&n.a.createElement(N.EuiButtonEmpty,{onClick:e.createHosts},n.a.createElement(V.FormattedMessage,{defaultMessage:"Recreate jobs",id:"xpack.infra.ml.anomalyFlyout.create.recreateButton"})),!e.hasHostJobs&&n.a.createElement(N.EuiButton,{onClick:e.createHosts},n.a.createElement(V.FormattedMessage,{defaultMessage:"Enable",id:"xpack.infra.ml.anomalyFlyout.create.createButton"})))})),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiCard,{isDisabled:!e.hasSetupCapabilities,icon:n.a.createElement(N.EuiIcon,{type:"logoKubernetes",size:"xl"}),title:n.a.createElement(V.FormattedMessage,{defaultMessage:"Kubernetes Pods",id:"xpack.infra.ml.anomalyFlyout.create.k8sTitle"}),description:n.a.createElement(V.FormattedMessage,{defaultMessage:"Detect anomalies for memory usage and network traffic on Kubernetes Pods.",id:"xpack.infra.ml.anomalyFlyout.create.k8sDescription"}),footer:n.a.createElement(n.a.Fragment,null,e.hasK8sJobs&&n.a.createElement(N.EuiButtonEmpty,{onClick:e.createK8s},n.a.createElement(V.FormattedMessage,{defaultMessage:"Recreate jobs",id:"xpack.infra.ml.anomalyFlyout.create.recreateButton"})),!e.hasK8sJobs&&n.a.createElement(N.EuiButton,{onClick:e.createK8s},n.a.createElement(V.FormattedMessage,{defaultMessage:"Enable",id:"xpack.infra.ml.anomalyFlyout.create.createButton"})))})))),hs=(e,t="absolute")=>{let a="";return a+=`(ml:(jobIds:!(${e.map((e=>`'${e}'`)).join(",")}))`,a+=`,refreshInterval:(display:Off,pause:!f,value:0),time:(from:'${p()().subtract(4,"weeks").toISOString()}'`,a+=`,to:'${p()().toISOString()}'`,"invalid"===t&&(a+=",mode:invalid"),a+="))&_a=(query:(query_string:(analyze_wildcard:!t,query:'*')))",a},ys={...Ia.b,filterQuery:Xt,time:Nt.currentTime,autoReload:Nt.isAutoReloading},Es=()=>{const{metric:e,groupBy:t,nodeType:a,view:n,customOptions:i,customMetrics:s,boundsOverride:o,autoBounds:l,accountId:c,region:u,legend:d,sort:m,timelineOpen:p,setWaffleOptionsState:g}=Object(Ia.d)(),{currentTime:f,isAutoReloading:b,setWaffleTimeState:h}=qt(),{filterQuery:y,setWaffleFiltersState:E}=ra(),v={metric:e,sort:m,groupBy:t,nodeType:a,view:n,customOptions:i,customMetrics:s,boundsOverride:o,autoBounds:l,accountId:c,region:u,time:f,autoReload:b,filterQuery:y,legend:d,timelineOpen:p},x=Object(r.useCallback)((e=>{g({sort:e.sort,metric:e.metric,groupBy:e.groupBy,nodeType:e.nodeType,view:e.view,customOptions:e.customOptions,customMetrics:e.customMetrics,boundsOverride:e.boundsOverride,autoBounds:e.autoBounds,accountId:e.accountId,region:e.region,legend:e.legend,timelineOpen:e.timelineOpen}),e.time&&h({currentTime:e.time,isAutoReloading:e.autoReload}),E(e.filterQuery)}),[g,h,E]);return{viewState:v,defaultViewState:ys,onViewChange:x}},vs=({jobId:e,type:t,startTime:a,closeFlyout:i,influencerField:s,influencers:o,disableShowInInventory:l})=>{const[c,u]=Object(r.useState)(!1),d=Object(r.useCallback)((()=>u(!1)),[u]),m=Object(r.useCallback)((()=>u(!c)),[c]),{onViewChange:p}=Es(),g=Object(r.useCallback)((()=>{const r=e.split("-"),n={metric:{type:{memory_usage:"memory",network_in:"rx",network_out:"tx"}[r[r.length-1].replace(/hosts_|k8s_/,"")]},sort:{by:"name",direction:"desc"},groupBy:[],nodeType:"metrics_k8s"===t?"pod":"host",view:"map",customOptions:[],customMetrics:[],boundsOverride:{max:1,min:0},autoBounds:!0,accountId:"",region:"",autoReload:!1,filterQuery:{expression:o.reduce(((e,t)=>(e&&(e=`${e} or `),`${e} ${s}: "${t}"`)),""),kind:"kuery"},legend:{palette:"cool",reverseColors:!1,steps:10},time:a};p(n),i()}),[e,p,a,t,o,s,i]),f=Object(Ve.b)({app:"ml",pathname:`/explorer?_g=${hs([e.toString()])}`}),b=[n.a.createElement(N.EuiContextMenuItem,ee()({key:"openInAnomalyExplorer",icon:"popout"},f),n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.actions.openInAnomalyExplorer",defaultMessage:"Open in Anomaly Explorer"}))];return l||b.push(n.a.createElement(N.EuiContextMenuItem,{key:"showInInventory",icon:"search",onClick:g},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.actions.showInInventory",defaultMessage:"Show in Inventory"}))),n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiPopover,{anchorPosition:"downRight",panelPaddingSize:"none",button:n.a.createElement(N.EuiButtonIcon,{iconType:"boxesHorizontal",onClick:m,"aria-label":R.i18n.translate("xpack.infra.ml.anomalyFlyout.actions.openActionMenu",{defaultMessage:"Open"})}),isOpen:c,closePopover:d},n.a.createElement(N.EuiContextMenuPanel,{items:b})))},xs=Object(z.withTheme)((({theme:e})=>n.a.createElement(N.EuiText,null,n.a.createElement(N.EuiSpacer,{size:"xl"}),n.a.createElement("p",null,n.a.createElement(N.EuiIcon,{type:"eyeClosed",size:"xl",color:e.eui.euiColorMediumShade})),n.a.createElement("h3",{"data-test-subj":"noAnomaliesFoundMsg"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.anomalyTable.noAnomaliesFound",defaultMessage:"No anomalies found"})),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiText,{color:"subdued"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.anomalyTable.noAnomaliesSuggestion",defaultMessage:"Try modifying your search or selected time range."}))))),ks=e=>{const{closeFlyout:t,hostName:a}=e,[i,s]=Object(r.useState)(""),[o,l]=Object(r.useState)("now-30d"),[c,u]=Object(r.useState)("now"),d=Object(de.useUiTracker)({app:"infra_metrics"}),[m,p]=Object(r.useState)({start:Object(cn.a)(o)||0,end:Object(cn.a)(c,"up")||0}),{sorting:g,setSorting:f}=function(e){const[t,a]=Object(r.useState)(e);return{sorting:t,setSorting:a}}({field:"startTime",direction:"desc"}),b=[{id:"hosts",label:R.i18n.translate("xpack.infra.ml.anomalyFlyout.hostBtn",{defaultMessage:"Hosts"}),"data-test-subj":"anomaliesHostComboBoxItem"},{id:"k8s",label:R.i18n.translate("xpack.infra.ml.anomalyFlyout.podsBtn",{defaultMessage:"Kubernetes Pods"}),"data-test-subj":"anomaliesK8sComboBoxItem"}],[h,y]=Object(r.useState)("hosts"),[E,v]=Object(r.useState)([b.find((e=>"hosts"===e.id))||b[0]]),{source:x}=Object(ce.b)(),k=null==x?void 0:x.configuration.anomalyThreshold,O=Object(r.useCallback)((({isInvalid:e,start:t,end:a})=>{e||(l(t),u(a),p({start:Object(cn.a)(t),end:Object(cn.a)(a,"up")}))}),[]),M=Object(r.useMemo)((()=>({sourceId:"default",anomalyThreshold:k||0,startTime:m.start,endTime:m.end,defaultSortOptions:{direction:(null==g?void 0:g.direction)||"desc",field:(null==g?void 0:g.field)||"startTime"},defaultPaginationOptions:{pageSize:10}})),[m.start,m.end,null==g?void 0:g.field,null==g?void 0:g.direction,k]),{metricsHostsAnomalies:w,getMetricsHostsAnomalies:j,page:S,changeSortOptions:C,fetchNextPage:T,fetchPreviousPage:F,isLoadingMetricsHostsAnomalies:L}=In(M),{metricsK8sAnomalies:P,getMetricsK8sAnomalies:I,page:D,changeSortOptions:_,fetchNextPage:A,fetchPreviousPage:B,isLoadingMetricsK8sAnomalies:z}=Tn(M),$=Object(r.useMemo)((()=>"hosts"===h?S:D),[h,S,D]),U=Object(r.useMemo)((()=>"hosts"===h?L:z),[h,L,z]),H=Object(r.useMemo)((()=>"hosts"===h?T:A),[h,T,A]),q=Object(r.useMemo)((()=>"hosts"===h?F:B),[h,F,B]),J=Object(r.useMemo)((()=>"hosts"===h?j:"k8s"===h?I:void 0),[h,I,j]),G=Object(r.useMemo)((()=>"hosts"===h?w:P),[h,w,P]),K=Object(r.useCallback)((e=>{s(e.target.value)}),[]),W=Object(r.useCallback)((e=>{v(e),y(e[0].id)}),[]),Q=Object(r.useCallback)((e=>{"hosts"===h?C(e):_(e)}),[C,_,h]);Object(r.useEffect)((()=>{G&&G.forEach((e=>{e.influencers.length>100&&d({metric:"metrics_ml_anomaly_detection_more_than_100_influencers"})}))}),[G,d]);let X=[{field:"startTime",name:R.i18n.translate("xpack.infra.ml.anomalyFlyout.columnTime",{defaultMessage:"Time"}),width:"15%",sortable:!0,textOnly:!0,truncateText:!0,render:e=>n.a.createElement(V.FormattedDate,{value:e,year:"numeric",month:"short",day:"2-digit"})},{field:"jobId",name:R.i18n.translate("xpack.infra.ml.anomalyFlyout.columnJob",{defaultMessage:"Job"}),width:"25%",render:e=>e,"data-test-subj":"anomalyRow"},{field:"anomalyScore",name:R.i18n.translate("xpack.infra.ml.anomalyFlyout.columnSeverit",{defaultMessage:"Severity"}),width:"15%",sortable:!0,render:e=>n.a.createElement(Vn.a,{anomalyScore:e})},{field:"typical",name:R.i18n.translate("xpack.infra.ml.anomalyFlyout.columnSummary",{defaultMessage:"Summary"}),width:"15%",textOnly:!0,render:(e,t)=>n.a.createElement(Nn,{anomaly:t})},{field:"influencers",name:R.i18n.translate("xpack.infra.ml.anomalyFlyout.columnInfluencerName",{defaultMessage:"Node name"}),width:"20%",textOnly:!0,truncateText:!0,render:e=>e.join(",")},{name:R.i18n.translate("xpack.infra.ml.anomalyFlyout.columnActionsName",{defaultMessage:"Actions"}),width:"10%",actions:[{render:e=>n.a.createElement(vs,{jobId:e.jobId,type:e.type,influencerField:"metrics_hosts"===e.type?"host.name":"kubernetes.pod.uid",disableShowInInventory:e.influencers.length>100,influencers:e.influencers,startTime:e.startTime,closeFlyout:t})}]}];return X=a?X.filter((e=>!("field"in e)||"influencers"!==e.field)):X,Object(r.useEffect)((()=>{J&&J(void 0,i,a)}),[J,i,a]),n.a.createElement("div",null,n.a.createElement(N.EuiFlexGroup,null,n.a.createElement(N.EuiFlexItem,{grow:1},n.a.createElement(N.EuiSuperDatePicker,{start:o,end:c,showUpdateButton:!1,onTimeChange:O}))),!a&&n.a.createElement(N.EuiFlexGroup,{alignItems:"center"},n.a.createElement(N.EuiFlexItem,{grow:3},n.a.createElement(N.EuiFieldSearch,{fullWidth:!0,placeholder:R.i18n.translate("xpack.infra.ml.anomalyFlyout.searchPlaceholder",{defaultMessage:"Search"}),value:i,onChange:K,isClearable:!0})),n.a.createElement(N.EuiFlexItem,{grow:1},n.a.createElement(N.EuiComboBox,{placeholder:R.i18n.translate("xpack.infra.ml.anomalyFlyout.jobTypeSelect",{defaultMessage:"Select group"}),singleSelection:{asPlainText:!0},options:b,selectedOptions:E,onChange:W,isClearable:!1,"data-test-subj":"anomaliesComboBoxType"}))),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiBasicTable,{columns:X,items:G,sorting:{sort:g},onChange:e=>{var t,a;f(e.sort),Q({field:(null==e||null===(t=e.sort)||void 0===t?void 0:t.field)||"startTime",direction:(null==e||null===(a=e.sort)||void 0===a?void 0:a.direction)||"desc"})},hasActions:!0,loading:U,noItemsMessage:U?n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.anomalyFlyout.anomalyTable.loading",defaultMessage:"Loading anomalies"}):n.a.createElement(xs,null)}),n.a.createElement(N.EuiSpacer,{size:"l"}),n.a.createElement(An,{fetchNextPage:H,fetchPreviousPage:q,page:$,isLoading:U}))},Os={id:"anomalies",name:R.i18n.translate("xpack.infra.nodeDetails.tabs.anomalies",{defaultMessage:"Anomalies"}),content:e=>{const{node:t,onClose:a}=e;return n.a.createElement(za,null,n.a.createElement(ks,{closeFlyout:a,hostName:t.name}))}},Ms={id:"osquery",name:R.i18n.translate("xpack.infra.nodeDetails.tabs.osquery",{defaultMessage:"Osquery"}),content:e=>{const t=e.node.id,a=e.nodeType,i=Object(Q.b)(a),{sourceId:s}=Object(r.useContext)(ce.a.Context),{currentTimeRange:o}=qt(),{loading:l,metadata:c}=en(t,a,i.requiredMetrics,s,o),{services:{osquery:u}}=Object(Ot.b)(),d=null==u?void 0:u.OsqueryAction;return Object(r.useMemo)((()=>l||!d?n.a.createElement(za,null,n.a.createElement(N.EuiLoadingContent,{lines:10})):n.a.createElement(za,null,n.a.createElement(d,{metadata:c}))),[d,l,c])}},ws=(e,t,a)=>{if("host"===t&&a.ip)return{app:"uptime",hash:"/",search:{search:`host.ip:"${a.ip}"`}};const r=Object(Q.c)(t);return{app:"uptime",hash:"/",search:{search:`${r?r+":":""}"${a.id}"`}}},js=({isOpen:e,node:t,nodeType:a,currentTime:i,options:s,onClose:o,openAlertFlyout:l})=>{var c;const u=[lr,pr,Qr,ln,Os,Ms],d=Object(Q.b)(a),m=i-1e3*d.metrics.defaultTimeRangeInSeconds,p=null===(c=Object(A.useKibana)().services.application)||void 0===c?void 0:c.capabilities,g=Object(r.useMemo)((()=>{var e;return Boolean(null==p||null===(e=p.infrastructure)||void 0===e?void 0:e.save)}),[p]),f=Object(r.useMemo)((()=>u.map((e=>{const r=e.content;return{...e,content:n.a.createElement(r,{onClose:o,node:t,nodeType:a,currentTime:i,options:s})}}))),[u,t,a,i,o,s]),[b,h]=Object(r.useState)(0),y=Object(Ve.b)({..._({nodeType:a,nodeId:t.id,from:m,to:i})}),E="host"===a?"host.hostname":d.fields.id,v=Object(Ve.b)({app:"apm",hash:"traces",search:{kuery:`${E}:"${t.id}"`}}),x=Object(Ve.b)(ws(0,a,t));return e?n.a.createElement(N.EuiPortal,null,n.a.createElement(N.EuiOutsideClickDetector,{onOutsideClick:o},n.a.createElement(Cs,null,n.a.createElement(Ss,null,n.a.createElement(N.EuiFlexGroup,{responsive:!1,gutterSize:"m"},n.a.createElement(Ts,{grow:!0},n.a.createElement(N.EuiTitle,{size:"xs"},n.a.createElement("h4",null,t.name))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiFlexGroup,{gutterSize:"m",responsive:!1},g&&n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButtonEmpty,{onClick:l,size:"xs",iconSide:"left",flush:"both",iconType:"bell"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.infra.nodeDetails.createAlertLink",defaultMessage:"Create inventory rule"}))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButtonEmpty,{size:"xs",iconSide:"left",iconType:"popout",href:y.href,flush:"both"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.infra.nodeDetails.openAsPage",defaultMessage:"Open as page"}))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButtonIcon,{size:"s",onClick:o,iconType:"cross"}))))),n.a.createElement(N.EuiSpacer,{size:"s"}),n.a.createElement(N.EuiTabs,{size:"s"},f.map(((e,t)=>n.a.createElement(N.EuiTab,{key:e.id,isSelected:t===b,onClick:()=>h(t)},e.name))),n.a.createElement(N.EuiTab,v,n.a.createElement(N.EuiIcon,{type:"popout"})," ",n.a.createElement(V.FormattedMessage,{id:"xpack.infra.infra.nodeDetails.apmTabLabel",defaultMessage:"APM"})),n.a.createElement(N.EuiTab,x,n.a.createElement(N.EuiIcon,{type:"popout"})," ",n.a.createElement(V.FormattedMessage,{id:"xpack.infra.infra.nodeDetails.updtimeTabLabel",defaultMessage:"Uptime"})))),f[b].content))):null},Ss=z.euiStyled.div`
  padding-top: ${e=>e.theme.eui.paddingSizes.m};
  padding-right: ${e=>e.theme.eui.paddingSizes.m};
  padding-left: ${e=>e.theme.eui.paddingSizes.m};
  background-color: ${e=>e.theme.eui.euiPageBackgroundColor};
  box-shadow: inset 0 -1px ${e=>e.theme.eui.euiBorderColor};
`,Cs=Object(z.euiStyled)(N.EuiPanel).attrs({paddingSize:"none"})`
  display: flex;
  flex-direction: column;
  position: absolute;
  right: 16px;
  top: ${266}px;
  width: 100%;
  max-width: 720px;
  z-index: 2;
  max-height: calc(100vh - ${282}px);
  overflow: hidden;

  @media (max-width: 752px) {
    border-radius: 0px !important;
    left: 0px;
    right: 0px;
    top: 97px;
    bottom: 0;
    max-height: calc(100vh - 97px);
    max-width: 100%;
  }
`,Ts=Object(z.euiStyled)(N.EuiFlexItem)`
  overflow: hidden;
  & h4 {
    text-overflow: ellipsis;
    overflow: hidden;
    white-space: nowrap;
  }
`,Fs=({options:e,nodeType:t,filter:a,visible:i,setVisible:s})=>{const{triggersActionsUI:o}=Object(r.useContext)(Oe.a),{inventoryPrefill:l}=Object(we.b)(),{customMetrics:c}=l,u=Object(r.useCallback)((()=>s(!1)),[s]),d=Object(r.useMemo)((()=>o&&o.getAddAlertFlyout({consumer:"infrastructure",onClose:u,canChangeTrigger:!1,alertTypeId:Me.c,metadata:{options:e,nodeType:t,filter:a,customMetrics:c}})),[o,i]);return n.a.createElement(n.a.Fragment,null,i&&d)},Ls=({onClose:e})=>{const{inventoryPrefill:t}=Object(we.b)(),{nodeType:a,metric:r,filterQuery:i}=t;return n.a.createElement(Fs,{options:{metric:r},nodeType:a,filter:i,visible:!0,setVisible:e})},Ps=Object(z.withTheme)((({options:e,currentTime:t,node:a,nodeType:i})=>{var s,o,l;const[c,u]=Object(r.useState)(!1),d=Object(Q.b)(i),m=t-1e3*d.metrics.defaultTimeRangeInSeconds,p=null===(s=Object(A.useKibana)().services.application)||void 0===s?void 0:s.capabilities,g="host"===i?"host.hostname":d.fields.id,f=d.crosslinkSupport.details,b=d.crosslinkSupport.logs&&a.id&&(null==p||null===(o=p.logs)||void 0===o?void 0:o.show),h=d.crosslinkSupport.apm&&(null==p?void 0:p.apm)&&(null==p?void 0:p.apm.show),y=d.crosslinkSupport.uptime&&(["pod","container"].includes(i)||a.ip),E=null==p||null===(l=p.infrastructure)||void 0===l?void 0:l.save,v=Object(r.useMemo)((()=>{if("host"!==i){const{id:e}=Object(Q.a)(i);return{label:n.a.createElement(N.EuiCode,null,e),value:a.id}}return a.ip?{label:n.a.createElement(N.EuiCode,null,"host.ip"),value:a.ip}:{label:"",value:""}}),[i,a.ip,a.id]),x=Object(Ve.b)(Object(mr.b)({nodeType:i,nodeId:a.id,time:t})),k=Object(Ve.b)({..._({nodeType:i,nodeId:a.id,from:m,to:t})}),O=Object(Ve.b)({app:"apm",hash:"traces",search:{kuery:`${g}:"${a.id}"`}}),M=Object(Ve.b)(ws(0,i,a)),w={label:R.i18n.translate("xpack.infra.nodeContextMenu.viewLogsName",{defaultMessage:"{inventoryName} logs",values:{inventoryName:d.singularDisplayName}}),...x,"data-test-subj":"viewLogsContextMenuItem",isDisabled:!b},j={label:R.i18n.translate("xpack.infra.nodeContextMenu.viewMetricsName",{defaultMessage:"{inventoryName} metrics",values:{inventoryName:d.singularDisplayName}}),...k,isDisabled:!f},S={label:R.i18n.translate("xpack.infra.nodeContextMenu.viewAPMTraces",{defaultMessage:"{inventoryName} APM traces",values:{inventoryName:d.singularDisplayName}}),...O,"data-test-subj":"viewApmTracesContextMenuItem",isDisabled:!h},C={label:R.i18n.translate("xpack.infra.nodeContextMenu.viewUptimeLink",{defaultMessage:"{inventoryName} in Uptime",values:{inventoryName:d.singularDisplayName}}),...M,isDisabled:!y},T={label:R.i18n.translate("xpack.infra.nodeContextMenu.createRuleLink",{defaultMessage:"Create inventory rule"}),onClick:()=>{u(!0)},isDisabled:!E};return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{style:{maxWidth:300},"data-test-subj":"nodeContextMenu"},n.a.createElement(de.Section,null,n.a.createElement(de.SectionTitle,null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.nodeContextMenu.title",defaultMessage:"{inventoryName} details",values:{inventoryName:d.singularDisplayName}})),v.label&&n.a.createElement(de.SectionSubtitle,null,n.a.createElement("div",{style:{wordBreak:"break-all"}},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.nodeContextMenu.description",defaultMessage:"View details for {label} {value}",values:{label:v.label,value:v.value}}))),n.a.createElement(de.SectionLinks,null,n.a.createElement(de.SectionLink,ee()({"data-test-subj":"viewLogsContextMenuItem"},w)),n.a.createElement(de.SectionLink,j),n.a.createElement(de.SectionLink,ee()({"data-test-subj":"viewApmTracesContextMenuItem"},S)),n.a.createElement(de.SectionLink,C)),n.a.createElement(de.ActionMenuDivider,null),n.a.createElement(de.SectionLinks,null,n.a.createElement(de.SectionLink,ee()({iconType:"bell",color:"primary"},T))))),c&&n.a.createElement(Fs,{filter:`${Object(Q.a)(i).id}: "${a.id}"`,options:e,nodeType:i,setVisible:u,visible:c}))})),Is={isPopoverOpen:!1,isOverlayOpen:!1,isAlertFlyoutVisible:!1,isToolTipOpen:!1};class node_Node extends n.a.PureComponent{constructor(...e){super(...e),xa()(this,"state",Is),xa()(this,"openAlertFlyout",(()=>{this.setState({isOverlayOpen:!1,isAlertFlyoutVisible:!0})})),xa()(this,"setAlertFlyoutVisible",(e=>{this.setState({isAlertFlyoutVisible:e})})),xa()(this,"togglePopover",(()=>{const{nodeType:e}=this.props;"host"===e?this.toggleNewOverlay():this.setState((e=>({isPopoverOpen:!e.isPopoverOpen})))})),xa()(this,"toggleNewOverlay",(()=>{this.setState((e=>({isPopoverOpen:!0!=!e.isOverlayOpen&&e.isPopoverOpen,isOverlayOpen:!e.isOverlayOpen})))})),xa()(this,"closePopover",(()=>{this.state.isPopoverOpen&&this.setState({isPopoverOpen:!1})})),xa()(this,"showToolTip",(()=>{this.setState({isToolTipOpen:!0})})),xa()(this,"hideToolTip",(()=>{this.setState({isToolTipOpen:!1})}))}render(){const{nodeType:e,node:t,options:a,squareSize:r,bounds:i,formatter:s,currentTime:o}=this.props,{isPopoverOpen:l,isAlertFlyoutVisible:c,isToolTipOpen:u}=this.state,d=Object(ve.first)(t.metrics),m=r>70,p=r>30,g=d&&d.value||0,f=((e,t,a,r="rgba(217, 217, 217, 1)")=>{try{return Ie.f.is(e)?Ra(Na(e.rules,t,r)):Ie.a.is(e)?Ra(Va(e.rules,t,a,r)):Ie.g.is(e)?Ra(Ba(e.rules,t,a,r)):r}catch(e){return r}})(a.legend,g,i),b=s(g),h=R.i18n.translate("xpack.infra.node.ariaLabel",{defaultMessage:"{nodeName}, click to open menu",values:{nodeName:t.name}}),y=this.state.isOverlayOpen?{border:"solid 4px #000"}:void 0,E=n.a.createElement(Ds,{"data-test-subj":"nodeContainer",style:{width:r||0,height:r||0},onClick:this.togglePopover,onMouseOver:this.showToolTip,onMouseLeave:this.hideToolTip,className:"buttonContainer"},n.a.createElement(Rs,{color:f,style:y},n.a.createElement(As,{color:f},m?n.a.createElement(Bs,{"aria-label":h},n.a.createElement(zs,{"data-test-subj":"nodeName",color:f},t.name),n.a.createElement(Vs,{"data-test-subj":"nodeValue",color:f},b)):p&&n.a.createElement(Bs,{"aria-label":h},n.a.createElement(zs,{color:f},"..."))))),v=n.a.createElement(_s,{"data-test-subj":"nodeContainer",style:{width:r||0,height:r||0,...y},onClick:this.togglePopover,onMouseOver:this.showToolTip,onMouseLeave:this.hideToolTip,color:f}),x=m||p?E:v;return n.a.createElement(n.a.Fragment,null,l?n.a.createElement(N.EuiPopover,{button:x,isOpen:l,closePopover:this.closePopover,anchorPosition:"downCenter",style:{height:r}},n.a.createElement(Ps,{node:t,nodeType:e,options:a,currentTime:o})):u?n.a.createElement(N.EuiToolTip,{delay:"regular",position:"right",content:n.a.createElement(Da,{currentTime:o,node:t,nodeType:e})},x):x,this.state.isOverlayOpen&&n.a.createElement(js,{openAlertFlyout:this.openAlertFlyout,node:t,nodeType:e,isOpen:this.state.isOverlayOpen,options:a,currentTime:o,onClose:this.toggleNewOverlay}),c&&n.a.createElement(Fs,{filter:`${Object(Q.a)(e).id}: "${t.id}"`,options:a,nodeType:e,setVisible:this.setAlertFlyoutVisible,visible:c}))}}const Ds=z.euiStyled.div`
  position: relative;
  cursor: pointer;
`,_s=z.euiStyled.div`
  cursor: pointer;
  position: relative;
  background-color: ${e=>Object(ja.darken)(.1,e.color)};
  border-radius: 3px;
  margin: 2px;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
`,Rs=z.euiStyled.div`
  position: absolute;
  top: 4px;
  left: 4px;
  bottom: 4px;
  right: 4px;
  background-color: ${e=>Object(ja.darken)(.1,e.color)};
  border-radius: 3px;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
`,As=z.euiStyled.div`
  position: absolute;
  top: 0;
  right: 0;
  bottom: 2px;
  left: 0;
  border-radius: 3px;
  background-color: ${e=>e.color};
`,Bs=z.euiStyled.button`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  display: flex;
  line-height: 1.2em;
  align-items: center;
  align-content: center;
  padding: 1em;
  overflow: hidden;
  flex-wrap: wrap;
  width: 100%;
  border: none;
  &:focus {
    outline: none !important;
    border: ${e=>{var t;return null===(t=e.theme)||void 0===t?void 0:t.eui.euiFocusRingSize}} solid
      ${e=>{var t;return null===(t=e.theme)||void 0===t?void 0:t.eui.euiFocusRingColor}};
    box-shadow: none;
  }
`,Ns=z.euiStyled.div`
  text-align: center;
  width: 100%;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
  flex: 1 0 auto;
  color: ${e=>Object(ja.readableColor)(e.color)};
`,Vs=Object(z.euiStyled)(Ns)`
  font-weight: bold;
  font-size: 0.9em;
  line-height: 1.2em;
`,zs=Object(z.euiStyled)(Ns)`
  font-size: 0.7em;
  margin-bottom: 0.7em;
`,$s=(e,t)=>{const{bounds:a,group:r,...n}=e,{bounds:i,group:s,...o}=t,{nodes:l,...c}=e.group,{nodes:u,...d}=t.group;return Object(ve.isEqual)(n,o)&&Object(ve.isEqual)(c,d)},Us=n.a.memo((({group:e,options:t,formatter:a,onDrilldown:r,isChild:i=!1,bounds:s,nodeType:o,currentTime:l})=>{const c=e.width>200?e.width:200;return n.a.createElement(Hs,{style:{width:c}},n.a.createElement(group_name_GroupName,{group:e,onDrilldown:r,isChild:i,options:t}),n.a.createElement(qs,null,e.width?e.nodes.map((r=>n.a.createElement(node_Node,{key:`${r.pathId}:${r.name}`,options:t,squareSize:e.squareSize,node:r,formatter:a,bounds:s,nodeType:o,currentTime:l}))):n.a.createElement(N.EuiLoadingSpinner,{size:"xl"})))}),$s),Hs=z.euiStyled.div`
  margin: 0 10px;
`,qs=z.euiStyled.div`
  display: flex;
  background-color: rgba(0, 0, 0, 0.05);
  flex-wrap: wrap;
  justify-content: center;
  padding: 20px 10px 10px;
  border-radius: 4px;
  border: 1px solid ${e=>e.theme.eui.euiBorderColor};
  box-shadow: 0 1px 7px rgba(0, 0, 0, 0.1);
`,Js=e=>n.a.createElement(Gs,null,n.a.createElement(group_name_GroupName,{group:e.group,onDrilldown:e.onDrilldown,options:e.options}),n.a.createElement(Ks,null,e.group.groups.map((t=>n.a.createElement(Us,{isChild:!0,key:t.id,onDrilldown:e.onDrilldown,options:e.options,group:t,formatter:e.formatter,bounds:e.bounds,nodeType:e.nodeType,currentTime:e.currentTime}))))),Gs=z.euiStyled.div`
  margin: 0 10px;
  width: 100%;
`,Ks=z.euiStyled.div`
  display: flex;
  background-color: rgba(0, 0, 0, 0.05);
  flex-wrap: wrap;
  justify-content: center;
  padding: 20px 10px 10px;
  border-radius: 4px;
  border: 1px solid ${e=>e.theme.eui.euiBorderColor};
  box-shadow: 0 1px 7px rgba(0, 0, 0, 0.1);
`;function Ws(e,t=1,a=1){const r=t/a,n=r>1.2?1.2:r,i=Math.ceil(Math.sqrt(e));return Math.ceil(i*n)}function Qs(e){return e?e.reduce(((e,t)=>ga(t)?t.groups.reduce(((e,t)=>t.nodes.length+e),e):pa(t)?t.nodes.length+e:e),0):0}const Xs=e=>Qs([e]);function Ys(e,t,a){if(0===e.length)return[];const r=ga(Object(ve.first)(e))?2:1,n=Qs(e),i=Math.round(function(e,t,a,r=1){const n=.55/(r>1?.7*r:1),i=e*n,s=t*n,o=Math.ceil(Math.sqrt(a*i/s));let l,c;l=Math.floor(o*s/i)*o<a?s/Math.ceil(o*s/i):i/o;const u=Math.ceil(Math.sqrt(a*s/i));c=Math.floor(u*i/s)*u<a?i/Math.ceil(i*u/s):s/u;const d=Math.max(l,c);return Math.min(Math.max(d,24),1/0)}(t,a,n,r)),s=function(e){return e?e.reduce(((e,t)=>ga(t)?t.groups.reduce(((e,t)=>pa(t)?e>t.nodes.length?e:t.nodes.length:e),e):pa(t)?e>t.nodes.length?e:t.nodes.length:e),0):0}(e);return Object(ve.sortBy)(e,Xs).reverse().map((e=>{if(ga(e)){const r=Ws(s,t,a),n=e.groups,o=Object(ve.sortBy)(n,Xs).reverse().filter(pa).map((e=>({...e,count:e.nodes.length,columns:r,width:r*i,squareSize:i})));return{...e,groups:o,count:Qs([e]),squareSize:i}}if(pa(e)){const r=Ws(Math.max(e.nodes.length,s),t,a);return{...e,count:e.nodes.length,squareSize:i,width:r*i}}return e}))}const Zs={name:e=>Object(ve.last)(e.path),value:e=>{const t=Object(ve.first)(e.metrics);return t&&t.value||0}},eo=({nodes:e,options:t,currentTime:a,onFilter:r,formatter:i,bounds:s,nodeType:o,dataBounds:l,bottomMargin:c,staticHeight:u})=>{const d=Ea(((e,t)=>{const a=Zs[e.by],r=Object(ve.sortBy)(t,a);return"desc"===e.direction?r.reverse():r})(t.sort,e));return n.a.createElement(ma.a,{bounds:!0},(({measureRef:e,bounds:{width:l=0,height:m=0}})=>{const p=Ys(d,l,m);return n.a.createElement(to,{ref:t=>e(t),bottomMargin:c,"data-test-subj":"waffleMap",staticHeight:u},n.a.createElement(ao,null,p.map((e=>ga(e)?n.a.createElement(Js,{onDrilldown:r,key:e.id,options:t,group:e,formatter:i,bounds:s,nodeType:o,currentTime:a}):pa(e)?n.a.createElement(Us,{key:e.id,options:t,group:e,onDrilldown:r,formatter:i,isChild:!1,bounds:s,nodeType:o,currentTime:a}):void 0))))}))},to=z.euiStyled.div`
  flex: 1 0 0%;
  display: flex;
  justify-content: flex-start;
  flex-direction: column;
  overflow-x: hidden;
  overflow-y: auto;
  margin-bottom: ${e=>e.bottomMargin}px;
  ${e=>e.staticHeight&&"min-height: 300px;"}
`,ao=z.euiStyled.div`
  display: flex;
  flex-direction: row;
  flex-wrap: wrap;
  justify-content: center;
  align-content: flex-start;
  padding: 10px;
`;var ro=a(215),no=a(172);const io=e=>{switch(e.length){case 3:return e.slice(0,2);case 2:return e.slice(0,1);default:return[]}},so=e=>{const{nodes:t,options:a,formatter:i,currentTime:s,nodeType:o}=e,[l,c]=Object(r.useState)([]),u=Object(r.useCallback)((e=>()=>{c([...l,e])}),[l]),d=Object(r.useCallback)((e=>()=>{l.includes(e)&&c(l.filter((t=>t!==e)))}),[l]);Object(r.useEffect)((()=>{const e=document.getElementsByClassName(no.a)[0];e instanceof HTMLElement&&(l.length>0?e.style.overflowY="hidden":e.style.overflowY="auto")}),[l]);const m=[{field:"name",name:R.i18n.translate("xpack.infra.tableView.columnName.name",{defaultMessage:"Name"}),sortable:!0,truncateText:!0,textOnly:!0,render:(e,t)=>{const r=t.node.id===e?`${e}`:`${e} (${t.node.id})`,i=[...t.node.path.map((e=>e.value)),t.node.name].join(":"),c=n.a.createElement(N.EuiToolTip,{content:r},n.a.createElement(N.EuiButtonEmpty,{onClick:u(i)},e));return n.a.createElement(N.EuiPopover,{button:c,isOpen:l.includes(i),closePopover:d(i),anchorPosition:"rightCenter"},n.a.createElement(Ps,{node:t.node,nodeType:o,currentTime:s,options:a}))}},...a.groupBy.map(((t,a)=>({field:`group_${a}`,name:Object(ro.a)(t&&t.field||""),sortable:!0,truncateText:!0,textOnly:!0,render:a=>n.a.createElement(N.EuiToolTip,{content:"Set Filter"},n.a.createElement(N.EuiButtonEmpty,{onClick:()=>e.onFilter(`${t.field}:"${a}"`)},a))}))),{field:"value",name:R.i18n.translate("xpack.infra.tableView.columnName.last1m",{defaultMessage:"Last 1m"}),sortable:!0,truncateText:!0,dataType:"number",render:e=>n.a.createElement("span",null,i(e))},{field:"avg",name:R.i18n.translate("xpack.infra.tableView.columnName.avg",{defaultMessage:"Avg"}),sortable:!0,truncateText:!0,dataType:"number",render:e=>n.a.createElement("span",null,i(e))},{field:"max",name:R.i18n.translate("xpack.infra.tableView.columnName.max",{defaultMessage:"Max"}),sortable:!0,truncateText:!0,dataType:"number",render:e=>n.a.createElement("span",null,i(e))}],p=t.map((e=>{const t=Object(ve.last)(e.path),a=Object(ve.first)(e.metrics);return{name:t&&t.label||"unknown",...io(e.path).reduce(((e,t,a)=>({...e,[`group_${a}`]:t.label})),{}),value:a&&a.value||0,avg:a&&a.avg||0,max:a&&a.max||0,node:ha(e)}}));return n.a.createElement(N.EuiInMemoryTable,{pagination:!0,sorting:{sort:{field:"value",direction:"desc"}},items:p,columns:m})},oo=e=>{const t=e.map((e=>{const t=Object(ve.first)(e.metrics);return t&&t.value?t.value:0}));1===t.length&&t.unshift(0);const a=Object(ve.max)(t)||0,r=Object(ve.min)(t)||0;return{min:Object(ve.isFinite)(r)?r:0,max:Object(ve.isFinite)(a)?a:0}},lo=({autoBounds:e,boundsOverride:t,loading:a,nodes:i,nodeType:s,reload:o,view:l,currentTime:c,options:u,formatter:d,onDrilldown:m,bottomMargin:p,topMargin:g,showLoading:f})=>{const b=Object(r.useCallback)((e=>{m({kind:"kuery",expression:e})}),[m]),h=!a&&i&&0===i.length;if(a&&f)return n.a.createElement(he.a,{height:"100%",width:"100%",text:R.i18n.translate("xpack.infra.waffle.loadingDataText",{defaultMessage:"Loading data"})});if(h)return n.a.createElement(be.a,{titleText:R.i18n.translate("xpack.infra.waffle.noDataTitle",{defaultMessage:"There is no data to display."}),bodyText:R.i18n.translate("xpack.infra.waffle.noDataDescription",{defaultMessage:"Try adjusting your time or filter."}),refetchText:R.i18n.translate("xpack.infra.waffle.checkNewDataButtonLabel",{defaultMessage:"Check for new data"}),onRefetch:()=>{o()},testString:"noMetricsDataPrompt"});const y=oo(i),E=e?y:t,v=["xs","s"].includes(Object(N.getBreakpoint)(window.innerWidth));return"table"===l?n.a.createElement(co,null,n.a.createElement(so,{nodeType:s,nodes:i,options:u,formatter:d,currentTime:c,onFilter:b})):n.a.createElement(uo,{top:g,positionStatic:v},n.a.createElement(eo,{nodeType:s,nodes:i,options:u,formatter:d,currentTime:c,onFilter:b,bounds:E,dataBounds:y,bottomMargin:p,staticHeight:v}))},co=z.euiStyled.div`
  padding: ${e=>e.theme.eui.paddingSizes.l};
`,uo=z.euiStyled.div`
  position: ${e=>e.positionStatic?"static":"absolute"};
  display: flex;
  top: ${e=>e.top}px;
  right: 0;
  bottom: 0;
  left: 0;
`;var mo=a(216),po=a(217),go=a(218),fo=a(219),bo=a(220),ho=a(221),yo=a(222);const Eo={host:mo.a,container:po.a,pod:go.a,awsEC2:fo.a,awsS3:bo.a,awsRDS:ho.a,awsSQS:yo.a};var vo=a(233);const xo=b.type({value:b.string,name:b.string}),ko=b.type({accounts:b.array(xo),projects:b.array(b.string),regions:b.array(b.string)});b.type({sourceId:b.string,nodeType:Ca.c,currentTime:b.number});const Oo=({nodeType:e,currentTime:t})=>{const{sourceId:a}=Object(ce.b)(),{accounts:i,regions:s}=function(e,t,a){const{error:n,loading:i,response:s,makeRequest:o}=Object(hr.a)("/api/infra/inventory/meta","POST",JSON.stringify({sourceId:e,nodeType:t,currentTime:a}),(e=>Object(h.pipe)(ko.decode(e),Object(y.fold)(Object(br.c)(br.a),E.identity))));return Object(r.useEffect)((()=>{o()}),[o]),{error:n,loading:i,accounts:s?s.accounts:[],regions:s?s.regions:[],makeRequest:o}}(a,e,t);return((e,t,a)=>n.a.createElement(vo.a,null,(r=>n.a.createElement(n.a.Fragment,null,n.a.createElement(e,ee()({},r,{accounts:t,regions:a})),n.a.createElement(N.EuiFlexItem,{grow:!0})))))((e=>{const t=null==Eo?void 0:Eo[e];if(!t)throw new Error(R.i18n.translate("xpack.infra.inventoryModels.findToolbar.error",{defaultMessage:"The toolbar you've attempted to find does not exist."}));return t})(e),i,s)},Mo=({view:e,onChange:t})=>{const a=[{id:"map",label:R.i18n.translate("xpack.infra.viewSwitcher.mapViewLabel",{defaultMessage:"Map view"}),iconType:"grid"},{id:"table",label:R.i18n.translate("xpack.infra.viewSwitcher.tableViewLabel",{defaultMessage:"Table view"}),iconType:"visTable"}];return n.a.createElement(N.EuiButtonGroup,{legend:R.i18n.translate("xpack.infra.viewSwitcher.lenged",{defaultMessage:"Switch between table and map view"}),options:a,color:"primary",buttonSize:"m",idSelected:e,onChange:t,isIconOnly:!0})},wo=(e="cool",t=10)=>{switch(e){case"temperature":return Object(N.euiPaletteForTemperature)(t);case"status":return Object(N.euiPaletteForStatus)(t);case"warm":return Object(N.euiPaletteWarm)(t);case"positive":return Object(N.euiPalettePositive)(t);case"negative":return Object(N.euiPaletteNegative)(t);default:return Object(N.euiPaletteCool)(t)}},jo=(e="cool",t=10,a=!1)=>a?wo(e,t).reverse():wo(e,t),So=(e,t=10,a=!1)=>({type:"steppedGradient",rules:jo(e,t,a).map(((e,a)=>({color:e,value:(a+1)/t})))}),Co=new RegExp("^([0-9\\.]*)\\s*("+["y","M","w","d","h","m","s","ms"].join("|")+")$"),To={ms:.001,s:1,m:60,h:3600,d:86400,w:604800,M:2592e3,y:30758400},Fo=e=>{const t=e.match(Co);if(t)return parseFloat(t[1])*To[t[2]];throw new Error("Invalid interval string format.")};var Lo=a(92);const Po=86400;function Io(e,t,a,n,i,s,o,l,c){const u=Object(r.useMemo)((()=>(e=>{if(e&&Fo(e)<300)return"5m";return e})(l)),[l]),d=Object(r.useMemo)((()=>(e=>{if(e){const t=Fo(e);return{timeLength:t<=900?Po:t<=2100?259200:t<=9e3?604800:2592e3,intervalInSeconds:t}}return{timeLength:0,intervalInSeconds:0}})(u)),[u]),{timeLength:m,intervalInSeconds:p}=d,g=i+1e3*p,f=i-1e3*m,b={interval:null!=u?u:"",to:g,from:f,ignoreLookback:!0,forceInterval:!0},{error:v,loading:x,response:k,makeRequest:O}=Object(hr.a)("/api/metrics/snapshot","POST",JSON.stringify({metrics:t,groupBy:null,nodeType:a,timerange:b,filterQuery:e,sourceId:n,accountId:s,region:o,includeTimeseries:!0}),(e=>Object(h.pipe)(Lo.g.decode(e),Object(y.fold)(Object(br.c)(br.a),E.identity)))),M=Object(r.useCallback)((()=>c?O():Promise.resolve()),[O,c]);Object(r.useEffect)((()=>{(async()=>{m&&await M()})()}),[M,m]);const w=k?Object(ve.first)(k.nodes.map((e=>{var t;return null===(t=Object(ve.first)(e.metrics))||void 0===t?void 0:t.timeseries}))):null;return{error:v&&v.message||null,loading:!l||x,timeseries:w,startTime:f,endTime:g,reload:O}}const Do=({interval:e,yAxisFormatter:t,isVisible:a})=>{var i,s;const{sourceId:o,source:l}=Object(ce.b)(),{metric:c,nodeType:u,accountId:d,region:m}=Object(Ia.d)(),{currentTime:g,jumpToTime:f,stopAutoReload:b}=qt(),{filterQueryAsJson:h}=ra(),{loading:y,error:E,startTime:v,endTime:x,timeseries:k,reload:O}=Io(h,[c],u,o,g,d,m,e,a),M={sourceId:"default",anomalyThreshold:(null==l?void 0:l.configuration.anomalyThreshold)||0,startTime:v,endTime:x,defaultSortOptions:{direction:"desc",field:"anomalyScore"},defaultPaginationOptions:{pageSize:100}},{metricsHostsAnomalies:w,getMetricsHostsAnomalies:j}=In(M),{metricsK8sAnomalies:S,getMetricsK8sAnomalies:C}=Tn(M),T=Object(r.useMemo)((()=>"host"===u?j:"pod"===u?C:void 0),[u,C,j]),F=Object(r.useMemo)((()=>"host"===u?w:"pod"===u?S:void 0),[u,w,S]),L=null===(i=Object(La.a)(c.type))||void 0===i?void 0:i.textLC,P=null===(s=Object(La.a)(c.type))||void 0===s?void 0:s.text,I={color:Le.a.color0,aggregation:"avg",label:P},D=Object(r.useMemo)((()=>{var e,t;if(!k)return()=>"";const a=null===(e=Object(ve.first)(k.rows))||void 0===e?void 0:e.timestamp,r=null===(t=Object(ve.last)(k.rows))||void 0===t?void 0:t.timestamp;return null==a||null==r?e=>`${e}`:Object(Ee.niceTimeFormatter)([a,r])}),[k]),_=Object(A.useUiSetting)("theme:darkMode"),R={headerFormatter:e=>p()(e.value).format("Y-MM-DD HH:mm:ss.SSS")},B=k?Object(Qe.a)(k,[I],!1):null,z=B?{max:1.1*B.max,min:B.min}:{max:0,min:0},$=Object(r.useCallback)((([[e]])=>{if(!Array.isArray(e)){const{x:t}=e;f(t),b()}}),[f,b]),U=Object(r.useMemo)((()=>{const e=c.type;return"memory"===e?"memory_usage":"rx"===e?"network_in":"tx"===e?"network_out":void 0}),[c]);if(Object(r.useEffect)((()=>{T&&U&&T(U)}),[T,U]),y)return n.a.createElement(_o,null,n.a.createElement(Bo,null,n.a.createElement(N.EuiLoadingChart,{size:"xl"})));if(!y&&(E||!k))return n.a.createElement(_o,null,n.a.createElement(N.EuiEmptyPrompt,{iconType:"visArea",title:n.a.createElement("h4",null,E?Vo:No),actions:n.a.createElement(N.EuiButton,{color:"primary",fill:!0,onClick:O},E?$o:zo)}));return n.a.createElement(_o,{"data-test-subj":a?"timelineContainerOpen":"timelineContainerClosed"},n.a.createElement(Ro,null,n.a.createElement(N.EuiFlexItem,{grow:!0},n.a.createElement(N.EuiText,null,n.a.createElement("strong",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.inventoryTimeline.header",defaultMessage:"Average {metricLabel}",values:{metricLabel:L}})))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiFlexGroup,{alignItems:"center",responsive:!1},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiIcon,{color:Object(Le.b)(I.color),type:"dot"})),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiText,{size:"xs"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.inventoryTimeline.header",defaultMessage:"Average {metricLabel}",values:{metricLabel:L}}))))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiFlexGroup,{gutterSize:"s",alignItems:"center",responsive:!1},n.a.createElement(N.EuiFlexItem,{grow:!1,style:{backgroundColor:"#D36086",height:5,width:10}}),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiText,{size:"xs"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.inventoryTimeline.legend.anomalyLabel",defaultMessage:"Anomaly detected"})))))))),n.a.createElement(Ao,null,n.a.createElement(Ee.Chart,null,F&&n.a.createElement(Ee.RectAnnotation,{id:"anomalies",dataValues:(H=F.map((e=>[e.startTime,e.influencers])),H.map((e=>{const[t,a]=e;return{coordinates:{x0:t,x1:p()(t).add(15,"minutes").valueOf(),y0:null==B?void 0:B.min,y1:null==B?void 0:B.max},details:a.join(",")}}))),style:{fill:"#D36086"}}),n.a.createElement(ke.a,{type:ne.b.area,metric:I,id:"0",series:k,stack:!1}),n.a.createElement(Ee.Axis,{id:"timestamp",position:Ee.Position.Bottom,showOverlappingTicks:!0,tickFormat:D}),n.a.createElement(Ee.Axis,{id:"values",position:Ee.Position.Left,tickFormat:t,domain:z,ticks:6,showGridLines:!0}),n.a.createElement(Ee.Settings,{tooltip:R,theme:Ge(_),onElementClick:$}))));var H},_o=z.euiStyled.div`
  background-color: ${e=>e.theme.eui.euiPageBackgroundColor};
  border-top: 1px solid ${e=>e.theme.eui.euiColorLightShade};
  height: 220px;
  width: 100%;
  padding: ${e=>e.theme.eui.paddingSizes.s} ${e=>e.theme.eui.paddingSizes.m};
  display: flex;
  flex-direction: column;
`,Ro=z.euiStyled.div`
  display: flex;
  width: 100%;
  padding: ${e=>e.theme.eui.paddingSizes.s} ${e=>e.theme.eui.paddingSizes.m};
  @media only screen and (max-width: 767px) {
      margin-top: 30px;
  }
`,Ao=z.euiStyled.div`
  padding-left: ${e=>e.theme.eui.paddingSizes.xs};
  width: 100%;
  height: 100%;
`,Bo=z.euiStyled.div`
  display: flex;
  justify-content: center;
  align-items: center;
  height: 100%;
`,No=R.i18n.translate("xpack.infra.inventoryTimeline.noHistoryDataTitle",{defaultMessage:"There is no historical data to display."}),Vo=R.i18n.translate("xpack.infra.inventoryTimeline.errorTitle",{defaultMessage:"Unable to show historical data."}),zo=R.i18n.translate("xpack.infra.inventoryTimeline.checkNewDataButtonLabel",{defaultMessage:"Check for new data"}),$o=R.i18n.translate("xpack.infra.inventoryTimeline.retryButtonLabel",{defaultMessage:"Try again"}),Uo=R.i18n.translate("xpack.infra.showHistory",{defaultMessage:"Show history"}),Ho=R.i18n.translate("xpack.infra.hideHistory",{defaultMessage:"Hide history"}),qo=({measureRef:e,width:t,interval:a,formatter:i,children:s})=>{const{timelineOpen:o,changeTimelineOpen:l}=Object(Ia.d)(),[c,u]=Object(r.useState)(Boolean(o));Object(r.useEffect)((()=>{c!==o&&u(Boolean(o))}),[c,o]);const d=Object(de.useUiTracker)({app:"infra_metrics"}),m=Object(r.useCallback)((()=>{c||d({metric:"open_timeline_drawer__inventory"}),u(!c),l(!c)}),[c,d,l]);return n.a.createElement(Jo,{ref:c?e:null,isOpen:c,outerWidth:t},n.a.createElement(Go,{ref:c?null:e},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(Ko,{"aria-expanded":c,iconType:c?"arrowDown":"arrowRight",onClick:m,"data-test-subj":"toggleTimelineButton"},c?Ho:Uo)),n.a.createElement(N.EuiFlexItem,{grow:!1,style:{position:"relative",minWidth:400,height:"16px"}},s),n.a.createElement(Wo,null)),n.a.createElement(N.EuiFlexGroup,{style:{marginTop:0}},n.a.createElement(Do,{isVisible:c,interval:a,yAxisFormatter:i})))},Jo=z.euiStyled.div`
  padding: ${e=>e.theme.eui.paddingSizes.m} 0;
  position: fixed;
  bottom: 0;
  right: 0;
  transition: transform ${300}ms;
  transform: translateY(${e=>e.isOpen?0:"224px"});
  width: ${e=>e.outerWidth+34}px;
`,Go=Object(z.euiStyled)(N.EuiFlexGroup).attrs({justifyContent:"spaceBetween",alignItems:"center"})`
 margin-bottom: 0;
 height: 48px;
`,Ko=Object(z.euiStyled)(N.EuiButtonEmpty).attrs({size:"s"})`
  width: 140px;
`,Wo=Object(z.euiStyled)(N.EuiSpacer).attrs({size:"xs"})`
  width: 140px;
`,Qo=({legend:e,bounds:t,formatter:a})=>{const r=e.rules.reduce(((e,t)=>e<t.value?t.value:e),0),i={background:`linear-gradient(to right, ${e.rules.map((e=>{const t=e.value/r*100;return`${e.color} ${t}%`}))})`};return n.a.createElement(Xo,{style:i},e.rules.map(((e,t)=>(a,r)=>{const i=0===a.value?e.min:e.max*a.value,s={left:100*a.value+"%"},o=t(i);return n.a.createElement(Yo,{style:s,key:`legend-rule-${r}`},n.a.createElement(Zo,null),n.a.createElement(el,null,o))})(t,a)))},Xo=z.euiStyled.div`
  position: absolute;
  height: 10px;
  bottom: 0;
  left: 0;
  right: 40px;
`,Yo=z.euiStyled.div`
  position: absolute;
  bottom: 0;
  top: -18px;
`,Zo=z.euiStyled.div`
  position: absolute;
  background-color: ${e=>e.theme.eui.euiBorderColor};
  width: 1px;
  left: 0;
  top: 15px;
  bottom: 0;
  ${Yo}:first-child {
    top: 2px;
  }
  ${Yo}:last-child {
    top: 2px;
  }
`,el=z.euiStyled.div`
  position: absolute;
  font-size: 11px;
  text-align: center;
  top: 0;
  left: 0;
  white-space: nowrap;
  transform: translate(-50%, 0);
  ${Yo}:first-child & {
    padding-left: 5px;
    transform: translate(0, 0);
  }
  ${Yo}:last-child & {
    padding-right: 5px;
    transform: translate(-100%, 0);
  }
`,tl=e=>({min:100*e.min,max:100*(e.max||1)}),al=({label:e,color:t})=>n.a.createElement(N.EuiFlexGroup,{alignItems:"center",gutterSize:"s",responsive:!1},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiColorPickerSwatch,{color:t})),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiText,{size:"xs"},n.a.createElement("strong",null,e)))),rl=({steps:e,palette:t,reverse:a})=>{const r=jo(t,e,a);return n.a.createElement(il,null,r.map((e=>n.a.createElement(nl,{key:e,style:{backgroundColor:e}}))))},nl=z.euiStyled.div`
  width: 15px;
  height: 12px;
  flex: 0 0 auto;
  &:first-child {
    border-radius: ${e=>e.theme.eui.euiBorderRadius} 0 0 ${e=>e.theme.eui.euiBorderRadius};
  }
  &:last-child {
    border-radius: 0 ${e=>e.theme.eui.euiBorderRadius} ${e=>e.theme.eui.euiBorderRadius} 0;
`,il=z.euiStyled.div`
  display: flex;
`,sl=["temperature","status","cool","warm","positive","negative"].map((e=>({text:Ie.e[e],value:e}))),ol=({autoBounds:e,boundsOverride:t,onChange:a,dataBounds:i,options:s})=>{const[o,l]=Object(r.useState)(!1),[c,u]=Object(r.useState)(e),[d,m]=Object(r.useState)(s),[p,g]=Object(r.useState)(tl(t));Object(r.useEffect)((()=>{c&&g(tl(i))}),[e,i,c,a,s]);const f=n.a.createElement(N.EuiButtonIcon,{iconType:"controlsHorizontal",color:"text","aria-label":R.i18n.translate("xpack.infra.legendControls.buttonLabel",{defaultMessage:"configure legend"}),onClick:()=>l(!0),"data-test-subj":"openLegendControlsButton"}),b=Object(r.useCallback)((e=>{const a=e.target.checked;u(a),a||g(tl(t))}),[t]),h=Object(r.useCallback)((e=>{m((t=>({...t,reverseColors:e.target.checked})))}),[m]),y=Object(r.useCallback)((e=>{const t=parseFloat(e.currentTarget.value),a=t<=p.min?p.min+1:t>100?100:t;g({...p,max:a})}),[p]),E=Object(r.useCallback)((e=>{const t=parseFloat(e.currentTarget.value),a=t>=p.max?p.max-1:t<0?0:t;g({...p,min:a})}),[p]),v=Object(r.useCallback)((()=>{a({auto:c,bounds:{min:p.min/100,max:p.max/100},legend:d}),l(!1)}),[a,c,p,d]),x=Object(r.useCallback)((()=>{g(tl(t)),u(e),m(s),l(!1)}),[e,t,s]),k=Object(r.useCallback)((e=>{const t=parseInt(e.target.value,10);m((e=>({...e,steps:t})))}),[m]),O=Object(r.useCallback)((e=>{const t=e.target.value;m((e=>({...e,palette:t})))}),[m]),M=c===e&&100*t.min===p.min&&100*t.max===p.max&&s.steps===d.steps&&s.reverseColors===d.reverseColors&&s.palette===d.palette,w=p.min<p.max,j=jo(d.palette,d.steps,d.reverseColors),S=w?[]:[R.i18n.translate("xpack.infra.legnedControls.boundRangeError",{defaultMessage:"Minimum must be smaller than the maximum"})];return n.a.createElement(ll,{"data-test-subj":"legendControls"},n.a.createElement(N.EuiPopover,{isOpen:o,closePopover:x,id:"legendControls",button:f},n.a.createElement(N.EuiPopoverTitle,null,"Legend Options"),n.a.createElement(N.EuiForm,{style:{minWidth:400}},n.a.createElement(N.EuiFormRow,{display:"columnCompressed",label:R.i18n.translate("xpack.infra.legendControls.colorPaletteLabel",{defaultMessage:"Color palette"})},n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiSelect,{options:sl,value:d.palette,id:"palette",onChange:O,compressed:!0,"data-test-subj":"legendControlsPalette"}),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(rl,{palette:d.palette,steps:d.steps,reverse:d.reverseColors}))),n.a.createElement(N.EuiFormRow,{display:"columnCompressed",label:R.i18n.translate("xpack.infra.legendControls.stepsLabel",{defaultMessage:"Number of colors"})},n.a.createElement(N.EuiRange,{id:"steps",min:2,max:18,step:1,value:d.steps,onChange:k,showValue:!0,fullWidth:!0})),n.a.createElement(N.EuiFormRow,{fullWidth:!0,display:"columnCompressed",label:R.i18n.translate("xpack.infra.legendControls.reverseDirectionLabel",{defaultMessage:"Reverse direction"})},n.a.createElement(N.EuiSwitch,{showLabel:!1,name:"reverseColors",label:"reverseColors",checked:d.reverseColors,onChange:h,compressed:!0,style:{position:"relative",top:"8px"}})),n.a.createElement(N.EuiFormRow,{fullWidth:!0,display:"columnCompressed",label:R.i18n.translate("xpack.infra.legendControls.switchLabel",{defaultMessage:"Auto calculate range"})},n.a.createElement(N.EuiSwitch,{showLabel:!1,name:"bounds",label:"bounds",checked:c,onChange:b,compressed:!0,style:{position:"relative",top:"8px"}})),n.a.createElement(N.EuiFormRow,{fullWidth:!0,label:n.a.createElement(al,{color:Object(ve.first)(j),label:R.i18n.translate("xpack.infra.legendControls.minLabel",{defaultMessage:"Minimum"})}),isInvalid:!w,display:"columnCompressed",error:S},n.a.createElement("div",{style:{maxWidth:150}},n.a.createElement(N.EuiFieldNumber,{disabled:c,step:1,value:isNaN(p.min)?"":p.min,isInvalid:!w,name:"legendMin",onChange:E,append:"%",compressed:!0}))),n.a.createElement(N.EuiFormRow,{fullWidth:!0,display:"columnCompressed",label:n.a.createElement(al,{color:Object(ve.last)(j),label:R.i18n.translate("xpack.infra.legendControls.maxLabel",{defaultMessage:"Maxium"})}),isInvalid:!w,error:S},n.a.createElement("div",{style:{maxWidth:150}},n.a.createElement(N.EuiFieldNumber,{disabled:c,step:1,isInvalid:!w,value:isNaN(p.max)?"":p.max,name:"legendMax",onChange:y,append:"%",compressed:!0}))),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd",responsive:!1},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButtonEmpty,{type:"submit",size:"s",onClick:x},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.legendControls.cancelButton",defaultMessage:"Cancel"}))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,{type:"submit",size:"s",fill:!0,disabled:M||!w,onClick:v,"data-test-subj":"applyLegendControlsButton"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.legendControls.applyButton",defaultMessage:"Apply"})))))))},ll=z.euiStyled.div`
  position: absolute;
  top: -20px;
  right: 6px;
  bottom: 0;
`,cl={[Ie.c.gte]:">=",[Ie.c.gt]:">",[Ie.c.lte]:"<=",[Ie.c.lt]:"<",[Ie.c.eq]:"="},ul=({legend:e,formatter:t})=>n.a.createElement(dl,null,e.rules.map((e=>(t,a)=>{const r=null!=t.label?t.label:`${cl[t.operator]} ${e(t.value)}`,i={backgroundColor:Object(ja.darken)(.4,t.color)},s={backgroundColor:t.color};return n.a.createElement(ml,{key:`legend-step-${a}`},n.a.createElement(pl,{style:i},n.a.createElement(gl,{style:s})),n.a.createElement(fl,null,r))})(t))),dl=z.euiStyled.div`
  display: flex;
  padding: 10px 40px 10px 10px;
`,ml=z.euiStyled.div`
  display: flex;
  margin-right: 20px
  align-items: center;
`,pl=z.euiStyled.div`
  position: relative;
  width: 24px;
  height: 24px;
  flex: 0 0 auto;
  margin-right: 5px;
  border-radius: 3px;
  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.2);
`,gl=z.euiStyled.div`
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 2px;
  border-radius: 3px;
`,fl=z.euiStyled.div`
  font-size: 12px;
`,bl=({legend:e,bounds:t,formatter:a})=>n.a.createElement(kl,null,n.a.createElement(El,null,n.a.createElement(hl,{value:0,bounds:t,formatter:a}),n.a.createElement(hl,{value:1,bounds:t,formatter:a})),n.a.createElement(xl,null,e.rules.map(((e,t)=>n.a.createElement(yl,{key:`step-${t}-${e.value}`,style:{backgroundColor:e.color}}))))),hl=({value:e,bounds:t,formatter:a})=>{const r={left:100*e+"%"},i=a(0===e?t.min:t.max*e);return n.a.createElement(vl,{style:r},i)},yl=z.euiStyled.div`
  height: ${e=>e.theme.eui.paddingSizes.s};
  flex: 1 1 auto;
  &:first-child {
    border-radius: ${e=>e.theme.eui.euiBorderRadius} 0 0 ${e=>e.theme.eui.euiBorderRadius};
  }
  &:last-child {
    border-radius: 0 ${e=>e.theme.eui.euiBorderRadius} ${e=>e.theme.eui.euiBorderRadius} 0;
  }
`,El=z.euiStyled.div`
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0;
  right: 0;
  top: -18px;
`,vl=z.euiStyled.div`
  position: absolute;
  font-size: 11px;
  text-align: center;
  top: 0;
  left: 0;
  white-space: nowrap;
  transform: translate(-50%, 0);
  &:first-child {
    padding-left: 5px;
    transform: translate(0, 0);
  }
  &:last-child {
    padding-right: 5px;
    transform: translate(-100%, 0);
  }
`,xl=z.euiStyled.div`
  display: flex;
  flex-direction; row;
  align-items: stretch;
  flex-grow: 1;
`,kl=z.euiStyled.div`
  position: absolute;
  height: 10px;
  bottom: 0;
  left: 0;
  right: 40px;
`,Ol=({dataBounds:e,legend:t,bounds:a,formatter:i})=>{const{changeBoundsOverride:s,changeAutoBounds:o,autoBounds:l,legend:c,changeLegend:u,boundsOverride:d}=Object(Ia.d)(),m=Object(r.useCallback)((e=>{s(e.bounds),o(e.auto),u(e.legend)}),[s,o,u]);return n.a.createElement(Ml,null,n.a.createElement(ol,{options:null!=c?c:Ia.a,dataBounds:e,bounds:a,autoBounds:l,boundsOverride:d,onChange:m}),Ie.a.is(t)&&n.a.createElement(Qo,{formatter:i,legend:t,bounds:a}),Ie.f.is(t)&&n.a.createElement(ul,{formatter:i,legend:t}),Ie.g.is(t)&&n.a.createElement(bl,{formatter:i,bounds:a,legend:t}))},Ml=z.euiStyled.div`
  position: absolute;
  bottom: 0px;
  left: 10px;
  right: 10px;
`,wl=({shouldLoadDefault:e,currentView:t,reload:a,interval:i,nodes:s,loading:o})=>{var l,c,u;const[d,m]=Object(r.useState)(!0),{metric:p,groupBy:g,sort:f,nodeType:b,changeView:h,view:y,autoBounds:E,boundsOverride:v,legend:x}=Object(Ia.d)(),{currentTime:k,jumpToTime:O,isAutoReloading:M}=qt(),{applyFilterQuery:w}=ra(),j=null!==(l=null==x?void 0:x.palette)&&void 0!==l?l:Ia.a.palette,S=null!==(c=null==x?void 0:x.steps)&&void 0!==c?c:Ia.a.steps,C=null!==(u=null==x?void 0:x.reverseColors)&&void 0!==u?u:Ia.a.reverseColors,T={formatter:Ie.b.percent,formatTemplate:"{{value}}",legend:So(j,S,C),metric:p,sort:f,groupBy:g};da()((()=>{o||O(Date.now())}),M?5e3:null);const F=oo(s),L=E?F:v,P=Object(r.useCallback)(Object(Fa.a)(T.metric),[T.metric]),{onViewChange:I}=Es();return Object(r.useEffect)((()=>{t&&I(t)}),[t,I]),Object(r.useEffect)((()=>{null==t&&e||a()}),[a,e]),Object(r.useEffect)((()=>{m(!0)}),[T.metric,b]),Object(r.useEffect)((()=>{const e=s&&s.length;m(!e)}),[s]),n.a.createElement(n.a.Fragment,null,n.a.createElement($.b,null,n.a.createElement(ma.a,{bounds:!0},(({measureRef:e,bounds:{width:t=0}})=>n.a.createElement(jl,{ref:e},n.a.createElement(ma.a,{bounds:!0},(({measureRef:e,bounds:{height:r=0}})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(Sl,{ref:e},n.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center",gutterSize:"m"},n.a.createElement(Oo,{nodeType:b,currentTime:k}),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(Mo,{view:y,onChange:h})))),n.a.createElement(ma.a,{bounds:!0},(({measureRef:e,bounds:{height:l=0}})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(lo,{nodes:s,options:T,nodeType:b,loading:o,showLoading:d,reload:a,onDrilldown:w,currentTime:k,view:y,autoBounds:E,boundsOverride:v,formatter:P,bottomMargin:l,topMargin:r}),"map"===y&&n.a.createElement(qo,{measureRef:e,interval:i,formatter:P,width:t},n.a.createElement(Ol,{formatter:P,bounds:L,dataBounds:F,legend:T.legend})))))))))))))},jl=z.euiStyled.div`
  position: relative;
  flex: 1 1 auto;
`,Sl=z.euiStyled.div`
  padding: ${e=>`12px ${e.theme.eui.paddingSizes.m}`};
`,Cl=e=>{const{shouldLoadDefault:t,currentView:a}=vt();return n.a.createElement(wl,ee()({shouldLoadDefault:t,currentView:a},e))};var Tl=a(31);const Fl=()=>{const{viewState:e}=Es();return n.a.createElement(Ft,{viewState:e})},Ll=({render:e})=>{const{sourceId:t}=Object(ce.b)(),{metric:a,groupBy:r,nodeType:n,accountId:i,region:s}=Object(Ia.d)(),{currentTime:o}=qt(),{filterQueryAsJson:l}=ra(),{loading:c,nodes:u,reload:d,interval:m}=Object(Ta.a)(l,[a],r,n,t,o,i,s,!1);return e({loading:c,nodes:u,reload:d,interval:m})},Pl=()=>{const{hasFailedLoadingSource:e,isLoading:t,loadSourceFailureMessage:a,loadSource:i,source:s,metricIndicesExist:o}=Object(r.useContext)(ce.a.Context);Object(de.useTrackPageview)({app:"infra_metrics",path:"inventory"}),Object(de.useTrackPageview)({app:"infra_metrics",path:"inventory",delay:15e3});const{source:l}=Object(Ia.d)();return fe([{text:ge.b}]),n.a.createElement(N.EuiErrorBoundary,null,n.a.createElement(te.a,{title:e=>R.i18n.translate("xpack.infra.infrastructureSnapshotPage.documentTitle",{defaultMessage:"{previousTitle} | Inventory",values:{previousTitle:e}})}),t&&!s?n.a.createElement(ca.a,null):o?n.a.createElement(n.a.Fragment,null,n.a.createElement(Il,{className:Tl.APP_WRAPPER_CLASS},n.a.createElement(Et,{shouldLoadDefault:"default"===l,viewType:"inventory-view",defaultViewState:ys},n.a.createElement(Mt,{hasData:o,pageHeader:{pageTitle:ge.b,rightSideItems:[n.a.createElement(Fl,null)]},pageBodyProps:{paddingSize:"none"}},n.a.createElement(Ll,{render:({loading:e,nodes:t,reload:a,interval:r})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(ia,{interval:r}),n.a.createElement(Cl,{loading:e,nodes:t,reload:a,interval:r}))}))))):e?n.a.createElement(la,{errorMessage:a||"",retry:i}):n.a.createElement(Mt,{hasData:o,"data-test-subj":"noMetricsIndicesPrompt"}))},Il=z.euiStyled.div`
  .euiPage .euiPageContentBody {
    display: flex;
    flex-direction: column;
    flex: 1 0 auto;
    width: 100%;
    height: 100%;
  }
`,Dl=b.intersection([b.type({timestamp:b.number}),b.partial({value:b.union([b.number,b.null])})]),_l=b.type({id:b.string,label:b.string,data:b.array(Dl)}),Rl=b.intersection([b.partial({id:b.union([Ca.a,b.null])}),b.type({series:b.array(_l)})]),Al=b.type({metrics:b.array(Rl)});b.intersection([b.type({nodeType:Ca.c,nodeId:b.string,metrics:b.array(Ca.a),timerange:Lo.a,sourceId:b.string}),b.partial({cloudId:b.union([b.string,b.null])})]);const Bl=({loading:e,name:t,items:a})=>{const[i,s]=Object(r.useState)(!1),o=Object(r.useCallback)((()=>{s(!i)}),[i]),l=e?null:n.a.createElement(N.EuiSideNav,{items:a}),c=e?null:n.a.createElement(N.EuiSideNav,{items:a,mobileTitle:t,toggleOpenOnMobile:o,isOpenOnMobile:i});return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiHideFor,{sizes:["xs","s","m"]},n.a.createElement(N.EuiPageSideBar,{sticky:!0},l)),n.a.createElement(N.EuiShowFor,{sizes:["xs","s","m"]},n.a.createElement(N.EuiPageSideBar,null,c)))},Nl=e=>{const[t]=Object(We.a)(at.UI_SETTINGS.TIMEPICKER_QUICK_RANGES),{onChangeTimeRange:a,onRefresh:i,currentTimeRange:s,isLiveStreaming:o,refreshInterval:l,setAutoReload:c,setRefreshInterval:u}=e,d=ct(t),m=Object(r.useCallback)((({start:e,end:t})=>{a({from:e,to:t,interval:">=1m"})}),[a]),p=Object(r.useCallback)((({isPaused:e,refreshInterval:t})=>{e?c(!1):(u(t),c(!0))}),[c,u]);return n.a.createElement(Vl,null,n.a.createElement(N.EuiSuperDatePicker,{start:s.from.toString(),end:s.to.toString(),isPaused:!o,refreshInterval:l||0,onTimeChange:m,onRefreshChange:p,onRefresh:i,commonlyUsedRanges:d}))},Vl=z.euiStyled.div`
  max-width: 750px;
`,zl=n.a.createContext({items:[],addNavItem:e=>{}}),$l=({children:e,metrics:t,navLabel:a,sectionLabel:i,onChangeRangeTime:s,isLiveStreaming:o,stopLiveStreaming:l})=>{const{addNavItem:c}=Object(r.useContext)(zl),u=r.Children.toArray(e).reduce(((e,a)=>{var n;if(!Object(r.isValidElement)(a))return e;return null===(null!==(n=null==t?void 0:t.find((e=>e.id===a.props.id)))&&void 0!==n?n:null)?e:a.props.label?[...e,{id:a.props.id,name:a.props.label,onClick:()=>{const e=document.getElementById(a.props.id);e&&e.scrollIntoView()}}]:e}),[]),d=r.Children.map(e,(e=>Object(r.isValidElement)(e)?Object(r.cloneElement)(e,{metrics:t,onChangeRangeTime:s,isLiveStreaming:o,stopLiveStreaming:l}):null));return t&&u.length?(c({id:a,name:a,items:u}),n.a.createElement("div",null,n.a.createElement(N.EuiTitle,null,n.a.createElement("h1",null,i)),d)):null},Ul=({id:e,label:t,children:a,metrics:i,onChangeRangeTime:s,isLiveStreaming:o,stopLiveStreaming:l})=>{const c=Object(r.useMemo)((()=>null==i?void 0:i.find((t=>t.id===e))),[e,i]);if(!a||!c)return null;const u=r.Children.map(a,(t=>Object(r.isValidElement)(t)?Object(r.cloneElement)(t,{metric:c,id:e,onChangeRangeTime:s,isLiveStreaming:o,stopLiveStreaming:l}):null));return n.a.createElement("div",{style:{margin:"10px 0 16px 0"},id:e},t?n.a.createElement(N.EuiTitle,{size:"s"},n.a.createElement("h4",null,t)):null,u)};var Hl=a(280),ql=a.n(Hl);const Jl=e=>e.data.length<2,Gl=(e,t,a)=>e?Object(ve.get)(e,[t,"name"],a):a,Kl=(e,t)=>{const a=e?Object(ve.get)(e,[t,"color"]):null;if(!a)return null;return new ql.a(a).hex().toString()},Wl=(e,t,a)=>{if(!e||!t)return"line";const r=Object(ve.get)(e,[a,"type"]);return Ca.b.is(r)?r:Ca.b.is(t)?t:"line"},Ql=({id:e,metric:t,seriesOverrides:a,formatter:r,formatterTemplate:i})=>t&&e?n.a.createElement(N.EuiPageContentBody,null,n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(Xl,null,t.series.map((t=>{const s=Object(ve.last)(t.data);if(!s)return null;const o=((e="number",t="{{value}}",a={},r)=>n=>{if(null==n)return"";const i=Object(ve.get)(a,[r,"formatter"],e),s=Object(ve.get)(a,[r,"formatterTemplate"],t);return Object(Sr.b)(i,s)(n)})(r,i,a,t.id)(s.value||0),l=Gl(a,t.id,t.id),c=Object(ve.max)(t.data.map((e=>e.value||0))),u=Object(ve.get)(a,[t.id,"gaugeMax"],c);return n.a.createElement(N.EuiFlexItem,{key:`${e}-${t.id}`,style:{margin:"0.4rem"}},n.a.createElement(N.EuiPanel,{style:{minWidth:"160px"}},n.a.createElement(N.EuiText,{style:{textAlign:"right"},size:"s"},l),n.a.createElement(N.EuiTitle,{size:"s"},n.a.createElement("h1",{style:{textAlign:"right",whiteSpace:"nowrap"}},o)),n.a.createElement(N.EuiProgress,{value:s.value||0,max:u,size:"s",color:"primary"})))}))),n.a.createElement(N.EuiSpacer,{size:"m"})):null,Xl=z.euiStyled.div`
  display: flex;
  flex-flow: row wrap;
  justify-content: space-evenly;
`;var Yl=a(116);const Zl=e=>"bar"===e.type?n.a.createElement(tc,e):n.a.createElement(ec,e),ec=({id:e,color:t,series:a,name:r,type:i,stack:s})=>{const o=Object(Yl.a)(),l={area:{opacity:1,visible:"area"===i},line:{strokeWidth:"area"===i?1:2,visible:!0}};return n.a.createElement(Ee.AreaSeries,{id:e,name:r,xScaleType:Ee.ScaleType.Time,yScaleType:Ee.ScaleType.Linear,xAccessor:"timestamp",yAccessors:["value"],data:a.data,areaSeriesStyle:l,color:t||void 0,stackAccessors:s?["timestamp"]:void 0,timeZone:o})},tc=({id:e,color:t,series:a,name:r,stack:i})=>{const s=Object(Yl.a)(),o={rectBorder:{stroke:t||void 0,strokeWidth:1,visible:!0},rect:{opacity:1}};return n.a.createElement(Ee.BarSeries,{id:e,name:r,xScaleType:Ee.ScaleType.Time,yScaleType:Ee.ScaleType.Linear,xAccessor:"timestamp",yAccessors:["value"],data:a.data,barSeriesStyle:o,color:t||void 0,stackAccessors:i?["timestamp"]:void 0,timeZone:s})},ac=({title:e,body:t})=>n.a.createElement(N.EuiEmptyPrompt,{iconType:"stats",title:n.a.createElement("h3",null,e),body:n.a.createElement("p",null,t)}),rc=({id:e,onChangeRangeTime:t,metric:a,stopLiveStreaming:i,isLiveStreaming:s,formatter:o,formatterTemplate:l,stacked:c,seriesOverrides:u,type:d})=>{const m=Object(A.useUiSetting)("theme:darkMode"),[g]=Object(We.a)("dateFormat"),f=Object(r.useCallback)(((e="number",t="{{value}}")=>a=>null!=a?Object(Sr.b)(e,t)(a):"")(o,l),[o,l]),b=Object(r.useMemo)((()=>null!=a?Object(Ee.niceTimeFormatter)((e=>{if(e.series.some(Jl))return[0,0];const t=e.series.reduce(((e,t)=>{const a=Object(ve.first)(t.data),r=Object(ve.last)(t.data);return e.concat([a&&a.timestamp||0,r&&r.timestamp||0])}),[]);return[Object(ve.min)(t),Object(ve.max)(t)]})(a)):void 0),[a]),h=Object(r.useCallback)((({x:e})=>{if(!e)return;const[a,r]=e;t&&(s&&i&&i(),t({from:p()(a).toISOString(),to:p()(r).toISOString(),interval:">=1m"}))}),[t,s,i]),y={headerFormatter:Object(r.useCallback)((e=>p()(e.value).format(g||"Y-MM-DD HH:mm:ss.SSS")),[g])};return e?a?a.series.some(Jl)?n.a.createElement(ac,{title:R.i18n.translate("xpack.infra.chartSection.notEnoughDataPointsToRenderTitle",{defaultMessage:"Not Enough Data"}),body:R.i18n.translate("xpack.infra.chartSection.notEnoughDataPointsToRenderText",{defaultMessage:"Not enough data points to render chart, try increasing the time range."})}):n.a.createElement(N.EuiPageContentBody,null,n.a.createElement("div",{className:"infrastructureChart",style:{height:250,marginBottom:16}},n.a.createElement(Ee.Chart,null,n.a.createElement(Ee.Axis,{id:"timestamp",position:Ee.Position.Bottom,showOverlappingTicks:!0,tickFormat:b}),n.a.createElement(Ee.Axis,{id:"values",position:Ee.Position.Left,tickFormat:f}),a&&a.series.map((t=>n.a.createElement(Zl,{key:`series-${e}-${t.id}`,id:`series-${e}-${t.id}`,series:t,name:Gl(u,t.id,t.id),type:Wl(u,d,t.id),color:Kl(u,t.id),stack:c}))),n.a.createElement(Ee.Settings,{tooltip:y,onBrushEnd:h,theme:Je(m),showLegend:!0,showLegendExtra:!0,legendPosition:"right"})))):n.a.createElement(ac,{title:R.i18n.translate("xpack.infra.chartSection.missingMetricDataText",{defaultMessage:"Missing Data"}),body:R.i18n.translate("xpack.infra.chartSection.missingMetricDataBody",{defaultMessage:"The data for this chart is missing."})}):null},nc=Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement($l,{navLabel:"AWS",sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"AWS Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"awsOverview"},n.a.createElement(Ql,{seriesOverrides:{"cpu-util":{name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.overviewSection.cpuUtilizationSeriesLabel",{defaultMessage:"CPU Utilization"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},"status-check-failed":{name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.overviewSection.statusCheckFailedLabel",{defaultMessage:"Status check failed"}),color:a.eui.euiColorFullShade},"packets-in":{name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.overviewSection.networkPacketsInLabel",{defaultMessage:"Packets (in)"}),color:a.eui.euiColorFullShade,formatter:"number"},"packets-out":{name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.overviewSection.networkPacketsOutLabel",{defaultMessage:"Packets (out)"}),color:a.eui.euiColorFullShade,formatter:"number"}}})),n.a.createElement(Ul,{id:"awsCpuUtilization",label:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.cpuUtilSection.sectionLabel",{defaultMessage:"CPU Utilization"})},n.a.createElement(rc,{type:"area",formatter:"number",seriesOverrides:{"cpu-util":{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.cpuUtilSection.percentSeriesLabel",{defaultMessage:"percent"})}}})),n.a.createElement(Ul,{id:"awsNetworkBytes",label:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.networkBytesSection.sectionLabel",{defaultMessage:"Network Traffic"})},n.a.createElement(rc,{type:"area",formatter:"bits",formatterTemplate:"{{value}}/s",seriesOverrides:{tx:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.networkBytesSection.txSeriesLabel",{defaultMessage:"out"})},rx:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.networkBytesSection.rxSeriesLabel",{defaultMessage:"in"})}}})),n.a.createElement(Ul,{id:"awsNetworkPackets",label:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.networkPacketsSection.sectionLabel",{defaultMessage:"Network Packets (Average)"})},n.a.createElement(rc,{type:"area",formatter:"number",seriesOverrides:{"packets-out":{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.networkPacketsSection.packetsOutSeriesLabel",{defaultMessage:"out"})},"packets-in":{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.networkPacketsSection.packetsInSeriesLabel",{defaultMessage:"in"})}}})),n.a.createElement(Ul,{id:"awsDiskioOps",label:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.diskioOperationsSection.sectionLabel",{defaultMessage:"Disk I/O Operations"})},n.a.createElement(rc,{type:"area",formatter:"number",seriesOverrides:{writes:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.diskioOperationsSection.writesSeriesLabel",{defaultMessage:"writes"})},reads:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.diskioOperationsSection.readsSeriesLabel",{defaultMessage:"reads"})}}})),n.a.createElement(Ul,{id:"awsDiskioBytes",label:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.diskioBytesSection.sectionLabel",{defaultMessage:"Disk I/O Bytes"})},n.a.createElement(rc,{type:"area",formatter:"number",seriesOverrides:{writes:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.diskioBytesSection.writesSeriesLabel",{defaultMessage:"writes"})},reads:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.awsMetricsLayout.diskioBytesSection.readsSeriesLabel",{defaultMessage:"reads"})}}})))))),ic=Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement($l,{navLabel:"Nginx",sectionLabel:"Nginx",metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"nginxHits",label:R.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.hitsSection.sectionLabel",{defaultMessage:"Hits"})},n.a.createElement(rc,{stacked:!0,type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{"200s":{color:a.eui.euiColorVis1},"300s":{color:a.eui.euiColorVis5},"400s":{color:a.eui.euiColorVis2},"500s":{color:a.eui.euiColorVis9}}})),n.a.createElement(Ul,{id:"nginxRequestRate",label:R.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.requestRateSection.sectionLabel",{defaultMessage:"Request Rate"})},n.a.createElement(rc,{type:"area",formatter:"abbreviatedNumber",formatterTemplate:"{{value}}/s",seriesOverrides:{rate:{color:a.eui.euiColorVis1}}})),n.a.createElement(Ul,{id:"nginxActiveConnections",label:R.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.activeConnectionsSection.sectionLabel",{defaultMessage:"Active Connections"})},n.a.createElement(rc,{type:"area",formatter:"abbreviatedNumber",seriesOverrides:{connections:{color:a.eui.euiColorVis1,type:"bar"}}})),n.a.createElement(Ul,{id:"nginxRequestsPerConnection",label:R.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.requestsPerConnectionsSection.sectionLabel",{defaultMessage:"Requests per Connections"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{reqPerConns:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.nginxMetricsLayout.requestsPerConnectionsSection.reqsPerConnSeriesLabel",{defaultMessage:"reqs per conn"})}}})))))),sc=n.a.createContext(null),oc=[{field:"cloud.instance.id",label:R.i18n.translate("xpack.infra.nodeDetails.labels.instanceId",{defaultMessage:"Instance ID"})},{field:"cloud.provider",label:R.i18n.translate("xpack.infra.nodeDetails.labels.cloudProvider",{defaultMessage:"Cloud Provider"})},{field:"host.os.name",label:R.i18n.translate("xpack.infra.nodeDetails.labels.operatinSystem",{defaultMessage:"Operating System"})},{field:"host.os.kernel",label:R.i18n.translate("xpack.infra.nodeDetails.labels.kernelVersion",{defaultMessage:"Kernel Version"})},{field:"host.hostname",label:R.i18n.translate("xpack.infra.nodeDetails.labels.hostname",{defaultMessage:"Hostname"})},{field:"host.containerized",label:R.i18n.translate("xpack.infra.nodeDetails.labels.containerized",{defaultMessage:"Containerized"}),isBoolean:!0},{field:"cloud.project.id",label:R.i18n.translate("xpack.infra.nodeDetails.labels.projectId",{defaultMessage:"Project ID"})},{field:"cloud.availability_zone",label:R.i18n.translate("xpack.infra.nodeDetails.labels.availabilityZone",{defaultMessage:"Availability Zone"})},{field:"cloud.machine.type",label:R.i18n.translate("xpack.infra.nodeDetails.labels.machineType",{defaultMessage:"Machine Type"})},{field:"cloud.instance.name",label:R.i18n.translate("xpack.infra.nodeDetails.labels.instanceName",{defaultMessage:"Instance Name"})}],lc=e=>{const[t,a]=Object(r.useState)(!1),i=Object(r.useCallback)((()=>a(!t)),[t]),s=Object(r.useMemo)((()=>e.fields&&e.fields.length?e.fields.map((e=>{const t=oc.find((t=>t.field===e));if(t)return t})).filter((e=>e)):oc),[e.fields]),o=Object(r.useMemo)((()=>t?s:s.slice(0,4)),[s,t]),l=Object(r.useContext)(sc);return l?n.a.createElement(cc,null,s.length>4?n.a.createElement(uc,null,n.a.createElement(N.EuiButtonIcon,{iconType:t?"arrowUp":"arrowDown",onClick:i,"aria-label":R.i18n.translate("xpack.infra.nodeDetails.labels.showMoreDetails",{defaultMessage:"Show more details"})})):null,n.a.createElement(N.EuiFlexGrid,{columns:4,style:{flexGrow:1},gutterSize:"s"},o.map((e=>n.a.createElement(N.EuiFlexItem,{key:e.field,style:{minWidth:0}},n.a.createElement(N.EuiTitle,{size:"xs"},n.a.createElement("h5",null,(({field:e})=>{const t=oc.find((t=>t.field===e));return t?t.label:e})(e))),n.a.createElement(N.EuiText,null,((e,{field:t,isBoolean:a})=>a?Object(ve.get)(e.info,t,!1)?R.i18n.translate("xpack.infra.nodeDetails.yes",{defaultMessage:"Yes"}):R.i18n.translate("xpack.infra.nodeDetails.no",{defaultMessage:"No"}):Object(ve.get)(e.info,t,"--"))(l,e))))))):null},cc=z.euiStyled.div`
border-top: ${e=>e.theme.eui.euiBorderWidthThin} solid ${e=>e.theme.eui.euiBorderColor};
border-bottom: ${e=>e.theme.eui.euiBorderWidthThin} solid ${e=>e.theme.eui.euiBorderColor};
padding: ${e=>e.theme.eui.paddingSizes.m} 0;
margin-bottom: ${e=>e.theme.eui.paddingSizes.m};
display: flex;
`,uc=z.euiStyled.div`
flex-grow: 0;
margin-right: ${e=>e.theme.eui.paddingSizes.m};
min-width: 0px;
`,dc=Object(z.euiStyled)(N.EuiPageContent)`
  position: relative;
`,mc={host:Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(lc,{fields:["host.hostname","host.os.name","host.os.kernel","host.containerized","cloud.provider","cloud.availability_zone","cloud.machine.type","cloud.project.id","cloud.instance.id","cloud.instance.name"]}),n.a.createElement(dc,null,n.a.createElement($l,{navLabel:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.layoutLabel",{defaultMessage:"Host"}),sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Host Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"hostSystemOverview"},n.a.createElement(Ql,{seriesOverrides:{cpu:{name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.overviewSection.cpuUsageSeriesLabel",{defaultMessage:"CPU Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},load:{name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.overviewSection.loadSeriesLabel",{defaultMessage:"Load (5m)"}),color:a.eui.euiColorFullShade},memory:{name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.overviewSection.memoryCapacitySeriesLabel",{defaultMessage:"Memory Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},rx:{name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.overviewSection.inboundRXSeriesLabel",{defaultMessage:"Inbound (RX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"},tx:{name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.overviewSection.outboundTXSeriesLabel",{defaultMessage:"Outbound (TX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"}}})),n.a.createElement(Ul,{id:"hostCpuUsage",label:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},n.a.createElement(rc,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{user:{color:a.eui.euiColorVis0},system:{color:a.eui.euiColorVis2},steal:{color:a.eui.euiColorVis9},irq:{color:a.eui.euiColorVis4},softirq:{color:a.eui.euiColorVis6},iowait:{color:a.eui.euiColorVis7},nice:{color:a.eui.euiColorVis5}}})),n.a.createElement(Ul,{id:"hostLoad",label:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.loadSection.sectionLabel",{defaultMessage:"Load"})},n.a.createElement(rc,{seriesOverrides:{load_1m:{color:a.eui.euiColorVis0,name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.loadSection.oneMinuteSeriesLabel",{defaultMessage:"1m"})},load_5m:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.loadSection.fiveMinuteSeriesLabel",{defaultMessage:"5m"})},load_15m:{color:a.eui.euiColorVis3,name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.loadSection.fifteenMinuteSeriesLabel",{defaultMessage:"15m"})}}})),n.a.createElement(Ul,{id:"hostMemoryUsage",label:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.memoryUsageSection.sectionLabel",{defaultMessage:"Memory Usage"})},n.a.createElement(rc,{stacked:!0,formatter:"bytes",type:"area",seriesOverrides:{used:{color:a.eui.euiColorVis2},free:{color:a.eui.euiColorVis0},cache:{color:a.eui.euiColorVis1}}})),n.a.createElement(Ul,{id:"hostNetworkTraffic",label:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.networkTrafficSection.sectionLabel",{defaultMessage:"Network Traffic"})},n.a.createElement(rc,{formatter:"bits",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{rx:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.networkTrafficSection.networkRxRateSeriesLabel",{defaultMessage:"in"})},tx:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.networkTrafficSection.networkTxRateSeriesLabel",{defaultMessage:"out"})}}}))),n.a.createElement($l,{navLabel:"Kubernetes",sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Kubernetes Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"hostK8sOverview"},n.a.createElement(Ql,{seriesOverrides:{cpucap:{name:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.overviewSection.cpuUsageSeriesLabel",{defaultMessage:"CPU Capacity"}),color:"success",formatter:"percent",gaugeMax:1},load:{name:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.overviewSection.loadSeriesLabel",{defaultMessage:"Load (5m)"}),color:"success"},memorycap:{name:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.overviewSection.memoryUsageSeriesLabel",{defaultMessage:"Memory Capacity"}),color:"success",formatter:"percent",gaugeMax:1},podcap:{name:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.overviewSection.podCapacitySeriesLabel",{defaultMessage:"Pod Capacity"}),color:"success",formatter:"percent",gaugeMax:1},diskcap:{name:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.overviewSection.diskCapacitySeriesLabel",{defaultMessage:"Disk Capacity"}),color:"success",formatter:"percent",gaugeMax:1}}})),n.a.createElement(Ul,{id:"hostK8sCpuCap",label:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.nodeCpuCapacitySection.sectionLabel",{defaultMessage:"Node CPU Capacity"})},n.a.createElement(rc,{formatter:"abbreviatedNumber",seriesOverrides:{capacity:{color:a.eui.euiColorVis2},used:{color:a.eui.euiColorVis1,type:"area"}}})),n.a.createElement(Ul,{id:"hostK8sMemoryCap",label:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.nodeMemoryCapacitySection.sectionLabel",{defaultMessage:"Node Memory Capacity"})},n.a.createElement(rc,{formatter:"bytes",seriesOverrides:{capacity:{color:a.eui.euiColorVis2},used:{color:a.eui.euiColorVis1,type:"area"}}})),n.a.createElement(Ul,{id:"hostK8sDiskCap",label:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.nodeDiskCapacitySection.sectionLabel",{defaultMessage:"Node Disk Capacity"})},n.a.createElement(rc,{formatter:"bytes",seriesOverrides:{capacity:{color:a.eui.euiColorVis2},used:{color:a.eui.euiColorVis1,type:"area"}}})),n.a.createElement(Ul,{id:"hostK8sPodCap",label:R.i18n.translate("xpack.infra.metricDetailPage.kubernetesMetricsLayout.nodePodCapacitySection.sectionLabel",{defaultMessage:"Node Pod Capacity"})},n.a.createElement(rc,{formatter:"number",seriesOverrides:{capacity:{color:a.eui.euiColorVis2},used:{color:a.eui.euiColorVis1,type:"area"}}}))),n.a.createElement(nc,{metrics:e,onChangeRangeTime:t}),n.a.createElement(ic,{metrics:e,onChangeRangeTime:t}))))),pod:Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(lc,null),n.a.createElement(dc,null,n.a.createElement($l,{navLabel:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.layoutLabel",{defaultMessage:"Pod"}),sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Pod Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"podOverview"},n.a.createElement(Ql,{seriesOverrides:{cpu:{name:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.cpuUsageSeriesLabel",{defaultMessage:"CPU Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},memory:{name:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.memoryUsageSeriesLabel",{defaultMessage:"Memory Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},rx:{name:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.inboundRXSeriesLabel",{defaultMessage:"Inbound (RX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"},tx:{name:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.overviewSection.outboundTXSeriesLabel",{defaultMessage:"Outbound (TX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"}}})),n.a.createElement(Ul,{id:"podCpuUsage",label:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},n.a.createElement(rc,{formatter:"percent",type:"area",seriesOverrides:{cpu:{color:a.eui.euiColorVis1}}})),n.a.createElement(Ul,{id:"podMemoryUsage",label:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.memoryUsageSection.sectionLabel",{defaultMessage:"Memory Usage"})},n.a.createElement(rc,{type:"area",formatter:"percent",seriesOverrides:{memory:{color:a.eui.euiColorVis1}}})),n.a.createElement(Ul,{id:"podNetworkTraffic",label:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.networkTrafficSection.sectionLabel",{defaultMessage:"Network Traffic"})},n.a.createElement(rc,{formatter:"bits",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{rx:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.networkTrafficSection.networkRxRateSeriesLabel",{defaultMessage:"in"})},tx:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.podMetricsLayout.networkTrafficSection.networkTxRateSeriesLabel",{defaultMessage:"out"})}}}))),n.a.createElement(ic,{metrics:e,onChangeRangeTime:t}))))),container:Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(lc,null),n.a.createElement(dc,null,n.a.createElement($l,{navLabel:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.layoutLabel",{defaultMessage:"Container"}),sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Container Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"containerOverview"},n.a.createElement(Ql,{seriesOverrides:{cpu:{name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.cpuUsageSeriesLabel",{defaultMessage:"CPU Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},memory:{name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.memoryUsageSeriesLabel",{defaultMessage:"Memory Usage"}),color:a.eui.euiColorFullShade,formatter:"percent",gaugeMax:1},rx:{name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.inboundRXSeriesLabel",{defaultMessage:"Inbound (RX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"},tx:{name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.overviewSection.outboundTXSeriesLabel",{defaultMessage:"Outbound (TX)"}),color:a.eui.euiColorFullShade,formatter:"bits",formatterTemplate:"{{value}}/s"}}})),n.a.createElement(Ul,{id:"containerCpuUsage",label:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},n.a.createElement(rc,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{cpu:{color:a.eui.euiColorVis1}}})),n.a.createElement(Ul,{id:"containerMemory",label:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.memoryUsageSection.sectionLabel",{defaultMessage:"Memory Usage"})},n.a.createElement(rc,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{memory:{color:a.eui.euiColorVis1}}})),n.a.createElement(Ul,{id:"containerNetworkTraffic",label:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.networkTrafficSection.sectionLabel",{defaultMessage:"Network Traffic"})},n.a.createElement(rc,{formatter:"bits",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{rx:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.networkTrafficSection.networkRxRateSeriesLabel",{defaultMessage:"in"})},tx:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.networkTrafficSection.networkTxRateSeriesLabel",{defaultMessage:"out"})}}})),n.a.createElement(Ul,{id:"containerDiskIOOps",label:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoOpsSection.sectionLabel",{defaultMessage:"Disk IO (Ops)"})},n.a.createElement(rc,{type:"area",formatterTemplate:"{{value}}/s",formatter:"number",seriesOverrides:{read:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoOpsSection.readRateSeriesLabel",{defaultMessage:"reads"})},write:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoOpsSection.writeRateSeriesLabel",{defaultMessage:"writes"})}}})),n.a.createElement(Ul,{id:"containerDiskIOBytes",label:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoBytesSection.sectionLabel",{defaultMessage:"Disk IO (Bytes)"})},n.a.createElement(rc,{type:"area",formatter:"bytes",formatterTemplate:"{{value}}/s",seriesOverrides:{read:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoBytesSection.readRateSeriesLabel",{defaultMessage:"reads"})},write:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.containerMetricsLayout.diskIoBytesSection.writeRateSeriesLabel",{defaultMessage:"writes"})}}}))))))),awsEC2:Object(z.withTheme)((({metrics:e,theme:t,onChangeRangeTime:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(lc,{fields:["cloud.instance.id","cloud.provider","cloud.availability_zone","cloud.machine.type","cloud.instance.name","cloud.project.id"]}),n.a.createElement(dc,null,n.a.createElement($l,{navLabel:"AWS EC2",sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws EC2 Overview"}),metrics:e,onChangeRangeTime:a},n.a.createElement(Ul,{id:"awsEC2CpuUtilization",label:R.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.cpuUsageSection.sectionLabel",{defaultMessage:"CPU Usage"})},n.a.createElement(rc,{stacked:!0,type:"area",formatter:"percent",seriesOverrides:{total:{color:t.eui.euiColorVis1}}})),n.a.createElement(Ul,{id:"awsEC2NetworkTraffic",label:R.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.networkTrafficSection.sectionLabel",{defaultMessage:"Network Traffic"})},n.a.createElement(rc,{formatter:"bits",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{rx:{color:t.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.networkTrafficSection.networkRxRateSeriesLabel",{defaultMessage:"in"})},tx:{color:t.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.hostMetricsLayout.networkTrafficSection.networkTxRateSeriesLabel",{defaultMessage:"out"})}}})),n.a.createElement(Ul,{id:"awsEC2DiskIOBytes",label:R.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.diskIOBytesSection.sectionLabel",{defaultMessage:"Disk IO (Bytes)"})},n.a.createElement(rc,{formatter:"bytes",formatterTemplate:"{{value}}/s",type:"area",seriesOverrides:{write:{color:t.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.diskIOBytesSection.writeLabel",{defaultMessage:"writes"})},read:{color:t.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.ec2MetricsLayout.diskIOBytesSection.readLabel",{defaultMessage:"reads"})}}}))))))),awsS3:Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(dc,null,n.a.createElement($l,{navLabel:"AWS S3",sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws S3 Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"awsS3BucketSize",label:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.bucketSize.sectionLabel",{defaultMessage:"Bucket Size"})},n.a.createElement(rc,{type:"bar",formatter:"bytes",seriesOverrides:{bytes:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.bucketSize.chartLabel",{defaultMessage:"Total Bytes"})}}})),n.a.createElement(Ul,{id:"awsS3NumberOfObjects",label:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.numberOfObjects.sectionLabel",{defaultMessage:"Number of Objects"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{objects:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.numberOfObjects.chartLabel",{defaultMessage:"Objects"})}}})),n.a.createElement(Ul,{id:"awsS3TotalRequests",label:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.totalRequests.sectionLabel",{defaultMessage:"Total Requests"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{total:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.totalRequests.chartLabel",{defaultMessage:"Requests"})}}})),n.a.createElement(Ul,{id:"awsS3DownloadBytes",label:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.downloadBytes.sectionLabel",{defaultMessage:"Downloaded Bytes"})},n.a.createElement(rc,{type:"bar",formatter:"bytes",seriesOverrides:{bytes:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.downloadBytes.chartLabel",{defaultMessage:"Bytes"})}}})),n.a.createElement(Ul,{id:"awsS3UploadBytes",label:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.uploadBytes.sectionLabel",{defaultMessage:"Uploaded Bytes"})},n.a.createElement(rc,{type:"bar",formatter:"bytes",seriesOverrides:{bytes:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.s3MetricsLayout.uploadBytes.chartLabel",{defaultMessage:"Bytes"})}}}))))))),awsRDS:Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(dc,null,n.a.createElement($l,{navLabel:"AWS RDS",sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws RDS Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"awsRDSCpuTotal",label:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.cpuTotal.sectionLabel",{defaultMessage:"Total CPU Usage"})},n.a.createElement(rc,{type:"area",formatter:"percent",seriesOverrides:{cpu:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.cpuTotal.chartLabel",{defaultMessage:"Total"})}}})),n.a.createElement(Ul,{id:"awsRDSConnections",label:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.connections.sectionLabel",{defaultMessage:"Connections"})},n.a.createElement(rc,{type:"bar",formatter:"number",seriesOverrides:{connections:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.connections.chartLabel",{defaultMessage:"Connections"})}}})),n.a.createElement(Ul,{id:"awsRDSQueriesExecuted",label:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.queriesExecuted.sectionLabel",{defaultMessage:"Queries Executed"})},n.a.createElement(rc,{type:"bar",formatter:"number",seriesOverrides:{queries:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.queriesExecuted.chartLabel",{defaultMessage:"Queries"})}}})),n.a.createElement(Ul,{id:"awsRDSActiveTransactions",label:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.activeTransactions.sectionLabel",{defaultMessage:"Transactions"})},n.a.createElement(rc,{type:"bar",formatter:"number",seriesOverrides:{active:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.active.chartLabel",{defaultMessage:"Active"})},blocked:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.blocked.chartLabel",{defaultMessage:"Blocked"})}}})),n.a.createElement(Ul,{id:"awsRDSLatency",label:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.sectionLabel",{defaultMessage:"Latency"})},n.a.createElement(rc,{type:"bar",stacked:!0,formatter:"highPercision",formatterTemplate:"{{value}} ms",seriesOverrides:{read:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.read.chartLabel",{defaultMessage:"Read"})},write:{color:a.eui.euiColorVis2,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.write.chartLabel",{defaultMessage:"Write"})},insert:{color:a.eui.euiColorVis0,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.insert.chartLabel",{defaultMessage:"Insert"})},update:{color:a.eui.euiColorVis7,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.update.chartLabel",{defaultMessage:"Update"})},commit:{color:a.eui.euiColorVis3,name:R.i18n.translate("xpack.infra.metricDetailPage.rdsMetricsLayout.latency.commit.chartLabel",{defaultMessage:"Commit"})}}}))))))),awsSQS:Object(z.withTheme)((({metrics:e,onChangeRangeTime:t,theme:a})=>n.a.createElement(n.a.Fragment,null,n.a.createElement(dc,null,n.a.createElement($l,{navLabel:"AWS SQS",sectionLabel:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.overviewSection.sectionLabel",{defaultMessage:"Aws SQS Overview"}),metrics:e,onChangeRangeTime:t},n.a.createElement(Ul,{id:"awsSQSMessagesVisible",label:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesVisible.sectionLabel",{defaultMessage:"Messages Available"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{visible:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesVisible.chartLabel",{defaultMessage:"Available"})}}})),n.a.createElement(Ul,{id:"awsSQSMessagesDelayed",label:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesDelayed.sectionLabel",{defaultMessage:"Messages Delayed"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{delayed:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesDelayed.chartLabel",{defaultMessage:"Delayed"})}}})),n.a.createElement(Ul,{id:"awsSQSMessagesSent",label:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesSent.sectionLabel",{defaultMessage:"Messages Added"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{sent:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesSent.chartLabel",{defaultMessage:"Added"})}}})),n.a.createElement(Ul,{id:"awsSQSMessagesEmpty",label:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesEmpty.sectionLabel",{defaultMessage:"Messages Empty"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{sent:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.messagesEmpty.chartLabel",{defaultMessage:"Empty"})}}})),n.a.createElement(Ul,{id:"awsSQSOldestMessage",label:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.oldestMessage.sectionLabel",{defaultMessage:"Oldest Message"})},n.a.createElement(rc,{type:"bar",formatter:"abbreviatedNumber",seriesOverrides:{oldest:{color:a.eui.euiColorVis1,name:R.i18n.translate("xpack.infra.metricDetailPage.sqsMetricsLayout.oldestMessage.chartLabel",{defaultMessage:"Age"})}}})))))))},pc=({loading:e,refetch:t,type:a,metrics:r,onChangeRangeTime:i,isLiveStreaming:s,stopLiveStreaming:o})=>{if(e)return n.a.createElement(he.a,{height:"100vh",width:"auto",text:R.i18n.translate("xpack.infra.metrics.loadingNodeDataText",{defaultMessage:"Loading data"})});if(!e&&r&&0===r.length)return n.a.createElement(be.a,{titleText:R.i18n.translate("xpack.infra.metrics.emptyViewTitle",{defaultMessage:"There is no data to display."}),bodyText:R.i18n.translate("xpack.infra.metrics.emptyViewDescription",{defaultMessage:"Try adjusting your time or filter."}),refetchText:R.i18n.translate("xpack.infra.metrics.refetchButtonLabel",{defaultMessage:"Check for new data"}),onRefetch:t,testString:"metricsEmptyViewState"});const l=(e=>{const t=null==mc?void 0:mc[e];if(!t)throw new Error(R.i18n.translate("xpack.infra.inventoryModels.findLayout.error",{defaultMessage:"The layout you've attempted to find does not exist"}));return t})(a);return n.a.createElement(l,{metrics:r,onChangeRangeTime:i,isLiveStreaming:s,stopLiveStreaming:o})},gc=({"data-test-subj":e,app:t,children:a})=>{const r=Object(Ve.b)({app:t,pathname:"/settings"});return n.a.createElement(N.EuiButton,ee()({"data-test-subj":e,color:"primary"},r),a)},fc=({nodeName:e})=>{const t=Object(Ve.b)({app:"integrations",hash:"/browse"});return n.a.createElement(bc,{title:n.a.createElement("h2",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metrics.invalidNodeErrorTitle",defaultMessage:"Looks like {nodeName} isn't collecting any metrics data",values:{nodeName:e}})),body:n.a.createElement("p",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.metrics.invalidNodeErrorDescription",defaultMessage:"Double check your configuration"})),actions:n.a.createElement(N.EuiFlexGroup,null,n.a.createElement(N.EuiFlexItem,null,n.a.createElement(N.EuiButton,ee()({},t,{color:"primary",fill:!0}),n.a.createElement(V.FormattedMessage,{id:"xpack.infra.homePage.noMetricsIndicesInstructionsActionLabel",defaultMessage:"View setup instructions"}))),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(gc,{app:"metrics","data-test-subj":"configureSourceButton"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.configureSourceActionLabel",defaultMessage:"Change source configuration"}))))})},bc=Object(z.euiStyled)(N.EuiEmptyPrompt)`
  align-self: center;
`,hc=({error:e,name:t})=>{var a;return n.a.createElement(n.a.Fragment,null,n.a.createElement(te.a,{title:e=>R.i18n.translate("xpack.infra.metricDetailPage.documentTitleError",{defaultMessage:"{previousTitle} | Uh oh",values:{previousTitle:e}})}),404===(null===(a=e.body)||void 0===a?void 0:a.statusCode)?n.a.createElement(fc,{nodeName:t}):n.a.createElement(q,{message:e.message}))},yc=e=>{const t=f.a.parse(e.from.toString()),a=f.a.parse(e.to.toString(),{roundUp:!0});return{...e,from:t&&t.valueOf()||p()().subtract(1,"hour").valueOf(),to:a&&a.valueOf()||p()().valueOf()}},Ec=e=>{const{metricIndicesExist:t}=Object(r.useContext)(ce.a.Context),[a,i]=Object(r.useState)(yc(e.timeRange)),{metrics:s,loading:o,makeRequest:l,error:c}=function(e,t,a,r,n,i){const{error:s,loading:o,response:l,makeRequest:c}=Object(hr.a)("/api/metrics/node_details","POST",JSON.stringify({metrics:e,nodeId:t,nodeType:a,timerange:n,cloudId:i,sourceId:r}),(e=>Object(h.pipe)(Al.decode(e),Object(y.fold)(Object(br.c)(br.a),E.identity))));return{error:s,loading:o,metrics:l?l.metrics:[],makeRequest:c}}(e.requiredMetrics,e.nodeId,e.nodeType,e.sourceId,a,e.cloudId),u=Object(r.useCallback)((()=>{i(yc(e.timeRange))}),[e.timeRange]);return Object(r.useEffect)((()=>{i(yc(e.timeRange))}),[e.timeRange]),Object(r.useEffect)((()=>{l()}),[l,a]),c?n.a.createElement(hc,{error:c,name:e.name}):n.a.createElement(Mt,{hasData:t,pageHeader:{pageTitle:e.name,rightSideItems:[n.a.createElement(Nl,{currentTimeRange:e.timeRange,isLiveStreaming:e.isAutoReloading,refreshInterval:e.refreshInterval,setRefreshInterval:e.setRefreshInterval,onChangeTimeRange:e.setTimeRange,setAutoReload:e.setAutoReload,onRefresh:u})]}},n.a.createElement(N.EuiFlexGroup,null,n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(Bl,{loading:e.metadataLoading,name:e.name,items:e.sideNav})),n.a.createElement(N.EuiFlexItem,null,n.a.createElement(zl.Provider,{value:{items:e.sideNav,addNavItem:e.addNavItem}},n.a.createElement(sc.Provider,{value:e.metadata},n.a.createElement(pc,{loading:!(s.length>0&&e.isAutoReloading)&&o,refetch:u,type:e.nodeType,metrics:s,onChangeRangeTime:e.setTimeRange,isLiveStreaming:e.isAutoReloading,stopLiveStreaming:()=>e.setAutoReload(!1)}))))))},vc=(xc=Object(z.withTheme)((({match:e})=>{const t=e.params.node,a=e.params.type,i=Object(Q.b)(a),{sourceId:s,metricIndicesExist:o}=Object(r.useContext)(ce.a.Context),{timeRange:l,parsedTimeRange:c,setTimeRange:u,refreshInterval:d,setRefreshInterval:m,isAutoReloading:p,setAutoReload:g,triggerRefresh:f}=P(),{name:b,filteredRequiredMetrics:h,loading:y,cloudId:E,metadata:v}=en(t,a,i.requiredMetrics,s,c),[x,k]=Object(r.useState)([]),O=n.a.useCallback((e=>{x.some((t=>t.id===e.id))||k([e,...x])}),[x]),M=Object(Ve.b)({app:"metrics",pathname:"/inventory"});return fe([{...M,text:ge.b},{text:b}]),y&&!h.length?n.a.createElement(Mt,{hasData:o},n.a.createElement(he.a,{height:"100vh",width:"100%",text:R.i18n.translate("xpack.infra.metrics.loadingNodeDataText",{defaultMessage:"Loading data"})})):n.a.createElement(n.a.Fragment,null,n.a.createElement(te.a,{title:R.i18n.translate("xpack.infra.metricDetailPage.documentTitle",{defaultMessage:"Infrastructure | Metrics | {name}",values:{name:b}})}),v?n.a.createElement(Ec,{name:b,requiredMetrics:h,sourceId:s,timeRange:l,nodeType:a,nodeId:t,cloudId:E,metadataLoading:y,isAutoReloading:p,refreshInterval:d,sideNav:x,metadata:v,addNavItem:O,setRefreshInterval:m,setAutoReload:g,triggerRefresh:f,setTimeRange:u}):null)})),e=>n.a.createElement(N.EuiErrorBoundary,null,n.a.createElement(ce.a.Provider,{sourceId:"default"},n.a.createElement(L,null,n.a.createElement(xc,e)))));var xc,kc=a(26);const Oc=({isLoading:e,readOnly:t,metricAliasFieldProps:a})=>n.a.createElement(N.EuiForm,null,n.a.createElement(N.EuiTitle,{size:"s"},n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.indicesSectionTitle",defaultMessage:"Indices"}))),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiDescribedFormGroup,{title:n.a.createElement("h4",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesTitle",defaultMessage:"Metrics indices"})),description:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesDescription",defaultMessage:"Index pattern for matching indices that contain metrics data"})},n.a.createElement(N.EuiFormRow,{error:a.error,fullWidth:!0,helpText:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesRecommendedValue",defaultMessage:"The recommended value is {defaultValue}",values:{defaultValue:n.a.createElement(N.EuiCode,null,pe.f)}}),isInvalid:a.isInvalid,label:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.metricIndicesLabel",defaultMessage:"Metrics indices"})},n.a.createElement(N.EuiFieldText,ee()({"data-test-subj":"metricIndicesInput",fullWidth:!0,disabled:e,readOnly:t,isLoading:e},a))))),Mc=({isLoading:e,readOnly:t,anomalyThresholdFieldProps:a})=>n.a.createElement(N.EuiForm,null,n.a.createElement(N.EuiTitle,{size:"s"},n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.mlSectionTitle",defaultMessage:"Machine Learning"}))),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiDescribedFormGroup,{title:n.a.createElement("h4",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.anomalyThresholdTitle",defaultMessage:"Anomaly Severity Threshold"})),description:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.anomalyThresholdDescription",defaultMessage:"Sets the minimum severity score required to show anomalies in the Metrics application."})},n.a.createElement(N.EuiFormRow,{error:a.error,fullWidth:!0,isInvalid:a.isInvalid,label:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.anomalyThresholdLabel",defaultMessage:"Minimum severity score"})},n.a.createElement(N.EuiRange,ee()({min:0,max:100,"data-test-subj":"anomalyThresholdInput",showInput:!0,showTicks:!0,showRange:!0,tickInterval:20,"aria-label":"Minimum severity score",disabled:e,readOnly:t,isLoading:e},a))))),wc=({isLoading:e,readOnly:t,nameFieldProps:a})=>n.a.createElement(N.EuiForm,null,n.a.createElement(N.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationNameSectionTitle"},n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameSectionTitle",defaultMessage:"Name"}))),n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiDescribedFormGroup,{title:n.a.createElement("h4",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})),description:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameDescription",defaultMessage:"A descriptive name for the source configuration"})},n.a.createElement(N.EuiFormRow,{error:a.error,fullWidth:!0,isInvalid:a.isInvalid,label:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})},n.a.createElement(N.EuiFieldText,ee()({"data-test-subj":"nameInput",fullWidth:!0,disabled:e,readOnly:t,isLoading:e},a))))),jc=({shouldAllowEdit:e})=>{fe([{text:ge.h}]);const{createSourceConfiguration:t,source:a,sourceExists:i,isLoading:s,isUninitialized:o,updateSourceConfiguration:l}=Object(r.useContext)(ce.a.Context),{indicesConfigurationProps:c,errors:u,resetForm:d,isFormDirty:m,isFormValid:p,formState:g,formStateChanges:f}=ft(a&&a.configuration),b=Object(r.useCallback)((async()=>{i?await l(f):await t(g),d()}),[i,l,t,d,g,f]),h=Object(r.useMemo)((()=>e&&a&&"internal"!==a.origin),[e,a]),{hasInfraMLCapabilities:y}=Jn();return!s&&!o||a?null!=a&&a.configuration?n.a.createElement(Mt,{pageHeader:{pageTitle:ge.h},"data-test-subj":"sourceConfigurationContent",restrictWidth:!0},n.a.createElement(kc.b,{prompt:m?R.i18n.translate("xpack.infra.sourceConfiguration.unsavedFormPrompt",{defaultMessage:"Are you sure you want to leave? Changes will be lost"}):void 0}),n.a.createElement(N.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},n.a.createElement(wc,{isLoading:s,nameFieldProps:c.name,readOnly:!h})),n.a.createElement(N.EuiSpacer,null),n.a.createElement(N.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},n.a.createElement(Oc,{isLoading:s,metricAliasFieldProps:c.metricAlias,readOnly:!h})),n.a.createElement(N.EuiSpacer,null),y&&n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},n.a.createElement(Mc,{isLoading:s,readOnly:!h,anomalyThresholdFieldProps:c.anomalyThreshold})),n.a.createElement(N.EuiSpacer,null)),u.length>0?n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiCallOut,{color:"danger"},n.a.createElement("ul",null,u.map(((e,t)=>n.a.createElement("li",{key:t},e))))),n.a.createElement(N.EuiSpacer,{size:"m"})):null,n.a.createElement(N.EuiSpacer,{size:"m"}),n.a.createElement(N.EuiFlexGroup,null,h&&n.a.createElement(N.EuiFlexItem,null,s?n.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd"},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,{color:"primary",isLoading:!0,fill:!0},"Loading"))):n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlexGroup,{justifyContent:"flexEnd"},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,{"data-test-subj":"discardSettingsButton",color:"danger",iconType:"cross",isDisabled:s||!m,onClick:()=>{d()}},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.discardSettingsButtonLabel",defaultMessage:"Discard"}))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,{"data-test-subj":"applySettingsButton",color:"primary",isDisabled:!m||!p,fill:!0,onClick:b},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.sourceConfiguration.applySettingsButtonLabel",defaultMessage:"Apply"})))))))):null:n.a.createElement(ca.a,null)},Sc=()=>{var e,t;const a=null===(e=Object(A.useKibana)().services.application)||void 0===e?void 0:e.capabilities;return n.a.createElement(N.EuiErrorBoundary,null,n.a.createElement(jc,{shouldAllowEdit:null==a||null===(t=a.infrastructure)||void 0===t?void 0:t.configureSource}))},Cc=()=>{var e;const[t,a]=Object(r.useState)(!1),[i,s]=Object(r.useState)(null),o=null===(e=Object(A.useKibana)().services.application)||void 0===e?void 0:e.capabilities,l=Object(r.useMemo)((()=>{var e;return Boolean(null==o||null===(e=o.infrastructure)||void 0===e?void 0:e.save)}),[o]),c=Object(r.useCallback)((()=>s(null)),[s]),u=Object(r.useCallback)((()=>{a(!1)}),[a]),d=Object(r.useCallback)((()=>{a(!t)}),[a,t]),m=Object(r.useMemo)((()=>({id:1,title:R.i18n.translate("xpack.infra.alerting.infrastructureDropdownTitle",{defaultMessage:"Infrastructure rules"}),items:[{"data-test-subj":"inventory-alerts-create-rule",name:R.i18n.translate("xpack.infra.alerting.createInventoryRuleButton",{defaultMessage:"Create inventory rule"}),onClick:()=>{u(),s("inventory")}}]})),[s,u]),p=Object(r.useMemo)((()=>({id:2,title:R.i18n.translate("xpack.infra.alerting.metricsDropdownTitle",{defaultMessage:"Metrics rules"}),items:[{"data-test-subj":"metrics-threshold-alerts-create-rule",name:R.i18n.translate("xpack.infra.alerting.createThresholdRuleButton",{defaultMessage:"Create threshold rule"}),onClick:()=>{u(),s("threshold")}}]})),[s,u]),g=Object(Ve.b)({app:"management",pathname:"/insightsAndAlerting/triggersActions/alerts"}),f=Object(r.useMemo)((()=>({name:R.i18n.translate("xpack.infra.alerting.manageRules",{defaultMessage:"Manage rules"}),icon:"tableOfContents",onClick:g.onClick})),[g]),b=Object(r.useMemo)((()=>l?[{"data-test-subj":"inventory-alerts-menu-option",name:R.i18n.translate("xpack.infra.alerting.infrastructureDropdownMenu",{defaultMessage:"Infrastructure"}),panel:1},{"data-test-subj":"metrics-threshold-alerts-menu-option",name:R.i18n.translate("xpack.infra.alerting.metricsDropdownMenu",{defaultMessage:"Metrics"}),panel:2},f]:[f]),[l,f]),h=Object(r.useMemo)((()=>[{id:0,title:R.i18n.translate("xpack.infra.alerting.alertDropdownTitle",{defaultMessage:"Alerts and rules"}),items:b}].concat(l?[m,p]:[])),[m,p,b,l]);return n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiPopover,{panelPaddingSize:"none",anchorPosition:"downLeft",button:n.a.createElement(N.EuiHeaderLink,{color:"text",iconSide:"right",iconType:"arrowDown",onClick:d,"data-test-subj":"infrastructure-alerts-and-rules"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.alerting.alertsButton",defaultMessage:"Alerts and rules"})),isOpen:t,closePopover:u},n.a.createElement(N.EuiContextMenu,{initialPanelId:0,panels:h,"data-test-subj":"metrics-alert-menu"})),n.a.createElement(Tc,{visibleFlyoutType:i,onClose:c}))},Tc=({visibleFlyoutType:e,onClose:t})=>{switch(e){case"inventory":return n.a.createElement(Ls,{onClose:t});case"threshold":return n.a.createElement(Se,{onClose:t});default:return null}};var Fc=a(201);const Lc=e=>{const[t]=Object(r.useState)((()=>p()())),{goHome:a}=e,[i,s]=Object(r.useState)(t.clone().subtract(4,"weeks")),[o,l]=Object(r.useState)(null),c=Yi(),u=ps(),[d,m]=Object(r.useState)(""),[g,f]=Object(r.useState)(""),b=Object(de.useUiTracker)({app:"infra_metrics"}),{createDerivedIndexPattern:h}=Object(J.a)({sourceId:"default"}),y=c.sourceConfiguration.indices,E=Object(r.useMemo)((()=>"kubernetes"===e.jobType?u.setupStatus:c.setupStatus),[e.jobType,u.setupStatus,c.setupStatus]),v=Object(r.useMemo)((()=>"kubernetes"===e.jobType?u.cleanUpAndSetUpModule:c.cleanUpAndSetUpModule),[e.jobType,u.cleanUpAndSetUpModule,c.cleanUpAndSetUpModule]),x=Object(r.useMemo)((()=>"kubernetes"===e.jobType?u.setUpModule:c.setUpModule),[e.jobType,u.setUpModule,c.setUpModule]),k=Object(r.useMemo)((()=>"kubernetes"===e.jobType?u.jobSummaries.length>0:c.jobSummaries.length>0),[e.jobType,u.jobSummaries,c.jobSummaries]),O=Object(r.useMemo)((()=>h()),[h]),M=Object(r.useCallback)((e=>{s(e)}),[]),w=Object(r.useCallback)((()=>{k?v(y,p()(i).toDate().getTime(),void 0,g,o?o[0]:void 0):x(y,p()(i).toDate().getTime(),void 0,g,o?o[0]:void 0)}),[v,g,x,k,y,o,i]),j=Object(r.useCallback)((e=>{m(e||""),f(Object(Qt.a)(e,O)||"")}),[O]),S=Object(r.useCallback)(Object(ve.debounce)(j,500),[j]),C=Object(r.useCallback)((e=>{l(e.map((e=>e.label)))}),[]);return Object(r.useEffect)((()=>{"kubernetes"===e.jobType&&l([is])}),[e.jobType]),Object(r.useEffect)((()=>{"succeeded"===E.type&&("kubernetes"===e.jobType?(b({metric:"metrics_ml_anomaly_detection_k8s_enabled"}),!o||1===o.length&&o[0]===is||b({metric:"metrics_ml_anomaly_detection_k8s_partition_changed"})):(b({metric:"metrics_ml_anomaly_detection_hosts_enabled"}),o&&b({metric:"metrics_ml_anomaly_detection_hosts_partition_changed"}),b({metric:"metrics_ml_anomaly_detection_hosts_enabled"})),a())}),[E,e.jobType,o,b,a]),n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiFlyoutHeader,null,n.a.createElement(N.EuiTitle,{size:"m"},n.a.createElement("h2",null,n.a.createElement(V.FormattedMessage,{defaultMessage:"Enable machine learning for {nodeType}",id:"xpack.infra.ml.aomalyFlyout.jobSetup.flyoutHeader",values:{nodeType:e.jobType}})))),n.a.createElement(N.EuiFlyoutBody,null,"pending"===E.type?n.a.createElement(N.EuiFlexGroup,{alignItems:"center"},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiLoadingSpinner,{size:"xl"})),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.loadingText",defaultMessage:"Creating ML job..."}))):"failed"===E.type?n.a.createElement(n.a.Fragment,null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.failureText",defaultMessage:"Something went wrong creating the necessary ML jobs."}),n.a.createElement(N.EuiSpacer,null),n.a.createElement(N.EuiButton,{fill:!0,onClick:w},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.tryAgainButton",defaultMessage:"Try again"}))):n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiText,null,n.a.createElement("p",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.description",defaultMessage:"Settings can not be changed once the jobs are created. You can recreate jobs anytime, however, the previously detected anomalies are removed."}))),n.a.createElement(N.EuiSpacer,{size:"l"}),n.a.createElement(N.EuiForm,null,n.a.createElement(N.EuiDescribedFormGroup,{title:n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.when.title",defaultMessage:"When does your model begin?"})),description:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.when.description",defaultMessage:"By default, machine learning jobs analyze the last 4 weeks of data and continue to run indefinitely."})},n.a.createElement(N.EuiFormRow,{label:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.when.timePicker.label",defaultMessage:"Start date"})},n.a.createElement(Fc.a,{showTimeSelect:!0,selected:i,onChange:M,maxDate:t}))),n.a.createElement(N.EuiDescribedFormGroup,{title:n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.partition.title",defaultMessage:"How do you want to partition your data?"})),description:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.partition.description",defaultMessage:"Partitions enable you to build independent models for groups of data that share similar behavior. For example, you can partition by machine type or cloud availability zone."})},n.a.createElement(N.EuiFormRow,{label:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.partition.label",defaultMessage:"Partition field"}),display:"rowCompressed"},n.a.createElement(N.EuiComboBox,{placeholder:R.i18n.translate("xpack.infra.metricsExplorer.groupByLabel",{defaultMessage:"Everything"}),"aria-label":R.i18n.translate("xpack.infra.metricsExplorer.groupByAriaLabel",{defaultMessage:"Graph per"}),fullWidth:!0,singleSelection:!0,selectedOptions:o?o.map((e=>({label:e}))):void 0,options:O.fields.filter((e=>e.aggregatable&&"string"===e.type)).map((e=>({label:e.name}))),onChange:C,isClearable:!0}))),n.a.createElement(N.EuiDescribedFormGroup,{title:n.a.createElement("h3",null,n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.filter.title",defaultMessage:"Filter"})),description:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.filter.description",defaultMessage:"By default, machine learning jobs analyze all of your metric data."})},n.a.createElement(N.EuiFormRow,{display:"rowCompressed",label:n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.filter.label",defaultMessage:"Filter (optional)"})},n.a.createElement(rt.a,{derivedIndexPattern:O,onSubmit:j,onChange:S,value:d})))))),n.a.createElement(N.EuiFlyoutFooter,null,n.a.createElement(N.EuiFlexGroup,{justifyContent:"spaceBetween"},n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButtonEmpty,{onClick:e.closeFlyout},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.cancelButton",defaultMessage:"Cancel"}))),n.a.createElement(N.EuiFlexItem,{grow:!1},n.a.createElement(N.EuiButton,{fill:!0,fullWidth:!1,onClick:w},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.steps.setupProcess.enableButton",defaultMessage:"Enable jobs"}))))))};var Pc=a(169);const Ic=()=>{var e,t;const{hasInfraMLSetupCapabilities:a}=Hn(),[i,s]=Object(r.useState)(!1),[o,l]=Object(r.useState)("home"),[c,u]=Object(r.useState)(null),{source:d}=Object(J.a)({sourceId:"default"}),{space:m}=Object(Pc.a)(),p=Object(r.useCallback)((()=>{l("home"),s(!0)}),[]),g=Object(r.useCallback)((e=>{l("setup"),u({jobType:e})}),[l]),f=Object(r.useCallback)((()=>{s(!1)}),[]);return null==(null==d?void 0:d.configuration.metricAlias)||null==m?null:n.a.createElement(n.a.Fragment,null,n.a.createElement(N.EuiHeaderLink,{color:"text",iconSide:"left",iconType:"inspect",onClick:p,"data-test-subj":"openAnomalyFlyoutButton"},n.a.createElement(V.FormattedMessage,{id:"xpack.infra.ml.anomalyDetectionButton",defaultMessage:"Anomaly detection"})),i&&n.a.createElement(Xi,{indexPattern:null!==(e=null==d?void 0:d.configuration.metricAlias)&&void 0!==e?e:"",sourceId:"default",spaceId:m.id},n.a.createElement(ms,{indexPattern:null!==(t=null==d?void 0:d.configuration.metricAlias)&&void 0!==t?t:"",sourceId:"default",spaceId:m.id},n.a.createElement(N.EuiFlyout,{onClose:f,"data-test-subj":"loadMLFlyout"},"home"===o&&n.a.createElement(gs,{hasSetupCapabilities:a,goToSetup:g,closeFlyout:f}),"setup"===o&&n.a.createElement(Lc,{goHome:p,closeFlyout:f,jobType:c.jobType})))))};var Dc=a(43);const _c=R.i18n.translate("xpack.infra.metricsHeaderAddDataButtonLabel",{defaultMessage:"Add data"}),Rc=({match:e})=>{var t,a,i,s,l;const c=null===(t=Object(A.useKibana)().services.application)||void 0===t?void 0:t.capabilities,{setHeaderActionMenu:u,theme$:d}=Object(r.useContext)(Dc.a),m=R.i18n.translate("xpack.infra.metrics.settingsTabTitle",{defaultMessage:"Settings"}),p=Object(A.useKibana)();Object(re.a)(!(null!=c&&null!==(a=c.infrastructure)&&void 0!==a&&a.save));const g=Object(Ve.b)({app:"metrics",pathname:"settings"}),f=Object(de.createExploratoryViewUrl)({reportType:"kpi-over-time",allSeries:[{dataType:"infra_metrics",seriesType:"area",time:{to:"now",from:"now-15m"},reportDefinitions:{"agent.hostname":["ALL_VALUES"]},selectedMetricField:"system.cpu.total.norm.pct",name:"Metrics-series"}]},null===(i=p.services.http)||void 0===i?void 0:i.basePath.get());return n.a.createElement(N.EuiErrorBoundary,null,n.a.createElement(ce.a.Provider,{sourceId:"default"},n.a.createElement(we.a,null,n.a.createElement(Ia.c,null,n.a.createElement(Ht,null,n.a.createElement(aa,null,n.a.createElement(qn,null,n.a.createElement(te.a,{title:R.i18n.translate("xpack.infra.homePage.documentTitle",{defaultMessage:"Metrics"})}),n.a.createElement(ae.a,{feedbackLink:"https://discuss.elastic.co/c/metrics",appName:R.i18n.translate("xpack.infra.header.infrastructureHelpAppName",{defaultMessage:"Metrics"})}),u&&d&&n.a.createElement(de.HeaderMenuPortal,{setHeaderActionMenu:u,theme$:d},n.a.createElement(N.EuiHeaderLinks,{gutterSize:"xs"},n.a.createElement(N.EuiToolTip,{position:"top",content:n.a.createElement("p",null,Nc)},n.a.createElement(A.RedirectAppLinks,{application:p.services.application},n.a.createElement(N.EuiHeaderLink,{"aria-label":R.i18n.translate("xpack.infra.metrics.pageHeader.analyzeData.label",{defaultMessage:'Navigate to the "Explore Data" view to visualize infra metrics data'}),href:f,color:"text",iconType:"visBarVerticalStacked"},Bc))),n.a.createElement(N.EuiHeaderLink,ee()({color:"text"},g),m),n.a.createElement(o.Route,{path:"/inventory",component:Ic}),n.a.createElement(Cc,null),n.a.createElement(N.EuiHeaderLink,{href:null===(s=p.services)||void 0===s||null===(l=s.application)||void 0===l?void 0:l.getUrlForApp("/integrations/browse"),color:"primary",iconType:"indexOpen"},_c))),n.a.createElement(o.Switch,null,n.a.createElement(o.Route,{path:"/inventory",component:Pl}),n.a.createElement(o.Route,{path:"/explorer",render:e=>n.a.createElement(ue,null,(({configuration:e,createDerivedIndexPattern:t})=>n.a.createElement(ne.c.Provider,null,n.a.createElement(oe,null),e?n.a.createElement(Ac,{configuration:e,createDerivedIndexPattern:t}):n.a.createElement(ca.a,null))))}),n.a.createElement(o.Route,{path:"/detail/:type/:node",component:vc}),n.a.createElement(o.Route,{path:"/settings",component:Sc})))))))))},Ac=e=>{const{createDerivedIndexPattern:t,configuration:a}=e,{options:i}=Object(r.useContext)(ne.c.Context);return n.a.createElement(Et,{shouldLoadDefault:"default"===i.source,viewType:"metrics-explorer-view",defaultViewState:ne.a},n.a.createElement(Pt,ee()({derivedIndexPattern:t(),source:a},e)))},Bc=R.i18n.translate("xpack.infra.metrics.exploreDataButtonLabel",{defaultMessage:"Explore data"}),Nc=R.i18n.translate("xpack.infra.metrics.exploreDataButtonLabel.message",{defaultMessage:"Explore Data allows you to select and filter result data in any dimension and look for the cause or impact of performance problems."});var Vc=a(198),zc=a(42);const $c=(e,t,{element:a,history:r,setHeaderActionMenu:i,theme$:o})=>{const c=new l.Storage(window.localStorage);return Object(no.b)(a,"infraMetricsPage"),s.a.render(n.a.createElement(Uc,{core:e,history:r,plugins:t,setHeaderActionMenu:i,storage:c,theme$:o}),a),()=>{s.a.unmountComponentAtNode(a)}},Uc=({core:e,history:t,plugins:a,setHeaderActionMenu:r,storage:i,theme$:s})=>{var l,u,d,m;const p=e.application.capabilities;return n.a.createElement(zc.b,{core:e,plugins:a,theme$:s},n.a.createElement(zc.a,{appName:"Metrics UI",setHeaderActionMenu:r,storage:i,theme$:s,triggersActionsUI:a.triggersActionsUi},n.a.createElement(o.Router,{history:t},n.a.createElement(o.Switch,null,n.a.createElement(o.Route,{path:"/link-to",component:Y}),(null==p||null===(l=p.infrastructure)||void 0===l?void 0:l.show)&&n.a.createElement(Vc.a,{from:"/",exact:!0,to:"/inventory"}),(null==p||null===(u=p.infrastructure)||void 0===u?void 0:u.show)&&n.a.createElement(Vc.a,{from:"/snapshot",exact:!0,to:"/inventory"}),(null==p||null===(d=p.infrastructure)||void 0===d?void 0:d.show)&&n.a.createElement(Vc.a,{from:"/metrics-explorer",exact:!0,to:"/explorer"}),(null==p||null===(m=p.infrastructure)||void 0===m?void 0:m.show)&&n.a.createElement(o.Route,{path:"/",component:Rc}),n.a.createElement(o.Route,{component:c.a})))))}}}]);