/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[10],{145:function(e,t,a){!function(e,t,a,n,i,r,o,s){"use strict";var l=Array.prototype,c=l.map,u=l.slice,d={name:"implicit"};function m(e){var t=a.map(),n=[],i=d;function r(a){var r=a+"",o=t.get(r);if(!o){if(i!==d)return i;t.set(r,o=n.push(a))}return e[(o-1)%e.length]}return e=null==e?[]:u.call(e),r.domain=function(e){if(!arguments.length)return n.slice();n=[],t=a.map();for(var i,o,s=-1,l=e.length;++s<l;)t.has(o=(i=e[s])+"")||t.set(o,n.push(i));return r},r.range=function(t){return arguments.length?(e=u.call(t),r):e.slice()},r.unknown=function(e){return arguments.length?(i=e,r):i},r.copy=function(){return m().domain(n).range(e).unknown(i)},r}function g(){var e,a,n=m().unknown(void 0),i=n.domain,r=n.range,o=[0,1],s=!1,l=0,c=0,u=.5;function d(){var n=i().length,d=o[1]<o[0],m=o[d-0],g=o[1-d];e=(g-m)/Math.max(1,n-l+2*c),s&&(e=Math.floor(e)),m+=(g-m-e*(n-l))*u,a=e*(1-l),s&&(m=Math.round(m),a=Math.round(a));var f=t.range(n).map((function(t){return m+e*t}));return r(d?f.reverse():f)}return delete n.unknown,n.domain=function(e){return arguments.length?(i(e),d()):i()},n.range=function(e){return arguments.length?(o=[+e[0],+e[1]],d()):o.slice()},n.rangeRound=function(e){return o=[+e[0],+e[1]],s=!0,d()},n.bandwidth=function(){return a},n.step=function(){return e},n.round=function(e){return arguments.length?(s=!!e,d()):s},n.padding=function(e){return arguments.length?(l=c=Math.max(0,Math.min(1,e)),d()):l},n.paddingInner=function(e){return arguments.length?(l=Math.max(0,Math.min(1,e)),d()):l},n.paddingOuter=function(e){return arguments.length?(c=Math.max(0,Math.min(1,e)),d()):c},n.align=function(e){return arguments.length?(u=Math.max(0,Math.min(1,e)),d()):u},n.copy=function(){return g().domain(i()).range(o).round(s).paddingInner(l).paddingOuter(c).align(u)},d()}function f(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return f(t())},e}function h(){return f(g().paddingInner(1))}var p=function(e){return function(){return e}},b=function(e){return+e},y=[0,1];function E(e,t){return(t-=e=+e)?function(a){return(a-e)/t}:p(t)}function v(e){return function(t,a){var n=e(t=+t,a=+a);return function(e){return e<=t?0:e>=a?1:n(e)}}}function x(e){return function(t,a){var n=e(t=+t,a=+a);return function(e){return e<=0?t:e>=1?a:n(e)}}}function _(e,t,a,n){var i=e[0],r=e[1],o=t[0],s=t[1];return r<i?(i=a(r,i),o=n(s,o)):(i=a(i,r),o=n(o,s)),function(e){return o(i(e))}}function M(e,a,n,i){var r=Math.min(e.length,a.length)-1,o=new Array(r),s=new Array(r),l=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),a=a.slice().reverse());++l<r;)o[l]=n(e[l],e[l+1]),s[l]=i(a[l],a[l+1]);return function(a){var n=t.bisect(e,a,1,r)-1;return s[n](o[n](a))}}function S(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp())}function T(e,t){var a,i,r,o=y,s=y,l=n.interpolate,d=!1;function m(){return a=Math.min(o.length,s.length)>2?M:_,i=r=null,g}function g(t){return(i||(i=a(o,s,d?v(e):e,l)))(+t)}return g.invert=function(e){return(r||(r=a(s,o,E,d?x(t):t)))(+e)},g.domain=function(e){return arguments.length?(o=c.call(e,b),m()):o.slice()},g.range=function(e){return arguments.length?(s=u.call(e),m()):s.slice()},g.rangeRound=function(e){return s=u.call(e),l=n.interpolateRound,m()},g.clamp=function(e){return arguments.length?(d=!!e,m()):d},g.interpolate=function(e){return arguments.length?(l=e,m()):l},m()}var C=function(e,a,n){var r,o=e[0],s=e[e.length-1],l=t.tickStep(o,s,null==a?10:a);switch((n=i.formatSpecifier(null==n?",f":n)).type){case"s":var c=Math.max(Math.abs(o),Math.abs(s));return null!=n.precision||isNaN(r=i.precisionPrefix(l,c))||(n.precision=r),i.formatPrefix(n,c);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN(r=i.precisionRound(l,Math.max(Math.abs(o),Math.abs(s))))||(n.precision=r-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN(r=i.precisionFixed(l))||(n.precision=r-2*("%"===n.type))}return i.format(n)};function O(e){var a=e.domain;return e.ticks=function(e){var n=a();return t.ticks(n[0],n[n.length-1],null==e?10:e)},e.tickFormat=function(e,t){return C(a(),e,t)},e.nice=function(n){null==n&&(n=10);var i,r=a(),o=0,s=r.length-1,l=r[o],c=r[s];return c<l&&(i=l,l=c,c=i,i=o,o=s,s=i),(i=t.tickIncrement(l,c,n))>0?(l=Math.floor(l/i)*i,c=Math.ceil(c/i)*i,i=t.tickIncrement(l,c,n)):i<0&&(l=Math.ceil(l*i)/i,c=Math.floor(c*i)/i,i=t.tickIncrement(l,c,n)),i>0?(r[o]=Math.floor(l/i)*i,r[s]=Math.ceil(c/i)*i,a(r)):i<0&&(r[o]=Math.ceil(l*i)/i,r[s]=Math.floor(c*i)/i,a(r)),e},e}function j(){var e=T(E,n.interpolateNumber);return e.copy=function(){return S(e,j())},O(e)}function w(){var e=[0,1];function t(e){return+e}return t.invert=t,t.domain=t.range=function(a){return arguments.length?(e=c.call(a,b),t):e.slice()},t.copy=function(){return w().domain(e)},O(t)}var k=function(e,t){var a,n=0,i=(e=e.slice()).length-1,r=e[n],o=e[i];return o<r&&(a=n,n=i,i=a,a=r,r=o,o=a),e[n]=t.floor(r),e[i]=t.ceil(o),e};function I(e,t){return(t=Math.log(t/e))?function(a){return Math.log(a/e)/t}:p(t)}function F(e,t){return e<0?function(a){return-Math.pow(-t,a)*Math.pow(-e,1-a)}:function(a){return Math.pow(t,a)*Math.pow(e,1-a)}}function L(e){return isFinite(e)?+("1e"+e):e<0?0:e}function D(e){return 10===e?L:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function P(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function R(e){return function(t){return-e(-t)}}function N(){var e=T(I,F).domain([1,10]),a=e.domain,n=10,r=P(10),o=D(10);function s(){return r=P(n),o=D(n),a()[0]<0&&(r=R(r),o=R(o)),e}return e.base=function(e){return arguments.length?(n=+e,s()):n},e.domain=function(e){return arguments.length?(a(e),s()):a()},e.ticks=function(e){var i,s=a(),l=s[0],c=s[s.length-1];(i=c<l)&&(g=l,l=c,c=g);var u,d,m,g=r(l),f=r(c),h=null==e?10:+e,p=[];if(!(n%1)&&f-g<h){if(g=Math.round(g)-1,f=Math.round(f)+1,l>0){for(;g<f;++g)for(d=1,u=o(g);d<n;++d)if(!((m=u*d)<l)){if(m>c)break;p.push(m)}}else for(;g<f;++g)for(d=n-1,u=o(g);d>=1;--d)if(!((m=u*d)<l)){if(m>c)break;p.push(m)}}else p=t.ticks(g,f,Math.min(f-g,h)).map(o);return i?p.reverse():p},e.tickFormat=function(t,a){if(null==a&&(a=10===n?".0e":","),"function"!=typeof a&&(a=i.format(a)),t===1/0)return a;null==t&&(t=10);var s=Math.max(1,n*t/e.ticks().length);return function(e){var t=e/o(Math.round(r(e)));return t*n<n-.5&&(t*=n),t<=s?a(e):""}},e.nice=function(){return a(k(a(),{floor:function(e){return o(Math.floor(r(e)))},ceil:function(e){return o(Math.ceil(r(e)))}}))},e.copy=function(){return S(e,N().base(n))},e}function A(e,t){return e<0?-Math.pow(-e,t):Math.pow(e,t)}function H(){var e=1,t=T(n,i),a=t.domain;function n(t,a){return(a=A(a,e)-(t=A(t,e)))?function(n){return(A(n,e)-t)/a}:p(a)}function i(t,a){return a=A(a,e)-(t=A(t,e)),function(n){return A(t+a*n,1/e)}}return t.exponent=function(t){return arguments.length?(e=+t,a(a())):e},t.copy=function(){return S(t,H().exponent(e))},O(t)}function U(){return H().exponent(.5)}function z(){var e=[],a=[],n=[];function i(){var i=0,o=Math.max(1,a.length);for(n=new Array(o-1);++i<o;)n[i-1]=t.quantile(e,i/o);return r}function r(e){if(!isNaN(e=+e))return a[t.bisect(n,e)]}return r.invertExtent=function(t){var i=a.indexOf(t);return i<0?[NaN,NaN]:[i>0?n[i-1]:e[0],i<n.length?n[i]:e[e.length-1]]},r.domain=function(a){if(!arguments.length)return e.slice();e=[];for(var n,r=0,o=a.length;r<o;++r)null==(n=a[r])||isNaN(n=+n)||e.push(n);return e.sort(t.ascending),i()},r.range=function(e){return arguments.length?(a=u.call(e),i()):a.slice()},r.quantiles=function(){return n.slice()},r.copy=function(){return z().domain(e).range(a)},r}function J(){var e=0,a=1,n=1,i=[.5],r=[0,1];function o(e){if(e<=e)return r[t.bisect(i,e,0,n)]}function s(){var t=-1;for(i=new Array(n);++t<n;)i[t]=((t+1)*a-(t-n)*e)/(n+1);return o}return o.domain=function(t){return arguments.length?(e=+t[0],a=+t[1],s()):[e,a]},o.range=function(e){return arguments.length?(n=(r=u.call(e)).length-1,s()):r.slice()},o.invertExtent=function(t){var o=r.indexOf(t);return o<0?[NaN,NaN]:o<1?[e,i[0]]:o>=n?[i[n-1],a]:[i[o-1],i[o]]},o.copy=function(){return J().domain([e,a]).range(r)},O(o)}function Y(){var e=[.5],a=[0,1],n=1;function i(i){if(i<=i)return a[t.bisect(e,i,0,n)]}return i.domain=function(t){return arguments.length?(e=u.call(t),n=Math.min(e.length,a.length-1),i):e.slice()},i.range=function(t){return arguments.length?(a=u.call(t),n=Math.min(e.length,a.length-1),i):a.slice()},i.invertExtent=function(t){var n=a.indexOf(t);return[e[n-1],e[n]]},i.copy=function(){return Y().domain(e).range(a)},i}var B=1e3,V=60*B,$=60*V,q=24*$,W=7*q,G=30*q,Q=365*q;function Z(e){return new Date(e)}function X(e){return e instanceof Date?+e:+new Date(+e)}function K(e,a,i,r,o,s,l,u,d){var m=T(E,n.interpolateNumber),g=m.invert,f=m.domain,h=d(".%L"),p=d(":%S"),b=d("%I:%M"),y=d("%I %p"),v=d("%a %d"),x=d("%b %d"),_=d("%B"),M=d("%Y"),C=[[l,1,B],[l,5,5*B],[l,15,15*B],[l,30,30*B],[s,1,V],[s,5,5*V],[s,15,15*V],[s,30,30*V],[o,1,$],[o,3,3*$],[o,6,6*$],[o,12,12*$],[r,1,q],[r,2,2*q],[i,1,W],[a,1,G],[a,3,3*G],[e,1,Q]];function O(t){return(l(t)<t?h:s(t)<t?p:o(t)<t?b:r(t)<t?y:a(t)<t?i(t)<t?v:x:e(t)<t?_:M)(t)}function j(a,n,i,r){if(null==a&&(a=10),"number"==typeof a){var o=Math.abs(i-n)/a,s=t.bisector((function(e){return e[2]})).right(C,o);s===C.length?(r=t.tickStep(n/Q,i/Q,a),a=e):s?(r=(s=C[o/C[s-1][2]<C[s][2]/o?s-1:s])[1],a=s[0]):(r=Math.max(t.tickStep(n,i,a),1),a=u)}return null==r?a:a.every(r)}return m.invert=function(e){return new Date(g(e))},m.domain=function(e){return arguments.length?f(c.call(e,X)):f().map(Z)},m.ticks=function(e,t){var a,n=f(),i=n[0],r=n[n.length-1],o=r<i;return o&&(a=i,i=r,r=a),a=(a=j(e,i,r,t))?a.range(i,r+1):[],o?a.reverse():a},m.tickFormat=function(e,t){return null==t?O:d(t)},m.nice=function(e,t){var a=f();return(e=j(e,a[0],a[a.length-1],t))?f(k(a,e)):m},m.copy=function(){return S(m,K(e,a,i,r,o,s,l,u,d))},m}var ee=function(){return K(r.timeYear,r.timeMonth,r.timeWeek,r.timeDay,r.timeHour,r.timeMinute,r.timeSecond,r.timeMillisecond,o.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)])},te=function(){return K(r.utcYear,r.utcMonth,r.utcWeek,r.utcDay,r.utcHour,r.utcMinute,r.utcSecond,r.utcMillisecond,o.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)])},ae=function(e){return e.match(/.{6}/g).map((function(e){return"#"+e}))},ne=ae("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),ie=ae("393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6"),re=ae("3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9"),oe=ae("1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5"),se=n.interpolateCubehelixLong(s.cubehelix(300,.5,0),s.cubehelix(-240,.5,1)),le=n.interpolateCubehelixLong(s.cubehelix(-100,.75,.35),s.cubehelix(80,1.5,.8)),ce=n.interpolateCubehelixLong(s.cubehelix(260,.75,.35),s.cubehelix(80,1.5,.8)),ue=s.cubehelix(),de=function(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return ue.h=360*e-100,ue.s=1.5-1.5*t,ue.l=.8-.9*t,ue+""};function me(e){var t=e.length;return function(a){return e[Math.max(0,Math.min(t-1,Math.floor(a*t)))]}}var ge=me(ae("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),fe=me(ae("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),he=me(ae("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),pe=me(ae("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function be(e){var t=0,a=1,n=!1;function i(i){var r=(i-t)/(a-t);return e(n?Math.max(0,Math.min(1,r)):r)}return i.domain=function(e){return arguments.length?(t=+e[0],a=+e[1],i):[t,a]},i.clamp=function(e){return arguments.length?(n=!!e,i):n},i.interpolator=function(t){return arguments.length?(e=t,i):e},i.copy=function(){return be(e).domain([t,a]).clamp(n)},O(i)}e.scaleBand=g,e.scalePoint=h,e.scaleIdentity=w,e.scaleLinear=j,e.scaleLog=N,e.scaleOrdinal=m,e.scaleImplicit=d,e.scalePow=H,e.scaleSqrt=U,e.scaleQuantile=z,e.scaleQuantize=J,e.scaleThreshold=Y,e.scaleTime=ee,e.scaleUtc=te,e.schemeCategory10=ne,e.schemeCategory20b=ie,e.schemeCategory20c=re,e.schemeCategory20=oe,e.interpolateCubehelixDefault=se,e.interpolateRainbow=de,e.interpolateWarm=le,e.interpolateCool=ce,e.interpolateViridis=ge,e.interpolateMagma=fe,e.interpolateInferno=he,e.interpolatePlasma=pe,e.scaleSequential=be,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(128),a(259),a(260),a(261),a(210),a(262),a(209))},207:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(69),i=a(2);t.default=function(e){void 0===e&&(e=new Set);var t=i.useState(e),a=t[0],r=t[1],o=i.useMemo((function(){return{add:function(e){return r((function(t){return new Set(n.__spreadArrays(Array.from(t),[e]))}))},remove:function(e){return r((function(t){return new Set(Array.from(t).filter((function(t){return t!==e})))}))},toggle:function(e){return r((function(t){return t.has(e)?new Set(Array.from(t).filter((function(t){return t!==e}))):new Set(n.__spreadArrays(Array.from(t),[e]))}))},reset:function(){return r(e)}}}),[r]),s=n.__assign({has:i.useCallback((function(e){return a.has(e)}),[a])},o);return[a,s]}},209:function(e,t,a){!function(e){"use strict";function t(e,t,a){e.prototype=t.prototype=a,a.constructor=e}function a(e,t){var a=Object.create(e.prototype);for(var n in t)a[n]=t[n];return a}function n(){}var i=.7,r=1/i,o="\\s*([+-]?\\d+)\\s*",s="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",l="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",c=/^#([0-9a-f]{3,8})$/,u=new RegExp("^rgb\\("+[o,o,o]+"\\)$"),d=new RegExp("^rgb\\("+[l,l,l]+"\\)$"),m=new RegExp("^rgba\\("+[o,o,o,s]+"\\)$"),g=new RegExp("^rgba\\("+[l,l,l,s]+"\\)$"),f=new RegExp("^hsl\\("+[s,l,l]+"\\)$"),h=new RegExp("^hsla\\("+[s,l,l,s]+"\\)$"),p={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function b(){return this.rgb().formatHex()}function y(){return k(this).formatHsl()}function E(){return this.rgb().formatRgb()}function v(e){var t,a;return e=(e+"").trim().toLowerCase(),(t=c.exec(e))?(a=t[1].length,t=parseInt(t[1],16),6===a?x(t):3===a?new T(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===a?_(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===a?_(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=u.exec(e))?new T(t[1],t[2],t[3],1):(t=d.exec(e))?new T(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=m.exec(e))?_(t[1],t[2],t[3],t[4]):(t=g.exec(e))?_(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=f.exec(e))?w(t[1],t[2]/100,t[3]/100,1):(t=h.exec(e))?w(t[1],t[2]/100,t[3]/100,t[4]):p.hasOwnProperty(e)?x(p[e]):"transparent"===e?new T(NaN,NaN,NaN,0):null}function x(e){return new T(e>>16&255,e>>8&255,255&e,1)}function _(e,t,a,n){return n<=0&&(e=t=a=NaN),new T(e,t,a,n)}function M(e){return e instanceof n||(e=v(e)),e?new T((e=e.rgb()).r,e.g,e.b,e.opacity):new T}function S(e,t,a,n){return 1===arguments.length?M(e):new T(e,t,a,null==n?1:n)}function T(e,t,a,n){this.r=+e,this.g=+t,this.b=+a,this.opacity=+n}function C(){return"#"+j(this.r)+j(this.g)+j(this.b)}function O(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function j(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function w(e,t,a,n){return n<=0?e=t=a=NaN:a<=0||a>=1?e=t=NaN:t<=0&&(e=NaN),new F(e,t,a,n)}function k(e){if(e instanceof F)return new F(e.h,e.s,e.l,e.opacity);if(e instanceof n||(e=v(e)),!e)return new F;if(e instanceof F)return e;var t=(e=e.rgb()).r/255,a=e.g/255,i=e.b/255,r=Math.min(t,a,i),o=Math.max(t,a,i),s=NaN,l=o-r,c=(o+r)/2;return l?(s=t===o?(a-i)/l+6*(a<i):a===o?(i-t)/l+2:(t-a)/l+4,l/=c<.5?o+r:2-o-r,s*=60):l=c>0&&c<1?0:s,new F(s,l,c,e.opacity)}function I(e,t,a,n){return 1===arguments.length?k(e):new F(e,t,a,null==n?1:n)}function F(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}function L(e,t,a){return 255*(e<60?t+(a-t)*e/60:e<180?a:e<240?t+(a-t)*(240-e)/60:t)}t(n,v,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:b,formatHex:b,formatHsl:y,formatRgb:E,toString:E}),t(T,S,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new T(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new T(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:C,formatHex:C,formatRgb:O,toString:O})),t(F,I,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new F(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new F(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,a=this.l,n=a+(a<.5?a:1-a)*t,i=2*a-n;return new T(L(e>=240?e-240:e+120,i,n),L(e,i,n),L(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}}));var D=Math.PI/180,P=180/Math.PI,R=18,N=.96422,A=1,H=.82521,U=4/29,z=6/29,J=3*z*z,Y=z*z*z;function B(e){if(e instanceof q)return new q(e.l,e.a,e.b,e.opacity);if(e instanceof te)return ae(e);e instanceof T||(e=M(e));var t,a,n=Z(e.r),i=Z(e.g),r=Z(e.b),o=W((.2225045*n+.7168786*i+.0606169*r)/A);return n===i&&i===r?t=a=o:(t=W((.4360747*n+.3850649*i+.1430804*r)/N),a=W((.0139322*n+.0971045*i+.7141733*r)/H)),new q(116*o-16,500*(t-o),200*(o-a),e.opacity)}function V(e,t){return new q(e,0,0,null==t?1:t)}function $(e,t,a,n){return 1===arguments.length?B(e):new q(e,t,a,null==n?1:n)}function q(e,t,a,n){this.l=+e,this.a=+t,this.b=+a,this.opacity=+n}function W(e){return e>Y?Math.pow(e,1/3):e/J+U}function G(e){return e>z?e*e*e:J*(e-U)}function Q(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Z(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function X(e){if(e instanceof te)return new te(e.h,e.c,e.l,e.opacity);if(e instanceof q||(e=B(e)),0===e.a&&0===e.b)return new te(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*P;return new te(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function K(e,t,a,n){return 1===arguments.length?X(e):new te(a,t,e,null==n?1:n)}function ee(e,t,a,n){return 1===arguments.length?X(e):new te(e,t,a,null==n?1:n)}function te(e,t,a,n){this.h=+e,this.c=+t,this.l=+a,this.opacity=+n}function ae(e){if(isNaN(e.h))return new q(e.l,0,0,e.opacity);var t=e.h*D;return new q(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}t(q,$,a(n,{brighter:function(e){return new q(this.l+R*(null==e?1:e),this.a,this.b,this.opacity)},darker:function(e){return new q(this.l-R*(null==e?1:e),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,a=isNaN(this.b)?e:e-this.b/200;return new T(Q(3.1338561*(t=N*G(t))-1.6168667*(e=A*G(e))-.4906146*(a=H*G(a))),Q(-.9787684*t+1.9161415*e+.033454*a),Q(.0719453*t-.2289914*e+1.4052427*a),this.opacity)}})),t(te,ee,a(n,{brighter:function(e){return new te(this.h,this.c,this.l+R*(null==e?1:e),this.opacity)},darker:function(e){return new te(this.h,this.c,this.l-R*(null==e?1:e),this.opacity)},rgb:function(){return ae(this).rgb()}}));var ne=-.14861,ie=1.78277,re=-.29227,oe=-.90649,se=1.97294,le=se*oe,ce=se*ie,ue=ie*re-oe*ne;function de(e){if(e instanceof ge)return new ge(e.h,e.s,e.l,e.opacity);e instanceof T||(e=M(e));var t=e.r/255,a=e.g/255,n=e.b/255,i=(ue*n+le*t-ce*a)/(ue+le-ce),r=n-i,o=(se*(a-i)-re*r)/oe,s=Math.sqrt(o*o+r*r)/(se*i*(1-i)),l=s?Math.atan2(o,r)*P-120:NaN;return new ge(l<0?l+360:l,s,i,e.opacity)}function me(e,t,a,n){return 1===arguments.length?de(e):new ge(e,t,a,null==n?1:n)}function ge(e,t,a,n){this.h=+e,this.s=+t,this.l=+a,this.opacity=+n}t(ge,me,a(n,{brighter:function(e){return e=null==e?r:Math.pow(r,e),new ge(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?i:Math.pow(i,e),new ge(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*D,t=+this.l,a=isNaN(this.s)?0:this.s*t*(1-t),n=Math.cos(e),i=Math.sin(e);return new T(255*(t+a*(ne*n+ie*i)),255*(t+a*(re*n+oe*i)),255*(t+a*(se*n)),this.opacity)}})),e.color=v,e.cubehelix=me,e.gray=V,e.hcl=ee,e.hsl=I,e.lab=$,e.lch=K,e.rgb=S,Object.defineProperty(e,"__esModule",{value:!0})}(t)},210:function(e,t,a){!function(e){"use strict";var t=new Date,a=new Date;function n(e,i,r,o){function s(t){return e(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=function(t){return e(t=new Date(+t)),t},s.ceil=function(t){return e(t=new Date(t-1)),i(t,1),e(t),t},s.round=function(e){var t=s(e),a=s.ceil(e);return e-t<a-e?t:a},s.offset=function(e,t){return i(e=new Date(+e),null==t?1:Math.floor(t)),e},s.range=function(t,a,n){var r,o=[];if(t=s.ceil(t),n=null==n?1:Math.floor(n),!(t<a&&n>0))return o;do{o.push(r=new Date(+t)),i(t,n),e(t)}while(r<t&&t<a);return o},s.filter=function(t){return n((function(a){if(a>=a)for(;e(a),!t(a);)a.setTime(a-1)}),(function(e,a){if(e>=e)if(a<0)for(;++a<=0;)for(;i(e,-1),!t(e););else for(;--a>=0;)for(;i(e,1),!t(e););}))},r&&(s.count=function(n,i){return t.setTime(+n),a.setTime(+i),e(t),e(a),Math.floor(r(t,a))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(o?function(t){return o(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var i=n((function(){}),(function(e,t){e.setTime(+e+t)}),(function(e,t){return t-e}));i.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?n((function(t){t.setTime(Math.floor(t/e)*e)}),(function(t,a){t.setTime(+t+a*e)}),(function(t,a){return(a-t)/e})):i:null};var r=i.range,o=1e3,s=6e4,l=36e5,c=864e5,u=6048e5,d=n((function(e){e.setTime(e-e.getMilliseconds())}),(function(e,t){e.setTime(+e+t*o)}),(function(e,t){return(t-e)/o}),(function(e){return e.getUTCSeconds()})),m=d.range,g=n((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getMinutes()})),f=g.range,h=n((function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*o-e.getMinutes()*s)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getHours()})),p=h.range,b=n((function(e){e.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/c}),(function(e){return e.getDate()-1})),y=b.range;function E(e){return n((function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)}),(function(e,t){e.setDate(e.getDate()+7*t)}),(function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*s)/u}))}var v=E(0),x=E(1),_=E(2),M=E(3),S=E(4),T=E(5),C=E(6),O=v.range,j=x.range,w=_.range,k=M.range,I=S.range,F=T.range,L=C.range,D=n((function(e){e.setDate(1),e.setHours(0,0,0,0)}),(function(e,t){e.setMonth(e.getMonth()+t)}),(function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())}),(function(e){return e.getMonth()})),P=D.range,R=n((function(e){e.setMonth(0,1),e.setHours(0,0,0,0)}),(function(e,t){e.setFullYear(e.getFullYear()+t)}),(function(e,t){return t.getFullYear()-e.getFullYear()}),(function(e){return e.getFullYear()}));R.every=function(e){return isFinite(e=Math.floor(e))&&e>0?n((function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)}),(function(t,a){t.setFullYear(t.getFullYear()+a*e)})):null};var N=R.range,A=n((function(e){e.setUTCSeconds(0,0)}),(function(e,t){e.setTime(+e+t*s)}),(function(e,t){return(t-e)/s}),(function(e){return e.getUTCMinutes()})),H=A.range,U=n((function(e){e.setUTCMinutes(0,0,0)}),(function(e,t){e.setTime(+e+t*l)}),(function(e,t){return(t-e)/l}),(function(e){return e.getUTCHours()})),z=U.range,J=n((function(e){e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+t)}),(function(e,t){return(t-e)/c}),(function(e){return e.getUTCDate()-1})),Y=J.range;function B(e){return n((function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCDate(e.getUTCDate()+7*t)}),(function(e,t){return(t-e)/u}))}var V=B(0),$=B(1),q=B(2),W=B(3),G=B(4),Q=B(5),Z=B(6),X=V.range,K=$.range,ee=q.range,te=W.range,ae=G.range,ne=Q.range,ie=Z.range,re=n((function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCMonth(e.getUTCMonth()+t)}),(function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())}),(function(e){return e.getUTCMonth()})),oe=re.range,se=n((function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),(function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)}),(function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()}),(function(e){return e.getUTCFullYear()}));se.every=function(e){return isFinite(e=Math.floor(e))&&e>0?n((function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),(function(t,a){t.setUTCFullYear(t.getUTCFullYear()+a*e)})):null};var le=se.range;e.timeDay=b,e.timeDays=y,e.timeFriday=T,e.timeFridays=F,e.timeHour=h,e.timeHours=p,e.timeInterval=n,e.timeMillisecond=i,e.timeMilliseconds=r,e.timeMinute=g,e.timeMinutes=f,e.timeMonday=x,e.timeMondays=j,e.timeMonth=D,e.timeMonths=P,e.timeSaturday=C,e.timeSaturdays=L,e.timeSecond=d,e.timeSeconds=m,e.timeSunday=v,e.timeSundays=O,e.timeThursday=S,e.timeThursdays=I,e.timeTuesday=_,e.timeTuesdays=w,e.timeWednesday=M,e.timeWednesdays=k,e.timeWeek=v,e.timeWeeks=O,e.timeYear=R,e.timeYears=N,e.utcDay=J,e.utcDays=Y,e.utcFriday=Q,e.utcFridays=ne,e.utcHour=U,e.utcHours=z,e.utcMillisecond=i,e.utcMilliseconds=r,e.utcMinute=A,e.utcMinutes=H,e.utcMonday=$,e.utcMondays=K,e.utcMonth=re,e.utcMonths=oe,e.utcSaturday=Z,e.utcSaturdays=ie,e.utcSecond=d,e.utcSeconds=m,e.utcSunday=V,e.utcSundays=X,e.utcThursday=G,e.utcThursdays=ae,e.utcTuesday=q,e.utcTuesdays=ee,e.utcWednesday=W,e.utcWednesdays=te,e.utcWeek=V,e.utcWeeks=X,e.utcYear=se,e.utcYears=le,Object.defineProperty(e,"__esModule",{value:!0})}(t)},248:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(69),i=a(249),r=n.__importDefault(a(251));t.default=function(e,t){r.default(e,t,i.isDeepEqual)}},249:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDeepEqual=t.off=t.on=t.isClient=void 0;var n=a(69).__importDefault(a(250));t.isClient="object"==typeof window,t.on=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.addEventListener.apply(e,t)},t.off=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return e.removeEventListener.apply(e,t)},t.isDeepEqual=n.default},250:function(e,t,a){"use strict";e.exports=function e(t,a){if(t===a)return!0;if(t&&a&&"object"==typeof t&&"object"==typeof a){if(t.constructor!==a.constructor)return!1;var n,i,r;if(Array.isArray(t)){if((n=t.length)!=a.length)return!1;for(i=n;0!=i--;)if(!e(t[i],a[i]))return!1;return!0}if(t.constructor===RegExp)return t.source===a.source&&t.flags===a.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===a.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===a.toString();if((n=(r=Object.keys(t)).length)!==Object.keys(a).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(a,r[i]))return!1;for(i=n;0!=i--;){var o=r[i];if(("_owner"!==o||!t.$$typeof)&&!e(t[o],a[o]))return!1}return!0}return t!=t&&a!=a}},251:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2);t.default=function(e,t,a){var i=n.useRef(void 0);i.current&&a(t,i.current)||(i.current=t),n.useEffect(e,i.current)}},259:function(e,t,a){!function(e){"use strict";var t="$";function a(){}function n(e,t){var n=new a;if(e instanceof a)e.each((function(e,t){n.set(t,e)}));else if(Array.isArray(e)){var i,r=-1,o=e.length;if(null==t)for(;++r<o;)n.set(r,e[r]);else for(;++r<o;)n.set(t(i=e[r],r,e),i)}else if(e)for(var s in e)n.set(s,e[s]);return n}function i(){var e,t,a,i=[],c=[];function u(a,r,o,s){if(r>=i.length)return null!=e&&a.sort(e),null!=t?t(a):a;for(var l,c,d,m=-1,g=a.length,f=i[r++],h=n(),p=o();++m<g;)(d=h.get(l=f(c=a[m])+""))?d.push(c):h.set(l,[c]);return h.each((function(e,t){s(p,t,u(e,r,o,s))})),p}function d(e,a){if(++a>i.length)return e;var n,r=c[a-1];return null!=t&&a>=i.length?n=e.entries():(n=[],e.each((function(e,t){n.push({key:t,values:d(e,a)})}))),null!=r?n.sort((function(e,t){return r(e.key,t.key)})):n}return a={object:function(e){return u(e,0,r,o)},map:function(e){return u(e,0,s,l)},entries:function(e){return d(u(e,0,s,l),0)},key:function(e){return i.push(e),a},sortKeys:function(e){return c[i.length-1]=e,a},sortValues:function(t){return e=t,a},rollup:function(e){return t=e,a}}}function r(){return{}}function o(e,t,a){e[t]=a}function s(){return n()}function l(e,t,a){e.set(t,a)}function c(){}a.prototype=n.prototype={constructor:a,has:function(e){return t+e in this},get:function(e){return this[t+e]},set:function(e,a){return this[t+e]=a,this},remove:function(e){var a=t+e;return a in this&&delete this[a]},clear:function(){for(var e in this)e[0]===t&&delete this[e]},keys:function(){var e=[];for(var a in this)a[0]===t&&e.push(a.slice(1));return e},values:function(){var e=[];for(var a in this)a[0]===t&&e.push(this[a]);return e},entries:function(){var e=[];for(var a in this)a[0]===t&&e.push({key:a.slice(1),value:this[a]});return e},size:function(){var e=0;for(var a in this)a[0]===t&&++e;return e},empty:function(){for(var e in this)if(e[0]===t)return!1;return!0},each:function(e){for(var a in this)a[0]===t&&e(this[a],a.slice(1),this)}};var u=n.prototype;function d(e,t){var a=new c;if(e instanceof c)e.each((function(e){a.add(e)}));else if(e){var n=-1,i=e.length;if(null==t)for(;++n<i;)a.add(e[n]);else for(;++n<i;)a.add(t(e[n],n,e))}return a}function m(e){var t=[];for(var a in e)t.push(a);return t}function g(e){var t=[];for(var a in e)t.push(e[a]);return t}function f(e){var t=[];for(var a in e)t.push({key:a,value:e[a]});return t}c.prototype=d.prototype={constructor:c,has:u.has,add:function(e){return this[t+(e+="")]=e,this},remove:u.remove,clear:u.clear,values:u.keys,size:u.size,empty:u.empty,each:u.each},e.nest=i,e.set=d,e.map=n,e.keys=m,e.values=g,e.entries=f,Object.defineProperty(e,"__esModule",{value:!0})}(t)},260:function(e,t,a){!function(e,t){"use strict";function a(e,t,a,n,i){var r=e*e,o=r*e;return((1-3*e+3*r-o)*t+(4-6*r+3*o)*a+(1+3*e+3*r-3*o)*n+o*i)/6}function n(e){var t=e.length-1;return function(n){var i=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),r=e[i],o=e[i+1],s=i>0?e[i-1]:2*r-o,l=i<t-1?e[i+2]:2*o-r;return a((n-i/t)*t,s,r,o,l)}}function i(e){var t=e.length;return function(n){var i=Math.floor(((n%=1)<0?++n:n)*t),r=e[(i+t-1)%t],o=e[i%t],s=e[(i+1)%t],l=e[(i+2)%t];return a((n-i/t)*t,r,o,s,l)}}function r(e){return function(){return e}}function o(e,t){return function(a){return e+a*t}}function s(e,t,a){return e=Math.pow(e,a),t=Math.pow(t,a)-e,a=1/a,function(n){return Math.pow(e+n*t,a)}}function l(e,t){var a=t-e;return a?o(e,a>180||a<-180?a-360*Math.round(a/360):a):r(isNaN(e)?t:e)}function c(e){return 1==(e=+e)?u:function(t,a){return a-t?s(t,a,e):r(isNaN(t)?a:t)}}function u(e,t){var a=t-e;return a?o(e,a):r(isNaN(e)?t:e)}var d=function e(a){var n=c(a);function i(e,a){var i=n((e=t.rgb(e)).r,(a=t.rgb(a)).r),r=n(e.g,a.g),o=n(e.b,a.b),s=u(e.opacity,a.opacity);return function(t){return e.r=i(t),e.g=r(t),e.b=o(t),e.opacity=s(t),e+""}}return i.gamma=e,i}(1);function m(e){return function(a){var n,i,r=a.length,o=new Array(r),s=new Array(r),l=new Array(r);for(n=0;n<r;++n)i=t.rgb(a[n]),o[n]=i.r||0,s[n]=i.g||0,l[n]=i.b||0;return o=e(o),s=e(s),l=e(l),i.opacity=1,function(e){return i.r=o(e),i.g=s(e),i.b=l(e),i+""}}}var g=m(n),f=m(i);function h(e,t){t||(t=[]);var a,n=e?Math.min(t.length,e.length):0,i=t.slice();return function(r){for(a=0;a<n;++a)i[a]=e[a]*(1-r)+t[a]*r;return i}}function p(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function b(e,t){return(p(t)?h:y)(e,t)}function y(e,t){var a,n=t?t.length:0,i=e?Math.min(n,e.length):0,r=new Array(i),o=new Array(n);for(a=0;a<i;++a)r[a]=O(e[a],t[a]);for(;a<n;++a)o[a]=t[a];return function(e){for(a=0;a<i;++a)o[a]=r[a](e);return o}}function E(e,t){var a=new Date;return e=+e,t=+t,function(n){return a.setTime(e*(1-n)+t*n),a}}function v(e,t){return e=+e,t=+t,function(a){return e*(1-a)+t*a}}function x(e,t){var a,n={},i={};for(a in null!==e&&"object"==typeof e||(e={}),null!==t&&"object"==typeof t||(t={}),t)a in e?n[a]=O(e[a],t[a]):i[a]=t[a];return function(e){for(a in n)i[a]=n[a](e);return i}}var _=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,M=new RegExp(_.source,"g");function S(e){return function(){return e}}function T(e){return function(t){return e(t)+""}}function C(e,t){var a,n,i,r=_.lastIndex=M.lastIndex=0,o=-1,s=[],l=[];for(e+="",t+="";(a=_.exec(e))&&(n=M.exec(t));)(i=n.index)>r&&(i=t.slice(r,i),s[o]?s[o]+=i:s[++o]=i),(a=a[0])===(n=n[0])?s[o]?s[o]+=n:s[++o]=n:(s[++o]=null,l.push({i:o,x:v(a,n)})),r=M.lastIndex;return r<t.length&&(i=t.slice(r),s[o]?s[o]+=i:s[++o]=i),s.length<2?l[0]?T(l[0].x):S(t):(t=l.length,function(e){for(var a,n=0;n<t;++n)s[(a=l[n]).i]=a.x(e);return s.join("")})}function O(e,a){var n,i=typeof a;return null==a||"boolean"===i?r(a):("number"===i?v:"string"===i?(n=t.color(a))?(a=n,d):C:a instanceof t.color?d:a instanceof Date?E:p(a)?h:Array.isArray(a)?y:"function"!=typeof a.valueOf&&"function"!=typeof a.toString||isNaN(a)?x:v)(e,a)}function j(e){var t=e.length;return function(a){return e[Math.max(0,Math.min(t-1,Math.floor(a*t)))]}}function w(e,t){var a=l(+e,+t);return function(e){var t=a(e);return t-360*Math.floor(t/360)}}function k(e,t){return e=+e,t=+t,function(a){return Math.round(e*(1-a)+t*a)}}var I,F,L,D,P=180/Math.PI,R={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function N(e,t,a,n,i,r){var o,s,l;return(o=Math.sqrt(e*e+t*t))&&(e/=o,t/=o),(l=e*a+t*n)&&(a-=e*l,n-=t*l),(s=Math.sqrt(a*a+n*n))&&(a/=s,n/=s,l/=s),e*n<t*a&&(e=-e,t=-t,l=-l,o=-o),{translateX:i,translateY:r,rotate:Math.atan2(t,e)*P,skewX:Math.atan(l)*P,scaleX:o,scaleY:s}}function A(e){return"none"===e?R:(I||(I=document.createElement("DIV"),F=document.documentElement,L=document.defaultView),I.style.transform=e,e=L.getComputedStyle(F.appendChild(I),null).getPropertyValue("transform"),F.removeChild(I),N(+(e=e.slice(7,-1).split(","))[0],+e[1],+e[2],+e[3],+e[4],+e[5]))}function H(e){return null==e?R:(D||(D=document.createElementNS("http://www.w3.org/2000/svg","g")),D.setAttribute("transform",e),(e=D.transform.baseVal.consolidate())?N((e=e.matrix).a,e.b,e.c,e.d,e.e,e.f):R)}function U(e,t,a,n){function i(e){return e.length?e.pop()+" ":""}function r(e,n,i,r,o,s){if(e!==i||n!==r){var l=o.push("translate(",null,t,null,a);s.push({i:l-4,x:v(e,i)},{i:l-2,x:v(n,r)})}else(i||r)&&o.push("translate("+i+t+r+a)}function o(e,t,a,r){e!==t?(e-t>180?t+=360:t-e>180&&(e+=360),r.push({i:a.push(i(a)+"rotate(",null,n)-2,x:v(e,t)})):t&&a.push(i(a)+"rotate("+t+n)}function s(e,t,a,r){e!==t?r.push({i:a.push(i(a)+"skewX(",null,n)-2,x:v(e,t)}):t&&a.push(i(a)+"skewX("+t+n)}function l(e,t,a,n,r,o){if(e!==a||t!==n){var s=r.push(i(r)+"scale(",null,",",null,")");o.push({i:s-4,x:v(e,a)},{i:s-2,x:v(t,n)})}else 1===a&&1===n||r.push(i(r)+"scale("+a+","+n+")")}return function(t,a){var n=[],i=[];return t=e(t),a=e(a),r(t.translateX,t.translateY,a.translateX,a.translateY,n,i),o(t.rotate,a.rotate,n,i),s(t.skewX,a.skewX,n,i),l(t.scaleX,t.scaleY,a.scaleX,a.scaleY,n,i),t=a=null,function(e){for(var t,a=-1,r=i.length;++a<r;)n[(t=i[a]).i]=t.x(e);return n.join("")}}}var z=U(A,"px, ","px)","deg)"),J=U(H,", ",")",")"),Y=Math.SQRT2,B=2,V=4,$=1e-12;function q(e){return((e=Math.exp(e))+1/e)/2}function W(e){return((e=Math.exp(e))-1/e)/2}function G(e){return((e=Math.exp(2*e))-1)/(e+1)}function Q(e,t){var a,n,i=e[0],r=e[1],o=e[2],s=t[0],l=t[1],c=t[2],u=s-i,d=l-r,m=u*u+d*d;if(m<$)n=Math.log(c/o)/Y,a=function(e){return[i+e*u,r+e*d,o*Math.exp(Y*e*n)]};else{var g=Math.sqrt(m),f=(c*c-o*o+V*m)/(2*o*B*g),h=(c*c-o*o-V*m)/(2*c*B*g),p=Math.log(Math.sqrt(f*f+1)-f),b=Math.log(Math.sqrt(h*h+1)-h);n=(b-p)/Y,a=function(e){var t=e*n,a=q(p),s=o/(B*g)*(a*G(Y*t+p)-W(p));return[i+s*u,r+s*d,o*a/q(Y*t+p)]}}return a.duration=1e3*n,a}function Z(e){return function(a,n){var i=e((a=t.hsl(a)).h,(n=t.hsl(n)).h),r=u(a.s,n.s),o=u(a.l,n.l),s=u(a.opacity,n.opacity);return function(e){return a.h=i(e),a.s=r(e),a.l=o(e),a.opacity=s(e),a+""}}}var X=Z(l),K=Z(u);function ee(e,a){var n=u((e=t.lab(e)).l,(a=t.lab(a)).l),i=u(e.a,a.a),r=u(e.b,a.b),o=u(e.opacity,a.opacity);return function(t){return e.l=n(t),e.a=i(t),e.b=r(t),e.opacity=o(t),e+""}}function te(e){return function(a,n){var i=e((a=t.hcl(a)).h,(n=t.hcl(n)).h),r=u(a.c,n.c),o=u(a.l,n.l),s=u(a.opacity,n.opacity);return function(e){return a.h=i(e),a.c=r(e),a.l=o(e),a.opacity=s(e),a+""}}}var ae=te(l),ne=te(u);function ie(e){return function a(n){function i(a,i){var r=e((a=t.cubehelix(a)).h,(i=t.cubehelix(i)).h),o=u(a.s,i.s),s=u(a.l,i.l),l=u(a.opacity,i.opacity);return function(e){return a.h=r(e),a.s=o(e),a.l=s(Math.pow(e,n)),a.opacity=l(e),a+""}}return n=+n,i.gamma=a,i}(1)}var re=ie(l),oe=ie(u);function se(e,t){for(var a=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);a<n;)r[a]=e(i,i=t[++a]);return function(e){var t=Math.max(0,Math.min(n-1,Math.floor(e*=n)));return r[t](e-t)}}function le(e,t){for(var a=new Array(t),n=0;n<t;++n)a[n]=e(n/(t-1));return a}e.interpolate=O,e.interpolateArray=b,e.interpolateBasis=n,e.interpolateBasisClosed=i,e.interpolateCubehelix=re,e.interpolateCubehelixLong=oe,e.interpolateDate=E,e.interpolateDiscrete=j,e.interpolateHcl=ae,e.interpolateHclLong=ne,e.interpolateHsl=X,e.interpolateHslLong=K,e.interpolateHue=w,e.interpolateLab=ee,e.interpolateNumber=v,e.interpolateNumberArray=h,e.interpolateObject=x,e.interpolateRgb=d,e.interpolateRgbBasis=g,e.interpolateRgbBasisClosed=f,e.interpolateRound=k,e.interpolateString=C,e.interpolateTransformCss=z,e.interpolateTransformSvg=J,e.interpolateZoom=Q,e.piecewise=se,e.quantize=le,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(209))},261:function(e,t,a){!function(e){"use strict";function t(e,t){if((a=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var a,n=e.slice(0,a);return[n.length>1?n[0]+n.slice(2):n,+e.slice(a+1)]}function a(e){return(e=t(Math.abs(e)))?e[1]:NaN}function n(e,t){return function(a,n){for(var i=a.length,r=[],o=0,s=e[0],l=0;i>0&&s>0&&(l+s+1>n&&(s=Math.max(1,n-l)),r.push(a.substring(i-=s,i+s)),!((l+=s+1)>n));)s=e[o=(o+1)%e.length];return r.reverse().join(t)}}function i(e){return function(t){return t.replace(/[0-9]/g,(function(t){return e[+t]}))}}var r,o=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function s(e){if(!(t=o.exec(e)))throw new Error("invalid format: "+e);var t;return new l({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}function l(e){this.fill=void 0===e.fill?" ":e.fill+"",this.align=void 0===e.align?">":e.align+"",this.sign=void 0===e.sign?"-":e.sign+"",this.symbol=void 0===e.symbol?"":e.symbol+"",this.zero=!!e.zero,this.width=void 0===e.width?void 0:+e.width,this.comma=!!e.comma,this.precision=void 0===e.precision?void 0:+e.precision,this.trim=!!e.trim,this.type=void 0===e.type?"":e.type+""}function c(e){e:for(var t,a=e.length,n=1,i=-1;n<a;++n)switch(e[n]){case".":i=t=n;break;case"0":0===i&&(i=n),t=n;break;default:if(!+e[n])break e;i>0&&(i=0)}return i>0?e.slice(0,i)+e.slice(t+1):e}function u(e,a){var n=t(e,a);if(!n)return e+"";var i=n[0],o=n[1],s=o-(r=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,l=i.length;return s===l?i:s>l?i+new Array(s-l+1).join("0"):s>0?i.slice(0,s)+"."+i.slice(s):"0."+new Array(1-s).join("0")+t(e,Math.max(0,a+s-1))[0]}function d(e,a){var n=t(e,a);if(!n)return e+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}s.prototype=l.prototype,l.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var m={"%":function(e,t){return(100*e).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:function(e){return Math.round(e).toString(10)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return d(100*e,t)},r:d,s:u,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function g(e){return e}var f,h=Array.prototype.map,p=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function b(e){var t=void 0===e.grouping||void 0===e.thousands?g:n(h.call(e.grouping,Number),e.thousands+""),o=void 0===e.currency?"":e.currency[0]+"",l=void 0===e.currency?"":e.currency[1]+"",u=void 0===e.decimal?".":e.decimal+"",d=void 0===e.numerals?g:i(h.call(e.numerals,String)),f=void 0===e.percent?"%":e.percent+"",b=void 0===e.minus?"-":e.minus+"",y=void 0===e.nan?"NaN":e.nan+"";function E(e){var a=(e=s(e)).fill,n=e.align,i=e.sign,g=e.symbol,h=e.zero,E=e.width,v=e.comma,x=e.precision,_=e.trim,M=e.type;"n"===M?(v=!0,M="g"):m[M]||(void 0===x&&(x=12),_=!0,M="g"),(h||"0"===a&&"="===n)&&(h=!0,a="0",n="=");var S="$"===g?o:"#"===g&&/[boxX]/.test(M)?"0"+M.toLowerCase():"",T="$"===g?l:/[%p]/.test(M)?f:"",C=m[M],O=/[defgprs%]/.test(M);function j(e){var o,s,l,m=S,g=T;if("c"===M)g=C(e)+g,e="";else{var f=(e=+e)<0||1/e<0;if(e=isNaN(e)?y:C(Math.abs(e),x),_&&(e=c(e)),f&&0==+e&&"+"!==i&&(f=!1),m=(f?"("===i?i:b:"-"===i||"("===i?"":i)+m,g=("s"===M?p[8+r/3]:"")+g+(f&&"("===i?")":""),O)for(o=-1,s=e.length;++o<s;)if(48>(l=e.charCodeAt(o))||l>57){g=(46===l?u+e.slice(o+1):e.slice(o))+g,e=e.slice(0,o);break}}v&&!h&&(e=t(e,1/0));var j=m.length+e.length+g.length,w=j<E?new Array(E-j+1).join(a):"";switch(v&&h&&(e=t(w+e,w.length?E-g.length:1/0),w=""),n){case"<":e=m+e+g+w;break;case"=":e=m+w+e+g;break;case"^":e=w.slice(0,j=w.length>>1)+m+e+g+w.slice(j);break;default:e=w+m+e+g}return d(e)}return x=void 0===x?6:/[gprs]/.test(M)?Math.max(1,Math.min(21,x)):Math.max(0,Math.min(20,x)),j.toString=function(){return e+""},j}function v(e,t){var n=E(((e=s(e)).type="f",e)),i=3*Math.max(-8,Math.min(8,Math.floor(a(t)/3))),r=Math.pow(10,-i),o=p[8+i/3];return function(e){return n(r*e)+o}}return{format:E,formatPrefix:v}}function y(t){return f=b(t),e.format=f.format,e.formatPrefix=f.formatPrefix,f}function E(e){return Math.max(0,-a(Math.abs(e)))}function v(e,t){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(a(t)/3)))-a(Math.abs(e)))}function x(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,a(t)-a(e))+1}y({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"}),e.FormatSpecifier=l,e.formatDefaultLocale=y,e.formatLocale=b,e.formatSpecifier=s,e.precisionFixed=E,e.precisionPrefix=v,e.precisionRound=x,Object.defineProperty(e,"__esModule",{value:!0})}(t)},262:function(e,t,a){!function(e,t){"use strict";function a(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function n(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function i(e,t,a){return{y:e,m:t,d:a,H:0,M:0,S:0,L:0}}function r(e){var r=e.dateTime,o=e.date,l=e.time,c=e.periods,u=e.days,d=e.shortDays,m=e.months,ye=e.shortMonths,Ee=g(c),ve=f(c),xe=g(u),_e=f(u),Me=g(d),Se=f(d),Te=g(m),Ce=f(m),Oe=g(ye),je=f(ye),we={a:Ye,A:Be,b:Ve,B:$e,c:null,d:P,e:P,f:U,H:R,I:N,j:A,L:H,m:z,M:J,p:qe,q:We,Q:pe,s:be,S:Y,u:B,U:V,V:$,w:q,W:W,x:null,X:null,y:G,Y:Q,Z:Z,"%":he},ke={a:Ge,A:Qe,b:Ze,B:Xe,c:null,d:X,e:X,f:ne,H:K,I:ee,j:te,L:ae,m:ie,M:re,p:Ke,q:et,Q:pe,s:be,S:oe,u:se,U:le,V:ce,w:ue,W:de,x:null,X:null,y:me,Y:ge,Z:fe,"%":he},Ie={a:Re,A:Ne,b:Ae,B:He,c:Ue,d:T,e:T,f:I,H:O,I:O,j:C,L:k,m:S,M:j,p:Pe,q:M,Q:L,s:D,S:w,u:p,U:b,V:y,w:h,W:E,x:ze,X:Je,y:x,Y:v,Z:_,"%":F};function Fe(e,t){return function(a){var n,i,r,o=[],l=-1,c=0,u=e.length;for(a instanceof Date||(a=new Date(+a));++l<u;)37===e.charCodeAt(l)&&(o.push(e.slice(c,l)),null!=(i=s[n=e.charAt(++l)])?n=e.charAt(++l):i="e"===n?" ":"0",(r=t[n])&&(n=r(a,i)),o.push(n),c=l+1);return o.push(e.slice(c,l)),o.join("")}}function Le(e,r){return function(o){var s,l,c=i(1900,void 0,1);if(De(c,e,o+="",0)!=o.length)return null;if("Q"in c)return new Date(c.Q);if("s"in c)return new Date(1e3*c.s+("L"in c?c.L:0));if(r&&!("Z"in c)&&(c.Z=0),"p"in c&&(c.H=c.H%12+12*c.p),void 0===c.m&&(c.m="q"in c?c.q:0),"V"in c){if(c.V<1||c.V>53)return null;"w"in c||(c.w=1),"Z"in c?(l=(s=n(i(c.y,0,1))).getUTCDay(),s=l>4||0===l?t.utcMonday.ceil(s):t.utcMonday(s),s=t.utcDay.offset(s,7*(c.V-1)),c.y=s.getUTCFullYear(),c.m=s.getUTCMonth(),c.d=s.getUTCDate()+(c.w+6)%7):(l=(s=a(i(c.y,0,1))).getDay(),s=l>4||0===l?t.timeMonday.ceil(s):t.timeMonday(s),s=t.timeDay.offset(s,7*(c.V-1)),c.y=s.getFullYear(),c.m=s.getMonth(),c.d=s.getDate()+(c.w+6)%7)}else("W"in c||"U"in c)&&("w"in c||(c.w="u"in c?c.u%7:"W"in c?1:0),l="Z"in c?n(i(c.y,0,1)).getUTCDay():a(i(c.y,0,1)).getDay(),c.m=0,c.d="W"in c?(c.w+6)%7+7*c.W-(l+5)%7:c.w+7*c.U-(l+6)%7);return"Z"in c?(c.H+=c.Z/100|0,c.M+=c.Z%100,n(c)):a(c)}}function De(e,t,a,n){for(var i,r,o=0,l=t.length,c=a.length;o<l;){if(n>=c)return-1;if(37===(i=t.charCodeAt(o++))){if(i=t.charAt(o++),!(r=Ie[i in s?t.charAt(o++):i])||(n=r(e,a,n))<0)return-1}else if(i!=a.charCodeAt(n++))return-1}return n}function Pe(e,t,a){var n=Ee.exec(t.slice(a));return n?(e.p=ve[n[0].toLowerCase()],a+n[0].length):-1}function Re(e,t,a){var n=Me.exec(t.slice(a));return n?(e.w=Se[n[0].toLowerCase()],a+n[0].length):-1}function Ne(e,t,a){var n=xe.exec(t.slice(a));return n?(e.w=_e[n[0].toLowerCase()],a+n[0].length):-1}function Ae(e,t,a){var n=Oe.exec(t.slice(a));return n?(e.m=je[n[0].toLowerCase()],a+n[0].length):-1}function He(e,t,a){var n=Te.exec(t.slice(a));return n?(e.m=Ce[n[0].toLowerCase()],a+n[0].length):-1}function Ue(e,t,a){return De(e,r,t,a)}function ze(e,t,a){return De(e,o,t,a)}function Je(e,t,a){return De(e,l,t,a)}function Ye(e){return d[e.getDay()]}function Be(e){return u[e.getDay()]}function Ve(e){return ye[e.getMonth()]}function $e(e){return m[e.getMonth()]}function qe(e){return c[+(e.getHours()>=12)]}function We(e){return 1+~~(e.getMonth()/3)}function Ge(e){return d[e.getUTCDay()]}function Qe(e){return u[e.getUTCDay()]}function Ze(e){return ye[e.getUTCMonth()]}function Xe(e){return m[e.getUTCMonth()]}function Ke(e){return c[+(e.getUTCHours()>=12)]}function et(e){return 1+~~(e.getUTCMonth()/3)}return we.x=Fe(o,we),we.X=Fe(l,we),we.c=Fe(r,we),ke.x=Fe(o,ke),ke.X=Fe(l,ke),ke.c=Fe(r,ke),{format:function(e){var t=Fe(e+="",we);return t.toString=function(){return e},t},parse:function(e){var t=Le(e+="",!1);return t.toString=function(){return e},t},utcFormat:function(e){var t=Fe(e+="",ke);return t.toString=function(){return e},t},utcParse:function(e){var t=Le(e+="",!0);return t.toString=function(){return e},t}}}var o,s={"-":"",_:" ",0:"0"},l=/^\s*\d+/,c=/^%/,u=/[\\^$*+?|[\]().{}]/g;function d(e,t,a){var n=e<0?"-":"",i=(n?-e:e)+"",r=i.length;return n+(r<a?new Array(a-r+1).join(t)+i:i)}function m(e){return e.replace(u,"\\$&")}function g(e){return new RegExp("^(?:"+e.map(m).join("|")+")","i")}function f(e){for(var t={},a=-1,n=e.length;++a<n;)t[e[a].toLowerCase()]=a;return t}function h(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.w=+n[0],a+n[0].length):-1}function p(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.u=+n[0],a+n[0].length):-1}function b(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.U=+n[0],a+n[0].length):-1}function y(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.V=+n[0],a+n[0].length):-1}function E(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.W=+n[0],a+n[0].length):-1}function v(e,t,a){var n=l.exec(t.slice(a,a+4));return n?(e.y=+n[0],a+n[0].length):-1}function x(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),a+n[0].length):-1}function _(e,t,a){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(a,a+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),a+n[0].length):-1}function M(e,t,a){var n=l.exec(t.slice(a,a+1));return n?(e.q=3*n[0]-3,a+n[0].length):-1}function S(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.m=n[0]-1,a+n[0].length):-1}function T(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.d=+n[0],a+n[0].length):-1}function C(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.m=0,e.d=+n[0],a+n[0].length):-1}function O(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.H=+n[0],a+n[0].length):-1}function j(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.M=+n[0],a+n[0].length):-1}function w(e,t,a){var n=l.exec(t.slice(a,a+2));return n?(e.S=+n[0],a+n[0].length):-1}function k(e,t,a){var n=l.exec(t.slice(a,a+3));return n?(e.L=+n[0],a+n[0].length):-1}function I(e,t,a){var n=l.exec(t.slice(a,a+6));return n?(e.L=Math.floor(n[0]/1e3),a+n[0].length):-1}function F(e,t,a){var n=c.exec(t.slice(a,a+1));return n?a+n[0].length:-1}function L(e,t,a){var n=l.exec(t.slice(a));return n?(e.Q=+n[0],a+n[0].length):-1}function D(e,t,a){var n=l.exec(t.slice(a));return n?(e.s=+n[0],a+n[0].length):-1}function P(e,t){return d(e.getDate(),t,2)}function R(e,t){return d(e.getHours(),t,2)}function N(e,t){return d(e.getHours()%12||12,t,2)}function A(e,a){return d(1+t.timeDay.count(t.timeYear(e),e),a,3)}function H(e,t){return d(e.getMilliseconds(),t,3)}function U(e,t){return H(e,t)+"000"}function z(e,t){return d(e.getMonth()+1,t,2)}function J(e,t){return d(e.getMinutes(),t,2)}function Y(e,t){return d(e.getSeconds(),t,2)}function B(e){var t=e.getDay();return 0===t?7:t}function V(e,a){return d(t.timeSunday.count(t.timeYear(e)-1,e),a,2)}function $(e,a){var n=e.getDay();return e=n>=4||0===n?t.timeThursday(e):t.timeThursday.ceil(e),d(t.timeThursday.count(t.timeYear(e),e)+(4===t.timeYear(e).getDay()),a,2)}function q(e){return e.getDay()}function W(e,a){return d(t.timeMonday.count(t.timeYear(e)-1,e),a,2)}function G(e,t){return d(e.getFullYear()%100,t,2)}function Q(e,t){return d(e.getFullYear()%1e4,t,4)}function Z(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+d(t/60|0,"0",2)+d(t%60,"0",2)}function X(e,t){return d(e.getUTCDate(),t,2)}function K(e,t){return d(e.getUTCHours(),t,2)}function ee(e,t){return d(e.getUTCHours()%12||12,t,2)}function te(e,a){return d(1+t.utcDay.count(t.utcYear(e),e),a,3)}function ae(e,t){return d(e.getUTCMilliseconds(),t,3)}function ne(e,t){return ae(e,t)+"000"}function ie(e,t){return d(e.getUTCMonth()+1,t,2)}function re(e,t){return d(e.getUTCMinutes(),t,2)}function oe(e,t){return d(e.getUTCSeconds(),t,2)}function se(e){var t=e.getUTCDay();return 0===t?7:t}function le(e,a){return d(t.utcSunday.count(t.utcYear(e)-1,e),a,2)}function ce(e,a){var n=e.getUTCDay();return e=n>=4||0===n?t.utcThursday(e):t.utcThursday.ceil(e),d(t.utcThursday.count(t.utcYear(e),e)+(4===t.utcYear(e).getUTCDay()),a,2)}function ue(e){return e.getUTCDay()}function de(e,a){return d(t.utcMonday.count(t.utcYear(e)-1,e),a,2)}function me(e,t){return d(e.getUTCFullYear()%100,t,2)}function ge(e,t){return d(e.getUTCFullYear()%1e4,t,4)}function fe(){return"+0000"}function he(){return"%"}function pe(e){return+e}function be(e){return Math.floor(+e/1e3)}function ye(t){return o=r(t),e.timeFormat=o.format,e.timeParse=o.parse,e.utcFormat=o.utcFormat,e.utcParse=o.utcParse,o}ye({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var Ee="%Y-%m-%dT%H:%M:%S.%LZ";function ve(e){return e.toISOString()}var xe=Date.prototype.toISOString?ve:e.utcFormat(Ee);function _e(e){var t=new Date(e);return isNaN(t)?null:t}var Me=+new Date("2000-01-01T00:00:00.000Z")?_e:e.utcParse(Ee);e.isoFormat=xe,e.isoParse=Me,e.timeFormatDefaultLocale=ye,e.timeFormatLocale=r,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(210))},263:function(e,t,a){!function(e,t){"use strict";function a(e){return function(){return e}}var n=Math.abs,i=Math.atan2,r=Math.cos,o=Math.max,s=Math.min,l=Math.sin,c=Math.sqrt,u=1e-12,d=Math.PI,m=d/2,g=2*d;function f(e){return e>1?0:e<-1?d:Math.acos(e)}function h(e){return e>=1?m:e<=-1?-m:Math.asin(e)}function p(e){return e.innerRadius}function b(e){return e.outerRadius}function y(e){return e.startAngle}function E(e){return e.endAngle}function v(e){return e&&e.padAngle}function x(e,t,a,n,i,r,o,s){var l=a-e,c=n-t,d=o-i,m=s-r,g=m*l-d*c;if(!(g*g<u))return[e+(g=(d*(t-r)-m*(e-i))/g)*l,t+g*c]}function _(e,t,a,n,i,r,s){var l=e-a,u=t-n,d=(s?r:-r)/c(l*l+u*u),m=d*u,g=-d*l,f=e+m,h=t+g,p=a+m,b=n+g,y=(f+p)/2,E=(h+b)/2,v=p-f,x=b-h,_=v*v+x*x,M=i-r,S=f*b-p*h,T=(x<0?-1:1)*c(o(0,M*M*_-S*S)),C=(S*x-v*T)/_,O=(-S*v-x*T)/_,j=(S*x+v*T)/_,w=(-S*v+x*T)/_,k=C-y,I=O-E,F=j-y,L=w-E;return k*k+I*I>F*F+L*L&&(C=j,O=w),{cx:C,cy:O,x01:-m,y01:-g,x11:C*(i/M-1),y11:O*(i/M-1)}}function M(){var e=p,o=b,M=a(0),S=null,T=y,C=E,O=v,j=null;function w(){var a,p,b=+e.apply(this,arguments),y=+o.apply(this,arguments),E=T.apply(this,arguments)-m,v=C.apply(this,arguments)-m,w=n(v-E),k=v>E;if(j||(j=a=t.path()),y<b&&(p=y,y=b,b=p),y>u)if(w>g-u)j.moveTo(y*r(E),y*l(E)),j.arc(0,0,y,E,v,!k),b>u&&(j.moveTo(b*r(v),b*l(v)),j.arc(0,0,b,v,E,k));else{var I,F,L=E,D=v,P=E,R=v,N=w,A=w,H=O.apply(this,arguments)/2,U=H>u&&(S?+S.apply(this,arguments):c(b*b+y*y)),z=s(n(y-b)/2,+M.apply(this,arguments)),J=z,Y=z;if(U>u){var B=h(U/b*l(H)),V=h(U/y*l(H));(N-=2*B)>u?(P+=B*=k?1:-1,R-=B):(N=0,P=R=(E+v)/2),(A-=2*V)>u?(L+=V*=k?1:-1,D-=V):(A=0,L=D=(E+v)/2)}var $=y*r(L),q=y*l(L),W=b*r(R),G=b*l(R);if(z>u){var Q,Z=y*r(D),X=y*l(D),K=b*r(P),ee=b*l(P);if(w<d&&(Q=x($,q,K,ee,Z,X,W,G))){var te=$-Q[0],ae=q-Q[1],ne=Z-Q[0],ie=X-Q[1],re=1/l(f((te*ne+ae*ie)/(c(te*te+ae*ae)*c(ne*ne+ie*ie)))/2),oe=c(Q[0]*Q[0]+Q[1]*Q[1]);J=s(z,(b-oe)/(re-1)),Y=s(z,(y-oe)/(re+1))}}A>u?Y>u?(I=_(K,ee,$,q,y,Y,k),F=_(Z,X,W,G,y,Y,k),j.moveTo(I.cx+I.x01,I.cy+I.y01),Y<z?j.arc(I.cx,I.cy,Y,i(I.y01,I.x01),i(F.y01,F.x01),!k):(j.arc(I.cx,I.cy,Y,i(I.y01,I.x01),i(I.y11,I.x11),!k),j.arc(0,0,y,i(I.cy+I.y11,I.cx+I.x11),i(F.cy+F.y11,F.cx+F.x11),!k),j.arc(F.cx,F.cy,Y,i(F.y11,F.x11),i(F.y01,F.x01),!k))):(j.moveTo($,q),j.arc(0,0,y,L,D,!k)):j.moveTo($,q),b>u&&N>u?J>u?(I=_(W,G,Z,X,b,-J,k),F=_($,q,K,ee,b,-J,k),j.lineTo(I.cx+I.x01,I.cy+I.y01),J<z?j.arc(I.cx,I.cy,J,i(I.y01,I.x01),i(F.y01,F.x01),!k):(j.arc(I.cx,I.cy,J,i(I.y01,I.x01),i(I.y11,I.x11),!k),j.arc(0,0,b,i(I.cy+I.y11,I.cx+I.x11),i(F.cy+F.y11,F.cx+F.x11),k),j.arc(F.cx,F.cy,J,i(F.y11,F.x11),i(F.y01,F.x01),!k))):j.arc(0,0,b,R,P,k):j.lineTo(W,G)}else j.moveTo(0,0);if(j.closePath(),a)return j=null,a+""||null}return w.centroid=function(){var t=(+e.apply(this,arguments)+ +o.apply(this,arguments))/2,a=(+T.apply(this,arguments)+ +C.apply(this,arguments))/2-d/2;return[r(a)*t,l(a)*t]},w.innerRadius=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),w):e},w.outerRadius=function(e){return arguments.length?(o="function"==typeof e?e:a(+e),w):o},w.cornerRadius=function(e){return arguments.length?(M="function"==typeof e?e:a(+e),w):M},w.padRadius=function(e){return arguments.length?(S=null==e?null:"function"==typeof e?e:a(+e),w):S},w.startAngle=function(e){return arguments.length?(T="function"==typeof e?e:a(+e),w):T},w.endAngle=function(e){return arguments.length?(C="function"==typeof e?e:a(+e),w):C},w.padAngle=function(e){return arguments.length?(O="function"==typeof e?e:a(+e),w):O},w.context=function(e){return arguments.length?(j=null==e?null:e,w):j},w}function S(e){this._context=e}function T(e){return new S(e)}function C(e){return e[0]}function O(e){return e[1]}function j(){var e=C,n=O,i=a(!0),r=null,o=T,s=null;function l(a){var l,c,u,d=a.length,m=!1;for(null==r&&(s=o(u=t.path())),l=0;l<=d;++l)!(l<d&&i(c=a[l],l,a))===m&&((m=!m)?s.lineStart():s.lineEnd()),m&&s.point(+e(c,l,a),+n(c,l,a));if(u)return s=null,u+""||null}return l.x=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),l):e},l.y=function(e){return arguments.length?(n="function"==typeof e?e:a(+e),l):n},l.defined=function(e){return arguments.length?(i="function"==typeof e?e:a(!!e),l):i},l.curve=function(e){return arguments.length?(o=e,null!=r&&(s=o(r)),l):o},l.context=function(e){return arguments.length?(null==e?r=s=null:s=o(r=e),l):r},l}function w(){var e=C,n=null,i=a(0),r=O,o=a(!0),s=null,l=T,c=null;function u(a){var u,d,m,g,f,h=a.length,p=!1,b=new Array(h),y=new Array(h);for(null==s&&(c=l(f=t.path())),u=0;u<=h;++u){if(!(u<h&&o(g=a[u],u,a))===p)if(p=!p)d=u,c.areaStart(),c.lineStart();else{for(c.lineEnd(),c.lineStart(),m=u-1;m>=d;--m)c.point(b[m],y[m]);c.lineEnd(),c.areaEnd()}p&&(b[u]=+e(g,u,a),y[u]=+i(g,u,a),c.point(n?+n(g,u,a):b[u],r?+r(g,u,a):y[u]))}if(f)return c=null,f+""||null}function d(){return j().defined(o).curve(l).context(s)}return u.x=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),n=null,u):e},u.x0=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),u):e},u.x1=function(e){return arguments.length?(n=null==e?null:"function"==typeof e?e:a(+e),u):n},u.y=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),r=null,u):i},u.y0=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),u):i},u.y1=function(e){return arguments.length?(r=null==e?null:"function"==typeof e?e:a(+e),u):r},u.lineX0=u.lineY0=function(){return d().x(e).y(i)},u.lineY1=function(){return d().x(e).y(r)},u.lineX1=function(){return d().x(n).y(i)},u.defined=function(e){return arguments.length?(o="function"==typeof e?e:a(!!e),u):o},u.curve=function(e){return arguments.length?(l=e,null!=s&&(c=l(s)),u):l},u.context=function(e){return arguments.length?(null==e?s=c=null:c=l(s=e),u):s},u}function k(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function I(e){return e}function F(){var e=I,t=k,n=null,i=a(0),r=a(g),o=a(0);function s(a){var s,l,c,u,d,m=a.length,f=0,h=new Array(m),p=new Array(m),b=+i.apply(this,arguments),y=Math.min(g,Math.max(-g,r.apply(this,arguments)-b)),E=Math.min(Math.abs(y)/m,o.apply(this,arguments)),v=E*(y<0?-1:1);for(s=0;s<m;++s)(d=p[h[s]=s]=+e(a[s],s,a))>0&&(f+=d);for(null!=t?h.sort((function(e,a){return t(p[e],p[a])})):null!=n&&h.sort((function(e,t){return n(a[e],a[t])})),s=0,c=f?(y-m*v)/f:0;s<m;++s,b=u)l=h[s],u=b+((d=p[l])>0?d*c:0)+v,p[l]={data:a[l],index:s,value:d,startAngle:b,endAngle:u,padAngle:E};return p}return s.value=function(t){return arguments.length?(e="function"==typeof t?t:a(+t),s):e},s.sortValues=function(e){return arguments.length?(t=e,n=null,s):t},s.sort=function(e){return arguments.length?(n=e,t=null,s):n},s.startAngle=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),s):i},s.endAngle=function(e){return arguments.length?(r="function"==typeof e?e:a(+e),s):r},s.padAngle=function(e){return arguments.length?(o="function"==typeof e?e:a(+e),s):o},s}S.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t)}}};var L=P(T);function D(e){this._curve=e}function P(e){function t(t){return new D(e(t))}return t._curve=e,t}function R(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(e){return arguments.length?t(P(e)):t()._curve},e}function N(){return R(j().curve(L))}function A(){var e=w().curve(L),t=e.curve,a=e.lineX0,n=e.lineX1,i=e.lineY0,r=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return R(a())},delete e.lineX0,e.lineEndAngle=function(){return R(n())},delete e.lineX1,e.lineInnerRadius=function(){return R(i())},delete e.lineY0,e.lineOuterRadius=function(){return R(r())},delete e.lineY1,e.curve=function(e){return arguments.length?t(P(e)):t()._curve},e}function H(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}D.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};var U=Array.prototype.slice;function z(e){return e.source}function J(e){return e.target}function Y(e){var n=z,i=J,r=C,o=O,s=null;function l(){var a,l=U.call(arguments),c=n.apply(this,l),u=i.apply(this,l);if(s||(s=a=t.path()),e(s,+r.apply(this,(l[0]=c,l)),+o.apply(this,l),+r.apply(this,(l[0]=u,l)),+o.apply(this,l)),a)return s=null,a+""||null}return l.source=function(e){return arguments.length?(n=e,l):n},l.target=function(e){return arguments.length?(i=e,l):i},l.x=function(e){return arguments.length?(r="function"==typeof e?e:a(+e),l):r},l.y=function(e){return arguments.length?(o="function"==typeof e?e:a(+e),l):o},l.context=function(e){return arguments.length?(s=null==e?null:e,l):s},l}function B(e,t,a,n,i){e.moveTo(t,a),e.bezierCurveTo(t=(t+n)/2,a,t,i,n,i)}function V(e,t,a,n,i){e.moveTo(t,a),e.bezierCurveTo(t,a=(a+i)/2,n,a,n,i)}function $(e,t,a,n,i){var r=H(t,a),o=H(t,a=(a+i)/2),s=H(n,a),l=H(n,i);e.moveTo(r[0],r[1]),e.bezierCurveTo(o[0],o[1],s[0],s[1],l[0],l[1])}function q(){return Y(B)}function W(){return Y(V)}function G(){var e=Y($);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}var Q={draw:function(e,t){var a=Math.sqrt(t/d);e.moveTo(a,0),e.arc(0,0,a,0,g)}},Z={draw:function(e,t){var a=Math.sqrt(t/5)/2;e.moveTo(-3*a,-a),e.lineTo(-a,-a),e.lineTo(-a,-3*a),e.lineTo(a,-3*a),e.lineTo(a,-a),e.lineTo(3*a,-a),e.lineTo(3*a,a),e.lineTo(a,a),e.lineTo(a,3*a),e.lineTo(-a,3*a),e.lineTo(-a,a),e.lineTo(-3*a,a),e.closePath()}},X=Math.sqrt(1/3),K=2*X,ee={draw:function(e,t){var a=Math.sqrt(t/K),n=a*X;e.moveTo(0,-a),e.lineTo(n,0),e.lineTo(0,a),e.lineTo(-n,0),e.closePath()}},te=.8908130915292852,ae=Math.sin(d/10)/Math.sin(7*d/10),ne=Math.sin(g/10)*ae,ie=-Math.cos(g/10)*ae,re={draw:function(e,t){var a=Math.sqrt(t*te),n=ne*a,i=ie*a;e.moveTo(0,-a),e.lineTo(n,i);for(var r=1;r<5;++r){var o=g*r/5,s=Math.cos(o),l=Math.sin(o);e.lineTo(l*a,-s*a),e.lineTo(s*n-l*i,l*n+s*i)}e.closePath()}},oe={draw:function(e,t){var a=Math.sqrt(t),n=-a/2;e.rect(n,n,a,a)}},se=Math.sqrt(3),le={draw:function(e,t){var a=-Math.sqrt(t/(3*se));e.moveTo(0,2*a),e.lineTo(-se*a,-a),e.lineTo(se*a,-a),e.closePath()}},ce=-.5,ue=Math.sqrt(3)/2,de=1/Math.sqrt(12),me=3*(de/2+1),ge={draw:function(e,t){var a=Math.sqrt(t/me),n=a/2,i=a*de,r=n,o=a*de+a,s=-r,l=o;e.moveTo(n,i),e.lineTo(r,o),e.lineTo(s,l),e.lineTo(ce*n-ue*i,ue*n+ce*i),e.lineTo(ce*r-ue*o,ue*r+ce*o),e.lineTo(ce*s-ue*l,ue*s+ce*l),e.lineTo(ce*n+ue*i,ce*i-ue*n),e.lineTo(ce*r+ue*o,ce*o-ue*r),e.lineTo(ce*s+ue*l,ce*l-ue*s),e.closePath()}},fe=[Q,Z,ee,oe,re,le,ge];function he(){var e=a(Q),n=a(64),i=null;function r(){var a;if(i||(i=a=t.path()),e.apply(this,arguments).draw(i,+n.apply(this,arguments)),a)return i=null,a+""||null}return r.type=function(t){return arguments.length?(e="function"==typeof t?t:a(t),r):e},r.size=function(e){return arguments.length?(n="function"==typeof e?e:a(+e),r):n},r.context=function(e){return arguments.length?(i=null==e?null:e,r):i},r}function pe(){}function be(e,t,a){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+a)/6)}function ye(e){this._context=e}function Ee(e){return new ye(e)}function ve(e){this._context=e}function xe(e){return new ve(e)}function _e(e){this._context=e}function Me(e){return new _e(e)}function Se(e,t){this._basis=new ye(e),this._beta=t}ye.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:be(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:be(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},ve.prototype={areaStart:pe,areaEnd:pe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:be(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},_e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var a=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(a,n):this._context.moveTo(a,n);break;case 3:this._point=4;default:be(this,e,t)}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}},Se.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,a=e.length-1;if(a>0)for(var n,i=e[0],r=t[0],o=e[a]-i,s=t[a]-r,l=-1;++l<=a;)n=l/a,this._basis.point(this._beta*e[l]+(1-this._beta)*(i+n*o),this._beta*t[l]+(1-this._beta)*(r+n*s));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};var Te=function e(t){function a(e){return 1===t?new ye(e):new Se(e,t)}return a.beta=function(t){return e(+t)},a}(.85);function Ce(e,t,a){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-a),e._x2,e._y2)}function Oe(e,t){this._context=e,this._k=(1-t)/6}Oe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ce(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Ce(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var je=function e(t){function a(e){return new Oe(e,t)}return a.tension=function(t){return e(+t)},a}(0);function we(e,t){this._context=e,this._k=(1-t)/6}we.prototype={areaStart:pe,areaEnd:pe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ce(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var ke=function e(t){function a(e){return new we(e,t)}return a.tension=function(t){return e(+t)},a}(0);function Ie(e,t){this._context=e,this._k=(1-t)/6}Ie.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ce(this,e,t)}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Fe=function e(t){function a(e){return new Ie(e,t)}return a.tension=function(t){return e(+t)},a}(0);function Le(e,t,a){var n=e._x1,i=e._y1,r=e._x2,o=e._y2;if(e._l01_a>u){var s=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);n=(n*s-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,i=(i*s-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>u){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);r=(r*c+e._x1*e._l23_2a-t*e._l12_2a)/d,o=(o*c+e._y1*e._l23_2a-a*e._l12_2a)/d}e._context.bezierCurveTo(n,i,r,o,e._x2,e._y2)}function De(e,t){this._context=e,this._alpha=t}De.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:Le(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Pe=function e(t){function a(e){return t?new De(e,t):new Oe(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);function Re(e,t){this._context=e,this._alpha=t}Re.prototype={areaStart:pe,areaEnd:pe,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+n*n,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Le(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var Ne=function e(t){function a(e){return t?new Re(e,t):new we(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);function Ae(e,t){this._context=e,this._alpha=t}Ae.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var a=this._x2-e,n=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(a*a+n*n,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Le(this,e,t)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};var He=function e(t){function a(e){return t?new Ae(e,t):new Ie(e,0)}return a.alpha=function(t){return e(+t)},a}(.5);function Ue(e){this._context=e}function ze(e){return new Ue(e)}function Je(e){return e<0?-1:1}function Ye(e,t,a){var n=e._x1-e._x0,i=t-e._x1,r=(e._y1-e._y0)/(n||i<0&&-0),o=(a-e._y1)/(i||n<0&&-0),s=(r*i+o*n)/(n+i);return(Je(r)+Je(o))*Math.min(Math.abs(r),Math.abs(o),.5*Math.abs(s))||0}function Be(e,t){var a=e._x1-e._x0;return a?(3*(e._y1-e._y0)/a-t)/2:t}function Ve(e,t,a){var n=e._x0,i=e._y0,r=e._x1,o=e._y1,s=(r-n)/3;e._context.bezierCurveTo(n+s,i+s*t,r-s,o-s*a,r,o)}function $e(e){this._context=e}function qe(e){this._context=new We(e)}function We(e){this._context=e}function Ge(e){return new $e(e)}function Qe(e){return new qe(e)}function Ze(e){this._context=e}function Xe(e){var t,a,n=e.length-1,i=new Array(n),r=new Array(n),o=new Array(n);for(i[0]=0,r[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)i[t]=1,r[t]=4,o[t]=4*e[t]+2*e[t+1];for(i[n-1]=2,r[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)a=i[t]/r[t-1],r[t]-=a,o[t]-=a*o[t-1];for(i[n-1]=o[n-1]/r[n-1],t=n-2;t>=0;--t)i[t]=(o[t]-i[t+1])/r[t];for(r[n-1]=(e[n]+i[n-1])/2,t=0;t<n-1;++t)r[t]=2*e[t+1]-i[t+1];return[i,r]}function Ke(e){return new Ze(e)}function et(e,t){this._context=e,this._t=t}function tt(e){return new et(e,.5)}function at(e){return new et(e,0)}function nt(e){return new et(e,1)}function it(e,t){if((i=e.length)>1)for(var a,n,i,r=1,o=e[t[0]],s=o.length;r<i;++r)for(n=o,o=e[t[r]],a=0;a<s;++a)o[a][1]+=o[a][0]=isNaN(n[a][1])?n[a][0]:n[a][1]}function rt(e){for(var t=e.length,a=new Array(t);--t>=0;)a[t]=t;return a}function ot(e,t){return e[t]}function st(){var e=a([]),t=rt,n=it,i=ot;function r(a){var r,o,s=e.apply(this,arguments),l=a.length,c=s.length,u=new Array(c);for(r=0;r<c;++r){for(var d,m=s[r],g=u[r]=new Array(l),f=0;f<l;++f)g[f]=d=[0,+i(a[f],m,f,a)],d.data=a[f];g.key=m}for(r=0,o=t(u);r<c;++r)u[o[r]].index=r;return n(u,o),u}return r.keys=function(t){return arguments.length?(e="function"==typeof t?t:a(U.call(t)),r):e},r.value=function(e){return arguments.length?(i="function"==typeof e?e:a(+e),r):i},r.order=function(e){return arguments.length?(t=null==e?rt:"function"==typeof e?e:a(U.call(e)),r):t},r.offset=function(e){return arguments.length?(n=null==e?it:e,r):n},r}function lt(e,t){if((n=e.length)>0){for(var a,n,i,r=0,o=e[0].length;r<o;++r){for(i=a=0;a<n;++a)i+=e[a][r][1]||0;if(i)for(a=0;a<n;++a)e[a][r][1]/=i}it(e,t)}}function ct(e,t){if((s=e.length)>0)for(var a,n,i,r,o,s,l=0,c=e[t[0]].length;l<c;++l)for(r=o=0,a=0;a<s;++a)(i=(n=e[t[a]][l])[1]-n[0])>0?(n[0]=r,n[1]=r+=i):i<0?(n[1]=o,n[0]=o+=i):(n[0]=0,n[1]=i)}function ut(e,t){if((a=e.length)>0){for(var a,n=0,i=e[t[0]],r=i.length;n<r;++n){for(var o=0,s=0;o<a;++o)s+=e[o][n][1]||0;i[n][1]+=i[n][0]=-s/2}it(e,t)}}function dt(e,t){if((i=e.length)>0&&(n=(a=e[t[0]]).length)>0){for(var a,n,i,r=0,o=1;o<n;++o){for(var s=0,l=0,c=0;s<i;++s){for(var u=e[t[s]],d=u[o][1]||0,m=(d-(u[o-1][1]||0))/2,g=0;g<s;++g){var f=e[t[g]];m+=(f[o][1]||0)-(f[o-1][1]||0)}l+=d,c+=m*d}a[o-1][1]+=a[o-1][0]=r,l&&(r-=c/l)}a[o-1][1]+=a[o-1][0]=r,it(e,t)}}function mt(e){var t=e.map(gt);return rt(e).sort((function(e,a){return t[e]-t[a]}))}function gt(e){for(var t,a=-1,n=0,i=e.length,r=-1/0;++a<i;)(t=+e[a][1])>r&&(r=t,n=a);return n}function ft(e){var t=e.map(ht);return rt(e).sort((function(e,a){return t[e]-t[a]}))}function ht(e){for(var t,a=0,n=-1,i=e.length;++n<i;)(t=+e[n][1])&&(a+=t);return a}function pt(e){return ft(e).reverse()}function bt(e){var t,a,n=e.length,i=e.map(ht),r=mt(e),o=0,s=0,l=[],c=[];for(t=0;t<n;++t)a=r[t],o<s?(o+=i[a],l.push(a)):(s+=i[a],c.push(a));return c.reverse().concat(l)}function yt(e){return rt(e).reverse()}Ue.prototype={areaStart:pe,areaEnd:pe,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}},$e.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ve(this,this._t0,Be(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var a=NaN;if(t=+t,(e=+e)!==this._x1||t!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ve(this,Be(this,a=Ye(this,e,t)),a);break;default:Ve(this,this._t0,a=Ye(this,e,t))}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=a}}},(qe.prototype=Object.create($e.prototype)).point=function(e,t){$e.prototype.point.call(this,t,e)},We.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,a,n,i,r){this._context.bezierCurveTo(t,e,n,a,r,i)}},Ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,a=e.length;if(a)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),2===a)this._context.lineTo(e[1],t[1]);else for(var n=Xe(e),i=Xe(t),r=0,o=1;o<a;++r,++o)this._context.bezierCurveTo(n[0][r],i[0][r],n[1][r],i[1][r],e[o],t[o]);(this._line||0!==this._line&&1===a)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}},et.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var a=this._x*(1-this._t)+e*this._t;this._context.lineTo(a,this._y),this._context.lineTo(a,t)}}this._x=e,this._y=t}},e.arc=M,e.area=w,e.areaRadial=A,e.curveBasis=Ee,e.curveBasisClosed=xe,e.curveBasisOpen=Me,e.curveBundle=Te,e.curveCardinal=je,e.curveCardinalClosed=ke,e.curveCardinalOpen=Fe,e.curveCatmullRom=Pe,e.curveCatmullRomClosed=Ne,e.curveCatmullRomOpen=He,e.curveLinear=T,e.curveLinearClosed=ze,e.curveMonotoneX=Ge,e.curveMonotoneY=Qe,e.curveNatural=Ke,e.curveStep=tt,e.curveStepAfter=nt,e.curveStepBefore=at,e.line=j,e.lineRadial=N,e.linkHorizontal=q,e.linkRadial=G,e.linkVertical=W,e.pie=F,e.pointRadial=H,e.radialArea=A,e.radialLine=N,e.stack=st,e.stackOffsetDiverging=ct,e.stackOffsetExpand=lt,e.stackOffsetNone=it,e.stackOffsetSilhouette=ut,e.stackOffsetWiggle=dt,e.stackOrderAppearance=mt,e.stackOrderAscending=ft,e.stackOrderDescending=pt,e.stackOrderInsideOut=bt,e.stackOrderNone=rt,e.stackOrderReverse=yt,e.symbol=he,e.symbolCircle=Q,e.symbolCross=Z,e.symbolDiamond=ee,e.symbolSquare=oe,e.symbolStar=re,e.symbolTriangle=le,e.symbolWye=ge,e.symbols=fe,Object.defineProperty(e,"__esModule",{value:!0})}(t,a(264))},264:function(e,t,a){!function(e){"use strict";var t=Math.PI,a=2*t,n=1e-6,i=a-n;function r(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function o(){return new r}r.prototype=o.prototype={constructor:r,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,a,n){this._+="Q"+ +e+","+ +t+","+(this._x1=+a)+","+(this._y1=+n)},bezierCurveTo:function(e,t,a,n,i,r){this._+="C"+ +e+","+ +t+","+ +a+","+ +n+","+(this._x1=+i)+","+(this._y1=+r)},arcTo:function(e,a,i,r,o){e=+e,a=+a,i=+i,r=+r,o=+o;var s=this._x1,l=this._y1,c=i-e,u=r-a,d=s-e,m=l-a,g=d*d+m*m;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=a);else if(g>n)if(Math.abs(m*c-u*d)>n&&o){var f=i-s,h=r-l,p=c*c+u*u,b=f*f+h*h,y=Math.sqrt(p),E=Math.sqrt(g),v=o*Math.tan((t-Math.acos((p+g-b)/(2*y*E)))/2),x=v/E,_=v/y;Math.abs(x-1)>n&&(this._+="L"+(e+x*d)+","+(a+x*m)),this._+="A"+o+","+o+",0,0,"+ +(m*f>d*h)+","+(this._x1=e+_*c)+","+(this._y1=a+_*u)}else this._+="L"+(this._x1=e)+","+(this._y1=a)},arc:function(e,r,o,s,l,c){e=+e,r=+r,c=!!c;var u=(o=+o)*Math.cos(s),d=o*Math.sin(s),m=e+u,g=r+d,f=1^c,h=c?s-l:l-s;if(o<0)throw new Error("negative radius: "+o);null===this._x1?this._+="M"+m+","+g:(Math.abs(this._x1-m)>n||Math.abs(this._y1-g)>n)&&(this._+="L"+m+","+g),o&&(h<0&&(h=h%a+a),h>i?this._+="A"+o+","+o+",0,1,"+f+","+(e-u)+","+(r-d)+"A"+o+","+o+",0,1,"+f+","+(this._x1=m)+","+(this._y1=g):h>n&&(this._+="A"+o+","+o+",0,"+ +(h>=t)+","+f+","+(this._x1=e+o*Math.cos(l))+","+(this._y1=r+o*Math.sin(l))))},rect:function(e,t,a,n){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +a+"v"+ +n+"h"+-a+"Z"},toString:function(){return this._}},e.path=o,Object.defineProperty(e,"__esModule",{value:!0})}(t)},290:function(e,t,a){"use strict";a.r(t),a.d(t,"renderApp",(function(){return ol}));var n=a(2),i=a.n(n),r=a(25),o=a.n(r),s=a(68),l=a(38),c=(a(185),a(188)),u=a(181),d=a(13),m=a(33),g=a.n(m),f=a(1),h=a(100),p=a.n(h),b=a(50),y=a(4),E=a(107),v=a(197),x=a(86),_=a(198),M=a(199),S=a(5),T=a(95);const C=e=>{Object(M.a)(S.d,T.d,e)};var O=a(82),j=a(106),w=a(177),k=a(18),I=a(0),F=a(19);const L=async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:i}=e,r=await t("/api/ml/jobs/jobs_summary",{method:"POST",body:JSON.stringify(D.encode({jobIds:i.map((e=>Object(O.k)(a,n,e)))}))});return Object(F.b)(z)(r)},D=I.type({jobIds:I.array(I.string)}),P=I.keyof({started:null,starting:null,stopped:null,stopping:null,"":null}),R=I.keyof({closed:null,closing:null,deleting:null,failed:null,opened:null,opening:null}),N=I.partial({per_partition_categorization:I.intersection([I.type({enabled:I.boolean}),I.partial({stop_on_warn:I.boolean})])}),A=I.keyof({ok:null,warn:null}),H=I.type({categorization_status:A,categorized_doc_count:I.number,dead_category_count:I.number,frequent_category_count:I.number,log_time:I.number,rare_category_count:I.number,total_category_count:I.number}),U=I.intersection([I.type({id:I.string,jobState:R}),I.partial({awaitingNodeAssignment:I.boolean,datafeedIndices:I.array(I.string),datafeedState:P,fullJob:I.partial({analysis_config:N,create_time:I.number,custom_settings:O.q,finished_time:I.number,model_size_stats:H,datafeed_config:I.partial({runtime_mappings:I.UnknownRecord})})})]),z=I.array(U),J=async(e,t)=>{const a=await t(`/api/ml/modules/get_module/${e}`,{method:"GET"});return Object(F.b)(B)(a)},Y=I.type({id:I.string,config:I.type({custom_settings:O.q})}),B=I.type({id:I.string,jobs:I.array(Y)}),V=async(e,t)=>{const{moduleId:a,start:n,end:i,spaceId:r,sourceId:o,indexPattern:s,jobOverrides:l=[],datafeedOverrides:c=[],query:u,useDedicatedIndex:d=!1}=e,m=await t(`/api/ml/modules/setup/${a}`,{method:"POST",body:JSON.stringify(Q.encode({start:n,end:i,indexPatternName:s,prefix:Object(O.l)(r,o),startDatafeed:!0,jobOverrides:l,datafeedOverrides:c,query:u,useDedicatedIndex:d}))});return Object(F.b)(te)(m)},$=I.partial({start:I.number,end:I.number}),q=I.type({job_id:I.string,custom_settings:O.q}),W=I.object,G=I.intersection([I.strict({indexPatternName:I.string,prefix:I.string,startDatafeed:I.boolean,jobOverrides:I.array(q),datafeedOverrides:I.array(W),useDedicatedIndex:I.boolean}),I.exact(I.partial({query:I.object}))]),Q=I.intersection([$,G]),Z=I.type({reason:I.string,type:I.string}),X=I.type({status:I.number,error:I.intersection([Z,I.type({root_cause:I.array(Z)})])}),K=I.intersection([I.type({id:I.string,started:I.boolean,success:I.boolean}),I.partial({awaitingNodeAssignment:I.boolean,error:X})]),ee=I.intersection([I.type({id:I.string,success:I.boolean}),I.partial({error:X})]),te=I.type({datafeeds:I.array(K),jobs:I.array(ee)});var ae=a(97);const ne=async(e,t)=>{const{indices:a,timestampField:n,startTime:i,endTime:r,runtimeMappings:o}=e,s=await t(ae.c,{method:"POST",body:JSON.stringify(ae.t.encode({data:{endTime:r,indices:a,startTime:i,timestampField:n,runtimeMappings:o}}))});return Object(F.b)(ae.u)(s)},ie=async(e,t)=>{const{indices:a,fields:n,runtimeMappings:i}=e,r=await t(ae.d,{method:"POST",body:JSON.stringify(ae.w.encode({data:{indices:a,fields:n,runtimeMappings:i}}))});return Object(F.b)(ae.x)(r)},re=async e=>{const t=await e("/api/ml/jobs/deleting_jobs_tasks");return Object(F.b)(le)(t)},oe=I.type({jobIds:I.array(I.string)}),se=I.record(I.string,I.type({deleted:I.boolean})),le=I.type({jobIds:I.array(I.string)}),ce=I.type({datafeedIds:I.array(I.string)}),ue=I.record(I.string,I.type({stopped:I.boolean})),de=async(e,t,a,n)=>{try{await(async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:i}=e,r=await t("/api/ml/jobs/stop_datafeeds",{method:"POST",body:JSON.stringify(ce.encode({datafeedIds:i.map((e=>Object(O.i)(a,n,e)))}))});return Object(F.b)(ue)(r)})({spaceId:e,sourceId:t,jobTypes:a},n)}catch(e){var i;if(404!==(null==e||null===(i=e.res)||void 0===i?void 0:i.status))throw e}return await me(e,t,a,n)},me=async(e,t,a,n)=>{const i=await(async(e,t)=>{const{spaceId:a,sourceId:n,jobTypes:i}=e,r=await t("/api/ml/jobs/delete_jobs",{method:"POST",body:JSON.stringify(oe.encode({jobIds:i.map((e=>Object(O.k)(a,n,e)))}))});return Object(F.b)(se)(r)})({spaceId:e,sourceId:t,jobTypes:a},n);return await ge(e,t,a,n),i},ge=async(e,t,a,n)=>{const i=a.map((a=>Object(O.k)(e,t,a)));for(;;){const{jobIds:e}=await re(n);if(!e.some((e=>i.includes(e))))return!0;await fe(1e3)}},fe=e=>new Promise((t=>setTimeout(t,e))),he="logs_ui_categories",pe=f.i18n.translate("xpack.infra.logs.analysis.logEntryCategoriesModuleName",{defaultMessage:"Categorization"}),be=f.i18n.translate("xpack.infra.logs.analysis.logEntryCategoriesModuleDescription",{defaultMessage:"Use Machine Learning to automatically categorize log messages."}),ye=(e,t)=>O.t.reduce(((a,n)=>({...a,[n]:Object(O.k)(e,t,n)})),{}),Ee={moduleId:he,moduleName:pe,moduleDescription:be,jobTypes:O.t,bucketSpan:O.c,getJobIds:ye,getJobSummary:async(e,t,a)=>{const n=await L({spaceId:e,sourceId:t,jobTypes:O.t},a),i=Object.values(ye(e,t));return n.filter((e=>i.includes(e.id)))},getModuleDefinition:async e=>await J(he,e),setUpModule:async(e,t,a,{spaceId:n,sourceId:i,indices:r,timestampField:o,runtimeMappings:s},l)=>{const c=r.join(","),u=[{job_id:"log-entry-categories-count",analysis_config:{bucket_span:`${O.c}ms`},data_description:{time_field:o},custom_settings:{logs_source_config:{indexPattern:c,timestampField:o,bucketSpan:O.c,datasetFilter:a}}}],d=[{job_id:"log-entry-categories-count",runtime_mappings:s}],m={bool:{filter:[..."includeSome"===a.type?[{terms:{"event.dataset":a.datasets}}]:[],{exists:{field:"message"}}]}};return V({moduleId:he,start:e,end:t,spaceId:n,sourceId:i,indexPattern:c,jobOverrides:u,datafeedOverrides:d,query:m,useDedicatedIndex:!0},l)},cleanUpModule:async(e,t,a)=>await de(e,t,O.t,a),validateSetupDatasets:async(e,t,a,n,i,r)=>await ne({indices:e,timestampField:t,startTime:a,endTime:n,runtimeMappings:i},r),validateSetupIndices:async(e,t,a,n)=>await ie({indices:e,fields:[{name:t,validTypes:["date"]},{name:O.z,validTypes:["keyword"]},{name:O.d,validTypes:["text"]}],runtimeMappings:a},n)};var ve=a(83),xe=a.n(ve),_e=a(20),Me=a(84);const Se=({jobTypes:e})=>({jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{}),jobSummaries:[],lastSetupErrorMessages:[],setupStatus:{type:"initializing"}}),Te=e=>t=>t.filter((t=>t.id===e&&t.success&&!t.error)).length>0,Ce=e=>t=>t.filter((t=>t.id===e&&t.success&&t.started&&!t.error)).length>0,Oe=e=>t=>t.filter((t=>t.id===e)).map((e=>"failed"===e.jobState||""===e.datafeedState?"failed":"closed"===e.jobState&&"stopped"===e.datafeedState&&e.fullJob&&null!=e.fullJob.finished_time?"finished":"closed"===e.jobState||"closing"===e.jobState||"stopped"===e.datafeedState?"stopped":"opening"===e.jobState&&!1===e.awaitingNodeAssignment?"initializing":"opened"===e.jobState&&"started"===e.datafeedState||"opening"===e.jobState&&"starting"===e.datafeedState&&!0===e.awaitingNodeAssignment?"started":"unknown"))[0]||"missing",je=e=>t=>Object.entries(e).reduce(((e,[,t])=>"missing"===t?{type:"required"}:"required"===e.type||"succeeded"===e.type?e:"skipped"===e.type||Object(O.p)(t)?{type:"skipped",newlyCreated:"skipped"===e.type&&e.newlyCreated}:e),t),we=e=>null!=e.error,ke=e=>Object(n.useReducer)((e=>(t,a)=>{switch(a.type){case"startedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"initializing"})),{}),setupStatus:{type:"pending"}};case"finishedSetup":{const{datafeedSetupResults:n,jobSetupResults:i,jobSummaries:r,spaceId:o,sourceId:s}=a,l=e.reduce(((e,t)=>({...e,[t]:Te(Object(O.k)(o,s,t))(i)&&Ce(Object(O.i)(o,s,t))(n)?"started":"failed"})),{}),c=Object.values(l).every((e=>"started"===e||"starting"===e))?{type:"succeeded"}:{type:"failed",reasons:[...Object.values(n).filter(we).map((e=>{var t;return null===(t=e.error.error)||void 0===t?void 0:t.reason})),...Object.values(i).filter(we).map((e=>{var t;return null===(t=e.error.error)||void 0===t?void 0:t.reason}))]};return{...t,jobStatus:l,jobSummaries:r,setupStatus:c}}case"failedSetup":return{...t,jobStatus:e.reduce(((e,t)=>({...e,[t]:"failed"})),{}),setupStatus:{type:"failed",reasons:["unknown"]}};case"fetchingJobStatuses":return{...t,setupStatus:"unknown"===t.setupStatus.type?{type:"initializing"}:t.setupStatus};case"fetchedJobStatuses":{const{payload:n,spaceId:i,sourceId:r}=a,{setupStatus:o}=t,s=e.reduce(((e,t)=>({...e,[t]:Oe(Object(O.k)(i,r,t))(n)})),{}),l=je(s)(o);return{...t,jobSummaries:n,jobStatus:s,setupStatus:l}}case"failedFetchingJobStatuses":return{...t,setupStatus:{type:"unknown"},jobStatus:e.reduce(((e,t)=>({...e,[t]:"unknown"})),{})};case"viewedResults":return{...t,setupStatus:{type:"skipped",newlyCreated:!0}};default:return t}})(e),{jobTypes:e},Se);var Ie=a(66);const Fe=({sourceConfiguration:e,moduleDescriptor:t})=>{const{services:a}=Object(_e.b)(),{spaceId:i,sourceId:r,timestampField:o,runtimeMappings:s}=e,[l,c]=ke(t.jobTypes),u=Object(Ie.useUiTracker)({app:"infra_logs"}),[,d]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>(c({type:"fetchingJobStatuses"}),await t.getJobSummary(i,r,a.http.fetch)),onResolve:e=>{c({type:"fetchedJobStatuses",payload:e,spaceId:i,sourceId:r})},onReject:()=>{c({type:"failedFetchingJobStatuses"})}},[i,r]),[,m]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async(e,n,l,u)=>{c({type:"startedSetup"});return{setupResult:await t.setUpModule(n,l,u,{indices:e,sourceId:r,spaceId:i,timestampField:o,runtimeMappings:s},a.http.fetch),jobSummaries:await t.getJobSummary(i,r,a.http.fetch)}},onResolve:({setupResult:{datafeeds:e,jobs:t},jobSummaries:a})=>{if([...e,...t].reduce(((e,t)=>[...e,...Object.keys(t)]),[]).some((e=>"error"===e))){[...e,...t].filter((e=>void 0!==e.error)).map((e=>{var t,a,n;return null!==(t=null===(a=e.error)||void 0===a||null===(n=a.error)||void 0===n?void 0:n.reason)&&void 0!==t?t:""})).filter((e=>e.includes("because it has no mappings"))).length>0?u({metric:"logs_ml_setup_error_bad_indices_or_mappings"}):u({metric:"logs_ml_setup_error_unknown_cause"})}c({type:"finishedSetup",datafeedSetupResults:e,jobSetupResults:t,jobSummaries:a,spaceId:i,sourceId:r})},onReject:e=>{var t;c({type:"failedSetup"}),403===(null==e||null===(t=e.body)||void 0===t?void 0:t.statusCode)&&u({metric:"logs_ml_setup_error_lack_of_privileges"})}},[t.setUpModule,i,r,o]),[g,f]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>await t.cleanUpModule(i,r,a.http.fetch)},[i,r]),h=Object(n.useMemo)((()=>"pending"===g.state),[g.state]),p=Object(n.useCallback)(((e,t,a,n)=>{c({type:"startedSetup"}),f().then((()=>{m(e,t,a,n)})).catch((()=>{c({type:"failedSetup"})}))}),[f,c,m]),b=Object(n.useCallback)((()=>{c({type:"viewedResults"})}),[c]),y=Object(n.useMemo)((()=>t.getJobIds(i,r)),[t,i,r]);return{cleanUpAndSetUpModule:p,cleanUpModule:f,fetchJobStatus:d,isCleaningUp:h,jobIds:y,jobStatus:l.jobStatus,jobSummaries:l.jobSummaries,lastSetupErrorMessages:l.lastSetupErrorMessages,moduleDescriptor:t,setUpModule:m,setupStatus:l.setupStatus,sourceConfiguration:e,viewResults:b}};var Le=a(163),De=a.n(Le);const Pe=({moduleDescriptor:e,sourceConfiguration:t})=>({getIsJobConfigurationOutdated:Object(n.useMemo)((()=>Re(e,t)),[t,e])}),Re=({bucketSpan:e},t)=>a=>{var n;if(!a.fullJob||!a.fullJob.custom_settings||!a.fullJob.datafeed_config)return!1;const i=a.fullJob.custom_settings.logs_source_config,r=null!==(n=a.fullJob.datafeed_config.runtime_mappings)&&void 0!==n?n:{};return!(i&&i.bucketSpan===e&&i.indexPattern&&Ne(new Set(i.indexPattern.split(",")),new Set(t.indices))&&i.timestampField===t.timestampField&&De()(r,t.runtimeMappings))},Ne=(e,t)=>Array.from(e).every((e=>t.has(e))),Ae=({sourceConfiguration:{spaceId:e,sourceId:t},moduleDescriptor:a})=>{const{services:i}=Object(_e.b)(),[r,o]=Object(n.useState)(),s=Object(n.useMemo)((()=>r?r.jobs.reduce(((a,n)=>({...a,[Object(O.k)(e,t,n.id)]:n})),{}):{}),[r,t,e]),[l,c]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>await a.getModuleDefinition(i.http.fetch),onResolve:e=>{o(e)},onReject:()=>{o(void 0)}},[a.getModuleDefinition,e,t]),u=Object(n.useCallback)((e=>{var t,a,n;const i=s[e.id];if(null==i)return!1;const r=null==i?void 0:i.config.custom_settings.job_revision;return(null!==(t=null===(a=e.fullJob)||void 0===a||null===(n=a.custom_settings)||void 0===n?void 0:n.job_revision)&&void 0!==t?t:0)<(null!=r?r:0)}),[s]);return{fetchModuleDefinition:c,fetchModuleDefinitionRequestState:l.state,getIsJobDefinitionOutdated:u,jobDefinitionByJobId:s,moduleDefinition:r}};var He=a(248),Ue=a.n(He);const ze=({jobSummaries:e})=>{const{services:{http:{fetch:t}}}=Object(_e.b)(),[a,i]=Object(n.useState)([]),r=Object(n.useMemo)((()=>e.filter(Je)),[e]),o=Object(n.useMemo)((()=>r.filter(Ye)),[r]),[s,l]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:e=>Promise.all(e.map((({jobId:e,startTime:a,endTime:n})=>(async({jobIds:e,startTime:t,endTime:a,includeCategorizerStatuses:n},i)=>{const r=await i(ae.b,{method:"POST",body:JSON.stringify(ae.j.encode({data:{jobIds:e,timeRange:{startTime:t,endTime:a},includeCategorizerStatuses:n}}))});return Object(F.b)(ae.k)(r)})({jobIds:[e],startTime:a,endTime:n,includeCategorizerStatuses:["warn"]},t)))),onResolve:e=>{i(e.flatMap((({data:{datasetStats:e}})=>e)))}},[]);Ue()((()=>{l(o.map((e=>{var t,a,n,i,r;return{jobId:e.id,startTime:null!==(t=null===(a=e.fullJob)||void 0===a?void 0:a.create_time)&&void 0!==t?t:0,endTime:null!==(n=null===(i=e.fullJob)||void 0===i||null===(r=i.model_size_stats)||void 0===r?void 0:r.log_time)&&void 0!==n?n:Date.now()}})))}),[o]);return{categoryQualityWarnings:Object(n.useMemo)((()=>[...r.filter((e=>!Ye(e))).map((e=>{var t;return{type:"categoryQualityWarning",jobId:e.id,dataset:"",reasons:null!==(t=e.fullJob)&&void 0!==t&&t.model_size_stats?Be(e.fullJob.model_size_stats):[]}})),...a.map((e=>({type:"categoryQualityWarning",jobId:e.job_id,dataset:e.dataset,reasons:Be(e)})))]),[r,a]),lastLatestWarnedDatasetsStatsRequestErrors:"rejected"===s.state?s.value:null,isLoadingCategoryQualityWarnings:"pending"===s.state}},Je=e=>{var t,a;return"warn"===(null===(t=e.fullJob)||void 0===t||null===(a=t.model_size_stats)||void 0===a?void 0:a.categorization_status)},Ye=e=>{var t,a,n;return null!==(t=null===(a=e.fullJob)||void 0===a||null===(n=a.analysis_config)||void 0===n?void 0:n.per_partition_categorization)&&void 0!==t&&t},Be=({categorized_doc_count:e,dead_category_count:t,frequent_category_count:a,rare_category_count:n,total_category_count:i})=>{const r=n/i,o=i/e,s=t/i;return[...1===i?[{type:"singleCategory"}]:[],...r>=.9?[{type:"manyRareCategories",rareCategoriesRatio:r}]:[],...e>100&&o>=.5?[{type:"manyCategories",categoriesDocumentRatio:o}]:[],...0===a?[{type:"noFrequentCategories"}]:[],...s>=.5?[{type:"manyDeadCategories",deadCategoriesRatio:s}]:[]]},[Ve,$e]=xe()((({indexPattern:e,sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})=>{const o=Object(n.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})),[e,t,a,i,r]),s=Fe({moduleDescriptor:Ee,sourceConfiguration:o}),{getIsJobConfigurationOutdated:l}=Pe({sourceConfiguration:o,moduleDescriptor:Ee}),{fetchModuleDefinition:c,getIsJobDefinitionOutdated:u}=Ae({sourceConfiguration:o,moduleDescriptor:Ee}),{categoryQualityWarnings:d}=ze({jobSummaries:s.jobSummaries}),m=Object(n.useMemo)((()=>s.jobSummaries.some(l)),[l,s.jobSummaries]),g=Object(n.useMemo)((()=>s.jobSummaries.some(u)),[u,s.jobSummaries]),f=Object(n.useMemo)((()=>Object.values(s.jobStatus).some((e=>"stopped"===e))),[s.jobStatus]);return{...s,categoryQualityWarnings:d,fetchModuleDefinition:c,hasOutdatedJobConfigurations:m,hasOutdatedJobDefinitions:g,hasStoppedJobs:f}}));var qe=a(27),We=a(164),Ge=a.n(We);const Qe=({cleanUpAndSetUpModule:e,moduleDescriptor:{validateSetupDatasets:t,validateSetupIndices:a},setUpModule:i,sourceConfiguration:r})=>{const{services:o}=Object(_e.b)(),[s,l]=Object(n.useState)(Date.now()-24192e5),[c,u]=Object(n.useState)(void 0),d=Object(n.useMemo)((()=>null==s||null==c||s<c),[c,s]),[m,g]=Object(n.useState)(r.indices.map((e=>({name:e,validity:"unknown"})))),f=Object(n.useCallback)((e=>g((t=>t.map((t=>{const a=e.filter((({index:e})=>e===t.name));return a.length>0?{validity:"invalid",name:t.name,errors:a}:"valid"===t.validity?{...t,validity:"valid",errors:[]}:{validity:"valid",name:t.name,isSelected:!Object(O.o)(t.name),availableDatasets:[],datasetFilter:{type:"includeAll"}}}))))),[]),h=Object(n.useCallback)((e=>g((t=>t.map((t=>{if("valid"!==t.validity)return t;const a=e.filter((({indexName:e})=>e===t.name)),n=a.flatMap((({datasets:e})=>e)),i=a.length>0?Object(O.g)(t.datasetFilter,(e=>n.includes(e))):t.datasetFilter;return{...t,availableDatasets:n,datasetFilter:i}}))))),[]),p=Object(n.useMemo)((()=>m.filter((e=>"valid"===e.validity)).map((e=>e.name))),[m]),b=Object(n.useMemo)((()=>m.filter((e=>"valid"===e.validity&&e.isSelected)).map((e=>e.name))),[m]),y=Object(n.useMemo)((()=>m.flatMap((e=>"valid"===e.validity?e.datasetFilter:{type:"includeAll"})).reduce(O.f,{type:"includeAll"})),[m]),[E,v]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>await a(r.indices,r.timestampField,r.runtimeMappings,o.http.fetch),onResolve:({data:{errors:e}})=>{f(e)},onReject:()=>{g([])}},[r.indices,r.timestampField]),[x,_]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>0===p.length?{data:{datasets:[]}}:await t(p,r.timestampField,null!=s?s:0,null!=c?c:Date.now(),r.runtimeMappings,o.http.fetch),onResolve:({data:{datasets:e}})=>{h(e)}},[p,r.timestampField,s,c]),M=Object(n.useCallback)((()=>i(b,s,c,y)),[i,b,s,c,y]),S=Object(n.useCallback)((()=>e(b,s,c,y)),[e,b,s,c,y]),T=Object(n.useMemo)((()=>"pending"===E.state||"pending"===x.state),[x.state,E.state]),C=Object(n.useMemo)((()=>T?[]:[..."rejected"===E.state||"rejected"===x.state?[{error:"NETWORK_ERROR"}]:[],...m.reduce(((e,t)=>"invalid"===t.validity&&b.includes(t.name)?[...e,...t.errors]:e),[]),...0===b.length?[{error:"TOO_FEW_SELECTED_INDICES"}]:[],...d?[]:[{error:"INVALID_TIME_RANGE"}]]),[T,E.state,x.state,m,b,d]),j=Ge()(s),w=Ge()(c),k=Ge()(p);return Object(n.useEffect)((()=>{d&&v()}),[d,v]),Object(n.useEffect)((()=>{d&&(s===j&&c===w&&Object(qe.isEqual)(p,k)||_())}),[c,d,w,j,k,s,p,_]),{cleanUpAndSetUp:S,datasetFilter:y,endTime:c,isValidating:T,selectedIndexNames:b,setEndTime:u,setStartTime:l,setUp:M,startTime:s,validatedIndices:m,setValidatedIndices:g,validationErrors:C}};var Ze=a(153),Xe=a(154);const Ke=({onClose:e})=>{const{categoryQualityWarnings:t,cleanUpAndSetUp:a,endTime:r,fetchJobStatus:o,isValidating:s,lastSetupErrorMessages:l,moduleDescriptor:c,setEndTime:u,setStartTime:m,setValidatedIndices:g,setUp:f,setupStatus:h,startTime:b,validatedIndices:y,validationErrors:E,viewResults:v}=(()=>{const{categoryQualityWarnings:e,cleanUpAndSetUpModule:t,fetchJobStatus:a,lastSetupErrorMessages:n,moduleDescriptor:i,setUpModule:r,setupStatus:o,sourceConfiguration:s,viewResults:l}=$e(),{cleanUpAndSetUp:c,endTime:u,isValidating:d,setEndTime:m,setStartTime:g,setValidatedIndices:f,setUp:h,startTime:p,validatedIndices:b,validationErrors:y}=Qe({cleanUpAndSetUpModule:t,moduleDescriptor:i,setUpModule:r,sourceConfiguration:s});return{categoryQualityWarnings:e,cleanUpAndSetUp:c,endTime:u,fetchJobStatus:a,isValidating:d,lastSetupErrorMessages:n,moduleDescriptor:i,setEndTime:m,setStartTime:g,setValidatedIndices:f,setUp:h,setupStatus:o,startTime:p,validatedIndices:b,validationErrors:y,viewResults:l}})();p()((()=>{o()}));const x=Object(n.useCallback)((()=>{v(),e()}),[v,e]),_=Object(n.useMemo)((()=>[Object(Ze.a)({setStartTime:m,setEndTime:u,startTime:b,endTime:r,isValidating:s,validatedIndices:y,setupStatus:h,setValidatedIndices:g,validationErrors:E,previousQualityWarnings:t}),Object(Xe.a)({cleanUpAndSetUp:a,errorMessages:l,isConfigurationValid:E.length<=0&&!s,setUp:f,setupStatus:h,viewResults:x})]),[t,a,r,s,l,u,m,f,g,h,b,y,E,x]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,c.moduleName," ")),i.a.createElement(d.EuiText,{size:"s"},c.moduleDescription),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiSteps,{steps:_}))},et="logs_ui_analysis",tt=f.i18n.translate("xpack.infra.logs.analysis.logEntryRateModuleName",{defaultMessage:"Log rate"}),at=f.i18n.translate("xpack.infra.logs.analysis.logEntryRateModuleDescription",{defaultMessage:"Use Machine Learning to automatically detect anomalous log entry rates."}),nt=(e,t)=>O.w.reduce(((a,n)=>({...a,[n]:Object(O.k)(e,t,n)})),{}),it={moduleId:et,moduleName:tt,moduleDescription:at,jobTypes:O.w,bucketSpan:O.c,getJobIds:nt,getJobSummary:async(e,t,a)=>{const n=await L({spaceId:e,sourceId:t,jobTypes:O.w},a),i=Object.values(nt(e,t));return n.filter((e=>i.includes(e.id)))},getModuleDefinition:async e=>await J(et,e),setUpModule:async(e,t,a,{spaceId:n,sourceId:i,indices:r,timestampField:o,runtimeMappings:s},l)=>{const c=r.join(","),u=[{job_id:"log-entry-rate",analysis_config:{bucket_span:`${O.c}ms`},data_description:{time_field:o},custom_settings:{logs_source_config:{indexPattern:c,timestampField:o,bucketSpan:O.c}}}],d=[{job_id:"log-entry-rate",runtime_mappings:s}],m="includeSome"===a.type?{bool:{filter:[{terms:{"event.dataset":a.datasets}}]}}:void 0;return V({moduleId:et,start:e,end:t,spaceId:n,sourceId:i,indexPattern:c,jobOverrides:u,datafeedOverrides:d,query:m,useDedicatedIndex:!0},l)},cleanUpModule:async(e,t,a)=>await de(e,t,O.w,a),validateSetupDatasets:async(e,t,a,n,i,r)=>await ne({indices:e,timestampField:t,startTime:a,endTime:n,runtimeMappings:i},r),validateSetupIndices:async(e,t,a,n)=>await ie({indices:e,fields:[{name:t,validTypes:["date"]},{name:O.z,validTypes:["keyword"]}],runtimeMappings:a},n)},[rt,ot]=xe()((({indexPattern:e,sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})=>{const o=Object(n.useMemo)((()=>({indices:e.split(","),sourceId:t,spaceId:a,timestampField:i,runtimeMappings:r})),[e,t,a,i,r]),s=Fe({moduleDescriptor:it,sourceConfiguration:o}),{getIsJobConfigurationOutdated:l}=Pe({sourceConfiguration:o,moduleDescriptor:it}),{fetchModuleDefinition:c,getIsJobDefinitionOutdated:u}=Ae({sourceConfiguration:o,moduleDescriptor:it}),d=Object(n.useMemo)((()=>s.jobSummaries.some(l)),[l,s.jobSummaries]),m=Object(n.useMemo)((()=>s.jobSummaries.some(u)),[u,s.jobSummaries]),g=Object(n.useMemo)((()=>Object.values(s.jobStatus).some((e=>"stopped"===e))),[s.jobStatus]);return{...s,fetchModuleDefinition:c,hasOutdatedJobConfigurations:d,hasOutdatedJobDefinitions:m,hasStoppedJobs:g}})),st=()=>{const{cleanUpAndSetUpModule:e,lastSetupErrorMessages:t,moduleDescriptor:a,setUpModule:n,setupStatus:i,sourceConfiguration:r,viewResults:o}=ot(),{cleanUpAndSetUp:s,endTime:l,isValidating:c,setEndTime:u,setStartTime:d,setValidatedIndices:m,setUp:g,startTime:f,validatedIndices:h,validationErrors:p}=Qe({cleanUpAndSetUpModule:e,moduleDescriptor:a,setUpModule:n,sourceConfiguration:r});return{cleanUpAndSetUp:s,endTime:l,isValidating:c,lastSetupErrorMessages:t,moduleDescriptor:a,setEndTime:u,setStartTime:d,setValidatedIndices:m,setUp:g,setupStatus:i,startTime:f,validatedIndices:h,validationErrors:p,viewResults:o}},[lt,ct]=xe()(st),ut=({onClose:e})=>{const{cleanUpAndSetUp:t,endTime:a,isValidating:r,lastSetupErrorMessages:o,moduleDescriptor:s,setEndTime:l,setStartTime:c,setValidatedIndices:u,setUp:m,setupStatus:g,startTime:f,validatedIndices:h,validationErrors:p,viewResults:b}=st(),y=Object(n.useCallback)((()=>{b(),e()}),[b,e]),E=Object(n.useMemo)((()=>[Object(Ze.a)({setStartTime:c,setEndTime:l,startTime:f,endTime:a,isValidating:r,validatedIndices:h,setupStatus:g,setValidatedIndices:u,validationErrors:p}),Object(Xe.a)({cleanUpAndSetUp:t,errorMessages:o,isConfigurationValid:p.length<=0&&!r,setUp:m,setupStatus:g,viewResults:y})]),[t,a,r,o,l,c,m,u,g,f,h,p,y]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,s.moduleName," ")),i.a.createElement(d.EuiText,{size:"s"},s.moduleDescription),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiSteps,{steps:E}))},dt=I.type({capabilities:I.type({canGetJobs:I.boolean,canCreateJob:I.boolean,canDeleteJob:I.boolean,canOpenJob:I.boolean,canCloseJob:I.boolean,canForecastJob:I.boolean,canGetDatafeeds:I.boolean,canStartStopDatafeed:I.boolean,canUpdateJob:I.boolean,canUpdateDatafeed:I.boolean,canPreviewDatafeed:I.boolean}),isPlatinumOrTrialLicense:I.boolean,mlFeatureEnabledInSpace:I.boolean,upgradeInProgress:I.boolean}),[mt,gt]=xe()((()=>{const{services:e}=Object(_e.b)(),[t,a]=Object(n.useState)(ft),[i,r]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>{const t=await e.http.fetch("/api/ml/ml_capabilities");return Object(F.b)(dt)(t)},onResolve:e=>{a(e)}},[]);Object(n.useEffect)((()=>{r()}),[r]);const o=Object(n.useMemo)((()=>"pending"===i.state),[i.state]),s=t.capabilities.canCreateJob,l=t.capabilities.canGetJobs;return{hasLogAnalysisCapabilites:t.isPlatinumOrTrialLicense&&t.mlFeatureEnabledInSpace,hasLogAnalysisReadCapabilities:l,hasLogAnalysisSetupCapabilities:s,isLoading:o}})),ft={capabilities:{canGetJobs:!1,canCreateJob:!1,canDeleteJob:!1,canOpenJob:!1,canCloseJob:!1,canForecastJob:!1,canGetDatafeeds:!1,canStartStopDatafeed:!1,canUpdateJob:!1,canUpdateDatafeed:!1,canPreviewDatafeed:!1,canGetCalendars:!1,canCreateCalendar:!1,canDeleteCalendar:!1,canGetFilters:!1,canCreateFilter:!1,canDeleteFilter:!1,canFindFileStructure:!1,canGetDataFrameJobs:!1,canDeleteDataFrameJob:!1,canPreviewDataFrameJob:!1,canCreateDataFrameJob:!1,canStartStopDataFrameJob:!1},isPlatinumOrTrialLicense:!1,mlFeatureEnabledInSpace:!1,upgradeInProgress:!1};var ht=a(184);const pt=({jobId:e,hasSetupCapabilities:t,moduleDescription:a,moduleName:r,moduleStatus:o,onViewSetup:s})=>{const{services:{ml:l,application:{navigateToUrl:c},notifications:{toasts:u}}}=Object(_e.b)(),[m,g]=Object(n.useState)("");Object(n.useEffect)((()=>{(async()=>{l.locator?g(await l.locator.getUrl({page:"jobs",pageState:{jobId:e}})):u.addWarning({title:bt})})()}));const f="required"===o.type?i.a.createElement(d.EuiIcon,{size:"xxl",type:"machineLearningApp"}):i.a.createElement(d.EuiIcon,{color:"success",size:"xxl",type:"check"}),h="required"===o.type?i.a.createElement(ht.a,{hasSetupCapabilities:t,onClick:s},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.enableAnomalyDetectionButtonLabel",defaultMessage:"Enable anomaly detection"})):i.a.createElement(i.a.Fragment,null,i.a.createElement(ht.b,{hasSetupCapabilities:t,onClick:s}),m?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"xs"}),i.a.createElement(d.EuiButtonEmpty,{onClick:async()=>{await c(m)}},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.viewInMlButtonLabel",defaultMessage:"View in Machine Learning"}))):null);return i.a.createElement(d.EuiCard,{description:a,footer:i.a.createElement("div",null,h),icon:f,title:r})},bt=f.i18n.translate("xpack.infra.logs.analysis.mlNotAvailable",{defaultMessage:"ML plugin is not available"}),yt=({onViewModuleSetup:e})=>{const{hasLogAnalysisSetupCapabilities:t}=gt(),{setupStatus:a,jobIds:r}=ot(),{setupStatus:o,jobIds:s}=$e(),l=Object(n.useCallback)((()=>{e("logs_ui_analysis")}),[e]),c=Object(n.useCallback)((()=>{e("logs_ui_categories")}),[e]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(pt,{jobId:r["log-entry-rate"],hasSetupCapabilities:t,moduleDescription:it.moduleDescription,moduleName:it.moduleName,moduleStatus:a,onViewSetup:l})),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(pt,{jobId:s["log-entry-categories-count"],hasSetupCapabilities:t,moduleDescription:Ee.moduleDescription,moduleName:Ee.moduleName,moduleStatus:o,onViewSetup:c}))))},Et=["logs_ui_analysis","logs_ui_categories"],[vt,xt]=xe()((({initialFlyoutView:e={view:"hidden"}})=>{const[t,a]=Object(n.useState)(e),i=Object(n.useCallback)((()=>a({view:"hidden"})),[]),r=Object(n.useCallback)((()=>a({view:"moduleList"})),[]),o=Object(n.useCallback)((e=>{a({view:"moduleSetup",module:e})}),[a]);return{closeFlyout:i,flyoutView:t,setFlyoutView:a,showModuleList:r,showModuleSetup:o}})),_t="logAnalysisSetupFlyoutHeading",Mt=({allowedModules:e=Et})=>{const{closeFlyout:t,flyoutView:a,showModuleList:n,showModuleSetup:r}=xt();return"hidden"===a.view?null:i.a.createElement(d.EuiFlyout,{"aria-labelledby":_t,maxWidth:800,onClose:t},i.a.createElement(d.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(d.EuiTitle,null,i.a.createElement("h2",{id:_t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.setupFlyoutTitle",defaultMessage:"Anomaly detection with Machine Learning"})))),i.a.createElement(d.EuiFlyoutBody,null,"moduleList"===a.view?i.a.createElement(yt,{onViewModuleSetup:r}):"moduleSetup"===a.view&&e.includes(a.module)?i.a.createElement(St,{moduleId:a.module,onClose:t,onViewModuleList:e.length>1?n:void 0}):null))},St=({moduleId:e,onClose:t,onViewModuleList:a})=>{switch(e){case"logs_ui_analysis":return i.a.createElement(Tt,{onViewModuleList:a},i.a.createElement(ut,{onClose:t}));case"logs_ui_categories":return i.a.createElement(Tt,{onViewModuleList:a},i.a.createElement(Ke,{onClose:t}))}},Tt=({children:e,onViewModuleList:t})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"flexStart",direction:"column",gutterSize:"none"},t?i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonEmpty,{flush:"left",iconSide:"left",iconType:"arrowLeft",onClick:t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.setupFlyoutGotoListButtonLabel",defaultMessage:"All Machine Learning jobs"}))):null,i.a.createElement(d.EuiFlexItem,null,e));var Ct=a(182),Ot=a(10),jt=a.n(Ot),wt=a(65),kt=a.n(wt),It=a(127),Ft=a.n(It),Lt=a(17),Dt=a(160);const Pt=({hasSetupCapabilities:e,moduleName:t,onRecreateMlJob:a})=>i.a.createElement(Dt.a,{hasSetupCapabilities:e,title:f.i18n.translate("xpack.infra.logs.analysis.jobConfigurationOutdatedCalloutTitle",{defaultMessage:"The {moduleName} ML job configuration is outdated",values:{moduleName:t}}),onRecreateMlJob:a},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobConfigurationOutdatedCalloutMessage",defaultMessage:"The {moduleName} ML job was created using a different source configuration. Recreate the job to apply the current configuration. This removes previously detected anomalies.",values:{moduleName:t},tagName:"p"})),Rt=({hasSetupCapabilities:e,moduleName:t,onRecreateMlJob:a})=>i.a.createElement(Dt.a,{hasSetupCapabilities:e,title:f.i18n.translate("xpack.infra.logs.analysis.jobDefinitionOutdatedCalloutTitle",{defaultMessage:"The {moduleName} ML job definition is outdated",values:{moduleName:t}}),onRecreateMlJob:a},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobDefinitionOutdatedCalloutMessage",defaultMessage:"A newer version of the {moduleName} ML job is available. Recreate the job to deploy the newer version. This removes previously detected anomalies.",values:{moduleName:t},tagName:"p"})),Nt=()=>i.a.createElement(d.EuiCallOut,{color:"primary",title:At},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.jobStoppedCalloutMessage",defaultMessage:"The ML job has been stopped manually or due to a lack of resources. New log entries will not be processed until the job has been restarted.",tagName:"p"})),At=f.i18n.translate("xpack.infra.logs.analysis.jobStoppedCalloutTitle",{defaultMessage:"ML job stopped"});var Ht=a(34);const Ut=({href:e})=>{const{services:{application:t}}=Object(_e.b)(),a=Object(n.useCallback)((a=>{e&&Object(Ht.a)(a)&&t.navigateToUrl(e)}),[e,t]);return i.a.createElement(d.EuiButton,{fill:!1,size:"s",onClick:a},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.analyzeInMlButtonLabel",defaultMessage:"Analyze in ML"}))},zt=()=>i.a.createElement(d.EuiCallOut,{color:"success",title:f.i18n.translate("xpack.infra.logs.analysis.onboardingSuccessTitle",{defaultMessage:"Success!"})},i.a.createElement("p",null,f.i18n.translate("xpack.infra.logs.analysis.onboardingSuccessContent",{defaultMessage:"Please allow a few minutes for our machine learning robots to begin collecting data."}))),Jt=({hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:a,hasStoppedJobs:n,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l})=>i.a.createElement(i.a.Fragment,null,t?i.a.createElement(Rt,{hasSetupCapabilities:a,moduleName:o,onRecreateMlJob:l}):null,e?i.a.createElement(Pt,{hasSetupCapabilities:a,moduleName:o,onRecreateMlJob:s}):null,n?i.a.createElement(Nt,null):null,r?i.a.createElement(zt,null):null);var Yt=a(200);const Bt=({hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:a,hasStoppedJobs:n,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l,qualityWarnings:c})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Jt,{hasOutdatedJobConfigurations:e,hasOutdatedJobDefinitions:t,hasSetupCapabilities:a,hasStoppedJobs:n,isFirstUse:r,moduleName:o,onRecreateMlJobForReconfiguration:s,onRecreateMlJobForUpdate:l}),i.a.createElement(Yt.b,{hasSetupCapabilities:a,qualityWarnings:c,onRecreateMlJob:s})),Vt=xe()((e=>{const[t,a]=Object(n.useState)(),{startTimestamp:i,endTimestamp:r,sourceId:o}=e;return[{startTimestamp:i,endTimestamp:r,sourceId:o,contextEntry:t},{setContextEntry:a}]})),$t=()=>window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,qt=()=>window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var Wt=a(202);const Gt=()=>{const[{contextEntry:e,startTimestamp:t,endTimestamp:a,sourceId:r},{setContextEntry:o}]=Object(n.useContext)(Vt.Context),s=Object(n.useCallback)((()=>o(void 0)),[o]),{width:l,height:c}=function(){const[e,t]=Object(n.useState)({width:$t(),height:qt()});return Object(n.useEffect)((()=>{const e=Object(qe.throttle)((()=>{t({width:$t(),height:qt()})}),250);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}(),u=Object(n.useMemo)((()=>{if(e&&!Object(qe.isEmpty)(e.context))return Object.entries(e.context).reduce(((e,[t,a])=>{const n=`${t} : "${a}"`;return e.length>0?`${e} AND ${n}`:n}),"")}),[e]);return e?i.a.createElement(d.EuiModal,{onClose:s,maxWidth:!1},i.a.createElement(Qt,{width:l-50,height:c-50},i.a.createElement(d.EuiFlexGroup,{direction:"column",responsive:!1,wrap:!1,style:{height:"100%"}},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Zt,{context:e.context})),i.a.createElement(d.EuiFlexItem,{grow:1},i.a.createElement(Wt.a,{sourceId:r,startTimestamp:t,endTimestamp:a,query:u,center:e.cursor,highlight:e.id,height:"100%"}))))):null},Qt=Lt.euiStyled.div`
  padding: 16px;
  width: ${e=>"number"==typeof e.width?`${e.width}px`:e.width};
  height: ${e=>"number"==typeof e.height?`${e.height}px`:e.height};
  max-height: 75vh; // Same as EuiModal
`,Zt=({context:e})=>{let t;if("container.id"in e&&(t=i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.viewInContext.logsFromContainerTitle",defaultMessage:"Displayed logs are from container {container}",values:{container:e["container.id"]}})),"host.name"in e){const a=e["log.file.path"].length>45?e["log.file.path"].slice(0,20)+"..."+e["log.file.path"].slice(-25):e["log.file.path"];t=i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.viewInContext.logsFromFileTitle",defaultMessage:"Displayed logs are from file {file} and host {host}",values:{file:i.a.createElement(d.EuiToolTip,{content:e["log.file.path"]},i.a.createElement("span",null,a)),host:e["host.name"]}})}return i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(d.EuiTextColor,{color:"subdued"},t)))};var Xt=a(141),Kt=a(73),ea=a.n(Kt),ta=a(207),aa=a.n(ta);const na=({isExpanded:e,item:t,onCollapse:a,onExpand:r})=>{const o=Object(n.useCallback)((()=>e?a(t):r(t)),[e,t,a,r]);return i.a.createElement(d.EuiButtonIcon,{onClick:o,"aria-label":e?ia:ra,iconType:e?"arrowUp":"arrowDown"})},ia=f.i18n.translate("xpack.infra.table.collapseRowLabel",{defaultMessage:"Collapse"}),ra=f.i18n.translate("xpack.infra.table.expandRowLabel",{defaultMessage:"Expand"});var oa=a(168);const sa=({datasets:e})=>i.a.createElement("ul",null,e.map((e=>{const t=Object(O.j)(e.name);return i.a.createElement("li",{key:t},i.a.createElement(oa.a,{anomalyScore:e.maximumAnomalyScore}))})));var la=a(102);const ca=({categoryId:e,endTime:t,exampleCount:a,sourceId:i,startTime:r})=>{const{services:o}=Object(_e.b)(),[s,l]=Object(n.useState)([]),[c,u]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,categoryId:r,exampleCount:o}=e,s=await t(la.f,{method:"POST",body:JSON.stringify(la.t.encode({data:{categoryId:r,exampleCount:o,sourceId:a,timeRange:{startTime:n,endTime:i}}}))});return Object(F.b)(la.u)(s)})({sourceId:i,startTime:r,endTime:t,categoryId:e,exampleCount:a},o.http.fetch),onResolve:({data:{examples:e}})=>{l(e)}},[e,t,a,i,r]),d=Object(n.useMemo)((()=>"pending"===c.state),[c.state]);return{getLogEntryCategoryExamples:u,hasFailedLoadingLogEntryCategoryExamples:Object(n.useMemo)((()=>"rejected"===c.state),[c.state]),isLoadingLogEntryCategoryExamples:d,logEntryCategoryExamples:s}},ua=({onReload:e})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleEmptyDescription",defaultMessage:"No examples found within the selected time range. Increase the log entry retention period to improve message sample availability."})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{onClick:e,size:"s"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleEmptyReloadButtonLabel",defaultMessage:"Reload"})))),da=({onRetry:e})=>i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,className:"eui-textNoWrap"},i.a.createElement(d.EuiTextColor,{color:"danger"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleLoadingFailureDescription",defaultMessage:"Failed to load examples."}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{onClick:e,size:"s"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryExamples.exampleLoadingFailureRetryButtonLabel",defaultMessage:"Retry"})))),ma=({exampleCount:e})=>i.a.createElement(i.a.Fragment,null,Array.from(new Array(e),((e,t)=>i.a.createElement(d.EuiLoadingContent,{key:t,lines:1})))),ga=({isLoading:e,hasFailedLoading:t,exampleCount:a,hasResults:n,onReload:r,children:o})=>i.a.createElement(fa,null,e?i.a.createElement(ma,{exampleCount:a}):t?i.a.createElement(da,{onRetry:r}):n?o:i.a.createElement(ua,{onReload:r})),fa=Lt.euiStyled.div`
  align-items: stretch;
  flex-direction: column;
  flex: 1 0 0%;
  overflow: hidden;
  padding-top: 1px; // Buffer for the "Reload" buttons' hover state
`;var ha=a(15),pa=a(151),ba=a(144);const ya=({id:e,dataset:t,message:a,timestamp:r,timeRange:o,tiebreaker:s,context:l})=>{const c=Object(Ie.useUiTracker)({app:"infra_logs"}),[,{setContextEntry:u}]=Object(n.useContext)(Vt.Context),d=Object(O.j)(t),[m,g]=Object(n.useState)(!1),h=Object(n.useCallback)((()=>g(!0)),[]),p=Object(n.useCallback)((()=>g(!1)),[]),[b,y]=Object(n.useState)(!1),E=Object(n.useCallback)((()=>y(!0)),[]),v=Object(n.useCallback)((()=>y(!1)),[]),x=Object(Ht.b)({app:"logs",pathname:"stream",search:{logPosition:Object(ha.encode)({end:kt()(o.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:{tiebreaker:s,time:r},start:kt()(o.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(ha.encode)({surroundingLogsId:e}),logFilter:Object(ha.encode)({expression:`${O.z}: ${t}`,kind:"kuery"})}});return i.a.createElement(pa.e,{scale:"medium",onMouseEnter:h,onMouseLeave:p},i.a.createElement(pa.a,Sa[va],i.a.createElement(pa.f,{format:"dateTime",time:r})),i.a.createElement(pa.a,Sa[xa],i.a.createElement(pa.d,{columnValue:{columnId:xa,message:[{field:"message",value:[a],highlights:[]}]},highlights:Ea,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,Sa[_a],i.a.createElement(pa.c,{columnValue:{columnId:_a,field:"event.dataset",value:[d],highlights:[]},highlights:Ea,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,Sa[Ma],m||b?i.a.createElement(ba.a,{isOpen:b,onOpen:E,onClose:v,items:[{label:f.i18n.translate("xpack.infra.logs.categoryExample.viewInStreamText",{defaultMessage:"View in stream"}),onClick:x.onClick,href:x.href},{label:f.i18n.translate("xpack.infra.logs.categoryExample.viewInContextText",{defaultMessage:"View in context"}),onClick:()=>{const t={id:e,index:"",context:l,cursor:{time:r,tiebreaker:s},columns:[]};c({metric:"view_in_context__categories"}),u(t)}}]}):null))},Ea=[],va="category-example-timestamp-column",xa="category-examples-message-column",_a="category-examples-dataset-column",Ma="category-examples-icon-column",Sa={[va]:{growWeight:0,shrinkWeight:0,baseWidth:"332px"},[xa]:{growWeight:1,shrinkWeight:0,baseWidth:"0%"},[_a]:{growWeight:0,shrinkWeight:0,baseWidth:"400px"},[Ma]:{growWeight:0,shrinkWeight:0,baseWidth:"32px"}},Ta=({categoryId:e,timeRange:t,sourceId:a})=>{const{getLogEntryCategoryExamples:r,hasFailedLoadingLogEntryCategoryExamples:o,isLoadingLogEntryCategoryExamples:s,logEntryCategoryExamples:l}=ca({categoryId:e,endTime:t.endTime,exampleCount:5,sourceId:a,startTime:t.startTime});return Object(n.useEffect)((()=>{r()}),[r]),i.a.createElement(ga,{isLoading:s,hasFailedLoading:o,hasResults:l.length>0,exampleCount:5,onReload:r},l.map(((e,a)=>i.a.createElement(ya,{key:a,id:e.id,dataset:e.dataset,message:e.message,timeRange:t,timestamp:e.timestamp,tiebreaker:e.tiebreaker,context:e.context}))))},Ca=Object(n.memo)((({maximumSegmentCount:e=30,regularExpression:t})=>{const a=t.split(ka);return i.a.createElement(Oa,null,a.slice(0,e).map(((e,t)=>[t>0?i.a.createElement(ja,{key:`wildcard-${t}`},"⁕"):null,i.a.createElement(wa,{key:`segment-${t}`},e.replace(Ia,"$1"))])),a.length>e?i.a.createElement(ja,{title:f.i18n.translate("xpack.infra.logs.logEntryCategories.truncatedPatternSegmentDescription",{defaultMessage:"{extraSegmentCount, plural, one {one more segment} other {# more segments}}",values:{extraSegmentCount:a.length-e}})},"…"):null)})),Oa=Lt.euiStyled.span`
  font-family: ${e=>e.theme.eui.euiCodeFontFamily};
  word-break: break-all;
`,ja=Lt.euiStyled.span`
  color: ${e=>e.theme.eui.euiColorMediumShade};
`,wa=Lt.euiStyled.span`
  font-weight: bold;
`,ka=/\.[+*]\??/g,Ia=/\\([\\^$*+?.()\[\]])/g;var Fa=a(71),La=a(140);const Da=({categorizationJobId:e,categoryId:t,dataset:a,timeRange:r})=>{const{services:{ml:o,http:s,application:l}}=Object(_e.b)(),c=Object(Fa.useMlHref)(o,s.basePath.get(),{page:Fa.ML_PAGES.SINGLE_METRIC_VIEWER,pageState:{jobIds:[e],timeRange:{from:kt()(r.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(r.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"},entities:{[La.i]:a,mlcategory:`${t}`}}}),u=Object(n.useCallback)((e=>{c&&Object(Ht.a)(e)&&l.navigateToUrl(c)}),[l,c]);return i.a.createElement(d.EuiToolTip,{content:Ra,delay:"long"},i.a.createElement(d.EuiButtonIcon,{"aria-label":Pa,iconType:"machineLearningApp","data-test-subj":"analyzeCategoryDatasetInMlButton",href:c,onClick:u}))},Pa=f.i18n.translate("xpack.infra.logs.logEntryCategories.analyzeCategoryInMlButtonLabel",{defaultMessage:"Analyze in ML"}),Ra=f.i18n.translate("xpack.infra.logs.logEntryCategories.analyzeCategoryInMlTooltipDescription",{defaultMessage:"Analyze this category in the ML app."}),Na=({categorizationJobId:e,categoryId:t,datasets:a,timeRange:n})=>i.a.createElement("ul",null,a.map((a=>{const r=Object(O.j)(a.name);return i.a.createElement("li",{key:r},i.a.createElement(Da,{categorizationJobId:e,categoryId:t,dataset:a.name,timeRange:n}))}))),Aa=({datasets:e})=>i.a.createElement("ul",null,e.map((e=>{const t=Object(O.j)(e.name);return i.a.createElement("li",{key:t},i.a.createElement(Ha,null,t))}))),Ha=Lt.euiStyled.div`
  display: inline-block;
  margin-bottom: 2.5px;
  margin-top: 1px;
`,Ua=({currentValue:e,previousValue:t})=>{const a=e/t-1;return a<0?i.a.createElement(Ya,null,i.a.createElement(d.EuiIcon,{type:"sortDown",color:"danger"}),i.a.createElement(d.EuiTextColor,{color:"danger"},za(a))):a>0&&Number.isFinite(a)?i.a.createElement(Ya,null,i.a.createElement(d.EuiIcon,{type:"sortUp",color:"success"}),i.a.createElement(d.EuiTextColor,{color:"success"},za(a))):a>0&&!Number.isFinite(a)?i.a.createElement(Ya,null,i.a.createElement(d.EuiIcon,{type:"sortUp",color:"success"}),i.a.createElement(d.EuiTextColor,{color:"success"},Ja)):null},za=e=>ea()(e).format("+0,0 %"),Ja=f.i18n.translate("xpack.infra.logs.logEntryCategories.newCategoryTrendLabel",{defaultMessage:"new"}),Ya=Lt.euiStyled.span`
  white-space: nowrap;
`;var Ba=a(67),Va=a(78),$a=a(110),qa=a(116);const Wa=["value"],Ga={height:20,width:100},Qa=({metric:e,timeRange:t})=>{const[a]=Object($a.a)("theme:darkMode"),r=Object(qa.a)(),o=Object(n.useMemo)((()=>[Va.EUI_SPARKLINE_THEME_PARTIAL,a?Va.EUI_CHARTS_THEME_DARK.theme:Va.EUI_CHARTS_THEME_LIGHT.theme]),[a]),s=Object(n.useMemo)((()=>({max:t.endTime,min:t.startTime})),[t]);return i.a.createElement(Ba.Chart,{size:Ga},i.a.createElement(Ba.Settings,{showLegend:!1,theme:o,tooltip:Ba.TooltipType.None,xDomain:s}),i.a.createElement(Ba.AreaSeries,{id:"metric",data:e,xAccessor:"timestamp",xScaleType:Ba.ScaleType.Time,yAccessors:Wa,timeZone:r}))},Za=({currentCount:e,histograms:t,timeRange:a})=>{const r=Object(n.useMemo)((()=>{var e,a,n;return null!==(e=null===(a=t.find((e=>"history"===e.histogramId)))||void 0===a||null===(n=a.buckets)||void 0===n?void 0:n.map((({startTime:e,logEntryCount:t})=>({timestamp:e,value:t}))))&&void 0!==e?e:[]}),[t]),o=Object(n.useMemo)((()=>{var e,a,n,i;return null!==(e=null===(a=t.find((e=>"reference"===e.histogramId)))||void 0===a||null===(n=a.buckets)||void 0===n||null===(i=n[0])||void 0===i?void 0:i.logEntryCount)&&void 0!==e?e:0}),[t]),s=Object(n.useMemo)((()=>({endTime:a.endTime,startTime:a.startTime-(a.endTime-a.startTime)})),[a.endTime,a.startTime]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Qa,{metric:r,timeRange:s}),i.a.createElement(Ua,{previousValue:o,currentValue:e}))},Xa=Object(Lt.euiStyled)((({categorizationJobId:e,className:t,sourceId:a,timeRange:r,topCategories:o,sortOptions:s,changeSortOptions:l})=>{const c=Object(n.useMemo)((()=>({sort:s})),[s]),u=Object(n.useCallback)((({sort:e={}})=>{l(e)}),[l]),[m,{add:g,remove:f}]=aa()(new Set),h=Object(n.useMemo)((()=>Ka(r,e,m,g,f)),[e,f,g,m,r]),p=Object(n.useMemo)((()=>[...m].reduce(((e,t)=>({...e,[t]:i.a.createElement(Ta,{categoryId:t,sourceId:a,timeRange:r})})),{})),[m,a,r]);return i.a.createElement(d.EuiBasicTable,{columns:h,itemIdToExpandedRowMap:p,itemId:"categoryId",items:o,rowProps:{className:`${t} euiTableRow--topAligned`},onChange:u,sorting:c})}))`
  &.euiTableRow--topAligned .euiTableRowCell {
    vertical-align: top;
  }
`,Ka=(e,t,a,n,r)=>[{align:"right",field:"logEntryCount",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.countColumnTitle",{defaultMessage:"Message count"}),sortable:!0,render:e=>ea()(e).format("0,0"),width:"120px"},{field:"histograms",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.trendColumnTitle",{defaultMessage:"Trend"}),render:(t,a)=>i.a.createElement(Za,{currentCount:a.logEntryCount,histograms:t,timeRange:e}),width:"220px"},{field:"regularExpression",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.categoryColumnTitle",{defaultMessage:"Category"}),truncateText:!0,render:e=>i.a.createElement(Ca,{regularExpression:e})},{field:"datasets",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.datasetColumnTitle",{defaultMessage:"Datasets"}),render:e=>i.a.createElement(Aa,{datasets:e}),width:"200px"},{align:"right",field:"maximumAnomalyScore",name:f.i18n.translate("xpack.infra.logs.logEntryCategories.maximumAnomalyScoreColumnTitle",{defaultMessage:"Maximum anomaly score"}),sortable:!0,render:(e,t)=>i.a.createElement(sa,{datasets:t.datasets}),width:"160px"},{actions:[{render:a=>i.a.createElement(Na,{categorizationJobId:t,categoryId:a.categoryId,datasets:a.datasets,timeRange:e})}],width:"40px"},{align:"right",isExpander:!0,render:e=>i.a.createElement(na,{isExpanded:a.has(e.categoryId),item:e.categoryId,onCollapse:r,onExpand:n}),width:"40px"}],en=({isLoadingTopCategories:e=!1,jobId:t,sourceId:a,timeRange:n,topCategories:r,sortOptions:o,changeSortOptions:s})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(Xt.a,{isLoading:e,loadingChildren:i.a.createElement(an,null)},i.a.createElement(Xa,{categorizationJobId:t,sourceId:a,timeRange:n,topCategories:r,sortOptions:o,changeSortOptions:s}))),tn=f.i18n.translate("xpack.infra.logs.logEntryCategories.topCategoriesSectionLoadingAriaLabel",{defaultMessage:"Loading message categories"}),an=()=>i.a.createElement(d.EuiLoadingSpinner,{size:"xl","aria-label":tn}),nn=({categoriesCount:e,filteredDatasets:t,endTime:a,onGetLogEntryCategoryDatasetsError:i,onGetTopLogEntryCategoriesError:r,sourceId:o,startTime:s})=>{const[l,c]=Object(n.useState)({field:"maximumAnomalyScore",direction:"desc"}),{services:u}=Object(_e.b)(),[d,m]=Object(n.useState)([]),[g,f]=Object(n.useState)([]),[h,p]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,categoryCount:r,datasets:o,sort:s}=e,l=i-n,c=await t(la.d,{method:"POST",body:JSON.stringify(la.p.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i},categoryCount:r,datasets:o,histograms:[{id:"history",timeRange:{startTime:n-l,endTime:i},bucketCount:10},{id:"reference",timeRange:{startTime:n-l,endTime:n},bucketCount:1}],sort:s}}))});return Object(F.b)(la.q)(c)})({sourceId:o,startTime:s,endTime:a,categoryCount:e,datasets:t,sort:l},u.http.fetch),onResolve:({data:{categories:e}})=>{m(e)},onReject:e=>{e instanceof Error&&!(e instanceof Me.a)&&r&&r(e)}},[e,a,t,o,s,l]),[b,y]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i}=e,r=await t(la.e,{method:"POST",body:JSON.stringify(la.r.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i}}}))});return Object(F.b)(la.s)(r)})({sourceId:o,startTime:s,endTime:a},u.http.fetch),onResolve:({data:{datasets:e}})=>{f(e)},onReject:e=>{e instanceof Error&&!(e instanceof Me.a)&&i&&i(e)}},[e,a,o,s]),E=Object(n.useMemo)((()=>"pending"===h.state),[h.state]),v=Object(n.useMemo)((()=>"pending"===b.state),[b.state]);return{getLogEntryCategoryDatasets:y,getTopLogEntryCategories:p,isLoading:Object(n.useMemo)((()=>E||v),[v,E]),isLoadingLogEntryCategoryDatasets:v,isLoadingTopLogEntryCategories:E,logEntryCategoryDatasets:g,topLogEntryCategories:d,sortOptions:l,changeSortOptions:c}};var rn=a(21),on=a(22),sn=a(28),ln=a(99),cn=a(126);const un=I.union([I.type({interval:I.number,isPaused:I.boolean}),I[void 0]]),dn=I.type({startTime:I.string,endTime:I.string}),mn=I.union([dn,I[void 0]]),gn={from:"now-2w",to:"now"},fn=({hasData:e=!0,"data-test-subj":t,...a})=>{const{services:{observability:{navigation:{PageTemplate:n}},docLinks:r}}=Object(_e.b)(),{http:o}=Object(y.useKibana)().services,s=o.basePath.get(),l=e?void 0:{solution:f.i18n.translate("xpack.infra.logs.noDataConfig.solutionName",{defaultMessage:"Observability"}),actions:{beats:{title:f.i18n.translate("xpack.infra.logs.noDataConfig.beatsCard.title",{defaultMessage:"Add a logging integration"}),description:f.i18n.translate("xpack.infra.logs.noDataConfig.beatsCard.description",{defaultMessage:"Use the Elastic Agent or Beats to send logs to Elasticsearch. We make it easy with integrations for many popular systems and apps."}),href:s+"/app/integrations/browse"}},docsLink:r.links.observability.guide};return i.a.createElement(n,g()({"data-test-subj":e?t:"noDataPage",noDataConfig:l},a))},hn=({availableDatasets:e,isLoading:t=!1,onChangeDatasetSelection:a,selectedDatasets:r})=>{const o=Object(n.useMemo)((()=>e.map((e=>({value:e,label:Object(O.j)(e)})))),[e]),s=Object(n.useMemo)((()=>o.filter((({value:e})=>null!=e&&r.includes(e)))),[o,r]),l=Object(n.useCallback)((e=>a(e.map((({value:e})=>e)).filter(bn))),[a]);return i.a.createElement(d.EuiComboBox,{"aria-label":pn,isLoading:t,onChange:l,options:o,placeholder:pn,selectedOptions:s})},pn=f.i18n.translate("xpack.infra.logs.analysis.datasetFilterPlaceholder",{defaultMessage:"Filter by datasets"}),bn=e=>null!=e,yn=({onOpenSetup:e,pageTitle:t})=>{Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_results"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_results",delay:15e3});const{services:{ml:a,http:r}}=Object(_e.b)(),{sourceStatus:o}=Object(x.c)(),{hasLogAnalysisSetupCapabilities:s}=gt(),{fetchJobStatus:l,fetchModuleDefinition:c,moduleDescriptor:u,setupStatus:m,hasOutdatedJobConfigurations:g,hasOutdatedJobDefinitions:f,hasStoppedJobs:h,jobIds:p,categoryQualityWarnings:b,sourceConfiguration:{sourceId:E}}=$e(),{timeRange:v,setTimeRange:_,autoRefresh:M,setAutoRefresh:S}=(()=>{const[e]=Object(cn.a)(gn),{from:t,to:a}=e(),[n,i]=Object(ln.b)({defaultState:{startTime:t,endTime:a},decodeUrlState:e=>Object(sn.pipe)(mn.decode(e),Object(rn.fold)(Object(on.constant)(void 0),on.identity)),encodeUrlState:mn.encode,urlStateKey:"timeRange",writeDefaultState:!0});Object(cn.b)(gn,{from:n.startTime,to:n.endTime});const[r,o]=Object(ln.b)({defaultState:{isPaused:!1,interval:6e4},decodeUrlState:e=>Object(sn.pipe)(un.decode(e),Object(rn.fold)(Object(on.constant)(void 0),on.identity)),encodeUrlState:un.encode,urlStateKey:"autoRefresh",writeDefaultState:!0});return{timeRange:n,setTimeRange:i,autoRefresh:r,setAutoRefresh:o}})(),[T,C]=Object(n.useState)((()=>({lastChangedTime:Date.now(),timeRange:En(v)}))),[O,j]=Object(n.useState)([]),{services:w}=Object(y.useKibana)(),k=Object(n.useCallback)((e=>{var t;null===(t=w.notifications)||void 0===t||t.toasts.addError(e,{title:vn})}),[w.notifications]),{getLogEntryCategoryDatasets:I,getTopLogEntryCategories:F,isLoadingLogEntryCategoryDatasets:L,isLoadingTopLogEntryCategories:D,logEntryCategoryDatasets:P,topLogEntryCategories:R,sortOptions:N,changeSortOptions:A}=nn({categoriesCount:25,endTime:T.timeRange.endTime,filteredDatasets:O,onGetTopLogEntryCategoriesError:k,sourceId:E,startTime:T.timeRange.startTime}),H=Object(n.useCallback)((({start:e,end:t})=>{C((a=>({...a,timeRange:En({startTime:e,endTime:t}),lastChangedTime:Date.now()})))}),[C]),U=Object(n.useCallback)((e=>{e.isInvalid||(_({startTime:e.start,endTime:e.end}),H(e))}),[_,H]),z=Object(n.useCallback)((({isPaused:e,refreshInterval:t})=>{S({isPaused:e,interval:t})}),[S]),J=Object(n.useMemo)((()=>R.length>0),[R.length]),Y=Object(n.useMemo)((()=>("skipped"===m.type&&!!m.newlyCreated||"succeeded"===m.type)&&!J),[J,m]);Object(n.useEffect)((()=>{F()}),[F,O,T.lastChangedTime,N]),Object(n.useEffect)((()=>{I()}),[I,T.lastChangedTime]),Object(n.useEffect)((()=>{c()}),[c]),Ft()((()=>{l()}),3e4),Ft()((()=>{H({start:v.startTime,end:v.endTime})}),M.isPaused?null:M.interval);const B=Object(Fa.useMlHref)(a,r.basePath.get(),{page:Fa.ML_PAGES.ANOMALY_EXPLORER,pageState:{jobIds:[p["log-entry-categories-count"]],timeRange:{from:kt()(T.timeRange.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(T.timeRange.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"}}});return i.a.createElement(Vt.Provider,{sourceId:E,startTimestamp:T.timeRange.startTime,endTimestamp:T.timeRange.endTime},i.a.createElement(fn,{hasData:"missing"!==(null==o?void 0:o.logIndexStatus),pageHeader:{pageTitle:t,rightSideItems:[i.a.createElement(ht.b,{hasSetupCapabilities:s,onClick:e,size:"s"}),i.a.createElement(Ut,{href:B})]}},i.a.createElement(d.EuiFlexGroup,{direction:"column"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,{justifyContent:"spaceBetween",alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(hn,{availableDatasets:P,isLoading:L,onChangeDatasetSelection:j,selectedDatasets:O})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiSuperDatePicker,{start:v.startTime,end:v.endTime,onTimeChange:U,isPaused:M.isPaused,refreshInterval:M.interval,onRefreshChange:z})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Fa.MLJobsAwaitingNodeWarning,{jobIds:Object.values(p)}),i.a.createElement(Bt,{hasOutdatedJobConfigurations:g,hasOutdatedJobDefinitions:f,hasSetupCapabilities:s,hasStoppedJobs:h,isFirstUse:Y,moduleName:u.moduleName,onRecreateMlJobForReconfiguration:e,onRecreateMlJobForUpdate:e,qualityWarnings:b})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(en,{isLoadingTopCategories:D,jobId:p["log-entry-categories-count"],sourceId:E,timeRange:T.timeRange,topCategories:R,sortOptions:N,changeSortOptions:A})))),i.a.createElement(Gt,null))},En=e=>({startTime:kt()(jt.a.parse(e.startTime,{momentInstance:kt.a})).valueOf(),endTime:kt()(jt.a.parse(e.endTime,{momentInstance:kt.a,roundUp:!0})).valueOf()}),vn=(Object(Lt.euiStyled)(d.EuiPage)`
  flex: 1 0 0%;
  flex-direction: column;

  .euiFlexGroup--responsive > .euiFlexItem {
    flex-basis: auto !important;
  }
`,f.i18n.translate("xpack.infra.logs.logEntryCategories.loadDataErrorTitle",{defaultMessage:"Failed to load category data"})),xn=({onOpenSetup:e})=>(Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_setup"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_categories_setup",delay:15e3}),i.a.createElement(d.EuiEmptyPrompt,{"data-test-subj":"logEntryCategoriesSetupPage",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.setupTitle",defaultMessage:"Set up log category analysis"})),body:i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.setupDescription",defaultMessage:"To enable log categories, set up a machine learning job."}))),actions:i.a.createElement(d.EuiButton,{fill:!0,onClick:e},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryCategories.showAnalysisSetupButtonLabel",defaultMessage:"ML setup"}))})),_n=f.i18n.translate("xpack.infra.logs.logCategoriesTitle",{defaultMessage:"Categories"}),Mn=()=>{const{hasLogAnalysisCapabilites:e,hasLogAnalysisReadCapabilities:t,hasLogAnalysisSetupCapabilities:a}=gt(),{fetchJobStatus:r,setupStatus:o,jobStatus:s}=$e(),{showModuleSetup:l}=xt(),c=Object(n.useCallback)((()=>l("logs_ui_categories")),[l]);return Object(n.useEffect)((()=>{t&&r()}),[r,t]),e?t?"initializing"===o.type?i.a.createElement(j.a,{message:f.i18n.translate("xpack.infra.logs.logEntryCategories.jobStatusLoadingMessage",{defaultMessage:"Checking status of categorization jobs..."})}):"unknown"===o.type?i.a.createElement(Tn,{isEmptyState:!0},i.a.createElement(w.a,{retry:r})):Object(O.p)(s["log-entry-categories-count"])?i.a.createElement(i.a.Fragment,null,i.a.createElement(yn,{onOpenSetup:c,pageTitle:_n}),i.a.createElement(Mt,{allowedModules:Sn})):a?i.a.createElement(i.a.Fragment,null,i.a.createElement(Tn,{isEmptyState:!0},i.a.createElement(xn,{onOpenSetup:c})),i.a.createElement(Mt,{allowedModules:Sn})):i.a.createElement(Tn,{isEmptyState:!0},i.a.createElement(w.c,null)):i.a.createElement(Tn,{isEmptyState:!0},i.a.createElement(w.b,null)):i.a.createElement(Ct.a,{"data-test-subj":"logsLogEntryCategoriesPage",pageHeader:{pageTitle:_n}})},Sn=["logs_ui_categories"],Tn=({children:e,...t})=>{const{sourceStatus:a}=Object(x.c)();return i.a.createElement(fn,g()({hasData:"missing"!==(null==a?void 0:a.logIndexStatus),"data-test-subj":"logsLogEntryCategoriesPage",pageHeader:t.isEmptyState?void 0:{pageTitle:_n}},t),e)};var Cn=a(74),On=a(8);const jn=({errors:e,onRetry:t})=>{const a=Object(Ht.b)({app:"logs",pathname:"/settings"});return i.a.createElement(fn,{isEmptyState:!0},i.a.createElement(d.EuiEmptyPrompt,{iconType:"alert",iconColor:"danger",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.failedToLoadSourceTitle",defaultMessage:"Failed to load configuration"})),body:i.a.createElement(i.a.Fragment,null,i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.failedToLoadSourceMessage",defaultMessage:"Errors occurred while attempting to load the configuration. Try again or change the configuration to fix the problem."})),e.map((e=>i.a.createElement(i.a.Fragment,{key:e.name},i.a.createElement(wn,{error:e}),i.a.createElement(d.EuiSpacer,null))))),actions:[i.a.createElement(d.EuiButton,{onClick:t,iconType:"refresh",fill:!0},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.tryAgainButtonLabel",defaultMessage:"Try again"})),i.a.createElement(d.EuiButtonEmpty,g()({iconType:"gear"},a),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.navigateToSettingsButtonLabel",defaultMessage:"Change configuration"}))]}))},wn=({error:e})=>{var t,a,n,r,o,s;return e instanceof On.d?i.a.createElement(kn,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.resolveLogSourceConfigurationErrorTitle",defaultMessage:"Failed to resolve the log source configuration"})},e.cause instanceof Cn.SavedObjectNotFound?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.savedObjectNotFoundErrorMessage",defaultMessage:"Failed to locate that {savedObjectType}: {savedObjectId}",values:{savedObjectType:e.cause.savedObjectType,savedObjectId:e.cause.savedObjectId}}):`${null!==(t=null===(a=e.cause)||void 0===a?void 0:a.message)&&void 0!==t?t:e.message}`):e instanceof On.a?i.a.createElement(kn,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.fetchLogSourceConfigurationErrorTitle",defaultMessage:"Failed to load the log source configuration"})},`${null!==(n=null===(r=e.cause)||void 0===r?void 0:r.message)&&void 0!==n?n:e.message}`):e instanceof On.b?i.a.createElement(kn,{title:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceErrorPage.fetchLogSourceStatusErrorTitle",defaultMessage:"Failed to determine the status of the log source"})},`${null!==(o=null===(s=e.cause)||void 0===s?void 0:s.message)&&void 0!==o?o:e.message}`):i.a.createElement(kn,{title:e.name},`${e.message}`)},kn=({title:e,children:t})=>i.a.createElement(d.EuiCallOut,{className:"eui-textLeft",color:"danger",iconType:"alert",title:e},i.a.createElement("p",null,t));var In=a(111),Fn=a(169);const Ln=({children:e})=>{const{hasFailedLoading:t,isLoading:a,isUninitialized:n,latestLoadSourceFailures:r,loadSource:o,resolvedSourceConfiguration:s,sourceId:l}=Object(x.c)(),{space:c}=Object(Fn.a)();return null==c?null:t?i.a.createElement(jn,{errors:r,onRetry:o}):a||n?i.a.createElement(In.a,null):null!=s?i.a.createElement(Ve,{indexPattern:s.indices,sourceId:l,spaceId:c.id,timestampField:s.timestampField,runtimeMappings:s.runtimeMappings},i.a.createElement(vt,null,e)):null},Dn=()=>(C([{text:T.c}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(Ln,null,i.a.createElement(Mn,null))));var Pn=a(23),Rn=a(124),Nn=a(203);const An=I.type({sourceId:I.string,logEntryId:I.string}),Hn=I.type({id:I.string,index:I.string,fields:I.array(Rn.e),cursor:Rn.d}),Un=I.intersection([I.type({data:I.union([Hn,I.null])}),I.partial({errors:I.array(Nn.a)})]);var zn=a(152);const Jn=Object(zn.b)(null,Object(F.b)(Un)),Yn=Object(Lt.euiStyled)(d.EuiFlyoutBody)`
  & .euiFlyoutBody__overflow {
    display: flex;
    flex-direction: column;
  }

  & .euiFlyoutBody__overflowContent {
    align-items: center;
    align-self: stretch;
    display: flex;
    flex-direction: column;
    flex-grow: 1;
    justify-content: center;
    overflow: hidden;
  }
`,Bn=({errors:e,onRetry:t,title:a})=>{const n=e.some((e=>"aborted"!==e.type))?"danger":"warning";return i.a.createElement(d.EuiCallOut,{color:n,iconType:"alert",title:a},null==e?void 0:e.map(((e,t)=>i.a.createElement(Vn,{key:t,error:e}))),t?i.a.createElement(d.EuiButton,{color:n,size:"s",onClick:t},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.dataSearch.loadingErrorRetryButtonLabel",defaultMessage:"Retry"})):null)},Vn=({error:e})=>"aborted"===e.type?i.a.createElement($n,{error:e}):"shardFailure"===e.type?i.a.createElement(Wn,{error:e}):i.a.createElement(qn,{error:e}),$n=({})=>i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.dataSearch.abortedRequestErrorMessage",defaultMessage:"The request was aborted."}),qn=({error:e})=>{var t;return i.a.createElement("p",null,null!==(t=e.message)&&void 0!==t?t:`${e}`)},Wn=({error:e})=>i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.dataSearch.shardFailureErrorMessage",defaultMessage:"Index {indexName}: {errorMessage}",values:{indexName:e.shardInfo.index,errorMessage:e.message}}),Gn=({label:e,maxValue:t,onCancel:a,value:r})=>{const o=Object(n.useMemo)((()=>Number.isFinite(t)&&Number.isFinite(r)?`${r} / ${t}`:void 0),[r,t]);return i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiProgress,{label:e,size:"s",max:t,value:r,valueText:o})),a?i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{color:"danger",iconType:"cross",onClick:a,title:Qn,"aria-label":Qn})):null)},Qn=f.i18n.translate("xpack.infra.dataSearch.cancelButtonLabel",{defaultMessage:"Cancel request"});var Zn=a(142);const Xn=["container.id","host.ip","kubernetes.pod.uid"],Kn=({logEntry:e})=>{const{hide:t,isVisible:a,show:r}=Object(Zn.a)(!1),o=Object(n.useMemo)((()=>ti(e)),[e]),s=Object(n.useMemo)((()=>ei(e)),[e]),l=Object(Ht.b)({app:"uptime",...s||{}}),c=Object(Ht.b)({app:"apm",...o||{}}),u=Object(n.useMemo)((()=>[i.a.createElement(d.EuiContextMenuItem,g()({"data-test-subj":"logEntryActionsMenuItem uptimeLogEntryActionsMenuItem",disabled:!s,icon:"uptimeApp",key:"uptimeLink"},l),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.uptimeActionLabel",defaultMessage:"View status in Uptime"})),i.a.createElement(d.EuiContextMenuItem,g()({"data-test-subj":"logEntryActionsMenuItem apmLogEntryActionsMenuItem",disabled:!o,icon:"apmApp",key:"apmLink"},c),i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.apmActionLabel",defaultMessage:"View in APM"}))]),[s,o,c,l]),m=Object(n.useMemo)((()=>u.length>0),[u]);return i.a.createElement(d.EuiPopover,{anchorPosition:"downRight",button:i.a.createElement(d.EuiButton,{"data-test-subj":"logEntryActionsMenuButton",disabled:!m,iconSide:"right",iconType:"arrowDown",onClick:r},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logEntryActionsMenu.buttonLabel",defaultMessage:"Investigate"})),closePopover:t,id:"logEntryActionsMenu",isOpen:a,panelPaddingSize:"none"},i.a.createElement(d.EuiContextMenuPanel,{items:u}))},ei=e=>{const t=e.fields.filter((({field:e,value:t})=>null!=t&&Xn.includes(e))).reduce(((e,t)=>{const{field:a,value:n}=t;return e.concat(n.map((e=>`${a}:${e}`)))}),[]);if(0!==t.length)return{app:"uptime",hash:"/",search:{search:`${t.join(" or ")}`}}},ti=e=>{var t,a;const n=null===(t=e.fields.find((({field:e,value:t})=>"string"==typeof t[0]&&"trace.id"===e)))||void 0===t||null===(a=t.value)||void 0===a?void 0:a[0];if("string"!=typeof n)return;const i=e.fields.find((({field:e})=>"@timestamp"===e)),r=i?i.value[0]:null,{rangeFrom:o,rangeTo:s}="number"==typeof r?(()=>{const e=new Date(r),t=new Date(r);return e.setMinutes(e.getMinutes()-10),t.setMinutes(t.getMinutes()+10),{rangeFrom:e.toISOString(),rangeTo:t.toISOString()}})():{rangeFrom:"now-1y",rangeTo:"now"};return{app:"apm",pathname:Object(Ie.getApmTraceUrl)({traceId:n,rangeFrom:o,rangeTo:s})}};var ai=a(129),ni=a(180);const ii=({logEntry:e,onSetFieldFilter:t})=>{const a=Object(n.useMemo)((()=>t?a=>()=>{I.array(ai.c).is(a.value)&&(null==t||t({language:"kuery",query:`${ui(a.field)}:${a.value.map(ui).join(" OR ")}`},e.id,e.cursor))}:void 0),[e,t]),r=Object(n.useMemo)((()=>[{field:"field",name:f.i18n.translate("xpack.infra.logFlyout.fieldColumnLabel",{defaultMessage:"Field"}),sortable:!0},{actions:[{type:"icon",icon:"filter",name:li,description:ci,available:()=>!!a,onClick:e=>null==a?void 0:a(e)()}]},{field:"value",name:f.i18n.translate("xpack.infra.logFlyout.valueColumnLabel",{defaultMessage:"Value"}),render:(e,t)=>i.a.createElement(ni.a,{highlightTerms:ri,isActiveHighlight:!1,value:t.value})}]),[a]);return i.a.createElement(d.EuiInMemoryTable,{columns:r,items:e.fields,search:si,sorting:oi})},ri=[],oi={sort:{field:"field",direction:"asc"}},si={box:{incremental:!0,schema:!0}},li=f.i18n.translate("xpack.infra.logFlyout.filterAriaLabel",{defaultMessage:"Filter"}),ci=f.i18n.translate("xpack.infra.logFlyout.setFilterTooltip",{defaultMessage:"View event with filter"}),ui=e=>"string"==typeof e?`"${e.replace(/"/g,'\\"')}"`:e,di=({logEntryId:e,onCloseFlyout:t,onSetFieldFilter:a,sourceId:r})=>{var o;const{cancelRequest:s,errors:l,fetchLogEntry:c,isRequestRunning:u,loaded:m,logEntry:g,total:f}=(({sourceId:e,logEntryId:t})=>{const{search:a,requests$:i}=Object(zn.c)({getRequest:Object(n.useCallback)((()=>t&&e?{request:{params:An.encode({sourceId:e,logEntryId:t})},options:{strategy:"infra-log-entry"}}:null),[e,t]),parseResponses:Jn}),{cancelRequest:r,isRequestRunning:o,isResponsePartial:s,latestResponseData:l,latestResponseErrors:c,loaded:u,total:d}=Object(zn.e)(i);return{cancelRequest:r,errors:c,fetchLogEntry:a,isRequestRunning:o,isResponsePartial:s,loaded:u,logEntry:null!=l?l:null,total:d}})({sourceId:r,logEntryId:e});return Object(n.useEffect)((()=>{r&&e&&c()}),[c,r,e]),i.a.createElement(d.EuiFlyout,{onClose:t,size:"m"},i.a.createElement(d.EuiFlyoutHeader,{hasBorder:!0},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",{id:"flyoutTitle"},i.a.createElement(k.FormattedMessage,{defaultMessage:"Details for log entry {logEntryId}",id:"xpack.infra.logFlyout.flyoutTitle",values:{logEntryId:e?i.a.createElement("code",null,e):""}}))),g?i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"s"}),i.a.createElement(d.EuiTextColor,{color:"subdued"},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logFlyout.flyoutSubTitle",defaultMessage:"From index {indexName}",values:{indexName:i.a.createElement("code",null,g.index)}}))):null),i.a.createElement(d.EuiFlexItem,{style:{padding:8},grow:!1},g?i.a.createElement(Kn,{logEntry:g}):null))),u?i.a.createElement(Yn,null,i.a.createElement("div",{style:{width:"75%"}},i.a.createElement(Gn,{label:mi,maxValue:f,onCancel:s,value:m}))):g?i.a.createElement(d.EuiFlyoutBody,{banner:(null!==(o=null==l?void 0:l.length)&&void 0!==o?o:0)>0?i.a.createElement(Bn,{title:gi,errors:null!=l?l:[],onRetry:c}):void 0},i.a.createElement(ii,{logEntry:g,onSetFieldFilter:a})):i.a.createElement(Yn,null,i.a.createElement("div",{style:{width:"75%"}},i.a.createElement(Bn,{title:gi,errors:null!=l?l:[],onRetry:c}))))},mi=f.i18n.translate("xpack.infra.logFlyout.loadingMessage",{defaultMessage:"Searching log entry in shards"}),gi=f.i18n.translate("xpack.infra.logFlyout.loadingErrorCalloutTitle",{defaultMessage:"Error while searching the log entry"});var fi=a(105);let hi;!function(e){e.hidden="hidden",e.visible="visible"}(hi||(hi={}));const pi=xe()((()=>{const[e,t]=Object(n.useState)(!1),[a,i]=Object(n.useState)(null),[r,o]=Object(n.useState)(null);return{isFlyoutOpen:e,closeFlyout:Object(n.useCallback)((()=>t(!1)),[]),openFlyout:Object(n.useCallback)((e=>{e&&i(e),t(!0)}),[]),logEntryId:a,setLogEntryId:i,surroundingLogsId:r,setSurroundingLogsId:o}})),[bi,yi]=pi,Ei=()=>{const{isFlyoutOpen:e,openFlyout:t,closeFlyout:a,logEntryId:n,setLogEntryId:r,surroundingLogsId:o,setSurroundingLogsId:s}=yi();return i.a.createElement(fi.a,{urlState:{flyoutVisibility:e?hi.visible:hi.hidden,flyoutId:n,surroundingLogsId:o},urlStateKey:"flyoutOptions",mapToUrlState:vi,onChange:e=>{e&&e.flyoutId&&r(e.flyoutId),e&&e.surroundingLogsId&&s(e.surroundingLogsId),e&&e.flyoutVisibility===hi.visible&&t(),e&&e.flyoutVisibility===hi.hidden&&a()},onInitialize:e=>{e&&e.flyoutId&&r(e.flyoutId),e&&e.surroundingLogsId&&s(e.surroundingLogsId),e&&e.flyoutVisibility===hi.visible&&t(),e&&e.flyoutVisibility===hi.hidden&&a()}})},vi=e=>e?{flyoutId:xi(e.flyoutId),flyoutVisibility:Mi(e.flyoutVisibility),surroundingLogsId:_i(e.surroundingLogsId)}:void 0,xi=e=>e&&Object(qe.isString)(e)?e:void 0,_i=e=>e&&Object(qe.isString)(e)?e:void 0,Mi=e=>{if(e){if("visible"===e)return hi.visible;if("hidden"===e)return hi.hidden}};var Si=a(47),Ti=a(103);const Ci=({embeddableType:e})=>i.a.createElement(d.EuiCallOut,{size:"s",color:"warning",title:f.i18n.translate("xpack.infra.missingEmebeddableFactoryCallout",{defaultMessage:"{embeddableType} embeddable is unavailable. This can happen if the embeddable plugin isn't enabled.",values:{embeddableType:e}})}),Oi={pause:!0,value:0},ji=e=>{const{embeddable:t}=Object(_e.b)().services;return t?i.a.createElement(wi,e):null},wi=({timeRange:e,jobIds:t,selectedDatasets:a})=>{const{embeddable:r}=Object(_e.b)().services,o=null==r?void 0:r.getEmbeddableFactory(Fa.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE),s=Object(n.useMemo)((()=>({id:"LOG_ENTRY_ANOMALIES_EMBEDDABLE_INSTANCE",jobIds:t,swimlaneType:"viewBy",timeRange:{from:kt()(e.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(e.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ")},refreshConfig:Oi,viewBy:Ti.i,filters:[],query:{language:"kuery",query:a.map((e=>`${Ti.i} : ${""!==e?e:'""'}`)).join(" or ")}})),[t,e.startTime,e.endTime,a]);return o?i.a.createElement(Si.EmbeddableRenderer,{input:s,factory:o}):i.a.createElement(Ci,{embeddableType:Fa.ANOMALY_SWIMLANE_EMBEDDABLE_TYPE})};var ki=a(79);const Ii=({dataset:e,endTime:t,exampleCount:a,sourceId:i,startTime:r,categoryId:o})=>{const{services:s}=Object(_e.b)(),[l,c]=Object(n.useState)([]),[u,d]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,dataset:r,exampleCount:o,categoryId:s}=e,l=await t(la.g,{method:"POST",body:JSON.stringify(la.v.encode({data:{dataset:r,exampleCount:o,sourceId:a,timeRange:{startTime:n,endTime:i},categoryId:s}}))});return Object(F.b)(la.w)(l)})({sourceId:i,startTime:r,endTime:t,dataset:e,exampleCount:a,categoryId:o},s.http.fetch),onResolve:({data:{examples:e}})=>{c(e)}},[e,t,a,i,r]),m=Object(n.useMemo)((()=>"pending"===u.state),[u.state]);return{getLogEntryExamples:d,hasFailedLoadingLogEntryExamples:Object(n.useMemo)((()=>"rejected"===u.state),[u.state]),isLoadingLogEntryExamples:m,logEntryExamples:l}};var Fi=a(205);const Li=e=>null!=e&&"messageColumn"in e,Di=e=>null!=e&&"timestampColumn"in e;var Pi=a(167);const Ri=f.i18n.translate("xpack.infra.logAnomalies.logEntryExamplesMenuLabel",{defaultMessage:"View actions for log entry"}),Ni=f.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewDetailsLabel",{defaultMessage:"View details"}),Ai=f.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewInStreamLabel",{defaultMessage:"View in stream"}),Hi=f.i18n.translate("xpack.infra.logs.analysis.logEntryExamplesViewAnomalyInMlLabel",{defaultMessage:"View anomaly in machine learning"}),Ui=({id:e,dataset:t,message:a,timestamp:r,tiebreaker:o,timeRange:s,anomaly:l})=>{const{services:{ml:c,http:u,application:d}}=Object(_e.b)(),[m,f]=Object(n.useState)(!1),[h,p]=Object(n.useState)(!1),b=Object(n.useCallback)((()=>p(!0)),[]),y=Object(n.useCallback)((()=>p(!1)),[]),E=Object(n.useCallback)((()=>f(!0)),[]),v=Object(n.useCallback)((()=>f(!1)),[]),{openFlyout:x}=yi(),_=Object(O.j)(t),M=Object(Ht.b)({app:"logs",pathname:"stream",search:{logPosition:Object(ha.encode)({end:kt()(s.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:{tiebreaker:o,time:r},start:kt()(s.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(ha.encode)({surroundingLogsId:e}),...t?{logFilter:Object(ha.encode)({expression:`${La.i}: ${t}`,kind:"kuery"})}:{}}}),S=Object(Fa.useMlHref)(c,u.basePath.get(),{page:Fa.ML_PAGES.SINGLE_METRIC_VIEWER,pageState:{jobIds:[l.jobId],timeRange:{from:kt()(s.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),to:kt()(s.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),mode:"absolute"},entities:{[La.i]:t,...Object(O.n)(l)?{mlcategory:l.categoryId}:{}}}}),T=Object(n.useCallback)((e=>{S&&Object(Ht.a)(e)&&d.navigateToUrl(S)}),[S,d]),C=Object(n.useMemo)((()=>{if(M.onClick&&S)return[{label:Ni,onClick:()=>{x(e)}},{label:Ai,onClick:M.onClick,href:M.href},{label:Hi,onClick:T,href:S}]}),[e,x,M,S,T]);return i.a.createElement(pa.e,{scale:"medium",onMouseEnter:E,onMouseLeave:v},i.a.createElement(pa.a,Vi[Ji],i.a.createElement(pa.f,{format:"time",time:r})),i.a.createElement(pa.a,Vi[Yi],i.a.createElement(pa.d,{columnValue:{columnId:Yi,message:[{field:"message",value:[a],highlights:[]}]},highlights:zi,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,Vi[Bi],i.a.createElement(pa.c,{columnValue:{columnId:Bi,field:"event.dataset",value:[_],highlights:[]},highlights:zi,isActiveHighlight:!1,wrapMode:"none"})),i.a.createElement(pa.a,g()({key:"logColumn iconLogColumn iconLogColumn:details"},Vi[pa.h]),(m||h)&&C?i.a.createElement(pa.b,{"aria-label":Ri,isOpen:h,onOpen:b,onClose:y,items:C}):null))},zi=[],Ji="log-entry-example-timestamp-column",Yi="log-entry-examples-message-column",Bi="log-entry-examples-dataset-column",Vi={[Ji]:{growWeight:0,shrinkWeight:0,baseWidth:"122px"},[Yi]:{growWeight:1,shrinkWeight:0,baseWidth:"0%"},[Bi]:{growWeight:0,shrinkWeight:0,baseWidth:"250px"},[pa.h]:{growWeight:0,shrinkWeight:0,baseWidth:"48px"}},$i=[{timestampColumn:{id:Ji}},{messageColumn:{id:Yi}},{fieldColumn:{field:"event.dataset",id:Bi}}],qi=({dateTime:e})=>i.a.createElement(Wi,null,i.a.createElement(i.a.Fragment,null,$i.map((t=>{return Di(t)?i.a.createElement(Fi.a,{key:t.timestampColumn.id,columnWidth:Vi[t.timestampColumn.id],"data-test-subj":"logColumnHeader timestampLogColumnHeader"},Object(Pi.a)(e)):Li(t)?i.a.createElement(Fi.a,{columnWidth:Vi[t.messageColumn.id],"data-test-subj":"logColumnHeader messageLogColumnHeader",key:t.messageColumn.id},"Message"):null!=(a=t)&&"fieldColumn"in a?i.a.createElement(Fi.a,{columnWidth:Vi[t.fieldColumn.id],"data-test-subj":"logColumnHeader fieldLogColumnHeader",key:t.fieldColumn.id},t.fieldColumn.field):void 0;var a})),i.a.createElement(Fi.a,{columnWidth:Vi[pa.h],"data-test-subj":"logColumnHeader contextMenuLogColumnHeader",key:"icon-column-header"},null))),Wi=Object(Lt.euiStyled)(Fi.c)`
  border-bottom: none;
  box-shadow: none;
  padding-right: 0;
`,Gi=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableExamplesTitle",{defaultMessage:"Example log entries"}),Qi=({anomaly:e,timeRange:t})=>{const{sourceId:a}=Object(x.c)(),{getLogEntryExamples:n,hasFailedLoadingLogEntryExamples:r,isLoadingLogEntryExamples:o,logEntryExamples:s}=Ii({dataset:e.dataset,endTime:e.startTime+e.duration,exampleCount:5,sourceId:a,startTime:e.startTime,categoryId:Object(O.n)(e)?e.categoryId:void 0});return p()((()=>{n()})),i.a.createElement(i.a.Fragment,null,i.a.createElement(Zi,{direction:"column"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"xs"},i.a.createElement("h3",null,Gi))),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(ga,{isLoading:o,hasFailedLoading:r,hasResults:s.length>0,exampleCount:5,onReload:n},s.length>0?i.a.createElement(i.a.Fragment,null,i.a.createElement(qi,{dateTime:s[0].timestamp}),s.map(((a,n)=>i.a.createElement(Ui,{key:n,id:a.id,dataset:a.dataset,message:a.message,timestamp:a.timestamp,tiebreaker:a.tiebreaker,timeRange:t,anomaly:e})))):null)),i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiStat,{titleSize:"xs",title:`${ea()(e.typical).format("0.[00]a")} ${f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowTypicalRateTitle",{defaultMessage:"{typicalCount, plural, one {message} other {messages}}",values:{typicalCount:e.typical}})}`,description:f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowTypicalRateDescription",{defaultMessage:"Typical"})})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiStat,{titleSize:"xs",title:`${ea()(e.actual).format("0.[00]a")} ${f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowActualRateTitle",{defaultMessage:"{actualCount, plural, one {message} other {messages}}",values:{actualCount:e.actual}})}`,description:f.i18n.translate("xpack.infra.logs.analysis.anomaliesExpandedRowActualRateDescription",{defaultMessage:"Actual"})}))))))},Zi=Object(Lt.euiStyled)(d.EuiFlexGroup)`
  overflow: hidden;
`,Xi=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyScoreColumnName",{defaultMessage:"Anomaly score"}),Ki=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyMessageName",{defaultMessage:"Anomaly"}),er=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyStartTime",{defaultMessage:"Start time"}),tr=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableAnomalyDatasetName",{defaultMessage:"Dataset"}),ar=({results:e,timeRange:t,changeSortOptions:a,sortOptions:r,changePaginationOptions:o,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:c,page:u,isLoading:m})=>{const[g]=Object($a.a)("dateFormat","Y-MM-DD HH:mm:ss"),f=Object(n.useMemo)((()=>({sort:r})),[r]),h=Object(n.useMemo)((()=>e.map((e=>({id:e.id,dataset:e.dataset,anomalyScore:e.anomalyScore,startTime:e.startTime,type:e.type,typical:e.typical,actual:e.actual,categoryRegex:Object(O.n)(e)?e.categoryRegex:void 0})))),[e]),[p,{add:b,remove:y}]=aa()(new Set),E=Object(n.useMemo)((()=>[...p].reduce(((a,n)=>{const r=e.find((e=>e.id===n));return{...a,[n]:r?i.a.createElement(Qi,{anomaly:r,timeRange:t}):null}}),{})),[p,e,t]),v=Object(n.useCallback)((({sort:e={}})=>{a(e)}),[a]),x=Object(n.useMemo)((()=>[{field:"anomalyScore",name:Xi,sortable:!0,truncateText:!0,dataType:"number",width:"130px",render:e=>i.a.createElement(oa.a,{anomalyScore:e})},{name:Ki,truncateText:!0,render:e=>i.a.createElement(nr,{anomaly:e})},{field:"startTime",name:er,sortable:!0,truncateText:!0,width:"230px",render:e=>kt()(e).format(g)},{field:"dataset",name:tr,sortable:!0,truncateText:!0,width:"200px",render:e=>Object(O.j)(e)},{align:ki.RIGHT_ALIGNMENT,width:"40px",isExpander:!0,render:e=>i.a.createElement(na,{isExpanded:p.has(e.id),item:e.id,onExpand:b,onCollapse:y})}]),[y,b,p,g]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(Xt.a,{isLoading:m},i.a.createElement(d.EuiBasicTable,{items:h,itemId:"id",itemIdToExpandedRowMap:E,isExpandable:!0,hasActions:!0,columns:x,sorting:f,onChange:v}),i.a.createElement(d.EuiSpacer,{size:"l"}),i.a.createElement(or,{fetchNextPage:l,fetchPreviousPage:c,page:u,isLoading:m})))},nr=({anomaly:e})=>{const{type:t,actual:a,typical:n}=e,r=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableMoreThanExpectedAnomalyMessage",{defaultMessage:"more log messages in this {type, select, logRate {dataset} logCategory {category}} than expected",values:{type:t}}),o=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableFewerThanExpectedAnomalyMessage",{defaultMessage:"fewer log messages in this {type, select, logRate {dataset} logCategory {category}} than expected",values:{type:t}}),s=a>n,l=s?r:o,c=s?a/n:n/a,u=s?"sortUp":"sortDown",m=c!==1/0?`${Object(O.h)(c)}x`:"";return i.a.createElement(d.EuiFlexGroup,{gutterSize:"s",responsive:!1,alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1,component:"span"},i.a.createElement(d.EuiIcon,{type:u})),i.a.createElement(d.EuiFlexItem,{component:"span"},`${m} ${l}`,e.categoryRegex&&i.a.createElement(i.a.Fragment,null,": ",i.a.createElement(Ca,{regularExpression:e.categoryRegex}))))},ir=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTablePreviousPageLabel",{defaultMessage:"Previous page"}),rr=f.i18n.translate("xpack.infra.logs.analysis.anomaliesTableNextPageLabel",{defaultMessage:"Next page"}),or=({fetchPreviousPage:e,fetchNextPage:t,page:a,isLoading:n})=>i.a.createElement(d.EuiFlexGroup,{justifyContent:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiButtonIcon,{iconType:"arrowLeft",isDisabled:!e||n,onClick:e,"aria-label":ir}),i.a.createElement("span",null,i.a.createElement("strong",null,a)),i.a.createElement(d.EuiButtonIcon,{iconType:"arrowRight",isDisabled:!t||n,onClick:t,"aria-label":rr})))),sr=({isLoadingAnomaliesResults:e,timeRange:t,anomalies:a,changeSortOptions:n,sortOptions:r,changePaginationOptions:o,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:c,page:u,selectedDatasets:m,jobIds:g,autoRefresh:h})=>i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(ji,{jobIds:g,timeRange:t,selectedDatasets:m,autoRefresh:h}))),i.a.createElement(d.EuiSpacer,{size:"l"}),i.a.createElement(i.a.Fragment,null,a&&0!==a.length?i.a.createElement(ar,{results:a,timeRange:t,changeSortOptions:n,changePaginationOptions:o,sortOptions:r,paginationOptions:s,fetchNextPage:l,fetchPreviousPage:c,page:u,isLoading:e}):i.a.createElement(Xt.a,{isLoading:e,loadingChildren:i.a.createElement(cr,null)},i.a.createElement(d.EuiEmptyPrompt,{title:i.a.createElement("h2",null,f.i18n.translate("xpack.infra.logs.analysis.anomalySectionNoDataTitle",{defaultMessage:"There is no data to display."})),titleSize:"m",body:i.a.createElement("p",null,f.i18n.translate("xpack.infra.logs.analysis.anomalySectionNoDataBody",{defaultMessage:"You may want to adjust your time range."}))})))),lr=f.i18n.translate("xpack.infra.logs.analysis.anomaliesSectionLoadingAriaLabel",{defaultMessage:"Loading anomalies"}),cr=()=>i.a.createElement(d.EuiLoadingSpinner,{size:"xl","aria-label":lr}),ur={selectedDatasets:[],selectedDatasetsFilters:[]};function dr(e,t){switch(t.type){case"changeSelectedDatasets":return{...e,selectedDatasets:t.payload.datasets};case"updateDatasetsFilters":const a=t.payload.filters.filter((t=>!e.selectedDatasets.includes(t.meta.params.query))).map((e=>e.meta.params.query));return{...e,selectedDatasets:[...e.selectedDatasets,...a],selectedDatasetsFilters:t.payload.filters};default:throw new Error("Unknown action")}}const mr=(e,t)=>{const a={page:1,paginationCursor:void 0};switch(t.type){case"changePaginationOptions":case"changeSortOptions":return{...e,...a,...t.payload};case"changeHasNextPage":case"changeLastReceivedCursors":return{...e,...t.payload};case"fetchNextPage":return e.lastReceivedCursors?{...e,page:e.page+1,paginationCursor:{searchAfter:e.lastReceivedCursors.nextPageCursor}}:e;case"fetchPreviousPage":return e.lastReceivedCursors?{...e,page:e.page-1,paginationCursor:{searchBefore:e.lastReceivedCursors.previousPageCursor}}:e;case"changeTimeRange":case"changeFilteredDatasets":return{...e,...a,...t.payload};default:return e}},gr={page:1,lastReceivedCursors:void 0,paginationCursor:void 0,hasNextPage:!1},fr=({endTime:e,startTime:t,sourceId:a,defaultSortOptions:i,defaultPaginationOptions:r,onGetLogEntryAnomaliesDatasetsError:o,filteredDatasets:s})=>{const{services:l}=Object(_e.b)(),[c,u]=Object(n.useReducer)(mr,gr,(a=>({...a,paginationOptions:r,sortOptions:i,filteredDatasets:s,timeRange:{start:t,end:e}}))),[d,m]=Object(n.useState)([]),[g,f]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>{const{timeRange:{start:e,end:t},sortOptions:n,paginationOptions:i,paginationCursor:r,filteredDatasets:o}=c;return await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i,sort:r,pagination:o,datasets:s}=e,l=await t(la.c,{method:"POST",body:JSON.stringify(la.n.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i},sort:r,pagination:o,datasets:s}}))});return Object(F.b)(la.o)(l)})({sourceId:a,startTime:e,endTime:t,sort:n,pagination:{...i,cursor:r},datasets:o},l.http.fetch)},onResolve:({data:{anomalies:e,paginationCursors:t,hasMoreEntries:a}})=>{const{paginationCursor:n}=c;t&&u({type:"changeLastReceivedCursors",payload:{lastReceivedCursors:t}}),!n||n&&"searchAfter"in n?u({type:"changeHasNextPage",payload:{hasNextPage:a}}):n&&"searchBefore"in n&&u({type:"changeHasNextPage",payload:{hasNextPage:!0}}),m(e)}},[a,u,c.timeRange,c.sortOptions,c.paginationOptions,c.paginationCursor,c.filteredDatasets]),h=Object(n.useCallback)((e=>{u({type:"changeSortOptions",payload:{sortOptions:e}})}),[u]),b=Object(n.useCallback)((e=>{u({type:"changePaginationOptions",payload:{paginationOptions:e}})}),[u]);Object(n.useEffect)((()=>{u({type:"changeTimeRange",payload:{timeRange:{start:t,end:e}}})}),[t,e]),Object(n.useEffect)((()=>{u({type:"changeFilteredDatasets",payload:{filteredDatasets:s}})}),[s]),Object(n.useEffect)((()=>{f()}),[f]);const y=Object(n.useCallback)((()=>{c.lastReceivedCursors&&u({type:"fetchNextPage"})}),[u,c]),E=Object(n.useCallback)((()=>{c.lastReceivedCursors&&u({type:"fetchPreviousPage"})}),[u,c]),v=Object(n.useMemo)((()=>"pending"===g.state),[g.state]),x=Object(n.useMemo)((()=>"rejected"===g.state),[g.state]),[_,M]=Object(n.useState)([]),[S,T]=Object(Me.c)({cancelPreviousOn:"creation",createPromise:async()=>await(async(e,t)=>{const{sourceId:a,startTime:n,endTime:i}=e,r=await t(la.b,{method:"POST",body:JSON.stringify(la.l.encode({data:{sourceId:a,timeRange:{startTime:n,endTime:i}}}))});return Object(F.b)(la.m)(r)})({sourceId:a,startTime:t,endTime:e},l.http.fetch),onResolve:({data:{datasets:e}})=>{M(e)},onReject:e=>{e instanceof Error&&!(e instanceof Me.a)&&o&&o(e)}},[e,a,t]),C=Object(n.useMemo)((()=>"pending"===S.state),[S.state]),O=Object(n.useMemo)((()=>"rejected"===S.state),[S.state]);return p()((()=>{T()})),{logEntryAnomalies:d,getLogEntryAnomalies:f,isLoadingLogEntryAnomalies:v,isLoadingDatasets:C,hasFailedLoadingDatasets:O,datasets:_,hasFailedLoadingLogEntryAnomalies:x,changeSortOptions:h,sortOptions:c.sortOptions,changePaginationOptions:b,paginationOptions:c.paginationOptions,fetchPreviousPage:c.page>1?E:void 0,fetchNextPage:c.hasNextPage?y:void 0,page:c.page}},hr=I.type({interval:I.number,isPaused:I.boolean}),pr=I.union([hr,I[void 0]]),br=Object(F.b)(pr),yr={isPaused:!1,interval:3e4},Er=I.type({startTime:I.string,endTime:I.string}),vr=I.union([Er,I[void 0]]),xr=Object(F.b)(vr),_r={from:"now-2w",to:"now"},Mr=e=>({startTime:kt()(jt.a.parse(e.start,{momentInstance:kt.a})).valueOf(),endTime:kt()(jt.a.parse(e.end,{momentInstance:kt.a,roundUp:!0})).valueOf()}),Sr=e=>i.a.createElement(d.EuiButton,e,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.analysis.manageMlJobsButtonLabel",defaultMessage:"Manage ML jobs"})),Tr={direction:"desc",field:"anomalyScore"},Cr={pageSize:25},Or=({pageTitle:e})=>{var t;Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_results"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_results",delay:15e3});const a=null===(t=Object(y.useKibana)().services.application)||void 0===t?void 0:t.navigateToApp,{sourceId:r,sourceStatus:o}=Object(x.c)(),{hasLogAnalysisSetupCapabilities:s}=gt(),{hasOutdatedJobConfigurations:l,hasOutdatedJobDefinitions:c,hasStoppedJobs:u,moduleDescriptor:m,setupStatus:g,jobStatus:f,jobIds:h}=ot(),{categoryQualityWarnings:p,hasOutdatedJobConfigurations:b,hasOutdatedJobDefinitions:E,hasStoppedJobs:v,moduleDescriptor:_,setupStatus:M,jobStatus:S,jobIds:T}=$e(),C=Object(n.useMemo)((()=>[...Object(O.p)(f["log-entry-rate"])?[h["log-entry-rate"]]:[],...Object(O.p)(S["log-entry-categories-count"])?[T["log-entry-categories-count"]]:[]]),[h,T,f,S]),{timeRange:j,friendlyTimeRange:w,setTimeRange:k,autoRefresh:I,setAutoRefresh:F}=(()=>{const[e]=Object(cn.a)(_r),{from:t,to:a}=e(),i=Object(n.useMemo)((()=>({startTime:t,endTime:a})),[t,a]),[r,o]=Object(ln.b)({defaultState:i,decodeUrlState:xr,encodeUrlState:vr.encode,urlStateKey:"timeRange",writeDefaultState:!0}),[s,l]=Object(n.useState)((()=>({value:Mr({start:r.startTime,end:r.endTime}),lastChangedTime:Date.now()}))),c=Object(n.useCallback)((({start:e,end:t})=>{l({value:Mr({start:e,end:t}),lastChangedTime:Date.now()})}),[l]),u=Object(n.useCallback)((e=>{o({startTime:e.start,endTime:e.end}),c(e)}),[o,c]),d=Object(n.useCallback)((e=>{const{from:t,to:a}=e;u({start:t,end:a})}),[u]);Object(cn.b)(_r,{from:r.startTime,to:r.endTime},d);const[m,g]=Object(ln.b)({defaultState:yr,decodeUrlState:br,encodeUrlState:pr.encode,urlStateKey:"autoRefresh",writeDefaultState:!0});return Ft()((()=>{c({start:r.startTime,end:r.endTime})}),m.isPaused?null:m.interval),{timeRange:s,friendlyTimeRange:r,setTimeRange:u,autoRefresh:m,setAutoRefresh:g}})(),{closeFlyout:L,isFlyoutOpen:D,logEntryId:P}=yi(),R=Object(n.useCallback)(((e,t,n)=>{const i={logPosition:Object(ha.encode)({end:kt()(j.value.endTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),position:n,start:kt()(j.value.startTime).format("YYYY-MM-DDTHH:mm:ss.SSSZ"),streamLive:!1}),flyoutOptions:Object(ha.encode)({surroundingLogsId:t}),logFilter:Object(ha.encode)(e)};null==a||a("logs",{path:`/stream?${Object(Pn.stringify)(i)}`})}),[j,a]),{selectedDatasets:N,setSelectedDatasets:A}=(()=>{const{services:e}=Object(_e.b)(),[t,a]=Object(n.useReducer)(dr,ur),i=Object(n.useCallback)((e=>{a({type:"changeSelectedDatasets",payload:{datasets:e}})}),[a]);return Object(n.useEffect)((()=>{const t=e.data.query.filterManager.getUpdates$().subscribe((()=>{const t=e.data.query.filterManager.getFilters().filter((e=>e.meta.controlledBy&&e.meta.controlledBy===Fa.CONTROLLED_BY_SWIM_LANE_FILTER));a({type:"updateDatasetsFilters",payload:{filters:t}})}));return()=>t.unsubscribe()}),[e.data.query.filterManager,a]),Object(n.useEffect)((()=>{const a=t.selectedDatasetsFilters.filter((e=>!t.selectedDatasets.includes(e.meta.params.query)));a.length>0&&a.forEach((t=>{e.data.query.filterManager.removeFilter(t)}))}),[t.selectedDatasets,t.selectedDatasetsFilters,e.data.query.filterManager]),{selectedDatasets:t.selectedDatasets,setSelectedDatasets:i,selectedDatasetsFilters:t.selectedDatasetsFilters}})(),{isLoadingLogEntryAnomalies:H,logEntryAnomalies:U,page:z,fetchNextPage:J,fetchPreviousPage:Y,changeSortOptions:B,changePaginationOptions:V,sortOptions:$,paginationOptions:q,datasets:W,isLoadingDatasets:G}=fr({sourceId:r,startTime:j.value.startTime,endTime:j.value.endTime,defaultSortOptions:Tr,defaultPaginationOptions:Cr,filteredDatasets:N}),Q=Object(n.useCallback)((({isPaused:e,refreshInterval:t})=>{F({isPaused:e,interval:t})}),[F]),{showModuleList:Z,showModuleSetup:X}=xt(),K=Object(n.useCallback)((()=>X("logs_ui_analysis")),[X]),ee=Object(n.useCallback)((()=>X("logs_ui_categories")),[X]),te=U.length>0,ae=Object(n.useMemo)((()=>("skipped"===M.type&&!!M.newlyCreated||"succeeded"===M.type||"skipped"===g.type&&!!g.newlyCreated||"succeeded"===g.type)&&!te),[te,M,g]),ne=Object(n.useCallback)((e=>{e.isInvalid||k(e)}),[k]);return i.a.createElement(fn,{hasData:"missing"!==(null==o?void 0:o.logIndexStatus),pageHeader:{pageTitle:e,rightSideItems:[i.a.createElement(Sr,{onClick:Z,size:"s"})]}},i.a.createElement(d.EuiFlexGroup,{direction:"column"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,{justifyContent:"spaceBetween"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(hn,{availableDatasets:W,isLoading:G,selectedDatasets:N,onChangeDatasetSelection:A})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiSuperDatePicker,{start:w.startTime,end:w.endTime,onTimeChange:ne,isPaused:I.isPaused,refreshInterval:I.interval,onRefreshChange:Q})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Jt,{hasOutdatedJobConfigurations:l,hasOutdatedJobDefinitions:c,hasSetupCapabilities:s,hasStoppedJobs:u,isFirstUse:!1,moduleName:m.moduleName,onRecreateMlJobForReconfiguration:K,onRecreateMlJobForUpdate:K}),i.a.createElement(Fa.MLJobsAwaitingNodeWarning,{jobIds:C}),i.a.createElement(Bt,{hasOutdatedJobConfigurations:b,hasOutdatedJobDefinitions:E,hasSetupCapabilities:s,hasStoppedJobs:v,isFirstUse:ae,moduleName:_.moduleName,onRecreateMlJobForReconfiguration:ee,onRecreateMlJobForUpdate:ee,qualityWarnings:p})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(sr,{isLoadingAnomaliesResults:H,anomalies:U,timeRange:j.value,page:z,fetchNextPage:J,fetchPreviousPage:Y,changeSortOptions:B,changePaginationOptions:V,sortOptions:$,paginationOptions:q,selectedDatasets:N,jobIds:C,autoRefresh:I}))),D?i.a.createElement(di,{logEntryId:P,onCloseFlyout:L,onSetFieldFilter:R,sourceId:r}):null)},jr=({onOpenSetup:e})=>(Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_setup"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_entry_rate_setup",delay:15e3}),i.a.createElement(d.EuiEmptyPrompt,{"data-test-subj":"logEntryRateSetupPage",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.setupTitle",defaultMessage:"Set up log anomaly analysis"})),body:i.a.createElement(d.EuiText,{size:"s"},i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.setupDescription",defaultMessage:"To enable log anomalies, set up a machine learning job"}))),actions:i.a.createElement(d.EuiButton,{fill:!0,onClick:e},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.logEntryRate.showAnalysisSetupButtonLabel",defaultMessage:"ML Setup"}))})),wr=f.i18n.translate("xpack.infra.logs.anomaliesPageTitle",{defaultMessage:"Anomalies"}),kr=Object(n.memo)((()=>{const{hasLogAnalysisCapabilites:e,hasLogAnalysisReadCapabilities:t,hasLogAnalysisSetupCapabilities:a}=gt(),{fetchJobStatus:r,fetchModuleDefinition:o,jobStatus:s,setupStatus:l}=$e(),{fetchJobStatus:c,fetchModuleDefinition:u,jobStatus:d,setupStatus:m}=ot(),{showModuleList:g}=xt(),h=Object(n.useCallback)((()=>Promise.all([r(),c()])),[r,c]);return Object(n.useEffect)((()=>{t&&h()}),[h,t]),Object(n.useEffect)((()=>{t&&o()}),[o,t]),Object(n.useEffect)((()=>{t&&u()}),[u,t]),Ft()((()=>{"pending"!==l.type&&t&&r(),"pending"!==m.type&&t&&c()}),3e4),e?t?"initializing"===l.type||"initializing"===m.type?i.a.createElement(j.a,{message:f.i18n.translate("xpack.infra.logs.analysisPage.loadingMessage",{defaultMessage:"Checking status of analysis jobs..."})}):"unknown"===l.type||"unknown"===m.type?i.a.createElement(Ir,{isEmptyState:!0},i.a.createElement(w.a,{retry:h})):Object(O.p)(s["log-entry-categories-count"])||Object(O.p)(d["log-entry-rate"])?i.a.createElement(i.a.Fragment,null,i.a.createElement(Or,{pageTitle:wr}),i.a.createElement(Mt,null)):a?i.a.createElement(i.a.Fragment,null,i.a.createElement(Ir,{isEmptyState:!0},i.a.createElement(jr,{onOpenSetup:g})),i.a.createElement(Mt,null)):i.a.createElement(Ir,{isEmptyState:!0},i.a.createElement(w.c,null),";"):i.a.createElement(Ir,{isEmptyState:!0},i.a.createElement(w.b,null)):i.a.createElement(Ct.a,{"data-test-subj":"logsLogEntryRatePage",pageHeader:{pageTitle:wr}})})),Ir=({children:e,...t})=>{const{sourceStatus:a}=Object(x.c)();return i.a.createElement(fn,g()({hasData:"missing"!==(null==a?void 0:a.logIndexStatus),"data-test-subj":"logsLogEntryRatePage",pageHeader:t.isEmptyState?void 0:{pageTitle:wr}},t),e)},Fr=({children:e})=>{const{hasFailedLoading:t,isLoading:a,isUninitialized:n,latestLoadSourceFailures:r,loadSource:o,resolvedSourceConfiguration:s,sourceId:l}=Object(x.c)(),{space:c}=Object(Fn.a)();return null==c?null:a||n?i.a.createElement(In.a,null):t?i.a.createElement(jn,{errors:r,onRetry:o}):null!=s?i.a.createElement(pi.Provider,null,i.a.createElement(rt,{indexPattern:s.indices,sourceId:l,spaceId:c.id,timestampField:s.timestampField,runtimeMappings:s.runtimeMappings},i.a.createElement(Ve,{indexPattern:s.indices,sourceId:l,spaceId:c.id,timestampField:s.timestampField,runtimeMappings:s.runtimeMappings},i.a.createElement(vt,null,e)))):null},Lr=()=>(C([{text:T.a}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(Fr,null,i.a.createElement(kr,null))));var Dr=a(26),Pr=a(208),Rr=a.n(Pr);const Nr=Symbol("unset form value"),Ar=({initialValue:e,validate:t})=>{const[a,i]=Object(n.useState)(Nr),r=a!==Nr?a:e,o=Object(n.useCallback)((t=>i((a=>t(a===Nr?e:a)))),[e]),s=Object(n.useCallback)((()=>i(Nr)),[]),l=Object(n.useMemo)((()=>!De()(r,e)),[r,e]),c=Hr(r,t);return Object(n.useMemo)((()=>({initialValue:e,isDirty:l,resetValue:s,updateValue:o,validity:c,value:r})),[e,l,s,o,c,r])},Hr=(e,t)=>{const a=Rr()((()=>{var a;return null!==(a=null==t?void 0:t(e))&&void 0!==a?a:Promise.resolve([])}),[t,e]);return Object(n.useMemo)((()=>a.loading?{validity:"pending"}:null!=a.error?{validity:"invalid",reasons:[{type:"generic",message:`${a.error}`}]}:a.value&&a.value.length>0?{validity:"invalid",reasons:a.value}:{validity:"valid"}),[a.error,a.loading,a.value])},Ur=(e,t)=>"invalid"===e.validity||"invalid"===t.validity?{validity:"invalid",reasons:[..."invalid"===e.validity?e.reasons:[],..."invalid"===t.validity?t.reasons:[]]}:"pending"===e.validity||"pending"===t.validity?{validity:"pending"}:{validity:"valid"},zr=e=>t=>e(t.value),Jr=({errors:e})=>i.a.createElement(d.EuiCallOut,{color:"danger",iconType:"alert",title:Br},i.a.createElement("ul",null,e.map(((e,t)=>i.a.createElement("li",{key:t},i.a.createElement(Yr,{error:e})))))),Yr=({error:e})=>"generic"===e.type?i.a.createElement(i.a.Fragment,null,e.message):"empty_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.emptyFieldErrorMessage",defaultMessage:"The field '{fieldName}' must not be empty.",values:{fieldName:e.fieldName}}):"empty_column_list"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.emptyColumnListErrorMessage",defaultMessage:"The column list must not be empty."}):"child"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.childFormElementErrorMessage",defaultMessage:"At least one form field is in an invalid state."}):"missing_timestamp_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingTimestampFieldErrorMessage",defaultMessage:"The data view must be time-based."}):"missing_message_field"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingMessageFieldErrorMessage",defaultMessage:"The data view must contain a {messageField} field.",values:{messageField:i.a.createElement(d.EuiCode,null,"message")}}):"invalid_message_field_type"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.invalidMessageFieldTypeErrorMessage",defaultMessage:"The {messageField} field must be a text field.",values:{messageField:i.a.createElement(d.EuiCode,null,"message")}}):"rollup_index_pattern"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.rollupIndexPatternErrorMessage",defaultMessage:"The data view must not be a rollup index pattern."}):"missing_index_pattern"===e.type?i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.missingDataViewErrorMessage",defaultMessage:"The data view {dataViewId} must exist.",values:{dataViewId:i.a.createElement(d.EuiCode,null,e.indexPatternId)}}):null,Br=f.i18n.translate("xpack.infra.logSourceConfiguration.logSourceConfigurationFormErrorsCalloutTitle",{defaultMessage:"Inconsistent source configuration"}),Vr=e=>({error:"invalid"===e.validity.validity?e.validity.reasons.map((e=>i.a.createElement(Yr,{error:e}))):[],isInvalid:"invalid"===e.validity.validity}),$r=(e,t)=>a=>({isInvalid:"invalid"===a.validity.validity,onChange:t=>{const n=t.currentTarget.value;a.updateValue((()=>e(n)))},value:t(a.value)}),qr=$r((e=>`${e}`),(e=>e)),Wr=({isLoading:e,isReadOnly:t,indexNamesFormElement:a,onSwitchToIndexPatternReference:n})=>(Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_name"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_name",delay:15e3}),i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.indicesSectionTitle",defaultMessage:"Indices"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiCallOut,{title:Qr,iconType:"wrench"},i.a.createElement(k.FormattedMessage,{tagName:"p",id:"xpack.infra.logSourceConfiguration.indexPatternInformationCalloutDescription",defaultMessage:"The Logs UI can now integrate with data views to configure the used indices."}),i.a.createElement(d.EuiButton,{onClick:n},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.switchToDataViewReferenceButtonLabel",defaultMessage:"Use data views"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesTitle",defaultMessage:"Log indices"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesDescription",defaultMessage:"Index pattern for matching indices that contain log data"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,helpText:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesRecommendedValue",defaultMessage:"The recommended value is {defaultValue}",values:{defaultValue:i.a.createElement(d.EuiCode,null,"logs-*,filebeat-*")}}),label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logIndicesLabel",defaultMessage:"Log indices"})},Vr(a)),i.a.createElement(d.EuiFieldText,g()({"data-test-subj":"logIndicesInput",fullWidth:!0,disabled:e,isLoading:e,readOnly:t},Gr(a))))))),Gr=$r((e=>({type:"index_name",indexName:e})),(({indexName:e})=>e)),Qr=f.i18n.translate("xpack.infra.logSourceConfiguration.indexPatternInformationCalloutTitle",{defaultMessage:"New configuration option"}),Zr=()=>{const{services:{data:{indexPatterns:e}}}=Object(_e.b)();return e},Xr=({indexPatternId:e,isLoading:t,isReadOnly:a,onChangeIndexPatternId:r})=>{const{indexPatternTitles:o,latestIndexPatternTitlesRequest:s,fetchIndexPatternTitles:l}=(()=>{const e=Zr(),[t,a]=Object(n.useState)([]),[i,r]=Object(Me.c)({createPromise:()=>e.getIdsWithTitle(!0),onResolve:a},[e]);return{fetchIndexPatternTitles:r,indexPatternTitles:t,latestIndexPatternTitlesRequest:i}})();Object(n.useEffect)((()=>{l()}),[l]);const c=Object(n.useMemo)((()=>[...o.map((({id:e,title:t})=>({key:e,label:t,value:e}))),...null==e||o.some((({id:t})=>t===e))?[]:[{key:e,label:f.i18n.translate("xpack.infra.logSourceConfiguration.missingDataViewsLabel",{defaultMessage:"Missing data view {indexPatternId}",values:{indexPatternId:e}}),value:e}]]),[o,e]),u=Object(n.useMemo)((()=>c.filter((({key:t})=>t===e))),[c,e]),m=Object(n.useCallback)((([e])=>"string"==typeof(null==e?void 0:e.key)?r(e.key):r(void 0)),[r]);return i.a.createElement(d.EuiComboBox,{isLoading:t||"pending"===s.state,isDisabled:a,options:c,placeholder:Kr,selectedOptions:u,singleSelection:!0,onChange:m})},Kr=f.i18n.translate("xpack.infra.logSourceConfiguration.dataViewSelectorPlaceholder",{defaultMessage:"Choose a data view"}),eo=({isLoading:e,isReadOnly:t,indexPatternFormElement:a})=>{var r;Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_pattern"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_source_configuration_index_pattern",delay:15e3});const o=Object(n.useCallback)((e=>{null!=e?a.updateValue((()=>({type:"index_pattern",indexPatternId:e}))):a.updateValue((()=>{}))}),[a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiTitle,{size:"s"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewSectionTitle",defaultMessage:"Data view"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(to,null),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewTitle",defaultMessage:"Log data view"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewDescription",defaultMessage:"Data view that contains log data"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewLabel",defaultMessage:"Log data view"})},Object(n.useMemo)((()=>e?{}:Vr(a)),[e,a])),i.a.createElement(Xr,{isLoading:e||"pending"===a.validity.validity,isReadOnly:t,indexPatternId:null===(r=a.value)||void 0===r?void 0:r.indexPatternId,onChangeIndexPatternId:o}))))},to=i.a.memo((()=>{const e=Object(Ht.b)({app:"management",pathname:"/kibana/dataViews"});return i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.logDataViewHelpText",defaultMessage:"Data views are shared among apps in the Kibana space and can be managed via the {dataViewsManagementLink}.",values:{dataViewsManagementLink:i.a.createElement(d.EuiLink,e,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logSourceConfiguration.dataViewsManagementLinkText",defaultMessage:"data views management screen"}))}})})),ao=i.a.memo((({isLoading:e,isReadOnly:t,indicesFormElement:a})=>{const r=Object(Ie.useUiTracker)({app:"infra_logs"}),o=Object(n.useCallback)((()=>{a.updateValue((()=>{})),r({metric:"configuration_switch_to_index_pattern_reference"})}),[a,r]);return no(a)?i.a.createElement(eo,{isLoading:e,isReadOnly:t,indexPatternFormElement:a}):io(a)?i.a.createElement(i.a.Fragment,null,i.a.createElement(Wr,{isLoading:e,isReadOnly:t,indexNamesFormElement:a,onSwitchToIndexPatternReference:o})):null})),no=zr((e=>null==e||On.f.is(e))),io=zr(On.e.is);var ro=a(41);const oo=({addLogColumn:e,availableFields:t,isDisabled:a})=>{const{isVisible:r,show:o,hide:s}=Object(Zn.a)(!1),l=Object(n.useMemo)((()=>[{optionProps:{append:i.a.createElement(co,null),"data-test-subj":"addTimestampLogColumn",key:"timestamp",label:"Timestamp"},columnConfiguration:{timestampColumn:{id:Object(ro.v4)()}}},{optionProps:{"data-test-subj":"addMessageLogColumn",append:i.a.createElement(co,null),key:"message",label:"Message"},columnConfiguration:{messageColumn:{id:Object(ro.v4)()}}},...t.map((e=>({optionProps:{"data-test-subj":`addFieldLogColumn addFieldLogColumn:${e}`,key:`field-${e}`,label:e},columnConfiguration:{fieldColumn:{id:Object(ro.v4)(),field:e}}})))]),[t]),c=Object(n.useMemo)((()=>l.map((e=>e.optionProps))),[l]),u=Object(n.useCallback)((t=>{s();const a=t.findIndex((e=>"on"===e.checked)),n=l[a];e(n.columnConfiguration)}),[e,l,s]);return i.a.createElement(d.EuiPopover,{anchorPosition:"downRight",button:i.a.createElement(d.EuiButton,{"data-test-subj":"addLogColumnButton",isDisabled:a,iconType:"plusInCircle",onClick:o},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.addLogColumnButtonLabel",defaultMessage:"Add column"})),closePopover:s,id:"addLogColumn",isOpen:r,ownFocus:!0,panelPaddingSize:"none"},i.a.createElement(d.EuiSelectable,{height:600,listProps:lo,onChange:u,options:c,searchable:!0,searchProps:so,singleSelection:!0},((e,t)=>i.a.createElement(uo,{"data-test-subj":"addLogColumnPopover"},i.a.createElement(d.EuiPopoverTitle,null,t),e))))},so={"data-test-subj":"fieldSearchInput"},lo={showIcons:!1},co=()=>i.a.createElement(d.EuiBadge,null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.systemColumnBadgeLabel",defaultMessage:"System"})),uo=Lt.euiStyled.div`
  width: 400px;
`,mo=i.a.memo((({availableFields:e,isLoading:t,logColumnsFormElement:a})=>{const r=Object(n.useCallback)((e=>a.updateValue((t=>[...t,e]))),[a]),o=Object(n.useCallback)((e=>a.updateValue((t=>t.filter((t=>t!==e))))),[a]),s=Object(n.useCallback)(((e,t)=>{a.updateValue((n=>{if(t>=0&&e<=a.value.length-1){const n=[...a.value];return n.splice(t,0,n.splice(e,1)[0]),n}return n}))}),[a]),l=Object(n.useCallback)((({source:e,destination:t})=>t&&s(e.index,t.index)),[s]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationLogColumnsSectionTitle"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.logColumnsSectionTitle",defaultMessage:"Log columns"})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(oo,{addLogColumn:r,availableFields:e,isDisabled:t}))),a.value.length>0?i.a.createElement(d.EuiDragDropContext,{onDragEnd:l},i.a.createElement(d.EuiDroppable,{droppableId:"COLUMN_CONFIG_DROPPABLE_AREA"},a.value.map(((e,t)=>{const a=(e=>Di(e)?e.timestampColumn.id:Li(e)?e.messageColumn.id:e.fieldColumn.id)(e);return i.a.createElement(d.EuiDraggable,{key:`logColumnConfigurationPanel-${a}`,index:t,draggableId:a,customDragHandle:!0},(t=>i.a.createElement(go,{dragHandleProps:t.dragHandleProps,logColumnConfiguration:e,onRemove:o})))})))):i.a.createElement(Eo,null),"invalid"===a.validity.validity?a.validity.reasons.map((e=>i.a.createElement(d.EuiText,{key:e.type,textAlign:"center",color:"danger"},i.a.createElement(Yr,{error:e})))):null)})),go=({logColumnConfiguration:e,dragHandleProps:t,onRemove:a})=>{const r=Object(n.useCallback)((()=>a(e)),[e,a]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiSpacer,{size:"m"}),Di(e)?i.a.createElement(fo,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}):Li(e)?i.a.createElement(ho,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}):i.a.createElement(po,{dragHandleProps:t,logColumnConfiguration:e,onRemove:r}))},fo=({dragHandleProps:e,onRemove:t})=>i.a.createElement(bo,{fieldName:"Timestamp",helpText:i.a.createElement(k.FormattedMessage,{tagName:"span",id:"xpack.infra.sourceConfiguration.timestampLogColumnDescription",defaultMessage:"This system field shows the log entry's time as determined by the {timestampSetting} field setting.",values:{timestampSetting:i.a.createElement("code",null,"timestamp")}}),onRemove:t,dragHandleProps:e}),ho=({dragHandleProps:e,onRemove:t})=>i.a.createElement(bo,{fieldName:"Message",helpText:i.a.createElement(k.FormattedMessage,{tagName:"span",id:"xpack.infra.sourceConfiguration.messageLogColumnDescription",defaultMessage:"This system field shows the log entry message as derived from the document fields."}),onRemove:t,dragHandleProps:e}),po=({dragHandleProps:e,logColumnConfiguration:{fieldColumn:{field:t}},onRemove:a})=>i.a.createElement(d.EuiPanel,{color:"subdued","data-test-subj":`logColumnPanel fieldLogColumnPanel fieldLogColumnPanel:${t}`,hasShadow:!1},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement("div",g()({"data-test-subj":"moveLogColumnHandle"},e),i.a.createElement(d.EuiIcon,{type:"grab"}))),i.a.createElement(d.EuiFlexItem,{grow:1},vo),i.a.createElement(d.EuiFlexItem,{grow:3},i.a.createElement("code",null,t)),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(yo,{onClick:a,columnDescription:`${vo} - ${t}`})))),bo=({fieldName:e,helpText:t,onRemove:a,dragHandleProps:n})=>i.a.createElement(d.EuiPanel,{color:"subdued","data-test-subj":`logColumnPanel systemLogColumnPanel systemLogColumnPanel:${e}`,hasShadow:!1},i.a.createElement(d.EuiFlexGroup,{alignItems:"center"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement("div",g()({"data-test-subj":"moveLogColumnHandle"},n),i.a.createElement(d.EuiIcon,{type:"grab"}))),i.a.createElement(d.EuiFlexItem,{grow:1},e),i.a.createElement(d.EuiFlexItem,{grow:3},i.a.createElement(d.EuiText,{size:"s",color:"subdued"},t)),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(yo,{onClick:a,columnDescription:String(e)})))),yo=({onClick:e,columnDescription:t})=>{const a=f.i18n.translate("xpack.infra.sourceConfiguration.removeLogColumnButtonLabel",{defaultMessage:"Remove {columnDescription} column",values:{columnDescription:t}});return i.a.createElement(d.EuiButtonIcon,{color:"danger","data-test-subj":"removeLogColumnButton",iconType:"trash",onClick:e,title:a,"aria-label":a})},Eo=()=>i.a.createElement(d.EuiEmptyPrompt,{iconType:"list",title:i.a.createElement("h2",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.noLogColumnsTitle",defaultMessage:"No columns"})),body:i.a.createElement("p",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.noLogColumnsDescription",defaultMessage:"Add a column to this list using the button above."}))}),vo=f.i18n.translate("xpack.infra.sourceConfiguration.fieldLogColumnTitle",{defaultMessage:"Field"}),xo=i.a.memo((({isLoading:e,isReadOnly:t,nameFormElement:a})=>i.a.createElement(d.EuiForm,null,i.a.createElement(d.EuiTitle,{size:"s","data-test-subj":"sourceConfigurationNameSectionTitle"},i.a.createElement("h3",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameSectionTitle",defaultMessage:"Name"}))),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(d.EuiDescribedFormGroup,{title:i.a.createElement("h4",null,i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})),description:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameDescription",defaultMessage:"A descriptive name for the source configuration"})},i.a.createElement(d.EuiFormRow,g()({fullWidth:!0,label:i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.nameLabel",defaultMessage:"Name"})},Object(n.useMemo)((()=>Vr(a)),[a])),i.a.createElement(d.EuiFieldText,g()({"data-test-subj":"nameInput",fullWidth:!0,disabled:e,readOnly:t,isLoading:e,name:"name"},Object(n.useMemo)((()=>qr(a)),[a]))))))));var _o=a(70);const Mo=(e,t)=>""===t?[{type:"empty_field",fieldName:e}]:[],So=e=>[...To(e),...Co(e),...Oo(e)],To=e=>e.isTimeBased()?[]:[{type:"missing_timestamp_field",indexPatternTitle:e.title}],Co=e=>{const t=e.getFieldByName("message");return null==t?[{type:"missing_message_field",indexPatternTitle:e.title}]:t.type!==_o.KBN_FIELD_TYPES.STRING?[{type:"invalid_message_field_type",indexPatternTitle:e.title}]:[]},Oo=e=>null!=e.type?[{type:"rollup_index_pattern",indexPatternTitle:e.title}]:[],jo=e=>{var t;const a=(i=null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"",Ar({initialValue:i,validate:Object(n.useMemo)((()=>async e=>Mo("name",e)),[])}));var i;const r=(e=>{const t=Zr(),a=Object(Ie.useUiTracker)({app:"infra_logs"});return Ar({initialValue:e,validate:Object(n.useMemo)((()=>async e=>{if(null==e)return Mo("log data view","");if(On.e.is(e))return Mo("log indices",e.indexName);{const n=Mo("log data view",e.indexPatternId);if(n.length>0)return n;const i=await t.get(e.indexPatternId).then(So,(t=>{if(t instanceof Cn.SavedObjectNotFound)return[{type:"missing_index_pattern",indexPatternId:e.indexPatternId}];throw t}));return i.length>0?a({metric:"configuration_index_pattern_validation_failed"}):a({metric:"configuration_index_pattern_validation_succeeded"}),i}}),[t,a])})})(Object(n.useMemo)((()=>{var t;return null!==(t=null==e?void 0:e.logIndices)&&void 0!==t?t:{type:"index_name",indexName:""}}),[e])),o=(e=>Ar({initialValue:e,validate:Object(n.useMemo)((()=>async e=>e.length<=0?[{type:"empty_column_list"}]:[]),[])}))(Object(n.useMemo)((()=>{var t;return null!==(t=null==e?void 0:e.logColumns)&&void 0!==t?t:[]}),[e])),s=(({childFormElements:e,validate:t})=>{const a=Object(n.useMemo)((()=>Object.entries(e)),Object.entries(e).flat()),i=Object(n.useMemo)((()=>a.reduce(((e,[t,a])=>({...e,[t]:a.value})),{})),[a]),r=Object(n.useCallback)((e=>{const t=e(i);a.forEach((([e,a])=>a.updateValue((()=>t[e]))))}),[a,i]),o=Object(n.useMemo)((()=>a.some((([,e])=>e.isDirty))),[a]),s=Hr(i,t),l=Object(n.useMemo)((()=>a.some((([,e])=>"invalid"===e.validity.validity))?{validity:"invalid",reasons:[{type:"child"}]}:a.some((([,e])=>"pending"===e.validity.validity))?{validity:"pending"}:{validity:"valid"}),[a]),c=Object(n.useMemo)((()=>Ur(s,l)),[s,l]),u=Object(n.useCallback)((()=>{a.forEach((([,e])=>e.resetValue()))}),[a]),d=Object(n.useMemo)((()=>a.reduce(((e,[t,a])=>({...e,[t]:a.initialValue})),{})),[a]);return Object(n.useMemo)((()=>({childFormElements:e,initialValue:d,isDirty:o,resetValue:u,updateValue:r,validity:c,value:i})),[e,d,o,u,r,c,i])})(Object(n.useMemo)((()=>({childFormElements:{name:a,logIndices:r,logColumns:o},validate:async()=>[]})),[a,r,o]));return{formState:s.value,logIndicesFormElement:r,logColumnsFormElement:o,nameFormElement:a,sourceConfigurationFormElement:s}},wo=()=>{var e,t;const a=null===(e=Object(y.useKibana)().services.application)||void 0===e?void 0:e.capabilities,r=!0===(null==a||null===(t=a.logs)||void 0===t?void 0:t.configureSource);Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_source_configuration"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"log_source_configuration",delay:15e3}),C([{text:T.h}]);const{sourceConfiguration:o,hasFailedLoadingSource:s,isLoading:l,isUninitialized:c,updateSource:u,resolvedSourceConfiguration:m}=Object(x.c)(),g=Object(n.useMemo)((()=>{var e;return null!==(e=null==m?void 0:m.fields.map((e=>e.name)))&&void 0!==e?e:[]}),[m]),{sourceConfigurationFormElement:f,formState:h,logIndicesFormElement:p,logColumnsFormElement:b,nameFormElement:E}=jo(null==o?void 0:o.configuration),v=Object(n.useCallback)((async()=>{await u(h),f.resetValue()}),[u,f,h]),_=Object(n.useMemo)((()=>r&&o&&"internal"!==o.origin),[r,o]);return!l&&!c||m?s?null:i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(fn,{pageHeader:{pageTitle:T.h},"data-test-subj":"sourceConfigurationContent",restrictWidth:!0},i.a.createElement(Dr.b,{prompt:f.isDirty?ko:void 0}),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(xo,{isLoading:l,isReadOnly:!_,nameFormElement:E})),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(ao,{isLoading:l,isReadOnly:!_,indicesFormElement:p})),i.a.createElement(d.EuiSpacer,null),i.a.createElement(d.EuiPanel,{paddingSize:"l",hasShadow:!1,hasBorder:!0},i.a.createElement(mo,{availableFields:g,isLoading:l,logColumnsFormElement:b})),i.a.createElement(d.EuiSpacer,null),"invalid"===f.validity.validity?i.a.createElement(i.a.Fragment,null,i.a.createElement(Jr,{errors:f.validity.reasons}),i.a.createElement(d.EuiSpacer,null)):null,i.a.createElement(d.EuiFlexGroup,null,_&&i.a.createElement(d.EuiFlexItem,null,l?i.a.createElement(d.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{color:"primary",isLoading:!0,fill:!0},"Loading"))):i.a.createElement(i.a.Fragment,null,i.a.createElement(d.EuiFlexGroup,{justifyContent:"flexEnd"},i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{"data-test-subj":"discardSettingsButton",color:"danger",iconType:"cross",isDisabled:l||!f.isDirty,onClick:()=>{f.resetValue()}},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.discardSettingsButtonLabel",defaultMessage:"Discard"}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButton,{"data-test-subj":"applySettingsButton",color:"primary",isDisabled:!f.isDirty||"valid"!==f.validity.validity,fill:!0,onClick:v},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.sourceConfiguration.applySettingsButtonLabel",defaultMessage:"Apply"}))))))))):i.a.createElement(In.a,null)},ko=f.i18n.translate("xpack.infra.logSourceConfiguration.unsavedFormPromptMessage",{defaultMessage:"Are you sure you want to leave? Changes will be lost"});var Io=a(115),Fo=a(14),Lo=a.n(Fo),Do=a(145),Po=a(263);const Ro=({buckets:e,start:t,end:a,width:i,height:r})=>{if(t>=a||r<=0||i<=0||e.length<=0)return null;const o=Object(Do.scaleTime)().domain([t,a]).range([0,r]),s=Object(qe.max)(e.map((e=>e.entriesCount)))||0,l=Object(Do.scaleLinear)().domain([0,s]).range([0,i]),c=Object(Po.area)().x0(l(0)).x1((e=>l(e.entriesCount))).y0((e=>o(e.start))).y1((e=>o(e.end))).curve(Po.curveMonotoneY),u=e[0],d=e[e.length-1],m=c([{start:t,end:t,entriesCount:u.entriesCount},...e,{start:d.end,end:d.end,entriesCount:d.entriesCount},{start:a,end:a,entriesCount:0}]);return n.createElement("g",null,n.createElement(No,{width:i,height:r}),n.createElement(Ao,{d:m||""}))},No=Lt.euiStyled.rect`
  fill: ${e=>e.theme.darkMode?e.theme.eui.euiColorLightShade:e.theme.eui.euiColorLightestShade};
`,Ao=Lt.euiStyled.path`
  fill: ${e=>e.theme.darkMode?e.theme.eui.euiColorMediumShade:e.theme.eui.euiColorLightShade};
`,Ho=({className:e,end:t,getPositionOfTime:a,start:i,targetWidth:r,width:o,target:s})=>{const l=a(i),c=a(t),u=s&&a(s);return n.createElement(n.Fragment,null,u&&n.createElement(Uo,{className:e,x1:0,x2:r,y1:u,y2:u}),n.createElement(zo,{className:e,points:` ${r},${l} ${o},${l} ${o},${c}  ${r},${c}`}))};Ho.displayName="HighlightedInterval";const Uo=Lt.euiStyled.line`
  stroke: ${e=>e.theme.eui.euiColorPrimary};
  stroke-width: 1;
`,zo=Lt.euiStyled.polygon`
  fill: ${e=>e.theme.eui.euiColorPrimary};
  fill-opacity: 0.3;
  stroke: ${e=>e.theme.eui.euiColorPrimary};
  stroke-width: 1;
`;var Jo=a(80),Yo=a.n(Jo);class search_marker_tooltip_SearchMarkerTooltip extends n.PureComponent{render(){const{children:e,markerPosition:t}=this.props;return n.createElement(d.EuiPortal,null,n.createElement("div",null,n.createElement(Io.a,{content:!1,bounds:!0},(({measureRef:a,bounds:{width:i,height:r}})=>{const{top:o,left:s}=i&&r?Object(d.calculatePopoverPosition)(t,{width:i,height:r},"left",16,["left"]):{left:-9999,top:0};return n.createElement("div",{className:"euiToolTip euiToolTip--left euiToolTipPopover",style:{left:s,top:o},ref:a},n.createElement("div",{className:"euiToolTip__arrow",style:{left:i||0,top:(r||0)/2-6}}),n.createElement("div",null,e))}))))}}class search_marker_SearchMarker extends n.PureComponent{constructor(...e){super(...e),Lo()(this,"state",{hoveredPosition:null}),Lo()(this,"handleClick",(e=>{e.stopPropagation(),this.props.jumpToTarget(this.props.bucket.representativeKey)})),Lo()(this,"handleMouseEnter",(e=>{this.setState({hoveredPosition:e.currentTarget.getBoundingClientRect()})})),Lo()(this,"handleMouseLeave",(()=>{this.setState({hoveredPosition:null})}))}render(){const{bucket:e,height:t,width:a}=this.props,{hoveredPosition:i}=this.state,r=e.entriesCount>1?n.createElement(qo,{x:"-2",y:"-2",width:"4",height:t+2,rx:"2",ry:"2"}):n.createElement(n.Fragment,null,n.createElement(qo,{x:"-1",y:"0",width:"2",height:t}),n.createElement(qo,{x:"-2",y:t/2-2,width:"4",height:"4",rx:"2",ry:"2"}));return n.createElement(n.Fragment,null,i?n.createElement(search_marker_tooltip_SearchMarkerTooltip,{markerPosition:i},n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.searchResultTooltip",defaultMessage:"{bucketCount, plural, one {# highlighted entry} other {# highlighted entries}}",values:{bucketCount:e.entriesCount}})):null,n.createElement(Vo,{onClick:this.handleClick,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},n.createElement($o,{x:"0",y:"0",width:a,height:t}),r))}}const Bo=Lt.keyframes`
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
`,Vo=Lt.euiStyled.g`
  animation: ${Bo} ${e=>e.theme.eui.euiAnimSpeedExtraSlow} ease-in both;
`,$o=Lt.euiStyled.rect`
  fill: ${e=>e.theme.eui.euiColorAccent};
  opacity: 0;
  transition: opacity ${e=>e.theme.eui.euiAnimSpeedNormal} ease-in;
  cursor: pointer;

  ${Vo}:hover & {
    opacity: 0.3;
  }
`,qo=Lt.euiStyled.rect`
  fill: ${e=>e.theme.eui.euiColorAccent};
`;class search_markers_SearchMarkers extends n.PureComponent{render(){const{buckets:e,start:t,end:a,width:i,height:r,jumpToTarget:o,className:s}=this.props,l=Yo()("minimapSearchMarkers",s);if(t>=a||r<=0||Object.keys(e).length<=0)return null;const c=Object(Do.scaleTime)().domain([t,a]).range([0,r]);return n.createElement("g",{transform:`translate(${i/2}, 0)`,className:l},e.map((e=>n.createElement("g",{key:`${e.representativeKey.time}:${e.representativeKey.tiebreaker}`,transform:`translate(0, ${c(e.start)})`},n.createElement(search_marker_SearchMarker,{bucket:e,height:c(e.end)-c(e.start),width:i,jumpToTarget:o})))))}}const Wo=({end:e,height:t,start:a,tickCount:i,width:r})=>{const o=Object(Do.scaleTime)().domain([a,e]).range([0,t]),s=o.ticks(i),l=o.tickFormat(i,function(e,t){const a=Math.abs(t-e);return a<15e3?":%S.%L":a<96e4?"%I:%M:%S":void 0}(a,e));return n.createElement("g",null,s.map(((e,t)=>{const a=o(e);return n.createElement("g",{key:`tick${t}`},n.createElement(Go,{x:0,y:a-4},l(e)),n.createElement(Qo,{x1:0,y1:a,x2:r,y2:a}))})))};Wo.displayName="TimeRuler";const Go=Lt.euiStyled.text`
  font-size: 9px;
  line-height: ${e=>e.theme.eui.euiLineHeight};
  fill: ${e=>e.theme.eui.euiTextSubduedColor};
  user-select: none;
  pointer-events: none;
`,Qo=Lt.euiStyled.line`
  stroke: ${e=>e.theme.darkMode?e.theme.eui.euiColorDarkestShade:e.theme.eui.euiColorDarkShade};
  stroke-opacity: 0.5;
  stroke-width: 1px;
`,Zo=50;function Xo(e,t,a){return Object(Do.scaleLinear)().domain([e||0,t||0]).range([0,a])}class log_minimap_LogMinimap extends n.Component{constructor(e){super(e),Lo()(this,"handleClick",(e=>{const t=e.currentTarget.getBoundingClientRect().top,a=e.clientY-t,n=Math.floor(this.getYScale().invert(a));this.props.jumpToTarget({tiebreaker:0,time:n})})),Lo()(this,"getYScale",(()=>{const{start:e,end:t,height:a}=this.props;return Xo(e,t,a)})),Lo()(this,"getPositionOfTime",(e=>this.getYScale()(e))),Lo()(this,"updateTimeCursor",(e=>{const t=e.currentTarget.getBoundingClientRect(),a=e.clientY-t.top;this.setState({timeCursorY:a})})),this.state={timeCursorY:0,target:e.target}}render(){const{start:e,end:t,className:a,height:i,highlightedInterval:r,jumpToTarget:o,summaryBuckets:s,summaryHighlightBuckets:l,width:c}=this.props,{timeCursorY:u,target:d}=this.state,[m,g]=Xo(e,t,i).domain(),f=i?Math.floor(i/50):12;return n.createElement(ts,{className:a,height:i,preserveAspectRatio:"none",viewBox:`0 0 ${c} ${i}`,width:c,onClick:this.handleClick,onMouseMove:this.updateTimeCursor},n.createElement(Ko,{x1:Zo,x2:Zo,y1:0,y2:i}),n.createElement(Wo,{start:m,end:g,width:Zo,height:i,tickCount:f}),n.createElement("g",{transform:"translate(50, 0)"},n.createElement(Ro,{buckets:s,start:m,end:g,width:c-Zo,height:i}),n.createElement(search_markers_SearchMarkers,{buckets:l||[],start:m,end:g,width:c-Zo,height:i,jumpToTarget:o})),r?n.createElement(Ho,{end:r.end,getPositionOfTime:this.getPositionOfTime,start:r.start,targetWidth:Zo,width:c,target:d}):null,n.createElement(es,{x1:Zo,x2:c,y1:u,y2:u}))}}const Ko=Lt.euiStyled.line`
  stroke: ${e=>e.theme.eui.euiColorMediumShade};
  stroke-width: 1px;
`,es=Lt.euiStyled.line`
  pointer-events: none;
  stroke-width: 1px;
  stroke: ${e=>e.theme.darkMode?e.theme.eui.euiColorDarkestShade:e.theme.eui.euiColorDarkShade};
`,ts=Lt.euiStyled.svg`
  cursor: pointer;
  fill: ${e=>e.theme.eui.euiColorEmptyShade};
  & ${es} {
    visibility: hidden;
  }
  &:hover ${es} {
    visibility: visible;
  }
`;var as=a(170),ns=a(123),is=a(171),rs=a.n(is);const os=(e,t,a,i,r,o,s,l)=>{const{services:c}=Object(_e.b)(),[u,d]=Object(n.useState)([]),[m,g]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!(a&&i&&r&&l.length))throw new Error("Skipping request: Insufficient parameters");return await(async(e,t)=>{const a=await t(ae.e,{method:"POST",body:JSON.stringify(ae.n.encode(e))});return Object(F.b)(ae.o)(a)})({sourceId:e,startTimestamp:a,endTimestamp:i,center:r,size:o,query:s||void 0,highlightTerms:l},c.http.fetch)},onResolve:e=>{d(e.data)}},[e,a,i,r,o,s,l]);Object(n.useEffect)((()=>{d([])}),[l]),Object(n.useEffect)((()=>{l.filter((e=>e.length>0)).length&&a&&i?g():d([])}),[i,s,l,g,t,a]);const f=Object(n.useMemo)((()=>u.reduce(((e,t)=>t.entries.reduce(((e,t)=>{const a=e[t.id]||[];return{...e,[t.id]:[...a,t]}}),e)),{})),[u]);return{logEntryHighlights:u,logEntryHighlightsById:f,loadLogEntryHighlightsRequest:m}};function ss(e,t){return Object(n.useMemo)((()=>e&&t?(t-e)/100:null),[e,t])}const ls=(e,t,a,i,r,o)=>{const{services:s}=Object(_e.b)(),[l,c]=Object(n.useState)([]),u=ss(a,i),[d,m]=Object(Me.c)({cancelPreviousOn:"resolution",createPromise:async()=>{if(!(a&&i&&u&&o.length))throw new Error("Skipping request: Insufficient parameters");return await(async(e,t)=>{const a=await t(ae.f,{method:"POST",body:JSON.stringify(ae.p.encode(e))});return Object(F.b)(ae.q)(a)})({sourceId:e,startTimestamp:a,endTimestamp:i,bucketSize:u,query:r,highlightTerms:o},s.http.fetch)},onResolve:e=>{c(e.data)}},[e,a,i,u,r,o]),g=Object(n.useMemo)((()=>Object(qe.debounce)(m,275)),[m]);return Object(n.useEffect)((()=>{c([])}),[o]),Object(n.useEffect)((()=>{o.filter((e=>e.length>0)).length&&a&&i?g():c([])}),[u,g,r,o,t,a,i]),{logSummaryHighlights:l,loadLogSummaryHighlightsRequest:d}};var cs=a(155);const us=(e,t,a)=>Math.min(Math.max(e,t),a);var ds=a(104);const ms=xe()((({sourceId:e,sourceVersion:t,centerCursor:a,size:i,filterQuery:r})=>{const[o,s]=Object(n.useState)([]),{visibleMidpoint:l,jumpToTargetPosition:c,startTimestamp:u,endTimestamp:d}=Object(n.useContext)(ds.a.Context),m=rs()(u,3e3),g=rs()(d,3e3),{logEntryHighlights:f,logEntryHighlightsById:h,loadLogEntryHighlightsRequest:p}=os(e,t,m,g,a,i,r,o),{logSummaryHighlights:b,loadLogSummaryHighlightsRequest:y}=ls(e,t,m,g,r,o),{currentHighlightKey:E,hasPreviousHighlight:v,hasNextHighlight:x,goToPreviousHighlight:_,goToNextHighlight:M}=(({highlightTerms:e,jumpToTargetPosition:t,logEntryHighlights:a,visibleMidpoint:i})=>{const[r,o]=Object(n.useState)(null),s=Object(n.useMemo)((()=>a&&a.length>0?a[0].entries:[]),[a]);Object(n.useEffect)((()=>{o(null)}),[e]),Object(n.useEffect)((()=>{r&&t(r)}),[r,t]),Object(n.useEffect)((()=>{if(null===r&&s.length>0){const e=i?us(Object(cs.b)(s,i),0,s.length-1):0,t=Object(cs.c)(s[e]);o(t)}}),[r,s,o,i]);const l=Object(n.useMemo)((()=>r&&s.length>0?Object(cs.a)(s,r):null),[r,s]),c=Object(n.useMemo)((()=>Object(qe.isNumber)(l)&&l>0),[l]),u=Object(n.useMemo)((()=>s.length>0&&Object(qe.isNumber)(l)&&l<s.length-1),[l,s]),d=Object(n.useCallback)((()=>{if(s.length&&Object(qe.isNumber)(l)){const e=l-1,t=Object(cs.c)(s[e]);o(t)}}),[l,s]),m=Object(n.useCallback)((()=>{if(s.length>0&&Object(qe.isNumber)(l)){const e=l+1,t=Object(cs.c)(s[e]);o(t)}}),[l,s]);return{currentHighlightKey:r,hasPreviousHighlight:c,hasNextHighlight:u,goToPreviousHighlight:d,goToNextHighlight:m}})({visibleMidpoint:l,logEntryHighlights:f,highlightTerms:o,jumpToTargetPosition:c});return{highlightTerms:o,setHighlightTerms:s,logEntryHighlights:f,logEntryHighlightsById:h,logSummaryHighlights:b,loadLogEntryHighlightsRequest:p,loadLogSummaryHighlightsRequest:y,currentHighlightKey:E,hasPreviousHighlight:v,hasNextHighlight:x,goToPreviousHighlight:_,goToNextHighlight:M}}));var gs=a(178);const fs=(e,t,a,i)=>{const{services:r}=Object(_e.b)(),[o,s]=Object(n.useState)([]),l=ss(t,a);var c,u;return c=n=>{null!==t&&null!==a&&null!==l&&(async(e,t)=>{const a=await t(ae.g,{method:"POST",body:JSON.stringify(ae.r.encode(e))});return Object(F.b)(ae.s)(a)})({sourceId:e,startTimestamp:t,endTimestamp:a,bucketSize:l,query:i},r.http.fetch).then((e=>{n()||s(e.data.buckets)}))},u=[e,i,t,a,l],Object(n.useEffect)((()=>{const e=(()=>{const e={isCancelled:!1,cancel:()=>{e.isCancelled=!0}};return e})();return c((()=>e.isCancelled)),e.cancel}),u),{buckets:o,start:t,end:a}},hs=({children:e})=>{var t;const{sourceId:a}=Object(x.c)(),{filterQuery:i}=Object(n.useContext)(ns.a.Context),{startTimestamp:r,endTimestamp:o}=Object(n.useContext)(ds.a.Context),s=rs()(r,3e3),l=rs()(o,3e3),{buckets:c,start:u,end:d}=fs(a,s,l,null!==(t=null==i?void 0:i.serializedQuery)&&void 0!==t?t:null);return e({buckets:c,start:u,end:d})},ps=xe()((()=>{const[e,t]=Object(n.useState)("medium"),[a,i]=Object(n.useState)(!0);return{availableTextScales:bs,setTextScale:t,setTextWrap:i,textScale:e,textWrap:a}})),bs=["large","medium","small"],ys=()=>{const{textScale:e,textWrap:t,setTextScale:a,setTextWrap:r}=Object(n.useContext)(ps.Context),o=Object(n.useMemo)((()=>({textScale:e,wrap:t})),[e,t]);return i.a.createElement(fi.a,{urlState:o,urlStateKey:"logTextview",mapToUrlState:Es,onChange:e=>{e&&e.textScale&&a(e.textScale),e&&void 0!==e.wrap&&r(e.wrap)},onInitialize:e=>{e&&e.textScale&&a(e.textScale),e&&void 0!==e.wrap&&r(e.wrap)}})},Es=e=>e?{textScale:vs(e.textScale),wrap:xs(e.wrap)}:void 0,vs=e=>bs.includes(e)?e:void 0,xs=e=>"boolean"==typeof e?e:void 0;var _s=a(30);class log_customization_menu_LogCustomizationMenu extends n.Component{constructor(...e){super(...e),Lo()(this,"state",{isShown:!1}),Lo()(this,"show",(()=>{this.setState({isShown:!0})})),Lo()(this,"hide",(()=>{this.setState({isShown:!1})})),Lo()(this,"toggleVisibility",(()=>{this.setState((e=>({isShown:!e.isShown})))}))}render(){const{children:e}=this.props,{isShown:t}=this.state,a=n.createElement(d.EuiButtonEmpty,{color:"text",iconType:"eye",onClick:this.toggleVisibility,size:"xs"},n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.customizeButtonLabel",defaultMessage:"Customize"}));return n.createElement(d.EuiPopover,{id:"customizePopover",button:a,closePopover:this.hide,isOpen:t,anchorPosition:"downRight",ownFocus:!0},n.createElement(Ms,null,e))}}const Ms=Lt.euiStyled.div`
  min-width: 200px;
`,Ss=({startDateExpression:e,endDateExpression:t,isStreaming:a,onUpdateDateRange:r,onStartStreaming:o,onStopStreaming:s})=>{const l=Object(n.useCallback)((({start:e,end:t,isInvalid:a})=>{r&&!a&&r({startDateExpression:e,endDateExpression:t})}),[r]);return i.a.createElement(d.EuiFlexGroup,{gutterSize:"s"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiSuperDatePicker,{start:e,end:t,onTimeChange:l,showUpdateButton:!1,isDisabled:a})),i.a.createElement(d.EuiFlexItem,{grow:!1},a?i.a.createElement(d.EuiButton,{color:"primary",iconType:"pause",iconSide:"left",onClick:s},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.stopStreamingButtonLabel",defaultMessage:"Stop streaming"})):i.a.createElement(d.EuiButton,{color:"primary",iconType:"play",iconSide:"left",onClick:o},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.startStreamingButtonLabel",defaultMessage:"Stream live"}))))},Ts=({onChange:e,isLoading:t,activeHighlights:a,hasPreviousHighlight:r,goToPreviousHighlight:o,hasNextHighlight:s,goToNextHighlight:l})=>{const{isVisible:c,hide:u,toggle:m}=Object(Zn.a)(!1),[g,f]=Object(n.useState)(""),h=Object(n.useMemo)((()=>Object(qe.debounce)(e,275)),[e]),p=Object(n.useCallback)((e=>f((t=>{const a="function"==typeof e?e(t):e;return a!==t&&h([a]),a}))),[h]),b=Object(n.useCallback)((e=>{const t=e.target.value;p(t)}),[p]),y=Object(n.useCallback)((()=>p("")),[p]),E=i.a.createElement(d.EuiButtonEmpty,{color:"text",size:"xs",iconType:"brush",onClick:m},i.a.createElement(k.FormattedMessage,{id:"xpack.infra.logs.highlights.highlightsPopoverButtonLabel",defaultMessage:"Highlights"}),a?i.a.createElement(ks,null):null);return i.a.createElement(d.EuiPopover,{id:"popover",button:E,isOpen:c,closePopover:u,ownFocus:!0},i.a.createElement(Is,null,i.a.createElement(d.EuiFlexGroup,{alignItems:"center",gutterSize:"s"},i.a.createElement(d.EuiFlexItem,null,i.a.createElement(d.EuiFieldText,{placeholder:Cs,fullWidth:!0,value:g,onChange:b,isLoading:t,"aria-label":Cs})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":js,iconType:"arrowUp",onClick:o,title:js,isDisabled:!r})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":ws,iconType:"arrowDown",onClick:l,title:ws,isDisabled:!s})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiButtonIcon,{"aria-label":Os,color:"danger",isDisabled:""===g,iconType:"trash",onClick:y,title:Os})))))},Cs=f.i18n.translate("xpack.infra.logs.highlights.highlightTermsFieldLabel",{defaultMessage:"Terms to highlight"}),Os=f.i18n.translate("xpack.infra.logs.highlights.clearHighlightTermsButtonLabel",{defaultMessage:"Clear terms to highlight"}),js=f.i18n.translate("xpack.infra.logs.highlights.goToPreviousHighlightButtonLabel",{defaultMessage:"Jump to previous highlight"}),ws=f.i18n.translate("xpack.infra.logs.highlights.goToNextHighlightButtonLabel",{defaultMessage:"Jump to next highlight"}),ks=Object(Lt.euiStyled)(d.EuiIcon).attrs((({theme:e})=>({type:"checkInCircleFilled",size:"m",color:null==e?void 0:e.eui.euiColorAccent})))`
  padding-left: ${e=>e.theme.eui.paddingSizes.xs};
`,Is=Lt.euiStyled.div`
  width: 300px;
`;class log_text_scale_controls_LogTextScaleControls extends n.PureComponent{constructor(...e){super(...e),Lo()(this,"setTextScale",(e=>{["small","medium","large"].includes(e)&&this.props.setTextScale(e)}))}render(){const{availableTextScales:e,textScale:t}=this.props;return n.createElement(d.EuiFormRow,{label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.textSizeFormRowLabel",defaultMessage:"Text Size"})},n.createElement(d.EuiRadioGroup,{options:e.map((e=>({id:e.toString(),label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.textSizeRadioGroup",defaultMessage:"{textScale, select, small {Small} medium {Medium} large {Large} other {{textScale}} }",values:{textScale:e}})}))),idSelected:t,onChange:this.setTextScale}))}}class log_text_wrap_controls_LogTextWrapControls extends n.PureComponent{constructor(...e){super(...e),Lo()(this,"toggleWrap",(()=>{this.props.setTextWrap(!this.props.wrap)}))}render(){const{wrap:e}=this.props;return n.createElement(d.EuiFormRow,{label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.lineWrappingFormRowLabel",defaultMessage:"Line Wrapping"})},n.createElement(d.EuiSwitch,{label:n.createElement(k.FormattedMessage,{id:"xpack.infra.logs.customizeLogs.wrapLongLinesSwitchLabel",defaultMessage:"Wrap long lines"}),checked:e,onChange:this.toggleWrap}))}}const Fs=()=>{const{derivedIndexPattern:e}=Object(x.c)(),{availableTextScales:t,setTextScale:a,setTextWrap:r,textScale:o,textWrap:s}=Object(n.useContext)(ps.Context),{filterQueryDraft:l,isFilterQueryDraftValid:c,applyLogFilterQuery:u,setLogFilterQueryDraft:m}=Object(n.useContext)(ns.a.Context),{setSurroundingLogsId:g}=Object(n.useContext)(pi.Context),{setHighlightTerms:h,loadLogEntryHighlightsRequest:p,highlightTerms:b,hasPreviousHighlight:y,hasNextHighlight:E,goToPreviousHighlight:v,goToNextHighlight:_}=Object(n.useContext)(ms.Context),{isStreaming:M,startLiveStreaming:S,stopLiveStreaming:T,startDateExpression:C,endDateExpression:O,updateDateRange:j}=Object(n.useContext)(ds.a.Context);return i.a.createElement("div",null,i.a.createElement(d.EuiFlexGroup,{alignItems:"center",justifyContent:"spaceBetween",gutterSize:"l",wrap:!0},i.a.createElement(Ls,null,i.a.createElement(_o.QueryStringInput,{disableLanguageSwitcher:!0,iconType:"search",indexPatterns:[e],isInvalid:!c,onChange:e=>{g(null),m(e)},onSubmit:e=>{g(null),u(e)},placeholder:f.i18n.translate("xpack.infra.logsPage.toolbar.kqlSearchFieldPlaceholder",{defaultMessage:"Search for log entries… (e.g. host.name:host-1)"}),query:l})),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(d.EuiFlexGroup,null,i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(log_customization_menu_LogCustomizationMenu,null,i.a.createElement(log_text_wrap_controls_LogTextWrapControls,{wrap:s,setTextWrap:r}),i.a.createElement(log_text_scale_controls_LogTextScaleControls,{availableTextScales:t,textScale:o,setTextScale:a}))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Ts,{onChange:h,isLoading:"pending"===p.state,activeHighlights:b.filter((e=>e.length>0)).length>0,goToPreviousHighlight:v,goToNextHighlight:_,hasPreviousHighlight:y,hasNextHighlight:E})))),i.a.createElement(d.EuiFlexItem,{grow:!1},i.a.createElement(Ss,{startDateExpression:C,endDateExpression:O,onStartStreaming:S,onStopStreaming:T,isStreaming:M,onUpdateDateRange:j}))))},Ls=Object(Lt.euiStyled)(d.EuiFlexItem)`
  @media (min-width: 1200px) {
    flex: 0 0 100% !important;
    margin-left: 0 !important;
    margin-right: 0 !important;
    padding-left: 12px;
    padding-right: 12px;
  }
`,Ds=()=>{const{resolvedSourceConfiguration:e,sourceConfiguration:t,sourceId:a}=Object(x.c)(),{textScale:r,textWrap:o}=Object(n.useContext)(ps.Context),{surroundingLogsId:s,setSurroundingLogsId:l,closeFlyout:c,openFlyout:u,isFlyoutOpen:m,logEntryId:g}=yi(),{startTimestamp:f,endTimestamp:h,isStreaming:p,targetPosition:b,visibleMidpointTime:y,visibleTimeInterval:E,reportVisiblePositions:v,jumpToTargetPosition:_,startLiveStreaming:M,stopLiveStreaming:S,startDateExpression:T,endDateExpression:C,updateDateRange:O,lastCompleteDateRangeExpressionUpdate:j}=Object(n.useContext)(ds.a.Context),{filterQuery:w,applyLogFilterQuery:k}=Object(n.useContext)(ns.a.Context),{isReloading:I,entries:F,topCursor:L,bottomCursor:D,hasMoreAfter:P,hasMoreBefore:R,isLoadingMore:N,lastLoadedTime:A,fetchEntries:H,fetchPreviousEntries:U,fetchNextEntries:z,fetchNewestEntries:J}=Object(gs.c)(),Y=Ge()(f),B=Ge()(h),V=Ge()(w),$=Ge()(j);Object(n.useEffect)((()=>{const e=!Y||!B,t=j!==$,a=null!=b&&(null!=L&&b.time<L.time||null!=D&&b.time>D.time);(e||t||a||w!==V)&&(p?J():H())}),[H,J,p,Y,B,f,h,b,L,D,w,V,j,$]);const{logSummaryHighlights:q,currentHighlightKey:W,logEntryHighlightsById:G}=Object(n.useContext)(ms.Context),Q=Object(n.useMemo)((()=>I?[]:F.map((e=>Rs(e,G[e.id]||[])))),[F,I,G]),[,{setContextEntry:Z}]=Object(n.useContext)(Vt.Context),X=Object(n.useCallback)((e=>{O(e),"startDateExpression"in e&&Object(_s.c)(e.startDateExpression)&&U({force:!0,extendTo:Object(_s.a)(e.startDateExpression)}),"endDateExpression"in e&&Object(_s.c)(e.endDateExpression)&&z({force:!0,extendTo:Object(_s.a)(e.endDateExpression)})}),[O,U,z]),K=Object(n.useCallback)((e=>{v(e),e.fromScroll&&(N||(e.pagesBeforeStart<2?U():e.pagesAfterEnd<2&&z()))}),[v,N,U,z]),ee=Object(n.useCallback)(((e,t,a)=>{k(e),a&&_(a),l(t),S()}),[k,_,l,S]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(ys,null),i.a.createElement(Ei,null),i.a.createElement(Fs,null),i.a.createElement(d.EuiSpacer,{size:"m"}),i.a.createElement(Gt,null),m?i.a.createElement(di,{logEntryId:g,onCloseFlyout:c,onSetFieldFilter:ee,sourceId:a}):null,i.a.createElement(as.b,{key:`${a}-${null==t?void 0:t.version}`},i.a.createElement(pa.g,{columnConfigurations:e&&e.columns||[],hasMoreAfterEnd:P,hasMoreBeforeStart:R,isLoadingMore:N,isReloading:I,isStreaming:p,items:Q,jumpToTarget:_,lastLoadedTime:A,reloadItems:H,reportVisibleInterval:K,scale:r,target:b,wrap:o,onOpenLogEntryFlyout:u,setContextEntry:Z,highlightedItem:s||null,currentHighlightKey:W,startDateExpression:T,endDateExpression:C,updateDateRange:X,startLiveStreaming:M}),i.a.createElement(Io.a,{content:!0,bounds:!0,detectAnyWindowResize:"height"},(({measureRef:e,bounds:{height:t=0},content:{width:a=0}})=>i.a.createElement(Ps,{ref:e},i.a.createElement(hs,null,(({buckets:e,start:n,end:r})=>i.a.createElement(log_minimap_LogMinimap,{start:n,end:r,height:t,width:a,highlightedInterval:I?null:E,jumpToTarget:_,summaryBuckets:e,summaryHighlightBuckets:q.length>0?q[0].buckets:[],target:y}))))))))},Ps=Lt.euiStyled.div`
  flex: 1 0 0%;
  overflow: hidden;
  min-width: 100px;
  max-width: 100px;
  display: flex;
  flex-direction: column;
`,Rs=(e,t)=>({kind:"logEntry",logEntry:e,highlights:t});var Ns=a(31);const As=f.i18n.translate("xpack.infra.logs.streamPageTitle",{defaultMessage:"Stream"}),Hs=()=>{const{hasFailedLoading:e,isLoading:t,isUninitialized:a,loadSource:n,latestLoadSourceFailures:r,sourceStatus:o}=Object(x.c)();return t||a?i.a.createElement(In.a,null):e?i.a.createElement(jn,{errors:r,onRetry:n}):i.a.createElement(Us,{className:Ns.APP_WRAPPER_CLASS},i.a.createElement(fn,{hasData:"missing"!==(null==o?void 0:o.logIndexStatus),pageHeader:{pageTitle:As}},i.a.createElement(Ds,null)))},Us=Lt.euiStyled.div`
  .euiPage .euiPageContentBody {
    display: flex;
    flex-direction: column;
    flex: 1 0 auto;
    width: 100%;
    height: 100%;
  }
`,zs=()=>i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{title:e=>f.i18n.translate("xpack.infra.logs.streamPage.documentTitle",{defaultMessage:"{previousTitle} | Stream",values:{previousTitle:e}})})),Js=({children:e})=>{const{derivedIndexPattern:t}=Object(x.c)();return i.a.createElement(ns.a.Provider,{indexPattern:t},i.a.createElement(ns.b,null),e)},Ys=({children:e})=>{const{startTimestamp:t,endTimestamp:a}=Object(n.useContext)(ds.a.Context),{sourceId:r}=Object(x.c)();return t&&a?i.a.createElement(Vt.Provider,{startTimestamp:t,endTimestamp:a,sourceId:r},e):null},Bs=({children:e})=>{const{sourceId:t}=Object(x.c)(),{startTimestamp:a,endTimestamp:r,targetPosition:o,isInitialized:s}=Object(n.useContext)(ds.a.Context),{filterQuery:l}=Object(n.useContext)(ns.a.Context);return a&&r&&s?i.a.createElement(gs.a,{sourceId:t,startTimestamp:a,endTimestamp:r,query:null==l?void 0:l.parsedQuery,center:null!=o?o:void 0},e):null},Vs=({children:e})=>{var t;const{sourceId:a,sourceConfiguration:r}=Object(x.c)(),{topCursor:o,bottomCursor:s,entries:l}=Object(gs.c)(),{filterQuery:c}=Object(n.useContext)(ns.a.Context),u={sourceId:a,sourceVersion:null==r?void 0:r.version,entriesStart:o,entriesEnd:s,centerCursor:l.length>0?l[Math.floor(l.length/2)].cursor:null,size:l.length,filterQuery:null!==(t=null==c?void 0:c.serializedQuery)&&void 0!==t?t:null};return i.a.createElement(ms.Provider,u,e)},$s=({children:e})=>{const{sourceStatus:t}=Object(x.c)();return"missing"===(null==t?void 0:t.logIndexStatus)?i.a.createElement(i.a.Fragment,null,e):i.a.createElement(ps.Provider,null,i.a.createElement(pi.Provider,null,i.a.createElement(ds.a.Provider,null,i.a.createElement(ds.b,null),i.a.createElement(Ys,null,i.a.createElement(Js,null,i.a.createElement(Bs,null,i.a.createElement(Vs,null,e)))))))},qs=()=>(Object(Ie.useTrackPageview)({app:"infra_logs",path:"stream"}),Object(Ie.useTrackPageview)({app:"infra_logs",path:"stream",delay:15e3}),C([{text:T.i}]),i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement($s,null,i.a.createElement(zs,null),i.a.createElement(Hs,null))));var Ws=a(43),Gs=a(211);const Qs=()=>{var e,t,a,r;const o=null===(e=Object(y.useKibana)().services.application)||void 0===e?void 0:e.capabilities,{setHeaderActionMenu:l,theme$:c}=Object(n.useContext)(Ws.a),{initialize:u}=Object(x.c)(),m=Object(y.useKibana)();Object(Gs.a)(!(null!=o&&null!==(t=o.logs)&&void 0!==t&&t.save)),p()((()=>{u()}));const f="/stream",h="/anomalies",M="/log-categories",S="/settings",T=Object(Ht.b)({app:"logs",pathname:"settings"});return i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,{title:Zs}),i.a.createElement(v.a,{feedbackLink:Ks,appName:Zs}),l&&c&&i.a.createElement(Ie.HeaderMenuPortal,{setHeaderActionMenu:l,theme$:c},i.a.createElement(d.EuiHeaderLinks,{gutterSize:"xs"},i.a.createElement(d.EuiHeaderLink,g()({color:"text"},T),Xs),i.a.createElement(b.a,null),i.a.createElement(d.EuiHeaderLink,{href:null===(a=m.services)||void 0===a||null===(r=a.application)||void 0===r?void 0:r.getUrlForApp("/integrations/browse"),color:"primary",iconType:"indexOpen"},el))),i.a.createElement(s.Switch,null,i.a.createElement(s.Route,{path:f,component:qs}),i.a.createElement(s.Route,{path:h,component:Lr}),i.a.createElement(s.Route,{path:M,component:Dn}),i.a.createElement(s.Route,{path:S,component:wo}),i.a.createElement(_.a,{from:"/analysis",to:h,exact:!0}),i.a.createElement(_.a,{from:"/log-rate",to:h,exact:!0}),i.a.createElement(_.a,{from:"/",to:f,exact:!0})))},Zs=f.i18n.translate("xpack.infra.header.logsTitle",{defaultMessage:"Logs"}),Xs=(f.i18n.translate("xpack.infra.logs.index.streamTabTitle",{defaultMessage:"Stream"}),f.i18n.translate("xpack.infra.logs.index.anomaliesTabTitle",{defaultMessage:"Anomalies"}),f.i18n.translate("xpack.infra.logs.index.logCategoriesBetaBadgeTitle",{defaultMessage:"Categories"}),f.i18n.translate("xpack.infra.logs.index.settingsTabTitle",{defaultMessage:"Settings"})),Ks="https://discuss.elastic.co/c/logs",el=f.i18n.translate("xpack.infra.logsHeaderAddDataButtonLabel",{defaultMessage:"Add data"});var tl=a(157);const al=({children:e})=>{const[t]=Object(tl.b)(),{services:a}=Object(_e.b)();return i.a.createElement(x.a,{sourceId:t,fetch:a.http.fetch,indexPatternsService:a.data.indexPatterns},i.a.createElement(mt,null,e))},nl=()=>i.a.createElement(d.EuiErrorBoundary,null,i.a.createElement(al,null,i.a.createElement(Qs,null)));var il=a(42),rl=a(172);const ol=(e,t,{element:a,history:n,setHeaderActionMenu:r,theme$:s})=>{const c=new l.Storage(window.localStorage);return Object(rl.b)(a,"infraLogsPage"),o.a.render(i.a.createElement(sl,{core:e,storage:c,history:n,plugins:t,setHeaderActionMenu:r,theme$:s}),a),()=>{o.a.unmountComponentAtNode(a)}},sl=({core:e,history:t,plugins:a,setHeaderActionMenu:n,storage:r,theme$:o})=>{var l;const d=e.application.capabilities;return i.a.createElement(il.b,{core:e,plugins:a,theme$:o},i.a.createElement(il.a,{appName:"Logs UI",setHeaderActionMenu:n,storage:r,theme$:o,triggersActionsUI:a.triggersActionsUi},i.a.createElement(s.Router,{history:t},i.a.createElement(s.Switch,null,i.a.createElement(s.Route,{path:"/link-to",component:u.a}),(null==d||null===(l=d.logs)||void 0===l?void 0:l.show)&&i.a.createElement(s.Route,{path:"/",component:nl}),i.a.createElement(s.Route,{component:c.a})))))}}}]);