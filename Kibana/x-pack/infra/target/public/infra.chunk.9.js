/*! Copyright Elasticsearch B.V. and/or licensed to Elasticsearch B.V. under one or more contributor license agreements. 
 * Licensed under the Elastic License 2.0; you may not use this file except in compliance with the Elastic License 2.0. */
(window.infra_bundle_jsonpfunction=window.infra_bundle_jsonpfunction||[]).push([[9],{100:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(69).__importDefault(r(134));t.default=function(e){n.default((function(){e()}))}},114:function(e,t,r){"use strict";r.d(t,"a",(function(){return p}));var n=r(0),a=r(89),i=r(98);const o=n.type({from:n.number,to:n.number,interval:n.string}),l=n.union([n.string,n.null,n[void 0]]),s=n.type({id:n.string,aggregations:a.d}),u=(n.intersection([n.type({timerange:o,indexPattern:n.string,metrics:n.array(s)}),n.partial({groupBy:n.array(l),modules:n.array(n.string),afterKey:n.union([n.null,i.b]),limit:n.union([n.number,n.null,n[void 0]]),filters:n.array(n.object),dropPartialBuckets:n.boolean,alignDataToEnd:n.boolean})]),n.type({afterKey:n.union([n.null,i.b,n[void 0]]),interval:n.number})),c=n.keyof({date:null,number:null,string:null}),d=n.type({name:n.string,type:c}),m=n.intersection([n.type({timestamp:n.number}),n.record(n.string,n.union([n.string,n.number,n.null,n[void 0],n.array(n.object)]))]),p=n.intersection([n.type({id:n.string,columns:n.array(d),rows:n.array(m)}),n.partial({keys:n.array(n.string)})]);n.type({series:n.array(n.intersection([p,n.partial({metricsets:n.array(n.string)})])),info:u})},116:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(4),a=r(70);function i(){const[e]=Object(n.useUiSetting$)(a.UI_SETTINGS.DATEFORMAT_TZ);return e&&"Browser"!==e?e:"local"}},124:function(e,t,r){"use strict";r.d(t,"c",(function(){return f})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return y})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return l}));var n=r(0),a=r(129);r(19);const i=n.type({time:n.number,tiebreaker:n.number}),o=n.type({before:n.union([i,n.literal("last")])}),l=n.type({after:n.union([i,n.literal("first")])}),s=(n.type({center:i}),n.type({constant:n.string})),u=n.type({field:n.string,value:a.a,highlights:n.array(n.string)}),c=n.union([s,u]),d=n.type({columnId:n.string,timestamp:n.number}),m=n.type({columnId:n.string,field:n.string,value:a.a,highlights:n.array(n.string)}),p=n.type({columnId:n.string,message:n.array(c)}),g=n.union([d,m,p]),f=n.union([n.type({}),n.type({"container.id":n.string}),n.type({"host.name":n.string,"log.file.path":n.string})]),b=n.type({field:n.string,value:a.a}),y=n.type({id:n.string,index:n.string,cursor:i,columns:n.array(g),context:f})},129:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return l}));var n=r(0);const a=n.union([n.null,n.boolean,n.number,n.string]),i=n.recursion("JsonValue",(()=>n.union([a,o,l]))),o=n.recursion("JsonArray",(()=>n.array(i))),l=n.recursion("JsonObject",(()=>n.record(n.string,i)))},132:function(e,t,r){"use strict";r.d(t,"i",(function(){return p})),r.d(t,"d",(function(){return g})),r.d(t,"f",(function(){return f})),r.d(t,"j",(function(){return b})),r.d(t,"k",(function(){return y})),r.d(t,"h",(function(){return v})),r.d(t,"g",(function(){return E})),r.d(t,"a",(function(){return O})),r.d(t,"e",(function(){return x})),r.d(t,"c",(function(){return C})),r.d(t,"b",(function(){return j}));var n=r(2),a=r.n(n),i=r(67),o=r(27),l=r(65),s=r.n(l),u=r(1),c=r(13),d=r(18),m=r(12);const p={headerFormatter:e=>s()(e.value).format("Y-MM-DD HH:mm:ss")},g=20,f={s:u.i18n.translate("xpack.infra.alerts.timeLabels.seconds",{defaultMessage:"seconds"}),m:u.i18n.translate("xpack.infra.alerts.timeLabels.minutes",{defaultMessage:"minutes"}),h:u.i18n.translate("xpack.infra.alerts.timeLabels.hours",{defaultMessage:"hours"}),d:u.i18n.translate("xpack.infra.alerts.timeLabels.days",{defaultMessage:"days"})},b=(e,t)=>Object(n.useMemo)((()=>"number"==typeof e&&"number"==typeof t?Object(i.niceTimeFormatter)([e,t]):e=>`${e}`),[e,t]),y=m.a,v=(e,t=!1)=>{let r=null,n=null;const a=e.reduce(((e,t)=>(t.points.forEach((t=>{const r=e[t.timestamp]||[];e[t.timestamp]=[...r,t.value]})),e)),{});Object.values(a).forEach((e=>{const a=t?Object(o.sum)(e):Object(o.max)(e),i=Object(o.min)(e);a&&(!n||a>n)&&(n=a),i&&(!r||i<r)&&(r=i)}));const i=Object.keys(a).map(Number),l=Object(o.min)(i)||0,s=Object(o.max)(i)||0;return{yMin:r||0,yMax:n||0,xMin:l,xMax:s}},E=e=>e?i.DARK_THEME:i.LIGHT_THEME,h=({children:e})=>a.a.createElement("div",{style:{width:"100%",height:150,display:"flex",justifyContent:"center",alignItems:"center"}},e),O=({children:e})=>a.a.createElement("div",{style:{width:"100%",height:150}},e),x=()=>a.a.createElement(h,null,a.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"noChartData"},a.a.createElement(d.FormattedMessage,{id:"xpack.infra.alerts.charts.noDataMessage",defaultMessage:"No chart data available"}))),C=()=>a.a.createElement(h,null,a.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"loadingData"},a.a.createElement(d.FormattedMessage,{id:"xpack.infra.alerts.charts.loadingMessage",defaultMessage:"Loading"}))),j=()=>a.a.createElement(h,null,a.a.createElement(c.EuiText,{color:"subdued","data-test-subj":"chartErrorState"},a.a.createElement(d.FormattedMessage,{id:"xpack.infra.alerts.charts.errorMessage",defaultMessage:"Uh oh, something went wrong"})))},134:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=function(e){n.useEffect(e,[])}},139:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.default=function(){var e=n.useRef(!1),t=n.useCallback((function(){return e.current}),[]);return n.useEffect((function(){return e.current=!0,function(){e.current=!1}})),t}},291:function(e,t,r){"use strict";r.r(t),r.d(t,"ExpressionEditor",(function(){return ue})),r.d(t,"SourceStatusWrapper",(function(){return ce})),r.d(t,"Editor",(function(){return de})),r.d(t,"ExpressionLike",(function(){return me}));var n=r(13),a=r(1),i=r(2),o=r.n(i),l=r(100),s=r.n(l),u=r(4),c=r(72),d=r(9),m=r(19),p=r(86),g=r(157);const f=({onChange:e,fields:t,selectedGroups:r=[],label:a,placeholder:l})=>{const s=Object(i.useCallback)((t=>{const r=t.map((e=>e.label));e(r)}),[e]),u=Object(i.useMemo)((()=>r.map((e=>({label:e})))),[r]),c=Object(i.useMemo)((()=>t.filter((e=>e.aggregatable)).map((e=>({label:e.name})))),[t]);return o.a.createElement("div",{style:{minWidth:"300px"}},o.a.createElement(n.EuiComboBox,{placeholder:l,"aria-label":a,fullWidth:!0,singleSelection:!1,selectedOptions:u,options:c,onChange:s,isClearable:!0}))},b=a.i18n.translate("xpack.infra.alerting.alertFlyout.groupByLabel",{defaultMessage:"Group By"}),y=a.i18n.translate("xpack.infra.alerting.alertFlyout.groupBy.placeholder",{defaultMessage:"Nothing (ungrouped)"}),v=({selectedGroups:e=[],fields:t,label:r,onChange:a})=>{const[l,s]=Object(i.useState)(!1),u=Object(i.useMemo)((()=>e.length>0?e.join(", "):y),[e]),c=null!=r?r:b;return o.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiPopover,{id:"groupByExpression",button:o.a.createElement(n.EuiExpression,{description:c,uppercase:!0,value:u,isActive:l,onClick:()=>s(!l)}),isOpen:l,closePopover:()=>s(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},o.a.createElement("div",{style:{zIndex:11e3}},o.a.createElement(n.EuiPopoverTitle,null,c),o.a.createElement(f,{selectedGroups:e,onChange:a,fields:t,label:c,placeholder:y})))))};var E=r(46),h=r(33),O=r.n(h),x=r(18),C=r(27);const j=a.i18n.translate("xpack.infra.logs.alertFlyout.firstCriterionFieldPrefix",{defaultMessage:"with"}),S=a.i18n.translate("xpack.infra.logs.alertFlyout.successiveCriterionFieldPrefix",{defaultMessage:"and"}),k=a.i18n.translate("xpack.infra.logs.alertFlyout.criterionFieldTitle",{defaultMessage:"Field"}),w=a.i18n.translate("xpack.infra.logs.alertFlyout.criterionComparatorValueTitle",{defaultMessage:"Comparison : Value"}),T=e=>"number"===(null==e?void 0:e.type)?[{value:d.a.GT,text:d.b[d.a.GT]},{value:d.a.GT_OR_EQ,text:d.b[d.a.GT_OR_EQ]},{value:d.a.LT,text:d.b[d.a.LT]},{value:d.a.LT_OR_EQ,text:d.b[d.a.LT_OR_EQ]},{value:d.a.EQ,text:d.b[`${d.a.EQ}:number`]},{value:d.a.NOT_EQ,text:d.b[`${d.a.NOT_EQ}:number`]}]:null!=e&&e.aggregatable?[{value:d.a.EQ,text:d.b[d.a.EQ]},{value:d.a.NOT_EQ,text:d.b[d.a.NOT_EQ]}]:[{value:d.a.MATCH,text:d.b[d.a.MATCH]},{value:d.a.NOT_MATCH,text:d.b[d.a.NOT_MATCH]},{value:d.a.MATCH_PHRASE,text:d.b[d.a.MATCH_PHRASE]},{value:d.a.NOT_MATCH_PHRASE,text:d.b[d.a.NOT_MATCH_PHRASE]}],M=(e,t)=>e.find((e=>e.name===t)),P=({idx:e,fields:t,criterion:r,updateCriterion:l,removeCriterion:s,canDelete:u,errors:c})=>{var m,p,g;const[f,b]=Object(i.useState)(!1),[y,v]=Object(i.useState)(!1),E=Object(i.useMemo)((()=>t.map((e=>({label:e.name})))),[t]),h=Object(i.useMemo)((()=>r.field?M(t,r.field):void 0),[t,r]),O=Object(i.useMemo)((()=>T(h)),[h]),x=Object(i.useCallback)((([r])=>{if(!r)return void l(e,{field:""});const n=r.label,a=M(t,n);if((null==h?void 0:h.type)!==(null==a?void 0:a.type)||(null==h?void 0:h.aggregatable)!==(null==a?void 0:a.aggregatable)){const t=T(a);l(e,{field:n,comparator:t[0].value,value:void 0})}else l(e,{field:n});b(!1)}),[h,t,e,l]),P=r.field?[{label:r.field}]:[];return o.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(n.EuiFlexItem,{grow:!0},o.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiPopover,{id:"criterion-field",button:o.a.createElement(n.EuiExpression,{description:0===e?j:S,uppercase:!0,value:null!==(m=r.field)&&void 0!==m?m:"a chosen field",isActive:f,color:0===c.field.length?"success":"danger",onClick:e=>{e.stopPropagation(),b(!f)}}),isOpen:f,closePopover:()=>b(!1),onClick:e=>e.stopPropagation(),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},o.a.createElement("div",null,o.a.createElement(n.EuiPopoverTitle,null,k),o.a.createElement(n.EuiFormRow,{style:{minWidth:"300px"},isInvalid:c.field.length>0,error:c.field},o.a.createElement(n.EuiComboBox,{compressed:!0,fullWidth:!0,isClearable:!1,singleSelection:{asPlainText:!0},options:E,selectedOptions:P,onChange:x}))))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiPopover,{id:"criterion-comparator-value",button:o.a.createElement(n.EuiExpression,{description:r.comparator&&null!==(p=null!==(g=d.b[`${r.comparator}:${null==h?void 0:h.type}`])&&void 0!==g?g:d.b[r.comparator])&&void 0!==p?p:"",uppercase:!0,value:r.value,isActive:y,color:0===c.comparator.length&&0===c.value.length?"success":"danger",onClick:e=>{e.stopPropagation(),v(!y)}}),isOpen:y,closePopover:()=>v(!1),onClick:e=>e.stopPropagation(),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},o.a.createElement("div",null,o.a.createElement(n.EuiPopoverTitle,null,w),o.a.createElement(n.EuiFlexGroup,{gutterSize:"l"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiFormRow,{isInvalid:c.comparator.length>0,error:c.comparator},o.a.createElement(n.EuiSelect,{compressed:!0,hasNoInitialSelection:null==r.comparator,value:r.comparator,onChange:t=>l(e,{comparator:t.target.value}),options:O}))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiFormRow,{isInvalid:c.value.length>0,error:c.value},"number"===(null==h?void 0:h.type)?o.a.createElement(n.EuiFieldNumber,{compressed:!0,value:r.value,onChange:t=>{const r=parseFloat(t.target.value);l(e,{value:Object(C.isNumber)(r)&&Object(C.isFinite)(r)?r:void 0})}}):o.a.createElement(n.EuiFieldText,{compressed:!0,value:r.value,onChange:t=>l(e,{value:t.target.value})}))))))))),u&&o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiButtonIcon,{"aria-label":a.i18n.translate("xpack.infra.logs.alertFlyout.removeCondition",{defaultMessage:"Remove condition"}),color:"danger",iconType:"trash",onClick:t=>{t.stopPropagation(),s(e)}})))};var F=r(194),_=r.n(F),R=r(67),L=r(132),I=r(90),z=r(183),B=r(84),A=r(97);const D=async(e,t,r,n)=>{const a=await t(A.a,{method:"POST",body:JSON.stringify(A.l.encode({data:{sourceId:e,alertParams:r,buckets:n}}))});return Object(m.b)(A.m)(a)};var Q=r(116);const G=({ruleParams:e,chartCriterion:t,sourceId:r,showThreshold:n})=>{const a=Object(i.useMemo)((()=>{const{field:r,comparator:n,value:a}=t,i={criteria:r&&n&&a?[{field:r,comparator:n,value:a}]:[],count:{comparator:e.count.comparator,value:e.count.value},timeSize:e.timeSize,timeUnit:e.timeUnit,groupBy:e.groupBy};try{return Object(m.b)(z.b)(i)}catch(e){return null}}),[e.timeSize,e.timeUnit,e.groupBy,e.count.comparator,e.count.value,t]);return null===a||0===a.criteria.length?null:o.a.createElement(N,{buckets:a.groupBy&&0!==a.groupBy.length?L.d/4:L.d,sourceId:r,threshold:e.count,chartAlertParams:a,showThreshold:n})},N=({buckets:e,sourceId:t,threshold:r,chartAlertParams:a,showThreshold:l})=>{const{uiSettings:s}=Object(u.useKibana)().services,c=(null==s?void 0:s.get("theme:darkMode"))||!1,m=Object(Q.a)(),{getChartPreviewData:p,isLoading:g,hasError:f,chartPreviewData:b}=(({sourceId:e,ruleParams:t,buckets:r})=>{const{http:n}=Object(u.useKibana)().services,[a,o]=Object(i.useState)([]),[l,s]=Object(i.useState)(!1),[c,d]=Object(B.c)({cancelPreviousOn:"creation",createPromise:async()=>(s(!1),await D(e,n.fetch,t,r)),onResolve:({data:{series:e}})=>{s(!1),o(e)},onReject:e=>{s(!0)}},[e,n,t,r]);return{chartPreviewData:a,hasError:l,isLoading:Object(i.useMemo)((()=>"pending"===c.state),[c.state]),getChartPreviewData:d}})({sourceId:t,ruleParams:a,buckets:e});_()((()=>{p()}),500,[p]);const{timeSize:y,timeUnit:v,groupBy:E}=a,h=!!(E&&E.length>0),O=!!(l&&r&&r.comparator)&&[d.a.GT,d.a.GT_OR_EQ].includes(r.comparator),C=!!(l&&r&&r.comparator)&&[d.a.LT,d.a.LT_OR_EQ].includes(r.comparator),j=Object(i.useMemo)((()=>{if(!h)return b;const e=b.sort(((e,t)=>{const r=Math.max(...e.points.map((e=>e.value)));return Math.max(...t.points.map((e=>e.value)))-r}));return(!O&&!C||O?e:e.reverse()).slice(0,5)}),[b,h,O,C]),S=Object(i.useMemo)((()=>j.reduce(((e,t)=>[...e,...t.points.reduce(((e,r)=>[...e,{...r,groupBy:t.id}]),[])]),[])),[j]),k=y*e,w=b.length>0,{yMin:T,yMax:M,xMin:P,xMax:F}=Object(L.h)(j,false),z={max:l&&r?1.1*Math.max(M,r.value):1.1*M,min:l&&r?Math.min(T,r.value):T};l&&r&&z.min===r.value&&(z.min=.9*z.min);const A=E&&E.length>0?E.join(", "):null,G=Object(L.j)(P,F),N=L.f[v];return g?o.a.createElement(L.c,null):f?o.a.createElement(L.b,null):w?o.a.createElement(o.a.Fragment,null,o.a.createElement(L.a,null,o.a.createElement(R.Chart,null,o.a.createElement(R.BarSeries,{id:"criterion-preview",xScaleType:R.ScaleType.Time,yScaleType:R.ScaleType.Linear,xAccessor:"timestamp",yAccessors:["value"],splitSeriesAccessors:["groupBy"],stackAccessors:void 0,data:S,barSeriesStyle:{rectBorder:{stroke:h?void 0:Object(I.b)(I.a.color0),strokeWidth:1,visible:!0},rect:{opacity:1}},color:h?void 0:Object(I.b)(I.a.color0),timeZone:m}),l&&r?o.a.createElement(R.LineAnnotation,{id:"threshold-line",domainType:R.AnnotationDomainType.YDomain,dataValues:[{dataValue:r.value}],style:{line:{strokeWidth:2,stroke:Object(I.b)(I.a.color1),opacity:1}}}):null,l&&r&&C?o.a.createElement(R.RectAnnotation,{id:"below-threshold",style:{fill:Object(I.b)(I.a.color1),opacity:.3},dataValues:[{coordinates:{x0:P,x1:F,y0:z.min,y1:r.value}}]}):null,l&&r&&O?o.a.createElement(R.RectAnnotation,{id:"above-threshold",style:{fill:Object(I.b)(I.a.color1),opacity:.3},dataValues:[{coordinates:{x0:P,x1:F,y0:r.value,y1:z.max}}]}):null,o.a.createElement(R.Axis,{id:"timestamp",position:R.Position.Bottom,showOverlappingTicks:!0,tickFormat:G}),o.a.createElement(R.Axis,{id:"values",position:R.Position.Left,tickFormat:L.k,domain:z}),o.a.createElement(R.Settings,{tooltip:L.i,theme:Object(L.g)(c)}))),o.a.createElement("div",{style:{textAlign:"center"}},null!=A?o.a.createElement(n.EuiText,{size:"xs",color:"subdued"},o.a.createElement(x.FormattedMessage,{id:"xpack.infra.logs.alerts.dataTimeRangeLabelWithGrouping",defaultMessage:"Last {lookback} {timeLabel} of data, grouped by {groupByLabel} (showing {displayedGroups}/{totalGroups} groups)",values:{groupByLabel:A,timeLabel:N,lookback:k,displayedGroups:j.length,totalGroups:b.length}})):o.a.createElement(n.EuiText,{size:"xs",color:"subdued"},o.a.createElement(x.FormattedMessage,{id:"xpack.infra.logs.alerts.dataTimeRangeLabel",defaultMessage:"Last {lookback} {timeLabel} of data",values:{timeLabel:N,lookback:k}})))):o.a.createElement(L.e,null)},U=a.i18n.translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryAText",{defaultMessage:"Query A"}),H=a.i18n.translate("xpack.infra.logs.alerting.threshold.ratioCriteriaQueryBText",{defaultMessage:"Query B"}),W=e=>{const{criteria:t,errors:r}=e;return t&&0!==t.length?Object(d.j)(t)?o.a.createElement($,O()({},e,{criteria:t,errors:r})):o.a.createElement(q,O()({},e,{criteria:t,errors:r})):null},K=e=>{const{updateCriterion:t,removeCriterion:r,addCriterion:a,criteria:i,fields:l,errors:s,ruleParams:u,sourceId:c,isRatio:d=!1}=e;return o.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(n.EuiFlexItem,{grow:!0},i.map(((e,a)=>o.a.createElement(n.EuiAccordion,{id:`criterion-${a}`,buttonContent:o.a.createElement(P,{idx:a,fields:l,criterion:e,updateCriterion:t,removeCriterion:r,canDelete:i.length>1,errors:s[a]}),key:a,arrowDisplay:"right"},o.a.createElement(G,{ruleParams:u,chartCriterion:e,sourceId:c,showThreshold:!d})))),o.a.createElement(J,{addCriterion:a})))},$=e=>{const{criteria:t,defaultCriterion:r,errors:a,updateCriteria:l}=e,s=Object(i.useCallback)((e=>{const r=[e,Object(d.f)(t)];l(r)}),[l,t]),u=Object(i.useCallback)((e=>{const r=[Object(d.g)(t),e];l(r)}),[l,t]),{updateCriterion:c,addCriterion:m,removeCriterion:p}=V(Object(d.g)(t),r,s),{updateCriterion:g,addCriterion:f,removeCriterion:b}=V(Object(d.f)(t),r,u);return o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiSpacer,{size:"xxl"}),o.a.createElement(me,{text:U}),o.a.createElement(K,O()({},e,{criteria:Object(d.g)(t),updateCriterion:c,addCriterion:m,removeCriterion:p,errors:a[0],isRatio:!0})),o.a.createElement(n.EuiSpacer,{size:"l"}),o.a.createElement(me,{text:H}),o.a.createElement(K,O()({},e,{criteria:Object(d.f)(t),updateCriterion:g,addCriterion:f,removeCriterion:b,errors:a[1],isRatio:!0})))},q=e=>{const{criteria:t,defaultCriterion:r,updateCriteria:n,errors:a}=e,{updateCriterion:i,addCriterion:l,removeCriterion:s}=V(t,r,n);return o.a.createElement(K,O()({},e,{updateCriterion:i,addCriterion:l,removeCriterion:s,errors:a[0]}))},V=(e,t,r)=>({updateCriterion:Object(i.useCallback)(((t,n)=>{const a=e.map(((e,r)=>t===r?{...e,...n}:e));r(a)}),[e,r]),addCriterion:Object(i.useCallback)((()=>{const n=[...e,t];r(n)}),[e,t,r]),removeCriterion:Object(i.useCallback)((t=>{const n=e.filter(((e,r)=>r!==t));r(n)}),[e,r])}),J=({addCriterion:e})=>o.a.createElement("div",null,o.a.createElement(n.EuiButtonEmpty,{color:"primary",iconSide:"left",flush:"left",iconType:"plusInCircleFilled",onClick:e},o.a.createElement(x.FormattedMessage,{id:"xpack.infra.logs.alertFlyout.addCondition",defaultMessage:"Add condition"}))),Y=a.i18n.translate("xpack.infra.logs.alertFlyout.thresholdPrefix",{defaultMessage:"is"}),Z=a.i18n.translate("xpack.infra.logs.alertFlyout.thresholdPopoverTitle",{defaultMessage:"Threshold"}),X=({comparator:e,value:t,updateThreshold:r,errors:a})=>{const[l,s]=Object(i.useState)(!1);return o.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiPopover,{id:"threshold",button:o.a.createElement(n.EuiExpression,{description:Y,uppercase:!0,value:`${e?d.b[e]:""} ${"number"==typeof t?t:""}`,isActive:l,onClick:()=>s(!l)}),isOpen:l,closePopover:()=>s(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiPopoverTitle,null,Z),o.a.createElement(n.EuiFlexGroup,null,o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiFormRow,null,o.a.createElement(n.EuiSelect,{compressed:!0,value:e,onChange:e=>r({comparator:e.target.value}),options:[{value:d.a.LT,text:d.b[d.a.LT]},{value:d.a.LT_OR_EQ,text:d.b[d.a.LT_OR_EQ]},{value:d.a.GT,text:d.b[d.a.GT]},{value:d.a.GT_OR_EQ,text:d.b[d.a.GT_OR_EQ]}]}))),o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiFormRow,{isInvalid:a.value.length>0,error:a.value},o.a.createElement(n.EuiFieldNumber,{compressed:!0,value:t,onChange:e=>{const t=parseFloat(e.target.value);r({value:Object(C.isNumber)(t)&&Object(C.isFinite)(t)?t:void 0})}}))))))))},ee=a.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypePrefix",{defaultMessage:"when the"}),te=a.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeCountSuffix",{defaultMessage:"of log entries"}),re=a.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeRatioSuffix",{defaultMessage:"of Query A to Query B"}),ne=a.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeCount",{defaultMessage:"count"}),ae=a.i18n.translate("xpack.infra.logs.alertFlyout.thresholdTypeRatio",{defaultMessage:"ratio"}),ie=({criteria:e,updateType:t})=>{const[r,a]=Object(i.useState)(!1),l=(e=>Object(d.j)(e)?"ratio":"count")(e);return o.a.createElement(n.EuiFlexGroup,{gutterSize:"s"},o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiPopover,{id:"thresholdType",button:o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiExpression,{description:ee,uppercase:!0,value:"ratio"===l?ae:ne,isActive:r,onClick:()=>a(!r)}),o.a.createElement(me,{text:"ratio"===l?re.toUpperCase():te.toUpperCase()})),isOpen:r,closePopover:()=>a(!1),ownFocus:!0,panelPaddingSize:"s",anchorPosition:"downLeft"},o.a.createElement(n.EuiFlexGroup,null,o.a.createElement(n.EuiFlexItem,{grow:!1},o.a.createElement(n.EuiSelect,{compressed:!0,value:l,onChange:e=>t("ratio"===l?"count":"ratio"),options:[{value:"ratio",text:ae},{value:"count",text:ne}]}))))))},oe={timeSize:5,timeUnit:"m"},le="log.level",se=(e,t)=>e.some((e=>e.name===le))?{field:le,comparator:d.a.EQ,value:t}:{field:void 0,comparator:void 0,value:void 0},ue=e=>{var t,r;const n=null!==(t=null===(r=e.metadata)||void 0===r?void 0:r.isInternal)&&void 0!==t&&t,[a]=Object(g.b)(),{http:i}=Object(u.useKibana)().services;return o.a.createElement(o.a.Fragment,null,n?o.a.createElement(ce,e,o.a.createElement(de,e)):o.a.createElement(p.a,{sourceId:a,fetch:i.fetch,indexPatternsService:e.data.indexPatterns},o.a.createElement(ce,e,o.a.createElement(de,e))))},ce=({children:e})=>{const{initialize:t,loadSource:r,isLoadingSourceConfiguration:i,hasFailedLoadingSource:l,isUninitialized:u}=Object(p.c)();return s()((()=>{t()})),o.a.createElement(o.a.Fragment,null,i||u?o.a.createElement("div",null,o.a.createElement(n.EuiSpacer,{size:"m"}),o.a.createElement(n.EuiLoadingSpinner,{size:"l"}),o.a.createElement(n.EuiSpacer,{size:"m"})):l?o.a.createElement(n.EuiCallOut,{title:a.i18n.translate("xpack.infra.logs.alertFlyout.sourceStatusError",{defaultMessage:"Sorry, there was a problem loading field information"}),color:"danger",iconType:"alert"},o.a.createElement(n.EuiButton,{onClick:r,iconType:"refresh"},a.i18n.translate("xpack.infra.logs.alertFlyout.sourceStatusErrorTryAgain",{defaultMessage:"Try again"}))):e)},de=e=>{var t,r;const{setRuleParams:l,ruleParams:u,errors:g}=e,[f,b]=Object(i.useState)(!1),{sourceId:y,resolvedSourceConfiguration:h}=Object(p.c)(),{criteria:O,threshold:x,timeSizeUnit:C,timeWindowSize:j}=Object(i.useMemo)((()=>Object(m.b)(E.a)(g)),[g]),S=Object(i.useMemo)((()=>null!=h&&h.fields?h.fields.filter((e=>("string"===e.type||"number"===e.type)&&e.searchable)):[]),[h]),k=Object(i.useMemo)((()=>null!=h&&h.fields?h.fields.filter((e=>"string"===e.type&&e.aggregatable)):[]),[h]),w=Object(i.useCallback)((e=>{const t={...u.count,...e};l("count",t)}),[u.count,l]),T=Object(i.useCallback)((e=>{l("criteria",e)}),[l]),M=Object(i.useCallback)((e=>{l("timeSize",e)}),[l]),P=Object(i.useCallback)((e=>{d.l.is(e)&&l("timeUnit",e)}),[l]),F=Object(i.useCallback)((e=>{l("groupBy",e)}),[l]),_=Object(i.useMemo)((()=>{return e=S,{...oe,count:{value:75,comparator:d.a.GT},criteria:[se(e,"error")]};var e}),[S]),R=Object(i.useCallback)((e=>{const t="count"===e?_:(r=S,{...oe,count:{value:2,comparator:d.a.GT},criteria:[[se(r,"error")],[se(r,"warning")]]});var r;l("count",t.count),l("criteria",t.criteria)}),[_,l,S]);s()((()=>{const e={..._,...u};for(const[t,r]of Object.entries(e))l(t,r);b(!0)}));const L=Object(i.useMemo)((()=>u.groupBy&&u.groupBy.length>0&&u.count&&!Object(d.i)(u.count.comparator,u.count.value)),[u]);if(!f)return null;const I=u.criteria?o.a.createElement(W,{fields:S,criteria:u.criteria,defaultCriterion:_.criteria[0],errors:O,ruleParams:u,sourceId:y,updateCriteria:T}):null;return o.a.createElement(o.a.Fragment,null,o.a.createElement(ie,{criteria:u.criteria||[],updateType:R}),u.criteria&&!Object(d.j)(u.criteria)&&I,o.a.createElement(X,{comparator:null===(t=u.count)||void 0===t?void 0:t.comparator,value:null===(r=u.count)||void 0===r?void 0:r.value,updateThreshold:w,errors:x}),o.a.createElement(c.ForLastExpression,{timeWindowSize:u.timeSize,timeWindowUnit:u.timeUnit,onChangeWindowSize:M,onChangeWindowUnit:P,errors:{timeWindowSize:j,timeSizeUnit:C}}),o.a.createElement(v,{selectedGroups:u.groupBy,onChange:F,fields:k}),u.criteria&&Object(d.j)(u.criteria)&&I,L&&o.a.createElement(o.a.Fragment,null,o.a.createElement(n.EuiSpacer,{size:"l"}),o.a.createElement(n.EuiCallOut,{color:"warning"},a.i18n.translate("xpack.infra.logs.alertFlyout.groupByOptimizationWarning",{defaultMessage:'When setting a "group by" we highly recommend using the "{comparator}" comparator for your threshold. This can lead to significant performance improvements.',values:{comparator:d.a.GT}}))),o.a.createElement(n.EuiSpacer,{size:"l"}))};t.default=ue;const me=({text:e})=>o.a.createElement("div",{className:"euiExpression euiExpression-isUppercase euiExpression--success"},o.a.createElement("span",{className:"euiExpression__description"},e))},83:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),a=!1,i="_NP_";function o(e){return function(){var t=n.useContext(e);return t}}t.default=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),l=1;l<t;l++)r[l-1]=arguments[l];var s=n.createContext(i),u=function(t){var a=e(t),i=r[0],o=i&&i(a);var l=Array.isArray(o)?n.useMemo((function(){return a}),o):a;return n.createElement(s.Provider,{value:l},t.children)},c=o(s);c.Context=s,c.Provider=u;var d=[];if(r.length){var m=[],p=function(t){for(var a=e(t),i=t.children,o=0;o<m.length;o+=1){var l=m[o],s=r[o];i=n.createElement(l.Provider,{value:s(a)},i)}return i};a,d.push(p);for(var g=0;g<r.length;g+=1){var f=n.createContext(i);m.push(f),d.push(o(f))}}else d.push(u,o(s));for(var b=0;b<d.length;b+=1)c[b]=d[b];return"function"==typeof Symbol&&Symbol.iterator&&(c[Symbol.iterator]=function(){return d[Symbol.iterator]()}),c}},84:function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return CanceledPromiseError}));var n=r(14),a=r.n(n),i=r(2),o=r(139),l=r.n(o);const s=({createPromise:e,onResolve:t=c,onReject:r=c,cancelPreviousOn:n="never",triggerOrThrow:a="whenMounted"},o)=>{const s=l()(),u=Object(i.useCallback)((()=>{switch(a){case"always":return!0;case"whenMounted":return s()}}),[s,a]),d=Object(i.useRef)([]),[m,p]=Object(i.useState)({state:"uninitialized"}),g=Object(i.useMemo)((()=>(...a)=>{let i;const o=new Promise(((e,t)=>{i=t})),l=d.current,s=()=>{l.forEach((e=>e.cancel()))},m=e(...a),g=Promise.race([m,o]);p({state:"pending",promise:g}),"creation"===n&&s();const f={cancel:()=>{i(new CanceledPromiseError)},cancelSilently:()=>{i(new SilentCanceledPromiseError)},promise:g.then((e=>(p((t=>"pending"===t.state&&t.promise===g?{state:"resolved",promise:f.promise,value:e}:t)),["settlement","resolution"].includes(n)&&s(),d.current=d.current.filter((e=>e.promise!==f.promise)),t&&u()&&t(e),e)),(e=>{if(e instanceof SilentCanceledPromiseError||p((t=>"pending"===t.state&&t.promise===g?{state:"rejected",promise:g,value:e}:t)),["settlement","rejection"].includes(n)&&s(),d.current=d.current.filter((e=>e.promise!==f.promise)),u())throw r&&r(e),e}))};return d.current=[...d.current,f],f.promise.catch(c),f.promise}),o);return Object(i.useEffect)((()=>()=>{d.current.forEach((e=>e.cancelSilently()))}),[]),[m,g]},u=e=>"rejected"===e.state;class CanceledPromiseError extends Error{constructor(e){super(e),a()(this,"isCanceled",!0),Object.setPrototypeOf(this,new.target.prototype)}}class SilentCanceledPromiseError extends CanceledPromiseError{}const c=()=>{}},86:function(e,t,r){"use strict";r.d(t,"b",(function(){return m})),r.d(t,"a",(function(){return p})),r.d(t,"c",(function(){return g}));var n=r(83),a=r.n(n),i=r(2),o=r(8),l=r(84),s=r(44),u=r(45),c=r(16),d=r(19);const m=({sourceId:e,fetch:t,indexPatternsService:r})=>{const[n,a]=Object(i.useState)(void 0),[m,p]=Object(i.useState)(void 0),[g,f]=Object(i.useState)(void 0),[b,y]=Object(l.c)({cancelPreviousOn:"resolution",createPromise:async()=>(await Object(s.a)(e,t)).data,onResolve:a},[e,t,r]),[v,E]=Object(l.c)({cancelPreviousOn:"resolution",createPromise:async e=>await Object(o.h)(e,r),onResolve:p},[r]),[h,O]=Object(l.c)({cancelPreviousOn:"resolution",createPromise:async r=>(await(async(e,t,r)=>{const n=await r(Object(c.a)(e),{method:"PATCH",body:JSON.stringify(c.e.encode({data:t}))}).catch((t=>{throw new o.c(`Failed to update log source configuration "${e}": ${t}`,t)}));return Object(d.b)(c.f,(t=>new o.c(`Failed to decode log source configuration "${e}": ${t}`)))(n)})(e,r,t)).data,onResolve:a},[e,t,r]),[x,C]=Object(l.c)({cancelPreviousOn:"resolution",createPromise:async()=>await Object(u.a)(e,t),onResolve:({data:e})=>f(e)},[e,t]),j=Object(i.useMemo)((()=>{var e,t;return{fields:null!==(e=null==m?void 0:m.fields)&&void 0!==e?e:[],title:null!==(t=null==m?void 0:m.indices)&&void 0!==t?t:"unknown"}}),[m]),S="pending"===b.state,k="pending"===v.state,w="pending"===x.state,T="pending"===h.state,M=S||k||w||T,P="uninitialized"===b.state||"uninitialized"===v.state||"uninitialized"===x.state,F="rejected"===b.state,_="rejected"===v.state,R="rejected"===x.state,L=[b,v,x].filter(l.b).map((({value:e})=>e instanceof Error?e:new Error(`${e}`))),I=L.length>0,z=Object(i.useCallback)((async()=>{const e=y(),t=C(),r=E((await e).configuration);return await Promise.all([e,r,t])}),[y,C,E]),B=Object(i.useCallback)((async e=>{const t=await O(e),r=E(t.configuration),n=C();return await Promise.all([t,r,n])}),[C,E,O]),A=Object(i.useCallback)((async()=>{if(P)return await z()}),[P,z]);return{sourceId:e,initialize:A,isUninitialized:P,derivedIndexPattern:j,hasFailedLoading:I,hasFailedLoadingSource:F,hasFailedLoadingSourceStatus:R,hasFailedResolvingSource:_,latestLoadSourceFailures:L,isLoading:M,isLoadingSourceConfiguration:S,isLoadingSourceStatus:w,isResolvingSourceConfiguration:k,sourceStatus:g,loadSourceStatus:C,loadSource:z,sourceConfiguration:n,updateSource:B,resolvedSourceConfiguration:m}},[p,g]=a()(m)},89:function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return T})),r.d(t,"e",(function(){return M})),r.d(t,"f",(function(){return P}));var n=r(0);const a=n.keyof({host:null,pod:null,container:null,awsEC2:null,awsS3:null,awsSQS:null,awsRDS:null}),i=n.keyof({line:null,area:null,bar:null}),o=(n.keyof({abbreviatedNumber:null,bits:null,bytes:null,number:null,percent:null,highPercision:null}),n.keyof({hostSystemOverview:null,hostCpuUsage:null,hostFilesystem:null,hostK8sOverview:null,hostK8sCpuCap:null,hostK8sDiskCap:null,hostK8sMemoryCap:null,hostK8sPodCap:null,hostLoad:null,hostMemoryUsage:null,hostNetworkTraffic:null,hostDockerOverview:null,hostDockerInfo:null,hostDockerTop5ByCpu:null,hostDockerTop5ByMemory:null,podOverview:null,podCpuUsage:null,podMemoryUsage:null,podLogUsage:null,podNetworkTraffic:null,containerOverview:null,containerCpuKernel:null,containerCpuUsage:null,containerDiskIOOps:null,containerDiskIOBytes:null,containerMemory:null,containerNetworkTraffic:null,nginxHits:null,nginxRequestRate:null,nginxActiveConnections:null,nginxRequestsPerConnection:null,awsOverview:null,awsCpuUtilization:null,awsNetworkBytes:null,awsNetworkPackets:null,awsDiskioBytes:null,awsDiskioOps:null,awsEC2CpuUtilization:null,awsEC2NetworkTraffic:null,awsEC2DiskIOBytes:null,awsS3TotalRequests:null,awsS3NumberOfObjects:null,awsS3BucketSize:null,awsS3DownloadBytes:null,awsS3UploadBytes:null,awsRDSCpuTotal:null,awsRDSConnections:null,awsRDSQueriesExecuted:null,awsRDSActiveTransactions:null,awsRDSLatency:null,awsSQSMessagesVisible:null,awsSQSMessagesDelayed:null,awsSQSMessagesSent:null,awsSQSMessagesEmpty:null,awsSQSOldestMessage:null,custom:null})),l=n.keyof({avg:null,max:null,min:null,calculation:null,cardinality:null,series_agg:null,positive_only:null,derivative:null,count:null,sum:null,cumulative_sum:null}),s=n.type({id:n.string,type:n.literal("count")}),u=n.intersection([n.type({id:n.string,type:l}),n.partial({field:n.string})]),c=n.type({field:n.string,id:n.string,name:n.string}),d=n.type({id:n.string,script:n.string,type:n.literal("calculation"),variables:n.array(c)}),m=n.type({id:n.string,field:n.string,unit:n.string,type:n.literal("derivative")}),p=n.type({id:n.string,function:n.string,type:n.literal("series_agg")}),g=n.type({id:n.string,value:n.number}),f=n.intersection([n.type({id:n.string,type:n.literal("percentile"),percentiles:n.array(g)}),n.partial({field:n.string})]),b=n.union([s,u,d,m,f,p]),y=n.intersection([n.type({id:n.string,metrics:n.array(b),split_mode:n.string}),n.partial({terms_field:n.string,terms_size:n.number,terms_order_by:n.string,filter:n.type({query:n.string,language:n.keyof({lucene:null,kuery:null})})})]),v=(n.intersection([n.type({id:o,requires:n.array(n.string),index_pattern:n.union([n.string,n.array(n.string)]),interval:n.string,time_field:n.string,type:n.string,series:n.array(y)}),n.partial({filter:n.string,map_field_to:n.string,id_type:n.keyof({cloud:null,node:null}),drop_last_bucket:n.boolean})]),n.record(n.string,n.union([n[void 0],n.type({field:n.string})]))),E=n.type({percentiles:n.type({field:n.string,percents:n.array(n.number)})}),h=n.type({cardinality:n.partial({field:n.string,script:n.string})}),O=n.type({bucket_script:n.intersection([n.type({buckets_path:n.record(n.string,n.string),script:n.type({source:n.string,lang:n.keyof({painless:null,expression:null})})}),n.partial({gap_policy:n.keyof({skip:null,insert_zeros:null})})])}),x=n.type({cumulative_sum:n.type({buckets_path:n.string})}),C=n.type({derivative:n.type({buckets_path:n.string,gap_policy:n.keyof({skip:null,insert_zeros:null}),unit:n.string})}),j=n.type({sum_bucket:n.type({buckets_path:n.string})}),S=n.type({top_metrics:n.type({metrics:n.union([n.array(n.type({field:n.string})),n.type({field:n.string})])})}),k=n.recursion("SnapshotModelRT",(()=>n.type({terms:n.type({field:n.string}),aggregations:T}))),w=n.union([v,E,O,x,C,j,k,h,S]),T=n.record(n.string,w),M={count:null,cpu:null,load:null,memory:null,tx:null,rx:null,logRate:null,diskIOReadBytes:null,diskIOWriteBytes:null,s3TotalRequests:null,s3NumberOfObjects:null,s3BucketSize:null,s3DownloadBytes:null,s3UploadBytes:null,rdsConnections:null,rdsQueriesExecuted:null,rdsActiveTransactions:null,rdsLatency:null,sqsMessagesVisible:null,sqsMessagesDelayed:null,sqsMessagesSent:null,sqsMessagesEmpty:null,sqsOldestMessage:null,custom:null},P=n.keyof(M)},90:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return l}));r(27);var n=r(13);let a;!function(e){e.color0="color0",e.color1="color1",e.color2="color2",e.color3="color3",e.color4="color4",e.color5="color5",e.color6="color6",e.color7="color7",e.color8="color8",e.color9="color9"}(a||(a={}));const i=Object(n.euiPaletteColorBlind)(),o={[a.color0]:i[1],[a.color1]:i[2],[a.color2]:i[0],[a.color3]:i[3],[a.color4]:i[4],[a.color5]:i[5],[a.color6]:i[6],[a.color7]:i[7],[a.color8]:i[8],[a.color9]:i[9]},l=(s=o,e=>s[e]);var s},92:function(e,t,r){"use strict";r.d(t,"g",(function(){return d})),r.d(t,"a",(function(){return m})),r.d(t,"e",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"c",(function(){return y})),r.d(t,"d",(function(){return v})),r.d(t,"f",(function(){return E}));var n=r(0),a=r(89),i=r(114);const o=n.intersection([n.type({value:n.string,label:n.string}),n.partial({ip:n.union([n.string,n.null])})]),l=n.partial({value:n.union([n.number,n.null]),avg:n.union([n.number,n.null]),max:n.union([n.number,n.null]),timeseries:i.a}),s=n.type({name:n.union([a.f,n.string])}),u=n.intersection([s,l]),c=n.type({metrics:n.array(u),path:n.array(o),name:n.string}),d=n.type({nodes:n.array(c),interval:n.string}),m=n.intersection([n.type({interval:n.string,to:n.number,from:n.number}),n.partial({lookbackSize:n.number,ignoreLookback:n.boolean,forceInterval:n.boolean})]),p=n.array(n.partial({label:n.union([n.string,n.null]),field:n.union([n.string,n.null])})),g=n.type({type:a.f}),f=["avg","max","min","rate"],b=f.reduce(((e,t)=>({...e,[t]:null})),{}),y=n.keyof(b),v=n.intersection([n.type({type:n.literal("custom"),field:n.string,aggregation:y,id:n.string}),n.partial({label:n.string})]),E=n.union([g,v]);n.intersection([n.type({timerange:m,metrics:n.array(E),groupBy:n.union([p,n.null]),nodeType:a.c,sourceId:n.string}),n.partial({accountId:n.string,region:n.string,filterQuery:n.union([n.string,n.null]),includeTimeseries:n.boolean,overrideCompositeSize:n.number})])},98:function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return p})),r.d(t,"e",(function(){return h}));var n=r(0);const a=["avg","max","min","cardinality","rate","count","sum","p95","p99"],i=a.reduce(((e,t)=>({...e,[t]:null})),{}),o=n.keyof(i),l=n.type({aggregation:o}),s=n.partial({field:n.union([n.string,n[void 0]])}),u=n.intersection([l,s]),c=n.type({from:n.number,to:n.number,interval:n.string}),d=n.type({timerange:c,indexPattern:n.string,metrics:n.array(u)}),m=n.union([n.string,n.null,n[void 0]]),p=n.record(n.string,n.union([n.string,n.null])),g=n.partial({groupBy:n.union([m,n.array(m)]),afterKey:n.union([n.string,n.null,n[void 0],p]),limit:n.union([n.number,n.null,n[void 0]]),filterQuery:n.union([n.string,n.null,n[void 0]]),forceInterval:n.boolean,dropLastBucket:n.boolean}),f=(n.intersection([d,g]),n.type({total:n.number,afterKey:n.union([n.string,n.null,p])})),b=n.keyof({date:null,number:null,string:null}),y=n.type({name:n.string,type:b}),v=n.intersection([n.type({timestamp:n.number}),n.record(n.string,n.union([n.string,n.number,n.null,n[void 0],n.array(n.object)]))]),E=n.intersection([n.type({id:n.string,columns:n.array(y),rows:n.array(v)}),n.partial({keys:n.array(n.string)})]),h=n.type({series:n.array(E),pageInfo:f})},99:function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return m}));var n=r(23),a=r(2),i=r(15),o=r(68),l=r(38);const s=({defaultState:e,decodeUrlState:t,encodeUrlState:r,urlStateKey:n,writeDefaultState:i=!1})=>{const l=Object(o.useHistory)(),s=null!=l&&l.location?c(l.location):"",g=Object(a.useMemo)((()=>{if(s)return d(s,n)}),[s,n]),f=Object(a.useMemo)((()=>t(u(g))),[t,g]),b=Object(a.useMemo)((()=>void 0!==f?f:e),[e,f]),y=Object(a.useCallback)((e=>{if(!l||!l.location)return;const t=l.location,a=p(t,m(n,void 0!==e?r(e):void 0)(c(t)));a!==t&&l.replace(a)}),[r,l,n]),[v,E]=Object(a.useState)(i&&void 0===f);return Object(a.useEffect)((()=>{v&&(E(!1),y(e))}),[v,y,e]),[b,y]},u=e=>{try{return e?Object(i.decode)(e):void 0}catch(e){if(e instanceof Error&&e.message.startsWith("rison decoder error"))return{};throw e}},c=e=>e.search.substring(1),d=(e,t)=>{const r=Object(n.parse)(e,{sort:!1})[t];return Array.isArray(r)?r[0]:r},m=(e,t)=>r=>{const a=Object(n.parse)(r,{sort:!1}),o=void 0===t?a:{...a,[e]:(s=t,Object(i.encode)(s))};var s;return Object(n.stringify)(l.url.encodeQuery(o),{sort:!1,encode:!1})},p=(e,t)=>t===c(e)?e:{...e,search:`?${t}`}}}]);